import{S as e,i as t,s as a,e as n,a as i,b as s,c as r,d as l,n as m,f as o,r as c,I as u,g,h as p,j as d,k as f,t as $,l as v,m as y,o as I,p as h,q as w,u as x,w as b,v as C,x as q,y as k,z as V,A as D,B as M,C as S,D as U,E as L,F as z,G as O,H as T,J as j,K as B,L as R,T as E,M as F}from"./region-list-a16607d4.js";function Z(e){let t,a,c,u;return{c(){t=n("div"),a=n("img"),i(a.src,c=e[1])||s(a,"src",c),s(a,"alt",u="Main view of region "+e[0]),s(a,"class","svelte-7qa61q"),s(t,"class","img-wrapper is-flex is-justify-content-center is-align-items-center svelte-7qa61q")},m(e,n){r(e,t,n),l(t,a)},p(e,[t]){1&t&&u!==(u="Main view of region "+e[0])&&s(a,"alt",u)},i:m,o:m,d(e){e&&o(t)}}}function H(e,t,a){let{mainImg:n}=t;const i=c(n);return e.$$set=e=>{"mainImg"in e&&a(0,n=e.mainImg)},[n,i]}class Q extends e{constructor(e){super(),t(this,e,H,Z,a,{mainImg:0})}}function A(e){let t,a,m,c,b,C,q,k,V,D,M,S,U,L,z,O,T,j,B,R,E,F,Z,H,Q,A,G,J,K,P,N,W,X,Y,_,ee;return z=new u({props:{minVal:0,maxVal:1,start:e[5],emitOnUpdate:!0,title:"fr"===g?"Opacité":"Opacity"}}),z.$on("updateSlider",e[9]),j=new u({props:{minVal:0,maxVal:360,start:e[6],step:1,emitOnUpdate:!0,title:"Rotation"}}),j.$on("updateSlider",e[10]),E=new u({props:{minVal:0,maxVal:200,step:1,start:e[7],emitOnUpdate:!0,title:"fr"===g?"Redimensionner":"Scale"}}),E.$on("updateSlider",e[11]),H=new p({props:{choicesItems:e[4],start:[],lightDisplay:!0,placeholder:"fr"===g?"Séléctionner":"Select",title:"fr"===g?"Basculer":"Flip"}}),H.$on("updateValues",e[14]),G=new u({props:{minVal:-100,maxVal:100,step:1,start:e[8][0],emitOnUpdate:!0,title:"fr"===g?"Translation horizontale":"Horizontal translate"}}),G.$on("updateSlider",e[12]),P=new u({props:{minVal:-100,maxVal:100,step:1,start:e[8][1],emitOnUpdate:!0,title:"fr"===g?"Translation verticale":"Vertical translate"}}),P.$on("updateSlider",e[13]),{c(){t=n("div"),a=n("img"),b=d(),C=n("img"),V=d(),D=n("div"),M=n("div"),M.innerHTML="<strong>Transform query image</strong>",S=d(),U=n("div"),L=n("div"),f(z.$$.fragment),O=d(),T=n("div"),f(j.$$.fragment),B=d(),R=n("div"),f(E.$$.fragment),F=d(),Z=n("div"),f(H.$$.fragment),Q=d(),A=n("div"),f(G.$$.fragment),J=d(),K=n("div"),f(P.$$.fragment),N=d(),W=n("div"),X=n("button"),X.textContent=""+("fr"===g?"Réinitialiser":"Reset"),s(a,"class","compare-img svelte-329u2s"),i(a.src,m=e[0].queryImage.href)||s(a,"src",m),s(a,"alt",c=e[0].queryImage.title),s(C,"class","main-img svelte-329u2s"),i(C.src,q=e[0].similarityImage.href)||s(C,"src",q),s(C,"alt",k=e[0].similarityImage.title),$(C,"overlay-reset",e[2]),v(C,"opacity",e[1]),v(C,"transform",e[3]),s(t,"class","overlay-wrapper svelte-329u2s"),s(M,"class","toolbar-title"),s(L,"class","column is-one-quarter svelte-329u2s"),s(T,"class","column is-one-quarter svelte-329u2s"),s(R,"class","column is-one-quarter svelte-329u2s"),s(Z,"class","column is-one-quarter svelte-329u2s"),s(A,"class","column is-one-third svelte-329u2s"),s(K,"class","column is-one-third svelte-329u2s"),s(X,"class","button is-link"),s(W,"class","column is-one-third is-flex is-flex-direction-column is-justify-content-center is-align-items-flex-end svelte-329u2s"),s(U,"class","toolbar-controls columns is-3 is-multiline svelte-329u2s"),s(D,"class","toolbar-wrapper svelte-329u2s")},m(n,i){r(n,t,i),l(t,a),l(t,b),l(t,C),r(n,V,i),r(n,D,i),l(D,M),l(D,S),l(D,U),l(U,L),y(z,L,null),l(U,O),l(U,T),y(j,T,null),l(U,B),l(U,R),y(E,R,null),l(U,F),l(U,Z),y(H,Z,null),l(U,Q),l(U,A),y(G,A,null),l(U,J),l(U,K),y(P,K,null),l(U,N),l(U,W),l(W,X),Y=!0,_||(ee=I(X,"click",e[15]),_=!0)},p(e,[t]){(!Y||1&t&&!i(a.src,m=e[0].queryImage.href))&&s(a,"src",m),(!Y||1&t&&c!==(c=e[0].queryImage.title))&&s(a,"alt",c),(!Y||1&t&&!i(C.src,q=e[0].similarityImage.href))&&s(C,"src",q),(!Y||1&t&&k!==(k=e[0].similarityImage.title))&&s(C,"alt",k),(!Y||4&t)&&$(C,"overlay-reset",e[2]),2&t&&v(C,"opacity",e[1]),8&t&&v(C,"transform",e[3])},i(e){Y||(h(z.$$.fragment,e),h(j.$$.fragment,e),h(E.$$.fragment,e),h(H.$$.fragment,e),h(G.$$.fragment,e),h(P.$$.fragment,e),Y=!0)},o(e){w(z.$$.fragment,e),w(j.$$.fragment,e),w(E.$$.fragment,e),w(H.$$.fragment,e),w(G.$$.fragment,e),w(P.$$.fragment,e),Y=!1},d(e){e&&o(t),e&&o(V),e&&o(D),x(z),x(j),x(E),x(H),x(G),x(P),_=!1,ee()}}}function G(e,t,a){let n,{imgData:i}=t;const s=[{value:"h",label:"fr"===g?"Basculer horizontalement":"Flip horizontally"},{value:"v",label:"fr"===g?"Basculer verticalement":"Flip vertically"},{value:"hv",label:"fr"===g?"Basculer horizontalement et verticalement":"Flip horizontally and vertically"}];let r=.5;const l=r;let m=0;const o=m;let c=100;const u=c;let p=[1,1];const d=structuredClone(p);let f=[0,0];const $=structuredClone(f);let v=!1;const y=b(window.crypto.randomUUID());C("resetTrigger",y);return e.$$set=e=>{"imgData"in e&&a(0,i=e.imgData)},e.$$.update=()=>{983040&e.$$.dirty&&a(3,n=`translate(${f[0]-50}%, ${f[1]}%)\n                        rotate(${m}deg)\n                        scale(${p.map((e=>e*(c/100))).join()})`)},[i,r,v,n,s,l,o,u,$,e=>a(1,r=e.detail),e=>a(16,m=e.detail),e=>a(17,c=e.detail),e=>a(19,f=[e.detail,f[1]]),e=>a(19,f=[f[0],e.detail]),e=>{let t=e.detail[0];a(18,p="hv"===t?[-1,-1]:"h"===t?[-1,1]:"v"===t?[1,-1]:[1,1])},()=>{a(1,r=l),a(16,m=o),a(17,c=u),a(18,p=d),a(19,f=$),y.set(window.crypto.randomUUID()),a(2,v=!0),setTimeout((()=>a(2,v=!1)),1e3)},m,c,p,f]}class J extends e{constructor(e){super(),t(this,e,G,A,a,{imgData:0})}}function K(e,t,a){const n=e.slice();return n[1]=t[a],n}function P(e){let t,a,m,c,u,p,f,$,v="queryImage"===e[1]&&"fr"===g?"Image requête":"similarityImage"===e[1]&&"fr"===g?"Similarité":"queryImage"===e[1]&&"en"===g?"Query image":"Similarity";return{c(){t=n("div"),a=n("span"),m=k(v),c=d(),u=n("img"),$=d(),i(u.src,p=e[0][e[1]].href)||s(u,"src",p),s(u,"alt",f=e[0][e[1]].title),s(t,"class","img-legend-wrapper column is-flex is-flex-direction-column is-justify-content-center is-align-items-center")},m(e,n){r(e,t,n),l(t,a),l(a,m),l(t,c),l(t,u),l(t,$)},p(e,t){1&t&&!i(u.src,p=e[0][e[1]].href)&&s(u,"src",p),1&t&&f!==(f=e[0][e[1]].title)&&s(u,"alt",f)},d(e){e&&o(t)}}}function N(e){let t,a=["queryImage","similarityImage"],i=[];for(let t=0;t<2;t+=1)i[t]=P(K(e,a,t));return{c(){t=n("div");for(let e=0;e<2;e+=1)i[e].c();s(t,"class","side-by-side columns")},m(e,a){r(e,t,a);for(let e=0;e<2;e+=1)i[e]&&i[e].m(t,null)},p(e,[n]){if(1&n){let s;for(a=["queryImage","similarityImage"],s=0;s<2;s+=1){const r=K(e,a,s);i[s]?i[s].p(r,n):(i[s]=P(r),i[s].c(),i[s].m(t,null))}for(;s<2;s+=1)i[s].d(1)}},i:m,o:m,d(e){e&&o(t),q(i,e)}}}function W(e,t,a){let{imgData:n}=t;return e.$$set=e=>{"imgData"in e&&a(0,n=e.imgData)},[n]}class X extends e{constructor(e){super(),t(this,e,W,N,a,{imgData:0})}}function Y(e){let t,a;return t=new X({props:{imgData:e[1]}}),{c(){f(t.$$.fragment)},m(e,n){y(t,e,n),a=!0},p:m,i(e){a||(h(t.$$.fragment,e),a=!0)},o(e){w(t.$$.fragment,e),a=!1},d(e){x(t,e)}}}function _(e){let t,a;return t=new J({props:{imgData:e[1]}}),{c(){f(t.$$.fragment)},m(e,n){y(t,e,n),a=!0},p:m,i(e){a||(h(t.$$.fragment,e),a=!0)},o(e){w(t.$$.fragment,e),a=!1},d(e){x(t,e)}}}function ee(e){let t,a,i,m,c,u,p,$,v;const I=[_,Y],b=[];function C(e,t){return e[0]?0:1}return i=C(e),m=b[i]=I[i](e),$=new V({props:{start:!1,buttonDisplay:!0,checkboxLabel:"en"===g?"Overlay view":"Vue superposée"}}),$.$on("updateChecked",e[2]),{c(){t=n("div"),a=n("div"),m.c(),u=d(),p=n("div"),f($.$$.fragment),s(a,"class",c="modal-similarity-images "+(e[0]?"overlay-wrapper":"side-by-side-wrapper")+" svelte-1qvtan5"),s(t,"class","modal-similarity svelte-1qvtan5")},m(e,n){r(e,t,n),l(t,a),b[i].m(a,null),l(t,u),l(t,p),y($,p,null),v=!0},p(e,[t]){let n=i;i=C(e),i===n?b[i].p(e,t):(D(),w(b[n],1,1,(()=>{b[n]=null})),M(),m=b[i],m?m.p(e,t):(m=b[i]=I[i](e),m.c()),h(m,1),m.m(a,null)),(!v||1&t&&c!==(c="modal-similarity-images "+(e[0]?"overlay-wrapper":"side-by-side-wrapper")+" svelte-1qvtan5"))&&s(a,"class",c)},i(e){v||(h(m),h($.$$.fragment,e),v=!0)},o(e){w(m),w($.$$.fragment,e),v=!1},d(e){e&&o(t),b[i].d(),x($)}}}function te(e,t,a){let{mainImg:n}=t,{compareImg:i}=t;const s={similarityImage:{href:c(n),title:l(n)},queryImage:{href:c(i),title:l(i)}};let r=!1;function l(e){return"fr"===g?`Vue principale de la région ${e}`:`Main view of region ${e}`}return e.$$set=e=>{"mainImg"in e&&a(3,n=e.mainImg),"compareImg"in e&&a(4,i=e.compareImg)},[r,s,()=>a(0,r=!r),n,i]}class ae extends e{constructor(e){super(),t(this,e,te,ee,a,{mainImg:3,compareImg:4})}}function ne(e){let t,a,i,m,c,u;return c=new S({props:{qImg:e[0]}}),{c(){t=n("div"),a=n("a"),i=n("button"),i.textContent=""+("fr"===g?"Voir toutes les similarités pour ce document":"View all similarities for this document"),m=d(),f(c.$$.fragment),s(i,"class","button is-link"),s(a,"href",e[1]),s(t,"class","is-flex is-align-items-center is-justify-content-end")},m(e,n){r(e,t,n),l(t,a),l(a,i),r(e,m,n),y(c,e,n),u=!0},p(e,[t]){const a={};1&t&&(a.qImg=e[0]),c.$set(a)},i(e){u||(h(c.$$.fragment,e),u=!0)},o(e){w(c.$$.fragment,e),u=!1},d(e){e&&o(t),e&&o(m),x(c,e)}}}function ie(e,t,a){let{mainImg:n}=t;const i=n.match(/wit(\d+)/)[1],s=function(){const e=new URL(window.location.origin);return e.pathname=`${new URL(window.location).pathname.split("/")[1]}/witness/${i}/regions/`,e.searchParams.set("tab","similarity"),console.log(e),e.href}();return e.$$set=e=>{"mainImg"in e&&a(0,n=e.mainImg)},[n,s]}class se extends e{constructor(e){super(),t(this,e,ie,ne,a,{mainImg:0})}}function re(e,t,a){const n=e.slice();return n[12]=t[a].id,n[13]=t[a].label,n}function le(e){let t,a,i,m,c,u,g,p=e[13]+"";function f(){return e[8](e[12])}return{c(){t=n("li"),a=n("a"),i=k(p),m=d(),s(a,"href",""),s(t,"class",c=e[12]===e[2]?"is-active":"")},m(e,n){r(e,t,n),l(t,a),l(a,i),l(t,m),u||(g=I(a,"click",B(f)),u=!0)},p(a,n){e=a,4&n&&c!==(c=e[12]===e[2]?"is-active":"")&&s(t,"class",c)},d(e){e&&o(t),u=!1,g()}}}function me(e){let t,a,i,m,c,u,g,p,v,b,C,k,V,S,O,T=e[3],j=[];for(let t=0;t<T.length;t+=1)j[t]=le(re(e,T,t));const B=[e[1][e[2]]||{}];var E=e[0][e[2]]||null;function F(e){let t={};for(let e=0;e<B.length;e+=1)t=R(t,B[e]);return{props:t}}return E&&(b=U(E,F())),{c(){t=n("div"),a=n("div"),i=d(),m=n("div"),c=n("div"),u=n("div"),g=n("ul");for(let e=0;e<j.length;e+=1)j[e].c();p=d(),v=n("div"),b&&f(b.$$.fragment),C=d(),k=n("button"),s(a,"class","modal-background"),s(u,"class","tabs is-centered"),s(v,"class","ml-4 mr-4 modal-main-wrapper svelte-cxz52m"),$(v,"pb-4","main"===e[2]),s(c,"class","modal-inner svelte-cxz52m"),s(m,"class","modal-content svelte-cxz52m"),s(k,"class","modal-close is-large"),s(k,"aria-label","close"),s(t,"id","region-modal-wrapper"),s(t,"class","modal is-active")},m(n,s){r(n,t,s),l(t,a),l(t,i),l(t,m),l(m,c),l(c,u),l(u,g);for(let e=0;e<j.length;e+=1)j[e]&&j[e].m(g,null);l(c,p),l(c,v),b&&y(b,v,null),l(t,C),l(t,k),V=!0,S||(O=I(k,"click",e[5]),S=!0)},p(e,[t]){if(28&t){let a;for(T=e[3],a=0;a<T.length;a+=1){const n=re(e,T,a);j[a]?j[a].p(n,t):(j[a]=le(n),j[a].c(),j[a].m(g,null))}for(;a<j.length;a+=1)j[a].d(1);j.length=T.length}const a=6&t?L(B,[z(e[1][e[2]]||{})]):{};if(5&t&&E!==(E=e[0][e[2]]||null)){if(b){D();const e=b;w(e.$$.fragment,1,0,(()=>{x(e,1)})),M()}E?(b=U(E,F()),f(b.$$.fragment),h(b.$$.fragment,1),y(b,v,null)):b=null}else E&&b.$set(a);(!V||4&t)&&$(v,"pb-4","main"===e[2])},i(e){V||(b&&h(b.$$.fragment,e),V=!0)},o(e){b&&w(b.$$.fragment,e),V=!1},d(e){e&&o(t),q(j,e),b&&x(b),S=!1,O()}}}function oe(e,t,a){let n,{mainImg:i}=t,{compareImg:s}=t;const r=O(),l=i&&s?["main","similarity","expansion"]:["main"],m=l.map((e=>({id:e,label:"expansion"===e&&"fr"===g?"Expansion de requête":"expansion"===e&&"en"===g?"Query expansion":"similarity"===e&&"fr"===g?"Similarité":"similarity"===e&&"en"===g?"Similarity":"main"===e&&"fr"===g?"Vue principale":"Main view"}))),o={};l.map((e=>a(0,o[e]="expansion"===e?se:"similarity"===e?ae:Q,o)));const c={};l.map((e=>a(1,c[e]="expansion"===e||"similarity"===e?{compareImg:s,mainImg:i}:{mainImg:i},c)));const u=e=>a(2,n=e),p=e=>{"Escape"===key&&r("closeModal")};T((()=>{document.addEventListener("keyup",p)})),j((()=>{document.removeEventListener("keydown",p)}));return e.$$set=e=>{"mainImg"in e&&a(6,i=e.mainImg),"compareImg"in e&&a(7,s=e.compareImg)},a(2,n=l[0]),[o,c,n,m,u,e=>r("closeModal"),i,s,e=>u(e)]}class ce extends e{constructor(e){super(),t(this,e,oe,me,a,{mainImg:6,compareImg:7})}}function ue(e){let t,a,i,c,u,g,p,$,v,b,C;return a=new E({props:{targetHtmlId:e[0],tooltipText:e[1]}}),{c(){t=n("div"),f(a.$$.fragment),i=d(),c=n("button"),u=F("svg"),g=F("path"),p=F("path"),$=F("path"),s(g,"d","M53.6443 14.25C47.7042 5.33 37.7293 0 26.9801 0C16.2206 0 6.24576 5.33 0.305653 14.25L0 14.71L0.305653 15.17C6.24576 24.09 16.2206 29.42 26.9801 29.42C37.7293 29.42 47.7042 24.09 53.6443 15.16L53.95 14.71L53.6443 14.25ZM3.25025 14.71C7.63146 8.69001 14.0606 4.65 21.2641 3.22C20.0619 3.83 18.9411 4.62 17.963 5.59C15.5176 8.02 14.1625 11.25 14.1625 14.67C14.1625 18.11 15.5176 21.34 17.963 23.76C19.0124 24.79 20.1943 25.61 21.4781 26.23C14.1829 24.85 7.6824 20.78 3.25025 14.71ZM27.1125 22.64C22.7008 22.64 19.1041 19.08 19.1041 14.7C19.1041 12.59 19.9396 10.6 21.4475 9.10001C22.9555 7.60001 24.9729 6.77 27.1125 6.77C29.2522 6.77 31.2594 7.60001 32.7775 9.10001C34.2855 10.6 35.121 12.59 35.121 14.7C35.121 16.82 34.2855 18.82 32.7775 20.32C31.2594 21.81 29.242 22.64 27.1125 22.64ZM32.9915 26.14C34.204 25.53 35.3146 24.74 36.3029 23.77C38.7482 21.34 40.0932 18.11 40.0932 14.68C40.0932 9.75 37.281 5.47001 33.1647 3.32001C40.1747 4.81001 46.4102 8.83001 50.6896 14.71C46.3797 20.64 40.0728 24.67 32.9915 26.14Z"),s(g,"fill","black"),s(g,"class","svelte-19wutme"),s(p,"d","M26.9804 25.98C33.3222 25.98 38.4633 20.9343 38.4633 14.71C38.4633 8.48576 33.3222 3.44 26.9804 3.44C20.6386 3.44 15.4976 8.48576 15.4976 14.71C15.4976 20.9343 20.6386 25.98 26.9804 25.98Z"),s(p,"fill","black"),s(p,"class","svelte-19wutme"),s($,"d","M17.9529 23.85L36.2928 5.85001"),s($,"stroke","black"),s($,"stroke-width","3"),s($,"stroke-miterlimit","10"),s($,"class","svelte-19wutme"),s(u,"width","54"),s(u,"height","30"),s(u,"viewBox","0 0 54 30"),s(u,"fill","none"),s(u,"xmlns","http://www.w3.org/2000/svg"),s(u,"class","svelte-19wutme"),s(c,"class","button tag svelte-19wutme"),s(c,"title",e[1]),s(t,"id",e[0])},m(n,s){r(n,t,s),y(a,t,null),l(t,i),l(t,c),l(c,u),l(u,g),l(u,p),l(u,$),v=!0,b||(C=I(c,"click",e[2]),b=!0)},p:m,i(e){v||(h(a.$$.fragment,e),v=!0)},o(e){w(a.$$.fragment,e),v=!1},d(e){e&&o(t),x(a),b=!1,C()}}}function ge(e,t,a){let n,i,{mainImg:s}=t,{compareImg:r}=t;C("isInModal",!0);const l=`modal-opener-${window.crypto.randomUUID()}`,m="fr"===g?"Vue détaillée":"Detailed view",o=()=>a(5,n=!1);return e.$$set=e=>{"mainImg"in e&&a(3,s=e.mainImg),"compareImg"in e&&a(4,r=e.compareImg)},e.$$.update=()=>{var t,l;96&e.$$.dirty&&a(6,(l=i,(t=n)?(l=new ce({target:document.querySelector("body"),props:{mainImg:s,compareImg:r}})).$on("closeModal",o):t||null==i||l.$destroy(),i=l))},a(5,n=!1),[l,m,()=>a(5,n=!n),s,r,n,i]}class pe extends e{constructor(e){super(),t(this,e,ge,ue,a,{mainImg:3,compareImg:4})}}export{pe as default};
//# sourceMappingURL=ModalController-1dc0de0e.js.map
