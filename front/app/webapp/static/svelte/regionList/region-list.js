function N(){}const qr=t=>t;function oo(t,e){for(const i in e)t[i]=e[i];return t}function lo(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function Kr(t){return t()}function En(){return Object.create(null)}function Ie(t){t.forEach(Kr)}function Gt(t){return typeof t=="function"}function le(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Zt;function it(t,e){return Zt||(Zt=document.createElement("a")),Zt.href=e,t===Zt.href}function ao(t){return Object.keys(t).length===0}function Ji(t,...e){if(t==null)return N;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function Xi(t){let e;return Ji(t,i=>e=i)(),e}function re(t,e,i){t.$$.on_destroy.push(Ji(e,i))}function ut(t,e,i,n){if(t){const r=Gr(t,e,i,n);return t[0](r)}}function Gr(t,e,i,n){return t[1]&&n?oo(i.ctx.slice(),t[1](n(e))):i.ctx}function ft(t,e,i,n){if(t[2]&&n){const r=t[2](n(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function dt(t,e,i,n,r,s){if(r){const o=Gr(e,i,n,s);t.p(o,r)}}function ht(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function ei(t){return t??""}function oi(t){return t&&Gt(t.destroy)?t.destroy:N}const Wr=typeof window<"u";let co=Wr?()=>window.performance.now():()=>Date.now(),Qi=Wr?t=>requestAnimationFrame(t):N;const It=new Set;function Yr(t){It.forEach(e=>{e.c(t)||(It.delete(e),e.f())}),It.size!==0&&Qi(Yr)}function uo(t){let e;return It.size===0&&Qi(Yr),{promise:new Promise(i=>{It.add(e={c:t,f:i})}),abort(){It.delete(e)}}}function b(t,e){t.appendChild(e)}function Jr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function fo(t){const e=w("style");return ho(Jr(t),e),e.sheet}function ho(t,e){return b(t.head||t,e),e.sheet}function C(t,e,i){t.insertBefore(e,i||null)}function k(t){t.parentNode&&t.parentNode.removeChild(t)}function mi(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function w(t){return document.createElement(t)}function Ke(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Y(t){return document.createTextNode(t)}function x(){return Y(" ")}function he(){return Y("")}function oe(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function yt(t){return function(e){return e.preventDefault(),t.call(this,e)}}function p(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function po(t){return Array.from(t.childNodes)}function de(t,e){e=""+e,t.data!==e&&(t.data=e)}function li(t,e){t.value=e??""}function kt(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}function xe(t,e,i){t.classList[i?"add":"remove"](e)}function Xr(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,n,e),r}class mo{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=Ke(i.nodeName):this.e=w(i.nodeType===11?"TEMPLATE":i.nodeName),this.t=i.tagName!=="TEMPLATE"?i:i.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)C(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(k)}}function kn(t,e){return new t(e)}const ai=new Map;let ci=0;function go(t){let e=5381,i=t.length;for(;i--;)e=(e<<5)-e^t.charCodeAt(i);return e>>>0}function _o(t,e){const i={stylesheet:fo(e),rules:{}};return ai.set(t,i),i}function Cn(t,e,i,n,r,s,o,l=0){const a=16.666/n;let c=`{
`;for(let v=0;v<=1;v+=a){const y=e+(i-e)*s(v);c+=v*100+`%{${o(y,1-y)}}
`}const u=c+`100% {${o(i,1-i)}}
}`,f=`__svelte_${go(u)}_${l}`,d=Jr(t),{stylesheet:h,rules:m}=ai.get(d)||_o(d,t);m[f]||(m[f]=!0,h.insertRule(`@keyframes ${f} ${u}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${n}ms linear ${r}ms 1 both`,ci+=1,f}function vo(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),r=i.length-n.length;r&&(t.style.animation=n.join(", "),ci-=r,ci||bo())}function bo(){Qi(()=>{ci||(ai.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&k(e)}),ai.clear())})}let qt;function et(t){qt=t}function Rt(){if(!qt)throw new Error("Function called outside component initialization");return qt}function Mt(t){Rt().$$.on_mount.push(t)}function Zi(t){Rt().$$.on_destroy.push(t)}function en(){const t=Rt();return(e,i,{cancelable:n=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=Xr(e,i,{cancelable:n});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function Ze(t,e){return Rt().$$.context.set(t,e),e}function Ce(t){return Rt().$$.context.get(t)}const Et=[],Fi=[];let At=[];const In=[],yo=Promise.resolve();let Vi=!1;function wo(){Vi||(Vi=!0,yo.then(tn))}function Ge(t){At.push(t)}const Ri=new Set;let wt=0;function tn(){if(wt!==0)return;const t=qt;do{try{for(;wt<Et.length;){const e=Et[wt];wt++,et(e),So(e.$$)}}catch(e){throw Et.length=0,wt=0,e}for(et(null),Et.length=0,wt=0;Fi.length;)Fi.pop()();for(let e=0;e<At.length;e+=1){const i=At[e];Ri.has(i)||(Ri.add(i),i())}At.length=0}while(Et.length);for(;In.length;)In.pop()();Vi=!1,Ri.clear(),et(t)}function So(t){if(t.fragment!==null){t.update(),Ie(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ge)}}function Eo(t){const e=[],i=[];At.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),At=e}let Vt;function ko(){return Vt||(Vt=Promise.resolve(),Vt.then(()=>{Vt=null})),Vt}function Mi(t,e,i){t.dispatchEvent(Xr(`${e?"intro":"outro"}${i}`))}const ri=new Set;let tt;function ve(){tt={r:0,c:[],p:tt}}function be(){tt.r||Ie(tt.c),tt=tt.p}function P(t,e){t&&t.i&&(ri.delete(t),t.i(e))}function M(t,e,i,n){if(t&&t.o){if(ri.has(t))return;ri.add(t),tt.c.push(()=>{ri.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const Co={duration:0};function Ue(t,e,i,n){const r={direction:"both"};let s=e(t,i,r),o=n?0:1,l=null,a=null,c=null;function u(){c&&vo(t,c)}function f(h,m){const g=h.b-o;return m*=Math.abs(g),{a:o,b:h.b,d:g,duration:m,start:h.start,end:h.start+m,group:h.group}}function d(h){const{delay:m=0,duration:g=300,easing:v=qr,tick:y=N,css:E}=s||Co,T={start:co()+m,b:h};h||(T.group=tt,tt.r+=1),l||a?a=T:(E&&(u(),c=Cn(t,o,h,g,m,v,E)),h&&y(0,1),l=f(T,g),Ge(()=>Mi(t,h,"start")),uo(H=>{if(a&&H>a.start&&(l=f(a,g),a=null,Mi(t,l.b,"start"),E&&(u(),c=Cn(t,o,l.b,l.duration,0,v,s.css))),l){if(H>=l.end)y(o=l.b,1-o),Mi(t,l.b,"end"),a||(l.b?u():--l.group.r||Ie(l.group.c)),l=null;else if(H>=l.start){const F=H-l.start;o=l.a+l.d*v(F/l.duration),y(o,1-o)}}return!!(l||a)}))}return{run(h){Gt(s)?ko().then(()=>{s=s(r),d(h)}):d(h)},end(){u(),l=a=null}}}function nt(t,e){const i=e.token={};function n(r,s,o,l){if(e.token!==i)return;e.resolved=l;let a=e.ctx;o!==void 0&&(a=a.slice(),a[o]=l);const c=r&&(e.current=r)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((f,d)=>{d!==s&&f&&(ve(),M(f,1,1,()=>{e.blocks[d]===f&&(e.blocks[d]=null)}),be())}):e.block.d(1),c.c(),P(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[s]=c),u&&tn()}if(lo(t)){const r=Rt();if(t.then(s=>{et(r),n(e.then,1,e.value,s),et(null)},s=>{if(et(r),n(e.catch,2,e.error,s),et(null),!e.hasCatch)throw s}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function Dt(t,e,i){const n=e.slice(),{resolved:r}=t;t.current===t.then&&(n[t.value]=r),t.current===t.catch&&(n[t.error]=r),t.block.p(n,i)}function Wt(t,e){M(t,1,1,()=>{e.delete(t.key)})}function Yt(t,e,i,n,r,s,o,l,a,c,u,f){let d=t.length,h=s.length,m=d;const g={};for(;m--;)g[t[m].key]=m;const v=[],y=new Map,E=new Map,T=[];for(m=h;m--;){const L=f(r,s,m),I=i(L);let O=o.get(I);O?n&&T.push(()=>O.p(L,e)):(O=c(I,L),O.c()),y.set(I,v[m]=O),I in g&&E.set(I,Math.abs(m-g[I]))}const H=new Set,F=new Set;function B(L){P(L,1),L.m(l,u),o.set(L.key,L),u=L.first,h--}for(;d&&h;){const L=v[h-1],I=t[d-1],O=L.key,q=I.key;L===I?(u=L.first,d--,h--):y.has(q)?!o.has(O)||H.has(O)?B(L):F.has(q)?d--:E.get(O)>E.get(q)?(F.add(O),B(L)):(H.add(q),d--):(a(I,o),d--)}for(;d--;){const L=t[d];y.has(L.key)||a(L,o)}for(;h;)B(v[h-1]);return Ie(T),v}function yd(t,e){const i={},n={},r={$$scope:1};let s=t.length;for(;s--;){const o=t[s],l=e[s];if(l){for(const a in o)a in l||(n[a]=1);for(const a in l)r[a]||(i[a]=l[a],r[a]=1);t[s]=l}else for(const a in o)r[a]=1}for(const o in n)o in i||(i[o]=void 0);return i}function wd(t){return typeof t=="object"&&t!==null?t:{}}function Z(t){t&&t.c()}function X(t,e,i,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,i),n||Ge(()=>{const o=t.$$.on_mount.map(Kr).filter(Gt);t.$$.on_destroy?t.$$.on_destroy.push(...o):Ie(o),t.$$.on_mount=[]}),s.forEach(Ge)}function Q(t,e){const i=t.$$;i.fragment!==null&&(Eo(i.after_update),Ie(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function Io(t,e){t.$$.dirty[0]===-1&&(Et.push(t),wo(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ce(t,e,i,n,r,s,o,l=[-1]){const a=qt;et(t);const c=t.$$={fragment:null,ctx:[],props:s,update:N,not_equal:r,bound:En(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:En(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(c.root);let u=!1;if(c.ctx=i?i(t,e.props||{},(f,d,...h)=>{const m=h.length?h[0]:d;return c.ctx&&r(c.ctx[f],c.ctx[f]=m)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](m),u&&Io(t,f)),d}):[],c.update(),u=!0,Ie(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const f=po(e.target);c.fragment&&c.fragment.l(f),f.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&P(t.$$.fragment),X(t,e.target,e.anchor,e.customElement),tn()}et(a)}class ue{$destroy(){Q(this,1),this.$destroy=N}$on(e,i){if(!Gt(i))return N;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!ao(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Ao(t){const e=t-1;return e*e*e+1}function Xe(t,{delay:e=0,duration:i=400,easing:n=qr}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:s=>`opacity: ${s*r}`}}function An(t,{delay:e=0,duration:i=400,easing:n=Ao,axis:r="y"}={}){const s=getComputedStyle(t),o=+s.opacity,l=r==="y"?"height":"width",a=parseFloat(s[l]),c=r==="y"?["top","bottom"]:["left","right"],u=c.map(y=>`${y[0].toUpperCase()}${y.slice(1)}`),f=parseFloat(s[`padding${u[0]}`]),d=parseFloat(s[`padding${u[1]}`]),h=parseFloat(s[`margin${u[0]}`]),m=parseFloat(s[`margin${u[1]}`]),g=parseFloat(s[`border${u[0]}Width`]),v=parseFloat(s[`border${u[1]}Width`]);return{delay:e,duration:i,easing:n,css:y=>`overflow: hidden;opacity: ${Math.min(y*20,1)*o};${l}: ${y*a}px;padding-${c[0]}: ${y*f}px;padding-${c[1]}: ${y*d}px;margin-${c[0]}: ${y*h}px;margin-${c[1]}: ${y*m}px;border-${c[0]}-width: ${y*g}px;border-${c[1]}-width: ${y*v}px;`}}const St=[];function Oo(t,e){return{subscribe:we(t,e).subscribe}}function we(t,e=N){let i;const n=new Set;function r(l){if(le(t,l)&&(t=l,i)){const a=!St.length;for(const c of n)c[1](),St.push(c,t);if(a){for(let c=0;c<St.length;c+=2)St[c][0](St[c+1]);St.length=0}}}function s(l){r(l(t))}function o(l,a=N){const c=[l,a];return n.add(c),n.size===1&&(i=e(r)||N),l(t),()=>{n.delete(c),n.size===0&&i&&(i(),i=null)}}return{set:r,update:s,subscribe:o}}function Fe(t,e,i){const n=!Array.isArray(t),r=n?[t]:t,s=e.length<2;return Oo(i,o=>{let l=!1;const a=[];let c=0,u=N;const f=()=>{if(c)return;u();const h=e(n?a[0]:a,o);s?o(h):u=Gt(h)?h:N},d=r.map((h,m)=>Ji(h,g=>{a[m]=g,c&=~(1<<m),l&&f()},()=>{c|=1<<m}));return l=!0,f(),function(){Ie(d),u(),l=!1}})}const j=APP_LANG,De=APP_NAME;WEBAPP_NAME;const Di=USER_ID;IS_SUPERUSER;ADD_PERMISSION;const He=CSRF_TOKEN,Ot=ADDITIONAL_MODULES,xi="Region";APP_URL;const To=SAS_APP_URL;CANTALOUPE_APP_URL;const Po=MEDIA_PATH,Lo=PAGE_LEN,Tt=we(!1),Qr=we(""),Ro=t=>typeof t=="string"||t instanceof String;async function Pt(t){Tt.set(!0);try{return await t()}finally{Tt.set(!1)}}function Zr(t){return t.match(/\d+/g).toString()}function Mo(t){return parseInt(Zr(t),10)}function es(t,e=100){const i=Math.floor(e*.75);return t.length>e?t.slice(0,i)+"..."+t.slice(-e+i):t}function Do(){return"https://vhs.huma-num.fr"}function No(){return To??"http://localhost:8888"}function nn(t,e){if(typeof window<"u"){const i=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(i))return t.set(i),i}return t.set(1),1}function rn(t,e,i){if(e.set(t),typeof window<"u"){const n=new URL(window.location.href);n.searchParams.set(i,t),window.history.pushState({},"",n)}}function $o(t=null){return t=t.split("_"),t.length<3?void 0:`${t.slice(0,3).join("_").replace(".jpg","")}.jpg`}function ts(t=null){const e=$o(t);return e===void 0?void 0:`${Do()}/iiif/2/${e}`}function at(t=null,e=null,i="full"){if(e=Ro(e)?e.replace(".jpg",""):e,!t)return"https://placehold.co/96x96/png?text=No+image";const n=ts(t);if(n===void 0)return"https://placehold.co/96x96/png?text=No+image";const r=t.split("_");return e||(e=r[r.length-1].includes(",")?r.pop().replace(".jpg",""):"full"),`${n}/${e}/${i}/0/default.jpg`}function Sd(t=null){return`${ts(t)}/info.json`}function ui(t=null,e=1){return`${No()}/index.html?iiif-content=${t}&canvas=${e}`}function Te(t,e=null,i=!1){return new Promise(n=>{if(document.getElementById("msg-modal")){i?document.getElementById("modal-footer").hidden=!1:n(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=t,document.getElementById("hidden-msg-btn").click();const s=document.getElementById("cancel-btn"),o=document.getElementById("ok-btn"),l=document.getElementById("modal-bkg"),a=()=>{s.removeEventListener("click",c),l.removeEventListener("click",c),o.removeEventListener("click",u),document.getElementById("modal-footer").hidden=!0},c=()=>{a(),n(!1)},u=()=>{a(),n(!0)};s.addEventListener("click",c),o.addEventListener("click",u)}else i?n(window.confirm(t)):(window.alert(t),n(void 0))})}function is(t,e){const i=window.URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=`${e}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(i),document.body.removeChild(n)}function fi(){let t,e,i=(n,r)=>n===r;return{set:n=>{e=t,t=n},setCompareFn:n=>i=n,get:()=>t,getNewAndOld:()=>[t,e],same:()=>i(t,e)}}const sn=(t,e)=>Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((i,n)=>i===e[n]||void 0);function ns(t=null){return t<600?1:t<800?2:t<1e3?3:t<1200?4:t<1400?5:t>=1400?6:4}function rs(t){const e=t.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),i=()=>t.classList.remove("is-active");e.forEach(r=>r.addEventListener("click",i));const n=r=>{r.key==="Escape"&&t.classList.contains("is-active")&&i()};return document.addEventListener("keydown",n),{destroy(){e.forEach(r=>r.removeEventListener("click",i)),document.removeEventListener("keydown",n)}}}function ss(t){const e=()=>{const i=document.getElementById(t.dataset.target);i==null||i.classList.add("is-active")};return t.addEventListener("click",e),{destroy(){t.removeEventListener("click",e)}}}function on(t){const{type:e,modelName:i,title:n,extractMeta:r=h=>h}=t,s={id:null,type:e,title:n,selected:{}},o=JSON.parse(localStorage.getItem(e))||s,l=we(o),a=we(!1);function c(h,m=!1){a.set(m),localStorage.setItem(e,JSON.stringify(h))}function u(){l.update(h=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),h;const m=Object.fromEntries(Object.entries(h.selected).map(([v,y])=>[v,Object.keys(y)])),g=h.id?`${h.id}/edit`:"new";return fetch(`${window.location.origin}/${i}/${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":He},body:JSON.stringify({title:h.title,selection:h,...m})}).then(v=>v.json()).then(v=>{if(!(v!=null&&v.document_set_id))throw new Error("Failed to save");l.update(y=>(y.id=v.document_set_id,y.title=v.document_set_title,c(y,!0),y))}).catch(v=>console.error("Error:",v)),h})}const f=h=>l.update(()=>{const m=h.selection.id?h.selection:{...h.selection,id:h.id};return c(m),m}),d=()=>l.update(()=>{const h={...s,selected:{}};return c(h),h});return{type:e,subscribe:l.subscribe,add:h=>l.update(m=>(m.selected[h.class]={...m.selected[h.class]||{},[h.id]:r(h)},c(m),m)),addAll:h=>l.update(m=>(h.forEach(g=>{m.selected[g.class]={...m.selected[g.class]||{},[g.id]:r(g)}}),c(m),m)),remove:(h,m)=>l.update(g=>{const{[h]:v,...y}=g.selected[m];return g.selected[m]=y,c(g),g}),removeAll:(h,m)=>l.update(g=>(h.forEach(v=>{var y;return(y=g.selected[m])==null?!0:delete y[v]}),c(g),g)),toggle:h=>l.update(m=>{var g;if((g=m.selected[h.class])!=null&&g[h.id]){const{[h.id]:v,...y}=m.selected[h.class];m.selected[h.class]=y}else m.selected[h.class]={...m.selected[h.class]||{},[h.id]:r(h)};return c(m),m}),toggleSet:h=>{Xi(l).id===h.id?d():f(h)},empty:()=>l.update(h=>(h.id=null,h.title=n,h.selected={},c(h,!0),h)),updateTitle:h=>l.update(m=>(m.title=h,c(m,!0),m)),save:u,isSaved:a,selection:l,selectionTitle:Fe(l,h=>h.title),isSelected:Fe(l,h=>m=>{var g;return((g=h.selected[m.class])==null?void 0:g[m.id])||!1}),selected:Fe(l,h=>h.selected),nbSelected:Fe(l,h=>Object.values(h.selected).reduce((m,g)=>m+Object.keys(g).length,0)),isSetSelected:Fe(l,h=>m=>h.id===m.id)}}on({type:"documentSet",modelName:"document-set",title:j==="en"?"Document set":"Set de documents",extractMeta:t=>({title:t.title,url:t.url})});const vt=on({type:"regionsSet",modelName:"regions-set",title:j==="en"?"Regions set":"Set de régions",extractMeta:t=>t});on({type:"clusterSet",modelName:"cluster-set",title:j==="en"?"Selected regions":"Régions sélectionnées",extractMeta:t=>({imgRef:t.id,clusterId:t.clusterId,title:t.title,xywh:t.xywh,img:t.img})});function jo(){const t=`${window.location.origin}${window.location.pathname}`,e=we(1),i=we({}),n=we({}),r=we("");nn(e,"p");function s(u){r.update(f=>{const d=f===u?"":u;return navigator.clipboard.writeText(d).then(h=>""),d})}const o=(async()=>{try{const u=await fetch(`${t}canvas`);if(!u.ok)return{};const f=await u.json();let d={};return Object.values(f).forEach(h=>{Object.entries(h).forEach(([m,g])=>{d[m]=g})}),i.set(d),f}catch{return{}}})(),l=Fe(e,u=>(async()=>{const d=await(await fetch(`${t}canvas?p=${u}`)).json();return n.set(d),d})());function a(u){rn(u,e,"p")}function c(u){i.update(f=>(delete f[u],{...f})),n.update(f=>{for(const d in f)if(f[d][u]){const{[u]:h,...m}=f[d];return f[d]=m,f}return f})}return{currentPage:e,pageRegions:n,allRegions:i,fetchPages:l,fetchAll:o,handlePageUpdate:a,remove:c,clipBoard:r,copyRef:s}}const ct=jo();function On(t){let e,i,n;return{c(){e=w("div"),e.innerHTML='<div class="loader svelte-vizlcg"></div>',p(e,"class","bkg-shade svelte-vizlcg")},m(r,s){C(r,e,s),n=!0},i(r){n||(Ge(()=>{n&&(i||(i=Ue(e,Xe,{duration:150},!0)),i.run(1))}),n=!0)},o(r){i||(i=Ue(e,Xe,{duration:150},!1)),i.run(0),n=!1},d(r){r&&k(e),r&&i&&i.end()}}}function Fo(t){let e,i,n=t[0]&&On();return{c(){n&&n.c(),e=he()},m(r,s){n&&n.m(r,s),C(r,e,s),i=!0},p(r,[s]){r[0]?n?s&1&&P(n,1):(n=On(),n.c(),P(n,1),n.m(e.parentNode,e)):n&&(ve(),M(n,1,1,()=>{n=null}),be())},i(r){i||(P(n),i=!0)},o(r){M(n),i=!1},d(r){n&&n.d(r),r&&k(e)}}}function Vo(t,e,i){let n;return re(t,Tt,r=>i(0,n=r)),[n]}class xo extends ue{constructor(e){super(),ce(this,e,Vo,Fo,le,{})}}const Uo="modulepreload",Ho=function(t){return"/"+t},Tn={},Bo=function(e,i,n){if(!i||i.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=Ho(s),s in Tn)return;Tn[s]=!0;const o=s.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!n)for(let u=r.length-1;u>=0;u--){const f=r[u];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Uo,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function zo(t){let e;return{c(){e=Ke("path"),p(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),p(e,"class","svelte-1829hp2")},m(i,n){C(i,e,n)},d(i){i&&k(e)}}}function qo(t){let e;return{c(){e=Ke("path"),p(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),p(e,"class","svelte-1829hp2")},m(i,n){C(i,e,n)},d(i){i&&k(e)}}}function Ko(t){let e=j==="en"?"Copy ID":"Copier l'ID",i;return{c(){i=Y(e)},m(n,r){C(n,i,r)},p:N,d(n){n&&k(i)}}}function Go(t){let e=j==="en"?"Copied!":"Copié !",i;return{c(){i=Y(e)},m(n,r){C(n,i,r)},p:N,d(n){n&&k(i)}}}function Pn(t){let e,i,n;var r=t[7];function s(o){return{props:{mainImgItem:o[1],compareImgItem:o[14]}}}return r&&(e=kn(r,s(t))),{c(){e&&Z(e.$$.fragment),i=he()},m(o,l){e&&X(e,o,l),C(o,i,l),n=!0},p(o,l){const a={};if(l&2&&(a.mainImgItem=o[1]),l&128&&r!==(r=o[7])){if(e){ve();const c=e;M(c.$$.fragment,1,0,()=>{Q(c,1)}),be()}r?(e=kn(r,s(o)),Z(e.$$.fragment),P(e.$$.fragment,1),X(e,i.parentNode,i)):e=null}else r&&e.$set(a)},i(o){n||(e&&P(e.$$.fragment,o),n=!0)},o(o){e&&M(e.$$.fragment,o),n=!1},d(o){o&&k(i),e&&Q(e,o)}}}function Wo(t){let e,i,n,r,s,o,l,a,c,u,f,d,h,m,g,v,y,E,T,H,F,B,L;function I(z,U){return z[8]?qo:zo}let O=I(t),q=O(t);function R(z,U){return z[8]?Go:Ko}let D=R(t),$=D(t),W=t[7]&&Pn(t);return{c(){e=w("div"),i=w("figure"),n=w("img"),s=x(),o=w("div"),l=w("span"),u=x(),f=w("div"),d=w("button"),h=Ke("svg"),q.c(),m=x(),g=w("span"),$.c(),y=x(),W&&W.c(),p(n,"class","region-img svelte-1829hp2"),it(n.src,r=t[9])||p(n,"src",r),p(n,"alt","Extracted region"),p(l,"class","overlay-desc"),p(o,"class","overlay is-center svelte-1829hp2"),p(i,"class",a="image card region-image "+(t[0]?"is-96x96":"")+" svelte-1829hp2"),p(i,"tabindex","-1"),p(i,"style",c=(t[2]==="full"?"height: 100%":`height: ${t[2]}px; min-width: ${t[2]}px`)+"; "+(t[3]?`border: 5px solid ${t[3]};`:"")),p(h,"xmlns","http://www.w3.org/2000/svg"),p(h,"viewBox","0 0 384 512"),p(h,"class","svelte-1829hp2"),p(g,"class","tooltip svelte-1829hp2"),p(d,"class","button tag svelte-1829hp2"),p(d,"style",v=t[6]?"":"display: none;"),p(f,"class","region-btn ml-1 svelte-1829hp2"),p(e,"class",E="region is-center "+(t[5]&&t[11](t[1])?"checked":"")+" svelte-1829hp2"),p(e,"style",T=t[2]==="full"?"height: 100%":"")},m(z,U){C(z,e,U),b(e,i),b(i,n),b(i,s),b(i,o),b(o,l),l.innerHTML=t[10],b(e,u),b(e,f),b(f,d),b(d,h),q.m(h,null),b(d,m),b(d,g),$.m(g,null),b(f,y),W&&W.m(f,null),F=!0,B||(L=[oe(i,"click",t[19]),oe(i,"keyup",Yo),oe(d,"click",t[20])],B=!0)},p(z,[U]){t=z,(!F||U&512&&!it(n.src,r=t[9]))&&p(n,"src",r),(!F||U&1024)&&(l.innerHTML=t[10]),(!F||U&1&&a!==(a="image card region-image "+(t[0]?"is-96x96":"")+" svelte-1829hp2"))&&p(i,"class",a),(!F||U&12&&c!==(c=(t[2]==="full"?"height: 100%":`height: ${t[2]}px; min-width: ${t[2]}px`)+"; "+(t[3]?`border: 5px solid ${t[3]};`:"")))&&p(i,"style",c),O!==(O=I(t))&&(q.d(1),q=O(t),q&&(q.c(),q.m(h,null))),D===(D=R(t))&&$?$.p(t,U):($.d(1),$=D(t),$&&($.c(),$.m(g,null))),(!F||U&64&&v!==(v=t[6]?"":"display: none;"))&&p(d,"style",v),t[7]?W?(W.p(t,U),U&128&&P(W,1)):(W=Pn(t),W.c(),P(W,1),W.m(f,null)):W&&(ve(),M(W,1,1,()=>{W=null}),be()),(!F||U&2082&&E!==(E="region is-center "+(t[5]&&t[11](t[1])?"checked":"")+" svelte-1829hp2"))&&p(e,"class",E),(!F||U&4&&T!==(T=t[2]==="full"?"height: 100%":""))&&p(e,"style",T)},i(z){F||(P(W),Ge(()=>{F&&(H||(H=Ue(e,Xe,{duration:t[15]},!0)),H.run(1))}),F=!0)},o(z){M(W),H||(H=Ue(e,Xe,{duration:t[15]},!1)),H.run(0),F=!1},d(z){z&&k(e),q.d(),$.d(),W&&W.d(),z&&H&&H.end(),B=!1,Ie(L)}}}const Yo=()=>null;function Jo(t,e,i){let n,r,s,o,l,{selectionStore:a}=e;a||(a=vt);const{isSelected:c}=a;re(t,c,O=>i(11,l=O));const{clipBoard:u}=ct;re(t,u,O=>i(18,o=O));let{item:f}=e,{descPromise:d=void 0}=e,{isSquare:h=!0}=e,{height:m=h?96:140}=e;m==="full"&&(h=!1);let{borderColor:g=null}=e,{toggleSelection:v=a.toggle}=e;const y=Ce("qImgMetadata")||void 0,E=Ce("isInModal")||!1,T=E?0:500;let H;E||Bo(()=>import("./ModalController-067e9b83.js"),[]).then(O=>i(7,H=O.default));let{selectable:F=!E}=e,{copyable:B=!0}=e;const L=()=>F?v(f):null,I=()=>B?ct.copyRef(f.ref):null;return t.$$set=O=>{"selectionStore"in O&&i(16,a=O.selectionStore),"item"in O&&i(1,f=O.item),"descPromise"in O&&i(17,d=O.descPromise),"isSquare"in O&&i(0,h=O.isSquare),"height"in O&&i(2,m=O.height),"borderColor"in O&&i(3,g=O.borderColor),"toggleSelection"in O&&i(4,v=O.toggleSelection),"selectable"in O&&i(5,F=O.selectable),"copyable"in O&&i(6,B=O.copyable)},t.$$.update=()=>{t.$$.dirty&2&&i(10,n=f.title),t.$$.dirty&131072&&d&&d.then(O=>i(10,n=O)),t.$$.dirty&7&&i(9,r=at(f.img??f.ref,f.xywh,m==="full"?m:h?`${m},`:`,${m}`)),t.$$.dirty&262146&&i(8,s=f.ref===o)},[h,f,m,g,v,F,B,H,s,r,n,l,c,u,y,T,a,d,o,L,I]}class ln extends ue{constructor(e){super(),ce(this,e,Jo,Wo,le,{selectionStore:16,item:1,descPromise:17,isSquare:0,height:2,borderColor:3,toggleSelection:4,selectable:5,copyable:6})}}const Xo=t=>({}),Ln=t=>({});function Qo(t){let e,i,n,r,s,o,l,a,c,u,f,d,h,m,g,v,y,E,T,H,F;const B=t[1].content,L=ut(B,t,t[0],Ln);return{c(){e=w("button"),i=x(),n=w("div"),r=w("div"),s=x(),o=w("div"),l=w("div"),l.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,a=x(),c=w("section"),u=w("div"),f=x(),d=w("div"),L&&L.c(),h=x(),m=w("footer"),g=w("div"),v=w("button"),v.textContent=`${j==="en"?"Abort":"Retour"}`,y=x(),E=w("button"),E.textContent="OK",p(e,"id","hidden-msg-btn"),p(e,"data-target","msg-modal"),e.hidden=!0,p(r,"id","modal-bkg"),p(r,"class","modal-background"),p(l,"class","modal-card-head media mb-0"),p(u,"id","modal-msg"),p(d,"class","py-3"),p(c,"id","modal-body"),p(c,"class","modal-card-body"),p(v,"id","cancel-btn"),p(v,"class","button is-link is-light button-close"),p(E,"id","ok-btn"),p(E,"class","button is-link button-close"),p(g,"class","buttons"),p(m,"id","modal-footer"),p(m,"class","modal-card-foot is-center pt-3"),m.hidden=!0,p(o,"class","modal-content"),p(n,"id","msg-modal"),p(n,"class","modal fade"),p(n,"tabindex","-1"),p(n,"aria-labelledby","selection-modal-label"),p(n,"aria-hidden","true")},m(I,O){C(I,e,O),C(I,i,O),C(I,n,O),b(n,r),b(n,s),b(n,o),b(o,l),b(o,a),b(o,c),b(c,u),b(c,f),b(c,d),L&&L.m(d,null),b(o,h),b(o,m),b(m,g),b(g,v),b(g,y),b(g,E),T=!0,H||(F=[oi(ss.call(null,e)),oi(rs.call(null,n))],H=!0)},p(I,[O]){L&&L.p&&(!T||O&1)&&dt(L,B,I,I[0],T?ft(B,I[0],O,Xo):ht(I[0]),Ln)},i(I){T||(P(L,I),T=!0)},o(I){M(L,I),T=!1},d(I){I&&k(e),I&&k(i),I&&k(n),L&&L.d(I),H=!1,Ie(F)}}}function Zo(t,e,i){let{$$slots:n={},$$scope:r}=e;return t.$$set=s=>{"$$scope"in s&&i(0,r=s.$$scope)},[r,n]}class el extends ue{constructor(e){super(),ce(this,e,Zo,Qo,le,{})}}function tl(t){let e,i,n;return{c(){e=w("button"),e.textContent=`${j==="en"?"Automatic region extraction":"Extraction automatique des régions"}`,p(e,"class","button is-link is-inverted")},m(r,s){C(r,e,s),i||(n=oe(e,"click",t[1]),i=!0)},p:N,d(r){r&&k(e),i=!1,n()}}}function il(t){let e,i,n,r=Ot.includes("regions"),s,o,l=r&&tl(t);return{c(){e=w("div"),i=w("button"),i.textContent=`${j==="en"?"Manually annotate":"Annoter manuellement"}`,n=x(),l&&l.c(),p(i,"class","button is-link"),p(e,"class","is-center buttons is-centered pt-5")},m(a,c){C(a,e,c),b(e,i),b(e,n),l&&l.m(e,null),s||(o=oe(i,"click",t[0]),s=!0)},p(a,[c]){r&&l.p(a,c)},i:N,o:N,d(a){a&&k(e),l&&l.d(),s=!1,o()}}}function nl(t,e,i){const n=Ce("witness");let{currentRegionId:r}=e,{baseUrl:s}=e;async function o(){const a=`${window.location.origin}/${De}`;let c=`${a}/witness/${n.id}/regions/add`;if(n.regions.length===1||r){const d=r||n.regions[0];c=`${a}/witness/${n.id}/regions/${d}/add`}const u=await Pt(()=>fetch(c,{method:"POST",headers:{"X-CSRFToken":He}}));if(!u.ok)throw await Te(`Failed to create regions: '${u.statusText}'`,"Error"),new Error(`Failed to create regions: '${u.statusText}'`);let f;try{f=await u.json()}catch(d){throw await Te(`Failed to parse JSON response: '${d}'`,"Error"),new Error(`Failed to parse JSON response: '${d}'`)}f.hasOwnProperty("mirador_url")&&window.open(f.mirador_url),f.hasOwnProperty("regions_id")&&(window.location.href=`${s.split("regions/")[0]}regions/${f.regions_id}`)}async function l(){const a=`${window.location.origin}/${De}/witness/${n.id}/regions/extract`,c=await Pt(()=>fetch(a,{method:"POST",headers:{"X-CSRFToken":He}}));let u;if(c.ok)try{u=await c.json(),console.log(u)}catch(f){throw await Te(`Failed to parse JSON response: '${f}'`,"Error"),new Error(`Failed to parse JSON response: '${f}'`)}finally{const f=u.doc_set_id;if(!f)throw await Te("Failed to launch regions extraction: 'No document set id'","Error"),new Error("Failed to launch regions extraction: 'No document set id'");window.location.href=`${window.location.origin}/${De}/treatment/add/?document_set=${f}&task_type=regions`}else throw await Te(`Failed to launch regions extraction: '${u.message}'`,"Error"),new Error(`Failed to launch regions extraction: '${u.message}'`)}return t.$$set=a=>{"currentRegionId"in a&&i(2,r=a.currentRegionId),"baseUrl"in a&&i(3,s=a.baseUrl)},[o,l,r,s]}class os extends ue{constructor(e){super(),ce(this,e,nl,il,le,{currentRegionId:2,baseUrl:3})}}function Rn(t,e,i){const n=t.slice();return n[6]=e[i],n}function rl(t){let e,i=t[3].regions,n=[];for(let r=0;r<i.length;r+=1)n[r]=Mn(Rn(t,i,r));return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=he()},m(r,s){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(r,s);C(r,e,s)},p(r,s){if(s&9){i=r[3].regions;let o;for(o=0;o<i.length;o+=1){const l=Rn(r,i,o);n[o]?n[o].p(l,s):(n[o]=Mn(l),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=i.length}},d(r){mi(n,r),r&&k(e)}}}function sl(t){let e,i;function n(o,l){if(l&4&&(e=null),e==null&&(e=!!["all","page"].includes(o[2])),e)return ll;if(o[2]==="similarity")return ol}let r=n(t,-1),s=r&&r(t);return{c(){s&&s.c(),i=he()},m(o,l){s&&s.m(o,l),C(o,i,l)},p(o,l){r===(r=n(o,l))&&s?s.p(o,l):(s&&s.d(1),s=r&&r(o),s&&(s.c(),s.m(i.parentNode,i)))},d(o){s&&s.d(o),o&&k(i)}}}function Mn(t){let e,i,n=t[6]+"",r,s;return{c(){e=w("a"),i=Y("Regions #"),r=Y(n),p(e,"href",s=""+(t[0]+t[6])),p(e,"class","tag is-dark mr-3 is-rounded")},m(o,l){C(o,e,l),b(e,i),b(e,r)},p(o,l){l&1&&s!==(s=""+(o[0]+o[6]))&&p(e,"href",s)},d(o){o&&k(e)}}}function ol(t){let e,i,n;return{c(){e=w("button"),e.textContent=`${j==="en"?"Delete all regions similarity":"Supprimer toutes les similarités du document"}`,p(e,"class","tag is-danger")},m(r,s){C(r,e,s),i||(n=oe(e,"click",t[5]),i=!0)},p:N,d(r){r&&k(e),i=!1,n()}}}function ll(t){let e,i,n;return{c(){e=w("button"),e.textContent=`${j==="en"?"Delete regions record":"Supprimer l'intégralité des régions"}`,p(e,"class","tag is-danger")},m(r,s){C(r,e,s),i||(n=oe(e,"click",t[4]),i=!0)},p:N,d(r){r&&k(e),i=!1,n()}}}function al(t){let e;function i(s,o){return s[1]?sl:rl}let n=i(t),r=n(t);return{c(){e=w("div"),r.c()},m(s,o){C(s,e,o),r.m(e,null)},p(s,[o]){n===(n=i(s))&&r?r.p(s,o):(r.d(1),r=n(s),r&&(r.c(),r.m(e,null)))},i:N,o:N,d(s){s&&k(e),r.d()}}}function cl(t,e,i){const n=Ce("witness");let{baseUrl:r=`${window.location.origin}${window.location.pathname}`}=e,{currentRegionId:s}=e,{currentLayout:o}=e;async function l(){if(!await Te(j==="en"?"Are you sure you want to delete this record?":"Voulez-vous vraiment supprimer cet enregistrement ?",j==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof s!="number")throw new Error("Invalid region ID");const u=`${window.location.origin}/${De}/regions/${s}/delete`;try{const f=await Pt(()=>fetch(u,{method:"DELETE",headers:{"X-CSRFToken":He}}));if(f.status!==204)throw new Error(`Failed to delete regions: '${f.statusText}'`);window.location.href=`${r.split("regions/")[0]}regions/`}catch(f){console.error(f)}}async function a(){if(!await Te(j==="en"?"Are you sure you want to delete all similarity scores for this document?":"Voulez-vous vraiment supprimer l'intégralité des scores de similarité pour ce document ?",j==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof s!="number")throw new Error("Invalid region ID");const u=`${window.location.origin}/${De}/similarity/reset/${s}`;try{const f=await Pt(()=>fetch(u,{method:"DELETE",headers:{"X-CSRFToken":He}}));if(f.status===204||f.status===200)window.location.href=`${r.split("regions/")[0]}regions/`;else throw new Error(`Failed to delete similarity: '${f.statusText}'`)}catch(f){console.error(f),await Te(f.message,"Error")}}return t.$$set=c=>{"baseUrl"in c&&i(0,r=c.baseUrl),"currentRegionId"in c&&i(1,s=c.currentRegionId),"currentLayout"in c&&i(2,o=c.currentLayout)},[r,s,o,n,l,a]}class ul extends ue{constructor(e){super(),ce(this,e,cl,al,le,{baseUrl:0,currentRegionId:1,currentLayout:2})}}function fl(t){let e;return{c(){e=Ke("path"),p(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),p(e,"class","svelte-h0t5l9")},m(i,n){C(i,e,n)},d(i){i&&k(e)}}}function dl(t){let e;return{c(){e=Ke("path"),p(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),p(e,"class","svelte-h0t5l9")},m(i,n){C(i,e,n)},d(i){i&&k(e)}}}function hl(t){let e=j==="en"?"Edit":"Modifier",i;return{c(){i=Y(e)},m(n,r){C(n,i,r)},p:N,d(n){n&&k(i)}}}function pl(t){let e=j==="en"?"Validate":"Valider",i;return{c(){i=Y(e)},m(n,r){C(n,i,r)},p:N,d(n){n&&k(i)}}}function Dn(t){let e,i,n,r=j==="en"?"Reload":"Recharger",s,o,l,a,c,u=j==="en"?"Go to editor":"Aller à l'éditeur",f,d,h,m,g,v=j==="en"?"Delete selected regions":"Supprimer les régions sélectionnées",y,E,T;return{c(){e=w("button"),i=w("i"),n=x(),s=Y(r),o=x(),l=w("a"),a=w("i"),c=x(),f=Y(u),d=x(),h=w("button"),m=w("i"),g=x(),y=Y(v),p(i,"class","fa-solid fa-rotate-right"),p(e,"class","tag is-link is-light is-rounded mr-3"),p(a,"class","fa-solid fa-edit"),p(l,"class","tag is-link is-rounded mr-3"),p(l,"href",ui(t[4])),p(l,"target","_blank"),p(m,"class","fa-solid fa-trash"),p(h,"class","tag is-danger is-rounded")},m(H,F){C(H,e,F),b(e,i),b(e,n),b(e,s),C(H,o,F),C(H,l,F),b(l,a),b(l,c),b(l,f),C(H,d,F),C(H,h,F),b(h,m),b(h,g),b(h,y),E||(T=[oe(e,"click",t[14]),oe(h,"click",t[6])],E=!0)},p:N,d(H){H&&k(e),H&&k(o),H&&k(l),H&&k(d),H&&k(h),E=!1,Ie(T)}}}function ml(t){let e,i,n,r,s,o,l,a,c,u,f,d,h,m,g=j==="en"?"Download":"Télécharger",v,y,E,T,H;function F(D,$){return D[0]?dl:fl}let B=F(t),L=B(t);function I(D,$){return D[0]?pl:hl}let O=I(t),q=O(t),R=t[0]&&Dn(t);return{c(){e=w("div"),i=w("button"),n=Ke("svg"),L.c(),r=x(),q.c(),o=x(),l=w("button"),a=w("i"),c=x(),u=w("span"),u.textContent=`${j==="en"?"Select all":"Tout sélectionner"}`,f=x(),d=w("button"),h=w("i"),m=x(),v=Y(g),y=x(),E=w("div"),R&&R.c(),p(n,"xmlns","http://www.w3.org/2000/svg"),p(n,"viewBox","0 0 384 512"),p(n,"class","pr-3 svelte-h0t5l9"),p(i,"class",s="button "+(t[0]?"is-success":"is-link")+" mr-3"),p(a,"class","fa-solid fa-square-check"),p(u,"id","all-selection"),p(l,"class","button is-link is-light mr-3"),p(h,"class","fa-solid fa-download"),p(d,"class","button is-link is-light"),p(e,"class","is-right mb-3"),p(E,"class","edit-action is-right svelte-h0t5l9")},m(D,$){C(D,e,$),b(e,i),b(i,n),L.m(n,null),b(i,r),q.m(i,null),b(e,o),b(e,l),b(l,a),b(l,c),b(l,u),b(e,f),b(e,d),b(d,h),b(d,m),b(d,v),C(D,y,$),C(D,E,$),R&&R.m(E,null),T||(H=[oe(i,"click",t[13]),oe(l,"click",t[7]),oe(d,"click",t[8])],T=!0)},p(D,[$]){B!==(B=F(D))&&(L.d(1),L=B(D),L&&(L.c(),L.m(n,null))),O===(O=I(D))&&q?q.p(D,$):(q.d(1),q=O(D),q&&(q.c(),q.m(i,null))),$&1&&s!==(s="button "+(D[0]?"is-success":"is-link")+" mr-3")&&p(i,"class",s),D[0]?R?R.p(D,$):(R=Dn(D),R.c(),R.m(E,null)):R&&(R.d(1),R=null)},i:N,o:N,d(D){D&&k(e),L.d(),q.d(),D&&k(y),D&&k(E),R&&R.d(),T=!1,Ie(H)}}}async function gl(t){const e=t.id_full,i=`${SAS_APP_URL}/annotation/destroy?uri=${e}`,n=await fetch(i,{method:"DELETE"});if(n.status!==204)throw new Error(`Failed to delete ${i} due to ${n.status}: '${n.statusText}'`)}function _l(t,e,i){let n,r,s,o,l,a,c;const{selected:u,nbSelected:f}=vt;re(t,u,F=>i(11,a=F)),re(t,f,F=>i(12,c=F));const{allRegions:d}=ct;re(t,d,F=>i(10,l=F));const h=Ce("manifest"),m=Ce("isValidated");function g(){i(0,r=!r)}async function v(){if(await Te(j==="en"?"Are you sure you want to delete these regions?":"Voulez-vous vraiment supprimer ces régions ?",j==="en"?"Confirm deletion":"Confirmer la suppression",!0))for(const[B,L]of Object.entries(s))try{if(!l.hasOwnProperty(B))continue;await gl(L),ct.remove(B),vt.remove(B,xi)}catch(I){await Te(`Failed to delete region ${B}: ${I.message}`,"Error")}}function y(){o?vt.removeAll(Object.keys(l),xi):vt.addAll(Object.values(l))}async function E(){const F=Object.values(s).map(I=>I.ref),L=await(await Pt(()=>fetch(`${window.location.origin}/${De}/regions/export`,{method:"POST",headers:{"X-CSRFToken":He},body:JSON.stringify({regionsRef:F})}))).blob();is(L,"regions.zip")}const T=()=>g(),H=()=>location.reload();return t.$$.update=()=>{t.$$.dirty&4096&&i(9,n=c),t.$$.dirty&2048&&(s=Object.values(a)[0]||{}),t.$$.dirty&1536&&(o=n>=Object.keys(l).length)},i(0,r=!m),[r,u,f,d,h,g,v,y,E,n,l,a,c,T,H]}class vl extends ue{constructor(e){super(),ce(this,e,_l,ml,le,{})}}function bl(){const t=`${window.location.origin}${window.location.pathname}`,e=25,i=window.location.pathname.match(/\d+/g).join("-"),n={[i]:{}},r=[2,6],s=we(1),o=we({}),l=we(JSON.parse(localStorage.getItem("selectedRegions"))||n);l.subscribe(D=>localStorage.setItem("selectedRegions",JSON.stringify(D)));const a=we(JSON.parse(localStorage.getItem("excludedCategories"))||[]);a.subscribe(D=>localStorage.setItem("excludedCategories",JSON.stringify(D)));const c=we(JSON.parse(localStorage.getItem("similarityScoreCutoff"))||void 0);c.subscribe(D=>{D!=null&&localStorage.setItem("similarityScoreCutoff",JSON.stringify(D))});const u=we(JSON.parse(localStorage.getItem("propagateRecursionDepth"))||r[1]);u.subscribe(D=>localStorage.setItem("propagateRecursionDepth",JSON.stringify(D)));const f=we(JSON.parse(localStorage.getItem("propagateFilterByRegions"))||!1);f.subscribe(D=>localStorage.setItem("propagateFilterByRegions",JSON.stringify(D)));const d=Fe([u,f],([D,$])=>({propagateRecursionDepth:D,propagateFilterByRegions:$})),h=Fe([a,l,c],([D,$,W])=>({excludedCategories:D,regions:$,similarityScoreCutoff:W})),m=Fe([d,h],([D,$])=>({propagate:D,similarity:$})),g=we([]),v=we([]);async function y(){const D=async()=>{const z=await(await fetch(`${t}compared-regions`)).json();o.set(z),l.update(U=>{let ne=U[i]||{};if(Object.keys(ne).length){let ae=Object.keys(ne).filter(se=>Object.keys(z).includes(se)).reduce((se,Be)=>(se[Be]=ne[Be],se),{});U[i]=ae}return U})},$=async()=>{const z=await(await fetch(`${t}query-images`)).json();z.length>0&&(g.set(z),q(L()))};Tt.set(!0);try{await Promise.all([D(),$()])}catch(W){console.error("Error:",W),Qr.set(W.message)}finally{Tt.set(!1)}}function E(D){localStorage.setItem("selectedRegions",JSON.stringify(D))}function T(D){l.update($=>{const W={...$};return delete W[i][D],E(W),W})}function H(D){l.update($=>{const W={...$,[i]:{...$[i]||{},[D.ref]:D}};return E(W),W})}const F=Fe(l,D=>$=>{var W;return(W=D[i])==null?void 0:W.hasOwnProperty($)});function B(D){const $=Xi(o),W=Object.keys($).filter(z=>z.startsWith(D));return W.length!==1?{title:"Error"}:$[W[0]]}const L=()=>nn(s,"sp"),I=Fe([s,g],([D,$])=>(async()=>O(D,$))());function O(D,$){const W=(D-1)*e,z=W+e,U=$.slice(W,z);return v.set(U),U}function q(D){rn(D,s,"sp")}function R(D){o.update($=>({...$,[D.ref]:D}))}return{currentPage:s,comparedRegions:o,excludedCategories:a,qImgs:g,pageQImgs:v,selectedRegions:l,propagateRecursionDepth:u,propagateFilterByRegions:f,similarityToolbarParams:m,propagateParams:d,similarityScoreCutoff:c,allowedPropagateDepthRange:r,fetchSimilarity:y,setPageQImgs:I,getRegionsInfo:B,handlePageUpdate:q,unselect:T,select:H,addComparedRegions:R,isSelected:F,pageLength:e}}const Ve=bl();function yl(t){let e,i,n;const r=t[1].default,s=ut(r,t,t[0],null);return{c(){e=w("table"),i=w("tbody"),s&&s.c(),p(e,"class","table is-fullwidth")},m(o,l){C(o,e,l),b(e,i),s&&s.m(i,null),n=!0},p(o,[l]){s&&s.p&&(!n||l&1)&&dt(s,r,o,o[0],n?ft(r,o[0],l,null):ht(o[0]),null)},i(o){n||(P(s,o),n=!0)},o(o){M(s,o),n=!1},d(o){o&&k(e),s&&s.d(o)}}}function wl(t,e,i){let{$$slots:n={},$$scope:r}=e;return t.$$set=s=>{"$$scope"in s&&i(0,r=s.$$scope)},[r,n]}class gi extends ue{constructor(e){super(),ce(this,e,wl,yl,le,{})}}function Nn(t){let e,i,n,r,s,o,l,a,c,u=t[5]>1&&$n(t),f=t[5]<t[3]&&Vn(t);return{c(){e=w("nav"),i=w("ul"),u&&u.c(),n=x(),r=w("li"),s=w("a"),o=Y(t[5]),l=x(),f&&f.c(),p(s,"class","pagination-link is-current"),p(s,"href",null),p(i,"class","pagination-list ml-0"),p(e,"class","pagination is-centered mb-2"),p(e,"aria-label","pagination")},m(d,h){C(d,e,h),b(e,i),u&&u.m(i,null),b(i,n),b(i,r),b(r,s),b(s,o),b(i,l),f&&f.m(i,null),a||(c=oe(s,"click",yt(t[9])),a=!0)},p(d,h){d[5]>1?u?u.p(d,h):(u=$n(d),u.c(),u.m(i,n)):u&&(u.d(1),u=null),h&32&&de(o,d[5]),d[5]<d[3]?f?f.p(d,h):(f=Vn(d),f.c(),f.m(i,null)):f&&(f.d(1),f=null)},d(d){d&&k(e),u&&u.d(),f&&f.d(),a=!1,c()}}}function $n(t){let e,i,n,r,s,o,l=t[5]-1>1&&jn(t);return{c(){e=w("li"),i=w("a"),i.textContent="1",n=x(),l&&l.c(),r=he(),p(i,"class","pagination-link"),p(i,"href",null)},m(a,c){C(a,e,c),b(e,i),C(a,n,c),l&&l.m(a,c),C(a,r,c),s||(o=oe(i,"click",yt(t[7])),s=!0)},p(a,c){a[5]-1>1?l?l.p(a,c):(l=jn(a),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},d(a){a&&k(e),a&&k(n),l&&l.d(a),a&&k(r),s=!1,o()}}}function jn(t){let e,i,n,r=t[5]-1+"",s,o,l,a=t[5]-1>2&&Fn();return{c(){a&&a.c(),e=x(),i=w("li"),n=w("a"),s=Y(r),p(n,"class","pagination-link"),p(n,"href",null)},m(c,u){a&&a.m(c,u),C(c,e,u),C(c,i,u),b(i,n),b(n,s),o||(l=oe(n,"click",yt(t[8])),o=!0)},p(c,u){c[5]-1>2?a||(a=Fn(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),u&32&&r!==(r=c[5]-1+"")&&de(s,r)},d(c){a&&a.d(c),c&&k(e),c&&k(i),o=!1,l()}}}function Fn(t){let e;return{c(){e=w("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(i,n){C(i,e,n)},d(i){i&&k(e)}}}function Vn(t){let e,i,n,r,s,o,l=t[5]+1<t[3]&&xn(t);return{c(){l&&l.c(),e=x(),i=w("li"),n=w("a"),r=Y(t[3]),p(n,"class","pagination-link"),p(n,"href",null)},m(a,c){l&&l.m(a,c),C(a,e,c),C(a,i,c),b(i,n),b(n,r),s||(o=oe(n,"click",yt(t[11])),s=!0)},p(a,c){a[5]+1<a[3]?l?l.p(a,c):(l=xn(a),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),c&8&&de(r,a[3])},d(a){l&&l.d(a),a&&k(e),a&&k(i),s=!1,o()}}}function xn(t){let e,i,n=t[5]+1+"",r,s,o,l,a,c=t[5]+2<t[3]&&Un();return{c(){e=w("li"),i=w("a"),r=Y(n),s=x(),c&&c.c(),o=he(),p(i,"class","pagination-link"),p(i,"href",null)},m(u,f){C(u,e,f),b(e,i),b(i,r),C(u,s,f),c&&c.m(u,f),C(u,o,f),l||(a=oe(i,"click",yt(t[10])),l=!0)},p(u,f){f&32&&n!==(n=u[5]+1+"")&&de(r,n),u[5]+2<u[3]?c||(c=Un(),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(u){u&&k(e),u&&k(s),c&&c.d(u),u&&k(o),l=!1,a()}}}function Un(t){let e;return{c(){e=w("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(i,n){C(i,e,n)},d(i){i&&k(e)}}}function Sl(t){let e,i,n=t[5]*t[2]-t[2]+1+"",r,s,o=Math.min(t[5]*t[2],t[1])+"",l,a,c,u,f=t[4]&&Nn(t);return{c(){f&&f.c(),e=x(),i=w("div"),r=Y(n),s=Y(" - "),l=Y(o),a=Y(" / "),c=Y(t[1]),p(i,"class",u="is-size-7 is-center mb-4 "+(t[4]?"":"mt-4"))},m(d,h){f&&f.m(d,h),C(d,e,h),C(d,i,h),b(i,r),b(i,s),b(i,l),b(i,a),b(i,c)},p(d,[h]){d[4]?f?f.p(d,h):(f=Nn(d),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),h&36&&n!==(n=d[5]*d[2]-d[2]+1+"")&&de(r,n),h&38&&o!==(o=Math.min(d[5]*d[2],d[1])+"")&&de(l,o),h&2&&de(c,d[1]),h&16&&u!==(u="is-size-7 is-center mb-4 "+(d[4]?"":"mt-4"))&&p(i,"class",u)},i:N,o:N,d(d){f&&f.d(d),d&&k(e),d&&k(i)}}}function El(t,e,i){let n,r,s,{store:o}=e;const{currentPage:l}=o;re(t,l,g=>i(5,s=g));let{nbOfItems:a}=e,{pageLength:c=Lo}=e;const u=()=>o.handlePageUpdate(1),f=()=>o.handlePageUpdate(s-1),d=()=>o.handlePageUpdate(s),h=()=>o.handlePageUpdate(s+1),m=()=>o.handlePageUpdate(n);return t.$$set=g=>{"store"in g&&i(0,o=g.store),"nbOfItems"in g&&i(1,a=g.nbOfItems),"pageLength"in g&&i(2,c=g.pageLength)},t.$$.update=()=>{t.$$.dirty&6&&i(3,n=c>0?Math.ceil(a/c):1),t.$$.dirty&14&&i(4,r=n>1||a>c)},[o,a,c,n,r,s,l,u,f,d,h,m]}class Lt extends ue{constructor(e){super(),ce(this,e,El,Sl,le,{store:0,nbOfItems:1,pageLength:2})}}const ls=(t,e,i,n)=>({id:t,img:t,title:`Canvas ${n} - ${i} - ${j==="en"?"Witness":"Témoin"} #${Zr(e)}`,xywh:i.split(",").map(Number),canvas:n,ref:t.replace(".jpg",""),type:xi}),kl=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,as=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">
        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>
    </svg>`,cs=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">
        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,us=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">
        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,fs=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,ds=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>
    </svg>`,Cl=j==="en"?"no categorization":"aucune catégorisation",hs=j==="en"?"overall visual matches":"correspondances visuelles globales",ps=j==="en"?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",ms=j==="en"?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",gs=j==="en"?"regions without match":"régions sans correspondance",_s=j==="en"?"user specific category":"correspondances spécifiques à l'utilisateur",ti={0:{title:Cl,svg:kl},1:{title:hs,svg:as},2:{title:ps,svg:cs},3:{title:ms,svg:us},4:{title:gs,svg:fs},5:{title:_s,svg:ds}};function Il(t){let e,i=ti[t[2]].svg+"",n,r,s,o;return{c(){e=w("span"),p(e,"class",n="tag py-4 "+t[4]+" "+(t[0]?"is-hoverable":"")),p(e,"title",r=ti[t[2]].title),xe(e,"is-selected",t[1])},m(l,a){C(l,e,a),e.innerHTML=i,s||(o=[oe(e,"click",t[5]),oe(e,"keyup",null)],s=!0)},p(l,[a]){a&4&&i!==(i=ti[l[2]].svg+"")&&(e.innerHTML=i),a&17&&n!==(n="tag py-4 "+l[4]+" "+(l[0]?"is-hoverable":""))&&p(e,"class",n),a&4&&r!==(r=ti[l[2]].title)&&p(e,"title",r),a&19&&xe(e,"is-selected",l[1])},i:N,o:N,d(l){l&&k(e),s=!1,Ie(o)}}}function Al(t,e,i){let{selectable:n=!0}=e,{isSelected:r=!1}=e,{category:s}=e,{toggle:o=()=>{}}=e,{padding:l="px-2"}=e;const a=()=>o(s);return t.$$set=c=>{"selectable"in c&&i(0,n=c.selectable),"isSelected"in c&&i(1,r=c.isSelected),"category"in c&&i(2,s=c.category),"toggle"in c&&i(3,o=c.toggle),"padding"in c&&i(4,l=c.padding)},[n,r,s,o,l,a]}class xt extends ue{constructor(e){super(),ce(this,e,Al,Il,le,{selectable:0,isSelected:1,category:2,toggle:3,padding:4})}}function Ol(t){let e,i,n,r,s,o,l,a,c,u,f;return i=new xt({props:{category:1,isSelected:t[0]===1,toggle:t[4],padding:"pl-3 pr-2"}}),r=new xt({props:{category:2,isSelected:t[0]===2,toggle:t[4]}}),o=new xt({props:{category:3,isSelected:t[0]===3,toggle:t[4]}}),a=new xt({props:{category:4,isSelected:t[0]===4,toggle:t[4]}}),u=new xt({props:{category:5,isSelected:t[0]===5,toggle:t[4],padding:"pl-2 pr-3"}}),{c(){e=w("div"),Z(i.$$.fragment),n=x(),Z(r.$$.fragment),s=x(),Z(o.$$.fragment),l=x(),Z(a.$$.fragment),c=x(),Z(u.$$.fragment),p(e,"class","tags has-addons is-dark is-center")},m(d,h){C(d,e,h),X(i,e,null),b(e,n),X(r,e,null),b(e,s),X(o,e,null),b(e,l),X(a,e,null),b(e,c),X(u,e,null),f=!0},p(d,h){const m={};h&1&&(m.isSelected=d[0]===1),i.$set(m);const g={};h&1&&(g.isSelected=d[0]===2),r.$set(g);const v={};h&1&&(v.isSelected=d[0]===3),o.$set(v);const y={};h&1&&(y.isSelected=d[0]===4),a.$set(y);const E={};h&1&&(E.isSelected=d[0]===5),u.$set(E)},i(d){f||(P(i.$$.fragment,d),P(r.$$.fragment,d),P(o.$$.fragment,d),P(a.$$.fragment,d),P(u.$$.fragment,d),f=!0)},o(d){M(i.$$.fragment,d),M(r.$$.fragment,d),M(o.$$.fragment,d),M(a.$$.fragment,d),M(u.$$.fragment,d),f=!1},d(d){d&&k(e),Q(i),Q(r),Q(o),Q(a),Q(u)}}}function Tl(t){let e,i,n,r;i=new ln({props:{item:t[3],size:256,selectable:!1,isSquare:!1}});let s=!t[2]&&Ol(t);return{c(){e=w("div"),Z(i.$$.fragment),n=x(),s&&s.c()},m(o,l){C(o,e,l),X(i,e,null),b(e,n),s&&s.m(e,null),r=!0},p(o,[l]){o[2]||s.p(o,l)},i(o){r||(P(i.$$.fragment,o),P(s),r=!0)},o(o){M(i.$$.fragment,o),M(s),r=!1},d(o){o&&k(e),Q(i),s&&s.d()}}}function Pl(t,e,i){let n,r,s;const{comparedRegions:o}=Ve;re(t,o,$=>i(15,s=$));const l=new URL(window.location.href),a=l.origin;l.pathname;let{qImg:c}=e,{sImg:u}=e,{qRegions:f}=e,{sRegions:d}=e,{score:h=0}=e,{category:m=null}=e,{users:g=[]}=e,{isManual:v}=e,{similarityType:y}=e;const E=Ce("isInModal")||!1,[T,H,F,B]=u.split(".")[0].split("_"),I=(()=>{let $=ls(u,T,B,F);const W=s[`${T}_${H}_anno${d}`]||{title:$.title};return $.title=`${es(W.title.replace(/^[^|]+/,""))}<br/>Page ${Mo(F)}<br/><b>Score: ${h}</b>`,$})();Ze("similarityPair",{qImg:c,sImg:u,qRegions:f,sRegions:d,score:h,category:m,users:g,isManual:v,similarityType:y});function O($){$=$.slice();let W=$.indexOf(Number(Di));return r&&W===-1?$.push(Number(Di)):!r&&W!==-1&&$.splice(W,1),$}const q=()=>({img_1:c,img_2:u,regions_id_1:f,regions_id_2:d,score:h,category:n,category_x:O(g),is_manual:v||y===2,similarity_type:y});function R($){$===5?r=!r:i(0,n=n===$?null:$)}async function D($){R($);try{(await fetch(`${a}/${De}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":He},body:JSON.stringify(q())})).ok||(console.error("Error: Network response was not ok"),R($))}catch(W){console.error("Error:",W),R($)}}return t.$$set=$=>{"qImg"in $&&i(5,c=$.qImg),"sImg"in $&&i(6,u=$.sImg),"qRegions"in $&&i(7,f=$.qRegions),"sRegions"in $&&i(8,d=$.sRegions),"score"in $&&i(9,h=$.score),"category"in $&&i(10,m=$.category),"users"in $&&i(11,g=$.users),"isManual"in $&&i(12,v=$.isManual),"similarityType"in $&&i(13,y=$.similarityType)},t.$$.update=()=>{t.$$.dirty&1024&&i(0,n=m),t.$$.dirty&2048&&(r=g.includes(Number(Di))||!1)},[n,o,E,I,D,c,u,f,d,h,m,g,v,y]}class Ll extends ue{constructor(e){super(),ce(this,e,Pl,Tl,le,{qImg:5,sImg:6,qRegions:7,sRegions:8,score:9,category:10,users:11,isManual:12,similarityType:13})}}function Hn(t,e,i){const n=t.slice();return n[22]=e[i].uuid,n[23]=e[i].data[0],n[24]=e[i].data[1],n[25]=e[i].data[2],n[26]=e[i].data[3],n[27]=e[i].data[4],n[28]=e[i].data[5],n[29]=e[i].data[6],n[30]=e[i].data[7],n[31]=e[i].data[8],n}function Rl(t){let e,i=j==="en"?`Error when retrieving similar regions: ${t[2]}`:`Erreur de recupération des régions similaires: ${t[2]}`,n;return{c(){e=w("div"),n=Y(i),p(e,"class","faded is-center")},m(r,s){C(r,e,s),b(e,n)},p(r,s){s[0]&4&&i!==(i=j==="en"?`Error when retrieving similar regions: ${r[2]}`:`Erreur de recupération des régions similaires: ${r[2]}`)&&de(n,i)},i:N,o:N,d(r){r&&k(e)}}}function Ml(t){let e,i,n=t[4].length+"",r,s,o=t[11](t[10],t[4].length)+"",l,a,c,u=[],f=new Map,d,h=t[4];const m=v=>v[22];for(let v=0;v<h.length;v+=1){let y=Hn(t,h,v),E=m(y);f.set(E,u[v]=zn(E,y))}let g=null;return h.length||(g=Bn(t)),{c(){e=w("div"),i=w("span"),r=Y(n),s=x(),l=Y(o),a=x(),c=w("div");for(let v=0;v<u.length;v+=1)u[v].c();g&&g.c(),p(i,"class","m-2"),p(c,"class","m-2 is-gap-2"),xe(c,"grid",t[4].length>0)},m(v,y){C(v,e,y),b(e,i),b(i,r),b(i,s),b(i,l),b(e,a),b(e,c);for(let E=0;E<u.length;E+=1)u[E]&&u[E].m(c,null);g&&g.m(c,null),d=!0},p(v,y){(!d||y[0]&16)&&n!==(n=v[4].length+"")&&de(r,n),(!d||y[0]&16)&&o!==(o=v[11](v[10],v[4].length)+"")&&de(l,o),y[0]&49&&(h=v[4],ve(),u=Yt(u,y,m,1,v,h,f,c,Wt,zn,null,Hn),be(),!h.length&&g?g.p(v,y):h.length?g&&(g.d(1),g=null):(g=Bn(v),g.c(),g.m(c,null))),(!d||y[0]&16)&&xe(c,"grid",v[4].length>0)},i(v){if(!d){for(let y=0;y<h.length;y+=1)P(u[y]);d=!0}},o(v){for(let y=0;y<u.length;y+=1)M(u[y]);d=!1},d(v){v&&k(e);for(let y=0;y<u.length;y+=1)u[y].d();g&&g.d()}}}function Dl(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"&&!t[10]?"Retrieving similar regions...":j==="fr"&&!t[10]?"Récupération des régions similaires...":j==="en"&&t[10]?"Retrieving propagated regions...":"Récupération de similarités propagées..."}`,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,i:N,o:N,d(i){i&&k(e)}}}function Bn(t){let e;function i(s,o){return s[5]?$l:Nl}let n=i(t),r=n(t);return{c(){r.c(),e=he()},m(s,o){r.m(s,o),C(s,e,o)},p(s,o){n===(n=i(s))&&r?r.p(s,o):(r.d(1),r=n(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&k(e)}}}function Nl(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"?"No similar regions":"Pas de régions similaires"}
                    `,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,d(i){i&&k(e)}}}function $l(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"?"No document selected. Select one to display results.":"Aucun document sélectionné. Sélectionnez-en un pour afficher les résultats."}
                    `,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,d(i){i&&k(e)}}}function zn(t,e){let i,n,r;return n=new Ll({props:{qImg:e[0],sImg:e[25],score:e[23],qRegions:e[26],sRegions:e[27],category:e[28],users:e[29],isManual:e[30],similarityType:e[31]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(s,o){C(s,i,o),X(n,s,o),r=!0},p(s,o){e=s;const l={};o[0]&1&&(l.qImg=e[0]),o[0]&16&&(l.sImg=e[25]),o[0]&16&&(l.score=e[23]),o[0]&16&&(l.qRegions=e[26]),o[0]&16&&(l.sRegions=e[27]),o[0]&16&&(l.category=e[28]),o[0]&16&&(l.users=e[29]),o[0]&16&&(l.isManual=e[30]),o[0]&16&&(l.similarityType=e[31]),n.$set(l)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){M(n.$$.fragment,s),r=!1},d(s){s&&k(i),Q(n,s)}}}function jl(t){let e,i,n,r;const s=[Dl,Ml,Rl],o=[];function l(a,c){return a[1]&&a[3]==="loading"?0:a[3]==="loaded"?1:a[3]==="error"?2:-1}return~(e=l(t))&&(i=o[e]=s[e](t)),{c(){i&&i.c(),n=he()},m(a,c){~e&&o[e].m(a,c),C(a,n,c),r=!0},p(a,c){let u=e;e=l(a),e===u?~e&&o[e].p(a,c):(i&&(ve(),M(o[u],1,1,()=>{o[u]=null}),be()),~e?(i=o[e],i?i.p(a,c):(i=o[e]=s[e](a),i.c()),P(i,1),i.m(n.parentNode,n)):i=null)},i(a){r||(P(i),r=!0)},o(a){M(i),r=!1},d(a){~e&&o[e].d(a),a&&k(n)}}}function Fl(t,e,i){let n,r,s,o,l,a,c,u,{qImg:f}=e,{sImgsPromise:d}=e;const{selectedRegions:h,excludedCategories:m,similarityScoreCutoff:g,propagateFilterByRegions:v}=Ve;re(t,h,O=>i(16,u=O)),re(t,m,O=>i(15,c=O)),re(t,g,O=>i(14,a=O)),re(t,v,O=>i(13,l=O));const y=Ce("similarityPropagatedContext")||!1,E=window.location.pathname.match(/\d+/g).join("-");let T;const H=(O,q)=>O===null||q===void 0||Number(O)>=q,F=(O,q,R)=>!R.includes(O),B=(O,q,R,D,$,W)=>y?!0:H(O,$)&&F(q,R,D),L=(O,q,R,D)=>O.filter(({uuid:$,data:[W,z,U,ne,ae,se,Be,$t,ze]})=>B(W,se,Be,q,R)),I=(O,q)=>{const R=q>1;return O?j==="fr"?R?"similarités propagées":"similarité propagée":R?"propagated matches":"propagated match":j==="fr"?R?"images similaires":"image similaire":R?"similar images":"similar image"};return t.$$set=O=>{"qImg"in O&&i(0,f=O.qImg),"sImgsPromise"in O&&i(1,d=O.sImgsPromise)},t.$$.update=()=>{t.$$.dirty[0]&65536&&i(5,n=Object.values(u).length===0||u[E]===void 0||!Object.keys(u[E]).length),t.$$.dirty[0]&2&&(O=>{i(3,r="loading"),i(4,o=[]),i(12,s=[])})(),t.$$.dirty[0]&2&&d.then(O=>{i(12,s=O.map(q=>({uuid:window.crypto.randomUUID(),data:q}))),i(3,r="loaded")}).catch(O=>{i(2,T=O),i(3,r="error")}),t.$$.dirty[0]&61440&&i(4,o=L(s,c,a))},i(3,r="loading"),i(12,s=[]),[f,d,T,r,o,n,h,m,g,v,y,I,s,l,a,c,u]}class vs extends ue{constructor(e){super(),ce(this,e,Fl,jl,le,{qImg:0,sImgsPromise:1},null,[-1,-1])}}function Vl(t){let e,i;return e=new vs({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,[r]){const s={};r&1&&(s.qImg=n[0]),r&2&&(s.sImgsPromise=n[1]),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function xl(t,e,i){let n,r,{qImg:s}=e,o;const l=Ce("isInModal")||!1,{selectedRegions:a,comparedRegions:c}=Ve;re(t,a,m=>i(4,n=m)),re(t,c,m=>i(5,r=m));const u=`${window.location.origin}${window.location.pathname}`,f=window.location.pathname.match(/\d+/g).join("-"),d=(m,g)=>g?Object.keys(r).map(v=>r[v].id):Object.values(m[f]||{}).map(v=>v.id);async function h(m,g,v){const y=d(g,v);return y.length===0?[]:await(await fetch(`${u}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:y,qImg:m,topk:12}),headers:{"Content-Type":"application/json","X-CSRFToken":He}})).json()}return l?o=h(s,n,l):a.subscribe(m=>{i(1,o=h(s,m,l))}),t.$$set=m=>{"qImg"in m&&i(0,s=m.qImg)},[s,o,a,c]}class Ul extends ue{constructor(e){super(),ce(this,e,xl,Vl,le,{qImg:0})}}function Hl(t){let e,i,n,r;return n=new vs({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){e=w("div"),i=w("div"),Z(n.$$.fragment),p(i,"class","matches-suggestion svelte-1cb4wg0"),p(e,"class","block matches-suggestion-wrapper svelte-1cb4wg0")},m(s,o){C(s,e,o),b(e,i),X(n,i,null),r=!0},p(s,[o]){const l={};o&1&&(l.qImg=s[0]),o&2&&(l.sImgsPromise=s[1]),n.$set(l)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){M(n.$$.fragment,s),r=!1},d(s){s&&k(e),Q(n)}}}function Bl(t,e,i){let n,r,{qImg:s}=e;const{propagateParams:o,selectedRegions:l}=Ve;re(t,o,v=>i(4,n=v)),re(t,l,v=>i(5,r=v));const a=`${window.location.origin}${window.location.pathname}`,c=window.location.pathname.match(/\d+/g).join("-"),u=Ce("isInModal")||!1;let f;const d=fi();d.setCompareFn((v,y)=>[v,y].every(E=>E&&E.hasOwnProperty("propagateRecursionDepth")&&E.hasOwnProperty("propagateFilterByRegions"))?v.propagateRecursionDepth===y.propagateRecursionDepth&&v.propagateFilterByRegions===y.propagateFilterByRegions:!1);const h=fi();h.setCompareFn(sn),Ze("similarityPropagatedContext",!0);const m=v=>Object.keys(v).includes(c)?Object.values(v[c]).map(y=>y.id):[],g=async(v,y,E)=>fetch(`${a}propagated-matches/${s}`,{method:"POST",body:JSON.stringify({regionsIds:E?[]:y,filterByRegions:E?!1:v.propagateFilterByRegions,recursionDepth:v.propagateRecursionDepth}),headers:{"Content-Type":"application/json","X-CSRFToken":He}}).then(T=>T.json()).catch(T=>(console.error("PropagatedMatches.getPropagatedMatches:",T),[]));return o.subscribe(v=>{d.set(v),d.same()||i(1,f=g(d.get(),m(r),u))}),l.subscribe(v=>{h.set(m(v)),n.propagateFilterByRegions===!0&&!h.same()&&i(1,f=g(n,h.get(),u))}),t.$$set=v=>{"qImg"in v&&i(0,s=v.qImg)},[s,f,o,l]}class zl extends ue{constructor(e){super(),ce(this,e,Bl,Hl,le,{qImg:0})}}const ql=t=>({}),qn=t=>({}),Kl=t=>({}),Kn=t=>({}),Gl=t=>({}),Gn=t=>({});function Wl(t){let e;const i=t[4]["row-body"],n=ut(i,t,t[3],qn);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&8)&&dt(n,i,r,r[3],e?ft(i,r[3],s,ql):ht(r[3]),qn)},i(r){e||(P(n,r),e=!0)},o(r){M(n,r),e=!1},d(r){n&&n.d(r)}}}function Yl(t){let e,i,n,r;const s=t[4]["row-body"],o=ut(s,t,t[3],Kn);return{c(){e=w("div"),i=w("div"),o&&o.c(),p(i,"class","grid is-gap-2"),p(e,"class",n="fixed-grid has-"+t[2]+"-cols")},m(l,a){C(l,e,a),b(e,i),o&&o.m(i,null),r=!0},p(l,a){o&&o.p&&(!r||a&8)&&dt(o,s,l,l[3],r?ft(s,l[3],a,Kl):ht(l[3]),Kn),(!r||a&4&&n!==(n="fixed-grid has-"+l[2]+"-cols"))&&p(e,"class",n)},i(l){r||(P(o,l),r=!0)},o(l){M(o,l),r=!1},d(l){l&&k(e),o&&o.d(l)}}}function Jl(t){let e,i,n,r,s,o,l,a,c,u;Ge(t[5]);const f=t[4]["row-header"],d=ut(f,t,t[3],Gn),h=[Yl,Wl],m=[];function g(v,y){return v[0]?0:1}return o=g(t),l=m[o]=h[o](t),{c(){e=w("tr"),i=w("th"),n=w("div"),d&&d.c(),r=x(),s=w("td"),l.c(),p(n,"class","content-wrapper py-5"),p(i,"class","is-3 center-flex is-narrow"),kt(i,"width","15vw"),p(s,"class","p-5 is-fullwidth")},m(v,y){C(v,e,y),b(e,i),b(i,n),d&&d.m(n,null),b(e,r),b(e,s),m[o].m(s,null),a=!0,c||(u=oe(window,"resize",t[5]),c=!0)},p(v,[y]){d&&d.p&&(!a||y&8)&&dt(d,f,v,v[3],a?ft(f,v[3],y,Gl):ht(v[3]),Gn);let E=o;o=g(v),o===E?m[o].p(v,y):(ve(),M(m[E],1,1,()=>{m[E]=null}),be(),l=m[o],l?l.p(v,y):(l=m[o]=h[o](v),l.c()),P(l,1),l.m(s,null))},i(v){a||(P(d,v),P(l),a=!0)},o(v){M(d,v),M(l),a=!1},d(v){v&&k(e),d&&d.d(v),m[o].d(),c=!1,u()}}}function Xl(t,e,i){let n,{$$slots:r={},$$scope:s}=e,{useGrid:o=!0}=e,l=0;function a(){i(1,l=window.innerWidth)}return t.$$set=c=>{"useGrid"in c&&i(0,o=c.useGrid),"$$scope"in c&&i(3,s=c.$$scope)},t.$$.update=()=>{t.$$.dirty&2&&i(2,n=ns(l))},[o,l,n,s,r,a]}class bs extends ue{constructor(e){super(),ce(this,e,Xl,Jl,le,{useGrid:0})}}function Ql(t){let e,i,n,r=parseInt(t[5])+"",s,o,l,a,c,u,f,d,h,m,g,v,y,E,T,H,F,B,L;return{c(){e=w("a"),i=w("i"),n=Y(`
            Page `),s=Y(r),o=x(),l=w("img"),c=x(),u=w("div"),f=w("div"),d=w("input"),h=x(),m=w("button"),m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',g=x(),v=w("button"),y=Ke("svg"),E=Ke("path"),p(i,"class","fa-solid fa-pen-to-square"),p(e,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),p(e,"href",ui(t[6],parseInt(t[5]))),p(e,"target","_blank"),it(l.src,a=at(t[0],t[0].split("_").pop(),"250,"))||p(l,"src",a),p(l,"alt","Query region"),p(l,"class","mb-3 card query-image svelte-f4ylwc"),p(d,"class","input is-small tag"),p(d,"type","text"),p(d,"placeholder",j==="en"?"Add new match":"Ajouter une correspondance"),p(m,"class","button is-small tag is-link is-center"),p(f,"class","tags has-addons"),kt(f,"flex-wrap","nowrap"),p(E,"fill","white"),p(E,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),p(y,"xmlns","http://www.w3.org/2000/svg"),p(y,"viewBox","0 0 384 512"),p(v,"id","no-match"),p(v,"class",T="button is-small tag is-danger is-center m-0 "+(t[3]===1?"visible":"")+" svelte-f4ylwc"),p(v,"title",j==="en"?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),p(u,"class","new-similarity control pt-2 is-center svelte-f4ylwc")},m(I,O){C(I,e,O),b(e,i),b(e,n),b(e,s),C(I,o,O),C(I,l,O),C(I,c,O),C(I,u,O),b(u,f),b(f,d),li(d,t[1]),b(f,h),b(f,m),b(u,g),b(u,v),b(v,y),b(y,E),F=!0,B||(L=[oe(d,"input",t[12]),oe(m,"click",t[8]),oe(v,"click",t[9])],B=!0)},p(I,O){(!F||O&1&&!it(l.src,a=at(I[0],I[0].split("_").pop(),"250,")))&&p(l,"src",a),O&2&&d.value!==I[1]&&li(d,I[1]),(!F||O&8&&T!==(T="button is-small tag is-danger is-center m-0 "+(I[3]===1?"visible":"")+" svelte-f4ylwc"))&&p(v,"class",T)},i(I){F||(Ge(()=>{F&&(H||(H=Ue(v,Xe,{duration:500},!0)),H.run(1))}),F=!0)},o(I){H||(H=Ue(v,Xe,{duration:500},!1)),H.run(0),F=!1},d(I){I&&k(e),I&&k(o),I&&k(l),I&&k(c),I&&k(u),I&&H&&H.end(),B=!1,Ie(L)}}}function Zl(t){let e,i,n,r,s,o,l,a;return i=new Ul({props:{qImg:t[0]}}),o=new zl({props:{qImg:t[0]}}),{c(){e=w("div"),Z(i.$$.fragment),r=x(),s=w("div"),Z(o.$$.fragment),p(e,"class",n=ei(t[7]?"":t[2])+" svelte-f4ylwc"),p(s,"class",l=ei(t[7]?"":t[2])+" svelte-f4ylwc")},m(c,u){C(c,e,u),X(i,e,null),C(c,r,u),C(c,s,u),X(o,s,null),a=!0},p(c,u){const f={};u&1&&(f.qImg=c[0]),i.$set(f),(!a||u&4&&n!==(n=ei(c[7]?"":c[2])+" svelte-f4ylwc"))&&p(e,"class",n);const d={};u&1&&(d.qImg=c[0]),o.$set(d),(!a||u&4&&l!==(l=ei(c[7]?"":c[2])+" svelte-f4ylwc"))&&p(s,"class",l)},i(c){a||(P(i.$$.fragment,c),P(o.$$.fragment,c),a=!0)},o(c){M(i.$$.fragment,c),M(o.$$.fragment,c),a=!1},d(c){c&&k(e),Q(i),c&&k(r),c&&k(s),Q(o)}}}function ea(t){let e,i;return e=new bs({props:{useGrid:!1,$$slots:{"row-body":[Zl],"row-header":[Ql]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,[r]){const s={};r&1048591&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function ta(t){return t=t.replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(t)}function ia(t,e,i){let n,r,s,o;const{selectedRegions:l}=Ve;re(t,l,B=>i(11,o=B));let{qImg:a}=e,c="";const[u,f,d,h]=a.split(".")[0].split("_"),m=`${window.location.origin}${window.location.pathname}`,g=window.location.pathname.match(/\d+/g).join("-"),v=j==="en"?"Error":"Erreur",y=Ce("manifest"),E=Ce("isInModal")||!1;Ze("qImgMetadata",ls(a,u,h,d));async function T(){if(!c||!ta(c)){await Te(j==="en"?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error");return}try{const B=await fetch(`${m}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":He},body:JSON.stringify({q_img:a.replace(".jpg",""),s_img:c,similarity_type:2})});B.ok||(console.error("Error: Network response was not ok"),await Te(j==="en"?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",v));const L=await B.json();if(L.hasOwnProperty("error")||!L.hasOwnProperty("s_regions")){await Te(j==="en"?`Request was unsuccessful, match was not added:<br>${L.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${L.error}`,v);return}const I=L.s_regions;Ve.addComparedRegions(I),Ve.select(I)}catch(B){console.error("Error:",B),await Te(j==="en"?`An error has occurred, match was not added:<br>${B}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${B}`,v)}}async function H(){const B=Object.values(o[g])[0];if(await Te(j==="en"?`Do you confirm this region does not have any match in ${B.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${B.title} ?`,j==="en"?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${m}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":He},body:JSON.stringify({q_img:a,s_regions:B.id})})).ok||(console.error("Error: Network response was not ok"),await Te(j==="en"?"Problem with network":"Problème de réseau",v)),Ve.select(B)}catch(I){console.error("Error:",I),await Te(j==="en"?`An error has occurred, request was unsuccessful:<br>${I}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${I}`,v)}}function F(){c=this.value,i(1,c)}return t.$$set=B=>{"qImg"in B&&i(0,a=B.qImg)},t.$$.update=()=>{t.$$.dirty&2048&&i(3,n=o.hasOwnProperty(g)?Object.values(o[g]).length:0),t.$$.dirty&1024&&i(2,s=`fixed-grid has-${r-1}-cols`)},i(10,r=ns(window.innerWidth)),[a,c,s,n,l,d,y,E,T,H,r,o,F]}class na extends ue{constructor(e){super(),ce(this,e,ia,ea,le,{qImg:0})}}function Wn(t,e,i){const n=t.slice();return n[8]=e[i],n}function ra(t){let e,i,n=t[11]+"",r;return{c(){e=w("tr"),i=Y("Error when retrieving similar regions: "),r=Y(n)},m(s,o){C(s,e,o),b(e,i),b(e,r)},p(s,o){o&2&&n!==(n=s[11]+"")&&de(r,n)},i:N,o:N,d(s){s&&k(e)}}}function sa(t){let e=[],i=new Map,n,r,s=t[2];const o=a=>a[8].id;for(let a=0;a<s.length;a+=1){let c=Wn(t,s,a),u=o(c);i.set(u,e[a]=Jn(u,c))}let l=null;return s.length||(l=Yn()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),l&&l.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);C(a,n,c),l&&l.m(a,c),r=!0},p(a,c){c&4&&(s=a[2],ve(),e=Yt(e,c,o,1,a,s,i,n.parentNode,Wt,Jn,n,Wn),be(),!s.length&&l?l.p(a,c):s.length?l&&(l.d(1),l=null):(l=Yn(),l.c(),l.m(n.parentNode,n)))},i(a){if(!r){for(let c=0;c<s.length;c+=1)P(e[c]);r=!0}},o(a){for(let c=0;c<e.length;c+=1)M(e[c]);r=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),l&&l.d(a)}}}function Yn(t){let e,i;return{c(){e=w("tr"),e.textContent=`${j==="en"?"No similarity":"Pas de similarités"}`,i=x(),p(e,"class","faded is-center")},m(n,r){C(n,e,r),C(n,i,r)},p:N,d(n){n&&k(e),n&&k(i)}}}function Jn(t,e){let i,n,r;return n=new na({props:{qImg:e[8]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(s,o){C(s,i,o),X(n,s,o),r=!0},p(s,o){e=s;const l={};o&4&&(l.qImg=e[8]),n.$set(l)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){M(n.$$.fragment,s),r=!1},d(s){s&&k(i),Q(n,s)}}}function oa(t){let e;return{c(){e=w("tr"),e.textContent=`${j==="en"?"Retrieving similarity page...":"Récupération la page de similarité..."}`,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,i:N,o:N,d(i){i&&k(e)}}}function la(t){let e,i,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:oa,then:sa,catch:ra,value:7,error:11,blocks:[,,,]};return nt(i=t[1],r),{c(){e=he(),r.block.c()},m(s,o){C(s,e,o),r.block.m(s,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(s,o){t=s,r.ctx=t,o&2&&i!==(i=t[1])&&nt(i,r)||Dt(r,t,o)},i(s){n||(P(r.block),n=!0)},o(s){for(let o=0;o<3;o+=1){const l=r.blocks[o];M(l)}n=!1},d(s){s&&k(e),r.block.d(s),r.token=null,r=null}}}function aa(t){let e,i,n,r,s,o,l;return i=new Lt({props:{store:Ve,nbOfItems:t[0].length,pageLength:t[6]}}),r=new gi({props:{$$slots:{default:[la]},$$scope:{ctx:t}}}),o=new Lt({props:{store:Ve,nbOfItems:t[0].length,pageLength:t[6]}}),{c(){e=w("div"),Z(i.$$.fragment),n=x(),Z(r.$$.fragment),s=x(),Z(o.$$.fragment)},m(a,c){C(a,e,c),X(i,e,null),b(e,n),X(r,e,null),b(e,s),X(o,e,null),l=!0},p(a,[c]){const u={};c&1&&(u.nbOfItems=a[0].length),i.$set(u);const f={};c&4102&&(f.$$scope={dirty:c,ctx:a}),r.$set(f);const d={};c&1&&(d.nbOfItems=a[0].length),o.$set(d)},i(a){l||(P(i.$$.fragment,a),P(r.$$.fragment,a),P(o.$$.fragment,a),l=!0)},o(a){M(i.$$.fragment,a),M(r.$$.fragment,a),M(o.$$.fragment,a),l=!1},d(a){a&&k(e),Q(i),Q(r),Q(o)}}}function ca(t,e,i){let n,r,s;const{qImgs:o,pageQImgs:l,setPageQImgs:a,pageLength:c}=Ve;return re(t,o,u=>i(0,n=u)),re(t,l,u=>i(2,s=u)),re(t,a,u=>i(1,r=u)),[n,r,s,o,l,a,c]}class ua extends ue{constructor(e){super(),ce(this,e,ca,aa,le,{})}}var ot;(function(t){t.Range="range",t.Steps="steps",t.Positions="positions",t.Count="count",t.Values="values"})(ot||(ot={}));var Me;(function(t){t[t.None=-1]="None",t[t.NoValue=0]="NoValue",t[t.LargeValue=1]="LargeValue",t[t.SmallValue=2]="SmallValue"})(Me||(Me={}));function fa(t){return di(t)&&typeof t.from=="function"}function di(t){return typeof t=="object"&&typeof t.to=="function"}function Xn(t){t.parentElement.removeChild(t)}function Ui(t){return t!=null}function Qn(t){t.preventDefault()}function da(t){return t.filter(function(e){return this[e]?!1:this[e]=!0},{})}function ha(t,e){return Math.round(t/e)*e}function pa(t,e){var i=t.getBoundingClientRect(),n=t.ownerDocument,r=n.documentElement,s=ys(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(s.x=0),e?i.top+s.y-r.clientTop:i.left+s.x-r.clientLeft}function qe(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function Zn(t,e,i){i>0&&(Re(t,e),setTimeout(function(){si(t,e)},i))}function er(t){return Math.max(Math.min(t,100),0)}function _i(t){return Array.isArray(t)?t:[t]}function ma(t){t=String(t);var e=t.split(".");return e.length>1?e[1].length:0}function Re(t,e){t.classList&&!/\s/.test(e)?t.classList.add(e):t.className+=" "+e}function si(t,e){t.classList&&!/\s/.test(e)?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function ga(t,e){return t.classList?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)}function ys(t){var e=window.pageXOffset!==void 0,i=(t.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:i?t.documentElement.scrollLeft:t.body.scrollLeft,r=e?window.pageYOffset:i?t.documentElement.scrollTop:t.body.scrollTop;return{x:n,y:r}}function _a(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function va(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch{}return t}function ba(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function an(t,e){return 100/(e-t)}function Hi(t,e,i){return e*100/(t[i+1]-t[i])}function ya(t,e){return Hi(t,t[0]<0?e+Math.abs(t[0]):e-t[0],0)}function wa(t,e){return e*(t[1]-t[0])/100+t[0]}function Kt(t,e){for(var i=1;t>=e[i];)i+=1;return i}function Sa(t,e,i){if(i>=t.slice(-1)[0])return 100;var n=Kt(i,t),r=t[n-1],s=t[n],o=e[n-1],l=e[n];return o+ya([r,s],i)/an(o,l)}function Ea(t,e,i){if(i>=100)return t.slice(-1)[0];var n=Kt(i,e),r=t[n-1],s=t[n],o=e[n-1],l=e[n];return wa([r,s],(i-o)*an(o,l))}function ka(t,e,i,n){if(n===100)return n;var r=Kt(n,t),s=t[r-1],o=t[r];return i?n-s>(o-s)/2?o:s:e[r-1]?t[r-1]+ha(n-t[r-1],e[r-1]):n}var ws=function(){function t(e,i,n){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=i;var r,s=[];for(Object.keys(e).forEach(function(o){s.push([_i(e[o]),o])}),s.sort(function(o,l){return o[0][0]-l[0][0]}),r=0;r<s.length;r++)this.handleEntryPoint(s[r][1],s[r][0]);for(this.xNumSteps=this.xSteps.slice(0),r=0;r<this.xNumSteps.length;r++)this.handleStepPoint(r,this.xNumSteps[r])}return t.prototype.getDistance=function(e){for(var i=[],n=0;n<this.xNumSteps.length-1;n++)i[n]=Hi(this.xVal,e,n);return i},t.prototype.getAbsoluteDistance=function(e,i,n){var r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);!n&&e===this.xPct[r+1]&&r++,i===null&&(i=[]);var s,o=1,l=i[r],a=0,c=0,u=0,f=0;for(n?s=(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):s=(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);l>0;)a=this.xPct[r+1+f]-this.xPct[r+f],i[r+f]*o+100-s*100>100?(c=a*s,o=(l-100*s)/i[r+f],s=1):(c=i[r+f]*a/100*o,o=0),n?(u=u-c,this.xPct.length+f>=1&&f--):(u=u+c,this.xPct.length-f>=1&&f++),l=i[r+f]*o;return e+u},t.prototype.toStepping=function(e){return e=Sa(this.xVal,this.xPct,e),e},t.prototype.fromStepping=function(e){return Ea(this.xVal,this.xPct,e)},t.prototype.getStep=function(e){return e=ka(this.xPct,this.xSteps,this.snap,e),e},t.prototype.getDefaultStep=function(e,i,n){var r=Kt(e,this.xPct);return(e===100||i&&e===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/n},t.prototype.getNearbySteps=function(e){var i=Kt(e,this.xPct);return{stepBefore:{startValue:this.xVal[i-2],step:this.xNumSteps[i-2],highestStep:this.xHighestCompleteStep[i-2]},thisStep:{startValue:this.xVal[i-1],step:this.xNumSteps[i-1],highestStep:this.xHighestCompleteStep[i-1]},stepAfter:{startValue:this.xVal[i],step:this.xNumSteps[i],highestStep:this.xHighestCompleteStep[i]}}},t.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(ma);return Math.max.apply(null,e)},t.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},t.prototype.convert=function(e){return this.getStep(this.toStepping(e))},t.prototype.handleEntryPoint=function(e,i){var n;if(e==="min"?n=0:e==="max"?n=100:n=parseFloat(e),!qe(n)||!qe(i[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(i[0]);var r=Number(i[1]);n?this.xSteps.push(isNaN(r)?!1:r):isNaN(r)||(this.xSteps[0]=r),this.xHighestCompleteStep.push(0)},t.prototype.handleStepPoint=function(e,i){if(i){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=Hi([this.xVal[e],this.xVal[e+1]],i,0)/an(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],r=Math.ceil(Number(n.toFixed(3))-1),s=this.xVal[e]+this.xNumSteps[e]*r;this.xHighestCompleteStep[e]=s}},t}(),tr={to:function(t){return t===void 0?"":t.toFixed(2)},from:Number},Ss={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},st={tooltips:".__tooltips",aria:".__aria"};function Ca(t,e){if(!qe(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function Ia(t,e){if(!qe(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");t.keyboardPageMultiplier=e}function Aa(t,e){if(!qe(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");t.keyboardMultiplier=e}function Oa(t,e){if(!qe(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");t.keyboardDefaultStep=e}function Ta(t,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");t.spectrum=new ws(e,t.snap||!1,t.singleStep)}function Pa(t,e){if(e=_i(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=e.length,t.start=e}function La(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");t.snap=e}function Ra(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");t.animate=e}function Ma(t,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");t.animationDuration=e}function Es(t,e){var i=[!1],n;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(n=1;n<t.handles;n++)i.push(e);i.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");i=e}t.connect=i}function Da(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function ks(t,e){if(!qe(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(t.margin=t.spectrum.getDistance(e))}function Na(t,e){if(!qe(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getDistance(e),!t.limit||t.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function $a(t,e){var i;if(!qe(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||qe(e[0])||qe(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),t.padding=[t.spectrum.getDistance(e[0]),t.spectrum.getDistance(e[1])],i=0;i<t.spectrum.xNumSteps.length-1;i++)if(t.padding[0][i]<0||t.padding[1][i]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var n=e[0]+e[1],r=t.spectrum.xVal[0],s=t.spectrum.xVal[t.spectrum.xVal.length-1];if(n/(s-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function ja(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Fa(t,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var i=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,s=e.indexOf("snap")>=0,o=e.indexOf("hover")>=0,l=e.indexOf("unconstrained")>=0,a=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,u=e.indexOf("smooth-steps")>=0;if(r){if(t.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");ks(t,t.start[1]-t.start[0])}if(a&&t.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(l&&(t.margin||t.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:i||s,drag:n,dragAll:c,smoothSteps:u,fixed:r,snap:s,hover:o,unconstrained:l,invertConnects:a}}function Va(t,e){if(e!==!1)if(e===!0||di(e)){t.tooltips=[];for(var i=0;i<t.handles;i++)t.tooltips.push(e)}else{if(e=_i(e),e.length!==t.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(n){if(typeof n!="boolean"&&!di(n))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),t.tooltips=e}}function xa(t,e){if(e.length!==t.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");t.handleAttributes=e}function Ua(t,e){if(!di(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");t.ariaFormat=e}function Ha(t,e){if(!fa(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");t.format=e}function Ba(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");t.keyboardSupport=e}function za(t,e){t.documentElement=e}function qa(t,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function Ka(t,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof t.cssPrefix=="string"?(t.cssClasses={},Object.keys(e).forEach(function(i){t.cssClasses[i]=t.cssPrefix+e[i]})):t.cssClasses=e}function Cs(t){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:tr,format:tr},i={step:{r:!1,t:Ca},keyboardPageMultiplier:{r:!1,t:Ia},keyboardMultiplier:{r:!1,t:Aa},keyboardDefaultStep:{r:!1,t:Oa},start:{r:!0,t:Pa},connect:{r:!0,t:Es},direction:{r:!0,t:ja},snap:{r:!1,t:La},animate:{r:!1,t:Ra},animationDuration:{r:!1,t:Ma},range:{r:!0,t:Ta},orientation:{r:!1,t:Da},margin:{r:!1,t:ks},limit:{r:!1,t:Na},padding:{r:!1,t:$a},behaviour:{r:!0,t:Fa},ariaFormat:{r:!1,t:Ua},format:{r:!1,t:Ha},tooltips:{r:!1,t:Va},keyboardSupport:{r:!0,t:Ba},documentElement:{r:!1,t:za},cssPrefix:{r:!0,t:qa},cssClasses:{r:!0,t:Ka},handleAttributes:{r:!1,t:xa}},n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Ss,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(i).forEach(function(a){if(!Ui(t[a])&&n[a]===void 0){if(i[a].r)throw new Error("noUiSlider: '"+a+"' is required.");return}i[a].t(e,Ui(t[a])?t[a]:n[a])}),e.pips=t.pips;var r=document.createElement("div"),s=r.style.msTransform!==void 0,o=r.style.transform!==void 0;e.transformRule=o?"transform":s?"msTransform":"webkitTransform";var l=[["left","top"],["right","bottom"]];return e.style=l[e.dir][e.ort],e}function Ga(t,e,i){var n=_a(),r=ba(),s=r&&va(),o=t,l,a,c,u,f,d,h=e.spectrum,m=[],g=[],v=[],y=0,E={},T=!1,H=t.ownerDocument,F=e.documentElement||H.documentElement,B=H.body,L=H.dir==="rtl"||e.ort===1?0:100;function I(_,S){var A=H.createElement("div");return S&&Re(A,S),_.appendChild(A),A}function O(_,S){var A=I(_,e.cssClasses.origin),V=I(A,e.cssClasses.handle);if(I(V,e.cssClasses.touchArea),V.setAttribute("data-handle",String(S)),e.keyboardSupport&&(V.setAttribute("tabindex","0"),V.addEventListener("keydown",function(G){return Js(G,S)})),e.handleAttributes!==void 0){var K=e.handleAttributes[S];Object.keys(K).forEach(function(G){V.setAttribute(G,K[G])})}return V.setAttribute("role","slider"),V.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),S===0?Re(V,e.cssClasses.handleLower):S===e.handles-1&&Re(V,e.cssClasses.handleUpper),A.handle=V,A}function q(_,S){return S?I(_,e.cssClasses.connect):!1}function R(_,S){a=I(S,e.cssClasses.connects),c=[],u=[],u.push(q(a,_[0]));for(var A=0;A<e.handles;A++)c.push(O(S,A)),v[A]=A,u.push(q(a,_[A+1]))}function D(_){Re(_,e.cssClasses.target),e.dir===0?Re(_,e.cssClasses.ltr):Re(_,e.cssClasses.rtl),e.ort===0?Re(_,e.cssClasses.horizontal):Re(_,e.cssClasses.vertical);var S=getComputedStyle(_).direction;return S==="rtl"?Re(_,e.cssClasses.textDirectionRtl):Re(_,e.cssClasses.textDirectionLtr),I(_,e.cssClasses.base)}function $(_,S){return!e.tooltips||!e.tooltips[S]?!1:I(_.firstChild,e.cssClasses.tooltip)}function W(){return o.hasAttribute("disabled")}function z(_){var S=c[_];return S.hasAttribute("disabled")}function U(_){_!=null?(c[_].setAttribute("disabled",""),c[_].handle.removeAttribute("tabindex")):(o.setAttribute("disabled",""),c.forEach(function(S){S.handle.removeAttribute("tabindex")}))}function ne(_){_!=null?(c[_].removeAttribute("disabled"),c[_].handle.setAttribute("tabindex","0")):(o.removeAttribute("disabled"),c.forEach(function(S){S.removeAttribute("disabled"),S.handle.setAttribute("tabindex","0")}))}function ae(){d&&(jt("update"+st.tooltips),d.forEach(function(_){_&&Xn(_)}),d=null)}function se(){ae(),d=c.map($),Ci("update"+st.tooltips,function(_,S,A){if(!(!d||!e.tooltips)&&d[S]!==!1){var V=_[S];e.tooltips[S]!==!0&&(V=e.tooltips[S].to(A[S])),d[S].innerHTML=V}})}function Be(){jt("update"+st.aria),Ci("update"+st.aria,function(_,S,A,V,K){v.forEach(function(G){var ee=c[G],J=Jt(g,G,0,!0,!0,!0),pe=Jt(g,G,100,!0,!0,!0),me=K[G],ge=String(e.ariaFormat.to(A[G]));J=h.fromStepping(J).toFixed(1),pe=h.fromStepping(pe).toFixed(1),me=h.fromStepping(me).toFixed(1),ee.children[0].setAttribute("aria-valuemin",J),ee.children[0].setAttribute("aria-valuemax",pe),ee.children[0].setAttribute("aria-valuenow",me),ee.children[0].setAttribute("aria-valuetext",ge)})})}function $t(_){if(_.mode===ot.Range||_.mode===ot.Steps)return h.xVal;if(_.mode===ot.Count){if(_.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var S=_.values-1,A=100/S,V=[];S--;)V[S]=S*A;return V.push(100),ze(V,_.stepped)}return _.mode===ot.Positions?ze(_.values,_.stepped):_.mode===ot.Values?_.stepped?_.values.map(function(K){return h.fromStepping(h.getStep(h.toStepping(K)))}):_.values:[]}function ze(_,S){return _.map(function(A){return h.fromStepping(S?h.getStep(A):A)})}function Hs(_){function S(me,ge){return Number((me+ge).toFixed(7))}var A=$t(_),V={},K=h.xVal[0],G=h.xVal[h.xVal.length-1],ee=!1,J=!1,pe=0;return A=da(A.slice().sort(function(me,ge){return me-ge})),A[0]!==K&&(A.unshift(K),ee=!0),A[A.length-1]!==G&&(A.push(G),J=!0),A.forEach(function(me,ge){var _e,fe,Ee,Pe=me,ke=A[ge+1],Ae,Oi,Ti,Pi,yn,Li,wn,Sn=_.mode===ot.Steps;for(Sn&&(_e=h.xNumSteps[ge]),_e||(_e=ke-Pe),ke===void 0&&(ke=Pe),_e=Math.max(_e,1e-7),fe=Pe;fe<=ke;fe=S(fe,_e)){for(Ae=h.toStepping(fe),Oi=Ae-pe,yn=Oi/(_.density||1),Li=Math.round(yn),wn=Oi/Li,Ee=1;Ee<=Li;Ee+=1)Ti=pe+Ee*wn,V[Ti.toFixed(5)]=[h.fromStepping(Ti),0];Pi=A.indexOf(fe)>-1?Me.LargeValue:Sn?Me.SmallValue:Me.NoValue,!ge&&ee&&fe!==ke&&(Pi=0),fe===ke&&J||(V[Ae.toFixed(5)]=[fe,Pi]),pe=Ae}}),V}function Bs(_,S,A){var V,K,G=H.createElement("div"),ee=(V={},V[Me.None]="",V[Me.NoValue]=e.cssClasses.valueNormal,V[Me.LargeValue]=e.cssClasses.valueLarge,V[Me.SmallValue]=e.cssClasses.valueSub,V),J=(K={},K[Me.None]="",K[Me.NoValue]=e.cssClasses.markerNormal,K[Me.LargeValue]=e.cssClasses.markerLarge,K[Me.SmallValue]=e.cssClasses.markerSub,K),pe=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],me=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];Re(G,e.cssClasses.pips),Re(G,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function ge(fe,Ee){var Pe=Ee===e.cssClasses.value,ke=Pe?pe:me,Ae=Pe?ee:J;return Ee+" "+ke[e.ort]+" "+Ae[fe]}function _e(fe,Ee,Pe){if(Pe=S?S(Ee,Pe):Pe,Pe!==Me.None){var ke=I(G,!1);ke.className=ge(Pe,e.cssClasses.marker),ke.style[e.style]=fe+"%",Pe>Me.NoValue&&(ke=I(G,!1),ke.className=ge(Pe,e.cssClasses.value),ke.setAttribute("data-value",String(Ee)),ke.style[e.style]=fe+"%",ke.innerHTML=String(A.to(Ee)))}}return Object.keys(_).forEach(function(fe){_e(fe,_[fe][0],_[fe][1])}),G}function wi(){f&&(Xn(f),f=null)}function Si(_){wi();var S=Hs(_),A=_.filter,V=_.format||{to:function(K){return String(Math.round(K))}};return f=o.appendChild(Bs(S,A,V)),f}function fn(){var _=l.getBoundingClientRect(),S="offset"+["Width","Height"][e.ort];return e.ort===0?_.width||l[S]:_.height||l[S]}function mt(_,S,A,V){var K=function(ee){var J=zs(ee,V.pageOffset,V.target||S);if(!J||W()&&!V.doNotReject||ga(o,e.cssClasses.tap)&&!V.doNotReject||_===n.start&&J.buttons!==void 0&&J.buttons>1||V.hover&&J.buttons)return!1;s||J.preventDefault(),J.calcPoint=J.points[e.ort],A(J,V)},G=[];return _.split(" ").forEach(function(ee){S.addEventListener(ee,K,s?{passive:!0}:!1),G.push([ee,K])}),G}function zs(_,S,A){var V=_.type.indexOf("touch")===0,K=_.type.indexOf("mouse")===0,G=_.type.indexOf("pointer")===0,ee=0,J=0;if(_.type.indexOf("MSPointer")===0&&(G=!0),_.type==="mousedown"&&!_.buttons&&!_.touches)return!1;if(V){var pe=function(_e){var fe=_e.target;return fe===A||A.contains(fe)||_.composed&&_.composedPath().shift()===A};if(_.type==="touchstart"){var me=Array.prototype.filter.call(_.touches,pe);if(me.length>1)return!1;ee=me[0].pageX,J=me[0].pageY}else{var ge=Array.prototype.find.call(_.changedTouches,pe);if(!ge)return!1;ee=ge.pageX,J=ge.pageY}}return S=S||ys(H),(K||G)&&(ee=_.clientX+S.x,J=_.clientY+S.y),_.pageOffset=S,_.points=[ee,J],_.cursor=K||G,_}function dn(_){var S=_-pa(l,e.ort),A=S*100/fn();return A=er(A),e.dir?100-A:A}function qs(_){var S=100,A=!1;return c.forEach(function(V,K){if(!z(K)){var G=g[K],ee=Math.abs(G-_),J=ee===100&&S===100,pe=ee<S,me=ee<=S&&_>G;(pe||me||J)&&(A=K,S=ee)}}),A}function Ks(_,S){_.type==="mouseout"&&_.target.nodeName==="HTML"&&_.relatedTarget===null&&Ei(_,S)}function Gs(_,S){if(navigator.appVersion.indexOf("MSIE 9")===-1&&_.buttons===0&&S.buttonsProperty!==0)return Ei(_,S);var A=(e.dir?-1:1)*(_.calcPoint-S.startCalcPoint),V=A*100/S.baseSize;pn(A>0,V,S.locations,S.handleNumbers,S.connect)}function Ei(_,S){S.handle&&(si(S.handle,e.cssClasses.active),y-=1),S.listeners.forEach(function(A){F.removeEventListener(A[0],A[1])}),y===0&&(si(o,e.cssClasses.drag),Ai(),_.cursor&&(B.style.cursor="",B.removeEventListener("selectstart",Qn))),e.events.smoothSteps&&(S.handleNumbers.forEach(function(A){gt(A,g[A],!0,!0,!1,!1)}),S.handleNumbers.forEach(function(A){ye("update",A)})),S.handleNumbers.forEach(function(A){ye("change",A),ye("set",A),ye("end",A)})}function ki(_,S){if(!S.handleNumbers.some(z)){var A;if(S.handleNumbers.length===1){var V=c[S.handleNumbers[0]];A=V.children[0],y+=1,Re(A,e.cssClasses.active)}_.stopPropagation();var K=[],G=mt(n.move,F,Gs,{target:_.target,handle:A,connect:S.connect,listeners:K,startCalcPoint:_.calcPoint,baseSize:fn(),pageOffset:_.pageOffset,handleNumbers:S.handleNumbers,buttonsProperty:_.buttons,locations:g.slice()}),ee=mt(n.end,F,Ei,{target:_.target,handle:A,listeners:K,doNotReject:!0,handleNumbers:S.handleNumbers}),J=mt("mouseout",F,Ks,{target:_.target,handle:A,listeners:K,doNotReject:!0,handleNumbers:S.handleNumbers});K.push.apply(K,G.concat(ee,J)),_.cursor&&(B.style.cursor=getComputedStyle(_.target).cursor,c.length>1&&Re(o,e.cssClasses.drag),B.addEventListener("selectstart",Qn,!1)),S.handleNumbers.forEach(function(pe){ye("start",pe)})}}function Ws(_){_.stopPropagation();var S=dn(_.calcPoint),A=qs(S);A!==!1&&(e.events.snap||Zn(o,e.cssClasses.tap,e.animationDuration),gt(A,S,!0,!0),Ai(),ye("slide",A,!0),ye("update",A,!0),e.events.snap?ki(_,{handleNumbers:[A]}):(ye("change",A,!0),ye("set",A,!0)))}function Ys(_){var S=dn(_.calcPoint),A=h.getStep(S),V=h.fromStepping(A);Object.keys(E).forEach(function(K){K.split(".")[0]==="hover"&&E[K].forEach(function(G){G.call(Qt,V)})})}function Js(_,S){if(W()||z(S))return!1;var A=["Left","Right"],V=["Down","Up"],K=["PageDown","PageUp"],G=["Home","End"];e.dir&&!e.ort?A.reverse():e.ort&&!e.dir&&(V.reverse(),K.reverse());var ee=_.key.replace("Arrow",""),J=ee===K[0],pe=ee===K[1],me=ee===V[0]||ee===A[0]||J,ge=ee===V[1]||ee===A[1]||pe,_e=ee===G[0],fe=ee===G[1];if(!me&&!ge&&!_e&&!fe)return!0;_.preventDefault();var Ee;if(ge||me){var Pe=me?0:1,ke=vn(S),Ae=ke[Pe];if(Ae===null)return!1;Ae===!1&&(Ae=h.getDefaultStep(g[S],me,e.keyboardDefaultStep)),pe||J?Ae*=e.keyboardPageMultiplier:Ae*=e.keyboardMultiplier,Ae=Math.max(Ae,1e-7),Ae=(me?-1:1)*Ae,Ee=m[S]+Ae}else fe?Ee=e.spectrum.xVal[e.spectrum.xVal.length-1]:Ee=e.spectrum.xVal[0];return gt(S,h.toStepping(Ee),!0,!0),ye("slide",S),ye("update",S),ye("change",S),ye("set",S),!1}function hn(_){_.fixed||c.forEach(function(S,A){mt(n.start,S.children[0],ki,{handleNumbers:[A]})}),_.tap&&mt(n.start,l,Ws,{}),_.hover&&mt(n.move,l,Ys,{hover:!0}),_.drag&&u.forEach(function(S,A){if(!(S===!1||A===0||A===u.length-1)){var V=c[A-1],K=c[A],G=[S],ee=[V,K],J=[A-1,A];Re(S,e.cssClasses.draggable),_.fixed&&(G.push(V.children[0]),G.push(K.children[0])),_.dragAll&&(ee=c,J=v),G.forEach(function(pe){mt(n.start,pe,ki,{handles:ee,handleNumbers:J,connect:S})})}})}function Ci(_,S){E[_]=E[_]||[],E[_].push(S),_.split(".")[0]==="update"&&c.forEach(function(A,V){ye("update",V)})}function Xs(_){return _===st.aria||_===st.tooltips}function jt(_){var S=_&&_.split(".")[0],A=S?_.substring(S.length):_;Object.keys(E).forEach(function(V){var K=V.split(".")[0],G=V.substring(K.length);(!S||S===K)&&(!A||A===G)&&(!Xs(G)||A===G)&&delete E[V]})}function ye(_,S,A){Object.keys(E).forEach(function(V){var K=V.split(".")[0];_===K&&E[V].forEach(function(G){G.call(Qt,m.map(e.format.to),S,m.slice(),A||!1,g.slice(),Qt)})})}function Jt(_,S,A,V,K,G,ee){var J;return c.length>1&&!e.events.unconstrained&&(V&&S>0&&(J=h.getAbsoluteDistance(_[S-1],e.margin,!1),A=Math.max(A,J)),K&&S<c.length-1&&(J=h.getAbsoluteDistance(_[S+1],e.margin,!0),A=Math.min(A,J))),c.length>1&&e.limit&&(V&&S>0&&(J=h.getAbsoluteDistance(_[S-1],e.limit,!1),A=Math.min(A,J)),K&&S<c.length-1&&(J=h.getAbsoluteDistance(_[S+1],e.limit,!0),A=Math.max(A,J))),e.padding&&(S===0&&(J=h.getAbsoluteDistance(0,e.padding[0],!1),A=Math.max(A,J)),S===c.length-1&&(J=h.getAbsoluteDistance(100,e.padding[1],!0),A=Math.min(A,J))),ee||(A=h.getStep(A)),A=er(A),A===_[S]&&!G?!1:A}function Ii(_,S){var A=e.ort;return(A?S:_)+", "+(A?_:S)}function pn(_,S,A,V,K){var G=A.slice(),ee=V[0],J=e.events.smoothSteps,pe=[!_,_],me=[_,!_];V=V.slice(),_&&V.reverse(),V.length>1?V.forEach(function(_e,fe){var Ee=Jt(G,_e,G[_e]+S,pe[fe],me[fe],!1,J);Ee===!1?S=0:(S=Ee-G[_e],G[_e]=Ee)}):pe=me=[!0];var ge=!1;V.forEach(function(_e,fe){ge=gt(_e,A[_e]+S,pe[fe],me[fe],!1,J)||ge}),ge&&(V.forEach(function(_e){ye("update",_e),ye("slide",_e)}),K!=null&&ye("drag",ee))}function mn(_,S){return e.dir?100-_-S:_}function Qs(_,S){g[_]=S,m[_]=h.fromStepping(S);var A=mn(S,0)-L,V="translate("+Ii(A+"%","0")+")";if(c[_].style[e.transformRule]=V,e.events.invertConnects&&g.length>1){var K=g.every(function(G,ee,J){return ee===0||G>=J[ee-1]});if(T!==!K){ro();return}}Ft(_),Ft(_+1),T&&(Ft(_-1),Ft(_+2))}function Ai(){v.forEach(function(_){var S=g[_]>50?-1:1,A=3+(c.length+S*_);c[_].style.zIndex=String(A)})}function gt(_,S,A,V,K,G){return K||(S=Jt(g,_,S,A,V,!1,G)),S===!1?!1:(Qs(_,S),!0)}function Ft(_){if(u[_]){var S=g.slice();T&&S.sort(function(J,pe){return J-pe});var A=0,V=100;_!==0&&(A=S[_-1]),_!==u.length-1&&(V=S[_]);var K=V-A,G="translate("+Ii(mn(A,K)+"%","0")+")",ee="scale("+Ii(K/100,"1")+")";u[_].style[e.transformRule]=G+" "+ee}}function gn(_,S){return _===null||_===!1||_===void 0||(typeof _=="number"&&(_=String(_)),_=e.format.from(_),_!==!1&&(_=h.toStepping(_)),_===!1||isNaN(_))?g[S]:_}function Xt(_,S,A){var V=_i(_),K=g[0]===void 0;S=S===void 0?!0:S,e.animate&&!K&&Zn(o,e.cssClasses.tap,e.animationDuration),v.forEach(function(J){gt(J,gn(V[J],J),!0,!1,A)});var G=v.length===1?0:1;if(K&&h.hasNoSize()&&(A=!0,g[0]=0,v.length>1)){var ee=100/(v.length-1);v.forEach(function(J){g[J]=J*ee})}for(;G<v.length;++G)v.forEach(function(J){gt(J,g[J],!0,!0,A)});Ai(),v.forEach(function(J){ye("update",J),V[J]!==null&&S&&ye("set",J)})}function Zs(_){Xt(e.start,_)}function eo(_,S,A,V){if(_=Number(_),!(_>=0&&_<v.length))throw new Error("noUiSlider: invalid handle number, got: "+_);gt(_,gn(S,_),!0,!0,V),ye("update",_),A&&ye("set",_)}function _n(_){if(_===void 0&&(_=!1),_)return m.length===1?m[0]:m.slice(0);var S=m.map(e.format.to);return S.length===1?S[0]:S}function to(){for(jt(st.aria),jt(st.tooltips),Object.keys(e.cssClasses).forEach(function(_){si(o,e.cssClasses[_])});o.firstChild;)o.removeChild(o.firstChild);delete o.noUiSlider}function vn(_){var S=g[_],A=h.getNearbySteps(S),V=m[_],K=A.thisStep.step,G=null;if(e.snap)return[V-A.stepBefore.startValue||null,A.stepAfter.startValue-V||null];K!==!1&&V+K>A.stepAfter.startValue&&(K=A.stepAfter.startValue-V),V>A.thisStep.startValue?G=A.thisStep.step:A.stepBefore.step===!1?G=!1:G=V-A.stepBefore.highestStep,S===100?K=null:S===0&&(G=null);var ee=h.countStepDecimals();return K!==null&&K!==!1&&(K=Number(K.toFixed(ee))),G!==null&&G!==!1&&(G=Number(G.toFixed(ee))),[G,K]}function io(){return v.map(vn)}function no(_,S){var A=_n(),V=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];V.forEach(function(G){_[G]!==void 0&&(i[G]=_[G])});var K=Cs(i);V.forEach(function(G){_[G]!==void 0&&(e[G]=K[G])}),h=K.spectrum,e.margin=K.margin,e.limit=K.limit,e.padding=K.padding,e.pips?Si(e.pips):wi(),e.tooltips?se():ae(),g=[],Xt(Ui(_.start)?_.start:A,S),_.connect&&bn()}function bn(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var _=0;_<=e.handles;_++)u[_]=q(a,e.connect[_]),Ft(_);hn({drag:e.events.drag,fixed:!0})}function ro(){T=!T,Es(e,e.connect.map(function(_){return!_})),bn()}function so(){l=D(o),R(e.connect,l),hn(e.events),Xt(e.start),e.pips&&Si(e.pips),e.tooltips&&se(),Be()}so();var Qt={destroy:to,steps:io,on:Ci,off:jt,get:_n,set:Xt,setHandle:eo,reset:Zs,disable:U,enable:ne,__moveHandles:function(_,S,A){pn(_,S,g,A)},options:i,updateOptions:no,target:o,removePips:wi,removeTooltips:ae,getPositions:function(){return g.slice()},getTooltips:function(){return d},getOrigins:function(){return c},pips:Si};return Qt}function Wa(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var i=Cs(e),n=Ga(t,i,e);return t.noUiSlider=n,n}const Ya={__spectrum:ws,cssClasses:Ss,create:Wa};function Ja(t){let e,i,n;return{c(){e=w("span"),i=Y(t[0]),p(e,"id",t[3]),p(e,"class",n="tooltip "+t[2]+" "+(t[1]?"display":"")+" svelte-1am23me")},m(r,s){C(r,e,s),b(e,i)},p(r,[s]){s&1&&de(i,r[0]),s&6&&n!==(n="tooltip "+r[2]+" "+(r[1]?"display":"")+" svelte-1am23me")&&p(e,"class",n)},i:N,o:N,d(r){r&&k(e)}}}function Xa(t,e,i){let n,r,s,o,{tooltipText:l}=e,{targetHtmlId:a}=e;const c=`tooltip-generic-${window.crypto.randomUUID()}`,u=()=>i(1,o=!0),f=()=>i(1,o=!1),d=()=>i(1,o=!o);return Mt(()=>{s=a?document.getElementById(a):document.getElementById(c).parentElement,a&&!s&&(console.error(`TooltipGeneric: element with ID ${a} not found, defaulting to the parent element`),s=document.getElementById(c).targetElement),s.addEventListener("mouseover",u),s.addEventListener("mouseout",f),s.addEventListener("click",d)}),Zi(()=>{s.removeEventListener("mouseover",u),s.removeEventListener("mouseout",f),s.removeEventListener("click",d)}),t.$$set=h=>{"tooltipText"in h&&i(0,l=h.tooltipText),"targetHtmlId"in h&&i(4,a=h.targetHtmlId)},t.$$.update=()=>{t.$$.dirty&33&&i(2,n=r(l))},i(5,r=h=>i(2,n=h.length>100?"tooltip-wide":h.length>20?"tooltip-mid":"tooltip-thin")),s=void 0,i(1,o=!1),[l,o,n,c,a,r]}class vi extends ue{constructor(e){super(),ce(this,e,Xa,Ja,le,{tooltipText:0,targetHtmlId:4})}}function Qa(t){let e,i,n,r,s,o,l,a,c,u,f,d,h,m,g,v;return{c(){e=w("div"),i=w("span"),n=Y(t[2]),r=Y(" ("),s=Y(t[3]),o=Y(")"),l=x(),a=w("div"),c=w("span"),u=Y(t[0]),f=x(),d=w("div"),h=w("div"),m=x(),g=w("span"),v=Y(t[1]),p(c,"class","range-marker svelte-216mtn"),p(h,"class","slider"),p(h,"id",t[4]),p(d,"class","slider-wrapper svelte-216mtn"),p(g,"class","range-marker svelte-216mtn"),p(a,"class","slider-outer-wrapper is-flex flex-direction-row svelte-216mtn")},m(y,E){C(y,e,E),b(e,i),b(i,n),b(i,r),b(i,s),b(i,o),b(e,l),b(e,a),b(a,c),b(c,u),b(a,f),b(a,d),b(d,h),b(a,m),b(a,g),b(g,v)},p(y,[E]){E&4&&de(n,y[2]),E&8&&de(s,y[3]),E&1&&de(u,y[0]),E&2&&de(v,y[1])},i:N,o:N,d(y){y&&k(e)}}}function Za(t,e,i){let n,{minVal:r}=e,{maxVal:s}=e,{start:o}=e,{step:l=void 0}=e,{roundTo:a=2}=e,{title:c=""}=e,{emitOnUpdate:u=!1}=e;const f=en(),d=`slider-${window.crypto.randomUUID()}`,h=Array.isArray(o)&&o.length===2&&o.every(I=>!isNaN(parseFloat(I))),m=[],g=h?[`noUi-handle-${window.crypto.randomUUID()}`,`noUi-handle-${window.crypto.randomUUID()}`]:[`noUi-handle-${window.crypto.randomUUID()}`],v=fi();v.setCompareFn(h?sn:(I,O)=>E(I)===E(O)),v.set(o);const y=Ce("resetTrigger")||void 0;y==null||y.subscribe(F);const E=I=>Number(I.toFixed(a)),T=(I,O)=>{I=Array.isArray(I)?I.map(E):E(I),i(3,n=I),(O==="set"||O==="update"&&u)&&(v.set(I),v.same()||f("updateSlider",v.get()))};function H(I){m.length&&m.map((O,q)=>O.$set({tooltipText:h?I[q]:I}))}function F(){const I=document.getElementById(d);I!=null&&I.noUiSlider&&I.noUiSlider.reset()}function B(){const I=document.getElementById(d);let O;Ya.create(I,{start:o,step:l,connect:h?!0:"lower",range:{min:r,max:s},handleAttributes:g.map(q=>({id:q}))}),I.noUiSlider.on("update",()=>{O=I.noUiSlider.get(!0),T(O,"update")}),I.noUiSlider.on("set",()=>{O=I.noUiSlider.get(!0),T(O,"set")})}function L(){g.map((I,O)=>{m.push(new vi({target:document.getElementById(I),props:h?{tooltipText:n[O]}:{tooltipText:n}}))})}return Mt(()=>{B(),L()}),Zi(()=>{document.getElementById(d)&&(document.getElementById(d).innerHTML="")}),t.$$set=I=>{"minVal"in I&&i(0,r=I.minVal),"maxVal"in I&&i(1,s=I.maxVal),"start"in I&&i(5,o=I.start),"step"in I&&i(6,l=I.step),"roundTo"in I&&i(7,a=I.roundTo),"title"in I&&i(2,c=I.title),"emitOnUpdate"in I&&i(8,u=I.emitOnUpdate)},t.$$.update=()=>{t.$$.dirty&32&&i(3,n=o),t.$$.dirty&8&&H(n)},[r,s,c,n,d,o,l,a,u]}class Is extends ue{constructor(e){super(),ce(this,e,Za,Qa,le,{minVal:0,maxVal:1,start:5,step:6,roundTo:7,title:2,emitOnUpdate:8})}}function ec(t){let e,i,n,r,s,o,l;return{c(){e=w("button"),i=w("span"),i.innerHTML='<span class="switch-control svelte-g5g8im"><span class="switch-spot"></span></span>',n=x(),r=w("span"),s=Y(t[0]),p(i,"class","switch mr-2 svelte-g5g8im"),p(r,"class","label svelte-g5g8im"),p(e,"id",t[3]),p(e,"name",t[3]),p(e,"class","input-checkbox-wrapper is-flex is-align-items-center-is-justify-content-center p-2 pl-3 pr-3 svelte-g5g8im"),p(e,"aria-label",t[0]),xe(e,"is-checked",t[2]),xe(e,"is-clickable",t[1]),xe(e,"button",t[1])},m(a,c){C(a,e,c),b(e,i),b(e,n),b(e,r),b(r,s),o||(l=oe(e,"click",yt(t[4])),o=!0)},p(a,[c]){c&1&&de(s,a[0]),c&1&&p(e,"aria-label",a[0]),c&4&&xe(e,"is-checked",a[2]),c&2&&xe(e,"is-clickable",a[1]),c&2&&xe(e,"button",a[1])},i:N,o:N,d(a){a&&k(e),o=!1,l()}}}function tc(t,e,i){let n,{toggleLabel:r}=e,{start:s=!1}=e,{buttonDisplay:o=!1}=e;const l=`input-toggle-${window.crypto.randomUUID()}`,a=en(),c=Ce("resetTrigger")||void 0;c==null||c.subscribe(f);const u=()=>i(2,n=!n);function f(){i(2,n=s)}return t.$$set=d=>{"toggleLabel"in d&&i(0,r=d.toggleLabel),"start"in d&&i(5,s=d.start),"buttonDisplay"in d&&i(1,o=d.buttonDisplay)},t.$$.update=()=>{t.$$.dirty&32&&i(2,n=s),t.$$.dirty&4&&a("updateChecked",n)},[r,o,n,l,u,s]}class ic extends ue{constructor(e){super(),ce(this,e,tc,ec,le,{toggleLabel:0,start:5,buttonDisplay:1})}}/*! choices.js v11.1.0 | © 2025 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var Bi=function(t,e){return Bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},Bi(t,e)};function As(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Bi(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var $e=function(){return $e=Object.assign||function(e){for(var i,n=1,r=arguments.length;n<r;n++){i=arguments[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},$e.apply(this,arguments)};function nc(t,e,i){if(i||arguments.length===2)for(var n=0,r=e.length,s;n<r;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var Se={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},Ne={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},Le={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},rc=["fuseOptions","classNames"],lt={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},ir=function(t){return{type:Se.ADD_CHOICE,choice:t}},sc=function(t){return{type:Se.REMOVE_CHOICE,choice:t}},oc=function(t){return{type:Se.FILTER_CHOICES,results:t}},lc=function(t){return{type:Se.ACTIVATE_CHOICES,active:t}},ac=function(t){return{type:Se.ADD_GROUP,group:t}},nr=function(t){return{type:Se.ADD_ITEM,item:t}},rr=function(t){return{type:Se.REMOVE_ITEM,item:t}},ii=function(t,e){return{type:Se.HIGHLIGHT_ITEM,item:t,highlighted:e}},cc=function(t,e){return Math.floor(Math.random()*(e-t)+t)},sr=function(t){return Array.from({length:t},function(){return cc(0,36).toString(36)}).join("")},uc=function(t,e){var i=t.id||t.name&&"".concat(t.name,"-").concat(sr(2))||sr(4);return i=i.replace(/(:|\.|\[|\]|,)/g,""),i="".concat(e,"-").concat(i),i},fc=function(t,e,i){i===void 0&&(i=1);for(var n="".concat(i>0?"next":"previous","ElementSibling"),r=t[n];r;){if(r.matches(e))return r;r=r[n]}return null},dc=function(t,e,i){i===void 0&&(i=1);var n;return i>0?n=e.scrollTop+e.offsetHeight>=t.offsetTop+t.offsetHeight:n=t.offsetTop>=e.scrollTop,n},bi=function(t){if(typeof t!="string"){if(t==null)return"";if(typeof t=="object"){if("raw"in t)return bi(t.raw);if("trusted"in t)return t.trusted}return t}return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},hc=function(){var t=document.createElement("div");return function(e){t.innerHTML=e.trim();for(var i=t.children[0];t.firstChild;)t.removeChild(t.firstChild);return i}}(),zt=function(t,e){return typeof t=="function"?t(bi(e),e):t},or=function(t){return typeof t=="function"?t():t},bt=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("trusted"in t)return t.trusted;if("raw"in t)return t.raw}return""},Os=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("escaped"in t)return t.escaped;if("trusted"in t)return t.trusted}return""},cn=function(t,e){return t?Os(e):bi(e)},Qe=function(t,e,i){t.innerHTML=cn(e,i)},pc=function(t,e){var i=t.value,n=t.label,r=n===void 0?i:n,s=e.value,o=e.label,l=o===void 0?s:o;return bt(r).localeCompare(bt(l),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},mc=function(t,e){return t.rank-e.rank},gc=function(t,e,i){i===void 0&&(i=null);var n=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0});return t.dispatchEvent(n)},_c=function(t,e){var i=Object.keys(t).sort(),n=Object.keys(e).sort();return i.filter(function(r){return n.indexOf(r)<0})},yi=function(t){return Array.isArray(t)?t:[t]},Ut=function(t){return t&&Array.isArray(t)?t.map(function(e){return".".concat(e)}).join(""):".".concat(t)},ie=function(t,e){var i;(i=t.classList).add.apply(i,yi(e))},Ye=function(t,e){var i;(i=t.classList).remove.apply(i,yi(e))},vc=function(t){if(typeof t<"u")try{return JSON.parse(t)}catch{return t}return{}},bc=function(t,e,i){var n=t.itemEl;n&&(Ye(n,i),ie(n,e))},yc=function(){function t(e){var i=e.element,n=e.type,r=e.classNames;this.element=i,this.classNames=r,this.type=n,this.isActive=!1}return t.prototype.show=function(){return ie(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},t.prototype.hide=function(){return Ye(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},t}(),lr=function(){function t(e){var i=e.element,n=e.type,r=e.classNames,s=e.position;this.element=i,this.classNames=r,this.type=n,this.position=s,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return t.prototype.shouldFlip=function(e,i){var n=!1;return this.position==="auto"?n=this.element.getBoundingClientRect().top-i>=0&&!window.matchMedia("(min-height: ".concat(e+1,"px)")).matches:this.position==="top"&&(n=!0),n},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype.open=function(e,i){ie(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e,i)&&(ie(this.element,this.classNames.flippedState),this.isFlipped=!0)},t.prototype.close=function(){Ye(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(Ye(this.element,this.classNames.flippedState),this.isFlipped=!1)},t.prototype.addFocusState=function(){ie(this.element,this.classNames.focusState)},t.prototype.removeFocusState=function(){Ye(this.element,this.classNames.focusState)},t.prototype.enable=function(){Ye(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===lt.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},t.prototype.disable=function(){ie(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===lt.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},t.prototype.wrap=function(e){var i=this.element,n=e.parentNode;n&&(e.nextSibling?n.insertBefore(i,e.nextSibling):n.appendChild(i)),i.appendChild(e)},t.prototype.unwrap=function(e){var i=this.element,n=i.parentNode;n&&(n.insertBefore(e,i),n.removeChild(i))},t.prototype.addLoadingState=function(){ie(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},t.prototype.removeLoadingState=function(){Ye(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},t}(),wc=function(){function t(e){var i=e.element,n=e.type,r=e.classNames,s=e.preventPaste;this.element=i,this.type=n,this.classNames=r,this.preventPaste=s,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=i.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(t.prototype,"placeholder",{set:function(e){this.element.placeholder=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.addEventListeners=function(){var e=this.element;e.addEventListener("paste",this._onPaste),e.addEventListener("input",this._onInput,{passive:!0}),e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})},t.prototype.removeEventListeners=function(){var e=this.element;e.removeEventListener("input",this._onInput),e.removeEventListener("paste",this._onPaste),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)},t.prototype.enable=function(){var e=this.element;e.removeAttribute("disabled"),this.isDisabled=!1},t.prototype.disable=function(){var e=this.element;e.setAttribute("disabled",""),this.isDisabled=!0},t.prototype.focus=function(){this.isFocussed||this.element.focus()},t.prototype.blur=function(){this.isFocussed&&this.element.blur()},t.prototype.clear=function(e){return e===void 0&&(e=!0),this.element.value="",e&&this.setWidth(),this},t.prototype.setWidth=function(){var e=this.element;e.style.minWidth="".concat(e.placeholder.length+1,"ch"),e.style.width="".concat(e.value.length+1,"ch")},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype._onInput=function(){this.type!==lt.SelectOne&&this.setWidth()},t.prototype._onPaste=function(e){this.preventPaste&&e.preventDefault()},t.prototype._onFocus=function(){this.isFocussed=!0},t.prototype._onBlur=function(){this.isFocussed=!1},t}(),Sc=4,ar=function(){function t(e){var i=e.element;this.element=i,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return t.prototype.prepend=function(e){var i=this.element.firstElementChild;i?this.element.insertBefore(e,i):this.element.append(e)},t.prototype.scrollToTop=function(){this.element.scrollTop=0},t.prototype.scrollToChildElement=function(e,i){var n=this;if(e){var r=this.element.offsetHeight,s=this.element.scrollTop+r,o=e.offsetHeight,l=e.offsetTop+o,a=i>0?this.element.scrollTop+l-s:e.offsetTop;requestAnimationFrame(function(){n._animateScroll(a,i)})}},t.prototype._scrollDown=function(e,i,n){var r=(n-e)/i,s=r>1?r:1;this.element.scrollTop=e+s},t.prototype._scrollUp=function(e,i,n){var r=(e-n)/i,s=r>1?r:1;this.element.scrollTop=e-s},t.prototype._animateScroll=function(e,i){var n=this,r=Sc,s=this.element.scrollTop,o=!1;i>0?(this._scrollDown(s,r,e),s<e&&(o=!0)):(this._scrollUp(s,r,e),s>e&&(o=!0)),o&&requestAnimationFrame(function(){n._animateScroll(e,i)})},t}(),Ts=function(){function t(e){var i=e.element,n=e.classNames;this.element=i,this.classNames=n,this.isDisabled=!1}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.setAttribute("value",e),this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.conceal=function(){var e=this.element;ie(e,this.classNames.input),e.hidden=!0,e.tabIndex=-1;var i=e.getAttribute("style");i&&e.setAttribute("data-choice-orig-style",i),e.setAttribute("data-choice","active")},t.prototype.reveal=function(){var e=this.element;Ye(e,this.classNames.input),e.hidden=!1,e.removeAttribute("tabindex");var i=e.getAttribute("data-choice-orig-style");i?(e.removeAttribute("data-choice-orig-style"),e.setAttribute("style",i)):e.removeAttribute("style"),e.removeAttribute("data-choice")},t.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},t.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},t.prototype.triggerEvent=function(e,i){gc(this.element,e,i||{})},t}(),Ec=function(t){As(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(Ts),Bt=function(t,e){return e===void 0&&(e=!0),typeof t>"u"?e:!!t},Ps=function(t){if(typeof t=="string"&&(t=t.split(" ").filter(function(e){return e.length})),Array.isArray(t)&&t.length)return t},We=function(t,e,i){if(i===void 0&&(i=!0),typeof t=="string"){var n=bi(t),r=i||n===t?t:{escaped:n,raw:t},s=We({value:t,label:r,selected:!0},!1);return s}var o=t;if("choices"in o){if(!e)throw new TypeError("optGroup is not allowed");var l=o,a=l.choices.map(function(d){return We(d,!1)}),c={id:0,label:bt(l.label)||l.value,active:!!a.length,disabled:!!l.disabled,choices:a};return c}var u=o,f={id:0,group:null,score:0,rank:0,value:u.value,label:u.label||u.value,active:Bt(u.active),selected:Bt(u.selected,!1),disabled:Bt(u.disabled,!1),placeholder:Bt(u.placeholder,!1),highlighted:!1,labelClass:Ps(u.labelClass),labelDescription:u.labelDescription,customProperties:u.customProperties};return f},kc=function(t){return t.tagName==="INPUT"},Ls=function(t){return t.tagName==="SELECT"},Cc=function(t){return t.tagName==="OPTION"},Ic=function(t){return t.tagName==="OPTGROUP"},Ac=function(t){As(e,t);function e(i){var n=i.element,r=i.classNames,s=i.template,o=i.extractPlaceholder,l=t.call(this,{element:n,classNames:r})||this;return l.template=s,l.extractPlaceholder=o,l}return Object.defineProperty(e.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),e.prototype.addOptions=function(i){var n=this,r=document.createDocumentFragment();i.forEach(function(s){var o=s;if(!o.element){var l=n.template(o);r.appendChild(l),o.element=l}}),this.element.appendChild(r)},e.prototype.optionsAsChoices=function(){var i=this,n=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(r){Cc(r)?n.push(i._optionToChoice(r)):Ic(r)&&n.push(i._optgroupToChoice(r))}),n},e.prototype._optionToChoice=function(i){return!i.hasAttribute("value")&&i.hasAttribute("placeholder")&&(i.setAttribute("value",""),i.value=""),{id:0,group:null,score:0,rank:0,value:i.value,label:i.label,element:i,active:!0,selected:this.extractPlaceholder?i.selected:i.hasAttribute("selected"),disabled:i.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!i.value||i.hasAttribute("placeholder")),labelClass:typeof i.dataset.labelClass<"u"?Ps(i.dataset.labelClass):void 0,labelDescription:typeof i.dataset.labelDescription<"u"?i.dataset.labelDescription:void 0,customProperties:vc(i.dataset.customProperties)}},e.prototype._optgroupToChoice=function(i){var n=this,r=i.querySelectorAll("option"),s=Array.from(r).map(function(o){return n._optionToChoice(o)});return{id:0,label:i.label||"",element:i,active:!!s.length,disabled:i.disabled,choices:s}},e}(Ts),Oc={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},cr={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(t){return!!t&&t!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:pc,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(t){return'Press Enter to add <b>"'.concat(t,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(t){return"Remove item: ".concat(t)},maxItemText:function(t){return"Only ".concat(t," values can be added")},valueComparer:function(t,e){return t===e},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:Oc,appendGroupInSearch:!1},ur=function(t){var e=t.itemEl;e&&(e.remove(),t.itemEl=void 0)};function Tc(t,e,i){var n=t,r=!0;switch(e.type){case Se.ADD_ITEM:{e.item.selected=!0;var s=e.item.element;s&&(s.selected=!0,s.setAttribute("selected","")),n.push(e.item);break}case Se.REMOVE_ITEM:{e.item.selected=!1;var s=e.item.element;if(s){s.selected=!1,s.removeAttribute("selected");var o=s.parentElement;o&&Ls(o)&&o.type===lt.SelectOne&&(o.value="")}ur(e.item),n=n.filter(function(u){return u.id!==e.item.id});break}case Se.REMOVE_CHOICE:{ur(e.choice),n=n.filter(function(c){return c.id!==e.choice.id});break}case Se.HIGHLIGHT_ITEM:{var l=e.highlighted,a=n.find(function(c){return c.id===e.item.id});a&&a.highlighted!==l&&(a.highlighted=l,i&&bc(a,l?i.classNames.highlightedState:i.classNames.selectedState,l?i.classNames.selectedState:i.classNames.highlightedState));break}default:{r=!1;break}}return{state:n,update:r}}function Pc(t,e){var i=t,n=!0;switch(e.type){case Se.ADD_GROUP:{i.push(e.group);break}case Se.CLEAR_CHOICES:{i=[];break}default:{n=!1;break}}return{state:i,update:n}}function Lc(t,e,i){var n=t,r=!0;switch(e.type){case Se.ADD_CHOICE:{n.push(e.choice);break}case Se.REMOVE_CHOICE:{e.choice.choiceEl=void 0,e.choice.group&&(e.choice.group.choices=e.choice.group.choices.filter(function(o){return o.id!==e.choice.id})),n=n.filter(function(o){return o.id!==e.choice.id});break}case Se.ADD_ITEM:case Se.REMOVE_ITEM:{e.item.choiceEl=void 0;break}case Se.FILTER_CHOICES:{var s=[];e.results.forEach(function(o){s[o.item.id]=o}),n.forEach(function(o){var l=s[o.id];l!==void 0?(o.score=l.score,o.rank=l.rank,o.active=!0):(o.score=0,o.rank=0,o.active=!1),i&&i.appendGroupInSearch&&(o.choiceEl=void 0)});break}case Se.ACTIVATE_CHOICES:{n.forEach(function(o){o.active=e.active,i&&i.appendGroupInSearch&&(o.choiceEl=void 0)});break}case Se.CLEAR_CHOICES:{n=[];break}default:{r=!1;break}}return{state:n,update:r}}var fr={groups:Pc,items:Tc,choices:Lc},Rc=function(){function t(e){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=e}return Object.defineProperty(t.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),t.prototype.changeSet=function(e){return{groups:e,items:e,choices:e}},t.prototype.reset=function(){this._state=this.defaultState;var e=this.changeSet(!0);this._txn?this._changeSet=e:this._listeners.forEach(function(i){return i(e)})},t.prototype.subscribe=function(e){return this._listeners.push(e),this},t.prototype.dispatch=function(e){var i=this,n=this._state,r=!1,s=this._changeSet||this.changeSet(!1);Object.keys(fr).forEach(function(o){var l=fr[o](n[o],e,i._context);l.update&&(r=!0,s[o]=!0,n[o]=l.state)}),r&&(this._txn?this._changeSet=s:this._listeners.forEach(function(o){return o(s)}))},t.prototype.withTxn=function(e){this._txn++;try{e()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var i=this._changeSet;i&&(this._changeSet=void 0,this._listeners.forEach(function(n){return n(i)}))}}},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(e){return e.active&&e.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeChoices",{get:function(){return this.choices.filter(function(e){return e.active})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(e){return!e.disabled&&!e.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeGroups",{get:function(){var e=this;return this.state.groups.filter(function(i){var n=i.active&&!i.disabled,r=e.state.choices.some(function(s){return s.active&&!s.disabled});return n&&r},[])},enumerable:!1,configurable:!0}),t.prototype.inTxn=function(){return this._txn>0},t.prototype.getChoiceById=function(e){return this.activeChoices.find(function(i){return i.id===e})},t.prototype.getGroupById=function(e){return this.groups.find(function(i){return i.id===e})},t}(),Oe={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Mc(t,e,i){return(e=Nc(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function dr(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),i.push.apply(i,n)}return i}function Ct(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?dr(Object(i),!0).forEach(function(n){Mc(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):dr(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function Dc(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nc(t){var e=Dc(t,"string");return typeof e=="symbol"?e:e+""}function rt(t){return Array.isArray?Array.isArray(t):Ds(t)==="[object Array]"}const $c=1/0;function jc(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-$c?"-0":e}function Fc(t){return t==null?"":jc(t)}function Je(t){return typeof t=="string"}function Rs(t){return typeof t=="number"}function Vc(t){return t===!0||t===!1||xc(t)&&Ds(t)=="[object Boolean]"}function Ms(t){return typeof t=="object"}function xc(t){return Ms(t)&&t!==null}function je(t){return t!=null}function Ni(t){return!t.trim().length}function Ds(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Uc="Incorrect 'index' type",Hc=t=>`Invalid value for key ${t}`,Bc=t=>`Pattern length exceeds max of ${t}.`,zc=t=>`Missing ${t} property in key`,qc=t=>`Property 'weight' in key '${t}' must be a positive integer`,hr=Object.prototype.hasOwnProperty;class Kc{constructor(e){this._keys=[],this._keyMap={};let i=0;e.forEach(n=>{let r=Ns(n);this._keys.push(r),this._keyMap[r.id]=r,i+=r.weight}),this._keys.forEach(n=>{n.weight/=i})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Ns(t){let e=null,i=null,n=null,r=1,s=null;if(Je(t)||rt(t))n=t,e=pr(t),i=zi(t);else{if(!hr.call(t,"name"))throw new Error(zc("name"));const o=t.name;if(n=o,hr.call(t,"weight")&&(r=t.weight,r<=0))throw new Error(qc(o));e=pr(o),i=zi(o),s=t.getFn}return{path:e,id:i,weight:r,src:n,getFn:s}}function pr(t){return rt(t)?t:t.split(".")}function zi(t){return rt(t)?t.join("."):t}function Gc(t,e){let i=[],n=!1;const r=(s,o,l)=>{if(je(s))if(!o[l])i.push(s);else{let a=o[l];const c=s[a];if(!je(c))return;if(l===o.length-1&&(Je(c)||Rs(c)||Vc(c)))i.push(Fc(c));else if(rt(c)){n=!0;for(let u=0,f=c.length;u<f;u+=1)r(c[u],o,l+1)}else o.length&&r(c,o,l+1)}};return r(t,Je(e)?e.split("."):e,0),n?i:i[0]}const Wc={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Yc={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},Jc={location:0,threshold:.6,distance:100},Xc={useExtendedSearch:!1,getFn:Gc,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var te=Ct(Ct(Ct(Ct({},Yc),Wc),Jc),Xc);const Qc=/[^ ]+/g;function Zc(t=1,e=3){const i=new Map,n=Math.pow(10,e);return{get(r){const s=r.match(Qc).length;if(i.has(s))return i.get(s);const o=1/Math.pow(s,.5*t),l=parseFloat(Math.round(o*n)/n);return i.set(s,l),l},clear(){i.clear()}}}class un{constructor({getFn:e=te.getFn,fieldNormWeight:i=te.fieldNormWeight}={}){this.norm=Zc(i,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((i,n)=>{this._keysMap[i.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Je(this.docs[0])?this.docs.forEach((e,i)=>{this._addString(e,i)}):this.docs.forEach((e,i)=>{this._addObject(e,i)}),this.norm.clear())}add(e){const i=this.size();Je(e)?this._addString(e,i):this._addObject(e,i)}removeAt(e){this.records.splice(e,1);for(let i=e,n=this.size();i<n;i+=1)this.records[i].i-=1}getValueForItemAtKeyId(e,i){return e[this._keysMap[i]]}size(){return this.records.length}_addString(e,i){if(!je(e)||Ni(e))return;let n={v:e,i,n:this.norm.get(e)};this.records.push(n)}_addObject(e,i){let n={i,$:{}};this.keys.forEach((r,s)=>{let o=r.getFn?r.getFn(e):this.getFn(e,r.path);if(je(o)){if(rt(o)){let l=[];const a=[{nestedArrIndex:-1,value:o}];for(;a.length;){const{nestedArrIndex:c,value:u}=a.pop();if(je(u))if(Je(u)&&!Ni(u)){let f={v:u,i:c,n:this.norm.get(u)};l.push(f)}else rt(u)&&u.forEach((f,d)=>{a.push({nestedArrIndex:d,value:f})})}n.$[s]=l}else if(Je(o)&&!Ni(o)){let l={v:o,n:this.norm.get(o)};n.$[s]=l}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function $s(t,e,{getFn:i=te.getFn,fieldNormWeight:n=te.fieldNormWeight}={}){const r=new un({getFn:i,fieldNormWeight:n});return r.setKeys(t.map(Ns)),r.setSources(e),r.create(),r}function eu(t,{getFn:e=te.getFn,fieldNormWeight:i=te.fieldNormWeight}={}){const{keys:n,records:r}=t,s=new un({getFn:e,fieldNormWeight:i});return s.setKeys(n),s.setIndexRecords(r),s}function ni(t,{errors:e=0,currentLocation:i=0,expectedLocation:n=0,distance:r=te.distance,ignoreLocation:s=te.ignoreLocation}={}){const o=e/t.length;if(s)return o;const l=Math.abs(n-i);return r?o+l/r:l?1:o}function tu(t=[],e=te.minMatchCharLength){let i=[],n=-1,r=-1,s=0;for(let o=t.length;s<o;s+=1){let l=t[s];l&&n===-1?n=s:!l&&n!==-1&&(r=s-1,r-n+1>=e&&i.push([n,r]),n=-1)}return t[s-1]&&s-n>=e&&i.push([n,s-1]),i}const _t=32;function iu(t,e,i,{location:n=te.location,distance:r=te.distance,threshold:s=te.threshold,findAllMatches:o=te.findAllMatches,minMatchCharLength:l=te.minMatchCharLength,includeMatches:a=te.includeMatches,ignoreLocation:c=te.ignoreLocation}={}){if(e.length>_t)throw new Error(Bc(_t));const u=e.length,f=t.length,d=Math.max(0,Math.min(n,f));let h=s,m=d;const g=l>1||a,v=g?Array(f):[];let y;for(;(y=t.indexOf(e,m))>-1;){let L=ni(e,{currentLocation:y,expectedLocation:d,distance:r,ignoreLocation:c});if(h=Math.min(L,h),m=y+u,g){let I=0;for(;I<u;)v[y+I]=1,I+=1}}m=-1;let E=[],T=1,H=u+f;const F=1<<u-1;for(let L=0;L<u;L+=1){let I=0,O=H;for(;I<O;)ni(e,{errors:L,currentLocation:d+O,expectedLocation:d,distance:r,ignoreLocation:c})<=h?I=O:H=O,O=Math.floor((H-I)/2+I);H=O;let q=Math.max(1,d-O+1),R=o?f:Math.min(d+O,f)+u,D=Array(R+2);D[R+1]=(1<<L)-1;for(let W=R;W>=q;W-=1){let z=W-1,U=i[t.charAt(z)];if(g&&(v[z]=+!!U),D[W]=(D[W+1]<<1|1)&U,L&&(D[W]|=(E[W+1]|E[W])<<1|1|E[W+1]),D[W]&F&&(T=ni(e,{errors:L,currentLocation:z,expectedLocation:d,distance:r,ignoreLocation:c}),T<=h)){if(h=T,m=z,m<=d)break;q=Math.max(1,2*d-m)}}if(ni(e,{errors:L+1,currentLocation:d,expectedLocation:d,distance:r,ignoreLocation:c})>h)break;E=D}const B={isMatch:m>=0,score:Math.max(.001,T)};if(g){const L=tu(v,l);L.length?a&&(B.indices=L):B.isMatch=!1}return B}function nu(t){let e={};for(let i=0,n=t.length;i<n;i+=1){const r=t.charAt(i);e[r]=(e[r]||0)|1<<n-i-1}return e}class js{constructor(e,{location:i=te.location,threshold:n=te.threshold,distance:r=te.distance,includeMatches:s=te.includeMatches,findAllMatches:o=te.findAllMatches,minMatchCharLength:l=te.minMatchCharLength,isCaseSensitive:a=te.isCaseSensitive,ignoreLocation:c=te.ignoreLocation}={}){if(this.options={location:i,threshold:n,distance:r,includeMatches:s,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(d,h)=>{this.chunks.push({pattern:d,alphabet:nu(d),startIndex:h})},f=this.pattern.length;if(f>_t){let d=0;const h=f%_t,m=f-h;for(;d<m;)u(this.pattern.substr(d,_t),d),d+=_t;if(h){const g=f-_t;u(this.pattern.substr(g),g)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:i,includeMatches:n}=this.options;if(i||(e=e.toLowerCase()),this.pattern===e){let m={isMatch:!0,score:0};return n&&(m.indices=[[0,e.length-1]]),m}const{location:r,distance:s,threshold:o,findAllMatches:l,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],f=0,d=!1;this.chunks.forEach(({pattern:m,alphabet:g,startIndex:v})=>{const{isMatch:y,score:E,indices:T}=iu(e,m,g,{location:r+v,distance:s,threshold:o,findAllMatches:l,minMatchCharLength:a,includeMatches:n,ignoreLocation:c});y&&(d=!0),f+=E,y&&T&&(u=[...u,...T])});let h={isMatch:d,score:d?f/this.chunks.length:1};return d&&n&&(h.indices=u),h}}class pt{constructor(e){this.pattern=e}static isMultiMatch(e){return mr(e,this.multiRegex)}static isSingleMatch(e){return mr(e,this.singleRegex)}search(){}}function mr(t,e){const i=t.match(e);return i?i[1]:null}class ru extends pt{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const i=e===this.pattern;return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}}class su extends pt{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class ou extends pt{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const i=e.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}}class lu extends pt{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const i=!e.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class au extends pt{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const i=e.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class cu extends pt{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const i=!e.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class Fs extends pt{constructor(e,{location:i=te.location,threshold:n=te.threshold,distance:r=te.distance,includeMatches:s=te.includeMatches,findAllMatches:o=te.findAllMatches,minMatchCharLength:l=te.minMatchCharLength,isCaseSensitive:a=te.isCaseSensitive,ignoreLocation:c=te.ignoreLocation}={}){super(e),this._bitapSearch=new js(e,{location:i,threshold:n,distance:r,includeMatches:s,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Vs extends pt{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let i=0,n;const r=[],s=this.pattern.length;for(;(n=e.indexOf(this.pattern,i))>-1;)i=n+s,r.push([n,i-1]);const o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}const qi=[ru,Vs,ou,lu,cu,au,su,Fs],gr=qi.length,uu=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,fu="|";function du(t,e={}){return t.split(fu).map(i=>{let n=i.trim().split(uu).filter(s=>s&&!!s.trim()),r=[];for(let s=0,o=n.length;s<o;s+=1){const l=n[s];let a=!1,c=-1;for(;!a&&++c<gr;){const u=qi[c];let f=u.isMultiMatch(l);f&&(r.push(new u(f,e)),a=!0)}if(!a)for(c=-1;++c<gr;){const u=qi[c];let f=u.isSingleMatch(l);if(f){r.push(new u(f,e));break}}}return r})}const hu=new Set([Fs.type,Vs.type]);class pu{constructor(e,{isCaseSensitive:i=te.isCaseSensitive,includeMatches:n=te.includeMatches,minMatchCharLength:r=te.minMatchCharLength,ignoreLocation:s=te.ignoreLocation,findAllMatches:o=te.findAllMatches,location:l=te.location,threshold:a=te.threshold,distance:c=te.distance}={}){this.query=null,this.options={isCaseSensitive:i,includeMatches:n,minMatchCharLength:r,findAllMatches:o,ignoreLocation:s,location:l,threshold:a,distance:c},this.pattern=i?e:e.toLowerCase(),this.query=du(this.pattern,this.options)}static condition(e,i){return i.useExtendedSearch}searchIn(e){const i=this.query;if(!i)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r}=this.options;e=r?e:e.toLowerCase();let s=0,o=[],l=0;for(let a=0,c=i.length;a<c;a+=1){const u=i[a];o.length=0,s=0;for(let f=0,d=u.length;f<d;f+=1){const h=u[f],{isMatch:m,indices:g,score:v}=h.search(e);if(m){if(s+=1,l+=v,n){const y=h.constructor.type;hu.has(y)?o=[...o,...g]:o.push(g)}}else{l=0,s=0,o.length=0;break}}if(s){let f={isMatch:!0,score:l/s};return n&&(f.indices=o),f}}return{isMatch:!1,score:1}}}const Ki=[];function mu(...t){Ki.push(...t)}function Gi(t,e){for(let i=0,n=Ki.length;i<n;i+=1){let r=Ki[i];if(r.condition(t,e))return new r(t,e)}return new js(t,e)}const hi={AND:"$and",OR:"$or"},Wi={PATH:"$path",PATTERN:"$val"},Yi=t=>!!(t[hi.AND]||t[hi.OR]),gu=t=>!!t[Wi.PATH],_u=t=>!rt(t)&&Ms(t)&&!Yi(t),_r=t=>({[hi.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function xs(t,e,{auto:i=!0}={}){const n=r=>{let s=Object.keys(r);const o=gu(r);if(!o&&s.length>1&&!Yi(r))return n(_r(r));if(_u(r)){const a=o?r[Wi.PATH]:s[0],c=o?r[Wi.PATTERN]:r[a];if(!Je(c))throw new Error(Hc(a));const u={keyId:zi(a),pattern:c};return i&&(u.searcher=Gi(c,e)),u}let l={children:[],operator:s[0]};return s.forEach(a=>{const c=r[a];rt(c)&&c.forEach(u=>{l.children.push(n(u))})}),l};return Yi(t)||(t=_r(t)),n(t)}function vu(t,{ignoreFieldNorm:e=te.ignoreFieldNorm}){t.forEach(i=>{let n=1;i.matches.forEach(({key:r,norm:s,score:o})=>{const l=r?r.weight:null;n*=Math.pow(o===0&&l?Number.EPSILON:o,(l||1)*(e?1:s))}),i.score=n})}function bu(t,e){const i=t.matches;e.matches=[],je(i)&&i.forEach(n=>{if(!je(n.indices)||!n.indices.length)return;const{indices:r,value:s}=n;let o={indices:r,value:s};n.key&&(o.key=n.key.src),n.idx>-1&&(o.refIndex=n.idx),e.matches.push(o)})}function yu(t,e){e.score=t.score}function wu(t,e,{includeMatches:i=te.includeMatches,includeScore:n=te.includeScore}={}){const r=[];return i&&r.push(bu),n&&r.push(yu),t.map(s=>{const{idx:o}=s,l={item:e[o],refIndex:o};return r.length&&r.forEach(a=>{a(s,l)}),l})}class Nt{constructor(e,i={},n){this.options=Ct(Ct({},te),i),this.options.useExtendedSearch,this._keyStore=new Kc(this.options.keys),this.setCollection(e,n)}setCollection(e,i){if(this._docs=e,i&&!(i instanceof un))throw new Error(Uc);this._myIndex=i||$s(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){je(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const i=[];for(let n=0,r=this._docs.length;n<r;n+=1){const s=this._docs[n];e(s,n)&&(this.removeAt(n),n-=1,r-=1,i.push(s))}return i}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:i=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:s,sortFn:o,ignoreFieldNorm:l}=this.options;let a=Je(e)?Je(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return vu(a,{ignoreFieldNorm:l}),s&&a.sort(o),Rs(i)&&i>-1&&(a=a.slice(0,i)),wu(a,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(e){const i=Gi(e,this.options),{records:n}=this._myIndex,r=[];return n.forEach(({v:s,i:o,n:l})=>{if(!je(s))return;const{isMatch:a,score:c,indices:u}=i.searchIn(s);a&&r.push({item:s,idx:o,matches:[{score:c,value:s,norm:l,indices:u}]})}),r}_searchLogical(e){const i=xs(e,this.options),n=(l,a,c)=>{if(!l.children){const{keyId:f,searcher:d}=l,h=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(a,f),searcher:d});return h&&h.length?[{idx:c,item:a,matches:h}]:[]}const u=[];for(let f=0,d=l.children.length;f<d;f+=1){const h=l.children[f],m=n(h,a,c);if(m.length)u.push(...m);else if(l.operator===hi.AND)return[]}return u},r=this._myIndex.records,s={},o=[];return r.forEach(({$:l,i:a})=>{if(je(l)){let c=n(i,l,a);c.length&&(s[a]||(s[a]={idx:a,item:l,matches:[]},o.push(s[a])),c.forEach(({matches:u})=>{s[a].matches.push(...u)}))}}),o}_searchObjectList(e){const i=Gi(e,this.options),{keys:n,records:r}=this._myIndex,s=[];return r.forEach(({$:o,i:l})=>{if(!je(o))return;let a=[];n.forEach((c,u)=>{a.push(...this._findMatches({key:c,value:o[u],searcher:i}))}),a.length&&s.push({idx:l,item:o,matches:a})}),s}_findMatches({key:e,value:i,searcher:n}){if(!je(i))return[];let r=[];if(rt(i))i.forEach(({v:s,i:o,n:l})=>{if(!je(s))return;const{isMatch:a,score:c,indices:u}=n.searchIn(s);a&&r.push({score:c,key:e,value:s,idx:o,norm:l,indices:u})});else{const{v:s,n:o}=i,{isMatch:l,score:a,indices:c}=n.searchIn(s);l&&r.push({score:a,key:e,value:s,norm:o,indices:c})}return r}}Nt.version="7.0.0";Nt.createIndex=$s;Nt.parseIndex=eu;Nt.config=te;Nt.parseQuery=xs;mu(pu);var Su=function(){function t(e){this._haystack=[],this._fuseOptions=$e($e({},e.fuseOptions),{keys:nc([],e.searchFields,!0),includeMatches:!0})}return t.prototype.index=function(e){this._haystack=e,this._fuse&&this._fuse.setCollection(e)},t.prototype.reset=function(){this._haystack=[],this._fuse=void 0},t.prototype.isEmptyIndex=function(){return!this._haystack.length},t.prototype.search=function(e){this._fuse||(this._fuse=new Nt(this._haystack,this._fuseOptions));var i=this._fuse.search(e);return i.map(function(n,r){return{item:n.item,score:n.score||0,rank:r+1}})},t}();function Eu(t){return new Su(t)}var ku=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},$i=function(t,e,i){var n=t.dataset,r=e.customProperties,s=e.labelClass,o=e.labelDescription;s&&(n.labelClass=yi(s).join(" ")),o&&(n.labelDescription=o),i&&r&&(typeof r=="string"?n.customProperties=r:typeof r=="object"&&!ku(r)&&(n.customProperties=JSON.stringify(r)))},vr=function(t,e,i){var n=e&&t.querySelector("label[for='".concat(e,"']")),r=n&&n.innerText;r&&i.setAttribute("aria-label",r)},Cu={containerOuter:function(t,e,i,n,r,s,o){var l=t.classNames.containerOuter,a=document.createElement("div");return ie(a,l),a.dataset.type=s,e&&(a.dir=e),n&&(a.tabIndex=0),i&&(a.setAttribute("role",r?"combobox":"listbox"),r?a.setAttribute("aria-autocomplete","list"):o||vr(this._docRoot,this.passedElement.element.id,a),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false")),o&&a.setAttribute("aria-labelledby",o),a},containerInner:function(t){var e=t.classNames.containerInner,i=document.createElement("div");return ie(i,e),i},itemList:function(t,e){var i=t.searchEnabled,n=t.classNames,r=n.list,s=n.listSingle,o=n.listItems,l=document.createElement("div");return ie(l,r),ie(l,e?s:o),this._isSelectElement&&i&&l.setAttribute("role","listbox"),l},placeholder:function(t,e){var i=t.allowHTML,n=t.classNames.placeholder,r=document.createElement("div");return ie(r,n),Qe(r,i,e),r},item:function(t,e,i){var n=t.allowHTML,r=t.removeItemButtonAlignLeft,s=t.removeItemIconText,o=t.removeItemLabelText,l=t.classNames,a=l.item,c=l.button,u=l.highlightedState,f=l.itemSelectable,d=l.placeholder,h=bt(e.value),m=document.createElement("div");if(ie(m,a),e.labelClass){var g=document.createElement("span");Qe(g,n,e.label),ie(g,e.labelClass),m.appendChild(g)}else Qe(m,n,e.label);if(m.dataset.item="",m.dataset.id=e.id,m.dataset.value=h,$i(m,e,!0),(e.disabled||this.containerOuter.isDisabled)&&m.setAttribute("aria-disabled","true"),this._isSelectElement&&(m.setAttribute("aria-selected","true"),m.setAttribute("role","option")),e.placeholder&&(ie(m,d),m.dataset.placeholder=""),ie(m,e.highlighted?u:f),i){e.disabled&&Ye(m,f),m.dataset.deletable="";var v=document.createElement("button");v.type="button",ie(v,c),Qe(v,!0,zt(s,e.value));var y=zt(o,e.value);y&&v.setAttribute("aria-label",y),v.dataset.button="",r?m.insertAdjacentElement("afterbegin",v):m.appendChild(v)}return m},choiceList:function(t,e){var i=t.classNames.list,n=document.createElement("div");return ie(n,i),e||n.setAttribute("aria-multiselectable","true"),n.setAttribute("role","listbox"),n},choiceGroup:function(t,e){var i=t.allowHTML,n=t.classNames,r=n.group,s=n.groupHeading,o=n.itemDisabled,l=e.id,a=e.label,c=e.disabled,u=bt(a),f=document.createElement("div");ie(f,r),c&&ie(f,o),f.setAttribute("role","group"),f.dataset.group="",f.dataset.id=l,f.dataset.value=u,c&&f.setAttribute("aria-disabled","true");var d=document.createElement("div");return ie(d,s),Qe(d,i,a||""),f.appendChild(d),f},choice:function(t,e,i,n){var r=t.allowHTML,s=t.classNames,o=s.item,l=s.itemChoice,a=s.itemSelectable,c=s.selectedState,u=s.itemDisabled,f=s.description,d=s.placeholder,h=e.label,m=bt(e.value),g=document.createElement("div");g.id=e.elementId,ie(g,o),ie(g,l),n&&typeof h=="string"&&(h=cn(r,h),h+=" (".concat(n,")"),h={trusted:h});var v=g;if(e.labelClass){var y=document.createElement("span");Qe(y,r,h),ie(y,e.labelClass),v=y,g.appendChild(y)}else Qe(g,r,h);if(e.labelDescription){var E="".concat(e.elementId,"-description");v.setAttribute("aria-describedby",E);var T=document.createElement("span");Qe(T,r,e.labelDescription),T.id=E,ie(T,f),g.appendChild(T)}return e.selected&&ie(g,c),e.placeholder&&ie(g,d),g.setAttribute("role",e.group?"treeitem":"option"),g.dataset.choice="",g.dataset.id=e.id,g.dataset.value=m,i&&(g.dataset.selectText=i),e.group&&(g.dataset.groupId="".concat(e.group.id)),$i(g,e,!1),e.disabled?(ie(g,u),g.dataset.choiceDisabled="",g.setAttribute("aria-disabled","true")):(ie(g,a),g.dataset.choiceSelectable=""),g},input:function(t,e){var i=t.classNames,n=i.input,r=i.inputCloned,s=t.labelId,o=document.createElement("input");return o.type="search",ie(o,n),ie(o,r),o.autocomplete="off",o.autocapitalize="off",o.spellcheck=!1,o.setAttribute("aria-autocomplete","list"),e?o.setAttribute("aria-label",e):s||vr(this._docRoot,this.passedElement.element.id,o),o},dropdown:function(t){var e=t.classNames,i=e.list,n=e.listDropdown,r=document.createElement("div");return ie(r,i),ie(r,n),r.setAttribute("aria-expanded","false"),r},notice:function(t,e,i){var n=t.classNames,r=n.item,s=n.itemChoice,o=n.addChoice,l=n.noResults,a=n.noChoices,c=n.notice;i===void 0&&(i=Oe.generic);var u=document.createElement("div");switch(Qe(u,!0,e),ie(u,r),ie(u,s),ie(u,c),i){case Oe.addChoice:ie(u,o);break;case Oe.noResults:ie(u,l);break;case Oe.noChoices:ie(u,a);break}return i===Oe.addChoice&&(u.dataset.choiceSelectable="",u.dataset.choice=""),u},option:function(t){var e=bt(t.label),i=new Option(e,t.value,!1,t.selected);return $i(i,t,!0),i.disabled=t.disabled,t.selected&&i.setAttribute("selected",""),i}},Iu="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,Au={},ji=function(t){if(t)return t.dataset.id?parseInt(t.dataset.id,10):void 0},Ht="[data-choice-selectable]",Ou=function(){function t(e,i){e===void 0&&(e="[data-choice]"),i===void 0&&(i={});var n=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var r=t.defaults;this.config=$e($e($e({},r.allOptions),r.options),i),rc.forEach(function(y){n.config[y]=$e($e($e({},r.allOptions[y]),r.options[y]),i[y])});var s=this.config;s.silent||this._validateConfig();var o=s.shadowRoot||document.documentElement;this._docRoot=o;var l=typeof e=="string"?o.querySelector(e):e;if(!l||typeof l!="object"||!(kc(l)||Ls(l)))throw TypeError(!l&&typeof e=="string"?"Selector ".concat(e," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var a=l.type,c=a===lt.Text;(c||s.maxItemCount!==1)&&(s.singleModeForMultiSelect=!1),s.singleModeForMultiSelect&&(a=lt.SelectMultiple);var u=a===lt.SelectOne,f=a===lt.SelectMultiple,d=u||f;if(this._elementType=a,this._isTextElement=c,this._isSelectOneElement=u,this._isSelectMultipleElement=f,this._isSelectElement=u||f,this._canAddUserChoices=c&&s.addItems||d&&s.addChoices,typeof s.renderSelectedChoices!="boolean"&&(s.renderSelectedChoices=s.renderSelectedChoices==="always"||u),s.closeDropdownOnSelect==="auto"?s.closeDropdownOnSelect=c||u||s.singleModeForMultiSelect:s.closeDropdownOnSelect=Bt(s.closeDropdownOnSelect),s.placeholder&&(s.placeholderValue?this._hasNonChoicePlaceholder=!0:l.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,s.placeholderValue=l.dataset.placeholder)),i.addItemFilter&&typeof i.addItemFilter!="function"){var h=i.addItemFilter instanceof RegExp?i.addItemFilter:new RegExp(i.addItemFilter);s.addItemFilter=h.test.bind(h)}if(this._isTextElement)this.passedElement=new Ec({element:l,classNames:s.classNames});else{var m=l;this.passedElement=new Ac({element:m,classNames:s.classNames,template:function(y){return n._templates.option(y)},extractPlaceholder:s.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Rc(s),this._currentValue="",s.searchEnabled=!c&&s.searchEnabled||f,this._canSearch=s.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=uc(l,"choices-"),this._direction=l.dir,!this._direction){var g=window.getComputedStyle(l).direction,v=window.getComputedStyle(document.documentElement).direction;g!==v&&(this._direction=g)}if(this._idNames={itemChoice:"item-choice"},this._templates=r.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){s.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(y){return y.value})}return Object.defineProperty(t,"defaults",{get:function(){return Object.preventExtensions({get options(){return Au},get allOptions(){return cr},get templates(){return Cu}})},enumerable:!1,configurable:!0}),t.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=Eu(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var e=this.config.callbackOnInit;typeof e=="function"&&e.call(this)}},t.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=t.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},t.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},t.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},t.prototype.highlightItem=function(e,i){if(i===void 0&&(i=!0),!e||!e.id)return this;var n=this._store.items.find(function(r){return r.id===e.id});return!n||n.highlighted?this:(this._store.dispatch(ii(n,!0)),i&&this.passedElement.triggerEvent(Ne.highlightItem,this._getChoiceForOutput(n)),this)},t.prototype.unhighlightItem=function(e,i){if(i===void 0&&(i=!0),!e||!e.id)return this;var n=this._store.items.find(function(r){return r.id===e.id});return!n||!n.highlighted?this:(this._store.dispatch(ii(n,!1)),i&&this.passedElement.triggerEvent(Ne.unhighlightItem,this._getChoiceForOutput(n)),this)},t.prototype.highlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(i){i.highlighted||(e._store.dispatch(ii(i,!0)),e.passedElement.triggerEvent(Ne.highlightItem,e._getChoiceForOutput(i)))})}),this},t.prototype.unhighlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(i){i.highlighted&&(e._store.dispatch(ii(i,!1)),e.passedElement.triggerEvent(Ne.highlightItem,e._getChoiceForOutput(i)))})}),this},t.prototype.removeActiveItemsByValue=function(e){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(n){return n.value===e}).forEach(function(n){return i._removeItem(n)})}),this},t.prototype.removeActiveItems=function(e){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(n){var r=n.id;return r!==e}).forEach(function(n){return i._removeItem(n)})}),this},t.prototype.removeHighlightedItems=function(e){var i=this;return e===void 0&&(e=!1),this._store.withTxn(function(){i._store.highlightedActiveItems.forEach(function(n){i._removeItem(n),e&&i._triggerChange(n.value)})}),this},t.prototype.showDropdown=function(e){var i=this;return this.dropdown.isActive?this:(e===void 0&&(e=!this._canSearch),requestAnimationFrame(function(){i.dropdown.show();var n=i.dropdown.element.getBoundingClientRect();i.containerOuter.open(n.bottom,n.height),e||i.input.focus(),i.passedElement.triggerEvent(Ne.showDropdown)}),this)},t.prototype.hideDropdown=function(e){var i=this;return this.dropdown.isActive?(requestAnimationFrame(function(){i.dropdown.hide(),i.containerOuter.close(),!e&&i._canSearch&&(i.input.removeActiveDescendant(),i.input.blur()),i.passedElement.triggerEvent(Ne.hideDropdown)}),this):this},t.prototype.getValue=function(e){var i=this,n=this._store.items.map(function(r){return e?r.value:i._getChoiceForOutput(r)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?n[0]:n},t.prototype.setValue=function(e){var i=this;return this.initialisedOK?(this._store.withTxn(function(){e.forEach(function(n){n&&i._addChoice(We(n,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},t.prototype.setChoiceByValue=function(e){var i=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var n=Array.isArray(e)?e:[e];n.forEach(function(r){return i._findAndSelectChoiceByValue(r)}),i.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},t.prototype.setChoices=function(e,i,n,r,s,o){var l=this;if(e===void 0&&(e=[]),i===void 0&&(i="value"),n===void 0&&(n="label"),r===void 0&&(r=!1),s===void 0&&(s=!0),o===void 0&&(o=!1),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof i!="string"||!i)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(typeof e=="function"){var a=e(this);if(typeof Promise=="function"&&a instanceof Promise)return new Promise(function(c){return requestAnimationFrame(c)}).then(function(){return l._handleLoadingState(!0)}).then(function(){return a}).then(function(c){return l.setChoices(c,i,n,r,s,o)}).catch(function(c){l.config.silent||console.error(c)}).then(function(){return l._handleLoadingState(!1)}).then(function(){return l});if(!Array.isArray(a))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof a));return this.setChoices(a,i,n,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){s&&(l._isSearching=!1),r&&l.clearChoices(!0,o);var c=i==="value",u=n==="label";e.forEach(function(f){if("choices"in f){var d=f;u||(d=$e($e({},d),{label:d[n]})),l._addGroup(We(d,!0))}else{var h=f;(!u||!c)&&(h=$e($e({},h),{value:h[i],label:h[n]}));var m=We(h,!1);l._addChoice(m),m.placeholder&&!l._hasNonChoicePlaceholder&&(l._placeholderValue=Os(m.label))}}),l.unhighlightAll()}),this._searcher.reset(),this},t.prototype.refresh=function(e,i,n){var r=this;return e===void 0&&(e=!1),i===void 0&&(i=!1),n===void 0&&(n=!1),this._isSelectElement?(this._store.withTxn(function(){var s=r.passedElement.optionsAsChoices(),o={};n||r._store.items.forEach(function(a){a.id&&a.active&&a.selected&&(o[a.value]=!0)}),r.clearStore(!1);var l=function(a){n?r._store.dispatch(rr(a)):o[a.value]&&(a.selected=!0)};s.forEach(function(a){if("choices"in a){a.choices.forEach(l);return}l(a)}),r._addPredefinedChoices(s,i,e),r._isSearching&&r._searchChoices(r.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},t.prototype.removeChoice=function(e){var i=this._store.choices.find(function(n){return n.value===e});return i?(this._clearNotice(),this._store.dispatch(sc(i)),this._searcher.reset(),i.selected&&this.passedElement.triggerEvent(Ne.removeItem,this._getChoiceForOutput(i)),this):this},t.prototype.clearChoices=function(e,i){var n=this;return e===void 0&&(e=!0),i===void 0&&(i=!1),e&&(i?this.passedElement.element.replaceChildren(""):this.passedElement.element.querySelectorAll(":not([selected])").forEach(function(r){r.remove()})),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.withTxn(function(){var r=i?[]:n._store.items;n._store.reset(),r.forEach(function(s){n._store.dispatch(ir(s)),n._store.dispatch(nr(s))})}),this._searcher.reset(),this},t.prototype.clearStore=function(e){return e===void 0&&(e=!0),this.clearChoices(e,!0),this._stopSearch(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this},t.prototype.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),this._stopSearch(),this},t.prototype._validateConfig=function(){var e=this.config,i=_c(e,cr);i.length&&console.warn("Unknown config option(s) passed",i.join(", ")),e.allowHTML&&e.allowHtmlUserInput&&(e.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),e.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},t.prototype._render=function(e){e===void 0&&(e={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(e.choices||e.groups)&&this._renderChoices(),e.items&&this._renderItems())},t.prototype._renderChoices=function(){var e=this;if(this._canAddItems()){var i=this,n=i.config,r=i._isSearching,s=this._store,o=s.activeGroups,l=s.activeChoices,a=0;if(r&&n.searchResultLimit>0?a=n.searchResultLimit:n.renderChoiceLimit>0&&(a=n.renderChoiceLimit),this._isSelectElement){var c=l.filter(function(m){return!m.element});c.length&&this.passedElement.addOptions(c)}var u=document.createDocumentFragment(),f=function(m){return m.filter(function(g){return!g.placeholder&&(r?!!g.rank:n.renderSelectedChoices||!g.selected)})},d=!1,h=function(m,g,v){r?m.sort(mc):n.shouldSort&&m.sort(n.sorter);var y=m.length;y=!g&&a&&y>a?a:y,y--,m.every(function(E,T){var H=E.choiceEl||e._templates.choice(n,E,n.itemSelectText,v);return E.choiceEl=H,u.appendChild(H),(r||!E.selected)&&(d=!0),T<y})};l.length&&(n.resetScrollPosition&&requestAnimationFrame(function(){return e.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!r&&this._isSelectOneElement&&h(l.filter(function(m){return m.placeholder&&!m.group}),!1,void 0),o.length&&!r?(n.shouldSort&&o.sort(n.sorter),h(l.filter(function(m){return!m.placeholder&&!m.group}),!1,void 0),o.forEach(function(m){var g=f(m.choices);if(g.length){if(m.label){var v=m.groupEl||e._templates.choiceGroup(e.config,m);m.groupEl=v,v.remove(),u.appendChild(v)}h(g,!0,n.appendGroupInSearch&&r?m.label:void 0)}})):h(f(l),!1,void 0)),!d&&(r||!u.children.length||!n.renderSelectedChoices)&&(this._notice||(this._notice={text:or(r?n.noResultsText:n.noChoicesText),type:r?Oe.noResults:Oe.noChoices}),u.replaceChildren("")),this._renderNotice(u),this.choiceList.element.replaceChildren(u),d&&this._highlightChoice()}},t.prototype._renderItems=function(){var e=this,i=this._store.items||[],n=this.itemList.element,r=this.config,s=document.createDocumentFragment(),o=function(f){return n.querySelector('[data-item][data-id="'.concat(f.id,'"]'))},l=function(f){var d=f.itemEl;d&&d.parentElement||(d=o(f)||e._templates.item(r,f,r.removeItemButton),f.itemEl=d,s.appendChild(d))};i.forEach(l);var a=!!s.childNodes.length;if(this._isSelectOneElement){var c=n.children.length;if(a||c>1){var u=n.querySelector(Ut(r.classNames.placeholder));u&&u.remove()}else!a&&!c&&this._placeholderValue&&(a=!0,l(We({selected:!0,value:"",label:this._placeholderValue,placeholder:!0},!1)))}a&&(n.append(s),r.shouldSortItems&&!this._isSelectOneElement&&(i.sort(r.sorter),i.forEach(function(f){var d=o(f);d&&(d.remove(),s.append(d))}),n.append(s))),this._isTextElement&&(this.passedElement.value=i.map(function(f){var d=f.value;return d}).join(r.delimiter))},t.prototype._displayNotice=function(e,i,n){n===void 0&&(n=!0);var r=this._notice;if(r&&(r.type===i&&r.text===e||r.type===Oe.addChoice&&(i===Oe.noResults||i===Oe.noChoices))){n&&this.showDropdown(!0);return}this._clearNotice(),this._notice=e?{text:e,type:i}:void 0,this._renderNotice(),n&&e&&this.showDropdown(!0)},t.prototype._clearNotice=function(){if(this._notice){var e=this.choiceList.element.querySelector(Ut(this.config.classNames.notice));e&&e.remove(),this._notice=void 0}},t.prototype._renderNotice=function(e){var i=this._notice;if(i){var n=this._templates.notice(this.config,i.text,i.type);e?e.append(n):this.choiceList.prepend(n)}},t.prototype._getChoiceForOutput=function(e,i){return{id:e.id,highlighted:e.highlighted,labelClass:e.labelClass,labelDescription:e.labelDescription,customProperties:e.customProperties,disabled:e.disabled,active:e.active,label:e.label,placeholder:e.placeholder,value:e.value,groupValue:e.group?e.group.label:void 0,element:e.element,keyCode:i}},t.prototype._triggerChange=function(e){e!=null&&this.passedElement.triggerEvent(Ne.change,{value:e})},t.prototype._handleButtonAction=function(e){var i=this,n=this._store.items;if(!(!n.length||!this.config.removeItems||!this.config.removeItemButton)){var r=e&&ji(e.parentElement),s=r&&n.find(function(o){return o.id===r});s&&this._store.withTxn(function(){if(i._removeItem(s),i._triggerChange(s.value),i._isSelectOneElement&&!i._hasNonChoicePlaceholder){var o=(i.config.shouldSort?i._store.choices.reverse():i._store.choices).find(function(l){return l.placeholder});o&&(i._addItem(o),i.unhighlightAll(),o.value&&i._triggerChange(o.value))}})}},t.prototype._handleItemAction=function(e,i){var n=this;i===void 0&&(i=!1);var r=this._store.items;if(!(!r.length||!this.config.removeItems||this._isSelectOneElement)){var s=ji(e);s&&(r.forEach(function(o){o.id===s&&!o.highlighted?n.highlightItem(o):!i&&o.highlighted&&n.unhighlightItem(o)}),this.input.focus())}},t.prototype._handleChoiceAction=function(e){var i=this,n=ji(e),r=n&&this._store.getChoiceById(n);if(!r||r.disabled)return!1;var s=this.dropdown.isActive;if(!r.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){i._addItem(r,!0,!0),i.clearInput(),i.unhighlightAll()}),this._triggerChange(r.value)}return s&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},t.prototype._handleBackspace=function(e){var i=this.config;if(!(!i.removeItems||!e.length)){var n=e[e.length-1],r=e.some(function(s){return s.highlighted});i.editItems&&!r&&n?(this.input.value=n.value,this.input.setWidth(),this._removeItem(n),this._triggerChange(n.value)):(r||this.highlightItem(n,!1),this.removeHighlightedItems(!0))}},t.prototype._loadChoices=function(){var e,i=this,n=this.config;if(this._isTextElement){if(this._presetChoices=n.items.map(function(o){return We(o,!1)}),this.passedElement.value){var r=this.passedElement.value.split(n.delimiter).map(function(o){return We(o,!1,i.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(r)}this._presetChoices.forEach(function(o){o.selected=!0})}else if(this._isSelectElement){this._presetChoices=n.choices.map(function(o){return We(o,!0)});var s=this.passedElement.optionsAsChoices();s&&(e=this._presetChoices).push.apply(e,s)}},t.prototype._handleLoadingState=function(e){e===void 0&&(e=!0);var i=this.itemList.element;e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?i.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(i.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},t.prototype._handleSearch=function(e){if(this.input.isFocussed)if(e!==null&&typeof e<"u"&&e.length>=this.config.searchFloor){var i=this.config.searchChoices?this._searchChoices(e):0;i!==null&&this.passedElement.triggerEvent(Ne.search,{value:e,resultCount:i})}else this._store.choices.some(function(n){return!n.active})&&this._stopSearch()},t.prototype._canAddItems=function(){var e=this.config,i=e.maxItemCount,n=e.maxItemText;return!e.singleModeForMultiSelect&&i>0&&i<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof n=="function"?n(i):n,Oe.addChoice),!1):(this._notice&&this._notice.type===Oe.addChoice&&this._clearNotice(),!0)},t.prototype._canCreateItem=function(e){var i=this.config,n=!0,r="";if(n&&typeof i.addItemFilter=="function"&&!i.addItemFilter(e)&&(n=!1,r=zt(i.customAddItemText,e)),n){var s=this._store.choices.find(function(o){return i.valueComparer(o.value,e)});if(s){if(this._isSelectElement)return this._displayNotice("",Oe.addChoice),!1;i.duplicateItemsAllowed||(n=!1,r=zt(i.uniqueItemText,e))}}return n&&(r=zt(i.addItemText,e)),r&&this._displayNotice(r,Oe.addChoice),n},t.prototype._searchChoices=function(e){var i=e.trim().replace(/\s{2,}/," ");if(!i.length||i===this._currentValue)return null;var n=this._searcher;n.isEmptyIndex()&&n.index(this._store.searchableChoices);var r=n.search(i);this._currentValue=i,this._highlightPosition=0,this._isSearching=!0;var s=this._notice,o=s&&s.type;return o!==Oe.addChoice&&(r.length?this._clearNotice():this._displayNotice(or(this.config.noResultsText),Oe.noResults)),this._store.dispatch(oc(r)),r.length},t.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(lc(!0)),this.passedElement.triggerEvent(Ne.search,{value:"",resultCount:0}))},t.prototype._addEventListeners=function(){var e=this._docRoot,i=this.containerOuter.element,n=this.input.element;e.addEventListener("touchend",this._onTouchEnd,!0),i.addEventListener("keydown",this._onKeyDown,!0),i.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0})),n.addEventListener("keyup",this._onKeyUp,{passive:!0}),n.addEventListener("input",this._onInput,{passive:!0}),n.addEventListener("focus",this._onFocus,{passive:!0}),n.addEventListener("blur",this._onBlur,{passive:!0}),n.form&&n.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},t.prototype._removeEventListeners=function(){var e=this._docRoot,i=this.containerOuter.element,n=this.input.element;e.removeEventListener("touchend",this._onTouchEnd,!0),i.removeEventListener("keydown",this._onKeyDown,!0),i.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur)),n.removeEventListener("keyup",this._onKeyUp),n.removeEventListener("input",this._onInput),n.removeEventListener("focus",this._onFocus),n.removeEventListener("blur",this._onBlur),n.form&&n.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},t.prototype._onKeyDown=function(e){var i=e.keyCode,n=this.dropdown.isActive,r=e.key.length===1||e.key.length===2&&e.key.charCodeAt(0)>=55296||e.key==="Unidentified";switch(!this._isTextElement&&!n&&i!==Le.ESC_KEY&&i!==Le.TAB_KEY&&i!==Le.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&r&&(this.input.value+=e.key,e.key===" "&&e.preventDefault())),i){case Le.A_KEY:return this._onSelectKey(e,this.itemList.element.hasChildNodes());case Le.ENTER_KEY:return this._onEnterKey(e,n);case Le.ESC_KEY:return this._onEscapeKey(e,n);case Le.UP_KEY:case Le.PAGE_UP_KEY:case Le.DOWN_KEY:case Le.PAGE_DOWN_KEY:return this._onDirectionKey(e,n);case Le.DELETE_KEY:case Le.BACK_KEY:return this._onDeleteKey(e,this._store.items,this.input.isFocussed)}},t.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},t.prototype._onInput=function(){var e=this.input.value;if(!e){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(e),this._canAddUserChoices&&(this._canCreateItem(e),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},t.prototype._onSelectKey=function(e,i){if((e.ctrlKey||e.metaKey)&&i){this._canSearch=!1;var n=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;n&&this.highlightAll()}},t.prototype._onEnterKey=function(e,i){var n=this,r=this.input.value,s=e.target;if(e.preventDefault(),s&&s.hasAttribute("data-button")){this._handleButtonAction(s);return}if(!i){(this._isSelectElement||this._notice)&&this.showDropdown();return}var o=this.dropdown.element.querySelector(Ut(this.config.classNames.highlightedState));if(!(o&&this._handleChoiceAction(o))){if(!s||!r){this.hideDropdown(!0);return}if(this._canAddItems()){var l=!1;this._store.withTxn(function(){if(l=n._findAndSelectChoiceByValue(r,!0),!l){if(!n._canAddUserChoices||!n._canCreateItem(r))return;n._addChoice(We(r,!1,n.config.allowHtmlUserInput),!0,!0),l=!0}n.clearInput(),n.unhighlightAll()}),l&&(this._triggerChange(r),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},t.prototype._onEscapeKey=function(e,i){i&&(e.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},t.prototype._onDirectionKey=function(e,i){var n=e.keyCode;if(i||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var r=n===Le.DOWN_KEY||n===Le.PAGE_DOWN_KEY?1:-1,s=e.metaKey||n===Le.PAGE_DOWN_KEY||n===Le.PAGE_UP_KEY,o=void 0;if(s)r>0?o=this.dropdown.element.querySelector("".concat(Ht,":last-of-type")):o=this.dropdown.element.querySelector(Ht);else{var l=this.dropdown.element.querySelector(Ut(this.config.classNames.highlightedState));l?o=fc(l,Ht,r):o=this.dropdown.element.querySelector(Ht)}o&&(dc(o,this.choiceList.element,r)||this.choiceList.scrollToChildElement(o,r),this._highlightChoice(o)),e.preventDefault()}},t.prototype._onDeleteKey=function(e,i,n){!this._isSelectOneElement&&!e.target.value&&n&&(this._handleBackspace(i),e.preventDefault())},t.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},t.prototype._onTouchEnd=function(e){var i=(e||e.touches[0]).target,n=this._wasTap&&this.containerOuter.element.contains(i);if(n){var r=i===this.containerOuter.element||i===this.containerInner.element;r&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()}this._wasTap=!0},t.prototype._onMouseDown=function(e){var i=e.target;if(i instanceof HTMLElement){if(Iu&&this.choiceList.element.contains(i)){var n=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?e.offsetX>=n.offsetWidth:e.offsetX<n.offsetLeft}if(i!==this.input.element){var r=i.closest("[data-button],[data-item],[data-choice]");r instanceof HTMLElement&&("button"in r.dataset?this._handleButtonAction(r):"item"in r.dataset?this._handleItemAction(r,e.shiftKey):"choice"in r.dataset&&this._handleChoiceAction(r)),e.preventDefault()}}},t.prototype._onMouseOver=function(e){var i=e.target;i instanceof HTMLElement&&"choice"in i.dataset&&this._highlightChoice(i)},t.prototype._onClick=function(e){var i=e.target,n=this.containerOuter,r=n.element.contains(i);r?!this.dropdown.isActive&&!n.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),n.element.focus()):this._isSelectOneElement&&i!==this.input.element&&!this.dropdown.element.contains(i)&&this.hideDropdown():(n.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},t.prototype._onFocus=function(e){var i=e.target,n=this.containerOuter,r=i&&n.element.contains(i);if(r){var s=i===this.input.element;this._isTextElement?s&&n.addFocusState():this._isSelectMultipleElement?s&&(this.showDropdown(!0),n.addFocusState()):(n.addFocusState(),s&&this.showDropdown(!0))}},t.prototype._onBlur=function(e){var i=e.target,n=this.containerOuter,r=i&&n.element.contains(i);r&&!this._isScrollingOnIe?i===this.input.element?(n.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):i===this.containerOuter.element&&(n.removeFocusState(),this._canSearch||this.hideDropdown(!0)):(this._isScrollingOnIe=!1,this.input.element.focus())},t.prototype._onFormReset=function(){var e=this;this._store.withTxn(function(){e.clearInput(),e.hideDropdown(),e.refresh(!1,!1,!0),e._initialItems.length&&e.setChoiceByValue(e._initialItems)})},t.prototype._highlightChoice=function(e){e===void 0&&(e=null);var i=Array.from(this.dropdown.element.querySelectorAll(Ht));if(i.length){var n=e,r=this.config.classNames.highlightedState,s=Array.from(this.dropdown.element.querySelectorAll(Ut(r)));s.forEach(function(o){Ye(o,r),o.setAttribute("aria-selected","false")}),n?this._highlightPosition=i.indexOf(n):(i.length>this._highlightPosition?n=i[this._highlightPosition]:n=i[i.length-1],n||(n=i[0])),ie(n,r),n.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(Ne.highlightChoice,{el:n}),this.dropdown.isActive&&(this.input.setActiveDescendant(n.id),this.containerOuter.setActiveDescendant(n.id))}},t.prototype._addItem=function(e,i,n){if(i===void 0&&(i=!0),n===void 0&&(n=!1),!e.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e.id),this._store.dispatch(nr(e)),i&&(this.passedElement.triggerEvent(Ne.addItem,this._getChoiceForOutput(e)),n&&this.passedElement.triggerEvent(Ne.choice,this._getChoiceForOutput(e)))},t.prototype._removeItem=function(e){if(e.id){this._store.dispatch(rr(e));var i=this._notice;i&&i.type===Oe.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(Ne.removeItem,this._getChoiceForOutput(e))}},t.prototype._addChoice=function(e,i,n){if(i===void 0&&(i=!0),n===void 0&&(n=!1),e.id)throw new TypeError("Can not re-add a choice which has already been added");var r=this.config;if(!(!r.duplicateItemsAllowed&&this._store.choices.find(function(l){return r.valueComparer(l.value,e.value)}))){this._lastAddedChoiceId++,e.id=this._lastAddedChoiceId,e.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(e.id);var s=r.prependValue,o=r.appendValue;s&&(e.value=s+e.value),o&&(e.value+=o.toString()),(s||o)&&e.element&&(e.element.value=e.value),this._clearNotice(),this._store.dispatch(ir(e)),e.selected&&this._addItem(e,i,n)}},t.prototype._addGroup=function(e,i){var n=this;if(i===void 0&&(i=!0),e.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(ac(e)),e.choices&&(this._lastAddedGroupId++,e.id=this._lastAddedGroupId,e.choices.forEach(function(r){r.group=e,e.disabled&&(r.disabled=!0),n._addChoice(r,i)}))},t.prototype._createTemplates=function(){var e=this,i=this.config.callbackOnCreateTemplates,n={};typeof i=="function"&&(n=i.call(this,hc,cn,yi));var r={};Object.keys(this._templates).forEach(function(s){s in n?r[s]=n[s].bind(e):r[s]=e._templates[s].bind(e)}),this._templates=r},t.prototype._createElements=function(){var e=this._templates,i=this,n=i.config,r=i._isSelectOneElement,s=n.position,o=n.classNames,l=this._elementType;this.containerOuter=new lr({element:e.containerOuter(n,this._direction,this._isSelectElement,r,n.searchEnabled,l,n.labelId),classNames:o,type:l,position:s}),this.containerInner=new lr({element:e.containerInner(n),classNames:o,type:l,position:s}),this.input=new wc({element:e.input(n,this._placeholderValue),classNames:o,type:l,preventPaste:!n.paste}),this.choiceList=new ar({element:e.choiceList(n,r)}),this.itemList=new ar({element:e.itemList(n,r)}),this.dropdown=new yc({element:e.dropdown(n),classNames:o,type:l})},t.prototype._createStructure=function(){var e=this,i=e.containerInner,n=e.containerOuter,r=e.passedElement,s=this.dropdown.element;r.conceal(),i.wrap(r.element),n.wrap(i.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),n.element.appendChild(i.element),n.element.appendChild(s),i.element.appendChild(this.itemList.element),s.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&s.insertBefore(this.input.element,s.firstChild):i.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},t.prototype._initStore=function(){var e=this;this._store.subscribe(this._render).withTxn(function(){e._addPredefinedChoices(e._presetChoices,e._isSelectOneElement&&!e._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},t.prototype._addPredefinedChoices=function(e,i,n){var r=this;if(i===void 0&&(i=!1),n===void 0&&(n=!0),i){var s=e.findIndex(function(o){return o.selected})===-1;s&&e.some(function(o){return o.disabled||"choices"in o?!1:(o.selected=!0,!0)})}e.forEach(function(o){"choices"in o?r._isSelectElement&&r._addGroup(o,n):r._addChoice(o,n)})},t.prototype._findAndSelectChoiceByValue=function(e,i){var n=this;i===void 0&&(i=!1);var r=this._store.choices.find(function(s){return n.config.valueComparer(s.value,e)});return r&&!r.disabled&&!r.selected?(this._addItem(r,!0,i),!0):!1},t.prototype._generatePlaceholderValue=function(){var e=this.config;if(!e.placeholder)return null;if(this._hasNonChoicePlaceholder)return e.placeholderValue;if(this._isSelectElement){var i=this.passedElement.placeholderOption;return i?i.text:null}return null},t.prototype._warnChoicesInitFailed=function(e){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(e," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(e," called on a non-initialised instance of Choices"))},t.version="11.1.0",t}();function br(t){let e,i;return{c(){e=w("label"),i=Y(t[2]),p(e,"for",t[4])},m(n,r){C(n,e,r),b(e,i)},p(n,r){r&4&&de(i,n[2])},d(n){n&&k(e)}}}function Tu(t){let e;return{c(){e=w("select"),p(e,"id",t[4]),p(e,"name",t[4]),p(e,"aria-label",t[2]),p(e,"class","m-1")},m(i,n){C(i,e,n)},p(i,n){n&4&&p(e,"aria-label",i[2])},i:N,o:N,d(i){i&&k(e)}}}function Pu(t){let e,i,n,r=t[3].length&&yr(t);return{c(){r&&r.c(),e=x(),i=w("select"),p(i,"id",t[4]),p(i,"name",t[4]),p(i,"aria-label",t[2]),p(i,"class","m-1"),i.multiple=!0},m(s,o){r&&r.m(s,o),C(s,e,o),C(s,i,o),n=!0},p(s,o){s[3].length?r?(r.p(s,o),o&8&&P(r,1)):(r=yr(s),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(ve(),M(r,1,1,()=>{r=null}),be()),(!n||o&4)&&p(i,"aria-label",s[2])},i(s){n||(P(r),n=!0)},o(s){M(r),n=!1},d(s){r&&r.d(s),s&&k(e),s&&k(i)}}}function yr(t){let e,i,n=t[3].length+"",r,s,o,l;return o=new vi({props:{targetHtmlId:t[5],tooltipText:`${t[3].length}
                                    ${j==="fr"&&t[3].length>1?"valeurs sélectionnées":j==="fr"&&t[3].length===1?"valeur sélectionnée":j==="en"&&t[3].length>1?"selected values":"selected value"}`}}),{c(){e=w("span"),i=w("span"),r=Y(n),s=x(),Z(o.$$.fragment),p(i,"id",t[5]),p(i,"class","input-dropdown-count tag m-1 svelte-1epfuu8"),p(e,"class","is-relative")},m(a,c){C(a,e,c),b(e,i),b(i,r),b(e,s),X(o,e,null),l=!0},p(a,c){(!l||c&8)&&n!==(n=a[3].length+"")&&de(r,n);const u={};c&8&&(u.tooltipText=`${a[3].length}
                                    ${j==="fr"&&a[3].length>1?"valeurs sélectionnées":j==="fr"&&a[3].length===1?"valeur sélectionnée":j==="en"&&a[3].length>1?"selected values":"selected value"}`),o.$set(u)},i(a){l||(P(o.$$.fragment,a),l=!0)},o(a){M(o.$$.fragment,a),l=!1},d(a){a&&k(e),Q(o)}}}function Lu(t){let e,i,n,r,s,o,l,a=t[2]!==void 0&&br(t);const c=[Pu,Tu],u=[];function f(d,h){return d[0]?0:1}return r=f(t),s=u[r]=c[r](t),{c(){e=w("div"),a&&a.c(),i=x(),n=w("div"),s.c(),p(n,"class",o="input-dropdown-select "+(t[0]?"is-multiple":"is-single")+" "+(t[0]&&t[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(t[1]?"light-display":"")+" svelte-1epfuu8"),p(e,"class","input-dropdown-select-wrapper")},m(d,h){C(d,e,h),a&&a.m(e,null),b(e,i),b(e,n),u[r].m(n,null),l=!0},p(d,[h]){d[2]!==void 0?a?a.p(d,h):(a=br(d),a.c(),a.m(e,i)):a&&(a.d(1),a=null);let m=r;r=f(d),r===m?u[r].p(d,h):(ve(),M(u[m],1,1,()=>{u[m]=null}),be(),s=u[r],s?s.p(d,h):(s=u[r]=c[r](d),s.c()),P(s,1),s.m(n,null)),(!l||h&11&&o!==(o="input-dropdown-select "+(d[0]?"is-multiple":"is-single")+" "+(d[0]&&d[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(d[1]?"light-display":"")+" svelte-1epfuu8"))&&p(n,"class",o)},i(d){l||(P(s),l=!0)},o(d){M(s),l=!1},d(d){d&&k(e),a&&a.d(),u[r].d()}}}const Ru=250;function Mu(t,e,i){let n,r,{choicesItems:s}=e,{start:o=[]}=e,{multiple:l}=e,{searchable:a=!0}=e,{lightDisplay:c=!1}=e,{placeholder:u=j==="fr"?"Sélectionner une valeur":"Select a value"}=e,{title:f=void 0}=e,{selectAll:d=!!l}=e;const h=`input-dropdown-select-${window.crypto.randomUUID()}`,m=`input-dropdown-counter-${window.crypto.randomUUID()}`,g=`select-all-${window.crypto.randomUUID()}`,v=`unselect-all-${window.crypto.randomUUID()}`,y=en();let E;const T=fi();T.setCompareFn(sn);const H=Ce("resetTrigger")||void 0;H==null||H.subscribe(()=>D(E,s,o,d));const F=()=>{i(11,r=!0),setTimeout(()=>i(11,r=!1),Ru)},B=(U,ne)=>{ne||(T.set(U),T.same()||y("updateValues",n))},L=U=>`<span class="iconify" data-icon=${U}/>`,I=(U,ne)=>U!=null&&ne!=null&&U.length&&ne.length?`<span class="dropdown-prefix-wrapper">${ne==="iconify"?L(U):U}</span>`:"",O=(U,ne)=>ne?[{value:g,label:`<b>${j==="fr"?"Tout sélectionner":"Select all"}</b>`},{value:v,label:`<b>${j==="fr"?"Tout retirer":"Remove all"}</b>`},...U]:U,q=(U,ne)=>O(U,ne).map(ae=>(ae.id=`dropdown-choice-${window.crypto.randomUUID()}`,ae.label=`<span>
                ${I(ae.prefix||"",ae.prefixType||"")}
                <span class="dropdown-prefix-text">${ae.label}</span>
            </span>`,ae));function R(U,ne,ae){return U=structuredClone(U),ne=structuredClone(ne),U=q(U,ae).map(se=>ne.includes(se.value)?{...se,selected:!0}:{...se,selected:!1}),i(3,n=ne),U}function D(U,ne,ae,se){U&&(ne=R(ne,ae,se),U.clearStore().setChoices(ne))}const $=(U,ne,ae,se,Be,$t)=>(se=structuredClone(se),ae=structuredClone(ae),U.detail.value===Be?(F(),ae=ae.map(ze=>[Be,$t].includes(ze.value)?{...ze,selected:!1}:{...ze,selected:!0}),ne.removeActiveItems().clearChoices(!0,!0).setValue(ae).hideDropdown(),se=[...new Set(ae.filter(ze=>ze.selected===!0).map(ze=>ze.value))]):U.detail.value===$t?(ne.removeActiveItems().hideDropdown(),se=[]):se=l===!0?[...se,U.detail.value]:[U.detail.value],[...new Set(se)]),W=(U,ne)=>structuredClone(ne).filter(ae=>ae!==U.detail.value);function z(U,ne){const ae=document.getElementById(h);E=new Ou(ae,{items:[],choices:U,addChoices:!1,addItems:!1,removeItems:!0,removeItemButton:!0,searchEnabled:a,allowHTML:!0,shouldSort:!ne,sorter:(se,Be)=>se.label.localeCompare(Be.label),placeholderValue:u,classNames:{item:["choices__item","dropdown-item"]},loadingText:j==="fr"?"Chargement...":"Loading...",noResultsText:j==="fr"?"Pas de résultats":"No results found",noChoicesText:j==="fr"?"Pas de choix pour faire la sélection":"No choices to choose from",itemSelectText:j==="fr"?"Cliquer pour sélectionner":"Press to select",uniqueItemText:j==="fr"?"Seules des valeurs uniques peuvent être ajoutées":"Only unique values can be added",customAddItemText:j==="fr"?"Les valeurs ne répondent pas aux conditions attendues":"Only values matching specific conditions can be added",removeItemIconText:j==="fr"?"Retirer l'item":"Remove item",addItemText:se=>j==="fr"?`Cliquer sur Entrer pour ajouter <b>${se}</b>`:`Press Enter to add <b>"${se}"</b>`,removeItemLabelText:se=>j==="fr"?`Retirer l'item: ${se}`:`Remove item: ${se}`,maxItemText:se=>j==="fr"?`Seulement ${se} items peuvent être ajoutées`:`Only ${se} items can be added`}),ae.addEventListener("addItem",se=>{i(3,n=$(se,E,U,n,g,v))}),ae.addEventListener("removeItem",se=>{i(3,n=W(se,n))})}return Mt(()=>{const U=R(s,o,d);z(U,d)}),Zi(()=>{E.destroy(),E=void 0}),t.$$set=U=>{"choicesItems"in U&&i(6,s=U.choicesItems),"start"in U&&i(7,o=U.start),"multiple"in U&&i(0,l=U.multiple),"searchable"in U&&i(8,a=U.searchable),"lightDisplay"in U&&i(1,c=U.lightDisplay),"placeholder"in U&&i(9,u=U.placeholder),"title"in U&&i(2,f=U.title),"selectAll"in U&&i(10,d=U.selectAll)},t.$$.update=()=>{t.$$.dirty&2056&&B(n,r)},i(3,n=[]),i(11,r=!1),[l,c,f,n,h,m,s,o,a,u,d,r]}class Us extends ue{constructor(e){super(),ce(this,e,Mu,Lu,le,{choicesItems:6,start:7,multiple:0,searchable:8,lightDisplay:1,placeholder:9,title:2,selectAll:10})}}function Du(t){let e,i,n,r,s,o;return s=new vi({props:{tooltipText:t[2]}}),{c(){e=w("div"),i=w("button"),n=w("span"),r=x(),Z(s.$$.fragment),p(n,"class","iconify"),p(n,"data-icon",t[0]),p(n,"title",t[1]),p(i,"class","svelte-11ixywk"),p(e,"class","is-inline-block icon-tooltip svelte-11ixywk")},m(l,a){C(l,e,a),b(e,i),b(i,n),b(i,r),X(s,i,null),o=!0},p(l,[a]){(!o||a&1)&&p(n,"data-icon",l[0]),(!o||a&2)&&p(n,"title",l[1]);const c={};a&4&&(c.tooltipText=l[2]),s.$set(c)},i(l){o||(P(s.$$.fragment,l),o=!0)},o(l){M(s.$$.fragment,l),o=!1},d(l){l&&k(e),Q(s)}}}function Nu(t,e,i){let{iconifyIcon:n,altText:r,tooltipText:s}=e;return t.$$set=o=>{"iconifyIcon"in o&&i(0,n=o.iconifyIcon),"altText"in o&&i(1,r=o.altText),"tooltipText"in o&&i(2,s=o.tooltipText)},[n,r,s]}class $u extends ue{constructor(e){super(),ce(this,e,Nu,Du,le,{iconifyIcon:0,altText:1,tooltipText:2})}}const ju=t=>({}),wr=t=>({}),Fu=t=>({}),Sr=t=>({});function Er(t){let e,i,n,r,s,o,l,a,c,u,f,d=t[1]&&kr(t);return a=new vi({props:{tooltipText:t[2][t[1]][j]}}),{c(){d&&d.c(),e=x(),i=w("div"),n=w("button"),r=Ke("svg"),s=Ke("path"),l=x(),Z(a.$$.fragment),p(s,"fill","none"),p(s,"stroke","currentColor"),p(s,"stroke-linecap","round"),p(s,"stroke-linejoin","round"),p(s,"stroke-width","1.5"),p(s,"d","M12 3v18m0 0l8.5-8.5M12 21l-8.5-8.5"),p(r,"style",o=`transform: rotate(${t[1]?"180":"0"}deg)`),p(r,"xmlns","http://www.w3.org/2000/svg"),p(r,"width","24"),p(r,"height","24"),p(r,"viewBox","0 0 24 24"),p(r,"class","svelte-jbs1sd"),p(n,"class","button is-link svelte-jbs1sd"),p(i,"class","ctrl-toggle svelte-jbs1sd")},m(h,m){d&&d.m(h,m),C(h,e,m),C(h,i,m),b(i,n),b(n,r),b(r,s),b(n,l),X(a,n,null),c=!0,u||(f=oe(n,"click",yt(t[3])),u=!0)},p(h,m){h[1]?d?(d.p(h,m),m&2&&P(d,1)):(d=kr(h),d.c(),P(d,1),d.m(e.parentNode,e)):d&&(ve(),M(d,1,1,()=>{d=null}),be()),(!c||m&2&&o!==(o=`transform: rotate(${h[1]?"180":"0"}deg)`))&&p(r,"style",o);const g={};m&2&&(g.tooltipText=h[2][h[1]][j]),a.$set(g)},i(h){c||(P(d),P(a.$$.fragment,h),c=!0)},o(h){M(d),M(a.$$.fragment,h),c=!1},d(h){d&&d.d(h),h&&k(e),h&&k(i),Q(a),u=!1,f()}}}function kr(t){let e,i,n;const r=t[5]["toolbar-hidden"],s=ut(r,t,t[4],wr);return{c(){e=w("div"),s&&s.c(),p(e,"class","ctrl-extra")},m(o,l){C(o,e,l),s&&s.m(e,null),n=!0},p(o,l){s&&s.p&&(!n||l&16)&&dt(s,r,o,o[4],n?ft(r,o[4],l,ju):ht(o[4]),wr)},i(o){n||(P(s,o),Ge(()=>{n&&(i||(i=Ue(e,An,{axis:"y"},!0)),i.run(1))}),n=!0)},o(o){M(s,o),i||(i=Ue(e,An,{axis:"y"},!1)),i.run(0),n=!1},d(o){o&&k(e),s&&s.d(o),o&&i&&i.end()}}}function Vu(t){let e,i,n,r,s,o,l,a;const c=t[5]["toolbar-visible"],u=ut(c,t,t[4],Sr);let f=t[0]&&Er(t);return{c(){e=w("div"),i=w("form"),n=w("div"),r=w("div"),s=w("div"),u&&u.c(),o=x(),f&&f.c(),p(s,"class","ctrl-block svelte-jbs1sd"),p(r,"class","ctrl-block-wrapper svelte-jbs1sd"),p(n,"class","ctrl-base"),p(i,"class","ctrl svelte-jbs1sd"),p(e,"id","toolbar"),p(e,"class",l="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(t[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd")},m(d,h){C(d,e,h),b(e,i),b(i,n),b(n,r),b(r,s),u&&u.m(s,null),b(i,o),f&&f.m(i,null),a=!0},p(d,[h]){u&&u.p&&(!a||h&16)&&dt(u,c,d,d[4],a?ft(c,d[4],h,Fu):ht(d[4]),Sr),d[0]?f?(f.p(d,h),h&1&&P(f,1)):(f=Er(d),f.c(),P(f,1),f.m(i,null)):f&&(ve(),M(f,1,1,()=>{f=null}),be()),(!a||h&2&&l!==(l="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(d[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd"))&&p(e,"class",l)},i(d){a||(P(u,d),P(f),a=!0)},o(d){M(u,d),M(f),a=!1},d(d){d&&k(e),u&&u.d(d),f&&f.d()}}}function xu(t,e,i){let n,{$$slots:r={},$$scope:s}=e,{expandable:o=!0}=e;const l={true:{en:"Collapse the toolbar",fr:"Refermer le menu"},false:{en:"Expand the toolbar",fr:"Ouvrir le menu"}},a=()=>i(1,n=!n);return t.$$set=c=>{"expandable"in c&&i(0,o=c.expandable),"$$scope"in c&&i(4,s=c.$$scope)},i(1,n=!1),[o,n,l,a,s,r]}class Uu extends ue{constructor(e){super(),ce(this,e,xu,Vu,le,{expandable:0})}}function Cr(t){let e,i;return e=new Us({props:{choicesItems:t[4],multiple:!0,placeholder:"...",start:Object.keys(t[5][t[13]]||{}),lightDisplay:!0,title:j==="fr"?"Régions sélectionnées":"Selected regions",selectAll:!0}}),e.$on("updateValues",t[22]),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,r){const s={};r&16&&(s.choicesItems=n[4]),r&32&&(s.start=Object.keys(n[5][n[13]]||{})),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Hu(t){return{c:N,m:N,p:N,i:N,o:N,d:N}}function Bu(t){let e,i,n=t[28].length&&zu(t);return{c(){n&&n.c(),e=he()},m(r,s){n&&n.m(r,s),C(r,e,s),i=!0},p(r,s){r[28].length&&n.p(r,s)},i(r){i||(P(n),i=!0)},o(r){M(n),i=!1},d(r){n&&n.d(r),r&&k(e)}}}function zu(t){let e,i;return e=new Is({props:{title:j==="fr"?"Score minimal":"Minimal score",minVal:t[28][0],maxVal:t[28][1],start:t[0]||t[28][0],roundTo:3}}),e.$on("updateSlider",t[18]),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,r){const s={};r&1&&(s.start=n[0]||n[28][0]),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function qu(t){return{c:N,m:N,p:N,i:N,o:N,d:N}}function Ku(t){let e,i,n=Object.keys(t[4]).length,r,s,o,l=n&&Cr(t),a={ctx:t,current:null,token:null,hasCatch:!1,pending:qu,then:Bu,catch:Hu,value:28,blocks:[,,,]};return nt(t[17],a),{c(){e=w("div"),i=w("div"),l&&l.c(),r=x(),s=w("div"),a.block.c(),p(i,"class","ctrl-input svelte-8yfni4"),p(s,"class","ctrl-input svelte-8yfni4"),p(e,"slot","toolbar-visible"),p(e,"class","ctrl-block-inputs svelte-8yfni4")},m(c,u){C(c,e,u),b(e,i),l&&l.m(i,null),b(e,r),b(e,s),a.block.m(s,a.anchor=null),a.mount=()=>s,a.anchor=null,o=!0},p(c,u){t=c,u&16&&(n=Object.keys(t[4]).length),n?l?(l.p(t,u),u&16&&P(l,1)):(l=Cr(t),l.c(),P(l,1),l.m(i,null)):l&&(ve(),M(l,1,1,()=>{l=null}),be()),Dt(a,t,u)},i(c){o||(P(l),P(a.block),o=!0)},o(c){M(l);for(let u=0;u<3;u+=1){const f=a.blocks[u];M(f)}o=!1},d(c){c&&k(e),l&&l.d(),a.block.d(),a.token=null,a=null}}}function Gu(t){let e,i,n,r,s,o,l,a,c,u,f,d,h,m,g,v,y,E,T,H,F,B,L;return a=new Us({props:{choicesItems:t[15],multiple:!0,placeholder:"...",start:t[1],lightDisplay:!0,title:j==="fr"?"Catégories masquées":"Hidden categories",selectAll:!0}}),a.$on("updateValues",t[19]),g=new $u({props:{iconifyIcon:"material-symbols:help-outline",altText:j==="en"?"Display help":"Afficher une explication",tooltipText:t[14]}}),T=new Is({props:{title:j==="fr"?"Profondeur de récursion":"Recursion depth",minVal:t[12][0],maxVal:t[12][1],start:t[2],step:1}}),T.$on("updateSlider",t[20]),B=new ic({props:{toggleLabel:j==="en"?"Filter by region":"Filtrer par région",start:t[3],buttonDisplay:!0}}),B.$on("updateChecked",t[21]),{c(){e=w("div"),i=w("div"),n=w("div"),r=w("span"),r.textContent=`${j==="en"?"Similarity":"Similarité"}`,s=x(),o=w("div"),l=w("div"),Z(a.$$.fragment),c=x(),u=w("div"),f=w("div"),d=w("div"),h=w("span"),h.textContent="Propagation",m=x(),Z(g.$$.fragment),v=x(),y=w("div"),E=w("div"),Z(T.$$.fragment),H=x(),F=w("div"),Z(B.$$.fragment),p(r,"class","tag is-medium is-link"),p(n,"class","ctrl-block-title svelte-8yfni4"),p(l,"class","ctrl-input svelte-8yfni4"),p(o,"class","ctrl-block-inputs svelte-8yfni4"),p(i,"class","ctrl-block svelte-8yfni4"),p(e,"class","ctrl-block-wrapper svelte-8yfni4"),p(h,"class","tag is-medium is-link mr-1"),p(d,"class","ctrl-block-title svelte-8yfni4"),p(E,"class","ctrl-input svelte-8yfni4"),p(F,"class","ctrl-input svelte-8yfni4"),p(y,"class","ctrl-block-inputs svelte-8yfni4"),p(f,"class","ctrl-block svelte-8yfni4"),p(u,"class","ctrl-block-wrapper svelte-8yfni4")},m(I,O){C(I,e,O),b(e,i),b(i,n),b(n,r),b(i,s),b(i,o),b(o,l),X(a,l,null),C(I,c,O),C(I,u,O),b(u,f),b(f,d),b(d,h),b(d,m),X(g,d,null),b(f,v),b(f,y),b(y,E),X(T,E,null),b(y,H),b(y,F),X(B,F,null),L=!0},p(I,O){const q={};O&2&&(q.start=I[1]),a.$set(q);const R={};O&4&&(R.start=I[2]),T.$set(R);const D={};O&8&&(D.start=I[3]),B.$set(D)},i(I){L||(P(a.$$.fragment,I),P(g.$$.fragment,I),P(T.$$.fragment,I),P(B.$$.fragment,I),L=!0)},o(I){M(a.$$.fragment,I),M(g.$$.fragment,I),M(T.$$.fragment,I),M(B.$$.fragment,I),L=!1},d(I){I&&k(e),Q(a),I&&k(c),I&&k(u),Q(g),Q(T),Q(B)}}}function Wu(t){let e,i;return e=new Uu({props:{$$slots:{"toolbar-hidden":[Gu],"toolbar-visible":[Ku]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,[r]){const s={};r&536870975&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Ir(){const t=document.getElementById("nav-actions");t&&document.documentElement.style.setProperty("--top-offset",`${t.offsetHeight}px`)}function Yu(t,e,i){let n,r,s,o,l,a,c,u;const{selectedRegions:f,comparedRegions:d,excludedCategories:h,similarityScoreCutoff:m,propagateRecursionDepth:g,propagateFilterByRegions:v,allowedPropagateDepthRange:y}=Ve;re(t,f,z=>i(5,u=z)),re(t,d,z=>i(25,r=z)),re(t,h,z=>i(1,o=z)),re(t,m,z=>i(23,s=z)),re(t,g,z=>i(2,l=z)),re(t,v,z=>i(3,a=z));let E;Mt(()=>{Ir(),E=new ResizeObserver(()=>{Ir()});const z=document.getElementById("nav-actions");return z&&E.observe(z),()=>{E&&z&&(E.unobserve(z),E.disconnect())}});const T=window.location.pathname.match(/\d+/g).join("-"),H=`${window.location.origin}${window.location.pathname}`,F=j==="en"?"Propagated matches are exact matches to images that have an exact match with the current image. There may be up to 6 exact matches connecting the current image and propagated images.":"Les correspondances propagées correspondent à des correspondances exactes à des images ayant une correspondance exacte avec l'image actuelle. Il peut y avoir jusqu'à 6 images reliant l'image actuelle à une correspondance propagée.",B=[{value:1,label:hs,prefix:as,prefixType:"svg"},{value:2,label:ps,prefix:cs,prefixType:"svg"},{value:3,label:ms,prefix:us,prefixType:"svg"},{value:4,label:gs,prefix:fs,prefixType:"svg"},{value:5,label:_s,prefix:ds,prefixType:"svg"}],L=Fe(d,z=>Object.entries(z).map(([U,ne])=>({prefix:`#${ne.id}`,prefixType:"text",value:U,label:es(ne.title.replace(/^[^|]+/,""))})));re(t,L,z=>i(4,c=z));const I=O();async function O(){let z=[];return await fetch(`${H}similarity-score-range`).then(U=>U.json()).then(U=>(z=[U.min,U.max],z.every(ne=>typeof ne=="number")?i(0,n=s&&z[0]<=s&&z[1]>=s?s:z[0]):(console.error(`fetchSimilarityScoreRange: expected '[number, number]', got '${z}'. Defaulting to '[]'`),z=[]),z)).catch(U=>(console.error("Error on fetchSimilarityScoreRange:",U),errorMsg.set(U.message),z))}const q=z=>m.set(z.detail),R=z=>h.set(z.detail),D=z=>g.set(z.detail),$=z=>v.set(z.detail),W=z=>{const U=z.detail,ne={[T]:{}};Object.keys(r).forEach(ae=>{U.includes(ae)&&(ne[T][ae]=r[ae])}),f.set(ne)};return t.$$.update=()=>{t.$$.dirty&8388608&&i(0,n=s||void 0)},[n,o,l,a,c,u,f,d,h,m,g,v,y,T,F,B,L,I,q,R,D,$,W,s]}class Ju extends ue{constructor(e){super(),ce(this,e,Yu,Wu,le,{})}}function Xu(t){let e=Object.keys(t[0]).length,i,n,r,s,o,l=e&&Ar();const a=[ef,Zu,Qu],c=[];function u(f,d){return f[1]?0:f[2]?1:2}return n=u(t),r=c[n]=a[n](t),{c(){l&&l.c(),i=x(),r.c(),s=he()},m(f,d){l&&l.m(f,d),C(f,i,d),c[n].m(f,d),C(f,s,d),o=!0},p(f,d){d&1&&(e=Object.keys(f[0]).length),e?l?d&1&&P(l,1):(l=Ar(),l.c(),P(l,1),l.m(i.parentNode,i)):l&&(ve(),M(l,1,1,()=>{l=null}),be());let h=n;n=u(f),n===h?c[n].p(f,d):(ve(),M(c[h],1,1,()=>{c[h]=null}),be(),r=c[n],r?r.p(f,d):(r=c[n]=a[n](f),r.c()),P(r,1),r.m(s.parentNode,s))},i(f){o||(P(l),P(r),o=!0)},o(f){M(l),M(r),o=!1},d(f){l&&l.d(f),f&&k(i),c[n].d(f),f&&k(s)}}}function Ar(t){let e,i;return e=new Ju({}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Qu(t){let e,i;return e=new ua({}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p:N,i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Zu(t){let e,i;return e=new gi({props:{$$slots:{default:[rf]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,r){const s={};r&36&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function ef(t){let e,i;return e=new gi({props:{$$slots:{default:[sf]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,r){const s={};r&32&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function tf(t){let e,i;return{c(){e=Y("Erreur lors de la récupération des similarités : "),i=Y(t[2])},m(n,r){C(n,e,r),C(n,i,r)},p(n,r){r&4&&de(i,n[2])},d(n){n&&k(e),n&&k(i)}}}function nf(t){let e,i;return{c(){e=Y("Error when retrieving similarities: "),i=Y(t[2])},m(n,r){C(n,e,r),C(n,i,r)},p(n,r){r&4&&de(i,n[2])},d(n){n&&k(e),n&&k(i)}}}function rf(t){let e;function i(s,o){return j==="en"?nf:tf}let r=i()(t);return{c(){e=w("tr"),r.c(),p(e,"class","faded is-center")},m(s,o){C(s,e,o),r.m(e,null)},p(s,o){r.p(s,o)},d(s){s&&k(e),r.d()}}}function sf(t){let e;return{c(){e=w("tr"),e.textContent=`${j==="en"?"Retrieving similarities...":"Récupération des similarités..."}`,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,d(i){i&&k(e)}}}function of(t){let e=Ot.includes("similarity"),i,n,r=e&&Xu(t);return{c(){r&&r.c(),i=he()},m(s,o){r&&r.m(s,o),C(s,i,o),n=!0},p(s,[o]){e&&r.p(s,o)},i(s){n||(P(r),n=!0)},o(s){M(r),n=!1},d(s){r&&r.d(s),s&&k(i)}}}function lf(t,e,i){let n,r,s;re(t,Tt,a=>i(1,r=a)),re(t,Qr,a=>i(2,s=a));const{fetchSimilarity:o,comparedRegions:l}=Ve;return re(t,l,a=>i(0,n=a)),Mt(()=>{Ot.includes("similarity")&&o()}),[n,r,s,l]}class af extends ue{constructor(e){super(),ce(this,e,lf,of,le,{})}}function Or(t,e,i){const n=t.slice();return n[10]=e[i][0],n[11]=e[i][1],n}function Tr(t,e,i){const n=t.slice();return n[14]=e[i],n}function cf(t){let e,i=j==="en"?`Error when retrieving paginated regions: ${t[17]}`:`Erreur de récupération des pages : ${t[17]}`,n;return{c(){e=w("tr"),n=Y(i),p(e,"class","faded is-center")},m(r,s){C(r,e,s),b(e,n)},p(r,s){s&1&&i!==(i=j==="en"?`Error when retrieving paginated regions: ${r[17]}`:`Erreur de récupération des pages : ${r[17]}`)&&de(n,i)},i:N,o:N,d(r){r&&k(e)}}}function uf(t){let e,i,n,r,s;const o=[df,ff],l=[];function a(c,u){return u&2&&(e=null),e==null&&(e=Object.values(c[1]).length>0),e?0:1}return i=a(t,-1),n=l[i]=o[i](t),{c(){n.c(),r=he()},m(c,u){l[i].m(c,u),C(c,r,u),s=!0},p(c,u){let f=i;i=a(c,u),i===f?l[i].p(c,u):(ve(),M(l[f],1,1,()=>{l[f]=null}),be(),n=l[i],n?n.p(c,u):(n=l[i]=o[i](c),n.c()),P(n,1),n.m(r.parentNode,r))},i(c){s||(P(n),s=!0)},o(c){M(n),s=!1},d(c){l[i].d(c),c&&k(r)}}}function ff(t){let e,i,n;return i=new os({}),{c(){e=w("tr"),Z(i.$$.fragment)},m(r,s){C(r,e,s),X(i,e,null),n=!0},p:N,i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){M(i.$$.fragment,r),n=!1},d(r){r&&k(e),Q(i)}}}function df(t){let e,i,n=Object.entries(t[1]),r=[];for(let o=0;o<n.length;o+=1)r[o]=Lr(Or(t,n,o));const s=o=>M(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=he()},m(o,l){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(o,l);C(o,e,l),i=!0},p(o,l){if(l&98){n=Object.entries(o[1]);let a;for(a=0;a<n.length;a+=1){const c=Or(o,n,a);r[a]?(r[a].p(c,l),P(r[a],1)):(r[a]=Lr(c),r[a].c(),P(r[a],1),r[a].m(e.parentNode,e))}for(ve(),a=n.length;a<r.length;a+=1)s(a);be()}},i(o){if(!i){for(let l=0;l<n.length;l+=1)P(r[l]);i=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)M(r[l]);i=!1},d(o){mi(r,o),o&&k(e)}}}function hf(t){let e,i,n,r,s,o,l,a,c=t[10]+"",u,f,d;return{c(){e=w("img"),r=x(),s=w("div"),o=w("a"),l=w("i"),a=Y(`
                                Page `),u=Y(c),d=x(),it(e.src,i=at(t[5](t[10]),"full","250,"))||p(e,"src",i),p(e,"alt",n="Canvas "+t[10]),p(e,"class","mb-3 card"),p(l,"class","fa-solid fa-pen-to-square"),p(o,"class","tag px-2 py-1 is-rounded is-hoverable"),p(o,"href",f=ui(t[6],t[10])),p(o,"target","_blank"),p(s,"class","is-center mb-1")},m(h,m){C(h,e,m),C(h,r,m),C(h,s,m),b(s,o),b(o,l),b(o,a),b(o,u),C(h,d,m)},p(h,m){m&2&&!it(e.src,i=at(h[5](h[10]),"full","250,"))&&p(e,"src",i),m&2&&n!==(n="Canvas "+h[10])&&p(e,"alt",n),m&2&&c!==(c=h[10]+"")&&de(u,c),m&2&&f!==(f=ui(h[6],h[10]))&&p(o,"href",f)},d(h){h&&k(e),h&&k(r),h&&k(s),h&&k(d)}}}function Pr(t,e){let i,n,r;return n=new ln({props:{item:e[14],isSquare:!0}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(s,o){C(s,i,o),X(n,s,o),r=!0},p(s,o){e=s;const l={};o&2&&(l.item=e[14]),n.$set(l)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){M(n.$$.fragment,s),r=!1},d(s){s&&k(i),Q(n,s)}}}function pf(t){let e=[],i=new Map,n,r,s=Object.values(t[11]);const o=l=>l[14].id;for(let l=0;l<s.length;l+=1){let a=Tr(t,s,l),c=o(a);i.set(c,e[l]=Pr(c,a))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();n=x()},m(l,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(l,a);C(l,n,a),r=!0},p(l,a){a&2&&(s=Object.values(l[11]),ve(),e=Yt(e,a,o,1,l,s,i,n.parentNode,Wt,Pr,n,Tr),be())},i(l){if(!r){for(let a=0;a<s.length;a+=1)P(e[a]);r=!0}},o(l){for(let a=0;a<e.length;a+=1)M(e[a]);r=!1},d(l){for(let a=0;a<e.length;a+=1)e[a].d(l);l&&k(n)}}}function Lr(t){let e,i;return e=new bs({props:{$$slots:{"row-body":[pf],"row-header":[hf]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p(n,r){const s={};r&262146&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function mf(t){let e;return{c(){e=w("tr"),e.textContent=`${j==="en"?"Retrieving paginated regions...":"Récupération des pages..."}`,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,i:N,o:N,d(i){i&&k(e)}}}function gf(t){let e,i,n,r={ctx:t,current:null,token:null,hasCatch:!0,pending:mf,then:uf,catch:cf,value:9,error:17,blocks:[,,,]};return nt(i=t[0],r),{c(){e=he(),r.block.c()},m(s,o){C(s,e,o),r.block.m(s,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(s,o){t=s,r.ctx=t,o&1&&i!==(i=t[0])&&nt(i,r)||Dt(r,t,o)},i(s){n||(P(r.block),n=!0)},o(s){for(let o=0;o<3;o+=1){const l=r.blocks[o];M(l)}n=!1},d(s){s&&k(e),r.block.d(s),r.token=null,r=null}}}function _f(t){let e,i,n,r,s,o;return e=new Lt({props:{store:ct,nbOfItems:t[4]}}),n=new gi({props:{$$slots:{default:[gf]},$$scope:{ctx:t}}}),s=new Lt({props:{store:ct,nbOfItems:t[4]}}),{c(){Z(e.$$.fragment),i=x(),Z(n.$$.fragment),r=x(),Z(s.$$.fragment)},m(l,a){X(e,l,a),C(l,i,a),X(n,l,a),C(l,r,a),X(s,l,a),o=!0},p(l,[a]){const c={};a&262147&&(c.$$scope={dirty:a,ctx:l}),n.$set(c)},i(l){o||(P(e.$$.fragment,l),P(n.$$.fragment,l),P(s.$$.fragment,l),o=!0)},o(l){M(e.$$.fragment,l),M(n.$$.fragment,l),M(s.$$.fragment,l),o=!1},d(l){Q(e,l),l&&k(i),Q(n,l),l&&k(r),Q(s,l)}}}function vf(t,e,i){let n,r;const{pageRegions:s,fetchPages:o}=ct;re(t,s,d=>i(1,r=d)),re(t,o,d=>i(0,n=d));const l=Ce("nbOfPages"),a=Ce("trailingZeros"),c=(d,h)=>d.toString().padStart(h,"0");function u(d){return`${imgPrefix}_${c(d,a)}`}const f=Ce("manifest");return[n,r,s,o,l,u,f]}class bf extends ue{constructor(e){super(),ce(this,e,vf,_f,le,{})}}function yf(){const t=`${window.location.origin}${window.location.pathname}`,e=49,i=we(1),n=we([]),r=we([]),s=(async()=>{const u=await fetch(`${t}vectorized-images`).then(f=>f.json()).then(f=>(n.set(f),f)).catch(f=>console.error("Error:",f));return c(o()),u})(),o=()=>nn(i,"vp"),l=Fe(i,u=>(async()=>a(u))());function a(u){const f=(u-1)*e,d=f+e,h=Xi(n).slice(f,d);return r.set(h),h}function c(u){rn(u,i,"vp")}return{currentPage:i,pageLength:e,vectImgs:n,fetchVectorization:s,setPageVectImgs:l,pageVectImgs:r,handlePageUpdate:c}}const pi=yf();function Rr(t){let e,i;return{c(){e=new mo(!1),i=he(),e.a=i},m(n,r){e.m(t[2],n,r),C(n,i,r)},p(n,r){r&4&&e.p(n[2])},d(n){n&&k(i),n&&e.d()}}}function wf(t){let e,i,n,r,s,o,l,a,c,u,f=!t[1]&&t[2]&&Rr(t);return{c(){e=w("div"),i=w("figure"),n=w("div"),f&&f.c(),r=x(),s=w("img"),p(n,"class","svg-container svelte-1egync3"),it(s.src,o=t[4])||p(s,"src",o),p(s,"alt","Extracted region"),p(s,"class","svelte-1egync3"),p(i,"class","image card region-image svelte-1egync3"),kt(i,"width",t[0]+"px"),kt(i,"aspect-ratio",t[3]?t[3].split(" ")[2]/t[3].split(" ")[3]:1),p(e,"class","svg-regions is-center svelte-1egync3")},m(d,h){C(d,e,h),b(e,i),b(i,n),f&&f.m(n,null),b(i,r),b(i,s),a=!0,c||(u=[oe(e,"mouseenter",t[6]),oe(e,"mouseleave",t[7])],c=!0)},p(d,[h]){!d[1]&&d[2]?f?f.p(d,h):(f=Rr(d),f.c(),f.m(n,null)):f&&(f.d(1),f=null),(!a||h&1)&&kt(i,"width",d[0]+"px"),(!a||h&8)&&kt(i,"aspect-ratio",d[3]?d[3].split(" ")[2]/d[3].split(" ")[3]:1)},i(d){a||(Ge(()=>{a&&(l||(l=Ue(e,Xe,{duration:500},!0)),l.run(1))}),a=!0)},o(d){l||(l=Ue(e,Xe,{duration:500},!1)),l.run(0),a=!1},d(d){d&&k(e),f&&f.d(),d&&l&&l.end(),c=!1,Ie(u)}}}function Sf(t,e,i){let{svgPath:n}=e,{width:r=200}=e;const[s,o,l,a]=n.replace(".svg","").split("_"),c=at(`${s}_${o}_${l}`,a,`${r},`);let u=!1,f="",d="";Mt(async()=>{const v=await(await fetch(`${Po}svg/${n}`)).text(),E=new DOMParser().parseFromString(v,"image/svg+xml"),T=E.querySelector("svg");i(3,d=T.getAttribute("viewBox")||`0 0 ${T.getAttribute("width")} ${T.getAttribute("height")}`),E.querySelectorAll("image").forEach(H=>H.remove()),T.setAttribute("viewBox",d),T.removeAttribute("width"),T.removeAttribute("height"),i(2,f=new XMLSerializer().serializeToString(E.documentElement))});const h=()=>i(1,u=!0),m=()=>i(1,u=!1);return t.$$set=g=>{"svgPath"in g&&i(5,n=g.svgPath),"width"in g&&i(0,r=g.width)},[r,u,f,d,c,n,h,m]}class Ef extends ue{constructor(e){super(),ce(this,e,Sf,wf,le,{svgPath:5,width:0})}}function kf(t){let e,i,n,r,s=j==="en"?"Download All":"Tout Télécharger",o,l,a;return{c(){e=w("div"),i=w("button"),n=w("i"),r=x(),o=Y(s),p(n,"class","fa-solid fa-download"),p(i,"class","button is-link is-light"),p(e,"class","is-right mb-3")},m(c,u){C(c,e,u),b(e,i),b(i,n),b(i,r),b(i,o),l||(a=oe(i,"click",t[0]),l=!0)},p:N,i:N,o:N,d(c){c&&k(e),l=!1,a()}}}function Cf(t){const e=`${window.location.origin}${window.location.pathname}`,i=parseInt(e.split("witness/")[1].replace("/","")),n=parseInt(e.split("regions/")[1].replace("/",""));async function r(){if(!n&&!i){console.error("No Region or Witness");return}const s=n?`${window.location.origin}/${De}/export-regions-imgs-and-svgs/${n}`:`${window.location.origin}/${De}/export-all-imgs-and-svgs/${i}`;try{const o=await Pt(()=>fetch(s,{method:"GET",headers:{"X-CSRFToken":He,"Content-Type":"application/json"}}));if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const l=await o.blob();is(l,"vectorizations.zip")}catch(o){console.error("Erreur lors du téléchargement des vectorisations:",o)}}return[r]}class If extends ue{constructor(e){super(),ce(this,e,Cf,kf,le,{})}}function Mr(t,e,i){const n=t.slice();return n[8]=e[i],n}function Af(t){let e;function i(s,o){return j==="en"?Tf:Of}let r=i()(t);return{c(){e=w("div"),r.c(),p(e,"class","faded is-center")},m(s,o){C(s,e,o),r.m(e,null)},p(s,o){r.p(s,o)},i:N,o:N,d(s){s&&k(e),r.d()}}}function Of(t){let e,i=t[11]+"",n;return{c(){e=Y("Erreur lors de la récupération des régions vectorisées : "),n=Y(i)},m(r,s){C(r,e,s),C(r,n,s)},p(r,s){s&2&&i!==(i=r[11]+"")&&de(n,i)},d(r){r&&k(e),r&&k(n)}}}function Tf(t){let e,i=t[11]+"",n;return{c(){e=Y("Error when retrieving vectorized regions: "),n=Y(i)},m(r,s){C(r,e,s),C(r,n,s)},p(r,s){s&2&&i!==(i=r[11]+"")&&de(n,i)},d(r){r&&k(e),r&&k(n)}}}function Pf(t){let e=[],i=new Map,n,r,s=t[2];const o=a=>a[8].id;for(let a=0;a<s.length;a+=1){let c=Mr(t,s,a),u=o(c);i.set(u,e[a]=Nr(u,c))}let l=null;return s.length||(l=Dr()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),l&&l.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);C(a,n,c),l&&l.m(a,c),r=!0},p(a,c){c&4&&(s=a[2],ve(),e=Yt(e,c,o,1,a,s,i,n.parentNode,Wt,Nr,n,Mr),be(),!s.length&&l?l.p(a,c):s.length?l&&(l.d(1),l=null):(l=Dr(),l.c(),l.m(n.parentNode,n)))},i(a){if(!r){for(let c=0;c<s.length;c+=1)P(e[c]);r=!0}},o(a){for(let c=0;c<e.length;c+=1)M(e[c]);r=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),l&&l.d(a)}}}function Dr(t){let e,i;return{c(){e=w("div"),e.textContent=`${j==="en"?"No vectorization":"Pas de vectorisation"}`,i=x(),p(e,"class","faded is-center")},m(n,r){C(n,e,r),C(n,i,r)},p:N,d(n){n&&k(e),n&&k(i)}}}function Nr(t,e){let i,n,r;return n=new Ef({props:{svgPath:e[8]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(s,o){C(s,i,o),X(n,s,o),r=!0},p(s,o){e=s;const l={};o&4&&(l.svgPath=e[8]),n.$set(l)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){M(n.$$.fragment,s),r=!1},d(s){s&&k(i),Q(n,s)}}}function Lf(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"?"Retrieving vectorization page...":"Récupération la page de vectorisation..."}`,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,i:N,o:N,d(i){i&&k(e)}}}function Rf(t){let e,i,n,r,s,o,l,a,c;e=new If({}),n=new Lt({props:{store:pi,nbOfItems:t[0].length,pageLength:t[6]}});let u={ctx:t,current:null,token:null,hasCatch:!0,pending:Lf,then:Pf,catch:Af,value:7,error:11,blocks:[,,,]};return nt(o=t[1],u),a=new Lt({props:{store:pi,nbOfItems:t[0].length,pageLength:t[6]}}),{c(){Z(e.$$.fragment),i=x(),Z(n.$$.fragment),r=x(),s=w("div"),u.block.c(),l=x(),Z(a.$$.fragment),p(s,"class","grid is-gap-2 mx-5 svelte-1mje9rl")},m(f,d){X(e,f,d),C(f,i,d),X(n,f,d),C(f,r,d),C(f,s,d),u.block.m(s,u.anchor=null),u.mount=()=>s,u.anchor=null,C(f,l,d),X(a,f,d),c=!0},p(f,[d]){t=f;const h={};d&1&&(h.nbOfItems=t[0].length),n.$set(h),u.ctx=t,d&2&&o!==(o=t[1])&&nt(o,u)||Dt(u,t,d);const m={};d&1&&(m.nbOfItems=t[0].length),a.$set(m)},i(f){c||(P(e.$$.fragment,f),P(n.$$.fragment,f),P(u.block),P(a.$$.fragment,f),c=!0)},o(f){M(e.$$.fragment,f),M(n.$$.fragment,f);for(let d=0;d<3;d+=1){const h=u.blocks[d];M(h)}M(a.$$.fragment,f),c=!1},d(f){Q(e,f),f&&k(i),Q(n,f),f&&k(r),f&&k(s),u.block.d(),u.token=null,u=null,f&&k(l),Q(a,f)}}}function Mf(t,e,i){let n,r,s;const{vectImgs:o,pageVectImgs:l,setPageVectImgs:a,pageLength:c}=pi;return re(t,o,u=>i(0,n=u)),re(t,l,u=>i(2,s=u)),re(t,a,u=>i(1,r=u)),[n,r,s,o,l,a,c]}class Df extends ue{constructor(e){super(),ce(this,e,Mf,Rf,le,{})}}function Nf(t){let e,i,n={ctx:t,current:null,token:null,hasCatch:!0,pending:xf,then:Vf,catch:$f,value:1,error:2,blocks:[,,,]};return nt(t[0],n),{c(){e=he(),n.block.c()},m(r,s){C(r,e,s),n.block.m(r,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e,i=!0},p(r,s){t=r,Dt(n,t,s)},i(r){i||(P(n.block),i=!0)},o(r){for(let s=0;s<3;s+=1){const o=n.blocks[s];M(o)}i=!1},d(r){r&&k(e),n.block.d(r),n.token=null,n=null}}}function $f(t){let e;function i(s,o){return j==="en"?Ff:jf}let r=i()(t);return{c(){e=w("div"),r.c(),p(e,"class","container faded is-center")},m(s,o){C(s,e,o),r.m(e,null)},p(s,o){r.p(s,o)},i:N,o:N,d(s){s&&k(e),r.d()}}}function jf(t){let e,i=t[2]+"",n;return{c(){e=Y("Erreur lors de la récupération des régions vectorisées : "),n=Y(i)},m(r,s){C(r,e,s),C(r,n,s)},p:N,d(r){r&&k(e),r&&k(n)}}}function Ff(t){let e,i=t[2]+"",n;return{c(){e=Y("Error when retrieving vectorized regions: "),n=Y(i)},m(r,s){C(r,e,s),C(r,n,s)},p:N,d(r){r&&k(e),r&&k(n)}}}function Vf(t){let e,i;return e=new Df({}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p:N,i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function xf(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"?"Retrieving vectorized regions...":"Récupération des régions vectorisées..."}`,p(e,"class","container faded is-center")},m(i,n){C(i,e,n)},p:N,i:N,o:N,d(i){i&&k(e)}}}function Uf(t){let e=Ot.includes("vectorization"),i,n,r=e&&Nf(t);return{c(){r&&r.c(),i=he()},m(s,o){r&&r.m(s,o),C(s,i,o),n=!0},p(s,[o]){e&&r.p(s,o)},i(s){n||(P(r),n=!0)},o(s){M(r),n=!1},d(s){r&&r.d(s),s&&k(i)}}}function Hf(t){const{fetchVectorization:e}=pi;return[e]}class Bf extends ue{constructor(e){super(),ce(this,e,Hf,Uf,le,{})}}function zf(t){let e,i,n,r,s=j==="en"?"Save selection":"Sauvegarder la sélection",o,l,a;return{c(){e=w("button"),i=w("span"),n=w("i"),r=x(),o=Y(s),p(n,"class","fa-solid fa-floppy-disk"),p(e,"class","button is-link")},m(c,u){C(c,e,u),b(e,i),b(i,n),b(i,r),b(i,o),l||(a=oe(e,"click",t[7]),l=!0)},p:N,d(c){c&&k(e),l=!1,a()}}}function qf(t){let e,i,n,r,s=j==="en"?"Go to treatment":"Accéder au traitement",o,l;return{c(){var a;e=w("a"),i=w("span"),n=w("i"),r=x(),o=Y(s),p(n,"class","fa-solid fa-gear"),p(e,"class","button is-link"),p(e,"href",l="/"+De+"/treatment/add/?document_set="+((a=t[3])==null?void 0:a.id))},m(a,c){C(a,e,c),b(e,i),b(i,n),b(i,r),b(i,o)},p(a,c){var u;c&8&&l!==(l="/"+De+"/treatment/add/?document_set="+((u=a[3])==null?void 0:u.id))&&p(e,"href",l)},d(a){a&&k(e)}}}function $r(t){let e,i,n,r,s,o,l;return{c(){var a,c;e=w("a"),i=w("span"),i.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',r=x(),s=w("a"),o=w("span"),o.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',p(e,"class","button is-link is-dark"),p(e,"href",n="/"+De+"/document-set/"+((a=t[3])==null?void 0:a.id)+"/json"),p(e,"target","_blank"),p(s,"class","button is-link is-dark"),p(s,"href",l="/"+De+"/document-set/"+((c=t[3])==null?void 0:c.id)+"/zip"),p(s,"target","_blank")},m(a,c){C(a,e,c),b(e,i),C(a,r,c),C(a,s,c),b(s,o)},p(a,c){var u,f;c&8&&n!==(n="/"+De+"/document-set/"+((u=a[3])==null?void 0:u.id)+"/json")&&p(e,"href",n),c&8&&l!==(l="/"+De+"/document-set/"+((f=a[3])==null?void 0:f.id)+"/zip")&&p(s,"href",l)},d(a){a&&k(e),a&&k(r),a&&k(s)}}}function Kf(t){let e,i,n,r,s,o,l;function a(d,h){return d[2]&&!d[1]?qf:zf}let c=a(t),u=c(t),f=!t[1]&&$r(t);return{c(){e=w("footer"),i=w("div"),n=w("button"),n.textContent=`${j==="en"?"Clear selection":"Vider la sélection"}`,r=x(),u.c(),s=x(),f&&f.c(),p(n,"class","button button-close is-link is-light"),p(i,"class","buttons"),p(e,"class","modal-card-foot is-center")},m(d,h){C(d,e,h),b(e,i),b(i,n),b(i,r),u.m(i,null),b(i,s),f&&f.m(i,null),o||(l=oe(n,"click",t[6]),o=!0)},p(d,[h]){c===(c=a(d))&&u?u.p(d,h):(u.d(1),u=c(d),u&&(u.c(),u.m(i,s))),d[1]?f&&(f.d(1),f=null):f?f.p(d,h):(f=$r(d),f.c(),f.m(i,null))},i:N,o:N,d(d){d&&k(e),u.d(),f&&f.d(),o=!1,l()}}}function Gf(t,e,i){let n,r,{selectionStore:s}=e;const{isSaved:o,selection:l}=s;re(t,o,f=>i(2,n=f)),re(t,l,f=>i(3,r=f));let{isRegion:a=s.type!=="documentSet"}=e;const c=()=>s.empty(),u=()=>s.save();return t.$$set=f=>{"selectionStore"in f&&i(0,s=f.selectionStore),"isRegion"in f&&i(1,a=f.isRegion)},[s,a,n,r,o,l,c,u]}class Wf extends ue{constructor(e){super(),ce(this,e,Gf,Kf,le,{selectionStore:0,isRegion:1})}}function Yf(t){let e,i,n,r,s,o;return{c(){e=w("span"),i=Y(t[5]),n=x(),r=w("span"),r.innerHTML='<i class="fas fa-edit"></i>',p(r,"class","pl-3 smaller has-text-link")},m(l,a){C(l,e,a),b(e,i),b(e,n),b(e,r),s||(o=[oe(e,"click",t[7]),oe(e,"keyup",null)],s=!0)},p(l,a){a&32&&de(i,l[5])},d(l){l&&k(e),s=!1,Ie(o)}}}function Jf(t){let e,i,n;return{c(){e=w("input"),p(e,"class","input selection-title svelte-sgypdx")},m(r,s){C(r,e,s),t[12](e),li(e,t[4]),i||(n=[oe(e,"input",t[13]),oe(e,"keydown",t[8]),oe(e,"blur",t[9])],i=!0)},p(r,s){s&16&&e.value!==r[4]&&li(e,r[4])},d(r){r&&k(e),t[12](null),i=!1,Ie(n)}}}function Xf(t){let e,i,n,r,s,o,l,a,c,u,f,d,h,m,g,v,y,E,T,H;function F(q,R){return q[2]?Jf:Yf}let B=F(t),L=B(t);const I=t[11].default,O=ut(I,t,t[10],null);return y=new Wf({props:{selectionStore:t[0]}}),{c(){e=w("div"),i=w("div"),n=x(),r=w("div"),s=w("div"),o=w("div"),l=w("i"),a=x(),L.c(),c=Y(`
                (`),u=Y(t[1]),f=Y(")"),d=x(),h=w("button"),m=x(),g=w("section"),O&&O.c(),v=x(),Z(y.$$.fragment),p(i,"class","modal-background"),p(l,"class","fa-solid fa-book-bookmark"),p(o,"class","title is-4 mb-0 media-content"),p(h,"class","delete media-left"),p(h,"aria-label","close"),p(s,"class","modal-card-head media mb-0 is-middle"),p(g,"class","modal-card-body"),p(r,"class","modal-content"),p(e,"id","selection-modal"),p(e,"class","modal fade"),p(e,"tabindex","-1"),p(e,"aria-labelledby","selection-modal-label"),p(e,"aria-hidden","true")},m(q,R){C(q,e,R),b(e,i),b(e,n),b(e,r),b(r,s),b(s,o),b(o,l),b(o,a),L.m(o,null),b(o,c),b(o,u),b(o,f),b(s,d),b(s,h),b(r,m),b(r,g),O&&O.m(g,null),b(r,v),X(y,r,null),E=!0,T||(H=oi(rs.call(null,e)),T=!0)},p(q,[R]){B===(B=F(q))&&L?L.p(q,R):(L.d(1),L=B(q),L&&(L.c(),L.m(o,c))),(!E||R&2)&&de(u,q[1]),O&&O.p&&(!E||R&1024)&&dt(O,I,q,q[10],E?ft(I,q[10],R,null):ht(q[10]),null);const D={};R&1&&(D.selectionStore=q[0]),y.$set(D)},i(q){E||(P(O,q),P(y.$$.fragment,q),E=!0)},o(q){M(O,q),M(y.$$.fragment,q),E=!1},d(q){q&&k(e),L.d(),O&&O.d(q),Q(y),T=!1,H()}}}function Qf(t,e,i){let n,{$$slots:r={},$$scope:s}=e,{selectionStore:o}=e;const{selectionTitle:l,updateTitle:a,save:c}=o;re(t,l,T=>i(5,n=T));let{selectionLength:u=!1}=e,f=!1,d,h;function m(){i(2,f=!0),i(4,h=n),setTimeout(()=>d&&d.focus(),0)}function g(T){T.key==="Enter"&&v()}function v(){i(2,f=!1),a(h),c()}function y(T){Fi[T?"unshift":"push"](()=>{d=T,i(3,d)})}function E(){h=this.value,i(4,h)}return t.$$set=T=>{"selectionStore"in T&&i(0,o=T.selectionStore),"selectionLength"in T&&i(1,u=T.selectionLength),"$$scope"in T&&i(10,s=T.$$scope)},[o,u,f,d,h,n,l,m,g,v,s,r,y,E]}class Zf extends ue{constructor(e){super(),ce(this,e,Qf,Xf,le,{selectionStore:0,selectionLength:1})}}function ed(t){let e,i,n,r,s,o=j==="en"?"Selection":"Sélection",l,a,c,u,f,d;return{c(){e=w("div"),i=w("button"),n=w("span"),r=w("i"),s=x(),l=Y(o),a=Y(`
            (`),c=Y(t[0]),u=Y(")"),p(r,"class","fa-solid fa-book-bookmark"),p(n,"id","btn-content"),p(i,"id","set-btn"),p(i,"class","button px-5 py-4 is-link svelte-gmt9z5"),p(i,"data-target","selection-modal"),p(e,"class","set-container svelte-gmt9z5")},m(h,m){C(h,e,m),b(e,i),b(i,n),b(n,r),b(n,s),b(n,l),b(n,a),b(n,c),b(n,u),f||(d=oi(ss.call(null,i)),f=!0)},p(h,[m]){m&1&&de(c,h[0])},i:N,o:N,d(h){h&&k(e),f=!1,d()}}}function td(t,e,i){let{selectionLength:n=0}=e,r=n;return t.$$set=s=>{"selectionLength"in s&&i(0,n=s.selectionLength)},t.$$.update=()=>{if(t.$$.dirty&3&&n!==r){const s=n>r;i(1,r=n);const o=document.getElementById("btn-content");o&&o.animate([{transform:s?"translateY(-7px)":"translateX(-5px)"},{transform:s?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[n,r]}class id extends ue{constructor(e){super(),ce(this,e,td,ed,le,{selectionLength:0})}}function jr(t,e,i){const n=t.slice();return n[7]=e[i][0],n[8]=e[i][1],n}function nd(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"?"No regions in selection":"Aucune région sélectionnée"}`},m(i,n){C(i,e,n)},p:N,d(i){i&&k(e)}}}function rd(t){let e,i,n=Object.entries(t[2]),r=[];for(let s=0;s<n.length;s+=1)r[s]=Fr(jr(t,n,s));return{c(){e=w("div"),i=w("div");for(let s=0;s<r.length;s+=1)r[s].c();p(i,"class","grid is-gap-2"),p(e,"class","fixed-grid has-6-cols")},m(s,o){C(s,e,o),b(e,i);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(i,null)},p(s,o){if(o&13){n=Object.entries(s[2]);let l;for(l=0;l<n.length;l+=1){const a=jr(s,n,l);r[l]?r[l].p(a,o):(r[l]=Fr(a),r[l].c(),r[l].m(i,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(s){s&&k(e),mi(r,s)}}}function Fr(t){let e,i,n,r,s,o,l,a=t[8].title+"",c,u,f,d,h,m;function g(){return t[6](t[7])}return{c(){e=w("div"),i=w("figure"),n=w("img"),s=x(),o=w("div"),l=w("span"),c=Y(a),u=x(),f=w("button"),d=x(),it(n.src,r=at(t[8].img,t[8].xywh,"96,"))||p(n,"src",r),p(n,"alt","Extracted region"),p(l,"class","overlay-desc"),p(o,"class","overlay is-center svelte-g8ij5d"),p(i,"class","image is-64x64 card"),p(f,"class","delete region-btn svelte-g8ij5d"),p(f,"aria-label","remove from selection"),p(e,"class","selection cell svelte-g8ij5d")},m(v,y){C(v,e,y),b(e,i),b(i,n),b(i,s),b(i,o),b(o,l),b(l,c),b(e,u),b(e,f),b(e,d),h||(m=oe(f,"click",g),h=!0)},p(v,y){t=v,y&4&&!it(n.src,r=at(t[8].img,t[8].xywh,"96,"))&&p(n,"src",r),y&4&&a!==(a=t[8].title+"")&&de(c,a)},d(v){v&&k(e),h=!1,m()}}}function sd(t){let e;function i(s,o){return s[4]?rd:nd}let n=i(t),r=n(t);return{c(){r.c(),e=he()},m(s,o){r.m(s,o),C(s,e,o)},p(s,o){n===(n=i(s))&&r?r.p(s,o):(r.d(1),r=n(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&k(e)}}}function od(t){let e,i,n,r;return e=new id({props:{selectionLength:t[1]}}),n=new Zf({props:{selectionLength:t[1],selectionStore:t[0],$$slots:{default:[sd]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment),i=x(),Z(n.$$.fragment)},m(s,o){X(e,s,o),C(s,i,o),X(n,s,o),r=!0},p(s,[o]){const l={};o&2&&(l.selectionLength=s[1]),e.$set(l);const a={};o&2&&(a.selectionLength=s[1]),o&1&&(a.selectionStore=s[0]),o&2077&&(a.$$scope={dirty:o,ctx:s}),n.$set(a)},i(s){r||(P(e.$$.fragment,s),P(n.$$.fragment,s),r=!0)},o(s){M(e.$$.fragment,s),M(n.$$.fragment,s),r=!1},d(s){Q(e,s),s&&k(i),Q(n,s)}}}function ld(t,e,i){let n,r,s,o,{selectionStore:l}=e;const{selected:a}=l;re(t,a,u=>i(3,o=u));const c=u=>l.remove(u,Object.keys(o)[0]);return t.$$set=u=>{"selectionStore"in u&&i(0,l=u.selectionStore)},t.$$.update=()=>{t.$$.dirty&8&&i(2,n=Object.values(o)[0]||{}),t.$$.dirty&4&&i(1,r=Object.keys(n).length),t.$$.dirty&2&&i(4,s=r>0)},[l,r,n,o,s,a,c]}class ad extends ue{constructor(e){super(),ce(this,e,ld,od,le,{selectionStore:0})}}function Vr(t,e,i){const n=t.slice();return n[16]=e[i],n}function xr(t,e,i){const n=t.slice();return n[20]=e[i][0],n[21]=e[i][1],n}function Ur(t){let e,i,n,r;return i=new vl({}),{c(){e=w("div"),Z(i.$$.fragment),p(e,"class","cell")},m(s,o){C(s,e,o),X(i,e,null),r=!0},i(s){r||(P(i.$$.fragment,s),Ge(()=>{r&&(n||(n=Ue(e,Xe,{duration:500},!0)),n.run(1))}),r=!0)},o(s){M(i.$$.fragment,s),n||(n=Ue(e,Xe,{duration:500},!1)),n.run(0),r=!1},d(s){s&&k(e),Q(i),s&&n&&n.end()}}}function Hr(t){let e,i,n=t[21].text+"",r,s,o,l;function a(){return t[14](t[20])}return{c(){e=w("li"),i=w("a"),r=Y(n),s=x(),p(i,"href",null),xe(e,"is-active",t[20]===t[1])},m(c,u){C(c,e,u),b(e,i),b(i,r),b(e,s),o||(l=[oe(e,"click",a),oe(e,"keyup",_d)],o=!0)},p(c,u){t=c,u&1&&n!==(n=t[21].text+"")&&de(r,n),u&3&&xe(e,"is-active",t[20]===t[1])},d(c){c&&k(e),o=!1,Ie(l)}}}function cd(t){let e,i;return e=new Bf({}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p:N,i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function ud(t){let e,i;return e=new af({}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p:N,i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function fd(t){let e,i;return e=new bf({}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p:N,i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function dd(t){let e,i,n={ctx:t,current:null,token:null,hasCatch:!0,pending:md,then:pd,catch:hd,value:15,error:19,blocks:[,,,]};return nt(t[4],n),{c(){e=w("div"),n.block.c(),p(e,"class","grid is-gap-2 mt-5")},m(r,s){C(r,e,s),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,i=!0},p(r,s){t=r,Dt(n,t,s)},i(r){i||(P(n.block),i=!0)},o(r){for(let s=0;s<3;s+=1){const o=n.blocks[s];M(o)}i=!1},d(r){r&&k(e),n.block.d(),n.token=null,n=null}}}function hd(t){let e,i,n=t[19]+"",r;return{c(){e=w("div"),i=Y("Error when retrieving regions: "),r=Y(n)},m(s,o){C(s,e,o),b(e,i),b(e,r)},p:N,i:N,o:N,d(s){s&&k(e)}}}function pd(t){let e=[],i=new Map,n,r,s=Object.values(t[2]);const o=a=>a[16].id;for(let a=0;a<s.length;a+=1){let c=Vr(t,s,a),u=o(c);i.set(u,e[a]=zr(u,c))}let l=null;return s.length||(l=Br(t)),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),l&&l.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);C(a,n,c),l&&l.m(a,c),r=!0},p(a,c){c&100&&(s=Object.values(a[2]),ve(),e=Yt(e,c,o,1,a,s,i,n.parentNode,Wt,zr,n,Vr),be(),!s.length&&l?l.p(a,c):s.length?l&&(ve(),M(l,1,1,()=>{l=null}),be()):(l=Br(a),l.c(),P(l,1),l.m(n.parentNode,n)))},i(a){if(!r){for(let c=0;c<s.length;c+=1)P(e[c]);r=!0}},o(a){for(let c=0;c<e.length;c+=1)M(e[c]);r=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),l&&l.d(a)}}}function Br(t){let e,i;return e=new os({props:{currentRegionId:t[6],baseUrl:t[5]}}),{c(){Z(e.$$.fragment)},m(n,r){X(e,n,r),i=!0},p:N,i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){M(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function zr(t,e){let i,n,r;return n=new ln({props:{item:e[16],selectionStore:vt}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(s,o){C(s,i,o),X(n,s,o),r=!0},p(s,o){e=s;const l={};o&4&&(l.item=e[16]),n.$set(l)},i(s){r||(P(n.$$.fragment,s),r=!0)},o(s){M(n.$$.fragment,s),r=!1},d(s){s&&k(i),Q(n,s)}}}function md(t){let e;return{c(){e=w("div"),e.textContent=`${j==="en"?"Retrieving regions...":"Récupération des régions..."}`,p(e,"class","faded is-center")},m(i,n){C(i,e,n)},p:N,i:N,o:N,d(i){i&&k(e)}}}function gd(t){let e,i,n,r,s,o,l,a,c,u,f,d=["all","page"].includes(t[1]),h,m,g,v,y,E,T,H;e=new xo({}),n=new el({}),s=new ad({props:{selectionStore:vt}}),u=new ul({props:{baseUrl:t[5],currentRegionId:t[6],currentLayout:t[1]}});let F=d&&Ur(),B=Object.entries(t[0]),L=[];for(let R=0;R<B.length;R+=1)L[R]=Hr(xr(t,B,R));const I=[dd,fd,ud,cd],O=[];function q(R,D){return R[1]==="all"?0:R[1]==="page"?1:R[1]==="similarity"?2:R[1]==="vectorization"?3:-1}return~(y=q(t))&&(E=O[y]=I[y](t)),{c(){Z(e.$$.fragment),i=x(),Z(n.$$.fragment),r=x(),Z(s.$$.fragment),o=x(),l=w("div"),a=w("div"),c=w("div"),Z(u.$$.fragment),f=x(),F&&F.c(),h=x(),m=w("div"),g=w("ul");for(let R=0;R<L.length;R+=1)L[R].c();v=x(),E&&E.c(),T=he(),p(c,"class","cell is-left is-middle"),p(a,"class","actions grid"),p(g,"class","panel-tabs svelte-saatkj"),p(m,"class","tabs is-centered"),p(l,"id","nav-actions"),p(l,"class","svelte-saatkj")},m(R,D){X(e,R,D),C(R,i,D),X(n,R,D),C(R,r,D),X(s,R,D),C(R,o,D),C(R,l,D),b(l,a),b(a,c),X(u,c,null),b(a,f),F&&F.m(a,null),b(l,h),b(l,m),b(m,g);for(let $=0;$<L.length;$+=1)L[$]&&L[$].m(g,null);C(R,v,D),~y&&O[y].m(R,D),C(R,T,D),H=!0},p(R,[D]){const $={};if(D&2&&($.currentLayout=R[1]),u.$set($),D&2&&(d=["all","page"].includes(R[1])),d?F?D&2&&P(F,1):(F=Ur(),F.c(),P(F,1),F.m(a,null)):F&&(ve(),M(F,1,1,()=>{F=null}),be()),D&131){B=Object.entries(R[0]);let z;for(z=0;z<B.length;z+=1){const U=xr(R,B,z);L[z]?L[z].p(U,D):(L[z]=Hr(U),L[z].c(),L[z].m(g,null))}for(;z<L.length;z+=1)L[z].d(1);L.length=B.length}let W=y;y=q(R),y===W?~y&&O[y].p(R,D):(E&&(ve(),M(O[W],1,1,()=>{O[W]=null}),be()),~y?(E=O[y],E?E.p(R,D):(E=O[y]=I[y](R),E.c()),P(E,1),E.m(T.parentNode,T)):E=null)},i(R){H||(P(e.$$.fragment,R),P(n.$$.fragment,R),P(s.$$.fragment,R),P(u.$$.fragment,R),P(F),P(E),H=!0)},o(R){M(e.$$.fragment,R),M(n.$$.fragment,R),M(s.$$.fragment,R),M(u.$$.fragment,R),M(F),M(E),H=!1},d(R){Q(e,R),R&&k(i),Q(n,R),R&&k(r),Q(s,R),R&&k(o),R&&k(l),Q(u),F&&F.d(),mi(L,R),R&&k(v),~y&&O[y].d(R),R&&k(T)}}}const _d=()=>null;function vd(t,e,i){let n,r;const{allRegions:s,fetchAll:o}=ct;re(t,s,E=>i(2,r=E));let{manifest:l=""}=e,{isValidated:a=!1}=e,{imgPrefix:c=""}=e,{nbOfPages:u=1}=e,{trailingZeros:f=1}=e,{witness:d={}}=e;Ze("witness",d),Ze("nbOfPages",u),Ze("trailingZeros",f),Ze("imgPrefix",c),Ze("manifest",l),Ze("isValidated",a);const h=`${window.location.origin}${window.location.pathname}`,m=parseInt(h.split("regions/")[1].replace("/","")),g={all:{text:j==="en"?"All regions":"Toutes les régions"},page:{text:j==="en"?"Per page":"Par page"}};Ot.includes("similarity")&&(g.similarity={text:j==="en"?"Similarity":"Similarité"}),Ot.includes("vectorization")&&(g.vectorization={text:j==="en"?"Vectorization":"Vectorisation"});function v(E){i(1,n=E);const T=new URL(window.location);T.searchParams.set("tab",E),window.history.pushState({},"",T)}const y=E=>v(E);return t.$$set=E=>{"manifest"in E&&i(8,l=E.manifest),"isValidated"in E&&i(9,a=E.isValidated),"imgPrefix"in E&&i(10,c=E.imgPrefix),"nbOfPages"in E&&i(11,u=E.nbOfPages),"trailingZeros"in E&&i(12,f=E.trailingZeros),"witness"in E&&i(13,d=E.witness)},i(1,n=new URLSearchParams(window.location.search).get("tab")??"all"),[g,n,r,s,o,h,m,v,l,a,c,u,f,d,y]}class bd extends ue{constructor(e){super(),ce(this,e,vd,gd,le,{manifest:8,isValidated:9,imgPrefix:10,nbOfPages:11,trailingZeros:12,witness:13})}}new bd({target:document.getElementById("region-list"),props:{witness,manifest,isValidated,imgPrefix,nbOfPages,trailingZeros}});export{ve as A,be as B,mi as C,Ie as D,en as E,Mt as F,Zi as G,Y as H,yt as I,oo as J,Ke as K,Ze as L,Is as M,Us as N,we as O,Ve as P,Ce as Q,ln as R,ue as S,vi as T,ic as U,na as V,Bo as _,p as a,C as b,Z as c,M as d,w as e,k as f,Q as g,nt as h,ce as i,x as j,it as k,j as l,X as m,b as n,N as o,Sd as p,kt as q,at as r,le as s,P as t,Dt as u,kn as v,xe as w,oe as x,yd as y,wd as z};
//# sourceMappingURL=region-list.js.map
