function t(){}function e(t){return t()}function n(){return Object.create(null)}function l(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let s,r;function c(t,e){return s||(s=document.createElement("a")),s.href=e,t===s.href}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function h(t){return document.createElement(t)}function m(t){return document.createTextNode(t)}function p(){return m(" ")}function g(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function _(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function v(t,e,n,l){null==n?t.style.removeProperty(e):t.style.setProperty(e,n,l?"important":"")}function w(t,e,n){for(let n=0;n<t.options.length;n+=1){const l=t.options[n];if(l.__value===e)return void(l.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function b(t){r=t}function y(t){(function(){if(!r)throw new Error("Function called outside component initialization");return r})().$$.on_mount.push(t)}const E=[],x=[];let A=[];const P=[],k=Promise.resolve();let N=!1;function S(t){A.push(t)}const O=new Set;let U=0;function T(){if(0!==U)return;const t=r;do{try{for(;U<E.length;){const t=E[U];U++,b(t),I(t.$$)}}catch(t){throw E.length=0,U=0,t}for(b(null),E.length=0,U=0;x.length;)x.pop()();for(let t=0;t<A.length;t+=1){const e=A[t];O.has(e)||(O.add(e),e())}A.length=0}while(E.length);for(;P.length;)P.pop()();N=!1,O.clear(),b(t)}function I(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const L=new Set;function M(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];A.forEach((l=>-1===t.indexOf(l)?e.push(l):n.push(l))),n.forEach((t=>t())),A=e}(n.after_update),l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function j(t,e){-1===t.$$.dirty[0]&&(E.push(t),N||(N=!0,k.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function C(i,s,c,u,a,d,h,m=[-1]){const p=r;b(i);const g=i.$$={fragment:null,ctx:[],props:d,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(p?p.$$.context:[])),callbacks:n(),dirty:m,skip_bound:!1,root:s.target||p.$$.root};h&&h(g.root);let _=!1;if(g.ctx=c?c(i,s.props||{},((t,e,...n)=>{const l=n.length?n[0]:e;return g.ctx&&a(g.ctx[t],g.ctx[t]=l)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](l),_&&j(i,t)),e})):[],g.update(),_=!0,l(g.before_update),g.fragment=!!u&&u(g.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);g.fragment&&g.fragment.l(t),t.forEach(f)}else g.fragment&&g.fragment.c();s.intro&&(($=i.$$.fragment)&&$.i&&(L.delete($),$.i(v))),function(t,n,i,s){const{fragment:r,after_update:c}=t.$$;r&&r.m(n,i),s||S((()=>{const n=t.$$.on_mount.map(e).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...n):l(n),t.$$.on_mount=[]})),c.forEach(S)}(i,s.target,s.anchor,s.customElement),T()}var $,v;b(p)}class D{$destroy(){M(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const t=l.indexOf(n);-1!==t&&l.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const R=APP_LANG;APP_NAME,WEBAPP_NAME,USER_ID,IS_SUPERUSER,ADD_PERMISSION,CSRF_TOKEN,ADDITIONAL_MODULES;const B=SAS_APP_URL;function F(t=null,e=1){return`${B??"http://localhost:3000"}/index.html?iiif-content=${t}&canvas=${e}`}function q(t,e,n){const l=t.slice();return l[2]=e[n],l}function z(t){let e,n,o,i,s,r,c,m,$=t[0],v=[];for(let e=0;e<$.length;e+=1)v[e]=G(q(t,$,e));return{c(){e=h("div"),n=h("label"),n.textContent=""+("en"===R?"Digitization":"NumÃ©risation"),o=p(),i=h("div"),s=h("div"),r=h("select");for(let t=0;t<v.length;t+=1)v[t].c();_(n,"for","digit"),_(n,"class","label"),void 0===t[2]&&S((()=>t[4].call(r))),_(s,"class","select is-small"),_(i,"id","digit"),_(i,"class","control pl-3"),_(e,"class","field selector is-flex")},m(l,f){a(l,e,f),u(e,n),u(e,o),u(e,i),u(i,s),u(s,r);for(let t=0;t<v.length;t+=1)v[t]&&v[t].m(r,null);w(r,t[2],!0),c||(m=[g(r,"change",t[4]),g(r,"change",t[3])],c=!0)},p(t,e){if(1&e){let n;for($=t[0],n=0;n<$.length;n+=1){const l=q(t,$,n);v[n]?v[n].p(l,e):(v[n]=G(l),v[n].c(),v[n].m(r,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=$.length}5&e&&w(r,t[2])},d(t){t&&f(e),d(v,t),c=!1,l(m)}}}function G(t){let e,n,l,o,i=t[2]+"";return{c(){e=h("option"),n=m(i),l=p(),e.__value=o=t[2],e.value=e.__value},m(t,o){a(t,e,o),u(e,n),u(e,l)},p(t,l){1&l&&i!==(i=t[2]+"")&&$(n,i),1&l&&o!==(o=t[2])&&(e.__value=o,e.value=e.__value)},d(t){t&&f(e)}}}function H(e){let n,l,o,i=e[0].length>0&&z(e);return{c(){i&&i.c(),n=p(),l=h("iframe"),c(l.src,o=e[1])||_(l,"src",o),v(l,"width","100%"),v(l,"height","90%"),v(l,"border","none"),_(l,"title","Mirador viewer"),l.allowFullscreen=!0},m(t,e){i&&i.m(t,e),a(t,n,e),a(t,l,e)},p(t,[e]){t[0].length>0?i?i.p(t,e):(i=z(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null),2&e&&!c(l.src,o=t[1])&&_(l,"src",o)},i:t,o:t,d(t){i&&i.d(t),t&&f(n),t&&f(l)}}}function K(t,e,n){let{manifests:l=[]}=e,o=l?.[0]||"";let i="";return y((()=>{l.length>0&&n(1,i=F(l[0])),window.addEventListener("selectManifest",(t=>{n(1,i=F(t.detail.manifest))}))})),t.$$set=t=>{"manifests"in t&&n(0,l=t.manifests)},[l,i,o,function(t){n(2,o=t.target.value);const e=new CustomEvent("selectManifest",{detail:{manifest:o}});window.dispatchEvent(e)},function(){o=function(t){const e=t.querySelector(":checked");return e&&e.__value}(this),n(2,o),n(0,l)}]}CANTALOUPE_APP_URL,MEDIA_PATH,PAGE_LEN;class W extends D{constructor(t){super(),C(this,t,K,H,i,{manifests:0})}}function J(t,e,n){const l=t.slice();return l[7]=e[n],l[9]=n,l}function Q(t,e,n){const l=t.slice();return l[10]=e[n][0],l[11]=e[n][1],l}function V(t,e,n){const l=t.slice();return l[10]=e[n][0],l[11]=e[n][1],l}function X(t){let e,n,l,o,i,s,r=t[10]+"",c=t[11]+"";return{c(){e=h("span"),n=m(r),l=h("br"),o=p(),i=h("span"),s=m(c),_(e,"class","witness-key svelte-1wmag74"),_(i,"class","witness-value")},m(t,r){a(t,e,r),u(e,n),a(t,l,r),a(t,o,r),a(t,i,r),u(i,s)},p(t,e){2&e&&r!==(r=t[10]+"")&&$(n,r),2&e&&c!==(c=t[11]+"")&&$(s,c)},d(t){t&&f(e),t&&f(l),t&&f(o),t&&f(i)}}}function Y(t){let e,n,l,o=t[1].metadata_full.contents,i=[];for(let e=0;e<o.length;e+=1)i[e]=et(J(t,o,e));return{c(){e=h("h3"),e.textContent="Contents",n=p();for(let t=0;t<i.length;t+=1)i[t].c();l=m(""),_(e,"class","title is-5 mb-3")},m(t,o){a(t,e,o),a(t,n,o);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,o);a(t,l,o)},p(t,e){if(26&e){let n;for(o=t[1].metadata_full.contents,n=0;n<o.length;n+=1){const s=J(t,o,n);i[n]?i[n].p(s,e):(i[n]=et(s),i[n].c(),i[n].m(l.parentNode,l))}for(;n<i.length;n+=1)i[n].d(1);i.length=o.length}},d(t){t&&f(e),t&&f(n),d(i,t),t&&f(l)}}}function Z(t){let e,n=Object.entries(t[7].content),l=[];for(let e=0;e<n.length;e+=1)l[e]=tt(Q(t,n,e));return{c(){e=h("div");for(let t=0;t<l.length;t+=1)l[t].c();_(e,"class","mt-2 pl-3")},m(t,n){a(t,e,n);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,null)},p(t,o){if(2&o){let i;for(n=Object.entries(t[7].content),i=0;i<n.length;i+=1){const s=Q(t,n,i);l[i]?l[i].p(s,o):(l[i]=tt(s),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},d(t){t&&f(e),d(l,t)}}}function tt(t){let e,n,l,o,i,s,r=t[10]+"",c=t[11]+"";return{c(){e=h("div"),n=h("b"),l=m(r),o=m(":"),i=p(),s=m(c),_(e,"class","witness-value")},m(t,r){a(t,e,r),u(e,n),u(n,l),u(n,o),u(e,i),u(e,s)},p(t,e){2&e&&r!==(r=t[10]+"")&&$(l,r),2&e&&c!==(c=t[11]+"")&&$(s,c)},d(t){t&&f(e)}}}function et(t){let e,n,o,i,s,r,c,d,v,w=t[7].title+"",b=t[3].has(t[9]);function y(){return t[5](t[9])}function E(){return t[6](t[9])}let x=b&&Z(t);return{c(){e=h("div"),n=h("div"),o=m(w),i=p(),s=h("i"),r=p(),x&&x.c(),c=p(),_(s,"class","fa-solid fa-chevron-down"),_(n,"class","is-flex is-justify-content-space-between is-clickable witness-key svelte-1wmag74"),_(e,"class","mb-3")},m(t,l){a(t,e,l),u(e,n),u(n,o),u(n,i),u(n,s),u(e,r),x&&x.m(e,null),u(e,c),d||(v=[g(n,"click",y),g(n,"keypress",E)],d=!0)},p(n,l){t=n,2&l&&w!==(w=t[7].title+"")&&$(o,w),8&l&&(b=t[3].has(t[9])),b?x?x.p(t,l):(x=Z(t),x.c(),x.m(e,c)):x&&(x.d(1),x=null)},d(t){t&&f(e),x&&x.d(),d=!1,l(v)}}}function nt(e){let n,l,o,i,s,r,c,g,v,w=Object.entries(e[1].metadata_full.wit),b=[];for(let t=0;t<w.length;t+=1)b[t]=X(V(e,w,t));let y=e[1].metadata_full.contents?.length&&Y(e);return{c(){n=h("div"),l=h("div"),o=h("h2"),i=m(e[0]),s=p(),r=h("a"),c=h("span"),g=p();for(let t=0;t<b.length;t+=1)b[t].c();v=p(),y&&y.c(),_(c,"class","iconify"),_(c,"data-icon","entypo:edit"),_(r,"href",e[2]),_(r,"class","edit-btn button is-small is-rounded is-link px-3 ml-2 mt-1"),_(r,"title","Edit"),_(o,"class","title is-4 mb-4"),_(l,"class","content"),_(n,"class","panel box svelte-1wmag74")},m(t,e){a(t,n,e),u(n,l),u(l,o),u(o,i),u(o,s),u(o,r),u(r,c),u(l,g);for(let t=0;t<b.length;t+=1)b[t]&&b[t].m(l,null);u(l,v),y&&y.m(l,null)},p(t,[e]){if(1&e&&$(i,t[0]),4&e&&_(r,"href",t[2]),2&e){let n;for(w=Object.entries(t[1].metadata_full.wit),n=0;n<w.length;n+=1){const o=V(t,w,n);b[n]?b[n].p(o,e):(b[n]=X(o),b[n].c(),b[n].m(l,v))}for(;n<b.length;n+=1)b[n].d(1);b.length=w.length}t[1].metadata_full.contents?.length?y?y.p(t,e):(y=Y(t),y.c(),y.m(l,null)):y&&(y.d(1),y=null)},i:t,o:t,d(t){t&&f(n),d(b,t),y&&y.d()}}}function lt(t,e,n){let{viewTitle:l=""}=e,{witness:o={}}=e,{editUrl:i=""}=e,s=new Set;function r(t){s.has(t)?s.delete(t):s.add(t),n(3,s=new Set(s))}return t.$$set=t=>{"viewTitle"in t&&n(0,l=t.viewTitle),"witness"in t&&n(1,o=t.witness),"editUrl"in t&&n(2,i=t.editUrl)},[l,o,i,s,r,t=>r(t),t=>r(t)]}const ot=document.getElementById("witness-viewer");ot&&new W({target:ot,props:{manifests:manifests}});const it=new class extends D{constructor(t){super(),C(this,t,lt,nt,i,{viewTitle:0,witness:1,editUrl:2})}}({target:document.getElementById("witness-panel"),props:{viewTitle:viewTitle,witness:witness,editUrl:editUrl,manifests:manifests}});export{it as panel,ot as viewer};
//# sourceMappingURL=witness.js.map
