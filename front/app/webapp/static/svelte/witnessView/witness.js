function $(){}const gr=t=>t;function Rl(t,e){for(const i in e)t[i]=e[i];return t}function Dl(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function _r(t){return t()}function En(){return Object.create(null)}function Ie(t){t.forEach(_r)}function Qt(t){return typeof t=="function"}function ue(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ni;function We(t,e){return ni||(ni=document.createElement("a")),ni.href=e,t===ni.href}function Nl(t){return Object.keys(t).length===0}function Qi(t,...e){if(t==null)return $;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function Zi(t){let e;return Qi(t,i=>e=i)(),e}function oe(t,e,i){t.$$.on_destroy.push(Qi(e,i))}function Ge(t,e,i,n){if(t){const s=vr(t,e,i,n);return t[0](s)}}function vr(t,e,i,n){return t[1]&&n?Rl(i.ctx.slice(),t[1](n(e))):i.ctx}function Ye(t,e,i,n){if(t[2]&&n){const s=t[2](n(i));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],l=Math.max(e.dirty.length,s.length);for(let o=0;o<l;o+=1)r[o]=e.dirty[o]|s[o];return r}return e.dirty|s}return e.dirty}function Je(t,e,i,n,s,r){if(s){const l=vr(e,i,n,r);t.p(l,s)}}function Xe(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function jl(t){const e={};for(const i in t)e[i]=!0;return e}function si(t){return t??""}function fi(t){return t&&Qt(t.destroy)?t.destroy:$}const br=typeof window<"u";let $l=br?()=>window.performance.now():()=>Date.now(),en=br?t=>requestAnimationFrame(t):$;const Pt=new Set;function wr(t){Pt.forEach(e=>{e.c(t)||(Pt.delete(e),e.f())}),Pt.size!==0&&en(wr)}function Fl(t){let e;return Pt.size===0&&en(wr),{promise:new Promise(i=>{Pt.add(e={c:t,f:i})}),abort(){Pt.delete(e)}}}function _(t,e){t.appendChild(e)}function yr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ul(t){const e=b("style");return Vl(yr(t),e),e.sheet}function Vl(t,e){return _(t.head||t,e),e.sheet}function S(t,e,i){t.insertBefore(e,i||null)}function k(t){t.parentNode&&t.parentNode.removeChild(t)}function st(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function b(t){return document.createElement(t)}function Qe(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function G(t){return document.createTextNode(t)}function N(){return G(" ")}function he(){return G("")}function re(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Ct(t){return function(e){return e.preventDefault(),t.call(this,e)}}function m(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function Hl(t){return Array.from(t.childNodes)}function ce(t,e){e=""+e,t.data!==e&&(t.data=e)}function Mt(t,e){t.value=e??""}function je(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}function Cn(t,e,i){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e){s.selected=!0;return}}(!i||e!==void 0)&&(t.selectedIndex=-1)}function Bl(t){const e=t.querySelector(":checked");return e&&e.__value}function qe(t,e,i){t.classList[i?"add":"remove"](e)}function kr(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,i,n,e),s}class zl{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=Qe(i.nodeName):this.e=b(i.nodeType===11?"TEMPLATE":i.nodeName),this.t=i.tagName!=="TEMPLATE"?i:i.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)S(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(k)}}function di(t,e){return new t(e)}const hi=new Map;let mi=0;function ql(t){let e=5381,i=t.length;for(;i--;)e=(e<<5)-e^t.charCodeAt(i);return e>>>0}function Kl(t,e){const i={stylesheet:Ul(e),rules:{}};return hi.set(t,i),i}function In(t,e,i,n,s,r,l,o=0){const a=16.666/n;let c=`{
`;for(let v=0;v<=1;v+=a){const y=e+(i-e)*r(v);c+=v*100+`%{${l(y,1-y)}}
`}const u=c+`100% {${l(i,1-i)}}
}`,f=`__svelte_${ql(u)}_${o}`,d=yr(t),{stylesheet:h,rules:p}=hi.get(d)||Kl(d,t);p[f]||(p[f]=!0,h.insertRule(`@keyframes ${f} ${u}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${n}ms linear ${s}ms 1 both`,mi+=1,f}function xl(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),s=i.length-n.length;s&&(t.style.animation=n.join(", "),mi-=s,mi||Wl())}function Wl(){en(()=>{mi||(hi.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&k(e)}),hi.clear())})}let Yt;function ot(t){Yt=t}function $t(){if(!Yt)throw new Error("Function called outside component initialization");return Yt}function vt(t){$t().$$.on_mount.push(t)}function bi(t){$t().$$.on_destroy.push(t)}function tn(){const t=$t();return(e,i,{cancelable:n=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=kr(e,i,{cancelable:n});return s.slice().forEach(l=>{l.call(t,r)}),!r.defaultPrevented}return!0}}function lt(t,e){return $t().$$.context.set(t,e),e}function Ae(t){return $t().$$.context.get(t)}const At=[],Hi=[];let Lt=[];const On=[],Gl=Promise.resolve();let Bi=!1;function Yl(){Bi||(Bi=!0,Gl.then(nn))}function Ze(t){Lt.push(t)}const ji=new Set;let It=0;function nn(){if(It!==0)return;const t=Yt;do{try{for(;It<At.length;){const e=At[It];It++,ot(e),Jl(e.$$)}}catch(e){throw At.length=0,It=0,e}for(ot(null),At.length=0,It=0;Hi.length;)Hi.pop()();for(let e=0;e<Lt.length;e+=1){const i=Lt[e];ji.has(i)||(ji.add(i),i())}Lt.length=0}while(At.length);for(;On.length;)On.pop()();Bi=!1,ji.clear(),ot(t)}function Jl(t){if(t.fragment!==null){t.update(),Ie(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ze)}}function Xl(t){const e=[],i=[];Lt.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),Lt=e}let zt;function Ql(){return zt||(zt=Promise.resolve(),zt.then(()=>{zt=null})),zt}function $i(t,e,i){t.dispatchEvent(kr(`${e?"intro":"outro"}${i}`))}const ai=new Set;let at;function _e(){at={r:0,c:[],p:at}}function ve(){at.r||Ie(at.c),at=at.p}function M(t,e){t&&t.i&&(ai.delete(t),t.i(e))}function R(t,e,i,n){if(t&&t.o){if(ai.has(t))return;ai.add(t),at.c.push(()=>{ai.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const Zl={duration:0};function nt(t,e,i,n){const s={direction:"both"};let r=e(t,i,s),l=n?0:1,o=null,a=null,c=null;function u(){c&&xl(t,c)}function f(h,p){const g=h.b-l;return p*=Math.abs(g),{a:l,b:h.b,d:g,duration:p,start:h.start,end:h.start+p,group:h.group}}function d(h){const{delay:p=0,duration:g=300,easing:v=gr,tick:y=$,css:O}=r||Zl,P={start:$l()+p,b:h};h||(P.group=at,at.r+=1),o||a?a=P:(O&&(u(),c=In(t,l,h,g,p,v,O)),h&&y(0,1),o=f(P,g),Ze(()=>$i(t,h,"start")),Fl(C=>{if(a&&C>a.start&&(o=f(a,g),a=null,$i(t,o.b,"start"),O&&(u(),c=In(t,l,o.b,o.duration,0,v,r.css))),o){if(C>=o.end)y(l=o.b,1-l),$i(t,o.b,"end"),a||(o.b?u():--o.group.r||Ie(o.group.c)),o=null;else if(C>=o.start){const T=C-o.start;l=o.a+o.d*v(T/o.duration),y(l,1-l)}}return!!(o||a)}))}return{run(h){Qt(r)?Ql().then(()=>{r=r(s),d(h)}):d(h)},end(){u(),o=a=null}}}function ct(t,e){const i=e.token={};function n(s,r,l,o){if(e.token!==i)return;e.resolved=o;let a=e.ctx;l!==void 0&&(a=a.slice(),a[l]=o);const c=s&&(e.current=s)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((f,d)=>{d!==r&&f&&(_e(),R(f,1,1,()=>{e.blocks[d]===f&&(e.blocks[d]=null)}),ve())}):e.block.d(1),c.c(),M(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[r]=c),u&&nn()}if(Dl(t)){const s=$t();if(t.then(r=>{ot(s),n(e.then,1,e.value,r),ot(null)},r=>{if(ot(s),n(e.catch,2,e.error,r),ot(null),!e.hasCatch)throw r}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function Ft(t,e,i){const n=e.slice(),{resolved:s}=t;t.current===t.then&&(n[t.value]=s),t.current===t.catch&&(n[t.error]=s),t.block.p(n,i)}function eo(t,e){t.d(1),e.delete(t.key)}function Zt(t,e){R(t,1,1,()=>{e.delete(t.key)})}function Ut(t,e,i,n,s,r,l,o,a,c,u,f){let d=t.length,h=r.length,p=d;const g={};for(;p--;)g[t[p].key]=p;const v=[],y=new Map,O=new Map,P=[];for(p=h;p--;){const F=f(s,r,p),E=i(F);let D=l.get(E);D?n&&P.push(()=>D.p(F,e)):(D=c(E,F),D.c()),y.set(E,v[p]=D),E in g&&O.set(E,Math.abs(p-g[E]))}const C=new Set,T=new Set;function j(F){M(F,1),F.m(o,u),l.set(F.key,F),u=F.first,h--}for(;d&&h;){const F=v[h-1],E=t[d-1],D=F.key,Y=E.key;F===E?(u=F.first,d--,h--):y.has(Y)?!l.has(D)||C.has(D)?j(F):T.has(Y)?d--:O.get(D)>O.get(Y)?(T.add(D),j(F)):(C.add(Y),d--):(a(E,l),d--)}for(;d--;){const F=t[d];y.has(F.key)||a(F,l)}for(;h;)j(v[h-1]);return Ie(P),v}function yh(t,e){const i={},n={},s={$$scope:1};let r=t.length;for(;r--;){const l=t[r],o=e[r];if(o){for(const a in l)a in o||(n[a]=1);for(const a in o)s[a]||(i[a]=o[a],s[a]=1);t[r]=o}else for(const a in l)s[a]=1}for(const l in n)l in i||(i[l]=void 0);return i}function kh(t){return typeof t=="object"&&t!==null?t:{}}function ee(t){t&&t.c()}function Q(t,e,i,n){const{fragment:s,after_update:r}=t.$$;s&&s.m(e,i),n||Ze(()=>{const l=t.$$.on_mount.map(_r).filter(Qt);t.$$.on_destroy?t.$$.on_destroy.push(...l):Ie(l),t.$$.on_mount=[]}),r.forEach(Ze)}function Z(t,e){const i=t.$$;i.fragment!==null&&(Xl(i.after_update),Ie(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function to(t,e){t.$$.dirty[0]===-1&&(At.push(t),Yl(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function fe(t,e,i,n,s,r,l,o=[-1]){const a=Yt;ot(t);const c=t.$$={fragment:null,ctx:[],props:r,update:$,not_equal:s,bound:En(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:En(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};l&&l(c.root);let u=!1;if(c.ctx=i?i(t,e.props||{},(f,d,...h)=>{const p=h.length?h[0]:d;return c.ctx&&s(c.ctx[f],c.ctx[f]=p)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](p),u&&to(t,f)),d}):[],c.update(),u=!0,Ie(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const f=Hl(e.target);c.fragment&&c.fragment.l(f),f.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&M(t.$$.fragment),Q(t,e.target,e.anchor,e.customElement),nn()}ot(a)}class de{$destroy(){Z(this,1),this.$destroy=$}$on(e,i){if(!Qt(i))return $;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const s=n.indexOf(i);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Nl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function io(t){const e=t-1;return e*e*e+1}function pt(t,{delay:e=0,duration:i=400,easing:n=gr}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:r=>`opacity: ${r*s}`}}function An(t,{delay:e=0,duration:i=400,easing:n=io,axis:s="y"}={}){const r=getComputedStyle(t),l=+r.opacity,o=s==="y"?"height":"width",a=parseFloat(r[o]),c=s==="y"?["top","bottom"]:["left","right"],u=c.map(y=>`${y[0].toUpperCase()}${y.slice(1)}`),f=parseFloat(r[`padding${u[0]}`]),d=parseFloat(r[`padding${u[1]}`]),h=parseFloat(r[`margin${u[0]}`]),p=parseFloat(r[`margin${u[1]}`]),g=parseFloat(r[`border${u[0]}Width`]),v=parseFloat(r[`border${u[1]}Width`]);return{delay:e,duration:i,easing:n,css:y=>`overflow: hidden;opacity: ${Math.min(y*20,1)*l};${o}: ${y*a}px;padding-${c[0]}: ${y*f}px;padding-${c[1]}: ${y*d}px;margin-${c[0]}: ${y*h}px;margin-${c[1]}: ${y*p}px;border-${c[0]}-width: ${y*g}px;border-${c[1]}-width: ${y*v}px;`}}const Ot=[];function no(t,e){return{subscribe:Ee(t,e).subscribe}}function Ee(t,e=$){let i;const n=new Set;function s(o){if(ue(t,o)&&(t=o,i)){const a=!Ot.length;for(const c of n)c[1](),Ot.push(c,t);if(a){for(let c=0;c<Ot.length;c+=2)Ot[c][0](Ot[c+1]);Ot.length=0}}}function r(o){s(o(t))}function l(o,a=$){const c=[o,a];return n.add(c),n.size===1&&(i=e(s)||$),o(t),()=>{n.delete(c),n.size===0&&i&&(i(),i=null)}}return{set:s,update:r,subscribe:l}}function Be(t,e,i){const n=!Array.isArray(t),s=n?[t]:t,r=e.length<2;return no(i,l=>{let o=!1;const a=[];let c=0,u=$;const f=()=>{if(c)return;u();const h=e(n?a[0]:a,l);r?l(h):u=Qt(h)?h:$},d=s.map((h,p)=>Qi(h,g=>{a[p]=g,c&=~(1<<p),o&&f()},()=>{c|=1<<p}));return o=!0,f(),function(){Ie(d),u(),o=!1}})}const V=APP_LANG,$e=APP_NAME;WEBAPP_NAME;const ci=USER_ID,so=IS_SUPERUSER,Ke=CSRF_TOKEN,Rt=ADDITIONAL_MODULES,Jt="Region";APP_URL;const ro=SAS_APP_URL,lo=CANTALOUPE_APP_URL,oo=MEDIA_PATH,ao=PAGE_LEN,Et=Ee(!1),Sr=Ee(""),co=t=>typeof t=="string"||t instanceof String;async function Dt(t){Et.set(!0);try{return await t()}finally{Et.set(!1)}}function Er(t){return t.match(/\d+/g).toString()}function uo(t){return parseInt(Er(t),10)}function Cr(t,e=100){const i=Math.floor(e*.75);return t.length>e?t.slice(0,i)+"..."+t.slice(-e+i):t}function fo(){return lo??"http://localhost:8182"}function ho(){return ro??"http://localhost:8888"}function sn(t,e){if(typeof window<"u"){const i=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(i))return t.set(i),i}return t.set(1),1}function rn(t,e,i){if(e.set(t),typeof window<"u"){const n=new URL(window.location.href);n.searchParams.set(i,t),window.history.pushState({},"",n)}}function mo(t=null){if(t)return t=t.split("_"),t.length<3?void 0:`${t.slice(0,3).join("_").replace(".jpg","")}.jpg`}function Ir(t=null){const e=mo(t);return e===void 0?void 0:`${fo()}/iiif/2/${e}`}function gt(t=null,e=null,i="full"){if(e=co(e)?e.replace(".jpg",""):e,!t)return"https://placehold.co/96x96/png?text=No+image";if(!t.startsWith("wit")){const[r,...l]=t.split("_wit");t=`wit${l}`}const n=Ir(t);if(n===void 0)return"https://placehold.co/96x96/png?text=No+image";const s=t.split("_");return e||(e=s[s.length-1].includes(",")?s.pop().replace(".jpg",""):"full"),`${n}/${e}/${i}/0/default.jpg`}function Sh(t=null){return`${Ir(t)}/info.json`}function Nt(t=null,e=1){return`${ho()}/index.html?iiif-content=${t}&canvas=${e}`}function Me(t,e=null,i=!1){return new Promise(n=>{if(document.getElementById("msg-modal")){i?document.getElementById("modal-footer").hidden=!1:n(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=t,document.getElementById("hidden-msg-btn").click();const r=document.getElementById("cancel-btn"),l=document.getElementById("ok-btn"),o=document.getElementById("modal-bkg"),a=()=>{r.removeEventListener("click",c),o.removeEventListener("click",c),l.removeEventListener("click",u),document.getElementById("modal-footer").hidden=!0},c=()=>{a(),n(!1)},u=()=>{a(),n(!0)};r.addEventListener("click",c),l.addEventListener("click",u)}else i?n(window.confirm(t)):(window.alert(t),n(void 0))})}function Or(t,e){const i=window.URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=`${e}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(i),document.body.removeChild(n)}function pi(){let t,e,i=(n,s)=>n===s;return{set:n=>{e=t,t=n},setCompareFn:n=>i=n,get:()=>t,getNewAndOld:()=>[t,e],same:()=>i(t,e)}}const ln=(t,e)=>Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((i,n)=>i===e[n]||void 0);function Ar(t=null){return t<600?1:t<800?2:t<1e3?3:t<1200?4:t<1400?5:t>=1400?6:4}function Tr(t){const e=t.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),i=()=>t.classList.remove("is-active");e.forEach(s=>s.addEventListener("click",i));const n=s=>{s.key==="Escape"&&t.classList.contains("is-active")&&i()};return document.addEventListener("keydown",n),{destroy(){e.forEach(s=>s.removeEventListener("click",i)),document.removeEventListener("keydown",n)}}}function Pr(t){const e=()=>{const i=document.getElementById(t.dataset.target);i==null||i.classList.add("is-active")};return t.addEventListener("click",e),{destroy(){t.removeEventListener("click",e)}}}function on(t){const{type:e,modelName:i,title:n,extractMeta:s=h=>h}=t,r={id:null,type:e,title:n,is_public:!1,selected:{}},l=JSON.parse(localStorage.getItem(e))||r,o=Ee(l),a=Ee(!1);function c(h,p=!1){a.set(p),localStorage.setItem(e,JSON.stringify(h))}function u(){o.update(h=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),h;const p=Object.fromEntries(Object.entries(h.selected).map(([v,y])=>[v,Object.keys(y)])),g=h.id?`${h.id}/edit`:"new";return fetch(`${window.location.origin}/${i}/${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify({title:h.title,is_public:h.is_public,selection:h,...p})}).then(v=>v.json()).then(v=>{if(!(v!=null&&v.document_set_id))throw new Error("Failed to save");o.update(y=>(y.id=v.document_set_id,y.title=v.document_set_title,y.is_public=v.is_public,c(y,!0),y))}).catch(v=>console.error("Error:",v)),h})}const f=h=>o.update(()=>{const p=h.selection.id?h.selection:{...h.selection,id:h.id};return c(p),p}),d=()=>o.update(()=>{const h={...r,selected:{}};return c(h),h});return{type:e,subscribe:o.subscribe,add:h=>o.update(p=>(p.selected[h.class]={...p.selected[h.class]||{},[h.id]:s(h)},c(p),p)),addAll:h=>o.update(p=>(h.forEach(g=>{p.selected[g.class]={...p.selected[g.class]||{},[g.id]:s(g)}}),c(p),p)),remove:(h,p)=>o.update(g=>{const{[h]:v,...y}=g.selected[p];return g.selected[p]=y,c(g),g}),removeAll:(h,p)=>o.update(g=>(h.forEach(v=>{var y;return(y=g.selected[p])==null?!0:delete y[v]}),c(g),g)),toggle:h=>o.update(p=>{var g;if((g=p.selected[h.class])!=null&&g[h.id]){const{[h.id]:v,...y}=p.selected[h.class];p.selected[h.class]=y}else p.selected[h.class]={...p.selected[h.class]||{},[h.id]:s(h)};return c(p),p}),toggleSet:h=>{Zi(o).id===h.id?d():f(h)},empty:()=>o.update(h=>(h.id=null,h.title=n,h.selected={},c(h,!0),h)),updateTitle:h=>o.update(p=>(p.title=h,c(p,!0),p)),updatePublic:h=>o.update(p=>(p.is_public=h,c(p,!0),p)),save:u,isSaved:a,selection:o,selectionTitle:Be(o,h=>h.title),isSelected:Be(o,h=>p=>{var g;return((g=h.selected[p.class])==null?void 0:g[p.id])||!1}),selected:Be(o,h=>h.selected),nbSelected:Be(o,h=>Object.entries(h.selected).reduce((p,[g,v])=>g==="User"?p:p+Object.keys(v).length,0)),isSetSelected:Be(o,h=>p=>h.id===p.id)}}const po=on({type:"documentSet",modelName:"document-set",title:V==="en"?"Document set":"Set de documents",extractMeta:t=>({title:t.title,url:t.url})}),ht=on({type:"regionsSet",modelName:"regions-set",title:V==="en"?"Regions set":"Set de régions",extractMeta:t=>t});function go(t){if(!t.startsWith("wit"))return t;const[e,...i]=t.split("_wit");return`wit${i}`}on({type:"clusterSet",modelName:"cluster-set",title:V==="en"?"Selected regions":"Régions sélectionnées",extractMeta:t=>({imgRef:t.id,clusterId:t.clusterId,title:t.title,xywh:t.xywh,img:go(t.id)})});function _o(){const t=`${window.location.origin}${window.location.pathname}`,e=Ee(1),i=Ee({}),n=Ee({}),s=Ee("");sn(e,"p");function r(u){s.update(f=>{const d=f===u?"":u;return navigator.clipboard.writeText(d).then(h=>""),d})}const l=(async()=>{try{const u=await fetch(`${t}canvas`);if(!u.ok)return{};const f=await u.json();let d={};return Object.values(f).forEach(h=>{Object.entries(h).forEach(([p,g])=>{d[p]=g})}),i.set(d),f}catch{return{}}})(),o=Be(e,u=>(async()=>{const d=await(await fetch(`${t}canvas?p=${u}`)).json();return n.set(d),d})());function a(u){rn(u,e,"p")}function c(u){i.update(f=>(delete f[u],{...f})),n.update(f=>{for(const d in f)if(f[d][u]){const{[u]:h,...p}=f[d];return f[d]=p,f}return f})}return{currentPage:e,pageRegions:n,allRegions:i,fetchPages:o,fetchAll:l,handlePageUpdate:a,remove:c,clipBoard:s,copyRef:r}}const _t=_o();function Tn(t){let e,i,n;return{c(){e=b("div"),e.innerHTML='<div class="loader svelte-vizlcg"></div>',m(e,"class","bkg-shade svelte-vizlcg")},m(s,r){S(s,e,r),n=!0},i(s){n||(Ze(()=>{n&&(i||(i=nt(e,pt,{duration:150},!0)),i.run(1))}),n=!0)},o(s){i||(i=nt(e,pt,{duration:150},!1)),i.run(0),n=!1},d(s){s&&k(e),s&&i&&i.end()}}}function vo(t){let e,i,n=t[0]&&Tn();return{c(){n&&n.c(),e=he()},m(s,r){n&&n.m(s,r),S(s,e,r),i=!0},p(s,[r]){s[0]?n?r&1&&M(n,1):(n=Tn(),n.c(),M(n,1),n.m(e.parentNode,e)):n&&(_e(),R(n,1,1,()=>{n=null}),ve())},i(s){i||(M(n),i=!0)},o(s){R(n),i=!1},d(s){n&&n.d(s),s&&k(e)}}}function bo(t,e,i){let n;return oe(t,Et,s=>i(0,n=s)),[n]}class Lr extends de{constructor(e){super(),fe(this,e,bo,vo,ue,{})}}const wo=t=>({}),Pn=t=>({});function yo(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g,v,y,O,P,C,T;const j=t[1].content,F=Ge(j,t,t[0],Pn);return{c(){e=b("button"),i=N(),n=b("div"),s=b("div"),r=N(),l=b("div"),o=b("div"),o.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,a=N(),c=b("section"),u=b("div"),f=N(),d=b("div"),F&&F.c(),h=N(),p=b("footer"),g=b("div"),v=b("button"),v.textContent=`${V==="en"?"Abort":"Retour"}`,y=N(),O=b("button"),O.textContent="OK",m(e,"id","hidden-msg-btn"),m(e,"data-target","msg-modal"),e.hidden=!0,m(s,"id","modal-bkg"),m(s,"class","modal-background"),m(o,"class","modal-card-head media mb-0"),m(u,"id","modal-msg"),m(d,"class","py-3"),m(c,"id","modal-body"),m(c,"class","modal-card-body"),m(v,"id","cancel-btn"),m(v,"class","button is-link is-light button-close"),m(O,"id","ok-btn"),m(O,"class","button is-link button-close"),m(g,"class","buttons"),m(p,"id","modal-footer"),m(p,"class","modal-card-foot is-center pt-3"),p.hidden=!0,m(l,"class","modal-content"),m(n,"id","msg-modal"),m(n,"class","modal fade"),m(n,"tabindex","-1"),m(n,"aria-labelledby","selection-modal-label"),m(n,"aria-hidden","true")},m(E,D){S(E,e,D),S(E,i,D),S(E,n,D),_(n,s),_(n,r),_(n,l),_(l,o),_(l,a),_(l,c),_(c,u),_(c,f),_(c,d),F&&F.m(d,null),_(l,h),_(l,p),_(p,g),_(g,v),_(g,y),_(g,O),P=!0,C||(T=[fi(Pr.call(null,e)),fi(Tr.call(null,n))],C=!0)},p(E,[D]){F&&F.p&&(!P||D&1)&&Je(F,j,E,E[0],P?Ye(j,E[0],D,wo):Xe(E[0]),Pn)},i(E){P||(M(F,E),P=!0)},o(E){R(F,E),P=!1},d(E){E&&k(e),E&&k(i),E&&k(n),F&&F.d(E),C=!1,Ie(T)}}}function ko(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=r=>{"$$scope"in r&&i(0,s=r.$$scope)},[s,n]}class So extends de{constructor(e){super(),fe(this,e,ko,yo,ue,{})}}const Eo=t=>({activeTab:t&8}),Ln=t=>({activeTab:t[3]});function Mn(t,e,i){const n=t.slice();return n[11]=e[i][0],n[12]=e[i][1],n}const Co=t=>({activeTab:t&8}),Rn=t=>({activeTab:t[3]}),Io=t=>({}),Dn=t=>({});function Oo(t){let e,i,n=Object.entries(t[2]),s=[];for(let r=0;r<n.length;r+=1)s[r]=Nn(Mn(t,n,r));return{c(){e=b("div"),i=b("ul");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","tabs")},m(r,l){S(r,e,l),_(e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,null)},p(r,l){if(l&28){n=Object.entries(r[2]);let o;for(o=0;o<n.length;o+=1){const a=Mn(r,n,o);s[o]?s[o].p(a,l):(s[o]=Nn(a),s[o].c(),s[o].m(i,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},i:$,o:$,d(r){r&&k(e),st(s,r)}}}function Ao(t){let e;const i=t[8].tabs,n=Ge(i,t,t[7],Rn);return{c(){n&&n.c()},m(s,r){n&&n.m(s,r),e=!0},p(s,r){n&&n.p&&(!e||r&136)&&Je(n,i,s,s[7],e?Ye(i,s[7],r,Co):Xe(s[7]),Rn)},i(s){e||(M(n,s),e=!0)},o(s){R(n,s),e=!1},d(s){n&&n.d(s)}}}function Nn(t){let e,i,n=t[12]+"",s,r,l,o;function a(){return t[9](t[11])}return{c(){e=b("li"),i=b("a"),s=G(n),r=N(),m(i,"href",null),qe(e,"is-active",t[3]===t[11])},m(c,u){S(c,e,u),_(e,i),_(i,s),_(e,r),l||(o=re(i,"click",a),l=!0)},p(c,u){t=c,u&4&&n!==(n=t[12]+"")&&ce(s,n),u&12&&qe(e,"is-active",t[3]===t[11])},d(c){c&&k(e),l=!1,o()}}}function To(t){let e,i,n,s,r,l,o,a,c,u,f,d,h;e=new Lr({});const p=t[8].sidebar,g=Ge(p,t,t[7],Dn),v=[Ao,Oo],y=[];function O(T,j){return j&4&&(a=null),T[5].tabs?0:(a==null&&(a=!!Object.keys(T[2]).length),a?1:-1)}~(c=O(t,-1))&&(u=y[c]=v[c](t));const P=t[8].content,C=Ge(P,t,t[7],Ln);return{c(){ee(e.$$.fragment),i=N(),n=b("div"),s=b("aside"),g&&g.c(),r=N(),l=b("main"),o=b("nav"),u&&u.c(),f=N(),d=b("div"),C&&C.c(),m(s,"class","sidebar svelte-jexg"),je(s,"width",t[0]+"%"),je(s,"min-height",t[1]),m(o,"id","tabs"),m(o,"class","tabs-bar svelte-jexg"),m(d,"class","content-area pl-5 svelte-jexg"),m(l,"class","main-content svelte-jexg"),je(l,"width",100-t[0]+"%"),je(l,"min-height",t[1]),m(n,"class","layout svelte-jexg"),je(n,"min-height",t[1])},m(T,j){Q(e,T,j),S(T,i,j),S(T,n,j),_(n,s),g&&g.m(s,null),_(n,r),_(n,l),_(l,o),~c&&y[c].m(o,null),_(l,f),_(l,d),C&&C.m(d,null),h=!0},p(T,[j]){g&&g.p&&(!h||j&128)&&Je(g,p,T,T[7],h?Ye(p,T[7],j,Io):Xe(T[7]),Dn),(!h||j&1)&&je(s,"width",T[0]+"%");let F=c;c=O(T,j),c===F?~c&&y[c].p(T,j):(u&&(_e(),R(y[F],1,1,()=>{y[F]=null}),ve()),~c?(u=y[c],u?u.p(T,j):(u=y[c]=v[c](T),u.c()),M(u,1),u.m(o,null)):u=null),C&&C.p&&(!h||j&136)&&Je(C,P,T,T[7],h?Ye(P,T[7],j,Eo):Xe(T[7]),Ln),(!h||j&1)&&je(l,"width",100-T[0]+"%")},i(T){h||(M(e.$$.fragment,T),M(g,T),M(u),M(C,T),h=!0)},o(T){R(e.$$.fragment,T),R(g,T),R(u),R(C,T),h=!1},d(T){Z(e,T),T&&k(i),T&&k(n),g&&g.d(T),~c&&y[c].d(),C&&C.d(T)}}}function Po(t=null){t||(t=document.getElementById("navbar")),document.documentElement.style.setProperty("--top-offset",`${t.offsetHeight}px`)}function Lo(t,e,i){let n,{$$slots:s={},$$scope:r}=e;const l=jl(s);let{sidebarWidth:o="25"}=e;const a="90vh";let{tabList:c={}}=e,u=Object.keys(c),{topOffsetElement:f=null}=e;Po(f);function d(p){if(!u.includes(p)){console.warn(`Tab "${p}" is not available.`);return}i(3,n=p);const g=new URL(window.location);g.searchParams.set("tab",p),window.history.pushState({},"",g)}const h=p=>d(p);return t.$$set=p=>{"sidebarWidth"in p&&i(0,o=p.sidebarWidth),"tabList"in p&&i(2,c=p.tabList),"topOffsetElement"in p&&i(6,f=p.topOffsetElement),"$$scope"in p&&i(7,r=p.$$scope)},i(3,n=new URLSearchParams(window.location.search).get("tab")??u[0]??null),[o,a,c,n,d,l,f,r,s,h]}class Mo extends de{constructor(e){super(),fe(this,e,Lo,To,ue,{sidebarWidth:0,layoutHeight:1,tabList:2,topOffsetElement:6})}get layoutHeight(){return this.$$.ctx[1]}}function jn(t,e,i){const n=t.slice();return n[8]=e[i],n[10]=i,n}function $n(t,e,i){const n=t.slice();return n[11]=e[i][0],n[12]=e[i][1],n}function Fn(t,e,i){const n=t.slice();return n[11]=e[i][0],n[12]=e[i][1],n}function Un(t){let e,i;return{c(){e=b("a"),i=b("span"),m(i,"class","iconify"),m(i,"data-icon","entypo:edit"),m(e,"href",t[2]),m(e,"class","edit-btn button is-small is-rounded is-link px-3 ml-2 mt-1"),m(e,"title","Edit")},m(n,s){S(n,e,s),_(e,i)},p(n,s){s&4&&m(e,"href",n[2])},d(n){n&&k(e)}}}function Vn(t){let e,i=t[12].label+"",n,s,r,l,o=t[12].value+"",a;return{c(){e=b("span"),n=G(i),s=N(),r=b("span"),l=b("span"),a=G(o),m(e,"class","witness-key svelte-1yrx5r8"),m(r,"class","witness-value svelte-1yrx5r8")},m(c,u){S(c,e,u),_(e,n),S(c,s,u),S(c,r,u),_(r,l),_(l,a)},p(c,u){u&2&&i!==(i=c[12].label+"")&&ce(n,i),u&2&&o!==(o=c[12].value+"")&&ce(a,o)},d(c){c&&k(e),c&&k(s),c&&k(r)}}}function Hn(t){let e,i,n,s=t[1].metadata_full.contents,r=[];for(let l=0;l<s.length;l+=1)r[l]=Kn(jn(t,s,l));return{c(){e=b("h3"),e.textContent="Contents",i=N();for(let l=0;l<r.length;l+=1)r[l].c();n=he(),m(e,"class","title is-5 mb-3")},m(l,o){S(l,e,o),S(l,i,o);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,o);S(l,n,o)},p(l,o){if(o&26){s=l[1].metadata_full.contents;let a;for(a=0;a<s.length;a+=1){const c=jn(l,s,a);r[a]?r[a].p(c,o):(r[a]=Kn(c),r[a].c(),r[a].m(n.parentNode,n))}for(;a<r.length;a+=1)r[a].d(1);r.length=s.length}},d(l){l&&k(e),l&&k(i),st(r,l),l&&k(n)}}}function Bn(t){let e;return{c(){e=b("i"),m(e,"class","fa-solid fa-chevron-down")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function zn(t){let e,i=Object.entries(t[8].content),n=[];for(let s=0;s<i.length;s+=1)n[s]=qn($n(t,i,s));return{c(){e=b("div");for(let s=0;s<n.length;s+=1)n[s].c();m(e,"class","mt-2 pl-3")},m(s,r){S(s,e,r);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(s,r){if(r&2){i=Object.entries(s[8].content);let l;for(l=0;l<i.length;l+=1){const o=$n(s,i,l);n[l]?n[l].p(o,r):(n[l]=qn(o),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(s){s&&k(e),st(n,s)}}}function qn(t){let e,i,n=t[11]+"",s,r,l,o=t[12]+"",a;return{c(){e=b("div"),i=b("b"),s=G(n),r=G(":"),l=N(),a=G(o),m(e,"class","witness-value svelte-1yrx5r8")},m(c,u){S(c,e,u),_(e,i),_(i,s),_(i,r),_(e,l),_(e,a)},p(c,u){u&2&&n!==(n=c[11]+"")&&ce(s,n),u&2&&o!==(o=c[12]+"")&&ce(a,o)},d(c){c&&k(e)}}}function Kn(t){let e,i,n=t[8].title+"",s,r,l=Object.entries(t[8].content).length,o,a=t[3].has(t[10]),c,u,f,d=l&&Bn();function h(){return t[5](t[10])}function p(){return t[6](t[10])}let g=a&&zn(t);return{c(){e=b("div"),i=b("div"),s=G(n),r=N(),d&&d.c(),o=N(),g&&g.c(),c=N(),m(i,"class","is-flex is-justify-content-space-between witness-key svelte-1yrx5r8"),m(e,"class","mb-3")},m(v,y){S(v,e,y),_(e,i),_(i,s),_(i,r),d&&d.m(i,null),_(e,o),g&&g.m(e,null),_(e,c),u||(f=[re(i,"click",h),re(i,"keypress",p)],u=!0)},p(v,y){t=v,y&2&&n!==(n=t[8].title+"")&&ce(s,n),y&2&&(l=Object.entries(t[8].content).length),l?d||(d=Bn(),d.c(),d.m(i,null)):d&&(d.d(1),d=null),y&8&&(a=t[3].has(t[10])),a?g?g.p(t,y):(g=zn(t),g.c(),g.m(e,c)):g&&(g.d(1),g=null)},d(v){v&&k(e),d&&d.d(),g&&g.d(),u=!1,Ie(f)}}}function Ro(t){var h;let e,i,n,s,r,l,o,a,c=t[1].can_edit&&Un(t),u=Object.entries(t[1].metadata_full.wit),f=[];for(let p=0;p<u.length;p+=1)f[p]=Vn(Fn(t,u,p));let d=((h=t[1].metadata_full.contents)==null?void 0:h.length)&&Hn(t);return{c(){e=b("div"),i=b("div"),n=b("div"),s=b("h1"),r=G(t[0]),l=N(),c&&c.c(),o=N();for(let p=0;p<f.length;p+=1)f[p].c();a=N(),d&&d.c(),m(s,"class","title"),m(n,"class","pb-2"),m(i,"class","content is-small mt-4"),m(e,"class","m-4 py-5 px-4")},m(p,g){S(p,e,g),_(e,i),_(i,n),_(n,s),_(s,r),_(s,l),c&&c.m(s,null),_(n,o);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(n,null);_(n,a),d&&d.m(n,null)},p(p,[g]){var v;if(g&1&&ce(r,p[0]),p[1].can_edit?c?c.p(p,g):(c=Un(p),c.c(),c.m(s,null)):c&&(c.d(1),c=null),g&2){u=Object.entries(p[1].metadata_full.wit);let y;for(y=0;y<u.length;y+=1){const O=Fn(p,u,y);f[y]?f[y].p(O,g):(f[y]=Vn(O),f[y].c(),f[y].m(n,a))}for(;y<f.length;y+=1)f[y].d(1);f.length=u.length}(v=p[1].metadata_full.contents)!=null&&v.length?d?d.p(p,g):(d=Hn(p),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},i:$,o:$,d(p){p&&k(e),c&&c.d(),st(f,p),d&&d.d()}}}function Do(t,e,i){let{viewTitle:n=""}=e,{witness:s={}}=e,{editUrl:r=""}=e,l={},o=new Set;vt(async()=>{const f=`${window.location.origin}/${$e}/witness/select`;try{l=await(await fetch(f)).json()}catch(d){return console.error("Error:",d),!1}});function a(f){o.has(f)?o.delete(f):o.add(f),i(3,o=new Set(o))}const c=f=>a(f),u=f=>a(f);return t.$$set=f=>{"viewTitle"in f&&i(0,n=f.viewTitle),"witness"in f&&i(1,s=f.witness),"editUrl"in f&&i(2,r=f.editUrl)},[n,s,r,o,a,c,u]}class No extends de{constructor(e){super(),fe(this,e,Do,Ro,ue,{viewTitle:0,witness:1,editUrl:2})}}const jo="modulepreload",$o=function(t){return"/"+t},xn={},Mr=function(e,i,n){if(!i||i.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(i.map(r=>{if(r=$o(r),r in xn)return;xn[r]=!0;const l=r.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const f=s[u];if(f.href===r&&(!l||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${o}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":jo,l||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),l)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r})};class Fo{constructor(e){this.id=e.id,this.img=e.img??e.ref,this.title=e.title,this.xywh=e.xywh,this.canvas=e.canvas,this.ref=e.ref,this.type=Jt}url(e=null,i=null){return gt(this.img,e??this.xywh??"full",i??"full")}}function Uo(t){let e;return{c(){e=Qe("path"),m(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),m(e,"class","svelte-1829hp2")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function Vo(t){let e;return{c(){e=Qe("path"),m(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),m(e,"class","svelte-1829hp2")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function Ho(t){let e=V==="en"?"Copy ID":"Copier l'ID",i;return{c(){i=G(e)},m(n,s){S(n,i,s)},p:$,d(n){n&&k(i)}}}function Bo(t){let e=V==="en"?"Copied!":"Copié !",i;return{c(){i=G(e)},m(n,s){S(n,i,s)},p:$,d(n){n&&k(i)}}}function Wn(t){let e,i,n;var s=t[9];function r(l){return{props:{mainImgItem:l[0],compareImgItem:l[16],items:l[2],index:l[3]}}}return s&&(e=di(s,r(t))),{c(){e&&ee(e.$$.fragment),i=he()},m(l,o){e&&Q(e,l,o),S(l,i,o),n=!0},p(l,o){const a={};if(o&1&&(a.mainImgItem=l[0]),o&4&&(a.items=l[2]),o&8&&(a.index=l[3]),o&512&&s!==(s=l[9])){if(e){_e();const c=e;R(c.$$.fragment,1,0,()=>{Z(c,1)}),ve()}s?(e=di(s,r(l)),ee(e.$$.fragment),M(e.$$.fragment,1),Q(e,i.parentNode,i)):e=null}else s&&e.$set(a)},i(l){n||(e&&M(e.$$.fragment,l),n=!0)},o(l){e&&R(e.$$.fragment,l),n=!1},d(l){l&&k(i),e&&Z(e,l)}}}function zo(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g,v,y,O,P,C,T,j,F;function E(K,U){return K[10]?Vo:Uo}let D=E(t),Y=D(t);function z(K,U){return K[10]?Bo:Ho}let L=z(t),H=L(t),q=t[9]&&Wn(t);return{c(){e=b("div"),i=b("figure"),n=b("img"),r=N(),l=b("div"),o=b("span"),u=N(),f=b("div"),d=b("button"),h=Qe("svg"),Y.c(),p=N(),g=b("span"),H.c(),y=N(),q&&q.c(),m(n,"class","region-img svelte-1829hp2"),We(n.src,s=t[11])||m(n,"src",s),m(n,"alt","Extracted region"),m(o,"class","overlay-desc"),m(l,"class","overlay is-center svelte-1829hp2"),m(i,"class",a="image card region-image "+(t[1]?"is-96x96":"")+" svelte-1829hp2"),m(i,"tabindex","-1"),m(i,"style",c=(t[4]==="full"?"height: 100%":`height: ${t[4]}px; min-width: ${t[4]}px`)+"; "+(t[5]?`border: 5px solid ${t[5]};`:"")),m(h,"xmlns","http://www.w3.org/2000/svg"),m(h,"viewBox","0 0 384 512"),m(h,"class","svelte-1829hp2"),m(g,"class","tooltip svelte-1829hp2"),m(d,"class","button tag svelte-1829hp2"),m(d,"style",v=t[8]?"":"display: none;"),m(f,"class","region-btn ml-1 svelte-1829hp2"),m(e,"class",O="region is-center "+(t[7]&&t[13](t[0])?"checked":"")+" svelte-1829hp2"),m(e,"style",P=t[4]==="full"?"height: 100%":"")},m(K,U){S(K,e,U),_(e,i),_(i,n),_(i,r),_(i,l),_(l,o),o.innerHTML=t[12],_(e,u),_(e,f),_(f,d),_(d,h),Y.m(h,null),_(d,p),_(d,g),H.m(g,null),_(f,y),q&&q.m(f,null),T=!0,j||(F=[re(i,"click",t[21]),re(i,"keyup",qo),re(d,"click",t[22])],j=!0)},p(K,[U]){t=K,(!T||U&2048&&!We(n.src,s=t[11]))&&m(n,"src",s),(!T||U&4096)&&(o.innerHTML=t[12]),(!T||U&2&&a!==(a="image card region-image "+(t[1]?"is-96x96":"")+" svelte-1829hp2"))&&m(i,"class",a),(!T||U&48&&c!==(c=(t[4]==="full"?"height: 100%":`height: ${t[4]}px; min-width: ${t[4]}px`)+"; "+(t[5]?`border: 5px solid ${t[5]};`:"")))&&m(i,"style",c),D!==(D=E(t))&&(Y.d(1),Y=D(t),Y&&(Y.c(),Y.m(h,null))),L===(L=z(t))&&H?H.p(t,U):(H.d(1),H=L(t),H&&(H.c(),H.m(g,null))),(!T||U&256&&v!==(v=t[8]?"":"display: none;"))&&m(d,"style",v),t[9]?q?(q.p(t,U),U&512&&M(q,1)):(q=Wn(t),q.c(),M(q,1),q.m(f,null)):q&&(_e(),R(q,1,1,()=>{q=null}),ve()),(!T||U&8321&&O!==(O="region is-center "+(t[7]&&t[13](t[0])?"checked":"")+" svelte-1829hp2"))&&m(e,"class",O),(!T||U&16&&P!==(P=t[4]==="full"?"height: 100%":""))&&m(e,"style",P)},i(K){T||(M(q),Ze(()=>{T&&(C||(C=nt(e,pt,{duration:t[17]},!0)),C.run(1))}),T=!0)},o(K){R(q),C||(C=nt(e,pt,{duration:t[17]},!1)),C.run(0),T=!1},d(K){K&&k(e),Y.d(),H.d(),q&&q.d(),K&&C&&C.end(),j=!1,Ie(F)}}}const qo=()=>null;function Ko(t,e,i){let n,s,r,l,o,{selectionStore:a}=e;a||(a=ht);const{isSelected:c}=a;oe(t,c,z=>i(13,o=z));const{clipBoard:u}=_t;oe(t,u,z=>i(20,l=z));let{item:f}=e,{items:d=null}=e,{index:h=null}=e,{descPromise:p=void 0}=e,{isSquare:g=!0}=e,{height:v=g?96:140}=e;v==="full"&&(g=!1);let{borderColor:y=null}=e,{toggleSelection:O=a.toggle}=e;const P=Ae("qImgMetadata")||void 0,C=Ae("isInModal")||!1,T=C?0:500;let j;C||Mr(()=>import("./ModalController-5b2bb6e2.js"),[]).then(z=>i(9,j=z.default));let{selectable:F=!C}=e,{copyable:E=!0}=e;f=new Fo(f);const D=()=>F?O(f):null,Y=()=>E?_t.copyRef(f.ref):null;return t.$$set=z=>{"selectionStore"in z&&i(18,a=z.selectionStore),"item"in z&&i(0,f=z.item),"items"in z&&i(2,d=z.items),"index"in z&&i(3,h=z.index),"descPromise"in z&&i(19,p=z.descPromise),"isSquare"in z&&i(1,g=z.isSquare),"height"in z&&i(4,v=z.height),"borderColor"in z&&i(5,y=z.borderColor),"toggleSelection"in z&&i(6,O=z.toggleSelection),"selectable"in z&&i(7,F=z.selectable),"copyable"in z&&i(8,E=z.copyable)},t.$$.update=()=>{t.$$.dirty&1&&i(12,n=f.title),t.$$.dirty&524288&&p&&p.then(z=>i(12,n=z)),t.$$.dirty&19&&i(11,s=f.url(null,v==="full"?v:g?`${v},`:`,${v}`)),t.$$.dirty&1048577&&i(10,r=f.ref===l)},[f,g,d,h,v,y,O,F,E,j,r,s,n,o,c,u,P,T,a,p,l,D,Y]}class an extends de{constructor(e){super(),fe(this,e,Ko,zo,ue,{selectionStore:18,item:0,items:2,index:3,descPromise:19,isSquare:1,height:4,borderColor:5,toggleSelection:6,selectable:7,copyable:8})}}function xo(t){let e,i,n,s,r,l=V==="en"?"Selection":"Sélection",o,a,c,u,f,d;return{c(){e=b("div"),i=b("button"),n=b("span"),s=b("i"),r=N(),o=G(l),a=G(`
            (`),c=G(t[0]),u=G(")"),m(s,"class","fa-solid fa-book-bookmark"),m(n,"id","btn-content"),m(i,"id","set-btn"),m(i,"class","button px-5 py-4 is-link svelte-gmt9z5"),m(i,"data-target","selection-modal"),m(e,"class","set-container svelte-gmt9z5")},m(h,p){S(h,e,p),_(e,i),_(i,n),_(n,s),_(n,r),_(n,o),_(n,a),_(n,c),_(n,u),f||(d=fi(Pr.call(null,i)),f=!0)},p(h,[p]){p&1&&ce(c,h[0])},i:$,o:$,d(h){h&&k(e),f=!1,d()}}}function Wo(t,e,i){let{selectionLength:n=0}=e,s=n;return t.$$set=r=>{"selectionLength"in r&&i(0,n=r.selectionLength)},t.$$.update=()=>{if(t.$$.dirty&3&&n!==s){const r=n>s;i(1,s=n);const l=document.getElementById("btn-content");l&&l.animate([{transform:r?"translateY(-7px)":"translateX(-5px)"},{transform:r?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[n,s]}class Go extends de{constructor(e){super(),fe(this,e,Wo,xo,ue,{selectionLength:0})}}function Yo(t){let e,i,n;return{c(){e=b("button"),e.textContent=`${V==="en"?"Automatic region extraction":"Extraction automatique des régions"}`,m(e,"class","button is-link is-light")},m(s,r){S(s,e,r),i||(n=re(e,"click",t[1]),i=!0)},p:$,d(s){s&&k(e),i=!1,n()}}}function Jo(t){let e,i,n,s=Rt.includes("regions"),r,l,o=s&&Yo(t);return{c(){e=b("div"),i=b("button"),i.textContent=`${V==="en"?"Manually annotate":"Annoter manuellement"}`,n=N(),o&&o.c(),m(i,"class","button is-link"),m(e,"class","is-center buttons is-centered pt-5")},m(a,c){S(a,e,c),_(e,i),_(e,n),o&&o.m(e,null),r||(l=re(i,"click",t[0]),r=!0)},p(a,[c]){s&&o.p(a,c)},i:$,o:$,d(a){a&&k(e),o&&o.d(),r=!1,l()}}}function Xo(t,e,i){const n=Ae("witness");let{currentRegionId:s}=e,{baseUrl:r}=e;async function l(){const a=`${window.location.origin}/${$e}`;let c=`${a}/witness/${n.id}/regions/add`;if(n.regions.length===1||s){const d=s||n.regions[0];c=`${a}/witness/${n.id}/regions/${d}/add`}const u=await Dt(()=>fetch(c,{method:"POST",headers:{"X-CSRFToken":Ke}}));if(!u.ok)throw await Me(`Failed to create regions: '${u.statusText}'`,"Error"),new Error(`Failed to create regions: '${u.statusText}'`);let f;try{f=await u.json()}catch(d){throw await Me(`Failed to parse JSON response: '${d}'`,"Error"),new Error(`Failed to parse JSON response: '${d}'`)}f.hasOwnProperty("mirador_url")&&window.open(f.mirador_url),f.hasOwnProperty("regions_id")&&(window.location.href=`${r.split("regions/")[0]}regions/${f.regions_id}`)}async function o(){const a=`${window.location.origin}/${$e}/witness/${n.id}/regions/extract`,c=await Dt(()=>fetch(a,{method:"POST",headers:{"X-CSRFToken":Ke}}));let u;if(c.ok)try{u=await c.json(),console.log(u)}catch(f){throw await Me(`Failed to parse JSON response: '${f}'`,"Error"),new Error(`Failed to parse JSON response: '${f}'`)}finally{const f=u.doc_set_id;if(!f)throw await Me("Failed to launch regions extraction: 'No document set id'","Error"),new Error("Failed to launch regions extraction: 'No document set id'");window.location.href=`${window.location.origin}/${$e}/treatment/add/?document_set=${f}&task_type=regions`}else throw await Me(`Failed to launch regions extraction: '${u.message}'`,"Error"),new Error(`Failed to launch regions extraction: '${u.message}'`)}return t.$$set=a=>{"currentRegionId"in a&&i(2,s=a.currentRegionId),"baseUrl"in a&&i(3,r=a.baseUrl)},[l,o,s,r]}class Rr extends de{constructor(e){super(),fe(this,e,Xo,Jo,ue,{currentRegionId:2,baseUrl:3})}}function Gn(t,e,i){const n=t.slice();return n[7]=e[i],n}function Qo(t){let e,i=t[3].regions,n=[];for(let s=0;s<i.length;s+=1)n[s]=Yn(Gn(t,i,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=he()},m(s,r){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(s,r);S(s,e,r)},p(s,r){if(r&9){i=s[3].regions;let l;for(l=0;l<i.length;l+=1){const o=Gn(s,i,l);n[l]?n[l].p(o,r):(n[l]=Yn(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(s){st(n,s),s&&k(e)}}}function Zo(t){let e,i;function n(l,o){if(o&4&&(e=null),e==null&&(e=!!["all","page"].includes(l[2])),e)return ta;if(l[2]==="similarity")return ea}let s=n(t,-1),r=s&&s(t);return{c(){r&&r.c(),i=he()},m(l,o){r&&r.m(l,o),S(l,i,o)},p(l,o){s===(s=n(l,o))&&r?r.p(l,o):(r&&r.d(1),r=s&&s(l),r&&(r.c(),r.m(i.parentNode,i)))},d(l){r&&r.d(l),l&&k(i)}}}function Yn(t){let e,i,n=t[7]+"",s,r;return{c(){e=b("a"),i=G("Regions extraction #"),s=G(n),m(e,"href",r=""+(t[0]+t[7])),m(e,"class","tag is-dark mr-3 is-rounded")},m(l,o){S(l,e,o),_(e,i),_(e,s)},p(l,o){o&1&&r!==(r=""+(l[0]+l[7]))&&m(e,"href",r)},d(l){l&&k(e)}}}function ea(t){let e,i,n;return{c(){e=b("button"),e.textContent=`${V==="en"?"Delete all regions similarity":"Supprimer toutes les similarités du document"}`,m(e,"class","tag is-danger")},m(s,r){S(s,e,r),i||(n=re(e,"click",t[6]),i=!0)},p:$,d(s){s&&k(e),i=!1,n()}}}function ta(t){let e,i,n,s,r,l;return{c(){e=b("a"),i=G("All regions"),n=N(),s=b("button"),s.textContent=`${V==="en"?"Delete regions extraction record":"Supprimer l'extraction de régions"}`,m(e,"href",t[4]),m(e,"class","tag is-dark mr-3 is-rounded"),m(s,"class","tag is-danger")},m(o,a){S(o,e,a),_(e,i),S(o,n,a),S(o,s,a),r||(l=re(s,"click",t[5]),r=!0)},p:$,d(o){o&&k(e),o&&k(n),o&&k(s),r=!1,l()}}}function ia(t){let e,i;function n(l,o){if(o&4&&(i=null),l[1])return Zo;if(i==null&&(i=!!["all","page","similarity"].includes(l[2])),i)return Qo}let s=n(t,-1),r=s&&s(t);return{c(){e=b("div"),r&&r.c()},m(l,o){S(l,e,o),r&&r.m(e,null)},p(l,[o]){s===(s=n(l,o))&&r?r.p(l,o):(r&&r.d(1),r=s&&s(l),r&&(r.c(),r.m(e,null)))},i:$,o:$,d(l){l&&k(e),r&&r.d()}}}function na(t,e,i){const n=Ae("witness");let{baseUrl:s=`${window.location.origin}${window.location.pathname}`}=e,{currentRegionId:r}=e,{activeTab:l}=e;const o=s.replace(/\/\d+\/?$/,"");async function a(){if(!await Me(V==="en"?"Are you sure you want to delete this record?":"Voulez-vous vraiment supprimer cet enregistrement ?",V==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof r!="number")throw new Error("Invalid region ID");const f=`${window.location.origin}/${$e}/regions/${r}/delete`;try{const d=await Dt(()=>fetch(f,{method:"DELETE",headers:{"X-CSRFToken":Ke}}));if(d.status!==204)throw new Error(`Failed to delete regions: '${d.statusText}'`);window.location.href=`${s.split("regions/")[0]}regions/`}catch(d){console.error(d)}}async function c(){if(!await Me(V==="en"?"Are you sure you want to delete all similarity scores for this document?":"Voulez-vous vraiment supprimer l'intégralité des scores de similarité pour ce document ?",V==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof r!="number")throw new Error("Invalid region ID");const f=`${window.location.origin}/${$e}/similarity/reset/${r}`;try{const d=await Dt(()=>fetch(f,{method:"DELETE",headers:{"X-CSRFToken":Ke}}));if(d.status===204||d.status===200)window.location.href=`${s.split("regions/")[0]}regions/`;else throw new Error(`Failed to delete similarity: '${d.statusText}'`)}catch(d){console.error(d),await Me(d.message,"Error")}}return t.$$set=u=>{"baseUrl"in u&&i(0,s=u.baseUrl),"currentRegionId"in u&&i(1,r=u.currentRegionId),"activeTab"in u&&i(2,l=u.activeTab)},[s,r,l,n,o,a,c]}class sa extends de{constructor(e){super(),fe(this,e,na,ia,ue,{baseUrl:0,currentRegionId:1,activeTab:2})}}function ra(t){let e;return{c(){e=Qe("path"),m(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),m(e,"class","svelte-h0t5l9")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function la(t){let e;return{c(){e=Qe("path"),m(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),m(e,"class","svelte-h0t5l9")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function oa(t){let e=V==="en"?"Edit":"Modifier",i;return{c(){i=G(e)},m(n,s){S(n,i,s)},p:$,d(n){n&&k(i)}}}function aa(t){let e=V==="en"?"Validate":"Valider",i;return{c(){i=G(e)},m(n,s){S(n,i,s)},p:$,d(n){n&&k(i)}}}function Jn(t){let e,i,n,s=V==="en"?"Reload":"Recharger",r,l,o,a,c,u=V==="en"?"Go to editor":"Aller à l'éditeur",f,d,h,p,g,v=V==="en"?"Delete selected regions":"Supprimer les régions sélectionnées",y,O,P;return{c(){e=b("button"),i=b("i"),n=N(),r=G(s),l=N(),o=b("a"),a=b("i"),c=N(),f=G(u),d=N(),h=b("button"),p=b("i"),g=N(),y=G(v),m(i,"class","fa-solid fa-rotate-right"),m(e,"class","tag is-link is-light is-rounded mr-3"),m(a,"class","fa-solid fa-edit"),m(o,"class","tag is-link is-rounded mr-3"),m(o,"href",Nt(t[4])),m(o,"target","_blank"),m(p,"class","fa-solid fa-trash"),m(h,"class","tag is-danger is-rounded")},m(C,T){S(C,e,T),_(e,i),_(e,n),_(e,r),S(C,l,T),S(C,o,T),_(o,a),_(o,c),_(o,f),S(C,d,T),S(C,h,T),_(h,p),_(h,g),_(h,y),O||(P=[re(e,"click",t[14]),re(h,"click",t[6])],O=!0)},p:$,d(C){C&&k(e),C&&k(l),C&&k(o),C&&k(d),C&&k(h),O=!1,Ie(P)}}}function ca(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g=V==="en"?"Download":"Télécharger",v,y,O,P,C;function T(L,H){return L[0]?la:ra}let j=T(t),F=j(t);function E(L,H){return L[0]?aa:oa}let D=E(t),Y=D(t),z=t[0]&&Jn(t);return{c(){e=b("div"),i=b("button"),n=Qe("svg"),F.c(),s=N(),Y.c(),l=N(),o=b("button"),a=b("i"),c=N(),u=b("span"),u.textContent=`${V==="en"?"Select all":"Tout sélectionner"}`,f=N(),d=b("button"),h=b("i"),p=N(),v=G(g),y=N(),O=b("div"),z&&z.c(),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"viewBox","0 0 384 512"),m(n,"class","pr-3 svelte-h0t5l9"),m(i,"class",r="button "+(t[0]?"is-success":"is-link")+" mr-3"),m(a,"class","fa-solid fa-square-check"),m(u,"id","all-selection"),m(o,"class","button is-link is-light mr-3"),m(h,"class","fa-solid fa-download"),m(d,"class","button is-link is-light"),m(e,"class","is-right mb-3"),m(O,"class","edit-action is-right svelte-h0t5l9")},m(L,H){S(L,e,H),_(e,i),_(i,n),F.m(n,null),_(i,s),Y.m(i,null),_(e,l),_(e,o),_(o,a),_(o,c),_(o,u),_(e,f),_(e,d),_(d,h),_(d,p),_(d,v),S(L,y,H),S(L,O,H),z&&z.m(O,null),P||(C=[re(i,"click",t[13]),re(o,"click",t[7]),re(d,"click",t[8])],P=!0)},p(L,[H]){j!==(j=T(L))&&(F.d(1),F=j(L),F&&(F.c(),F.m(n,null))),D===(D=E(L))&&Y?Y.p(L,H):(Y.d(1),Y=D(L),Y&&(Y.c(),Y.m(i,null))),H&1&&r!==(r="button "+(L[0]?"is-success":"is-link")+" mr-3")&&m(i,"class",r),L[0]?z?z.p(L,H):(z=Jn(L),z.c(),z.m(O,null)):z&&(z.d(1),z=null)},i:$,o:$,d(L){L&&k(e),F.d(),Y.d(),L&&k(y),L&&k(O),z&&z.d(),P=!1,Ie(C)}}}async function ua(t){const e=t.id_full,i=`${SAS_APP_URL}/annotation/destroy?uri=${e}`,n=await fetch(i,{method:"DELETE"});if(n.status!==204)throw new Error(`Failed to delete ${i} due to ${n.status}: '${n.statusText}'`)}function fa(t,e,i){let n,s,r,l,o,a,c;const{selected:u,nbSelected:f}=ht;oe(t,u,T=>i(11,a=T)),oe(t,f,T=>i(12,c=T));const{allRegions:d}=_t;oe(t,d,T=>i(10,o=T));const h=Ae("manifest"),p=Ae("isValidated");function g(){i(0,s=!s)}async function v(){if(await Me(V==="en"?"Are you sure you want to delete these regions?":"Voulez-vous vraiment supprimer ces régions ?",V==="en"?"Confirm deletion":"Confirmer la suppression",!0))for(const[j,F]of Object.entries(r))try{if(!o.hasOwnProperty(j))continue;await ua(F),_t.remove(j),ht.remove(j,Jt)}catch(E){await Me(`Failed to delete region ${j}: ${E.message}`,"Error")}}function y(){l?ht.removeAll(Object.keys(o),Jt):ht.addAll(Object.values(o))}async function O(){const T=Object.values(r).map(E=>E.ref),F=await(await Dt(()=>fetch(`${window.location.origin}/${$e}/regions/export`,{method:"POST",headers:{"X-CSRFToken":Ke},body:JSON.stringify({regionsRef:T})}))).blob();Or(F,"regions.zip")}const P=()=>g(),C=()=>location.reload();return t.$$.update=()=>{t.$$.dirty&4096&&i(9,n=c),t.$$.dirty&2048&&(r=Object.values(a)[0]||{}),t.$$.dirty&1536&&(l=n>=Object.keys(o).length)},i(0,s=!p),[s,u,f,d,h,g,v,y,O,n,o,a,c,P,C]}class da extends de{constructor(e){super(),fe(this,e,fa,ca,ue,{})}}function ha(){const t=`${window.location.origin}${window.location.pathname}`,e=25,i=window.location.pathname.match(/\d+/g).join("-"),n={[i]:{}},s=[2,6],r=Ee(1),l=Ee({}),o=Ee(JSON.parse(localStorage.getItem("selectedRegions"))||n);o.subscribe(L=>localStorage.setItem("selectedRegions",JSON.stringify(L)));const a=Ee(JSON.parse(localStorage.getItem("excludedCategories"))||[]);a.subscribe(L=>localStorage.setItem("excludedCategories",JSON.stringify(L)));const c=Ee(JSON.parse(localStorage.getItem("similarityScoreCutoff"))||void 0);c.subscribe(L=>{L!=null&&localStorage.setItem("similarityScoreCutoff",JSON.stringify(L))});const u=Ee(JSON.parse(localStorage.getItem("propagateRecursionDepth"))||s[1]);u.subscribe(L=>localStorage.setItem("propagateRecursionDepth",JSON.stringify(L)));const f=Ee(JSON.parse(localStorage.getItem("propagateFilterByRegions"))||!1);f.subscribe(L=>localStorage.setItem("propagateFilterByRegions",JSON.stringify(L)));const d=Be([u,f],([L,H])=>({propagateRecursionDepth:L,propagateFilterByRegions:H})),h=Be([a,o,c],([L,H,q])=>({excludedCategories:L,regions:H,similarityScoreCutoff:q})),p=Be([d,h],([L,H])=>({propagate:L,similarity:H})),g=Ee([]),v=Ee([]);async function y(){const L=async()=>{const K=await(await fetch(`${t}compared-regions`)).json();l.set(K),o.update(U=>{let se=U[i]||{};if(Object.keys(se).length){let J=Object.keys(se).filter(te=>Object.keys(K).includes(te)).reduce((te,ne)=>(te[ne]=se[ne],te),{});U[i]=J}return U})},H=async()=>{const K=await(await fetch(`${t}query-images`)).json();K.length>0&&(g.set(K),Y(F()))};Et.set(!0);try{await Promise.all([L(),H()])}catch(q){console.error("Error:",q),Sr.set(q.message)}finally{Et.set(!1)}}function O(L){localStorage.setItem("selectedRegions",JSON.stringify(L))}function P(L){o.update(H=>{const q={...H};return delete q[i][L],O(q),q})}function C(L){o.update(H=>{const q={...H,[i]:{...H[i]||{},[L.ref]:L}};return O(q),q})}const T=Be(o,L=>H=>{var q;return(q=L[i])==null?void 0:q.hasOwnProperty(H)});function j(L){const H=Zi(l),q=Object.keys(H).filter(K=>K.startsWith(L));return q.length!==1?{title:"Error"}:H[q[0]]}const F=()=>sn(r,"sp"),E=Be([r,g],([L,H])=>(async()=>D(L,H))());function D(L,H){const q=(L-1)*e,K=q+e,U=H.slice(q,K);return v.set(U),U}function Y(L){rn(L,r,"sp")}function z(L){l.update(H=>({...H,[L.ref]:L}))}return{currentPage:r,comparedRegions:l,excludedCategories:a,qImgs:g,pageQImgs:v,selectedRegions:o,propagateRecursionDepth:u,propagateFilterByRegions:f,similarityToolbarParams:p,propagateParams:d,similarityScoreCutoff:c,allowedPropagateDepthRange:s,fetchSimilarity:y,setPageQImgs:E,getRegionsInfo:j,handlePageUpdate:Y,unselect:P,select:C,addComparedRegions:z,isSelected:T,pageLength:e}}const ze=ha();function ma(t){let e,i,n;const s=t[1].default,r=Ge(s,t,t[0],null);return{c(){e=b("table"),i=b("tbody"),r&&r.c(),m(e,"class","table is-fullwidth")},m(l,o){S(l,e,o),_(e,i),r&&r.m(i,null),n=!0},p(l,[o]){r&&r.p&&(!n||o&1)&&Je(r,s,l,l[0],n?Ye(s,l[0],o,null):Xe(l[0]),null)},i(l){n||(M(r,l),n=!0)},o(l){R(r,l),n=!1},d(l){l&&k(e),r&&r.d(l)}}}function pa(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=r=>{"$$scope"in r&&i(0,s=r.$$scope)},[s,n]}class wi extends de{constructor(e){super(),fe(this,e,pa,ma,ue,{})}}function Xn(t){let e,i,n,s,r,l,o,a,c,u=t[5]>1&&Qn(t),f=t[5]<t[3]&&ts(t);return{c(){e=b("nav"),i=b("ul"),u&&u.c(),n=N(),s=b("li"),r=b("a"),l=G(t[5]),o=N(),f&&f.c(),m(r,"class","pagination-link is-current"),m(r,"href",null),m(i,"class","pagination-list ml-0"),m(e,"class","pagination is-centered mb-2"),m(e,"aria-label","pagination")},m(d,h){S(d,e,h),_(e,i),u&&u.m(i,null),_(i,n),_(i,s),_(s,r),_(r,l),_(i,o),f&&f.m(i,null),a||(c=re(r,"click",Ct(t[9])),a=!0)},p(d,h){d[5]>1?u?u.p(d,h):(u=Qn(d),u.c(),u.m(i,n)):u&&(u.d(1),u=null),h&32&&ce(l,d[5]),d[5]<d[3]?f?f.p(d,h):(f=ts(d),f.c(),f.m(i,null)):f&&(f.d(1),f=null)},d(d){d&&k(e),u&&u.d(),f&&f.d(),a=!1,c()}}}function Qn(t){let e,i,n,s,r,l,o=t[5]-1>1&&Zn(t);return{c(){e=b("li"),i=b("a"),i.textContent="1",n=N(),o&&o.c(),s=he(),m(i,"class","pagination-link"),m(i,"href",null)},m(a,c){S(a,e,c),_(e,i),S(a,n,c),o&&o.m(a,c),S(a,s,c),r||(l=re(i,"click",Ct(t[7])),r=!0)},p(a,c){a[5]-1>1?o?o.p(a,c):(o=Zn(a),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},d(a){a&&k(e),a&&k(n),o&&o.d(a),a&&k(s),r=!1,l()}}}function Zn(t){let e,i,n,s=t[5]-1+"",r,l,o,a=t[5]-1>2&&es();return{c(){a&&a.c(),e=N(),i=b("li"),n=b("a"),r=G(s),m(n,"class","pagination-link"),m(n,"href",null)},m(c,u){a&&a.m(c,u),S(c,e,u),S(c,i,u),_(i,n),_(n,r),l||(o=re(n,"click",Ct(t[8])),l=!0)},p(c,u){c[5]-1>2?a||(a=es(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),u&32&&s!==(s=c[5]-1+"")&&ce(r,s)},d(c){a&&a.d(c),c&&k(e),c&&k(i),l=!1,o()}}}function es(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function ts(t){let e,i,n,s,r,l,o=t[5]+1<t[3]&&is(t);return{c(){o&&o.c(),e=N(),i=b("li"),n=b("a"),s=G(t[3]),m(n,"class","pagination-link"),m(n,"href",null)},m(a,c){o&&o.m(a,c),S(a,e,c),S(a,i,c),_(i,n),_(n,s),r||(l=re(n,"click",Ct(t[11])),r=!0)},p(a,c){a[5]+1<a[3]?o?o.p(a,c):(o=is(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),c&8&&ce(s,a[3])},d(a){o&&o.d(a),a&&k(e),a&&k(i),r=!1,l()}}}function is(t){let e,i,n=t[5]+1+"",s,r,l,o,a,c=t[5]+2<t[3]&&ns();return{c(){e=b("li"),i=b("a"),s=G(n),r=N(),c&&c.c(),l=he(),m(i,"class","pagination-link"),m(i,"href",null)},m(u,f){S(u,e,f),_(e,i),_(i,s),S(u,r,f),c&&c.m(u,f),S(u,l,f),o||(a=re(i,"click",Ct(t[10])),o=!0)},p(u,f){f&32&&n!==(n=u[5]+1+"")&&ce(s,n),u[5]+2<u[3]?c||(c=ns(),c.c(),c.m(l.parentNode,l)):c&&(c.d(1),c=null)},d(u){u&&k(e),u&&k(r),c&&c.d(u),u&&k(l),o=!1,a()}}}function ns(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function ga(t){let e,i,n=t[5]*t[2]-t[2]+1+"",s,r,l=Math.min(t[5]*t[2],t[1])+"",o,a,c,u,f=t[4]&&Xn(t);return{c(){f&&f.c(),e=N(),i=b("div"),s=G(n),r=G(" - "),o=G(l),a=G(" / "),c=G(t[1]),m(i,"class",u="is-size-7 is-center mb-4 "+(t[4]?"":"mt-4"))},m(d,h){f&&f.m(d,h),S(d,e,h),S(d,i,h),_(i,s),_(i,r),_(i,o),_(i,a),_(i,c)},p(d,[h]){d[4]?f?f.p(d,h):(f=Xn(d),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),h&36&&n!==(n=d[5]*d[2]-d[2]+1+"")&&ce(s,n),h&38&&l!==(l=Math.min(d[5]*d[2],d[1])+"")&&ce(o,l),h&2&&ce(c,d[1]),h&16&&u!==(u="is-size-7 is-center mb-4 "+(d[4]?"":"mt-4"))&&m(i,"class",u)},i:$,o:$,d(d){f&&f.d(d),d&&k(e),d&&k(i)}}}function _a(t,e,i){let n,s,r,{store:l}=e;const{currentPage:o}=l;oe(t,o,g=>i(5,r=g));let{nbOfItems:a}=e,{pageLength:c=ao}=e;const u=()=>l.handlePageUpdate(1),f=()=>l.handlePageUpdate(r-1),d=()=>l.handlePageUpdate(r),h=()=>l.handlePageUpdate(r+1),p=()=>l.handlePageUpdate(n);return t.$$set=g=>{"store"in g&&i(0,l=g.store),"nbOfItems"in g&&i(1,a=g.nbOfItems),"pageLength"in g&&i(2,c=g.pageLength)},t.$$.update=()=>{t.$$.dirty&6&&i(3,n=c>0?Math.ceil(a/c):1),t.$$.dirty&14&&i(4,s=n>1||a>c)},[l,a,c,n,s,r,o,u,f,d,h,p]}class jt extends de{constructor(e){super(),fe(this,e,_a,ga,ue,{store:0,nbOfItems:1,pageLength:2})}}const Dr=(t,e,i,n)=>({id:t,img:t,title:`Canvas ${n} - ${i} - ${V==="en"?"Witness":"Témoin"} #${Er(e)}`,xywh:i.split(",").map(Number),canvas:n,ref:t.replace(".jpg",""),type:Jt}),va=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,Nr=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">
        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>
    </svg>`,jr=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">
        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,$r=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">
        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,Fr=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,Ur=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>
    </svg>`,ba=V==="en"?"no categorization":"aucune catégorisation",Vr=V==="en"?"overall visual matches":"correspondances visuelles globales",Hr=V==="en"?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",Br=V==="en"?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",zr=V==="en"?"regions without match":"régions sans correspondance",qr=V==="en"?"user specific category":"correspondances spécifiques à l'utilisateur",ri={0:{title:ba,svg:va},1:{title:Vr,svg:Nr},2:{title:Hr,svg:jr},3:{title:Br,svg:$r},4:{title:zr,svg:Fr},5:{title:qr,svg:Ur}};function wa(t){let e,i=ri[t[2]].svg+"",n,s,r,l;return{c(){e=b("span"),m(e,"class",n="tag py-4 "+t[4]+" "+(t[0]?"is-hoverable":"")),m(e,"title",s=ri[t[2]].title),qe(e,"is-selected",t[1])},m(o,a){S(o,e,a),e.innerHTML=i,r||(l=[re(e,"click",t[5]),re(e,"keyup",null)],r=!0)},p(o,[a]){a&4&&i!==(i=ri[o[2]].svg+"")&&(e.innerHTML=i),a&17&&n!==(n="tag py-4 "+o[4]+" "+(o[0]?"is-hoverable":""))&&m(e,"class",n),a&4&&s!==(s=ri[o[2]].title)&&m(e,"title",s),a&19&&qe(e,"is-selected",o[1])},i:$,o:$,d(o){o&&k(e),r=!1,Ie(l)}}}function ya(t,e,i){let{selectable:n=!0}=e,{isSelected:s=!1}=e,{category:r}=e,{toggle:l=()=>{}}=e,{padding:o="px-2"}=e;const a=()=>l(r);return t.$$set=c=>{"selectable"in c&&i(0,n=c.selectable),"isSelected"in c&&i(1,s=c.isSelected),"category"in c&&i(2,r=c.category),"toggle"in c&&i(3,l=c.toggle),"padding"in c&&i(4,o=c.padding)},[n,s,r,l,o,a]}class qt extends de{constructor(e){super(),fe(this,e,ya,wa,ue,{selectable:0,isSelected:1,category:2,toggle:3,padding:4})}}function ka(t){let e,i,n,s,r,l,o,a,c,u,f;return i=new qt({props:{category:1,isSelected:t[0]===1,toggle:t[4],padding:"pl-3 pr-2"}}),s=new qt({props:{category:2,isSelected:t[0]===2,toggle:t[4]}}),l=new qt({props:{category:3,isSelected:t[0]===3,toggle:t[4]}}),a=new qt({props:{category:4,isSelected:t[0]===4,toggle:t[4]}}),u=new qt({props:{category:5,isSelected:t[0]===5,toggle:t[4],padding:"pl-2 pr-3"}}),{c(){e=b("div"),ee(i.$$.fragment),n=N(),ee(s.$$.fragment),r=N(),ee(l.$$.fragment),o=N(),ee(a.$$.fragment),c=N(),ee(u.$$.fragment),m(e,"class","tags has-addons is-dark is-center")},m(d,h){S(d,e,h),Q(i,e,null),_(e,n),Q(s,e,null),_(e,r),Q(l,e,null),_(e,o),Q(a,e,null),_(e,c),Q(u,e,null),f=!0},p(d,h){const p={};h&1&&(p.isSelected=d[0]===1),i.$set(p);const g={};h&1&&(g.isSelected=d[0]===2),s.$set(g);const v={};h&1&&(v.isSelected=d[0]===3),l.$set(v);const y={};h&1&&(y.isSelected=d[0]===4),a.$set(y);const O={};h&1&&(O.isSelected=d[0]===5),u.$set(O)},i(d){f||(M(i.$$.fragment,d),M(s.$$.fragment,d),M(l.$$.fragment,d),M(a.$$.fragment,d),M(u.$$.fragment,d),f=!0)},o(d){R(i.$$.fragment,d),R(s.$$.fragment,d),R(l.$$.fragment,d),R(a.$$.fragment,d),R(u.$$.fragment,d),f=!1},d(d){d&&k(e),Z(i),Z(s),Z(l),Z(a),Z(u)}}}function Sa(t){let e,i,n,s;i=new an({props:{item:t[3],size:256,selectable:!1,isSquare:!1}});let r=!t[2]&&ka(t);return{c(){e=b("div"),ee(i.$$.fragment),n=N(),r&&r.c()},m(l,o){S(l,e,o),Q(i,e,null),_(e,n),r&&r.m(e,null),s=!0},p(l,[o]){l[2]||r.p(l,o)},i(l){s||(M(i.$$.fragment,l),M(r),s=!0)},o(l){R(i.$$.fragment,l),R(r),s=!1},d(l){l&&k(e),Z(i),r&&r.d()}}}function Ea(t,e,i){let n,s,r;const{comparedRegions:l}=ze;oe(t,l,H=>i(15,r=H));const o=new URL(window.location.href),a=o.origin;o.pathname;let{qImg:c}=e,{sImg:u}=e,{qRegions:f}=e,{sRegions:d}=e,{score:h=0}=e,{category:p=null}=e,{users:g=[]}=e,{isManual:v}=e,{similarityType:y}=e;const O=Ae("isInModal")||!1,[P,C,T,j]=u.split(".")[0].split("_"),E=(()=>{let H=Dr(u,P,j,T);const q=r[`${P}_${C}_anno${d}`]||{title:H.title};return H.title=`${Cr(q.title.replace(/^[^|]+/,""))}<br/>Page ${uo(T)}<br/><b>Score: ${h}</b>`,H})();lt("similarityPair",{qImg:c,sImg:u,qRegions:f,sRegions:d,score:h,category:p,users:g,isManual:v,similarityType:y});function D(H){H=H.slice();let q=H.indexOf(Number(ci));return s&&q===-1?H.push(Number(ci)):!s&&q!==-1&&H.splice(q,1),H}const Y=()=>({img_1:c,img_2:u,regions_id_1:f,regions_id_2:d,score:h,category:n,category_x:D(g),similarity_type:y});function z(H){H===5?s=!s:i(0,n=n===H?null:H)}async function L(H){z(H);try{(await fetch(`${a}/${$e}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify(Y())})).ok||(console.error("Error: Network response was not ok"),z(H))}catch(q){console.error("Error:",q),z(H)}}return t.$$set=H=>{"qImg"in H&&i(5,c=H.qImg),"sImg"in H&&i(6,u=H.sImg),"qRegions"in H&&i(7,f=H.qRegions),"sRegions"in H&&i(8,d=H.sRegions),"score"in H&&i(9,h=H.score),"category"in H&&i(10,p=H.category),"users"in H&&i(11,g=H.users),"isManual"in H&&i(12,v=H.isManual),"similarityType"in H&&i(13,y=H.similarityType)},t.$$.update=()=>{t.$$.dirty&1024&&i(0,n=p),t.$$.dirty&2048&&(s=g.includes(Number(ci))||!1)},[n,l,O,E,L,c,u,f,d,h,p,g,v,y]}class Ca extends de{constructor(e){super(),fe(this,e,Ea,Sa,ue,{qImg:5,sImg:6,qRegions:7,sRegions:8,score:9,category:10,users:11,isManual:12,similarityType:13})}}function ss(t,e,i){const n=t.slice();return n[22]=e[i].uuid,n[23]=e[i].data[0],n[24]=e[i].data[1],n[25]=e[i].data[2],n[26]=e[i].data[3],n[27]=e[i].data[4],n[28]=e[i].data[5],n[29]=e[i].data[6],n[30]=e[i].data[7],n[31]=e[i].data[8],n}function Ia(t){let e,i=V==="en"?`Error when retrieving similar regions: ${t[2]}`:`Erreur de recupération des régions similaires: ${t[2]}`,n;return{c(){e=b("div"),n=G(i),m(e,"class","faded is-center")},m(s,r){S(s,e,r),_(e,n)},p(s,r){r[0]&4&&i!==(i=V==="en"?`Error when retrieving similar regions: ${s[2]}`:`Erreur de recupération des régions similaires: ${s[2]}`)&&ce(n,i)},i:$,o:$,d(s){s&&k(e)}}}function Oa(t){let e,i,n=t[4].length+"",s,r,l=t[11](t[10],t[4].length)+"",o,a,c,u=[],f=new Map,d,h=t[4];const p=v=>v[22];for(let v=0;v<h.length;v+=1){let y=ss(t,h,v),O=p(y);f.set(O,u[v]=ls(O,y))}let g=null;return h.length||(g=rs(t)),{c(){e=b("div"),i=b("span"),s=G(n),r=N(),o=G(l),a=N(),c=b("div");for(let v=0;v<u.length;v+=1)u[v].c();g&&g.c(),m(i,"class","m-2"),m(c,"class","m-2 is-gap-2"),qe(c,"grid",t[4].length>0)},m(v,y){S(v,e,y),_(e,i),_(i,s),_(i,r),_(i,o),_(e,a),_(e,c);for(let O=0;O<u.length;O+=1)u[O]&&u[O].m(c,null);g&&g.m(c,null),d=!0},p(v,y){(!d||y[0]&16)&&n!==(n=v[4].length+"")&&ce(s,n),(!d||y[0]&16)&&l!==(l=v[11](v[10],v[4].length)+"")&&ce(o,l),y[0]&49&&(h=v[4],_e(),u=Ut(u,y,p,1,v,h,f,c,Zt,ls,null,ss),ve(),!h.length&&g?g.p(v,y):h.length?g&&(g.d(1),g=null):(g=rs(v),g.c(),g.m(c,null))),(!d||y[0]&16)&&qe(c,"grid",v[4].length>0)},i(v){if(!d){for(let y=0;y<h.length;y+=1)M(u[y]);d=!0}},o(v){for(let y=0;y<u.length;y+=1)R(u[y]);d=!1},d(v){v&&k(e);for(let y=0;y<u.length;y+=1)u[y].d();g&&g.d()}}}function Aa(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"&&!t[10]?"Retrieving similar regions...":V==="fr"&&!t[10]?"Récupération des régions similaires...":V==="en"&&t[10]?"Retrieving propagated regions...":"Récupération de similarités propagées..."}`,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,i:$,o:$,d(i){i&&k(e)}}}function rs(t){let e;function i(r,l){return r[5]?Pa:Ta}let n=i(t),s=n(t);return{c(){s.c(),e=he()},m(r,l){s.m(r,l),S(r,e,l)},p(r,l){n===(n=i(r))&&s?s.p(r,l):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&k(e)}}}function Ta(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"No similar regions":"Pas de régions similaires"}
                    `,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,d(i){i&&k(e)}}}function Pa(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"No document selected. Select one to display results.":"Aucun document sélectionné. Sélectionnez-en un pour afficher les résultats."}
                    `,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,d(i){i&&k(e)}}}function ls(t,e){let i,n,s;return n=new Ca({props:{qImg:e[0],sImg:e[25],score:e[23],qRegions:e[26],sRegions:e[27],category:e[28],users:e[29],isManual:e[30],similarityType:e[31]}}),{key:t,first:null,c(){i=he(),ee(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),Q(n,r,l),s=!0},p(r,l){e=r;const o={};l[0]&1&&(o.qImg=e[0]),l[0]&16&&(o.sImg=e[25]),l[0]&16&&(o.score=e[23]),l[0]&16&&(o.qRegions=e[26]),l[0]&16&&(o.sRegions=e[27]),l[0]&16&&(o.category=e[28]),l[0]&16&&(o.users=e[29]),l[0]&16&&(o.isManual=e[30]),l[0]&16&&(o.similarityType=e[31]),n.$set(o)},i(r){s||(M(n.$$.fragment,r),s=!0)},o(r){R(n.$$.fragment,r),s=!1},d(r){r&&k(i),Z(n,r)}}}function La(t){let e,i,n,s;const r=[Aa,Oa,Ia],l=[];function o(a,c){return a[1]&&a[3]==="loading"?0:a[3]==="loaded"?1:a[3]==="error"?2:-1}return~(e=o(t))&&(i=l[e]=r[e](t)),{c(){i&&i.c(),n=he()},m(a,c){~e&&l[e].m(a,c),S(a,n,c),s=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(i&&(_e(),R(l[u],1,1,()=>{l[u]=null}),ve()),~e?(i=l[e],i?i.p(a,c):(i=l[e]=r[e](a),i.c()),M(i,1),i.m(n.parentNode,n)):i=null)},i(a){s||(M(i),s=!0)},o(a){R(i),s=!1},d(a){~e&&l[e].d(a),a&&k(n)}}}function Ma(t,e,i){let n,s,r,l,o,a,c,u,{qImg:f}=e,{sImgsPromise:d}=e;const{selectedRegions:h,excludedCategories:p,similarityScoreCutoff:g,propagateFilterByRegions:v}=ze;oe(t,h,D=>i(16,u=D)),oe(t,p,D=>i(15,c=D)),oe(t,g,D=>i(14,a=D)),oe(t,v,D=>i(13,o=D));const y=Ae("similarityPropagatedContext")||!1,O=window.location.pathname.match(/\d+/g).join("-");let P;const C=(D,Y)=>D===null||Y===void 0||Number(D)>=Y,T=(D,Y,z)=>!z.includes(D),j=(D,Y,z,L,H,q)=>y?!0:C(D,H)&&T(Y,z,L),F=(D,Y,z,L)=>D.filter(({uuid:H,data:[q,K,U,se,J,te,ne,be,ke]})=>j(q,te,ne,Y,z)),E=(D,Y)=>{const z=Y>1;return D?V==="fr"?z?"similarités propagées":"similarité propagée":z?"propagated matches":"propagated match":V==="fr"?z?"images similaires":"image similaire":z?"similar images":"similar image"};return t.$$set=D=>{"qImg"in D&&i(0,f=D.qImg),"sImgsPromise"in D&&i(1,d=D.sImgsPromise)},t.$$.update=()=>{t.$$.dirty[0]&65536&&i(5,n=Object.values(u).length===0||u[O]===void 0||!Object.keys(u[O]).length),t.$$.dirty[0]&2&&(D=>{i(3,s="loading"),i(4,l=[]),i(12,r=[])})(),t.$$.dirty[0]&2&&d.then(D=>{i(12,r=D.map(Y=>({uuid:window.crypto.randomUUID(),data:Y}))),i(3,s="loaded")}).catch(D=>{i(2,P=D),i(3,s="error")}),t.$$.dirty[0]&61440&&i(4,l=F(r,c,a))},i(3,s="loading"),i(12,r=[]),[f,d,P,s,l,n,h,p,g,v,y,E,r,o,a,c,u]}class Kr extends de{constructor(e){super(),fe(this,e,Ma,La,ue,{qImg:0,sImgsPromise:1},null,[-1,-1])}}function Ra(t){let e,i;return e=new Kr({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,[s]){const r={};s&1&&(r.qImg=n[0]),s&2&&(r.sImgsPromise=n[1]),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Da(t,e,i){let n,s,{qImg:r}=e,l;const o=Ae("isInModal")||!1,{selectedRegions:a,comparedRegions:c}=ze;oe(t,a,p=>i(4,n=p)),oe(t,c,p=>i(5,s=p));const u=`${window.location.origin}${window.location.pathname}`,f=window.location.pathname.match(/\d+/g).join("-"),d=(p,g)=>g?Object.keys(s).map(v=>s[v].id):Object.values(p[f]||{}).map(v=>v.id);async function h(p,g,v){const y=d(g,v);return y.length===0?[]:await(await fetch(`${u}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:y,qImg:p,topk:12}),headers:{"Content-Type":"application/json","X-CSRFToken":Ke}})).json()}return o?l=h(r,n,o):a.subscribe(p=>{i(1,l=h(r,p,o))}),t.$$set=p=>{"qImg"in p&&i(0,r=p.qImg)},[r,l,a,c]}class Na extends de{constructor(e){super(),fe(this,e,Da,Ra,ue,{qImg:0})}}function ja(t){let e,i,n,s;return n=new Kr({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){e=b("div"),i=b("div"),ee(n.$$.fragment),m(i,"class","matches-suggestion svelte-1cb4wg0"),m(e,"class","block matches-suggestion-wrapper svelte-1cb4wg0")},m(r,l){S(r,e,l),_(e,i),Q(n,i,null),s=!0},p(r,[l]){const o={};l&1&&(o.qImg=r[0]),l&2&&(o.sImgsPromise=r[1]),n.$set(o)},i(r){s||(M(n.$$.fragment,r),s=!0)},o(r){R(n.$$.fragment,r),s=!1},d(r){r&&k(e),Z(n)}}}function $a(t,e,i){let n,s,{qImg:r}=e;const{propagateParams:l,selectedRegions:o}=ze;oe(t,l,v=>i(4,n=v)),oe(t,o,v=>i(5,s=v));const a=`${window.location.origin}${window.location.pathname}`,c=window.location.pathname.match(/\d+/g).join("-"),u=Ae("isInModal")||!1;let f;const d=pi();d.setCompareFn((v,y)=>[v,y].every(O=>O&&O.hasOwnProperty("propagateRecursionDepth")&&O.hasOwnProperty("propagateFilterByRegions"))?v.propagateRecursionDepth===y.propagateRecursionDepth&&v.propagateFilterByRegions===y.propagateFilterByRegions:!1);const h=pi();h.setCompareFn(ln),lt("similarityPropagatedContext",!0);const p=v=>Object.keys(v).includes(c)?Object.values(v[c]).map(y=>y.id):[],g=async(v,y,O)=>fetch(`${a}propagated-matches/${r}`,{method:"POST",body:JSON.stringify({regionsIds:O?[]:y,filterByRegions:O?!1:v.propagateFilterByRegions,recursionDepth:v.propagateRecursionDepth}),headers:{"Content-Type":"application/json","X-CSRFToken":Ke}}).then(P=>P.json()).catch(P=>(console.error("PropagatedMatches.getPropagatedMatches:",P),[]));return l.subscribe(v=>{d.set(v),d.same()||i(1,f=g(d.get(),p(s),u))}),o.subscribe(v=>{h.set(p(v)),n.propagateFilterByRegions===!0&&!h.same()&&i(1,f=g(n,h.get(),u))}),t.$$set=v=>{"qImg"in v&&i(0,r=v.qImg)},[r,f,l,o]}class Fa extends de{constructor(e){super(),fe(this,e,$a,ja,ue,{qImg:0})}}const Ua=t=>({}),os=t=>({}),Va=t=>({}),as=t=>({}),Ha=t=>({}),cs=t=>({});function Ba(t){let e;const i=t[4]["row-body"],n=Ge(i,t,t[3],os);return{c(){n&&n.c()},m(s,r){n&&n.m(s,r),e=!0},p(s,r){n&&n.p&&(!e||r&8)&&Je(n,i,s,s[3],e?Ye(i,s[3],r,Ua):Xe(s[3]),os)},i(s){e||(M(n,s),e=!0)},o(s){R(n,s),e=!1},d(s){n&&n.d(s)}}}function za(t){let e,i,n,s;const r=t[4]["row-body"],l=Ge(r,t,t[3],as);return{c(){e=b("div"),i=b("div"),l&&l.c(),m(i,"class","grid is-gap-2"),m(e,"class",n="fixed-grid has-"+t[2]+"-cols")},m(o,a){S(o,e,a),_(e,i),l&&l.m(i,null),s=!0},p(o,a){l&&l.p&&(!s||a&8)&&Je(l,r,o,o[3],s?Ye(r,o[3],a,Va):Xe(o[3]),as),(!s||a&4&&n!==(n="fixed-grid has-"+o[2]+"-cols"))&&m(e,"class",n)},i(o){s||(M(l,o),s=!0)},o(o){R(l,o),s=!1},d(o){o&&k(e),l&&l.d(o)}}}function qa(t){let e,i,n,s,r,l,o,a,c,u;Ze(t[5]);const f=t[4]["row-header"],d=Ge(f,t,t[3],cs),h=[za,Ba],p=[];function g(v,y){return v[0]?0:1}return l=g(t),o=p[l]=h[l](t),{c(){e=b("tr"),i=b("th"),n=b("div"),d&&d.c(),s=N(),r=b("td"),o.c(),m(n,"class","content-wrapper py-5"),m(i,"class","is-3 center-flex is-narrow"),je(i,"width","15vw"),m(r,"class","p-5 is-fullwidth")},m(v,y){S(v,e,y),_(e,i),_(i,n),d&&d.m(n,null),_(e,s),_(e,r),p[l].m(r,null),a=!0,c||(u=re(window,"resize",t[5]),c=!0)},p(v,[y]){d&&d.p&&(!a||y&8)&&Je(d,f,v,v[3],a?Ye(f,v[3],y,Ha):Xe(v[3]),cs);let O=l;l=g(v),l===O?p[l].p(v,y):(_e(),R(p[O],1,1,()=>{p[O]=null}),ve(),o=p[l],o?o.p(v,y):(o=p[l]=h[l](v),o.c()),M(o,1),o.m(r,null))},i(v){a||(M(d,v),M(o),a=!0)},o(v){R(d,v),R(o),a=!1},d(v){v&&k(e),d&&d.d(v),p[l].d(),c=!1,u()}}}function Ka(t,e,i){let n,{$$slots:s={},$$scope:r}=e,{useGrid:l=!0}=e,o=0;function a(){i(1,o=window.innerWidth)}return t.$$set=c=>{"useGrid"in c&&i(0,l=c.useGrid),"$$scope"in c&&i(3,r=c.$$scope)},t.$$.update=()=>{t.$$.dirty&2&&i(2,n=Ar(o))},[l,o,n,r,s,a]}class xr extends de{constructor(e){super(),fe(this,e,Ka,qa,ue,{useGrid:0})}}function xa(t){let e,i,n,s=parseInt(t[5])+"",r,l,o,a,c,u,f,d,h,p,g,v,y,O,P,C,T,j,F;return{c(){e=b("a"),i=b("i"),n=G(`
            Page `),r=G(s),l=N(),o=b("img"),c=N(),u=b("div"),f=b("div"),d=b("input"),h=N(),p=b("button"),p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',g=N(),v=b("button"),y=Qe("svg"),O=Qe("path"),m(i,"class","fa-solid fa-pen-to-square"),m(e,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),m(e,"href",Nt(t[6],parseInt(t[5]))),m(e,"target","_blank"),We(o.src,a=gt(t[0],t[0].split("_").pop(),"250,"))||m(o,"src",a),m(o,"alt","Query region"),m(o,"class","mb-3 card query-image svelte-f4ylwc"),m(d,"class","input is-small tag"),m(d,"type","text"),m(d,"placeholder",V==="en"?"Add new match":"Ajouter une correspondance"),m(p,"class","button is-small tag is-link is-center"),m(f,"class","tags has-addons"),je(f,"flex-wrap","nowrap"),m(O,"fill","white"),m(O,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),m(y,"xmlns","http://www.w3.org/2000/svg"),m(y,"viewBox","0 0 384 512"),m(v,"id","no-match"),m(v,"class",P="button is-small tag is-danger is-center m-0 "+(t[3]===1?"visible":"")+" svelte-f4ylwc"),m(v,"title",V==="en"?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),m(u,"class","new-similarity control pt-2 is-center svelte-f4ylwc")},m(E,D){S(E,e,D),_(e,i),_(e,n),_(e,r),S(E,l,D),S(E,o,D),S(E,c,D),S(E,u,D),_(u,f),_(f,d),Mt(d,t[1]),_(f,h),_(f,p),_(u,g),_(u,v),_(v,y),_(y,O),T=!0,j||(F=[re(d,"input",t[12]),re(p,"click",t[8]),re(v,"click",t[9])],j=!0)},p(E,D){(!T||D&1&&!We(o.src,a=gt(E[0],E[0].split("_").pop(),"250,")))&&m(o,"src",a),D&2&&d.value!==E[1]&&Mt(d,E[1]),(!T||D&8&&P!==(P="button is-small tag is-danger is-center m-0 "+(E[3]===1?"visible":"")+" svelte-f4ylwc"))&&m(v,"class",P)},i(E){T||(Ze(()=>{T&&(C||(C=nt(v,pt,{duration:500},!0)),C.run(1))}),T=!0)},o(E){C||(C=nt(v,pt,{duration:500},!1)),C.run(0),T=!1},d(E){E&&k(e),E&&k(l),E&&k(o),E&&k(c),E&&k(u),E&&C&&C.end(),j=!1,Ie(F)}}}function Wa(t){let e,i,n,s,r,l,o,a;return i=new Na({props:{qImg:t[0]}}),l=new Fa({props:{qImg:t[0]}}),{c(){e=b("div"),ee(i.$$.fragment),s=N(),r=b("div"),ee(l.$$.fragment),m(e,"class",n=si(t[7]?"":t[2])+" svelte-f4ylwc"),m(r,"class",o=si(t[7]?"":t[2])+" svelte-f4ylwc")},m(c,u){S(c,e,u),Q(i,e,null),S(c,s,u),S(c,r,u),Q(l,r,null),a=!0},p(c,u){const f={};u&1&&(f.qImg=c[0]),i.$set(f),(!a||u&4&&n!==(n=si(c[7]?"":c[2])+" svelte-f4ylwc"))&&m(e,"class",n);const d={};u&1&&(d.qImg=c[0]),l.$set(d),(!a||u&4&&o!==(o=si(c[7]?"":c[2])+" svelte-f4ylwc"))&&m(r,"class",o)},i(c){a||(M(i.$$.fragment,c),M(l.$$.fragment,c),a=!0)},o(c){R(i.$$.fragment,c),R(l.$$.fragment,c),a=!1},d(c){c&&k(e),Z(i),c&&k(s),c&&k(r),Z(l)}}}function Ga(t){let e,i;return e=new xr({props:{useGrid:!1,$$slots:{"row-body":[Wa],"row-header":[xa]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,[s]){const r={};s&1048591&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Ya(t){return t=t.replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(t)}function Ja(t,e,i){let n,s,r,l;const{selectedRegions:o}=ze;oe(t,o,j=>i(11,l=j));let{qImg:a}=e,c="";const[u,f,d,h]=a.split(".")[0].split("_"),p=`${window.location.origin}${window.location.pathname}`,g=window.location.pathname.match(/\d+/g).join("-"),v=V==="en"?"Error":"Erreur",y=Ae("manifest"),O=Ae("isInModal")||!1;lt("qImgMetadata",Dr(a,u,h,d));async function P(){if(!c||!Ya(c)){await Me(V==="en"?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error");return}try{const j=await fetch(`${p}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify({q_img:a.replace(".jpg",""),s_img:c,similarity_type:2})});j.ok||(console.error("Error: Network response was not ok"),await Me(V==="en"?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",v));const F=await j.json();if(F.hasOwnProperty("error")||!F.hasOwnProperty("s_regions")){await Me(V==="en"?`Request was unsuccessful, match was not added:<br>${F.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${F.error}`,v);return}const E=F.s_regions;ze.addComparedRegions(E),ze.select(E)}catch(j){console.error("Error:",j),await Me(V==="en"?`An error has occurred, match was not added:<br>${j}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${j}`,v)}}async function C(){const j=Object.values(l[g])[0];if(await Me(V==="en"?`Do you confirm this region does not have any match in ${j.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${j.title} ?`,V==="en"?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${p}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify({q_img:a,s_regions:j.id})})).ok||(console.error("Error: Network response was not ok"),await Me(V==="en"?"Problem with network":"Problème de réseau",v)),ze.select(j)}catch(E){console.error("Error:",E),await Me(V==="en"?`An error has occurred, request was unsuccessful:<br>${E}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${E}`,v)}}function T(){c=this.value,i(1,c)}return t.$$set=j=>{"qImg"in j&&i(0,a=j.qImg)},t.$$.update=()=>{t.$$.dirty&2048&&i(3,n=l.hasOwnProperty(g)?Object.values(l[g]).length:0),t.$$.dirty&1024&&i(2,r=`fixed-grid has-${s-1}-cols`)},i(10,s=Ar(window.innerWidth)),[a,c,r,n,o,d,y,O,P,C,s,l,T]}class Xa extends de{constructor(e){super(),fe(this,e,Ja,Ga,ue,{qImg:0})}}function us(t,e,i){const n=t.slice();return n[8]=e[i],n}function Qa(t){let e,i,n=t[11]+"",s;return{c(){e=b("tr"),i=G("Error when retrieving similar regions: "),s=G(n)},m(r,l){S(r,e,l),_(e,i),_(e,s)},p(r,l){l&2&&n!==(n=r[11]+"")&&ce(s,n)},i:$,o:$,d(r){r&&k(e)}}}function Za(t){let e=[],i=new Map,n,s,r=t[2];const l=a=>a[8].id;for(let a=0;a<r.length;a+=1){let c=us(t,r,a),u=l(c);i.set(u,e[a]=ds(u,c))}let o=null;return r.length||(o=fs()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);S(a,n,c),o&&o.m(a,c),s=!0},p(a,c){c&4&&(r=a[2],_e(),e=Ut(e,c,l,1,a,r,i,n.parentNode,Zt,ds,n,us),ve(),!r.length&&o?o.p(a,c):r.length?o&&(o.d(1),o=null):(o=fs(),o.c(),o.m(n.parentNode,n)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)M(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)R(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),o&&o.d(a)}}}function fs(t){let e,i;return{c(){e=b("tr"),e.textContent=`${V==="en"?"No similarity":"Pas de similarités"}`,i=N(),m(e,"class","faded is-center")},m(n,s){S(n,e,s),S(n,i,s)},p:$,d(n){n&&k(e),n&&k(i)}}}function ds(t,e){let i,n,s;return n=new Xa({props:{qImg:e[8]}}),{key:t,first:null,c(){i=he(),ee(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),Q(n,r,l),s=!0},p(r,l){e=r;const o={};l&4&&(o.qImg=e[8]),n.$set(o)},i(r){s||(M(n.$$.fragment,r),s=!0)},o(r){R(n.$$.fragment,r),s=!1},d(r){r&&k(i),Z(n,r)}}}function ec(t){let e;return{c(){e=b("tr"),e.textContent=`${V==="en"?"Retrieving similarity page...":"Récupération la page de similarité..."}`,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,i:$,o:$,d(i){i&&k(e)}}}function tc(t){let e,i,n,s={ctx:t,current:null,token:null,hasCatch:!0,pending:ec,then:Za,catch:Qa,value:7,error:11,blocks:[,,,]};return ct(i=t[1],s),{c(){e=he(),s.block.c()},m(r,l){S(r,e,l),s.block.m(r,s.anchor=l),s.mount=()=>e.parentNode,s.anchor=e,n=!0},p(r,l){t=r,s.ctx=t,l&2&&i!==(i=t[1])&&ct(i,s)||Ft(s,t,l)},i(r){n||(M(s.block),n=!0)},o(r){for(let l=0;l<3;l+=1){const o=s.blocks[l];R(o)}n=!1},d(r){r&&k(e),s.block.d(r),s.token=null,s=null}}}function ic(t){let e,i,n,s,r,l,o;return i=new jt({props:{store:ze,nbOfItems:t[0].length,pageLength:t[6]}}),s=new wi({props:{$$slots:{default:[tc]},$$scope:{ctx:t}}}),l=new jt({props:{store:ze,nbOfItems:t[0].length,pageLength:t[6]}}),{c(){e=b("div"),ee(i.$$.fragment),n=N(),ee(s.$$.fragment),r=N(),ee(l.$$.fragment)},m(a,c){S(a,e,c),Q(i,e,null),_(e,n),Q(s,e,null),_(e,r),Q(l,e,null),o=!0},p(a,[c]){const u={};c&1&&(u.nbOfItems=a[0].length),i.$set(u);const f={};c&4102&&(f.$$scope={dirty:c,ctx:a}),s.$set(f);const d={};c&1&&(d.nbOfItems=a[0].length),l.$set(d)},i(a){o||(M(i.$$.fragment,a),M(s.$$.fragment,a),M(l.$$.fragment,a),o=!0)},o(a){R(i.$$.fragment,a),R(s.$$.fragment,a),R(l.$$.fragment,a),o=!1},d(a){a&&k(e),Z(i),Z(s),Z(l)}}}function nc(t,e,i){let n,s,r;const{qImgs:l,pageQImgs:o,setPageQImgs:a,pageLength:c}=ze;return oe(t,l,u=>i(0,n=u)),oe(t,o,u=>i(2,r=u)),oe(t,a,u=>i(1,s=u)),[n,s,r,l,o,a,c]}class sc extends de{constructor(e){super(),fe(this,e,nc,ic,ue,{})}}var dt;(function(t){t.Range="range",t.Steps="steps",t.Positions="positions",t.Count="count",t.Values="values"})(dt||(dt={}));var Fe;(function(t){t[t.None=-1]="None",t[t.NoValue=0]="NoValue",t[t.LargeValue=1]="LargeValue",t[t.SmallValue=2]="SmallValue"})(Fe||(Fe={}));function rc(t){return gi(t)&&typeof t.from=="function"}function gi(t){return typeof t=="object"&&typeof t.to=="function"}function hs(t){t.parentElement.removeChild(t)}function zi(t){return t!=null}function ms(t){t.preventDefault()}function lc(t){return t.filter(function(e){return this[e]?!1:this[e]=!0},{})}function oc(t,e){return Math.round(t/e)*e}function ac(t,e){var i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.documentElement,r=Wr(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(r.x=0),e?i.top+r.y-s.clientTop:i.left+r.x-s.clientLeft}function xe(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function ps(t,e,i){i>0&&(Ne(t,e),setTimeout(function(){ui(t,e)},i))}function gs(t){return Math.max(Math.min(t,100),0)}function yi(t){return Array.isArray(t)?t:[t]}function cc(t){t=String(t);var e=t.split(".");return e.length>1?e[1].length:0}function Ne(t,e){t.classList&&!/\s/.test(e)?t.classList.add(e):t.className+=" "+e}function ui(t,e){t.classList&&!/\s/.test(e)?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function uc(t,e){return t.classList?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)}function Wr(t){var e=window.pageXOffset!==void 0,i=(t.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:i?t.documentElement.scrollLeft:t.body.scrollLeft,s=e?window.pageYOffset:i?t.documentElement.scrollTop:t.body.scrollTop;return{x:n,y:s}}function fc(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function dc(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch{}return t}function hc(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function cn(t,e){return 100/(e-t)}function qi(t,e,i){return e*100/(t[i+1]-t[i])}function mc(t,e){return qi(t,t[0]<0?e+Math.abs(t[0]):e-t[0],0)}function pc(t,e){return e*(t[1]-t[0])/100+t[0]}function Xt(t,e){for(var i=1;t>=e[i];)i+=1;return i}function gc(t,e,i){if(i>=t.slice(-1)[0])return 100;var n=Xt(i,t),s=t[n-1],r=t[n],l=e[n-1],o=e[n];return l+mc([s,r],i)/cn(l,o)}function _c(t,e,i){if(i>=100)return t.slice(-1)[0];var n=Xt(i,e),s=t[n-1],r=t[n],l=e[n-1],o=e[n];return pc([s,r],(i-l)*cn(l,o))}function vc(t,e,i,n){if(n===100)return n;var s=Xt(n,t),r=t[s-1],l=t[s];return i?n-r>(l-r)/2?l:r:e[s-1]?t[s-1]+oc(n-t[s-1],e[s-1]):n}var Gr=function(){function t(e,i,n){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=i;var s,r=[];for(Object.keys(e).forEach(function(l){r.push([yi(e[l]),l])}),r.sort(function(l,o){return l[0][0]-o[0][0]}),s=0;s<r.length;s++)this.handleEntryPoint(r[s][1],r[s][0]);for(this.xNumSteps=this.xSteps.slice(0),s=0;s<this.xNumSteps.length;s++)this.handleStepPoint(s,this.xNumSteps[s])}return t.prototype.getDistance=function(e){for(var i=[],n=0;n<this.xNumSteps.length-1;n++)i[n]=qi(this.xVal,e,n);return i},t.prototype.getAbsoluteDistance=function(e,i,n){var s=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[s+1];)s++;else e===this.xPct[this.xPct.length-1]&&(s=this.xPct.length-2);!n&&e===this.xPct[s+1]&&s++,i===null&&(i=[]);var r,l=1,o=i[s],a=0,c=0,u=0,f=0;for(n?r=(e-this.xPct[s])/(this.xPct[s+1]-this.xPct[s]):r=(this.xPct[s+1]-e)/(this.xPct[s+1]-this.xPct[s]);o>0;)a=this.xPct[s+1+f]-this.xPct[s+f],i[s+f]*l+100-r*100>100?(c=a*r,l=(o-100*r)/i[s+f],r=1):(c=i[s+f]*a/100*l,l=0),n?(u=u-c,this.xPct.length+f>=1&&f--):(u=u+c,this.xPct.length-f>=1&&f++),o=i[s+f]*l;return e+u},t.prototype.toStepping=function(e){return e=gc(this.xVal,this.xPct,e),e},t.prototype.fromStepping=function(e){return _c(this.xVal,this.xPct,e)},t.prototype.getStep=function(e){return e=vc(this.xPct,this.xSteps,this.snap,e),e},t.prototype.getDefaultStep=function(e,i,n){var s=Xt(e,this.xPct);return(e===100||i&&e===this.xPct[s-1])&&(s=Math.max(s-1,1)),(this.xVal[s]-this.xVal[s-1])/n},t.prototype.getNearbySteps=function(e){var i=Xt(e,this.xPct);return{stepBefore:{startValue:this.xVal[i-2],step:this.xNumSteps[i-2],highestStep:this.xHighestCompleteStep[i-2]},thisStep:{startValue:this.xVal[i-1],step:this.xNumSteps[i-1],highestStep:this.xHighestCompleteStep[i-1]},stepAfter:{startValue:this.xVal[i],step:this.xNumSteps[i],highestStep:this.xHighestCompleteStep[i]}}},t.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(cc);return Math.max.apply(null,e)},t.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},t.prototype.convert=function(e){return this.getStep(this.toStepping(e))},t.prototype.handleEntryPoint=function(e,i){var n;if(e==="min"?n=0:e==="max"?n=100:n=parseFloat(e),!xe(n)||!xe(i[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(i[0]);var s=Number(i[1]);n?this.xSteps.push(isNaN(s)?!1:s):isNaN(s)||(this.xSteps[0]=s),this.xHighestCompleteStep.push(0)},t.prototype.handleStepPoint=function(e,i){if(i){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=qi([this.xVal[e],this.xVal[e+1]],i,0)/cn(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],s=Math.ceil(Number(n.toFixed(3))-1),r=this.xVal[e]+this.xNumSteps[e]*s;this.xHighestCompleteStep[e]=r}},t}(),_s={to:function(t){return t===void 0?"":t.toFixed(2)},from:Number},Yr={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},ft={tooltips:".__tooltips",aria:".__aria"};function bc(t,e){if(!xe(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function wc(t,e){if(!xe(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");t.keyboardPageMultiplier=e}function yc(t,e){if(!xe(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");t.keyboardMultiplier=e}function kc(t,e){if(!xe(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");t.keyboardDefaultStep=e}function Sc(t,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");t.spectrum=new Gr(e,t.snap||!1,t.singleStep)}function Ec(t,e){if(e=yi(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=e.length,t.start=e}function Cc(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");t.snap=e}function Ic(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");t.animate=e}function Oc(t,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");t.animationDuration=e}function Jr(t,e){var i=[!1],n;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(n=1;n<t.handles;n++)i.push(e);i.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");i=e}t.connect=i}function Ac(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function Xr(t,e){if(!xe(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(t.margin=t.spectrum.getDistance(e))}function Tc(t,e){if(!xe(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getDistance(e),!t.limit||t.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function Pc(t,e){var i;if(!xe(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||xe(e[0])||xe(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),t.padding=[t.spectrum.getDistance(e[0]),t.spectrum.getDistance(e[1])],i=0;i<t.spectrum.xNumSteps.length-1;i++)if(t.padding[0][i]<0||t.padding[1][i]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var n=e[0]+e[1],s=t.spectrum.xVal[0],r=t.spectrum.xVal[t.spectrum.xVal.length-1];if(n/(r-s)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function Lc(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Mc(t,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var i=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,s=e.indexOf("fixed")>=0,r=e.indexOf("snap")>=0,l=e.indexOf("hover")>=0,o=e.indexOf("unconstrained")>=0,a=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,u=e.indexOf("smooth-steps")>=0;if(s){if(t.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");Xr(t,t.start[1]-t.start[0])}if(a&&t.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(o&&(t.margin||t.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:i||r,drag:n,dragAll:c,smoothSteps:u,fixed:s,snap:r,hover:l,unconstrained:o,invertConnects:a}}function Rc(t,e){if(e!==!1)if(e===!0||gi(e)){t.tooltips=[];for(var i=0;i<t.handles;i++)t.tooltips.push(e)}else{if(e=yi(e),e.length!==t.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(n){if(typeof n!="boolean"&&!gi(n))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),t.tooltips=e}}function Dc(t,e){if(e.length!==t.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");t.handleAttributes=e}function Nc(t,e){if(!gi(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");t.ariaFormat=e}function jc(t,e){if(!rc(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");t.format=e}function $c(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");t.keyboardSupport=e}function Fc(t,e){t.documentElement=e}function Uc(t,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function Vc(t,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof t.cssPrefix=="string"?(t.cssClasses={},Object.keys(e).forEach(function(i){t.cssClasses[i]=t.cssPrefix+e[i]})):t.cssClasses=e}function Qr(t){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:_s,format:_s},i={step:{r:!1,t:bc},keyboardPageMultiplier:{r:!1,t:wc},keyboardMultiplier:{r:!1,t:yc},keyboardDefaultStep:{r:!1,t:kc},start:{r:!0,t:Ec},connect:{r:!0,t:Jr},direction:{r:!0,t:Lc},snap:{r:!1,t:Cc},animate:{r:!1,t:Ic},animationDuration:{r:!1,t:Oc},range:{r:!0,t:Sc},orientation:{r:!1,t:Ac},margin:{r:!1,t:Xr},limit:{r:!1,t:Tc},padding:{r:!1,t:Pc},behaviour:{r:!0,t:Mc},ariaFormat:{r:!1,t:Nc},format:{r:!1,t:jc},tooltips:{r:!1,t:Rc},keyboardSupport:{r:!0,t:$c},documentElement:{r:!1,t:Fc},cssPrefix:{r:!0,t:Uc},cssClasses:{r:!0,t:Vc},handleAttributes:{r:!1,t:Dc}},n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Yr,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(i).forEach(function(a){if(!zi(t[a])&&n[a]===void 0){if(i[a].r)throw new Error("noUiSlider: '"+a+"' is required.");return}i[a].t(e,zi(t[a])?t[a]:n[a])}),e.pips=t.pips;var s=document.createElement("div"),r=s.style.msTransform!==void 0,l=s.style.transform!==void 0;e.transformRule=l?"transform":r?"msTransform":"webkitTransform";var o=[["left","top"],["right","bottom"]];return e.style=o[e.dir][e.ort],e}function Hc(t,e,i){var n=fc(),s=hc(),r=s&&dc(),l=t,o,a,c,u,f,d,h=e.spectrum,p=[],g=[],v=[],y=0,O={},P=!1,C=t.ownerDocument,T=e.documentElement||C.documentElement,j=C.body,F=C.dir==="rtl"||e.ort===1?0:100;function E(w,I){var A=C.createElement("div");return I&&Ne(A,I),w.appendChild(A),A}function D(w,I){var A=E(w,e.cssClasses.origin),B=E(A,e.cssClasses.handle);if(E(B,e.cssClasses.touchArea),B.setAttribute("data-handle",String(I)),e.keyboardSupport&&(B.setAttribute("tabindex","0"),B.addEventListener("keydown",function(W){return Sl(W,I)})),e.handleAttributes!==void 0){var x=e.handleAttributes[I];Object.keys(x).forEach(function(W){B.setAttribute(W,x[W])})}return B.setAttribute("role","slider"),B.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),I===0?Ne(B,e.cssClasses.handleLower):I===e.handles-1&&Ne(B,e.cssClasses.handleUpper),A.handle=B,A}function Y(w,I){return I?E(w,e.cssClasses.connect):!1}function z(w,I){a=E(I,e.cssClasses.connects),c=[],u=[],u.push(Y(a,w[0]));for(var A=0;A<e.handles;A++)c.push(D(I,A)),v[A]=A,u.push(Y(a,w[A+1]))}function L(w){Ne(w,e.cssClasses.target),e.dir===0?Ne(w,e.cssClasses.ltr):Ne(w,e.cssClasses.rtl),e.ort===0?Ne(w,e.cssClasses.horizontal):Ne(w,e.cssClasses.vertical);var I=getComputedStyle(w).direction;return I==="rtl"?Ne(w,e.cssClasses.textDirectionRtl):Ne(w,e.cssClasses.textDirectionLtr),E(w,e.cssClasses.base)}function H(w,I){return!e.tooltips||!e.tooltips[I]?!1:E(w.firstChild,e.cssClasses.tooltip)}function q(){return l.hasAttribute("disabled")}function K(w){var I=c[w];return I.hasAttribute("disabled")}function U(w){w!=null?(c[w].setAttribute("disabled",""),c[w].handle.removeAttribute("tabindex")):(l.setAttribute("disabled",""),c.forEach(function(I){I.handle.removeAttribute("tabindex")}))}function se(w){w!=null?(c[w].removeAttribute("disabled"),c[w].handle.setAttribute("tabindex","0")):(l.removeAttribute("disabled"),c.forEach(function(I){I.removeAttribute("disabled"),I.handle.setAttribute("tabindex","0")}))}function J(){d&&(Ht("update"+ft.tooltips),d.forEach(function(w){w&&hs(w)}),d=null)}function te(){J(),d=c.map(H),Ti("update"+ft.tooltips,function(w,I,A){if(!(!d||!e.tooltips)&&d[I]!==!1){var B=w[I];e.tooltips[I]!==!0&&(B=e.tooltips[I].to(A[I])),d[I].innerHTML=B}})}function ne(){Ht("update"+ft.aria),Ti("update"+ft.aria,function(w,I,A,B,x){v.forEach(function(W){var ie=c[W],X=ei(g,W,0,!0,!0,!0),pe=ei(g,W,100,!0,!0,!0),ge=x[W],we=String(e.ariaFormat.to(A[W]));X=h.fromStepping(X).toFixed(1),pe=h.fromStepping(pe).toFixed(1),ge=h.fromStepping(ge).toFixed(1),ie.children[0].setAttribute("aria-valuemin",X),ie.children[0].setAttribute("aria-valuemax",pe),ie.children[0].setAttribute("aria-valuenow",ge),ie.children[0].setAttribute("aria-valuetext",we)})})}function be(w){if(w.mode===dt.Range||w.mode===dt.Steps)return h.xVal;if(w.mode===dt.Count){if(w.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var I=w.values-1,A=100/I,B=[];I--;)B[I]=I*A;return B.push(100),ke(B,w.stepped)}return w.mode===dt.Positions?ke(w.values,w.stepped):w.mode===dt.Values?w.stepped?w.values.map(function(x){return h.fromStepping(h.getStep(h.toStepping(x)))}):w.values:[]}function ke(w,I){return w.map(function(A){return h.fromStepping(I?h.getStep(A):A)})}function pl(w){function I(ge,we){return Number((ge+we).toFixed(7))}var A=be(w),B={},x=h.xVal[0],W=h.xVal[h.xVal.length-1],ie=!1,X=!1,pe=0;return A=lc(A.slice().sort(function(ge,we){return ge-we})),A[0]!==x&&(A.unshift(x),ie=!0),A[A.length-1]!==W&&(A.push(W),X=!0),A.forEach(function(ge,we){var ye,me,Oe,Re=ge,Te=A[we+1],Pe,Mi,Ri,Di,yn,Ni,kn,Sn=w.mode===dt.Steps;for(Sn&&(ye=h.xNumSteps[we]),ye||(ye=Te-Re),Te===void 0&&(Te=Re),ye=Math.max(ye,1e-7),me=Re;me<=Te;me=I(me,ye)){for(Pe=h.toStepping(me),Mi=Pe-pe,yn=Mi/(w.density||1),Ni=Math.round(yn),kn=Mi/Ni,Oe=1;Oe<=Ni;Oe+=1)Ri=pe+Oe*kn,B[Ri.toFixed(5)]=[h.fromStepping(Ri),0];Di=A.indexOf(me)>-1?Fe.LargeValue:Sn?Fe.SmallValue:Fe.NoValue,!we&&ie&&me!==Te&&(Di=0),me===Te&&X||(B[Pe.toFixed(5)]=[me,Di]),pe=Pe}}),B}function gl(w,I,A){var B,x,W=C.createElement("div"),ie=(B={},B[Fe.None]="",B[Fe.NoValue]=e.cssClasses.valueNormal,B[Fe.LargeValue]=e.cssClasses.valueLarge,B[Fe.SmallValue]=e.cssClasses.valueSub,B),X=(x={},x[Fe.None]="",x[Fe.NoValue]=e.cssClasses.markerNormal,x[Fe.LargeValue]=e.cssClasses.markerLarge,x[Fe.SmallValue]=e.cssClasses.markerSub,x),pe=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],ge=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];Ne(W,e.cssClasses.pips),Ne(W,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function we(me,Oe){var Re=Oe===e.cssClasses.value,Te=Re?pe:ge,Pe=Re?ie:X;return Oe+" "+Te[e.ort]+" "+Pe[me]}function ye(me,Oe,Re){if(Re=I?I(Oe,Re):Re,Re!==Fe.None){var Te=E(W,!1);Te.className=we(Re,e.cssClasses.marker),Te.style[e.style]=me+"%",Re>Fe.NoValue&&(Te=E(W,!1),Te.className=we(Re,e.cssClasses.value),Te.setAttribute("data-value",String(Oe)),Te.style[e.style]=me+"%",Te.innerHTML=String(A.to(Oe)))}}return Object.keys(w).forEach(function(me){ye(me,w[me][0],w[me][1])}),W}function Ci(){f&&(hs(f),f=null)}function Ii(w){Ci();var I=pl(w),A=w.filter,B=w.format||{to:function(x){return String(Math.round(x))}};return f=l.appendChild(gl(I,A,B)),f}function dn(){var w=o.getBoundingClientRect(),I="offset"+["Width","Height"][e.ort];return e.ort===0?w.width||o[I]:w.height||o[I]}function wt(w,I,A,B){var x=function(ie){var X=_l(ie,B.pageOffset,B.target||I);if(!X||q()&&!B.doNotReject||uc(l,e.cssClasses.tap)&&!B.doNotReject||w===n.start&&X.buttons!==void 0&&X.buttons>1||B.hover&&X.buttons)return!1;r||X.preventDefault(),X.calcPoint=X.points[e.ort],A(X,B)},W=[];return w.split(" ").forEach(function(ie){I.addEventListener(ie,x,r?{passive:!0}:!1),W.push([ie,x])}),W}function _l(w,I,A){var B=w.type.indexOf("touch")===0,x=w.type.indexOf("mouse")===0,W=w.type.indexOf("pointer")===0,ie=0,X=0;if(w.type.indexOf("MSPointer")===0&&(W=!0),w.type==="mousedown"&&!w.buttons&&!w.touches)return!1;if(B){var pe=function(ye){var me=ye.target;return me===A||A.contains(me)||w.composed&&w.composedPath().shift()===A};if(w.type==="touchstart"){var ge=Array.prototype.filter.call(w.touches,pe);if(ge.length>1)return!1;ie=ge[0].pageX,X=ge[0].pageY}else{var we=Array.prototype.find.call(w.changedTouches,pe);if(!we)return!1;ie=we.pageX,X=we.pageY}}return I=I||Wr(C),(x||W)&&(ie=w.clientX+I.x,X=w.clientY+I.y),w.pageOffset=I,w.points=[ie,X],w.cursor=x||W,w}function hn(w){var I=w-ac(o,e.ort),A=I*100/dn();return A=gs(A),e.dir?100-A:A}function vl(w){var I=100,A=!1;return c.forEach(function(B,x){if(!K(x)){var W=g[x],ie=Math.abs(W-w),X=ie===100&&I===100,pe=ie<I,ge=ie<=I&&w>W;(pe||ge||X)&&(A=x,I=ie)}}),A}function bl(w,I){w.type==="mouseout"&&w.target.nodeName==="HTML"&&w.relatedTarget===null&&Oi(w,I)}function wl(w,I){if(navigator.appVersion.indexOf("MSIE 9")===-1&&w.buttons===0&&I.buttonsProperty!==0)return Oi(w,I);var A=(e.dir?-1:1)*(w.calcPoint-I.startCalcPoint),B=A*100/I.baseSize;pn(A>0,B,I.locations,I.handleNumbers,I.connect)}function Oi(w,I){I.handle&&(ui(I.handle,e.cssClasses.active),y-=1),I.listeners.forEach(function(A){T.removeEventListener(A[0],A[1])}),y===0&&(ui(l,e.cssClasses.drag),Li(),w.cursor&&(j.style.cursor="",j.removeEventListener("selectstart",ms))),e.events.smoothSteps&&(I.handleNumbers.forEach(function(A){yt(A,g[A],!0,!0,!1,!1)}),I.handleNumbers.forEach(function(A){Se("update",A)})),I.handleNumbers.forEach(function(A){Se("change",A),Se("set",A),Se("end",A)})}function Ai(w,I){if(!I.handleNumbers.some(K)){var A;if(I.handleNumbers.length===1){var B=c[I.handleNumbers[0]];A=B.children[0],y+=1,Ne(A,e.cssClasses.active)}w.stopPropagation();var x=[],W=wt(n.move,T,wl,{target:w.target,handle:A,connect:I.connect,listeners:x,startCalcPoint:w.calcPoint,baseSize:dn(),pageOffset:w.pageOffset,handleNumbers:I.handleNumbers,buttonsProperty:w.buttons,locations:g.slice()}),ie=wt(n.end,T,Oi,{target:w.target,handle:A,listeners:x,doNotReject:!0,handleNumbers:I.handleNumbers}),X=wt("mouseout",T,bl,{target:w.target,handle:A,listeners:x,doNotReject:!0,handleNumbers:I.handleNumbers});x.push.apply(x,W.concat(ie,X)),w.cursor&&(j.style.cursor=getComputedStyle(w.target).cursor,c.length>1&&Ne(l,e.cssClasses.drag),j.addEventListener("selectstart",ms,!1)),I.handleNumbers.forEach(function(pe){Se("start",pe)})}}function yl(w){w.stopPropagation();var I=hn(w.calcPoint),A=vl(I);A!==!1&&(e.events.snap||ps(l,e.cssClasses.tap,e.animationDuration),yt(A,I,!0,!0),Li(),Se("slide",A,!0),Se("update",A,!0),e.events.snap?Ai(w,{handleNumbers:[A]}):(Se("change",A,!0),Se("set",A,!0)))}function kl(w){var I=hn(w.calcPoint),A=h.getStep(I),B=h.fromStepping(A);Object.keys(O).forEach(function(x){x.split(".")[0]==="hover"&&O[x].forEach(function(W){W.call(ii,B)})})}function Sl(w,I){if(q()||K(I))return!1;var A=["Left","Right"],B=["Down","Up"],x=["PageDown","PageUp"],W=["Home","End"];e.dir&&!e.ort?A.reverse():e.ort&&!e.dir&&(B.reverse(),x.reverse());var ie=w.key.replace("Arrow",""),X=ie===x[0],pe=ie===x[1],ge=ie===B[0]||ie===A[0]||X,we=ie===B[1]||ie===A[1]||pe,ye=ie===W[0],me=ie===W[1];if(!ge&&!we&&!ye&&!me)return!0;w.preventDefault();var Oe;if(we||ge){var Re=ge?0:1,Te=bn(I),Pe=Te[Re];if(Pe===null)return!1;Pe===!1&&(Pe=h.getDefaultStep(g[I],ge,e.keyboardDefaultStep)),pe||X?Pe*=e.keyboardPageMultiplier:Pe*=e.keyboardMultiplier,Pe=Math.max(Pe,1e-7),Pe=(ge?-1:1)*Pe,Oe=p[I]+Pe}else me?Oe=e.spectrum.xVal[e.spectrum.xVal.length-1]:Oe=e.spectrum.xVal[0];return yt(I,h.toStepping(Oe),!0,!0),Se("slide",I),Se("update",I),Se("change",I),Se("set",I),!1}function mn(w){w.fixed||c.forEach(function(I,A){wt(n.start,I.children[0],Ai,{handleNumbers:[A]})}),w.tap&&wt(n.start,o,yl,{}),w.hover&&wt(n.move,o,kl,{hover:!0}),w.drag&&u.forEach(function(I,A){if(!(I===!1||A===0||A===u.length-1)){var B=c[A-1],x=c[A],W=[I],ie=[B,x],X=[A-1,A];Ne(I,e.cssClasses.draggable),w.fixed&&(W.push(B.children[0]),W.push(x.children[0])),w.dragAll&&(ie=c,X=v),W.forEach(function(pe){wt(n.start,pe,Ai,{handles:ie,handleNumbers:X,connect:I})})}})}function Ti(w,I){O[w]=O[w]||[],O[w].push(I),w.split(".")[0]==="update"&&c.forEach(function(A,B){Se("update",B)})}function El(w){return w===ft.aria||w===ft.tooltips}function Ht(w){var I=w&&w.split(".")[0],A=I?w.substring(I.length):w;Object.keys(O).forEach(function(B){var x=B.split(".")[0],W=B.substring(x.length);(!I||I===x)&&(!A||A===W)&&(!El(W)||A===W)&&delete O[B]})}function Se(w,I,A){Object.keys(O).forEach(function(B){var x=B.split(".")[0];w===x&&O[B].forEach(function(W){W.call(ii,p.map(e.format.to),I,p.slice(),A||!1,g.slice(),ii)})})}function ei(w,I,A,B,x,W,ie){var X;return c.length>1&&!e.events.unconstrained&&(B&&I>0&&(X=h.getAbsoluteDistance(w[I-1],e.margin,!1),A=Math.max(A,X)),x&&I<c.length-1&&(X=h.getAbsoluteDistance(w[I+1],e.margin,!0),A=Math.min(A,X))),c.length>1&&e.limit&&(B&&I>0&&(X=h.getAbsoluteDistance(w[I-1],e.limit,!1),A=Math.min(A,X)),x&&I<c.length-1&&(X=h.getAbsoluteDistance(w[I+1],e.limit,!0),A=Math.max(A,X))),e.padding&&(I===0&&(X=h.getAbsoluteDistance(0,e.padding[0],!1),A=Math.max(A,X)),I===c.length-1&&(X=h.getAbsoluteDistance(100,e.padding[1],!0),A=Math.min(A,X))),ie||(A=h.getStep(A)),A=gs(A),A===w[I]&&!W?!1:A}function Pi(w,I){var A=e.ort;return(A?I:w)+", "+(A?w:I)}function pn(w,I,A,B,x){var W=A.slice(),ie=B[0],X=e.events.smoothSteps,pe=[!w,w],ge=[w,!w];B=B.slice(),w&&B.reverse(),B.length>1?B.forEach(function(ye,me){var Oe=ei(W,ye,W[ye]+I,pe[me],ge[me],!1,X);Oe===!1?I=0:(I=Oe-W[ye],W[ye]=Oe)}):pe=ge=[!0];var we=!1;B.forEach(function(ye,me){we=yt(ye,A[ye]+I,pe[me],ge[me],!1,X)||we}),we&&(B.forEach(function(ye){Se("update",ye),Se("slide",ye)}),x!=null&&Se("drag",ie))}function gn(w,I){return e.dir?100-w-I:w}function Cl(w,I){g[w]=I,p[w]=h.fromStepping(I);var A=gn(I,0)-F,B="translate("+Pi(A+"%","0")+")";if(c[w].style[e.transformRule]=B,e.events.invertConnects&&g.length>1){var x=g.every(function(W,ie,X){return ie===0||W>=X[ie-1]});if(P!==!x){Ll();return}}Bt(w),Bt(w+1),P&&(Bt(w-1),Bt(w+2))}function Li(){v.forEach(function(w){var I=g[w]>50?-1:1,A=3+(c.length+I*w);c[w].style.zIndex=String(A)})}function yt(w,I,A,B,x,W){return x||(I=ei(g,w,I,A,B,!1,W)),I===!1?!1:(Cl(w,I),!0)}function Bt(w){if(u[w]){var I=g.slice();P&&I.sort(function(X,pe){return X-pe});var A=0,B=100;w!==0&&(A=I[w-1]),w!==u.length-1&&(B=I[w]);var x=B-A,W="translate("+Pi(gn(A,x)+"%","0")+")",ie="scale("+Pi(x/100,"1")+")";u[w].style[e.transformRule]=W+" "+ie}}function _n(w,I){return w===null||w===!1||w===void 0||(typeof w=="number"&&(w=String(w)),w=e.format.from(w),w!==!1&&(w=h.toStepping(w)),w===!1||isNaN(w))?g[I]:w}function ti(w,I,A){var B=yi(w),x=g[0]===void 0;I=I===void 0?!0:I,e.animate&&!x&&ps(l,e.cssClasses.tap,e.animationDuration),v.forEach(function(X){yt(X,_n(B[X],X),!0,!1,A)});var W=v.length===1?0:1;if(x&&h.hasNoSize()&&(A=!0,g[0]=0,v.length>1)){var ie=100/(v.length-1);v.forEach(function(X){g[X]=X*ie})}for(;W<v.length;++W)v.forEach(function(X){yt(X,g[X],!0,!0,A)});Li(),v.forEach(function(X){Se("update",X),B[X]!==null&&I&&Se("set",X)})}function Il(w){ti(e.start,w)}function Ol(w,I,A,B){if(w=Number(w),!(w>=0&&w<v.length))throw new Error("noUiSlider: invalid handle number, got: "+w);yt(w,_n(I,w),!0,!0,B),Se("update",w),A&&Se("set",w)}function vn(w){if(w===void 0&&(w=!1),w)return p.length===1?p[0]:p.slice(0);var I=p.map(e.format.to);return I.length===1?I[0]:I}function Al(){for(Ht(ft.aria),Ht(ft.tooltips),Object.keys(e.cssClasses).forEach(function(w){ui(l,e.cssClasses[w])});l.firstChild;)l.removeChild(l.firstChild);delete l.noUiSlider}function bn(w){var I=g[w],A=h.getNearbySteps(I),B=p[w],x=A.thisStep.step,W=null;if(e.snap)return[B-A.stepBefore.startValue||null,A.stepAfter.startValue-B||null];x!==!1&&B+x>A.stepAfter.startValue&&(x=A.stepAfter.startValue-B),B>A.thisStep.startValue?W=A.thisStep.step:A.stepBefore.step===!1?W=!1:W=B-A.stepBefore.highestStep,I===100?x=null:I===0&&(W=null);var ie=h.countStepDecimals();return x!==null&&x!==!1&&(x=Number(x.toFixed(ie))),W!==null&&W!==!1&&(W=Number(W.toFixed(ie))),[W,x]}function Tl(){return v.map(bn)}function Pl(w,I){var A=vn(),B=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];B.forEach(function(W){w[W]!==void 0&&(i[W]=w[W])});var x=Qr(i);B.forEach(function(W){w[W]!==void 0&&(e[W]=x[W])}),h=x.spectrum,e.margin=x.margin,e.limit=x.limit,e.padding=x.padding,e.pips?Ii(e.pips):Ci(),e.tooltips?te():J(),g=[],ti(zi(w.start)?w.start:A,I),w.connect&&wn()}function wn(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var w=0;w<=e.handles;w++)u[w]=Y(a,e.connect[w]),Bt(w);mn({drag:e.events.drag,fixed:!0})}function Ll(){P=!P,Jr(e,e.connect.map(function(w){return!w})),wn()}function Ml(){o=L(l),z(e.connect,o),mn(e.events),ti(e.start),e.pips&&Ii(e.pips),e.tooltips&&te(),ne()}Ml();var ii={destroy:Al,steps:Tl,on:Ti,off:Ht,get:vn,set:ti,setHandle:Ol,reset:Il,disable:U,enable:se,__moveHandles:function(w,I,A){pn(w,I,g,A)},options:i,updateOptions:Pl,target:l,removePips:Ci,removeTooltips:J,getPositions:function(){return g.slice()},getTooltips:function(){return d},getOrigins:function(){return c},pips:Ii};return ii}function Bc(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var i=Qr(e),n=Hc(t,i,e);return t.noUiSlider=n,n}const zc={__spectrum:Gr,cssClasses:Yr,create:Bc};function qc(t){let e,i,n;return{c(){e=b("span"),i=G(t[0]),m(e,"id",t[3]),m(e,"class",n="tooltip "+t[2]+" "+(t[1]?"display":"")+" svelte-1am23me")},m(s,r){S(s,e,r),_(e,i)},p(s,[r]){r&1&&ce(i,s[0]),r&6&&n!==(n="tooltip "+s[2]+" "+(s[1]?"display":"")+" svelte-1am23me")&&m(e,"class",n)},i:$,o:$,d(s){s&&k(e)}}}function Kc(t,e,i){let n,s,r,l,{tooltipText:o}=e,{targetHtmlId:a}=e;const c=`tooltip-generic-${window.crypto.randomUUID()}`,u=()=>i(1,l=!0),f=()=>i(1,l=!1),d=()=>i(1,l=!l);return vt(()=>{r=a?document.getElementById(a):document.getElementById(c).parentElement,a&&!r&&(console.error(`TooltipGeneric: element with ID ${a} not found, defaulting to the parent element`),r=document.getElementById(c).targetElement),r.addEventListener("mouseover",u),r.addEventListener("mouseout",f),r.addEventListener("click",d)}),bi(()=>{r.removeEventListener("mouseover",u),r.removeEventListener("mouseout",f),r.removeEventListener("click",d)}),t.$$set=h=>{"tooltipText"in h&&i(0,o=h.tooltipText),"targetHtmlId"in h&&i(4,a=h.targetHtmlId)},t.$$.update=()=>{t.$$.dirty&33&&i(2,n=s(o))},i(5,s=h=>i(2,n=h.length>100?"tooltip-wide":h.length>20?"tooltip-mid":"tooltip-thin")),r=void 0,i(1,l=!1),[o,l,n,c,a,s]}class ki extends de{constructor(e){super(),fe(this,e,Kc,qc,ue,{tooltipText:0,targetHtmlId:4})}}function xc(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g,v;return{c(){e=b("div"),i=b("span"),n=G(t[2]),s=G(" ("),r=G(t[3]),l=G(")"),o=N(),a=b("div"),c=b("span"),u=G(t[0]),f=N(),d=b("div"),h=b("div"),p=N(),g=b("span"),v=G(t[1]),m(c,"class","range-marker svelte-216mtn"),m(h,"class","slider"),m(h,"id",t[4]),m(d,"class","slider-wrapper svelte-216mtn"),m(g,"class","range-marker svelte-216mtn"),m(a,"class","slider-outer-wrapper is-flex flex-direction-row svelte-216mtn")},m(y,O){S(y,e,O),_(e,i),_(i,n),_(i,s),_(i,r),_(i,l),_(e,o),_(e,a),_(a,c),_(c,u),_(a,f),_(a,d),_(d,h),_(a,p),_(a,g),_(g,v)},p(y,[O]){O&4&&ce(n,y[2]),O&8&&ce(r,y[3]),O&1&&ce(u,y[0]),O&2&&ce(v,y[1])},i:$,o:$,d(y){y&&k(e)}}}function Wc(t,e,i){let n,{minVal:s}=e,{maxVal:r}=e,{start:l}=e,{step:o=void 0}=e,{roundTo:a=2}=e,{title:c=""}=e,{emitOnUpdate:u=!1}=e;const f=tn(),d=`slider-${window.crypto.randomUUID()}`,h=Array.isArray(l)&&l.length===2&&l.every(E=>!isNaN(parseFloat(E))),p=[],g=h?[`noUi-handle-${window.crypto.randomUUID()}`,`noUi-handle-${window.crypto.randomUUID()}`]:[`noUi-handle-${window.crypto.randomUUID()}`],v=pi();v.setCompareFn(h?ln:(E,D)=>O(E)===O(D)),v.set(l);const y=Ae("resetTrigger")||void 0;y==null||y.subscribe(T);const O=E=>Number(E.toFixed(a)),P=(E,D)=>{E=Array.isArray(E)?E.map(O):O(E),i(3,n=E),(D==="set"||D==="update"&&u)&&(v.set(E),v.same()||f("updateSlider",v.get()))};function C(E){p.length&&p.map((D,Y)=>D.$set({tooltipText:h?E[Y]:E}))}function T(){const E=document.getElementById(d);E!=null&&E.noUiSlider&&E.noUiSlider.reset()}function j(){const E=document.getElementById(d);let D;zc.create(E,{start:l,step:o,connect:h?!0:"lower",range:{min:s,max:r},handleAttributes:g.map(Y=>({id:Y}))}),E.noUiSlider.on("update",()=>{D=E.noUiSlider.get(!0),P(D,"update")}),E.noUiSlider.on("set",()=>{D=E.noUiSlider.get(!0),P(D,"set")})}function F(){g.map((E,D)=>{p.push(new ki({target:document.getElementById(E),props:h?{tooltipText:n[D]}:{tooltipText:n}}))})}return vt(()=>{j(),F()}),bi(()=>{document.getElementById(d)&&(document.getElementById(d).innerHTML="")}),t.$$set=E=>{"minVal"in E&&i(0,s=E.minVal),"maxVal"in E&&i(1,r=E.maxVal),"start"in E&&i(5,l=E.start),"step"in E&&i(6,o=E.step),"roundTo"in E&&i(7,a=E.roundTo),"title"in E&&i(2,c=E.title),"emitOnUpdate"in E&&i(8,u=E.emitOnUpdate)},t.$$.update=()=>{t.$$.dirty&32&&i(3,n=l),t.$$.dirty&8&&C(n)},[s,r,c,n,d,l,o,a,u]}class Zr extends de{constructor(e){super(),fe(this,e,Wc,xc,ue,{minVal:0,maxVal:1,start:5,step:6,roundTo:7,title:2,emitOnUpdate:8})}}function Gc(t){let e,i,n,s,r,l,o;return{c(){e=b("button"),i=b("span"),i.innerHTML='<span class="switch-control svelte-g5g8im"><span class="switch-spot"></span></span>',n=N(),s=b("span"),r=G(t[0]),m(i,"class","switch mr-2 svelte-g5g8im"),m(s,"class","label svelte-g5g8im"),m(e,"id",t[3]),m(e,"name",t[3]),m(e,"class","input-checkbox-wrapper is-flex is-align-items-center-is-justify-content-center p-2 pl-3 pr-3 svelte-g5g8im"),m(e,"aria-label",t[0]),qe(e,"is-checked",t[2]),qe(e,"is-clickable",t[1]),qe(e,"button",t[1])},m(a,c){S(a,e,c),_(e,i),_(e,n),_(e,s),_(s,r),l||(o=re(e,"click",Ct(t[4])),l=!0)},p(a,[c]){c&1&&ce(r,a[0]),c&1&&m(e,"aria-label",a[0]),c&4&&qe(e,"is-checked",a[2]),c&2&&qe(e,"is-clickable",a[1]),c&2&&qe(e,"button",a[1])},i:$,o:$,d(a){a&&k(e),l=!1,o()}}}function Yc(t,e,i){let n,{toggleLabel:s}=e,{start:r=!1}=e,{buttonDisplay:l=!1}=e;const o=`input-toggle-${window.crypto.randomUUID()}`,a=tn(),c=Ae("resetTrigger")||void 0;c==null||c.subscribe(f);const u=()=>i(2,n=!n);function f(){i(2,n=r)}return t.$$set=d=>{"toggleLabel"in d&&i(0,s=d.toggleLabel),"start"in d&&i(5,r=d.start),"buttonDisplay"in d&&i(1,l=d.buttonDisplay)},t.$$.update=()=>{t.$$.dirty&32&&i(2,n=r),t.$$.dirty&4&&a("updateChecked",n)},[s,l,n,o,u,r]}class Jc extends de{constructor(e){super(),fe(this,e,Yc,Gc,ue,{toggleLabel:0,start:5,buttonDisplay:1})}}/*! choices.js v11.1.0 | © 2025 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var Ki=function(t,e){return Ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},Ki(t,e)};function el(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ki(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var Ve=function(){return Ve=Object.assign||function(e){for(var i,n=1,s=arguments.length;n<s;n++){i=arguments[n];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Ve.apply(this,arguments)};function Xc(t,e,i){if(i||arguments.length===2)for(var n=0,s=e.length,r;n<s;n++)(r||!(n in e))&&(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))}var Ce={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},Ue={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},De={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},Qc=["fuseOptions","classNames"],mt={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},vs=function(t){return{type:Ce.ADD_CHOICE,choice:t}},Zc=function(t){return{type:Ce.REMOVE_CHOICE,choice:t}},eu=function(t){return{type:Ce.FILTER_CHOICES,results:t}},tu=function(t){return{type:Ce.ACTIVATE_CHOICES,active:t}},iu=function(t){return{type:Ce.ADD_GROUP,group:t}},bs=function(t){return{type:Ce.ADD_ITEM,item:t}},ws=function(t){return{type:Ce.REMOVE_ITEM,item:t}},li=function(t,e){return{type:Ce.HIGHLIGHT_ITEM,item:t,highlighted:e}},nu=function(t,e){return Math.floor(Math.random()*(e-t)+t)},ys=function(t){return Array.from({length:t},function(){return nu(0,36).toString(36)}).join("")},su=function(t,e){var i=t.id||t.name&&"".concat(t.name,"-").concat(ys(2))||ys(4);return i=i.replace(/(:|\.|\[|\]|,)/g,""),i="".concat(e,"-").concat(i),i},ru=function(t,e,i){i===void 0&&(i=1);for(var n="".concat(i>0?"next":"previous","ElementSibling"),s=t[n];s;){if(s.matches(e))return s;s=s[n]}return null},lu=function(t,e,i){i===void 0&&(i=1);var n;return i>0?n=e.scrollTop+e.offsetHeight>=t.offsetTop+t.offsetHeight:n=t.offsetTop>=e.scrollTop,n},Si=function(t){if(typeof t!="string"){if(t==null)return"";if(typeof t=="object"){if("raw"in t)return Si(t.raw);if("trusted"in t)return t.trusted}return t}return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},ou=function(){var t=document.createElement("div");return function(e){t.innerHTML=e.trim();for(var i=t.children[0];t.firstChild;)t.removeChild(t.firstChild);return i}}(),Gt=function(t,e){return typeof t=="function"?t(Si(e),e):t},ks=function(t){return typeof t=="function"?t():t},St=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("trusted"in t)return t.trusted;if("raw"in t)return t.raw}return""},tl=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("escaped"in t)return t.escaped;if("trusted"in t)return t.trusted}return""},un=function(t,e){return t?tl(e):Si(e)},rt=function(t,e,i){t.innerHTML=un(e,i)},au=function(t,e){var i=t.value,n=t.label,s=n===void 0?i:n,r=e.value,l=e.label,o=l===void 0?r:l;return St(s).localeCompare(St(o),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},cu=function(t,e){return t.rank-e.rank},uu=function(t,e,i){i===void 0&&(i=null);var n=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0});return t.dispatchEvent(n)},fu=function(t,e){var i=Object.keys(t).sort(),n=Object.keys(e).sort();return i.filter(function(s){return n.indexOf(s)<0})},Ei=function(t){return Array.isArray(t)?t:[t]},Kt=function(t){return t&&Array.isArray(t)?t.map(function(e){return".".concat(e)}).join(""):".".concat(t)},ae=function(t,e){var i;(i=t.classList).add.apply(i,Ei(e))},tt=function(t,e){var i;(i=t.classList).remove.apply(i,Ei(e))},du=function(t){if(typeof t<"u")try{return JSON.parse(t)}catch{return t}return{}},hu=function(t,e,i){var n=t.itemEl;n&&(tt(n,i),ae(n,e))},mu=function(){function t(e){var i=e.element,n=e.type,s=e.classNames;this.element=i,this.classNames=s,this.type=n,this.isActive=!1}return t.prototype.show=function(){return ae(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},t.prototype.hide=function(){return tt(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},t}(),Ss=function(){function t(e){var i=e.element,n=e.type,s=e.classNames,r=e.position;this.element=i,this.classNames=s,this.type=n,this.position=r,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return t.prototype.shouldFlip=function(e,i){var n=!1;return this.position==="auto"?n=this.element.getBoundingClientRect().top-i>=0&&!window.matchMedia("(min-height: ".concat(e+1,"px)")).matches:this.position==="top"&&(n=!0),n},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype.open=function(e,i){ae(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e,i)&&(ae(this.element,this.classNames.flippedState),this.isFlipped=!0)},t.prototype.close=function(){tt(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(tt(this.element,this.classNames.flippedState),this.isFlipped=!1)},t.prototype.addFocusState=function(){ae(this.element,this.classNames.focusState)},t.prototype.removeFocusState=function(){tt(this.element,this.classNames.focusState)},t.prototype.enable=function(){tt(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===mt.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},t.prototype.disable=function(){ae(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===mt.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},t.prototype.wrap=function(e){var i=this.element,n=e.parentNode;n&&(e.nextSibling?n.insertBefore(i,e.nextSibling):n.appendChild(i)),i.appendChild(e)},t.prototype.unwrap=function(e){var i=this.element,n=i.parentNode;n&&(n.insertBefore(e,i),n.removeChild(i))},t.prototype.addLoadingState=function(){ae(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},t.prototype.removeLoadingState=function(){tt(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},t}(),pu=function(){function t(e){var i=e.element,n=e.type,s=e.classNames,r=e.preventPaste;this.element=i,this.type=n,this.classNames=s,this.preventPaste=r,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=i.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(t.prototype,"placeholder",{set:function(e){this.element.placeholder=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.addEventListeners=function(){var e=this.element;e.addEventListener("paste",this._onPaste),e.addEventListener("input",this._onInput,{passive:!0}),e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})},t.prototype.removeEventListeners=function(){var e=this.element;e.removeEventListener("input",this._onInput),e.removeEventListener("paste",this._onPaste),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)},t.prototype.enable=function(){var e=this.element;e.removeAttribute("disabled"),this.isDisabled=!1},t.prototype.disable=function(){var e=this.element;e.setAttribute("disabled",""),this.isDisabled=!0},t.prototype.focus=function(){this.isFocussed||this.element.focus()},t.prototype.blur=function(){this.isFocussed&&this.element.blur()},t.prototype.clear=function(e){return e===void 0&&(e=!0),this.element.value="",e&&this.setWidth(),this},t.prototype.setWidth=function(){var e=this.element;e.style.minWidth="".concat(e.placeholder.length+1,"ch"),e.style.width="".concat(e.value.length+1,"ch")},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype._onInput=function(){this.type!==mt.SelectOne&&this.setWidth()},t.prototype._onPaste=function(e){this.preventPaste&&e.preventDefault()},t.prototype._onFocus=function(){this.isFocussed=!0},t.prototype._onBlur=function(){this.isFocussed=!1},t}(),gu=4,Es=function(){function t(e){var i=e.element;this.element=i,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return t.prototype.prepend=function(e){var i=this.element.firstElementChild;i?this.element.insertBefore(e,i):this.element.append(e)},t.prototype.scrollToTop=function(){this.element.scrollTop=0},t.prototype.scrollToChildElement=function(e,i){var n=this;if(e){var s=this.element.offsetHeight,r=this.element.scrollTop+s,l=e.offsetHeight,o=e.offsetTop+l,a=i>0?this.element.scrollTop+o-r:e.offsetTop;requestAnimationFrame(function(){n._animateScroll(a,i)})}},t.prototype._scrollDown=function(e,i,n){var s=(n-e)/i,r=s>1?s:1;this.element.scrollTop=e+r},t.prototype._scrollUp=function(e,i,n){var s=(e-n)/i,r=s>1?s:1;this.element.scrollTop=e-r},t.prototype._animateScroll=function(e,i){var n=this,s=gu,r=this.element.scrollTop,l=!1;i>0?(this._scrollDown(r,s,e),r<e&&(l=!0)):(this._scrollUp(r,s,e),r>e&&(l=!0)),l&&requestAnimationFrame(function(){n._animateScroll(e,i)})},t}(),il=function(){function t(e){var i=e.element,n=e.classNames;this.element=i,this.classNames=n,this.isDisabled=!1}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.setAttribute("value",e),this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.conceal=function(){var e=this.element;ae(e,this.classNames.input),e.hidden=!0,e.tabIndex=-1;var i=e.getAttribute("style");i&&e.setAttribute("data-choice-orig-style",i),e.setAttribute("data-choice","active")},t.prototype.reveal=function(){var e=this.element;tt(e,this.classNames.input),e.hidden=!1,e.removeAttribute("tabindex");var i=e.getAttribute("data-choice-orig-style");i?(e.removeAttribute("data-choice-orig-style"),e.setAttribute("style",i)):e.removeAttribute("style"),e.removeAttribute("data-choice")},t.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},t.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},t.prototype.triggerEvent=function(e,i){uu(this.element,e,i||{})},t}(),_u=function(t){el(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(il),Wt=function(t,e){return e===void 0&&(e=!0),typeof t>"u"?e:!!t},nl=function(t){if(typeof t=="string"&&(t=t.split(" ").filter(function(e){return e.length})),Array.isArray(t)&&t.length)return t},et=function(t,e,i){if(i===void 0&&(i=!0),typeof t=="string"){var n=Si(t),s=i||n===t?t:{escaped:n,raw:t},r=et({value:t,label:s,selected:!0},!1);return r}var l=t;if("choices"in l){if(!e)throw new TypeError("optGroup is not allowed");var o=l,a=o.choices.map(function(d){return et(d,!1)}),c={id:0,label:St(o.label)||o.value,active:!!a.length,disabled:!!o.disabled,choices:a};return c}var u=l,f={id:0,group:null,score:0,rank:0,value:u.value,label:u.label||u.value,active:Wt(u.active),selected:Wt(u.selected,!1),disabled:Wt(u.disabled,!1),placeholder:Wt(u.placeholder,!1),highlighted:!1,labelClass:nl(u.labelClass),labelDescription:u.labelDescription,customProperties:u.customProperties};return f},vu=function(t){return t.tagName==="INPUT"},sl=function(t){return t.tagName==="SELECT"},bu=function(t){return t.tagName==="OPTION"},wu=function(t){return t.tagName==="OPTGROUP"},yu=function(t){el(e,t);function e(i){var n=i.element,s=i.classNames,r=i.template,l=i.extractPlaceholder,o=t.call(this,{element:n,classNames:s})||this;return o.template=r,o.extractPlaceholder=l,o}return Object.defineProperty(e.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),e.prototype.addOptions=function(i){var n=this,s=document.createDocumentFragment();i.forEach(function(r){var l=r;if(!l.element){var o=n.template(l);s.appendChild(o),l.element=o}}),this.element.appendChild(s)},e.prototype.optionsAsChoices=function(){var i=this,n=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(s){bu(s)?n.push(i._optionToChoice(s)):wu(s)&&n.push(i._optgroupToChoice(s))}),n},e.prototype._optionToChoice=function(i){return!i.hasAttribute("value")&&i.hasAttribute("placeholder")&&(i.setAttribute("value",""),i.value=""),{id:0,group:null,score:0,rank:0,value:i.value,label:i.label,element:i,active:!0,selected:this.extractPlaceholder?i.selected:i.hasAttribute("selected"),disabled:i.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!i.value||i.hasAttribute("placeholder")),labelClass:typeof i.dataset.labelClass<"u"?nl(i.dataset.labelClass):void 0,labelDescription:typeof i.dataset.labelDescription<"u"?i.dataset.labelDescription:void 0,customProperties:du(i.dataset.customProperties)}},e.prototype._optgroupToChoice=function(i){var n=this,s=i.querySelectorAll("option"),r=Array.from(s).map(function(l){return n._optionToChoice(l)});return{id:0,label:i.label||"",element:i,active:!!r.length,disabled:i.disabled,choices:r}},e}(il),ku={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},Cs={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(t){return!!t&&t!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:au,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(t){return'Press Enter to add <b>"'.concat(t,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(t){return"Remove item: ".concat(t)},maxItemText:function(t){return"Only ".concat(t," values can be added")},valueComparer:function(t,e){return t===e},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:ku,appendGroupInSearch:!1},Is=function(t){var e=t.itemEl;e&&(e.remove(),t.itemEl=void 0)};function Su(t,e,i){var n=t,s=!0;switch(e.type){case Ce.ADD_ITEM:{e.item.selected=!0;var r=e.item.element;r&&(r.selected=!0,r.setAttribute("selected","")),n.push(e.item);break}case Ce.REMOVE_ITEM:{e.item.selected=!1;var r=e.item.element;if(r){r.selected=!1,r.removeAttribute("selected");var l=r.parentElement;l&&sl(l)&&l.type===mt.SelectOne&&(l.value="")}Is(e.item),n=n.filter(function(u){return u.id!==e.item.id});break}case Ce.REMOVE_CHOICE:{Is(e.choice),n=n.filter(function(c){return c.id!==e.choice.id});break}case Ce.HIGHLIGHT_ITEM:{var o=e.highlighted,a=n.find(function(c){return c.id===e.item.id});a&&a.highlighted!==o&&(a.highlighted=o,i&&hu(a,o?i.classNames.highlightedState:i.classNames.selectedState,o?i.classNames.selectedState:i.classNames.highlightedState));break}default:{s=!1;break}}return{state:n,update:s}}function Eu(t,e){var i=t,n=!0;switch(e.type){case Ce.ADD_GROUP:{i.push(e.group);break}case Ce.CLEAR_CHOICES:{i=[];break}default:{n=!1;break}}return{state:i,update:n}}function Cu(t,e,i){var n=t,s=!0;switch(e.type){case Ce.ADD_CHOICE:{n.push(e.choice);break}case Ce.REMOVE_CHOICE:{e.choice.choiceEl=void 0,e.choice.group&&(e.choice.group.choices=e.choice.group.choices.filter(function(l){return l.id!==e.choice.id})),n=n.filter(function(l){return l.id!==e.choice.id});break}case Ce.ADD_ITEM:case Ce.REMOVE_ITEM:{e.item.choiceEl=void 0;break}case Ce.FILTER_CHOICES:{var r=[];e.results.forEach(function(l){r[l.item.id]=l}),n.forEach(function(l){var o=r[l.id];o!==void 0?(l.score=o.score,l.rank=o.rank,l.active=!0):(l.score=0,l.rank=0,l.active=!1),i&&i.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ce.ACTIVATE_CHOICES:{n.forEach(function(l){l.active=e.active,i&&i.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ce.CLEAR_CHOICES:{n=[];break}default:{s=!1;break}}return{state:n,update:s}}var Os={groups:Eu,items:Su,choices:Cu},Iu=function(){function t(e){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=e}return Object.defineProperty(t.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),t.prototype.changeSet=function(e){return{groups:e,items:e,choices:e}},t.prototype.reset=function(){this._state=this.defaultState;var e=this.changeSet(!0);this._txn?this._changeSet=e:this._listeners.forEach(function(i){return i(e)})},t.prototype.subscribe=function(e){return this._listeners.push(e),this},t.prototype.dispatch=function(e){var i=this,n=this._state,s=!1,r=this._changeSet||this.changeSet(!1);Object.keys(Os).forEach(function(l){var o=Os[l](n[l],e,i._context);o.update&&(s=!0,r[l]=!0,n[l]=o.state)}),s&&(this._txn?this._changeSet=r:this._listeners.forEach(function(l){return l(r)}))},t.prototype.withTxn=function(e){this._txn++;try{e()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var i=this._changeSet;i&&(this._changeSet=void 0,this._listeners.forEach(function(n){return n(i)}))}}},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(e){return e.active&&e.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeChoices",{get:function(){return this.choices.filter(function(e){return e.active})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(e){return!e.disabled&&!e.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeGroups",{get:function(){var e=this;return this.state.groups.filter(function(i){var n=i.active&&!i.disabled,s=e.state.choices.some(function(r){return r.active&&!r.disabled});return n&&s},[])},enumerable:!1,configurable:!0}),t.prototype.inTxn=function(){return this._txn>0},t.prototype.getChoiceById=function(e){return this.activeChoices.find(function(i){return i.id===e})},t.prototype.getGroupById=function(e){return this.groups.find(function(i){return i.id===e})},t}(),Le={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Ou(t,e,i){return(e=Tu(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function As(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),i.push.apply(i,n)}return i}function Tt(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?As(Object(i),!0).forEach(function(n){Ou(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):As(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function Au(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tu(t){var e=Au(t,"string");return typeof e=="symbol"?e:e+""}function ut(t){return Array.isArray?Array.isArray(t):ol(t)==="[object Array]"}const Pu=1/0;function Lu(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Pu?"-0":e}function Mu(t){return t==null?"":Lu(t)}function it(t){return typeof t=="string"}function rl(t){return typeof t=="number"}function Ru(t){return t===!0||t===!1||Du(t)&&ol(t)=="[object Boolean]"}function ll(t){return typeof t=="object"}function Du(t){return ll(t)&&t!==null}function He(t){return t!=null}function Fi(t){return!t.trim().length}function ol(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Nu="Incorrect 'index' type",ju=t=>`Invalid value for key ${t}`,$u=t=>`Pattern length exceeds max of ${t}.`,Fu=t=>`Missing ${t} property in key`,Uu=t=>`Property 'weight' in key '${t}' must be a positive integer`,Ts=Object.prototype.hasOwnProperty;class Vu{constructor(e){this._keys=[],this._keyMap={};let i=0;e.forEach(n=>{let s=al(n);this._keys.push(s),this._keyMap[s.id]=s,i+=s.weight}),this._keys.forEach(n=>{n.weight/=i})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function al(t){let e=null,i=null,n=null,s=1,r=null;if(it(t)||ut(t))n=t,e=Ps(t),i=xi(t);else{if(!Ts.call(t,"name"))throw new Error(Fu("name"));const l=t.name;if(n=l,Ts.call(t,"weight")&&(s=t.weight,s<=0))throw new Error(Uu(l));e=Ps(l),i=xi(l),r=t.getFn}return{path:e,id:i,weight:s,src:n,getFn:r}}function Ps(t){return ut(t)?t:t.split(".")}function xi(t){return ut(t)?t.join("."):t}function Hu(t,e){let i=[],n=!1;const s=(r,l,o)=>{if(He(r))if(!l[o])i.push(r);else{let a=l[o];const c=r[a];if(!He(c))return;if(o===l.length-1&&(it(c)||rl(c)||Ru(c)))i.push(Mu(c));else if(ut(c)){n=!0;for(let u=0,f=c.length;u<f;u+=1)s(c[u],l,o+1)}else l.length&&s(c,l,o+1)}};return s(t,it(e)?e.split("."):e,0),n?i:i[0]}const Bu={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},zu={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},qu={location:0,threshold:.6,distance:100},Ku={useExtendedSearch:!1,getFn:Hu,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var le=Tt(Tt(Tt(Tt({},zu),Bu),qu),Ku);const xu=/[^ ]+/g;function Wu(t=1,e=3){const i=new Map,n=Math.pow(10,e);return{get(s){const r=s.match(xu).length;if(i.has(r))return i.get(r);const l=1/Math.pow(r,.5*t),o=parseFloat(Math.round(l*n)/n);return i.set(r,o),o},clear(){i.clear()}}}class fn{constructor({getFn:e=le.getFn,fieldNormWeight:i=le.fieldNormWeight}={}){this.norm=Wu(i,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((i,n)=>{this._keysMap[i.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,it(this.docs[0])?this.docs.forEach((e,i)=>{this._addString(e,i)}):this.docs.forEach((e,i)=>{this._addObject(e,i)}),this.norm.clear())}add(e){const i=this.size();it(e)?this._addString(e,i):this._addObject(e,i)}removeAt(e){this.records.splice(e,1);for(let i=e,n=this.size();i<n;i+=1)this.records[i].i-=1}getValueForItemAtKeyId(e,i){return e[this._keysMap[i]]}size(){return this.records.length}_addString(e,i){if(!He(e)||Fi(e))return;let n={v:e,i,n:this.norm.get(e)};this.records.push(n)}_addObject(e,i){let n={i,$:{}};this.keys.forEach((s,r)=>{let l=s.getFn?s.getFn(e):this.getFn(e,s.path);if(He(l)){if(ut(l)){let o=[];const a=[{nestedArrIndex:-1,value:l}];for(;a.length;){const{nestedArrIndex:c,value:u}=a.pop();if(He(u))if(it(u)&&!Fi(u)){let f={v:u,i:c,n:this.norm.get(u)};o.push(f)}else ut(u)&&u.forEach((f,d)=>{a.push({nestedArrIndex:d,value:f})})}n.$[r]=o}else if(it(l)&&!Fi(l)){let o={v:l,n:this.norm.get(l)};n.$[r]=o}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function cl(t,e,{getFn:i=le.getFn,fieldNormWeight:n=le.fieldNormWeight}={}){const s=new fn({getFn:i,fieldNormWeight:n});return s.setKeys(t.map(al)),s.setSources(e),s.create(),s}function Gu(t,{getFn:e=le.getFn,fieldNormWeight:i=le.fieldNormWeight}={}){const{keys:n,records:s}=t,r=new fn({getFn:e,fieldNormWeight:i});return r.setKeys(n),r.setIndexRecords(s),r}function oi(t,{errors:e=0,currentLocation:i=0,expectedLocation:n=0,distance:s=le.distance,ignoreLocation:r=le.ignoreLocation}={}){const l=e/t.length;if(r)return l;const o=Math.abs(n-i);return s?l+o/s:o?1:l}function Yu(t=[],e=le.minMatchCharLength){let i=[],n=-1,s=-1,r=0;for(let l=t.length;r<l;r+=1){let o=t[r];o&&n===-1?n=r:!o&&n!==-1&&(s=r-1,s-n+1>=e&&i.push([n,s]),n=-1)}return t[r-1]&&r-n>=e&&i.push([n,r-1]),i}const kt=32;function Ju(t,e,i,{location:n=le.location,distance:s=le.distance,threshold:r=le.threshold,findAllMatches:l=le.findAllMatches,minMatchCharLength:o=le.minMatchCharLength,includeMatches:a=le.includeMatches,ignoreLocation:c=le.ignoreLocation}={}){if(e.length>kt)throw new Error($u(kt));const u=e.length,f=t.length,d=Math.max(0,Math.min(n,f));let h=r,p=d;const g=o>1||a,v=g?Array(f):[];let y;for(;(y=t.indexOf(e,p))>-1;){let F=oi(e,{currentLocation:y,expectedLocation:d,distance:s,ignoreLocation:c});if(h=Math.min(F,h),p=y+u,g){let E=0;for(;E<u;)v[y+E]=1,E+=1}}p=-1;let O=[],P=1,C=u+f;const T=1<<u-1;for(let F=0;F<u;F+=1){let E=0,D=C;for(;E<D;)oi(e,{errors:F,currentLocation:d+D,expectedLocation:d,distance:s,ignoreLocation:c})<=h?E=D:C=D,D=Math.floor((C-E)/2+E);C=D;let Y=Math.max(1,d-D+1),z=l?f:Math.min(d+D,f)+u,L=Array(z+2);L[z+1]=(1<<F)-1;for(let q=z;q>=Y;q-=1){let K=q-1,U=i[t.charAt(K)];if(g&&(v[K]=+!!U),L[q]=(L[q+1]<<1|1)&U,F&&(L[q]|=(O[q+1]|O[q])<<1|1|O[q+1]),L[q]&T&&(P=oi(e,{errors:F,currentLocation:K,expectedLocation:d,distance:s,ignoreLocation:c}),P<=h)){if(h=P,p=K,p<=d)break;Y=Math.max(1,2*d-p)}}if(oi(e,{errors:F+1,currentLocation:d,expectedLocation:d,distance:s,ignoreLocation:c})>h)break;O=L}const j={isMatch:p>=0,score:Math.max(.001,P)};if(g){const F=Yu(v,o);F.length?a&&(j.indices=F):j.isMatch=!1}return j}function Xu(t){let e={};for(let i=0,n=t.length;i<n;i+=1){const s=t.charAt(i);e[s]=(e[s]||0)|1<<n-i-1}return e}class ul{constructor(e,{location:i=le.location,threshold:n=le.threshold,distance:s=le.distance,includeMatches:r=le.includeMatches,findAllMatches:l=le.findAllMatches,minMatchCharLength:o=le.minMatchCharLength,isCaseSensitive:a=le.isCaseSensitive,ignoreLocation:c=le.ignoreLocation}={}){if(this.options={location:i,threshold:n,distance:s,includeMatches:r,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(d,h)=>{this.chunks.push({pattern:d,alphabet:Xu(d),startIndex:h})},f=this.pattern.length;if(f>kt){let d=0;const h=f%kt,p=f-h;for(;d<p;)u(this.pattern.substr(d,kt),d),d+=kt;if(h){const g=f-kt;u(this.pattern.substr(g),g)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:i,includeMatches:n}=this.options;if(i||(e=e.toLowerCase()),this.pattern===e){let p={isMatch:!0,score:0};return n&&(p.indices=[[0,e.length-1]]),p}const{location:s,distance:r,threshold:l,findAllMatches:o,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],f=0,d=!1;this.chunks.forEach(({pattern:p,alphabet:g,startIndex:v})=>{const{isMatch:y,score:O,indices:P}=Ju(e,p,g,{location:s+v,distance:r,threshold:l,findAllMatches:o,minMatchCharLength:a,includeMatches:n,ignoreLocation:c});y&&(d=!0),f+=O,y&&P&&(u=[...u,...P])});let h={isMatch:d,score:d?f/this.chunks.length:1};return d&&n&&(h.indices=u),h}}class bt{constructor(e){this.pattern=e}static isMultiMatch(e){return Ls(e,this.multiRegex)}static isSingleMatch(e){return Ls(e,this.singleRegex)}search(){}}function Ls(t,e){const i=t.match(e);return i?i[1]:null}class Qu extends bt{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const i=e===this.pattern;return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}}class Zu extends bt{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class ef extends bt{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const i=e.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}}class tf extends bt{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const i=!e.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class nf extends bt{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const i=e.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class sf extends bt{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const i=!e.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class fl extends bt{constructor(e,{location:i=le.location,threshold:n=le.threshold,distance:s=le.distance,includeMatches:r=le.includeMatches,findAllMatches:l=le.findAllMatches,minMatchCharLength:o=le.minMatchCharLength,isCaseSensitive:a=le.isCaseSensitive,ignoreLocation:c=le.ignoreLocation}={}){super(e),this._bitapSearch=new ul(e,{location:i,threshold:n,distance:s,includeMatches:r,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class dl extends bt{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let i=0,n;const s=[],r=this.pattern.length;for(;(n=e.indexOf(this.pattern,i))>-1;)i=n+r,s.push([n,i-1]);const l=!!s.length;return{isMatch:l,score:l?0:1,indices:s}}}const Wi=[Qu,dl,ef,tf,sf,nf,Zu,fl],Ms=Wi.length,rf=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,lf="|";function of(t,e={}){return t.split(lf).map(i=>{let n=i.trim().split(rf).filter(r=>r&&!!r.trim()),s=[];for(let r=0,l=n.length;r<l;r+=1){const o=n[r];let a=!1,c=-1;for(;!a&&++c<Ms;){const u=Wi[c];let f=u.isMultiMatch(o);f&&(s.push(new u(f,e)),a=!0)}if(!a)for(c=-1;++c<Ms;){const u=Wi[c];let f=u.isSingleMatch(o);if(f){s.push(new u(f,e));break}}}return s})}const af=new Set([fl.type,dl.type]);class cf{constructor(e,{isCaseSensitive:i=le.isCaseSensitive,includeMatches:n=le.includeMatches,minMatchCharLength:s=le.minMatchCharLength,ignoreLocation:r=le.ignoreLocation,findAllMatches:l=le.findAllMatches,location:o=le.location,threshold:a=le.threshold,distance:c=le.distance}={}){this.query=null,this.options={isCaseSensitive:i,includeMatches:n,minMatchCharLength:s,findAllMatches:l,ignoreLocation:r,location:o,threshold:a,distance:c},this.pattern=i?e:e.toLowerCase(),this.query=of(this.pattern,this.options)}static condition(e,i){return i.useExtendedSearch}searchIn(e){const i=this.query;if(!i)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:s}=this.options;e=s?e:e.toLowerCase();let r=0,l=[],o=0;for(let a=0,c=i.length;a<c;a+=1){const u=i[a];l.length=0,r=0;for(let f=0,d=u.length;f<d;f+=1){const h=u[f],{isMatch:p,indices:g,score:v}=h.search(e);if(p){if(r+=1,o+=v,n){const y=h.constructor.type;af.has(y)?l=[...l,...g]:l.push(g)}}else{o=0,r=0,l.length=0;break}}if(r){let f={isMatch:!0,score:o/r};return n&&(f.indices=l),f}}return{isMatch:!1,score:1}}}const Gi=[];function uf(...t){Gi.push(...t)}function Yi(t,e){for(let i=0,n=Gi.length;i<n;i+=1){let s=Gi[i];if(s.condition(t,e))return new s(t,e)}return new ul(t,e)}const _i={AND:"$and",OR:"$or"},Ji={PATH:"$path",PATTERN:"$val"},Xi=t=>!!(t[_i.AND]||t[_i.OR]),ff=t=>!!t[Ji.PATH],df=t=>!ut(t)&&ll(t)&&!Xi(t),Rs=t=>({[_i.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function hl(t,e,{auto:i=!0}={}){const n=s=>{let r=Object.keys(s);const l=ff(s);if(!l&&r.length>1&&!Xi(s))return n(Rs(s));if(df(s)){const a=l?s[Ji.PATH]:r[0],c=l?s[Ji.PATTERN]:s[a];if(!it(c))throw new Error(ju(a));const u={keyId:xi(a),pattern:c};return i&&(u.searcher=Yi(c,e)),u}let o={children:[],operator:r[0]};return r.forEach(a=>{const c=s[a];ut(c)&&c.forEach(u=>{o.children.push(n(u))})}),o};return Xi(t)||(t=Rs(t)),n(t)}function hf(t,{ignoreFieldNorm:e=le.ignoreFieldNorm}){t.forEach(i=>{let n=1;i.matches.forEach(({key:s,norm:r,score:l})=>{const o=s?s.weight:null;n*=Math.pow(l===0&&o?Number.EPSILON:l,(o||1)*(e?1:r))}),i.score=n})}function mf(t,e){const i=t.matches;e.matches=[],He(i)&&i.forEach(n=>{if(!He(n.indices)||!n.indices.length)return;const{indices:s,value:r}=n;let l={indices:s,value:r};n.key&&(l.key=n.key.src),n.idx>-1&&(l.refIndex=n.idx),e.matches.push(l)})}function pf(t,e){e.score=t.score}function gf(t,e,{includeMatches:i=le.includeMatches,includeScore:n=le.includeScore}={}){const s=[];return i&&s.push(mf),n&&s.push(pf),t.map(r=>{const{idx:l}=r,o={item:e[l],refIndex:l};return s.length&&s.forEach(a=>{a(r,o)}),o})}class Vt{constructor(e,i={},n){this.options=Tt(Tt({},le),i),this.options.useExtendedSearch,this._keyStore=new Vu(this.options.keys),this.setCollection(e,n)}setCollection(e,i){if(this._docs=e,i&&!(i instanceof fn))throw new Error(Nu);this._myIndex=i||cl(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){He(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const i=[];for(let n=0,s=this._docs.length;n<s;n+=1){const r=this._docs[n];e(r,n)&&(this.removeAt(n),n-=1,s-=1,i.push(r))}return i}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:i=-1}={}){const{includeMatches:n,includeScore:s,shouldSort:r,sortFn:l,ignoreFieldNorm:o}=this.options;let a=it(e)?it(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return hf(a,{ignoreFieldNorm:o}),r&&a.sort(l),rl(i)&&i>-1&&(a=a.slice(0,i)),gf(a,this._docs,{includeMatches:n,includeScore:s})}_searchStringList(e){const i=Yi(e,this.options),{records:n}=this._myIndex,s=[];return n.forEach(({v:r,i:l,n:o})=>{if(!He(r))return;const{isMatch:a,score:c,indices:u}=i.searchIn(r);a&&s.push({item:r,idx:l,matches:[{score:c,value:r,norm:o,indices:u}]})}),s}_searchLogical(e){const i=hl(e,this.options),n=(o,a,c)=>{if(!o.children){const{keyId:f,searcher:d}=o,h=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(a,f),searcher:d});return h&&h.length?[{idx:c,item:a,matches:h}]:[]}const u=[];for(let f=0,d=o.children.length;f<d;f+=1){const h=o.children[f],p=n(h,a,c);if(p.length)u.push(...p);else if(o.operator===_i.AND)return[]}return u},s=this._myIndex.records,r={},l=[];return s.forEach(({$:o,i:a})=>{if(He(o)){let c=n(i,o,a);c.length&&(r[a]||(r[a]={idx:a,item:o,matches:[]},l.push(r[a])),c.forEach(({matches:u})=>{r[a].matches.push(...u)}))}}),l}_searchObjectList(e){const i=Yi(e,this.options),{keys:n,records:s}=this._myIndex,r=[];return s.forEach(({$:l,i:o})=>{if(!He(l))return;let a=[];n.forEach((c,u)=>{a.push(...this._findMatches({key:c,value:l[u],searcher:i}))}),a.length&&r.push({idx:o,item:l,matches:a})}),r}_findMatches({key:e,value:i,searcher:n}){if(!He(i))return[];let s=[];if(ut(i))i.forEach(({v:r,i:l,n:o})=>{if(!He(r))return;const{isMatch:a,score:c,indices:u}=n.searchIn(r);a&&s.push({score:c,key:e,value:r,idx:l,norm:o,indices:u})});else{const{v:r,n:l}=i,{isMatch:o,score:a,indices:c}=n.searchIn(r);o&&s.push({score:a,key:e,value:r,norm:l,indices:c})}return s}}Vt.version="7.0.0";Vt.createIndex=cl;Vt.parseIndex=Gu;Vt.config=le;Vt.parseQuery=hl;uf(cf);var _f=function(){function t(e){this._haystack=[],this._fuseOptions=Ve(Ve({},e.fuseOptions),{keys:Xc([],e.searchFields,!0),includeMatches:!0})}return t.prototype.index=function(e){this._haystack=e,this._fuse&&this._fuse.setCollection(e)},t.prototype.reset=function(){this._haystack=[],this._fuse=void 0},t.prototype.isEmptyIndex=function(){return!this._haystack.length},t.prototype.search=function(e){this._fuse||(this._fuse=new Vt(this._haystack,this._fuseOptions));var i=this._fuse.search(e);return i.map(function(n,s){return{item:n.item,score:n.score||0,rank:s+1}})},t}();function vf(t){return new _f(t)}var bf=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},Ui=function(t,e,i){var n=t.dataset,s=e.customProperties,r=e.labelClass,l=e.labelDescription;r&&(n.labelClass=Ei(r).join(" ")),l&&(n.labelDescription=l),i&&s&&(typeof s=="string"?n.customProperties=s:typeof s=="object"&&!bf(s)&&(n.customProperties=JSON.stringify(s)))},Ds=function(t,e,i){var n=e&&t.querySelector("label[for='".concat(e,"']")),s=n&&n.innerText;s&&i.setAttribute("aria-label",s)},wf={containerOuter:function(t,e,i,n,s,r,l){var o=t.classNames.containerOuter,a=document.createElement("div");return ae(a,o),a.dataset.type=r,e&&(a.dir=e),n&&(a.tabIndex=0),i&&(a.setAttribute("role",s?"combobox":"listbox"),s?a.setAttribute("aria-autocomplete","list"):l||Ds(this._docRoot,this.passedElement.element.id,a),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false")),l&&a.setAttribute("aria-labelledby",l),a},containerInner:function(t){var e=t.classNames.containerInner,i=document.createElement("div");return ae(i,e),i},itemList:function(t,e){var i=t.searchEnabled,n=t.classNames,s=n.list,r=n.listSingle,l=n.listItems,o=document.createElement("div");return ae(o,s),ae(o,e?r:l),this._isSelectElement&&i&&o.setAttribute("role","listbox"),o},placeholder:function(t,e){var i=t.allowHTML,n=t.classNames.placeholder,s=document.createElement("div");return ae(s,n),rt(s,i,e),s},item:function(t,e,i){var n=t.allowHTML,s=t.removeItemButtonAlignLeft,r=t.removeItemIconText,l=t.removeItemLabelText,o=t.classNames,a=o.item,c=o.button,u=o.highlightedState,f=o.itemSelectable,d=o.placeholder,h=St(e.value),p=document.createElement("div");if(ae(p,a),e.labelClass){var g=document.createElement("span");rt(g,n,e.label),ae(g,e.labelClass),p.appendChild(g)}else rt(p,n,e.label);if(p.dataset.item="",p.dataset.id=e.id,p.dataset.value=h,Ui(p,e,!0),(e.disabled||this.containerOuter.isDisabled)&&p.setAttribute("aria-disabled","true"),this._isSelectElement&&(p.setAttribute("aria-selected","true"),p.setAttribute("role","option")),e.placeholder&&(ae(p,d),p.dataset.placeholder=""),ae(p,e.highlighted?u:f),i){e.disabled&&tt(p,f),p.dataset.deletable="";var v=document.createElement("button");v.type="button",ae(v,c),rt(v,!0,Gt(r,e.value));var y=Gt(l,e.value);y&&v.setAttribute("aria-label",y),v.dataset.button="",s?p.insertAdjacentElement("afterbegin",v):p.appendChild(v)}return p},choiceList:function(t,e){var i=t.classNames.list,n=document.createElement("div");return ae(n,i),e||n.setAttribute("aria-multiselectable","true"),n.setAttribute("role","listbox"),n},choiceGroup:function(t,e){var i=t.allowHTML,n=t.classNames,s=n.group,r=n.groupHeading,l=n.itemDisabled,o=e.id,a=e.label,c=e.disabled,u=St(a),f=document.createElement("div");ae(f,s),c&&ae(f,l),f.setAttribute("role","group"),f.dataset.group="",f.dataset.id=o,f.dataset.value=u,c&&f.setAttribute("aria-disabled","true");var d=document.createElement("div");return ae(d,r),rt(d,i,a||""),f.appendChild(d),f},choice:function(t,e,i,n){var s=t.allowHTML,r=t.classNames,l=r.item,o=r.itemChoice,a=r.itemSelectable,c=r.selectedState,u=r.itemDisabled,f=r.description,d=r.placeholder,h=e.label,p=St(e.value),g=document.createElement("div");g.id=e.elementId,ae(g,l),ae(g,o),n&&typeof h=="string"&&(h=un(s,h),h+=" (".concat(n,")"),h={trusted:h});var v=g;if(e.labelClass){var y=document.createElement("span");rt(y,s,h),ae(y,e.labelClass),v=y,g.appendChild(y)}else rt(g,s,h);if(e.labelDescription){var O="".concat(e.elementId,"-description");v.setAttribute("aria-describedby",O);var P=document.createElement("span");rt(P,s,e.labelDescription),P.id=O,ae(P,f),g.appendChild(P)}return e.selected&&ae(g,c),e.placeholder&&ae(g,d),g.setAttribute("role",e.group?"treeitem":"option"),g.dataset.choice="",g.dataset.id=e.id,g.dataset.value=p,i&&(g.dataset.selectText=i),e.group&&(g.dataset.groupId="".concat(e.group.id)),Ui(g,e,!1),e.disabled?(ae(g,u),g.dataset.choiceDisabled="",g.setAttribute("aria-disabled","true")):(ae(g,a),g.dataset.choiceSelectable=""),g},input:function(t,e){var i=t.classNames,n=i.input,s=i.inputCloned,r=t.labelId,l=document.createElement("input");return l.type="search",ae(l,n),ae(l,s),l.autocomplete="off",l.autocapitalize="off",l.spellcheck=!1,l.setAttribute("aria-autocomplete","list"),e?l.setAttribute("aria-label",e):r||Ds(this._docRoot,this.passedElement.element.id,l),l},dropdown:function(t){var e=t.classNames,i=e.list,n=e.listDropdown,s=document.createElement("div");return ae(s,i),ae(s,n),s.setAttribute("aria-expanded","false"),s},notice:function(t,e,i){var n=t.classNames,s=n.item,r=n.itemChoice,l=n.addChoice,o=n.noResults,a=n.noChoices,c=n.notice;i===void 0&&(i=Le.generic);var u=document.createElement("div");switch(rt(u,!0,e),ae(u,s),ae(u,r),ae(u,c),i){case Le.addChoice:ae(u,l);break;case Le.noResults:ae(u,o);break;case Le.noChoices:ae(u,a);break}return i===Le.addChoice&&(u.dataset.choiceSelectable="",u.dataset.choice=""),u},option:function(t){var e=St(t.label),i=new Option(e,t.value,!1,t.selected);return Ui(i,t,!0),i.disabled=t.disabled,t.selected&&i.setAttribute("selected",""),i}},yf="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,kf={},Vi=function(t){if(t)return t.dataset.id?parseInt(t.dataset.id,10):void 0},xt="[data-choice-selectable]",Sf=function(){function t(e,i){e===void 0&&(e="[data-choice]"),i===void 0&&(i={});var n=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var s=t.defaults;this.config=Ve(Ve(Ve({},s.allOptions),s.options),i),Qc.forEach(function(y){n.config[y]=Ve(Ve(Ve({},s.allOptions[y]),s.options[y]),i[y])});var r=this.config;r.silent||this._validateConfig();var l=r.shadowRoot||document.documentElement;this._docRoot=l;var o=typeof e=="string"?l.querySelector(e):e;if(!o||typeof o!="object"||!(vu(o)||sl(o)))throw TypeError(!o&&typeof e=="string"?"Selector ".concat(e," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var a=o.type,c=a===mt.Text;(c||r.maxItemCount!==1)&&(r.singleModeForMultiSelect=!1),r.singleModeForMultiSelect&&(a=mt.SelectMultiple);var u=a===mt.SelectOne,f=a===mt.SelectMultiple,d=u||f;if(this._elementType=a,this._isTextElement=c,this._isSelectOneElement=u,this._isSelectMultipleElement=f,this._isSelectElement=u||f,this._canAddUserChoices=c&&r.addItems||d&&r.addChoices,typeof r.renderSelectedChoices!="boolean"&&(r.renderSelectedChoices=r.renderSelectedChoices==="always"||u),r.closeDropdownOnSelect==="auto"?r.closeDropdownOnSelect=c||u||r.singleModeForMultiSelect:r.closeDropdownOnSelect=Wt(r.closeDropdownOnSelect),r.placeholder&&(r.placeholderValue?this._hasNonChoicePlaceholder=!0:o.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,r.placeholderValue=o.dataset.placeholder)),i.addItemFilter&&typeof i.addItemFilter!="function"){var h=i.addItemFilter instanceof RegExp?i.addItemFilter:new RegExp(i.addItemFilter);r.addItemFilter=h.test.bind(h)}if(this._isTextElement)this.passedElement=new _u({element:o,classNames:r.classNames});else{var p=o;this.passedElement=new yu({element:p,classNames:r.classNames,template:function(y){return n._templates.option(y)},extractPlaceholder:r.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Iu(r),this._currentValue="",r.searchEnabled=!c&&r.searchEnabled||f,this._canSearch=r.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=su(o,"choices-"),this._direction=o.dir,!this._direction){var g=window.getComputedStyle(o).direction,v=window.getComputedStyle(document.documentElement).direction;g!==v&&(this._direction=g)}if(this._idNames={itemChoice:"item-choice"},this._templates=s.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){r.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(y){return y.value})}return Object.defineProperty(t,"defaults",{get:function(){return Object.preventExtensions({get options(){return kf},get allOptions(){return Cs},get templates(){return wf}})},enumerable:!1,configurable:!0}),t.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=vf(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var e=this.config.callbackOnInit;typeof e=="function"&&e.call(this)}},t.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=t.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},t.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},t.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},t.prototype.highlightItem=function(e,i){if(i===void 0&&(i=!0),!e||!e.id)return this;var n=this._store.items.find(function(s){return s.id===e.id});return!n||n.highlighted?this:(this._store.dispatch(li(n,!0)),i&&this.passedElement.triggerEvent(Ue.highlightItem,this._getChoiceForOutput(n)),this)},t.prototype.unhighlightItem=function(e,i){if(i===void 0&&(i=!0),!e||!e.id)return this;var n=this._store.items.find(function(s){return s.id===e.id});return!n||!n.highlighted?this:(this._store.dispatch(li(n,!1)),i&&this.passedElement.triggerEvent(Ue.unhighlightItem,this._getChoiceForOutput(n)),this)},t.prototype.highlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(i){i.highlighted||(e._store.dispatch(li(i,!0)),e.passedElement.triggerEvent(Ue.highlightItem,e._getChoiceForOutput(i)))})}),this},t.prototype.unhighlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(i){i.highlighted&&(e._store.dispatch(li(i,!1)),e.passedElement.triggerEvent(Ue.highlightItem,e._getChoiceForOutput(i)))})}),this},t.prototype.removeActiveItemsByValue=function(e){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(n){return n.value===e}).forEach(function(n){return i._removeItem(n)})}),this},t.prototype.removeActiveItems=function(e){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(n){var s=n.id;return s!==e}).forEach(function(n){return i._removeItem(n)})}),this},t.prototype.removeHighlightedItems=function(e){var i=this;return e===void 0&&(e=!1),this._store.withTxn(function(){i._store.highlightedActiveItems.forEach(function(n){i._removeItem(n),e&&i._triggerChange(n.value)})}),this},t.prototype.showDropdown=function(e){var i=this;return this.dropdown.isActive?this:(e===void 0&&(e=!this._canSearch),requestAnimationFrame(function(){i.dropdown.show();var n=i.dropdown.element.getBoundingClientRect();i.containerOuter.open(n.bottom,n.height),e||i.input.focus(),i.passedElement.triggerEvent(Ue.showDropdown)}),this)},t.prototype.hideDropdown=function(e){var i=this;return this.dropdown.isActive?(requestAnimationFrame(function(){i.dropdown.hide(),i.containerOuter.close(),!e&&i._canSearch&&(i.input.removeActiveDescendant(),i.input.blur()),i.passedElement.triggerEvent(Ue.hideDropdown)}),this):this},t.prototype.getValue=function(e){var i=this,n=this._store.items.map(function(s){return e?s.value:i._getChoiceForOutput(s)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?n[0]:n},t.prototype.setValue=function(e){var i=this;return this.initialisedOK?(this._store.withTxn(function(){e.forEach(function(n){n&&i._addChoice(et(n,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},t.prototype.setChoiceByValue=function(e){var i=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var n=Array.isArray(e)?e:[e];n.forEach(function(s){return i._findAndSelectChoiceByValue(s)}),i.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},t.prototype.setChoices=function(e,i,n,s,r,l){var o=this;if(e===void 0&&(e=[]),i===void 0&&(i="value"),n===void 0&&(n="label"),s===void 0&&(s=!1),r===void 0&&(r=!0),l===void 0&&(l=!1),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof i!="string"||!i)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(typeof e=="function"){var a=e(this);if(typeof Promise=="function"&&a instanceof Promise)return new Promise(function(c){return requestAnimationFrame(c)}).then(function(){return o._handleLoadingState(!0)}).then(function(){return a}).then(function(c){return o.setChoices(c,i,n,s,r,l)}).catch(function(c){o.config.silent||console.error(c)}).then(function(){return o._handleLoadingState(!1)}).then(function(){return o});if(!Array.isArray(a))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof a));return this.setChoices(a,i,n,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){r&&(o._isSearching=!1),s&&o.clearChoices(!0,l);var c=i==="value",u=n==="label";e.forEach(function(f){if("choices"in f){var d=f;u||(d=Ve(Ve({},d),{label:d[n]})),o._addGroup(et(d,!0))}else{var h=f;(!u||!c)&&(h=Ve(Ve({},h),{value:h[i],label:h[n]}));var p=et(h,!1);o._addChoice(p),p.placeholder&&!o._hasNonChoicePlaceholder&&(o._placeholderValue=tl(p.label))}}),o.unhighlightAll()}),this._searcher.reset(),this},t.prototype.refresh=function(e,i,n){var s=this;return e===void 0&&(e=!1),i===void 0&&(i=!1),n===void 0&&(n=!1),this._isSelectElement?(this._store.withTxn(function(){var r=s.passedElement.optionsAsChoices(),l={};n||s._store.items.forEach(function(a){a.id&&a.active&&a.selected&&(l[a.value]=!0)}),s.clearStore(!1);var o=function(a){n?s._store.dispatch(ws(a)):l[a.value]&&(a.selected=!0)};r.forEach(function(a){if("choices"in a){a.choices.forEach(o);return}o(a)}),s._addPredefinedChoices(r,i,e),s._isSearching&&s._searchChoices(s.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},t.prototype.removeChoice=function(e){var i=this._store.choices.find(function(n){return n.value===e});return i?(this._clearNotice(),this._store.dispatch(Zc(i)),this._searcher.reset(),i.selected&&this.passedElement.triggerEvent(Ue.removeItem,this._getChoiceForOutput(i)),this):this},t.prototype.clearChoices=function(e,i){var n=this;return e===void 0&&(e=!0),i===void 0&&(i=!1),e&&(i?this.passedElement.element.replaceChildren(""):this.passedElement.element.querySelectorAll(":not([selected])").forEach(function(s){s.remove()})),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.withTxn(function(){var s=i?[]:n._store.items;n._store.reset(),s.forEach(function(r){n._store.dispatch(vs(r)),n._store.dispatch(bs(r))})}),this._searcher.reset(),this},t.prototype.clearStore=function(e){return e===void 0&&(e=!0),this.clearChoices(e,!0),this._stopSearch(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this},t.prototype.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),this._stopSearch(),this},t.prototype._validateConfig=function(){var e=this.config,i=fu(e,Cs);i.length&&console.warn("Unknown config option(s) passed",i.join(", ")),e.allowHTML&&e.allowHtmlUserInput&&(e.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),e.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},t.prototype._render=function(e){e===void 0&&(e={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(e.choices||e.groups)&&this._renderChoices(),e.items&&this._renderItems())},t.prototype._renderChoices=function(){var e=this;if(this._canAddItems()){var i=this,n=i.config,s=i._isSearching,r=this._store,l=r.activeGroups,o=r.activeChoices,a=0;if(s&&n.searchResultLimit>0?a=n.searchResultLimit:n.renderChoiceLimit>0&&(a=n.renderChoiceLimit),this._isSelectElement){var c=o.filter(function(p){return!p.element});c.length&&this.passedElement.addOptions(c)}var u=document.createDocumentFragment(),f=function(p){return p.filter(function(g){return!g.placeholder&&(s?!!g.rank:n.renderSelectedChoices||!g.selected)})},d=!1,h=function(p,g,v){s?p.sort(cu):n.shouldSort&&p.sort(n.sorter);var y=p.length;y=!g&&a&&y>a?a:y,y--,p.every(function(O,P){var C=O.choiceEl||e._templates.choice(n,O,n.itemSelectText,v);return O.choiceEl=C,u.appendChild(C),(s||!O.selected)&&(d=!0),P<y})};o.length&&(n.resetScrollPosition&&requestAnimationFrame(function(){return e.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!s&&this._isSelectOneElement&&h(o.filter(function(p){return p.placeholder&&!p.group}),!1,void 0),l.length&&!s?(n.shouldSort&&l.sort(n.sorter),h(o.filter(function(p){return!p.placeholder&&!p.group}),!1,void 0),l.forEach(function(p){var g=f(p.choices);if(g.length){if(p.label){var v=p.groupEl||e._templates.choiceGroup(e.config,p);p.groupEl=v,v.remove(),u.appendChild(v)}h(g,!0,n.appendGroupInSearch&&s?p.label:void 0)}})):h(f(o),!1,void 0)),!d&&(s||!u.children.length||!n.renderSelectedChoices)&&(this._notice||(this._notice={text:ks(s?n.noResultsText:n.noChoicesText),type:s?Le.noResults:Le.noChoices}),u.replaceChildren("")),this._renderNotice(u),this.choiceList.element.replaceChildren(u),d&&this._highlightChoice()}},t.prototype._renderItems=function(){var e=this,i=this._store.items||[],n=this.itemList.element,s=this.config,r=document.createDocumentFragment(),l=function(f){return n.querySelector('[data-item][data-id="'.concat(f.id,'"]'))},o=function(f){var d=f.itemEl;d&&d.parentElement||(d=l(f)||e._templates.item(s,f,s.removeItemButton),f.itemEl=d,r.appendChild(d))};i.forEach(o);var a=!!r.childNodes.length;if(this._isSelectOneElement){var c=n.children.length;if(a||c>1){var u=n.querySelector(Kt(s.classNames.placeholder));u&&u.remove()}else!a&&!c&&this._placeholderValue&&(a=!0,o(et({selected:!0,value:"",label:this._placeholderValue,placeholder:!0},!1)))}a&&(n.append(r),s.shouldSortItems&&!this._isSelectOneElement&&(i.sort(s.sorter),i.forEach(function(f){var d=l(f);d&&(d.remove(),r.append(d))}),n.append(r))),this._isTextElement&&(this.passedElement.value=i.map(function(f){var d=f.value;return d}).join(s.delimiter))},t.prototype._displayNotice=function(e,i,n){n===void 0&&(n=!0);var s=this._notice;if(s&&(s.type===i&&s.text===e||s.type===Le.addChoice&&(i===Le.noResults||i===Le.noChoices))){n&&this.showDropdown(!0);return}this._clearNotice(),this._notice=e?{text:e,type:i}:void 0,this._renderNotice(),n&&e&&this.showDropdown(!0)},t.prototype._clearNotice=function(){if(this._notice){var e=this.choiceList.element.querySelector(Kt(this.config.classNames.notice));e&&e.remove(),this._notice=void 0}},t.prototype._renderNotice=function(e){var i=this._notice;if(i){var n=this._templates.notice(this.config,i.text,i.type);e?e.append(n):this.choiceList.prepend(n)}},t.prototype._getChoiceForOutput=function(e,i){return{id:e.id,highlighted:e.highlighted,labelClass:e.labelClass,labelDescription:e.labelDescription,customProperties:e.customProperties,disabled:e.disabled,active:e.active,label:e.label,placeholder:e.placeholder,value:e.value,groupValue:e.group?e.group.label:void 0,element:e.element,keyCode:i}},t.prototype._triggerChange=function(e){e!=null&&this.passedElement.triggerEvent(Ue.change,{value:e})},t.prototype._handleButtonAction=function(e){var i=this,n=this._store.items;if(!(!n.length||!this.config.removeItems||!this.config.removeItemButton)){var s=e&&Vi(e.parentElement),r=s&&n.find(function(l){return l.id===s});r&&this._store.withTxn(function(){if(i._removeItem(r),i._triggerChange(r.value),i._isSelectOneElement&&!i._hasNonChoicePlaceholder){var l=(i.config.shouldSort?i._store.choices.reverse():i._store.choices).find(function(o){return o.placeholder});l&&(i._addItem(l),i.unhighlightAll(),l.value&&i._triggerChange(l.value))}})}},t.prototype._handleItemAction=function(e,i){var n=this;i===void 0&&(i=!1);var s=this._store.items;if(!(!s.length||!this.config.removeItems||this._isSelectOneElement)){var r=Vi(e);r&&(s.forEach(function(l){l.id===r&&!l.highlighted?n.highlightItem(l):!i&&l.highlighted&&n.unhighlightItem(l)}),this.input.focus())}},t.prototype._handleChoiceAction=function(e){var i=this,n=Vi(e),s=n&&this._store.getChoiceById(n);if(!s||s.disabled)return!1;var r=this.dropdown.isActive;if(!s.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){i._addItem(s,!0,!0),i.clearInput(),i.unhighlightAll()}),this._triggerChange(s.value)}return r&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},t.prototype._handleBackspace=function(e){var i=this.config;if(!(!i.removeItems||!e.length)){var n=e[e.length-1],s=e.some(function(r){return r.highlighted});i.editItems&&!s&&n?(this.input.value=n.value,this.input.setWidth(),this._removeItem(n),this._triggerChange(n.value)):(s||this.highlightItem(n,!1),this.removeHighlightedItems(!0))}},t.prototype._loadChoices=function(){var e,i=this,n=this.config;if(this._isTextElement){if(this._presetChoices=n.items.map(function(l){return et(l,!1)}),this.passedElement.value){var s=this.passedElement.value.split(n.delimiter).map(function(l){return et(l,!1,i.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(s)}this._presetChoices.forEach(function(l){l.selected=!0})}else if(this._isSelectElement){this._presetChoices=n.choices.map(function(l){return et(l,!0)});var r=this.passedElement.optionsAsChoices();r&&(e=this._presetChoices).push.apply(e,r)}},t.prototype._handleLoadingState=function(e){e===void 0&&(e=!0);var i=this.itemList.element;e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?i.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(i.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},t.prototype._handleSearch=function(e){if(this.input.isFocussed)if(e!==null&&typeof e<"u"&&e.length>=this.config.searchFloor){var i=this.config.searchChoices?this._searchChoices(e):0;i!==null&&this.passedElement.triggerEvent(Ue.search,{value:e,resultCount:i})}else this._store.choices.some(function(n){return!n.active})&&this._stopSearch()},t.prototype._canAddItems=function(){var e=this.config,i=e.maxItemCount,n=e.maxItemText;return!e.singleModeForMultiSelect&&i>0&&i<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof n=="function"?n(i):n,Le.addChoice),!1):(this._notice&&this._notice.type===Le.addChoice&&this._clearNotice(),!0)},t.prototype._canCreateItem=function(e){var i=this.config,n=!0,s="";if(n&&typeof i.addItemFilter=="function"&&!i.addItemFilter(e)&&(n=!1,s=Gt(i.customAddItemText,e)),n){var r=this._store.choices.find(function(l){return i.valueComparer(l.value,e)});if(r){if(this._isSelectElement)return this._displayNotice("",Le.addChoice),!1;i.duplicateItemsAllowed||(n=!1,s=Gt(i.uniqueItemText,e))}}return n&&(s=Gt(i.addItemText,e)),s&&this._displayNotice(s,Le.addChoice),n},t.prototype._searchChoices=function(e){var i=e.trim().replace(/\s{2,}/," ");if(!i.length||i===this._currentValue)return null;var n=this._searcher;n.isEmptyIndex()&&n.index(this._store.searchableChoices);var s=n.search(i);this._currentValue=i,this._highlightPosition=0,this._isSearching=!0;var r=this._notice,l=r&&r.type;return l!==Le.addChoice&&(s.length?this._clearNotice():this._displayNotice(ks(this.config.noResultsText),Le.noResults)),this._store.dispatch(eu(s)),s.length},t.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(tu(!0)),this.passedElement.triggerEvent(Ue.search,{value:"",resultCount:0}))},t.prototype._addEventListeners=function(){var e=this._docRoot,i=this.containerOuter.element,n=this.input.element;e.addEventListener("touchend",this._onTouchEnd,!0),i.addEventListener("keydown",this._onKeyDown,!0),i.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0})),n.addEventListener("keyup",this._onKeyUp,{passive:!0}),n.addEventListener("input",this._onInput,{passive:!0}),n.addEventListener("focus",this._onFocus,{passive:!0}),n.addEventListener("blur",this._onBlur,{passive:!0}),n.form&&n.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},t.prototype._removeEventListeners=function(){var e=this._docRoot,i=this.containerOuter.element,n=this.input.element;e.removeEventListener("touchend",this._onTouchEnd,!0),i.removeEventListener("keydown",this._onKeyDown,!0),i.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur)),n.removeEventListener("keyup",this._onKeyUp),n.removeEventListener("input",this._onInput),n.removeEventListener("focus",this._onFocus),n.removeEventListener("blur",this._onBlur),n.form&&n.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},t.prototype._onKeyDown=function(e){var i=e.keyCode,n=this.dropdown.isActive,s=e.key.length===1||e.key.length===2&&e.key.charCodeAt(0)>=55296||e.key==="Unidentified";switch(!this._isTextElement&&!n&&i!==De.ESC_KEY&&i!==De.TAB_KEY&&i!==De.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&s&&(this.input.value+=e.key,e.key===" "&&e.preventDefault())),i){case De.A_KEY:return this._onSelectKey(e,this.itemList.element.hasChildNodes());case De.ENTER_KEY:return this._onEnterKey(e,n);case De.ESC_KEY:return this._onEscapeKey(e,n);case De.UP_KEY:case De.PAGE_UP_KEY:case De.DOWN_KEY:case De.PAGE_DOWN_KEY:return this._onDirectionKey(e,n);case De.DELETE_KEY:case De.BACK_KEY:return this._onDeleteKey(e,this._store.items,this.input.isFocussed)}},t.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},t.prototype._onInput=function(){var e=this.input.value;if(!e){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(e),this._canAddUserChoices&&(this._canCreateItem(e),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},t.prototype._onSelectKey=function(e,i){if((e.ctrlKey||e.metaKey)&&i){this._canSearch=!1;var n=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;n&&this.highlightAll()}},t.prototype._onEnterKey=function(e,i){var n=this,s=this.input.value,r=e.target;if(e.preventDefault(),r&&r.hasAttribute("data-button")){this._handleButtonAction(r);return}if(!i){(this._isSelectElement||this._notice)&&this.showDropdown();return}var l=this.dropdown.element.querySelector(Kt(this.config.classNames.highlightedState));if(!(l&&this._handleChoiceAction(l))){if(!r||!s){this.hideDropdown(!0);return}if(this._canAddItems()){var o=!1;this._store.withTxn(function(){if(o=n._findAndSelectChoiceByValue(s,!0),!o){if(!n._canAddUserChoices||!n._canCreateItem(s))return;n._addChoice(et(s,!1,n.config.allowHtmlUserInput),!0,!0),o=!0}n.clearInput(),n.unhighlightAll()}),o&&(this._triggerChange(s),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},t.prototype._onEscapeKey=function(e,i){i&&(e.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},t.prototype._onDirectionKey=function(e,i){var n=e.keyCode;if(i||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var s=n===De.DOWN_KEY||n===De.PAGE_DOWN_KEY?1:-1,r=e.metaKey||n===De.PAGE_DOWN_KEY||n===De.PAGE_UP_KEY,l=void 0;if(r)s>0?l=this.dropdown.element.querySelector("".concat(xt,":last-of-type")):l=this.dropdown.element.querySelector(xt);else{var o=this.dropdown.element.querySelector(Kt(this.config.classNames.highlightedState));o?l=ru(o,xt,s):l=this.dropdown.element.querySelector(xt)}l&&(lu(l,this.choiceList.element,s)||this.choiceList.scrollToChildElement(l,s),this._highlightChoice(l)),e.preventDefault()}},t.prototype._onDeleteKey=function(e,i,n){!this._isSelectOneElement&&!e.target.value&&n&&(this._handleBackspace(i),e.preventDefault())},t.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},t.prototype._onTouchEnd=function(e){var i=(e||e.touches[0]).target,n=this._wasTap&&this.containerOuter.element.contains(i);if(n){var s=i===this.containerOuter.element||i===this.containerInner.element;s&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()}this._wasTap=!0},t.prototype._onMouseDown=function(e){var i=e.target;if(i instanceof HTMLElement){if(yf&&this.choiceList.element.contains(i)){var n=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?e.offsetX>=n.offsetWidth:e.offsetX<n.offsetLeft}if(i!==this.input.element){var s=i.closest("[data-button],[data-item],[data-choice]");s instanceof HTMLElement&&("button"in s.dataset?this._handleButtonAction(s):"item"in s.dataset?this._handleItemAction(s,e.shiftKey):"choice"in s.dataset&&this._handleChoiceAction(s)),e.preventDefault()}}},t.prototype._onMouseOver=function(e){var i=e.target;i instanceof HTMLElement&&"choice"in i.dataset&&this._highlightChoice(i)},t.prototype._onClick=function(e){var i=e.target,n=this.containerOuter,s=n.element.contains(i);s?!this.dropdown.isActive&&!n.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),n.element.focus()):this._isSelectOneElement&&i!==this.input.element&&!this.dropdown.element.contains(i)&&this.hideDropdown():(n.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},t.prototype._onFocus=function(e){var i=e.target,n=this.containerOuter,s=i&&n.element.contains(i);if(s){var r=i===this.input.element;this._isTextElement?r&&n.addFocusState():this._isSelectMultipleElement?r&&(this.showDropdown(!0),n.addFocusState()):(n.addFocusState(),r&&this.showDropdown(!0))}},t.prototype._onBlur=function(e){var i=e.target,n=this.containerOuter,s=i&&n.element.contains(i);s&&!this._isScrollingOnIe?i===this.input.element?(n.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):i===this.containerOuter.element&&(n.removeFocusState(),this._canSearch||this.hideDropdown(!0)):(this._isScrollingOnIe=!1,this.input.element.focus())},t.prototype._onFormReset=function(){var e=this;this._store.withTxn(function(){e.clearInput(),e.hideDropdown(),e.refresh(!1,!1,!0),e._initialItems.length&&e.setChoiceByValue(e._initialItems)})},t.prototype._highlightChoice=function(e){e===void 0&&(e=null);var i=Array.from(this.dropdown.element.querySelectorAll(xt));if(i.length){var n=e,s=this.config.classNames.highlightedState,r=Array.from(this.dropdown.element.querySelectorAll(Kt(s)));r.forEach(function(l){tt(l,s),l.setAttribute("aria-selected","false")}),n?this._highlightPosition=i.indexOf(n):(i.length>this._highlightPosition?n=i[this._highlightPosition]:n=i[i.length-1],n||(n=i[0])),ae(n,s),n.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(Ue.highlightChoice,{el:n}),this.dropdown.isActive&&(this.input.setActiveDescendant(n.id),this.containerOuter.setActiveDescendant(n.id))}},t.prototype._addItem=function(e,i,n){if(i===void 0&&(i=!0),n===void 0&&(n=!1),!e.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e.id),this._store.dispatch(bs(e)),i&&(this.passedElement.triggerEvent(Ue.addItem,this._getChoiceForOutput(e)),n&&this.passedElement.triggerEvent(Ue.choice,this._getChoiceForOutput(e)))},t.prototype._removeItem=function(e){if(e.id){this._store.dispatch(ws(e));var i=this._notice;i&&i.type===Le.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(Ue.removeItem,this._getChoiceForOutput(e))}},t.prototype._addChoice=function(e,i,n){if(i===void 0&&(i=!0),n===void 0&&(n=!1),e.id)throw new TypeError("Can not re-add a choice which has already been added");var s=this.config;if(!(!s.duplicateItemsAllowed&&this._store.choices.find(function(o){return s.valueComparer(o.value,e.value)}))){this._lastAddedChoiceId++,e.id=this._lastAddedChoiceId,e.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(e.id);var r=s.prependValue,l=s.appendValue;r&&(e.value=r+e.value),l&&(e.value+=l.toString()),(r||l)&&e.element&&(e.element.value=e.value),this._clearNotice(),this._store.dispatch(vs(e)),e.selected&&this._addItem(e,i,n)}},t.prototype._addGroup=function(e,i){var n=this;if(i===void 0&&(i=!0),e.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(iu(e)),e.choices&&(this._lastAddedGroupId++,e.id=this._lastAddedGroupId,e.choices.forEach(function(s){s.group=e,e.disabled&&(s.disabled=!0),n._addChoice(s,i)}))},t.prototype._createTemplates=function(){var e=this,i=this.config.callbackOnCreateTemplates,n={};typeof i=="function"&&(n=i.call(this,ou,un,Ei));var s={};Object.keys(this._templates).forEach(function(r){r in n?s[r]=n[r].bind(e):s[r]=e._templates[r].bind(e)}),this._templates=s},t.prototype._createElements=function(){var e=this._templates,i=this,n=i.config,s=i._isSelectOneElement,r=n.position,l=n.classNames,o=this._elementType;this.containerOuter=new Ss({element:e.containerOuter(n,this._direction,this._isSelectElement,s,n.searchEnabled,o,n.labelId),classNames:l,type:o,position:r}),this.containerInner=new Ss({element:e.containerInner(n),classNames:l,type:o,position:r}),this.input=new pu({element:e.input(n,this._placeholderValue),classNames:l,type:o,preventPaste:!n.paste}),this.choiceList=new Es({element:e.choiceList(n,s)}),this.itemList=new Es({element:e.itemList(n,s)}),this.dropdown=new mu({element:e.dropdown(n),classNames:l,type:o})},t.prototype._createStructure=function(){var e=this,i=e.containerInner,n=e.containerOuter,s=e.passedElement,r=this.dropdown.element;s.conceal(),i.wrap(s.element),n.wrap(i.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),n.element.appendChild(i.element),n.element.appendChild(r),i.element.appendChild(this.itemList.element),r.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&r.insertBefore(this.input.element,r.firstChild):i.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},t.prototype._initStore=function(){var e=this;this._store.subscribe(this._render).withTxn(function(){e._addPredefinedChoices(e._presetChoices,e._isSelectOneElement&&!e._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},t.prototype._addPredefinedChoices=function(e,i,n){var s=this;if(i===void 0&&(i=!1),n===void 0&&(n=!0),i){var r=e.findIndex(function(l){return l.selected})===-1;r&&e.some(function(l){return l.disabled||"choices"in l?!1:(l.selected=!0,!0)})}e.forEach(function(l){"choices"in l?s._isSelectElement&&s._addGroup(l,n):s._addChoice(l,n)})},t.prototype._findAndSelectChoiceByValue=function(e,i){var n=this;i===void 0&&(i=!1);var s=this._store.choices.find(function(r){return n.config.valueComparer(r.value,e)});return s&&!s.disabled&&!s.selected?(this._addItem(s,!0,i),!0):!1},t.prototype._generatePlaceholderValue=function(){var e=this.config;if(!e.placeholder)return null;if(this._hasNonChoicePlaceholder)return e.placeholderValue;if(this._isSelectElement){var i=this.passedElement.placeholderOption;return i?i.text:null}return null},t.prototype._warnChoicesInitFailed=function(e){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(e," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(e," called on a non-initialised instance of Choices"))},t.version="11.1.0",t}();function Ns(t){let e,i;return{c(){e=b("label"),i=G(t[2]),m(e,"for",t[4])},m(n,s){S(n,e,s),_(e,i)},p(n,s){s&4&&ce(i,n[2])},d(n){n&&k(e)}}}function Ef(t){let e;return{c(){e=b("select"),m(e,"id",t[4]),m(e,"name",t[4]),m(e,"aria-label",t[2]),m(e,"class","m-1")},m(i,n){S(i,e,n)},p(i,n){n&4&&m(e,"aria-label",i[2])},i:$,o:$,d(i){i&&k(e)}}}function Cf(t){let e,i,n,s=t[3].length&&js(t);return{c(){s&&s.c(),e=N(),i=b("select"),m(i,"id",t[4]),m(i,"name",t[4]),m(i,"aria-label",t[2]),m(i,"class","m-1"),i.multiple=!0},m(r,l){s&&s.m(r,l),S(r,e,l),S(r,i,l),n=!0},p(r,l){r[3].length?s?(s.p(r,l),l&8&&M(s,1)):(s=js(r),s.c(),M(s,1),s.m(e.parentNode,e)):s&&(_e(),R(s,1,1,()=>{s=null}),ve()),(!n||l&4)&&m(i,"aria-label",r[2])},i(r){n||(M(s),n=!0)},o(r){R(s),n=!1},d(r){s&&s.d(r),r&&k(e),r&&k(i)}}}function js(t){let e,i,n=t[3].length+"",s,r,l,o;return l=new ki({props:{targetHtmlId:t[5],tooltipText:`${t[3].length}
                                    ${V==="fr"&&t[3].length>1?"valeurs sélectionnées":V==="fr"&&t[3].length===1?"valeur sélectionnée":V==="en"&&t[3].length>1?"selected values":"selected value"}`}}),{c(){e=b("span"),i=b("span"),s=G(n),r=N(),ee(l.$$.fragment),m(i,"id",t[5]),m(i,"class","input-dropdown-count tag m-1 svelte-1epfuu8"),m(e,"class","is-relative")},m(a,c){S(a,e,c),_(e,i),_(i,s),_(e,r),Q(l,e,null),o=!0},p(a,c){(!o||c&8)&&n!==(n=a[3].length+"")&&ce(s,n);const u={};c&8&&(u.tooltipText=`${a[3].length}
                                    ${V==="fr"&&a[3].length>1?"valeurs sélectionnées":V==="fr"&&a[3].length===1?"valeur sélectionnée":V==="en"&&a[3].length>1?"selected values":"selected value"}`),l.$set(u)},i(a){o||(M(l.$$.fragment,a),o=!0)},o(a){R(l.$$.fragment,a),o=!1},d(a){a&&k(e),Z(l)}}}function If(t){let e,i,n,s,r,l,o,a=t[2]!==void 0&&Ns(t);const c=[Cf,Ef],u=[];function f(d,h){return d[0]?0:1}return s=f(t),r=u[s]=c[s](t),{c(){e=b("div"),a&&a.c(),i=N(),n=b("div"),r.c(),m(n,"class",l="input-dropdown-select "+(t[0]?"is-multiple":"is-single")+" "+(t[0]&&t[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(t[1]?"light-display":"")+" svelte-1epfuu8"),m(e,"class","input-dropdown-select-wrapper")},m(d,h){S(d,e,h),a&&a.m(e,null),_(e,i),_(e,n),u[s].m(n,null),o=!0},p(d,[h]){d[2]!==void 0?a?a.p(d,h):(a=Ns(d),a.c(),a.m(e,i)):a&&(a.d(1),a=null);let p=s;s=f(d),s===p?u[s].p(d,h):(_e(),R(u[p],1,1,()=>{u[p]=null}),ve(),r=u[s],r?r.p(d,h):(r=u[s]=c[s](d),r.c()),M(r,1),r.m(n,null)),(!o||h&11&&l!==(l="input-dropdown-select "+(d[0]?"is-multiple":"is-single")+" "+(d[0]&&d[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(d[1]?"light-display":"")+" svelte-1epfuu8"))&&m(n,"class",l)},i(d){o||(M(r),o=!0)},o(d){R(r),o=!1},d(d){d&&k(e),a&&a.d(),u[s].d()}}}const Of=250;function Af(t,e,i){let n,s,{choicesItems:r}=e,{start:l=[]}=e,{multiple:o}=e,{searchable:a=!0}=e,{lightDisplay:c=!1}=e,{placeholder:u=V==="fr"?"Sélectionner une valeur":"Select a value"}=e,{title:f=void 0}=e,{selectAll:d=!!o}=e;const h=`input-dropdown-select-${window.crypto.randomUUID()}`,p=`input-dropdown-counter-${window.crypto.randomUUID()}`,g=`select-all-${window.crypto.randomUUID()}`,v=`unselect-all-${window.crypto.randomUUID()}`,y=tn();let O;const P=pi();P.setCompareFn(ln);const C=Ae("resetTrigger")||void 0;C==null||C.subscribe(()=>L(O,r,l,d));const T=()=>{i(11,s=!0),setTimeout(()=>i(11,s=!1),Of)},j=(U,se)=>{se||(P.set(U),P.same()||y("updateValues",n))},F=U=>`<span class="iconify" data-icon=${U}/>`,E=(U,se)=>U!=null&&se!=null&&U.length&&se.length?`<span class="dropdown-prefix-wrapper">${se==="iconify"?F(U):U}</span>`:"",D=(U,se)=>se?[{value:g,label:`<b>${V==="fr"?"Tout sélectionner":"Select all"}</b>`},{value:v,label:`<b>${V==="fr"?"Tout retirer":"Remove all"}</b>`},...U]:U,Y=(U,se)=>D(U,se).map(J=>(J.id=`dropdown-choice-${window.crypto.randomUUID()}`,J.label=`<span>
                ${E(J.prefix||"",J.prefixType||"")}
                <span class="dropdown-prefix-text">${J.label}</span>
            </span>`,J));function z(U,se,J){return U=structuredClone(U),se=structuredClone(se),U=Y(U,J).map(te=>se.includes(te.value)?{...te,selected:!0}:{...te,selected:!1}),i(3,n=se),U}function L(U,se,J,te){U&&(se=z(se,J,te),U.clearStore().setChoices(se))}const H=(U,se,J,te,ne,be)=>(te=structuredClone(te),J=structuredClone(J),U.detail.value===ne?(T(),J=J.map(ke=>[ne,be].includes(ke.value)?{...ke,selected:!1}:{...ke,selected:!0}),se.removeActiveItems().clearChoices(!0,!0).setValue(J).hideDropdown(),te=[...new Set(J.filter(ke=>ke.selected===!0).map(ke=>ke.value))]):U.detail.value===be?(se.removeActiveItems().hideDropdown(),te=[]):te=o===!0?[...te,U.detail.value]:[U.detail.value],[...new Set(te)]),q=(U,se)=>structuredClone(se).filter(J=>J!==U.detail.value);function K(U,se){const J=document.getElementById(h);O=new Sf(J,{items:[],choices:U,addChoices:!1,addItems:!1,removeItems:!0,removeItemButton:!0,searchEnabled:a,allowHTML:!0,shouldSort:!se,sorter:(te,ne)=>te.label.localeCompare(ne.label),placeholderValue:u,classNames:{item:["choices__item","dropdown-item"]},loadingText:V==="fr"?"Chargement...":"Loading...",noResultsText:V==="fr"?"Pas de résultats":"No results found",noChoicesText:V==="fr"?"Pas de choix pour faire la sélection":"No choices to choose from",itemSelectText:V==="fr"?"Cliquer pour sélectionner":"Press to select",uniqueItemText:V==="fr"?"Seules des valeurs uniques peuvent être ajoutées":"Only unique values can be added",customAddItemText:V==="fr"?"Les valeurs ne répondent pas aux conditions attendues":"Only values matching specific conditions can be added",removeItemIconText:V==="fr"?"Retirer l'item":"Remove item",addItemText:te=>V==="fr"?`Cliquer sur Entrer pour ajouter <b>${te}</b>`:`Press Enter to add <b>"${te}"</b>`,removeItemLabelText:te=>V==="fr"?`Retirer l'item: ${te}`:`Remove item: ${te}`,maxItemText:te=>V==="fr"?`Seulement ${te} items peuvent être ajoutées`:`Only ${te} items can be added`}),J.addEventListener("addItem",te=>{i(3,n=H(te,O,U,n,g,v))}),J.addEventListener("removeItem",te=>{i(3,n=q(te,n))})}return vt(()=>{const U=z(r,l,d);K(U,d)}),bi(()=>{O.destroy(),O=void 0}),t.$$set=U=>{"choicesItems"in U&&i(6,r=U.choicesItems),"start"in U&&i(7,l=U.start),"multiple"in U&&i(0,o=U.multiple),"searchable"in U&&i(8,a=U.searchable),"lightDisplay"in U&&i(1,c=U.lightDisplay),"placeholder"in U&&i(9,u=U.placeholder),"title"in U&&i(2,f=U.title),"selectAll"in U&&i(10,d=U.selectAll)},t.$$.update=()=>{t.$$.dirty&2056&&j(n,s)},i(3,n=[]),i(11,s=!1),[o,c,f,n,h,p,r,l,a,u,d,s]}class ml extends de{constructor(e){super(),fe(this,e,Af,If,ue,{choicesItems:6,start:7,multiple:0,searchable:8,lightDisplay:1,placeholder:9,title:2,selectAll:10})}}function Tf(t){let e,i,n,s,r,l;return r=new ki({props:{tooltipText:t[2]}}),{c(){e=b("div"),i=b("button"),n=b("span"),s=N(),ee(r.$$.fragment),m(n,"class","iconify"),m(n,"data-icon",t[0]),m(n,"title",t[1]),m(i,"class","svelte-11ixywk"),m(e,"class","is-inline-block icon-tooltip svelte-11ixywk")},m(o,a){S(o,e,a),_(e,i),_(i,n),_(i,s),Q(r,i,null),l=!0},p(o,[a]){(!l||a&1)&&m(n,"data-icon",o[0]),(!l||a&2)&&m(n,"title",o[1]);const c={};a&4&&(c.tooltipText=o[2]),r.$set(c)},i(o){l||(M(r.$$.fragment,o),l=!0)},o(o){R(r.$$.fragment,o),l=!1},d(o){o&&k(e),Z(r)}}}function Pf(t,e,i){let{iconifyIcon:n,altText:s,tooltipText:r}=e;return t.$$set=l=>{"iconifyIcon"in l&&i(0,n=l.iconifyIcon),"altText"in l&&i(1,s=l.altText),"tooltipText"in l&&i(2,r=l.tooltipText)},[n,s,r]}class Lf extends de{constructor(e){super(),fe(this,e,Pf,Tf,ue,{iconifyIcon:0,altText:1,tooltipText:2})}}const Mf=t=>({}),$s=t=>({}),Rf=t=>({}),Fs=t=>({});function Us(t){let e,i,n,s,r,l,o,a,c,u,f,d=t[1]&&Vs(t);return a=new ki({props:{tooltipText:t[2][t[1]][V]}}),{c(){d&&d.c(),e=N(),i=b("div"),n=b("button"),s=Qe("svg"),r=Qe("path"),o=N(),ee(a.$$.fragment),m(r,"fill","none"),m(r,"stroke","currentColor"),m(r,"stroke-linecap","round"),m(r,"stroke-linejoin","round"),m(r,"stroke-width","1.5"),m(r,"d","M12 3v18m0 0l8.5-8.5M12 21l-8.5-8.5"),m(s,"style",l=`transform: rotate(${t[1]?"180":"0"}deg)`),m(s,"xmlns","http://www.w3.org/2000/svg"),m(s,"width","24"),m(s,"height","24"),m(s,"viewBox","0 0 24 24"),m(s,"class","svelte-jbs1sd"),m(n,"class","button is-link svelte-jbs1sd"),m(i,"class","ctrl-toggle svelte-jbs1sd")},m(h,p){d&&d.m(h,p),S(h,e,p),S(h,i,p),_(i,n),_(n,s),_(s,r),_(n,o),Q(a,n,null),c=!0,u||(f=re(n,"click",Ct(t[3])),u=!0)},p(h,p){h[1]?d?(d.p(h,p),p&2&&M(d,1)):(d=Vs(h),d.c(),M(d,1),d.m(e.parentNode,e)):d&&(_e(),R(d,1,1,()=>{d=null}),ve()),(!c||p&2&&l!==(l=`transform: rotate(${h[1]?"180":"0"}deg)`))&&m(s,"style",l);const g={};p&2&&(g.tooltipText=h[2][h[1]][V]),a.$set(g)},i(h){c||(M(d),M(a.$$.fragment,h),c=!0)},o(h){R(d),R(a.$$.fragment,h),c=!1},d(h){d&&d.d(h),h&&k(e),h&&k(i),Z(a),u=!1,f()}}}function Vs(t){let e,i,n;const s=t[5]["toolbar-hidden"],r=Ge(s,t,t[4],$s);return{c(){e=b("div"),r&&r.c(),m(e,"class","ctrl-extra")},m(l,o){S(l,e,o),r&&r.m(e,null),n=!0},p(l,o){r&&r.p&&(!n||o&16)&&Je(r,s,l,l[4],n?Ye(s,l[4],o,Mf):Xe(l[4]),$s)},i(l){n||(M(r,l),Ze(()=>{n&&(i||(i=nt(e,An,{axis:"y"},!0)),i.run(1))}),n=!0)},o(l){R(r,l),i||(i=nt(e,An,{axis:"y"},!1)),i.run(0),n=!1},d(l){l&&k(e),r&&r.d(l),l&&i&&i.end()}}}function Df(t){let e,i,n,s,r,l,o,a;const c=t[5]["toolbar-visible"],u=Ge(c,t,t[4],Fs);let f=t[0]&&Us(t);return{c(){e=b("div"),i=b("form"),n=b("div"),s=b("div"),r=b("div"),u&&u.c(),l=N(),f&&f.c(),m(r,"class","ctrl-block svelte-jbs1sd"),m(s,"class","ctrl-block-wrapper svelte-jbs1sd"),m(n,"class","ctrl-base"),m(i,"class","ctrl svelte-jbs1sd"),m(e,"id","toolbar"),m(e,"class",o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(t[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd")},m(d,h){S(d,e,h),_(e,i),_(i,n),_(n,s),_(s,r),u&&u.m(r,null),_(i,l),f&&f.m(i,null),a=!0},p(d,[h]){u&&u.p&&(!a||h&16)&&Je(u,c,d,d[4],a?Ye(c,d[4],h,Rf):Xe(d[4]),Fs),d[0]?f?(f.p(d,h),h&1&&M(f,1)):(f=Us(d),f.c(),M(f,1),f.m(i,null)):f&&(_e(),R(f,1,1,()=>{f=null}),ve()),(!a||h&2&&o!==(o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(d[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd"))&&m(e,"class",o)},i(d){a||(M(u,d),M(f),a=!0)},o(d){R(u,d),R(f),a=!1},d(d){d&&k(e),u&&u.d(d),f&&f.d()}}}function Nf(t,e,i){let n,{$$slots:s={},$$scope:r}=e,{expandable:l=!0}=e;const o={true:{en:"Collapse the toolbar",fr:"Refermer le menu"},false:{en:"Expand the toolbar",fr:"Ouvrir le menu"}},a=()=>i(1,n=!n);return t.$$set=c=>{"expandable"in c&&i(0,l=c.expandable),"$$scope"in c&&i(4,r=c.$$scope)},i(1,n=!1),[l,n,o,a,r,s]}class jf extends de{constructor(e){super(),fe(this,e,Nf,Df,ue,{expandable:0})}}function Hs(t){let e,i;return e=new ml({props:{choicesItems:t[4],multiple:!0,placeholder:"...",start:Object.keys(t[5][t[13]]||{}),lightDisplay:!0,title:V==="fr"?"Régions sélectionnées":"Selected regions",selectAll:!0}}),e.$on("updateValues",t[22]),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,s){const r={};s&16&&(r.choicesItems=n[4]),s&32&&(r.start=Object.keys(n[5][n[13]]||{})),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function $f(t){return{c:$,m:$,p:$,i:$,o:$,d:$}}function Ff(t){let e,i,n=t[28].length&&Uf(t);return{c(){n&&n.c(),e=he()},m(s,r){n&&n.m(s,r),S(s,e,r),i=!0},p(s,r){s[28].length&&n.p(s,r)},i(s){i||(M(n),i=!0)},o(s){R(n),i=!1},d(s){n&&n.d(s),s&&k(e)}}}function Uf(t){let e,i;return e=new Zr({props:{title:V==="fr"?"Score minimal":"Minimal score",minVal:t[28][0],maxVal:t[28][1],start:t[0]||t[28][0],roundTo:3}}),e.$on("updateSlider",t[18]),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,s){const r={};s&1&&(r.start=n[0]||n[28][0]),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Vf(t){return{c:$,m:$,p:$,i:$,o:$,d:$}}function Hf(t){let e,i,n=Object.keys(t[4]).length,s,r,l,o=n&&Hs(t),a={ctx:t,current:null,token:null,hasCatch:!1,pending:Vf,then:Ff,catch:$f,value:28,blocks:[,,,]};return ct(t[17],a),{c(){e=b("div"),i=b("div"),o&&o.c(),s=N(),r=b("div"),a.block.c(),m(i,"class","ctrl-input svelte-8yfni4"),m(r,"class","ctrl-input svelte-8yfni4"),m(e,"slot","toolbar-visible"),m(e,"class","ctrl-block-inputs svelte-8yfni4")},m(c,u){S(c,e,u),_(e,i),o&&o.m(i,null),_(e,s),_(e,r),a.block.m(r,a.anchor=null),a.mount=()=>r,a.anchor=null,l=!0},p(c,u){t=c,u&16&&(n=Object.keys(t[4]).length),n?o?(o.p(t,u),u&16&&M(o,1)):(o=Hs(t),o.c(),M(o,1),o.m(i,null)):o&&(_e(),R(o,1,1,()=>{o=null}),ve()),Ft(a,t,u)},i(c){l||(M(o),M(a.block),l=!0)},o(c){R(o);for(let u=0;u<3;u+=1){const f=a.blocks[u];R(f)}l=!1},d(c){c&&k(e),o&&o.d(),a.block.d(),a.token=null,a=null}}}function Bf(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g,v,y,O,P,C,T,j,F;return a=new ml({props:{choicesItems:t[15],multiple:!0,placeholder:"...",start:t[1],lightDisplay:!0,title:V==="fr"?"Catégories masquées":"Hidden categories",selectAll:!0}}),a.$on("updateValues",t[19]),g=new Lf({props:{iconifyIcon:"material-symbols:help-outline",altText:V==="en"?"Display help":"Afficher une explication",tooltipText:t[14]}}),P=new Zr({props:{title:V==="fr"?"Profondeur de récursion":"Recursion depth",minVal:t[12][0],maxVal:t[12][1],start:t[2],step:1}}),P.$on("updateSlider",t[20]),j=new Jc({props:{toggleLabel:V==="en"?"Filter by region":"Filtrer par région",start:t[3],buttonDisplay:!0}}),j.$on("updateChecked",t[21]),{c(){e=b("div"),i=b("div"),n=b("div"),s=b("span"),s.textContent=`${V==="en"?"Similarity":"Similarité"}`,r=N(),l=b("div"),o=b("div"),ee(a.$$.fragment),c=N(),u=b("div"),f=b("div"),d=b("div"),h=b("span"),h.textContent="Propagation",p=N(),ee(g.$$.fragment),v=N(),y=b("div"),O=b("div"),ee(P.$$.fragment),C=N(),T=b("div"),ee(j.$$.fragment),m(s,"class","tag is-medium is-link"),m(n,"class","ctrl-block-title svelte-8yfni4"),m(o,"class","ctrl-input svelte-8yfni4"),m(l,"class","ctrl-block-inputs svelte-8yfni4"),m(i,"class","ctrl-block svelte-8yfni4"),m(e,"class","ctrl-block-wrapper svelte-8yfni4"),m(h,"class","tag is-medium is-link mr-1"),m(d,"class","ctrl-block-title svelte-8yfni4"),m(O,"class","ctrl-input svelte-8yfni4"),m(T,"class","ctrl-input svelte-8yfni4"),m(y,"class","ctrl-block-inputs svelte-8yfni4"),m(f,"class","ctrl-block svelte-8yfni4"),m(u,"class","ctrl-block-wrapper svelte-8yfni4")},m(E,D){S(E,e,D),_(e,i),_(i,n),_(n,s),_(i,r),_(i,l),_(l,o),Q(a,o,null),S(E,c,D),S(E,u,D),_(u,f),_(f,d),_(d,h),_(d,p),Q(g,d,null),_(f,v),_(f,y),_(y,O),Q(P,O,null),_(y,C),_(y,T),Q(j,T,null),F=!0},p(E,D){const Y={};D&2&&(Y.start=E[1]),a.$set(Y);const z={};D&4&&(z.start=E[2]),P.$set(z);const L={};D&8&&(L.start=E[3]),j.$set(L)},i(E){F||(M(a.$$.fragment,E),M(g.$$.fragment,E),M(P.$$.fragment,E),M(j.$$.fragment,E),F=!0)},o(E){R(a.$$.fragment,E),R(g.$$.fragment,E),R(P.$$.fragment,E),R(j.$$.fragment,E),F=!1},d(E){E&&k(e),Z(a),E&&k(c),E&&k(u),Z(g),Z(P),Z(j)}}}function zf(t){let e,i;return e=new jf({props:{$$slots:{"toolbar-hidden":[Bf],"toolbar-visible":[Hf]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,[s]){const r={};s&536870975&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Bs(){const t=document.getElementById("nav-actions");t&&document.documentElement.style.setProperty("--top-offset",`${t.offsetHeight}px`)}function qf(t,e,i){let n,s,r,l,o,a,c,u;const{selectedRegions:f,comparedRegions:d,excludedCategories:h,similarityScoreCutoff:p,propagateRecursionDepth:g,propagateFilterByRegions:v,allowedPropagateDepthRange:y}=ze;oe(t,f,K=>i(5,u=K)),oe(t,d,K=>i(25,s=K)),oe(t,h,K=>i(1,l=K)),oe(t,p,K=>i(23,r=K)),oe(t,g,K=>i(2,o=K)),oe(t,v,K=>i(3,a=K));let O;vt(()=>{Bs(),O=new ResizeObserver(()=>{Bs()});const K=document.getElementById("nav-actions");return K&&O.observe(K),()=>{O&&K&&(O.unobserve(K),O.disconnect())}});const P=window.location.pathname.match(/\d+/g).join("-"),C=`${window.location.origin}${window.location.pathname}`,T=V==="en"?"Propagated matches are exact matches to images that have an exact match with the current image. There may be up to 6 exact matches connecting the current image and propagated images.":"Les correspondances propagées correspondent à des correspondances exactes à des images ayant une correspondance exacte avec l'image actuelle. Il peut y avoir jusqu'à 6 images reliant l'image actuelle à une correspondance propagée.",j=[{value:1,label:Vr,prefix:Nr,prefixType:"svg"},{value:2,label:Hr,prefix:jr,prefixType:"svg"},{value:3,label:Br,prefix:$r,prefixType:"svg"},{value:4,label:zr,prefix:Fr,prefixType:"svg"},{value:5,label:qr,prefix:Ur,prefixType:"svg"}],F=Be(d,K=>Object.entries(K).map(([U,se])=>({prefix:`#${se.id}`,prefixType:"text",value:U,label:Cr(se.title.replace(/^[^|]+/,""))})));oe(t,F,K=>i(4,c=K));const E=D();async function D(){let K=[];return await fetch(`${C}similarity-score-range`).then(U=>U.json()).then(U=>(K=[U.min,U.max],K.every(se=>typeof se=="number")?i(0,n=r&&K[0]<=r&&K[1]>=r?r:K[0]):(console.error(`fetchSimilarityScoreRange: expected '[number, number]', got '${K}'. Defaulting to '[]'`),K=[]),K)).catch(U=>(console.error("Error on fetchSimilarityScoreRange:",U),errorMsg.set(U.message),K))}const Y=K=>p.set(K.detail),z=K=>h.set(K.detail),L=K=>g.set(K.detail),H=K=>v.set(K.detail),q=K=>{const U=K.detail,se={[P]:{}};Object.keys(s).forEach(J=>{U.includes(J)&&(se[P][J]=s[J])}),f.set(se)};return t.$$.update=()=>{t.$$.dirty&8388608&&i(0,n=r||void 0)},[n,l,o,a,c,u,f,d,h,p,g,v,y,P,T,j,F,E,Y,z,L,H,q,r]}class Kf extends de{constructor(e){super(),fe(this,e,qf,zf,ue,{})}}function xf(t){let e=Object.keys(t[0]).length,i,n,s,r,l,o=e&&zs();const a=[Yf,Gf,Wf],c=[];function u(f,d){return f[1]?0:f[2]?1:2}return n=u(t),s=c[n]=a[n](t),{c(){o&&o.c(),i=N(),s.c(),r=he()},m(f,d){o&&o.m(f,d),S(f,i,d),c[n].m(f,d),S(f,r,d),l=!0},p(f,d){d&1&&(e=Object.keys(f[0]).length),e?o?d&1&&M(o,1):(o=zs(),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(_e(),R(o,1,1,()=>{o=null}),ve());let h=n;n=u(f),n===h?c[n].p(f,d):(_e(),R(c[h],1,1,()=>{c[h]=null}),ve(),s=c[n],s?s.p(f,d):(s=c[n]=a[n](f),s.c()),M(s,1),s.m(r.parentNode,r))},i(f){l||(M(o),M(s),l=!0)},o(f){R(o),R(s),l=!1},d(f){o&&o.d(f),f&&k(i),c[n].d(f),f&&k(r)}}}function zs(t){let e,i;return e=new Kf({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Wf(t){let e,i;return e=new sc({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Gf(t){let e,i;return e=new wi({props:{$$slots:{default:[Qf]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,s){const r={};s&36&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Yf(t){let e,i;return e=new wi({props:{$$slots:{default:[Zf]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,s){const r={};s&32&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function Jf(t){let e,i;return{c(){e=G("Erreur lors de la récupération des similarités : "),i=G(t[2])},m(n,s){S(n,e,s),S(n,i,s)},p(n,s){s&4&&ce(i,n[2])},d(n){n&&k(e),n&&k(i)}}}function Xf(t){let e,i;return{c(){e=G("Error when retrieving similarities: "),i=G(t[2])},m(n,s){S(n,e,s),S(n,i,s)},p(n,s){s&4&&ce(i,n[2])},d(n){n&&k(e),n&&k(i)}}}function Qf(t){let e;function i(r,l){return V==="en"?Xf:Jf}let s=i()(t);return{c(){e=b("tr"),s.c(),m(e,"class","faded is-center")},m(r,l){S(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},d(r){r&&k(e),s.d()}}}function Zf(t){let e;return{c(){e=b("tr"),e.textContent=`${V==="en"?"Retrieving similarities...":"Récupération des similarités..."}`,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,d(i){i&&k(e)}}}function ed(t){let e=Rt.includes("similarity"),i,n,s=e&&xf(t);return{c(){s&&s.c(),i=he()},m(r,l){s&&s.m(r,l),S(r,i,l),n=!0},p(r,[l]){e&&s.p(r,l)},i(r){n||(M(s),n=!0)},o(r){R(s),n=!1},d(r){s&&s.d(r),r&&k(i)}}}function td(t,e,i){let n,s,r;oe(t,Et,a=>i(1,s=a)),oe(t,Sr,a=>i(2,r=a));const{fetchSimilarity:l,comparedRegions:o}=ze;return oe(t,o,a=>i(0,n=a)),vt(()=>{Rt.includes("similarity")&&l()}),[n,s,r,o]}class id extends de{constructor(e){super(),fe(this,e,td,ed,ue,{})}}function qs(t,e,i){const n=t.slice();return n[10]=e[i][0],n[11]=e[i][1],n}function Ks(t,e,i){const n=t.slice();return n[14]=e[i],n[16]=i,n}function nd(t){let e,i=V==="en"?`Error when retrieving paginated regions: ${t[17]}`:`Erreur de récupération des pages : ${t[17]}`,n;return{c(){e=b("tr"),n=G(i),m(e,"class","faded is-center")},m(s,r){S(s,e,r),_(e,n)},p(s,r){r&1&&i!==(i=V==="en"?`Error when retrieving paginated regions: ${s[17]}`:`Erreur de récupération des pages : ${s[17]}`)&&ce(n,i)},i:$,o:$,d(s){s&&k(e)}}}function sd(t){let e,i,n,s,r;const l=[ld,rd],o=[];function a(c,u){return u&2&&(e=null),e==null&&(e=Object.values(c[1]).length>0),e?0:1}return i=a(t,-1),n=o[i]=l[i](t),{c(){n.c(),s=he()},m(c,u){o[i].m(c,u),S(c,s,u),r=!0},p(c,u){let f=i;i=a(c,u),i===f?o[i].p(c,u):(_e(),R(o[f],1,1,()=>{o[f]=null}),ve(),n=o[i],n?n.p(c,u):(n=o[i]=l[i](c),n.c()),M(n,1),n.m(s.parentNode,s))},i(c){r||(M(n),r=!0)},o(c){R(n),r=!1},d(c){o[i].d(c),c&&k(s)}}}function rd(t){let e,i,n;return i=new Rr({}),{c(){e=b("tr"),ee(i.$$.fragment)},m(s,r){S(s,e,r),Q(i,e,null),n=!0},p:$,i(s){n||(M(i.$$.fragment,s),n=!0)},o(s){R(i.$$.fragment,s),n=!1},d(s){s&&k(e),Z(i)}}}function ld(t){let e,i,n=Object.entries(t[1]),s=[];for(let l=0;l<n.length;l+=1)s[l]=Ws(qs(t,n,l));const r=l=>R(s[l],1,1,()=>{s[l]=null});return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=he()},m(l,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(l,o);S(l,e,o),i=!0},p(l,o){if(o&98){n=Object.entries(l[1]);let a;for(a=0;a<n.length;a+=1){const c=qs(l,n,a);s[a]?(s[a].p(c,o),M(s[a],1)):(s[a]=Ws(c),s[a].c(),M(s[a],1),s[a].m(e.parentNode,e))}for(_e(),a=n.length;a<s.length;a+=1)r(a);ve()}},i(l){if(!i){for(let o=0;o<n.length;o+=1)M(s[o]);i=!0}},o(l){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)R(s[o]);i=!1},d(l){st(s,l),l&&k(e)}}}function od(t){let e,i,n,s,r,l,o,a,c=t[10]+"",u,f,d;return{c(){e=b("img"),s=N(),r=b("div"),l=b("a"),o=b("i"),a=G(`
                                Page `),u=G(c),d=N(),We(e.src,i=gt(t[5](t[10]),"full","250,"))||m(e,"src",i),m(e,"alt",n="Canvas "+t[10]),m(e,"class","mb-3 card"),m(o,"class","fa-solid fa-pen-to-square"),m(l,"class","tag px-2 py-1 is-rounded is-hoverable"),m(l,"href",f=Nt(t[6],t[10])),m(l,"target","_blank"),m(r,"class","is-center mb-1")},m(h,p){S(h,e,p),S(h,s,p),S(h,r,p),_(r,l),_(l,o),_(l,a),_(l,u),S(h,d,p)},p(h,p){p&2&&!We(e.src,i=gt(h[5](h[10]),"full","250,"))&&m(e,"src",i),p&2&&n!==(n="Canvas "+h[10])&&m(e,"alt",n),p&2&&c!==(c=h[10]+"")&&ce(u,c),p&2&&f!==(f=Nt(h[6],h[10]))&&m(l,"href",f)},d(h){h&&k(e),h&&k(s),h&&k(r),h&&k(d)}}}function xs(t,e){let i,n,s;return n=new an({props:{item:e[14],items:Object.values(e[11]),index:e[16]}}),{key:t,first:null,c(){i=he(),ee(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),Q(n,r,l),s=!0},p(r,l){e=r;const o={};l&2&&(o.item=e[14]),l&2&&(o.items=Object.values(e[11])),l&2&&(o.index=e[16]),n.$set(o)},i(r){s||(M(n.$$.fragment,r),s=!0)},o(r){R(n.$$.fragment,r),s=!1},d(r){r&&k(i),Z(n,r)}}}function ad(t){let e=[],i=new Map,n,s,r=Object.values(t[11]);const l=o=>o[14].id;for(let o=0;o<r.length;o+=1){let a=Ks(t,r,o),c=l(a);i.set(c,e[o]=xs(c,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();n=N()},m(o,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(o,a);S(o,n,a),s=!0},p(o,a){a&2&&(r=Object.values(o[11]),_e(),e=Ut(e,a,l,1,o,r,i,n.parentNode,Zt,xs,n,Ks),ve())},i(o){if(!s){for(let a=0;a<r.length;a+=1)M(e[a]);s=!0}},o(o){for(let a=0;a<e.length;a+=1)R(e[a]);s=!1},d(o){for(let a=0;a<e.length;a+=1)e[a].d(o);o&&k(n)}}}function Ws(t){let e,i;return e=new xr({props:{$$slots:{"row-body":[ad],"row-header":[od]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,s){const r={};s&262146&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function cd(t){let e;return{c(){e=b("tr"),e.textContent=`${V==="en"?"Retrieving paginated regions...":"Récupération des pages..."}`,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,i:$,o:$,d(i){i&&k(e)}}}function ud(t){let e,i,n,s={ctx:t,current:null,token:null,hasCatch:!0,pending:cd,then:sd,catch:nd,value:9,error:17,blocks:[,,,]};return ct(i=t[0],s),{c(){e=he(),s.block.c()},m(r,l){S(r,e,l),s.block.m(r,s.anchor=l),s.mount=()=>e.parentNode,s.anchor=e,n=!0},p(r,l){t=r,s.ctx=t,l&1&&i!==(i=t[0])&&ct(i,s)||Ft(s,t,l)},i(r){n||(M(s.block),n=!0)},o(r){for(let l=0;l<3;l+=1){const o=s.blocks[l];R(o)}n=!1},d(r){r&&k(e),s.block.d(r),s.token=null,s=null}}}function fd(t){let e,i,n,s,r,l;return e=new jt({props:{store:_t,nbOfItems:t[4]}}),n=new wi({props:{$$slots:{default:[ud]},$$scope:{ctx:t}}}),r=new jt({props:{store:_t,nbOfItems:t[4]}}),{c(){ee(e.$$.fragment),i=N(),ee(n.$$.fragment),s=N(),ee(r.$$.fragment)},m(o,a){Q(e,o,a),S(o,i,a),Q(n,o,a),S(o,s,a),Q(r,o,a),l=!0},p(o,[a]){const c={};a&262147&&(c.$$scope={dirty:a,ctx:o}),n.$set(c)},i(o){l||(M(e.$$.fragment,o),M(n.$$.fragment,o),M(r.$$.fragment,o),l=!0)},o(o){R(e.$$.fragment,o),R(n.$$.fragment,o),R(r.$$.fragment,o),l=!1},d(o){Z(e,o),o&&k(i),Z(n,o),o&&k(s),Z(r,o)}}}function dd(t,e,i){let n,s;const{pageRegions:r,fetchPages:l}=_t;oe(t,r,d=>i(1,s=d)),oe(t,l,d=>i(0,n=d));const o=Ae("nbOfPages"),a=Ae("trailingZeros"),c=(d,h)=>d.toString().padStart(h,"0");function u(d){return`${imgPrefix}_${c(d,a)}`}const f=Ae("manifest");return[n,s,r,l,o,u,f]}class hd extends de{constructor(e){super(),fe(this,e,dd,fd,ue,{})}}function md(t){let e,i,n,s,r=V==="en"?"Save selection":"Sauvegarder la sélection",l,o,a;return{c(){e=b("button"),i=b("span"),n=b("i"),s=N(),l=G(r),m(n,"class","fa-solid fa-floppy-disk"),m(e,"class","button is-link")},m(c,u){S(c,e,u),_(e,i),_(i,n),_(i,s),_(i,l),o||(a=re(e,"click",t[7]),o=!0)},p:$,d(c){c&&k(e),o=!1,a()}}}function pd(t){let e,i,n,s,r=V==="en"?"Go to treatment":"Accéder au traitement",l,o;return{c(){var a;e=b("a"),i=b("span"),n=b("i"),s=N(),l=G(r),m(n,"class","fa-solid fa-gear"),m(e,"class","button is-link"),m(e,"href",o="/"+$e+"/treatment/add/?document_set="+((a=t[3])==null?void 0:a.id))},m(a,c){S(a,e,c),_(e,i),_(i,n),_(i,s),_(i,l)},p(a,c){var u;c&8&&o!==(o="/"+$e+"/treatment/add/?document_set="+((u=a[3])==null?void 0:u.id))&&m(e,"href",o)},d(a){a&&k(e)}}}function Gs(t){let e,i,n,s,r,l,o;return{c(){var a,c;e=b("a"),i=b("span"),i.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',s=N(),r=b("a"),l=b("span"),l.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',m(e,"class","button is-link is-dark"),m(e,"href",n="/"+$e+"/document-set/"+((a=t[3])==null?void 0:a.id)+"/json"),m(e,"target","_blank"),m(r,"class","button is-link is-dark"),m(r,"href",o="/"+$e+"/document-set/"+((c=t[3])==null?void 0:c.id)+"/zip"),m(r,"target","_blank")},m(a,c){S(a,e,c),_(e,i),S(a,s,c),S(a,r,c),_(r,l)},p(a,c){var u,f;c&8&&n!==(n="/"+$e+"/document-set/"+((u=a[3])==null?void 0:u.id)+"/json")&&m(e,"href",n),c&8&&o!==(o="/"+$e+"/document-set/"+((f=a[3])==null?void 0:f.id)+"/zip")&&m(r,"href",o)},d(a){a&&k(e),a&&k(s),a&&k(r)}}}function gd(t){let e,i,n,s,r,l,o;function a(d,h){return d[2]&&!d[1]?pd:md}let c=a(t),u=c(t),f=!t[1]&&Gs(t);return{c(){e=b("footer"),i=b("div"),n=b("button"),n.textContent=`${V==="en"?"Clear selection":"Vider la sélection"}`,s=N(),u.c(),r=N(),f&&f.c(),m(n,"class","button button-close is-link is-light"),m(i,"class","buttons"),m(e,"class","modal-card-foot is-center")},m(d,h){S(d,e,h),_(e,i),_(i,n),_(i,s),u.m(i,null),_(i,r),f&&f.m(i,null),l||(o=re(n,"click",t[6]),l=!0)},p(d,[h]){c===(c=a(d))&&u?u.p(d,h):(u.d(1),u=c(d),u&&(u.c(),u.m(i,r))),d[1]?f&&(f.d(1),f=null):f?f.p(d,h):(f=Gs(d),f.c(),f.m(i,null))},i:$,o:$,d(d){d&&k(e),u.d(),f&&f.d(),l=!1,o()}}}function _d(t,e,i){let n,s,{selectionStore:r}=e;const{isSaved:l,selection:o}=r;oe(t,l,f=>i(2,n=f)),oe(t,o,f=>i(3,s=f));let{isRegion:a=r.type!=="documentSet"}=e;const c=()=>r.empty(),u=()=>r.save();return t.$$set=f=>{"selectionStore"in f&&i(0,r=f.selectionStore),"isRegion"in f&&i(1,a=f.isRegion)},[r,a,n,s,l,o,c,u]}class vd extends de{constructor(e){super(),fe(this,e,_d,gd,ue,{selectionStore:0,isRegion:1})}}function Ys(t,e,i){const n=t.slice();return n[31]=e[i],n}function Js(t,e,i){const n=t.slice();return n[31]=e[i],n}function bd(t){let e,i,n,s,r,l;return{c(){e=b("span"),i=G(t[10]),n=N(),s=b("span"),s.innerHTML='<i class="fas fa-edit"></i>',m(s,"class","pl-3 smaller has-text-link")},m(o,a){S(o,e,a),_(e,i),_(e,n),_(e,s),r||(l=[re(e,"click",t[14]),re(e,"keyup",null)],r=!0)},p(o,a){a[0]&1024&&ce(i,o[10])},d(o){o&&k(e),r=!1,Ie(l)}}}function wd(t){let e,i,n;return{c(){e=b("input"),m(e,"class","input selection-title svelte-fumu7c")},m(s,r){S(s,e,r),t[23](e),Mt(e,t[5]),i||(n=[re(e,"input",t[24]),re(e,"keydown",t[15]),re(e,"blur",t[16])],i=!0)},p(s,r){r[0]&32&&e.value!==s[5]&&Mt(e,s[5])},d(s){s&&k(e),t[23](null),i=!1,Ie(n)}}}function Xs(t){let e,i,n;function s(){return t[25](t[31])}return{c(){e=b("button"),m(e,"class","tag is-delete is-link ml-0")},m(r,l){S(r,e,l),i||(n=re(e,"click",s),i=!0)},p(r,l){t=r},d(r){r&&k(e),i=!1,n()}}}function Qs(t,e){let i,n,s=e[31].username+"",r,l,o,a=e[9]&&Xs(e);return{key:t,first:null,c(){i=b("div"),n=b("span"),r=G(s),l=N(),a&&a.c(),o=N(),m(n,"class","tag"),m(i,"class","tags has-addons svelte-fumu7c"),this.first=i},m(c,u){S(c,i,u),_(i,n),_(n,r),_(i,l),a&&a.m(i,null),_(i,o)},p(c,u){e=c,u[0]&256&&s!==(s=e[31].username+"")&&ce(r,s),e[9]?a?a.p(e,u):(a=Xs(e),a.c(),a.m(i,o)):a&&(a.d(1),a=null)},d(c){c&&k(i),a&&a.d()}}}function Zs(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g=V==="en"?"Make public":"Rendre public",v,y,O,P=t[7].length>0&&er(t);return{c(){var C;e=b("div"),i=b("div"),n=b("div"),s=b("p"),r=b("input"),l=N(),o=b("span"),o.innerHTML='<i class="fas fa-search"></i>',a=N(),P&&P.c(),c=N(),u=b("div"),f=b("label"),d=b("input"),p=N(),v=G(g),m(r,"class","input svelte-fumu7c"),m(r,"placeholder","Search users…"),m(o,"class","icon is-small is-right"),m(s,"class","control is-expanded has-icons-right"),m(n,"class","field"),m(i,"class","dropdown-trigger"),m(e,"class","dropdown is-active"),m(d,"type","checkbox"),d.checked=h=(C=t[2])==null?void 0:C.is_public,m(f,"class","checkbox"),m(u,"class","field mt-3 is-right")},m(C,T){S(C,e,T),_(e,i),_(i,n),_(n,s),_(s,r),Mt(r,t[6]),_(s,l),_(s,o),_(e,a),P&&P.m(e,null),S(C,c,T),S(C,u,T),_(u,f),_(f,d),_(f,p),_(f,v),y||(O=[re(r,"input",t[26]),re(r,"input",t[17]),re(d,"change",t[28])],y=!0)},p(C,T){var j;T[0]&64&&r.value!==C[6]&&Mt(r,C[6]),C[7].length>0?P?P.p(C,T):(P=er(C),P.c(),P.m(e,null)):P&&(P.d(1),P=null),T[0]&4&&h!==(h=(j=C[2])==null?void 0:j.is_public)&&(d.checked=h)},d(C){C&&k(e),P&&P.d(),C&&k(c),C&&k(u),y=!1,Ie(O)}}}function er(t){let e,i,n=t[7],s=[];for(let r=0;r<n.length;r+=1)s[r]=tr(Ys(t,n,r));return{c(){e=b("div"),i=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(i,"class","dropdown-content"),m(e,"class","dropdown-menu"),m(e,"id","dropdown-menu"),m(e,"role","menu")},m(r,l){S(r,e,l),_(e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,null)},p(r,l){if(l[0]&262272){n=r[7];let o;for(o=0;o<n.length;o+=1){const a=Ys(r,n,o);s[o]?s[o].p(a,l):(s[o]=tr(a),s[o].c(),s[o].m(i,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},d(r){r&&k(e),st(s,r)}}}function tr(t){let e,i=t[31].username+"",n,s,r,l;function o(){return t[27](t[31])}return{c(){e=b("div"),n=G(i),s=N(),m(e,"class","dropdown-item")},m(a,c){S(a,e,c),_(e,n),_(e,s),r||(l=[re(e,"click",o),re(e,"keydown",null)],r=!0)},p(a,c){t=a,c[0]&128&&i!==(i=t[31].username+"")&&ce(n,i)},d(a){a&&k(e),r=!1,Ie(l)}}}function yd(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g,v,y,O,P,C=[],T=new Map,j,F,E,D,Y,z;function L(ne,be){return ne[3]?wd:bd}let H=L(t),q=H(t);const K=t[22].default,U=Ge(K,t,t[21],null);let se=t[8];const J=ne=>ne[31].id;for(let ne=0;ne<se.length;ne+=1){let be=Js(t,se,ne),ke=J(be);T.set(ke,C[ne]=Qs(ke,be))}let te=t[9]&&Zs(t);return E=new vd({props:{selectionStore:t[0]}}),{c(){e=b("div"),i=b("div"),n=N(),s=b("div"),r=b("div"),l=b("div"),o=b("i"),a=N(),q.c(),c=G(`

                (`),u=G(t[1]),f=G(")"),d=N(),h=b("button"),p=N(),g=b("section"),U&&U.c(),v=N(),y=b("h4"),y.textContent=`${V==="en"?"Shared with":"Partagé avec"}`,O=N(),P=b("div");for(let ne=0;ne<C.length;ne+=1)C[ne].c();j=N(),te&&te.c(),F=N(),ee(E.$$.fragment),m(i,"class","modal-background"),m(o,"class","fa-solid fa-book-bookmark"),m(l,"class","title is-4 mb-0 media-content"),m(h,"class","delete media-left"),m(h,"aria-label","close"),m(r,"class","modal-card-head media mb-0 is-middle"),m(P,"class","field is-grouped is-grouped-multiline"),m(g,"class","modal-card-body"),m(s,"class","modal-content"),m(e,"id","selection-modal"),m(e,"class","modal fade"),m(e,"tabindex","-1"),m(e,"aria-labelledby","selection-modal-label"),m(e,"aria-hidden","true")},m(ne,be){S(ne,e,be),_(e,i),_(e,n),_(e,s),_(s,r),_(r,l),_(l,o),_(l,a),q.m(l,null),_(l,c),_(l,u),_(l,f),_(r,d),_(r,h),_(s,p),_(s,g),U&&U.m(g,null),_(g,v),_(g,y),_(g,O),_(g,P);for(let ke=0;ke<C.length;ke+=1)C[ke]&&C[ke].m(P,null);_(g,j),te&&te.m(g,null),_(s,F),Q(E,s,null),D=!0,Y||(z=fi(Tr.call(null,e)),Y=!0)},p(ne,be){H===(H=L(ne))&&q?q.p(ne,be):(q.d(1),q=H(ne),q&&(q.c(),q.m(l,c))),(!D||be[0]&2)&&ce(u,ne[1]),U&&U.p&&(!D||be[0]&2097152)&&Je(U,K,ne,ne[21],D?Ye(K,ne[21],be,null):Xe(ne[21]),null),be[0]&525056&&(se=ne[8],C=Ut(C,be,J,1,ne,se,T,P,eo,Qs,null,Js)),ne[9]?te?te.p(ne,be):(te=Zs(ne),te.c(),te.m(g,null)):te&&(te.d(1),te=null);const ke={};be[0]&1&&(ke.selectionStore=ne[0]),E.$set(ke)},i(ne){D||(M(U,ne),M(E.$$.fragment,ne),D=!0)},o(ne){R(U,ne),R(E.$$.fragment,ne),D=!1},d(ne){ne&&k(e),q.d(),U&&U.d(ne);for(let be=0;be<C.length;be+=1)C[be].d();te&&te.d(),Z(E),Y=!1,z()}}}function kd(t,e,i){let n,s,r,l,o,{$$slots:a={},$$scope:c}=e;const{selected:u}=po;oe(t,u,J=>i(2,l=J));let{selectionStore:f}=e,{selectionLength:d=!1}=e;const{selectionTitle:h,updateTitle:p,updatePublic:g,save:v}=f;oe(t,h,J=>i(10,o=J));let y=!1,O,P;function C(){i(3,y=!0),i(5,P=o),setTimeout(()=>O==null?void 0:O.focus(),0)}function T(J){J.key==="Enter"&&j()}function j(){i(3,y=!1),p(P),v()}let F="",E=[];async function D(){if(F.trim().length<1){i(7,E=[]);return}const te=await(await fetch(`${window.location.origin}/search/user?q=${encodeURIComponent(F)}`)).json();i(7,E=te.users||[])}function Y(J){f.add({id:J.id,class:"User",title:J.username}),i(6,F=""),i(7,E=[])}function z(J){f.remove(J,"User")}function L(J){Hi[J?"unshift":"push"](()=>{O=J,i(4,O)})}function H(){P=this.value,i(5,P)}const q=J=>z(J.id);function K(){F=this.value,i(6,F)}const U=J=>Y(J),se=J=>g(J.target.checked);return t.$$set=J=>{"selectionStore"in J&&i(0,f=J.selectionStore),"selectionLength"in J&&i(1,d=J.selectionLength),"$$scope"in J&&i(21,c=J.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&4&&i(20,n=l==null?void 0:l.owner_id),t.$$.dirty[0]&1048576&&i(9,s=so||n===ci),t.$$.dirty[0]&4&&i(8,r=Object.entries((l==null?void 0:l.User)||{}).map(([J,te])=>({id:Number(J),username:te.title})))},[f,d,l,y,O,P,F,E,r,s,o,u,h,g,C,T,j,D,Y,z,n,c,a,L,H,q,K,U,se]}class Sd extends de{constructor(e){super(),fe(this,e,kd,yd,ue,{selectionStore:0,selectionLength:1},null,[-1,-1])}}function Ed(){const t=`${window.location.origin}${window.location.pathname}`,e=49,i=Ee(1),n=Ee([]),s=Ee([]),r=(async()=>{const u=await fetch(`${t}vectorized-images`).then(f=>f.json()).then(f=>(n.set(f),f)).catch(f=>console.error("Error:",f));return c(l()),u})(),l=()=>sn(i,"vp"),o=Be(i,u=>(async()=>a(u))());function a(u){const f=(u-1)*e,d=f+e,h=Zi(n).slice(f,d);return s.set(h),h}function c(u){rn(u,i,"vp")}return{currentPage:i,pageLength:e,vectImgs:n,fetchVectorization:r,setPageVectImgs:o,pageVectImgs:s,handlePageUpdate:c}}const vi=Ed();function ir(t){let e,i;return{c(){e=new zl(!1),i=he(),e.a=i},m(n,s){e.m(t[5],n,s),S(n,i,s)},p(n,s){s&32&&e.p(n[5])},d(n){n&&k(i),n&&e.d()}}}function nr(t){let e,i,n;var s=t[9];function r(l){return{props:{mainImgItem:l[15],compareImgItem:l[13],svgItem:l[1]}}}return s&&(e=di(s,r(t))),{c(){e&&ee(e.$$.fragment),i=he()},m(l,o){e&&Q(e,l,o),S(l,i,o),n=!0},p(l,o){const a={};if(o&2&&(a.svgItem=l[1]),o&512&&s!==(s=l[9])){if(e){_e();const c=e;R(c.$$.fragment,1,0,()=>{Z(c,1)}),ve()}s?(e=di(s,r(l)),ee(e.$$.fragment),M(e.$$.fragment,1),Q(e,i.parentNode,i)):e=null}else s&&e.$set(a)},i(l){n||(e&&M(e.$$.fragment,l),n=!0)},o(l){e&&R(e.$$.fragment,l),n=!1},d(l){l&&k(i),e&&Z(e,l)}}}function Cd(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,p,g,v,y,O,P=!t[6]&&t[5]&&ir(t),C=t[9]&&nr(t);return{c(){e=b("div"),i=b("figure"),n=b("div"),P&&P.c(),s=N(),r=b("img"),o=N(),a=b("div"),c=b("a"),u=b("i"),f=N(),d=b("span"),d.textContent=`${V==="en"?"Download SVG":"Télécharger le SVG"}`,h=N(),C&&C.c(),m(n,"class","svg-container svelte-78b4ls"),m(r,"class","region-img svelte-78b4ls"),We(r.src,l=t[12])||m(r,"src",l),m(r,"alt","Extracted region"),m(i,"class","image card region-image svelte-78b4ls"),je(i,"width",t[3]?"50%":`${t[2]}px`),je(i,"aspect-ratio",t[7]?t[7].split(" ")[2]/t[7].split(" ")[3]:1),m(u,"class","fa-solid fa-download"),m(d,"class","tooltip svelte-78b4ls"),m(c,"class","button tag svelte-78b4ls"),m(c,"href",t[8]),m(c,"download",t[1]),m(a,"class","region-btn ml-1 svelte-78b4ls"),m(e,"class",p="region is-center "+(t[4]&&t[10](t[15])?"checked":"")+" svelte-78b4ls")},m(T,j){S(T,e,j),_(e,i),_(i,n),P&&P.m(n,null),_(i,s),_(i,r),_(e,o),_(e,a),_(a,c),_(c,u),_(c,f),_(c,d),_(a,h),C&&C.m(a,null),v=!0,y||(O=[re(i,"click",t[17]),re(i,"keyup",null),re(i,"mouseenter",t[18]),re(i,"mouseleave",t[19])],y=!0)},p(T,[j]){t=T,!t[6]&&t[5]?P?P.p(t,j):(P=ir(t),P.c(),P.m(n,null)):P&&(P.d(1),P=null),(!v||j&12)&&je(i,"width",t[3]?"50%":`${t[2]}px`),(!v||j&128)&&je(i,"aspect-ratio",t[7]?t[7].split(" ")[2]/t[7].split(" ")[3]:1),(!v||j&256)&&m(c,"href",t[8]),(!v||j&2)&&m(c,"download",t[1]),t[9]?C?(C.p(t,j),j&512&&M(C,1)):(C=nr(t),C.c(),M(C,1),C.m(a,null)):C&&(_e(),R(C,1,1,()=>{C=null}),ve()),(!v||j&1040&&p!==(p="region is-center "+(t[4]&&t[10](t[15])?"checked":"")+" svelte-78b4ls"))&&m(e,"class",p)},i(T){v||(M(C),Ze(()=>{v&&(g||(g=nt(e,pt,{duration:t[14]},!0)),g.run(1))}),v=!0)},o(T){R(C),g||(g=nt(e,pt,{duration:t[14]},!1)),g.run(0),v=!1},d(T){T&&k(e),P&&P.d(),C&&C.d(),T&&g&&g.end(),y=!1,Ie(O)}}}function Id(t,e,i){let n,{selectionStore:s}=e;s||(s=ht);const{isSelected:r}=s;oe(t,r,L=>i(10,n=L));let{toggleSelection:l=s.toggle}=e,{svgPath:o}=e,{width:a=200}=e,{fullWidth:c=!1}=e,{selectable:u=!0}=e;const[f,d,h,p]=o.replace(".svg","").split("_"),g=gt(`${f}_${d}_${h}`,p,`${a},`);let v=!1,y="",O="",P="";const C=Ae("qImgMetadata")||void 0,T=Ae("isInModal")||!1,j=T?0:500;let F;T||Mr(()=>import("./ModalController-5b2bb6e2.js"),[]).then(L=>i(9,F=L.default));let E={ref:o,img:`${f}_${d}_${h}`,xywh:p};bi(()=>{P&&URL.revokeObjectURL(P)}),vt(async()=>{const H=await(await fetch(`${oo}svg/${o}`)).text(),K=new DOMParser().parseFromString(H,"image/svg+xml"),U=K.querySelector("svg");i(7,O=U.getAttribute("viewBox")||`0 0 ${U.getAttribute("width")} ${U.getAttribute("height")}`),K.querySelectorAll("image").forEach(se=>se.remove()),U.setAttribute("viewBox",O),U.removeAttribute("width"),U.removeAttribute("height"),i(5,y=new XMLSerializer().serializeToString(K.documentElement))});const D=()=>u?l(E):null,Y=()=>i(6,v=!0),z=()=>i(6,v=!1);return t.$$set=L=>{"selectionStore"in L&&i(16,s=L.selectionStore),"toggleSelection"in L&&i(0,l=L.toggleSelection),"svgPath"in L&&i(1,o=L.svgPath),"width"in L&&i(2,a=L.width),"fullWidth"in L&&i(3,c=L.fullWidth),"selectable"in L&&i(4,u=L.selectable)},t.$$.update=()=>{if(t.$$.dirty&32&&y){const L=new Blob([y],{type:"image/svg+xml"});i(8,P=URL.createObjectURL(L))}},[l,o,a,c,u,y,v,O,P,F,n,r,g,C,j,E,s,D,Y,z]}class Od extends de{constructor(e){super(),fe(this,e,Id,Cd,ue,{selectionStore:16,toggleSelection:0,svgPath:1,width:2,fullWidth:3,selectable:4})}}function Ad(t){let e,i,n,s,r=V==="en"?"Download All":"Tout Télécharger",l,o,a;return{c(){e=b("div"),i=b("button"),n=b("i"),s=N(),l=G(r),m(n,"class","fa-solid fa-download"),m(i,"class","button is-link is-light"),m(e,"class","is-right mb-3")},m(c,u){S(c,e,u),_(e,i),_(i,n),_(i,s),_(i,l),o||(a=re(i,"click",t[0]),o=!0)},p:$,i:$,o:$,d(c){c&&k(e),o=!1,a()}}}function Td(t){const e=`${window.location.origin}${window.location.pathname}`,i=parseInt(e.split("witness/")[1].replace("/","")),n=parseInt(e.split("regions/")[1].replace("/",""));async function s(){if(!n&&!i){console.error("No Region or Witness");return}const r=n?`${window.location.origin}/${$e}/export-regions-imgs-and-svgs/${n}`:`${window.location.origin}/${$e}/export-all-imgs-and-svgs/${i}`;try{const l=await Dt(()=>fetch(r,{method:"GET",headers:{"X-CSRFToken":Ke,"Content-Type":"application/json"}}));if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const o=await l.blob();Or(o,"vectorizations.zip")}catch(l){console.error("Erreur lors du téléchargement des vectorisations:",l)}}return[s]}class Pd extends de{constructor(e){super(),fe(this,e,Td,Ad,ue,{})}}function sr(t,e,i){const n=t.slice();return n[8]=e[i],n}function Ld(t){let e;function i(r,l){return V==="en"?Rd:Md}let s=i()(t);return{c(){e=b("div"),s.c(),m(e,"class","faded is-center")},m(r,l){S(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:$,o:$,d(r){r&&k(e),s.d()}}}function Md(t){let e,i=t[11]+"",n;return{c(){e=G("Erreur lors de la récupération des régions vectorisées : "),n=G(i)},m(s,r){S(s,e,r),S(s,n,r)},p(s,r){r&2&&i!==(i=s[11]+"")&&ce(n,i)},d(s){s&&k(e),s&&k(n)}}}function Rd(t){let e,i=t[11]+"",n;return{c(){e=G("Error when retrieving vectorized regions: "),n=G(i)},m(s,r){S(s,e,r),S(s,n,r)},p(s,r){r&2&&i!==(i=s[11]+"")&&ce(n,i)},d(s){s&&k(e),s&&k(n)}}}function Dd(t){let e=[],i=new Map,n,s,r=t[2];const l=a=>a[8].id;for(let a=0;a<r.length;a+=1){let c=sr(t,r,a),u=l(c);i.set(u,e[a]=lr(u,c))}let o=null;return r.length||(o=rr()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);S(a,n,c),o&&o.m(a,c),s=!0},p(a,c){c&4&&(r=a[2],_e(),e=Ut(e,c,l,1,a,r,i,n.parentNode,Zt,lr,n,sr),ve(),!r.length&&o?o.p(a,c):r.length?o&&(o.d(1),o=null):(o=rr(),o.c(),o.m(n.parentNode,n)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)M(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)R(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),o&&o.d(a)}}}function rr(t){let e,i;return{c(){e=b("div"),e.textContent=`${V==="en"?"No vectorization":"Pas de vectorisation"}`,i=N(),m(e,"class","faded is-center")},m(n,s){S(n,e,s),S(n,i,s)},p:$,d(n){n&&k(e),n&&k(i)}}}function lr(t,e){let i,n,s;return n=new Od({props:{svgPath:e[8]}}),{key:t,first:null,c(){i=he(),ee(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),Q(n,r,l),s=!0},p(r,l){e=r;const o={};l&4&&(o.svgPath=e[8]),n.$set(o)},i(r){s||(M(n.$$.fragment,r),s=!0)},o(r){R(n.$$.fragment,r),s=!1},d(r){r&&k(i),Z(n,r)}}}function Nd(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"Retrieving vectorization page...":"Récupération la page de vectorisation..."}`,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,i:$,o:$,d(i){i&&k(e)}}}function jd(t){let e,i,n,s,r,l,o;e=new jt({props:{store:vi,nbOfItems:t[0].length,pageLength:t[6]}});let a={ctx:t,current:null,token:null,hasCatch:!0,pending:Nd,then:Dd,catch:Ld,value:7,error:11,blocks:[,,,]};return ct(s=t[1],a),l=new jt({props:{store:vi,nbOfItems:t[0].length,pageLength:t[6]}}),{c(){ee(e.$$.fragment),i=N(),n=b("div"),a.block.c(),r=N(),ee(l.$$.fragment),m(n,"class","grid is-gap-2 mx-5 svelte-1mje9rl")},m(c,u){Q(e,c,u),S(c,i,u),S(c,n,u),a.block.m(n,a.anchor=null),a.mount=()=>n,a.anchor=null,S(c,r,u),Q(l,c,u),o=!0},p(c,[u]){t=c;const f={};u&1&&(f.nbOfItems=t[0].length),e.$set(f),a.ctx=t,u&2&&s!==(s=t[1])&&ct(s,a)||Ft(a,t,u);const d={};u&1&&(d.nbOfItems=t[0].length),l.$set(d)},i(c){o||(M(e.$$.fragment,c),M(a.block),M(l.$$.fragment,c),o=!0)},o(c){R(e.$$.fragment,c);for(let u=0;u<3;u+=1){const f=a.blocks[u];R(f)}R(l.$$.fragment,c),o=!1},d(c){Z(e,c),c&&k(i),c&&k(n),a.block.d(),a.token=null,a=null,c&&k(r),Z(l,c)}}}function $d(t,e,i){let n,s,r;const{vectImgs:l,pageVectImgs:o,setPageVectImgs:a,pageLength:c}=vi;return oe(t,l,u=>i(0,n=u)),oe(t,o,u=>i(2,r=u)),oe(t,a,u=>i(1,s=u)),[n,s,r,l,o,a,c]}class Fd extends de{constructor(e){super(),fe(this,e,$d,jd,ue,{})}}function Ud(t){let e,i,n={ctx:t,current:null,token:null,hasCatch:!0,pending:qd,then:zd,catch:Vd,value:1,error:2,blocks:[,,,]};return ct(t[0],n),{c(){e=he(),n.block.c()},m(s,r){S(s,e,r),n.block.m(s,n.anchor=r),n.mount=()=>e.parentNode,n.anchor=e,i=!0},p(s,r){t=s,Ft(n,t,r)},i(s){i||(M(n.block),i=!0)},o(s){for(let r=0;r<3;r+=1){const l=n.blocks[r];R(l)}i=!1},d(s){s&&k(e),n.block.d(s),n.token=null,n=null}}}function Vd(t){let e;function i(r,l){return V==="en"?Bd:Hd}let s=i()(t);return{c(){e=b("div"),s.c(),m(e,"class","container faded is-center")},m(r,l){S(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:$,o:$,d(r){r&&k(e),s.d()}}}function Hd(t){let e,i=t[2]+"",n;return{c(){e=G("Erreur lors de la récupération des régions vectorisées : "),n=G(i)},m(s,r){S(s,e,r),S(s,n,r)},p:$,d(s){s&&k(e),s&&k(n)}}}function Bd(t){let e,i=t[2]+"",n;return{c(){e=G("Error when retrieving vectorized regions: "),n=G(i)},m(s,r){S(s,e,r),S(s,n,r)},p:$,d(s){s&&k(e),s&&k(n)}}}function zd(t){let e,i;return e=new Fd({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function qd(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"Retrieving vectorized regions...":"Récupération des régions vectorisées..."}`,m(e,"class","container faded is-center")},m(i,n){S(i,e,n)},p:$,i:$,o:$,d(i){i&&k(e)}}}function Kd(t){let e=Rt.includes("vectorization"),i,n,s=e&&Ud(t);return{c(){s&&s.c(),i=he()},m(r,l){s&&s.m(r,l),S(r,i,l),n=!0},p(r,[l]){e&&s.p(r,l)},i(r){n||(M(s),n=!0)},o(r){R(s),n=!1},d(r){s&&s.d(r),r&&k(i)}}}function xd(t){const{fetchVectorization:e}=vi;return[e]}class Wd extends de{constructor(e){super(),fe(this,e,xd,Kd,ue,{})}}function Gd(t){let e,i;return{c(){e=b("iframe"),We(e.src,i=t[0])||m(e,"src",i),je(e,"width","100%"),je(e,"height","75vh"),je(e,"border","none"),m(e,"title","Mirador viewer"),e.allowFullscreen=!0},m(n,s){S(n,e,s)},p(n,[s]){s&1&&!We(e.src,i=n[0])&&m(e,"src",i)},i:$,o:$,d(n){n&&k(e)}}}function Yd(t,e,i){let n="";return vt(()=>{manifests.length>0&&i(0,n=Nt(manifests[0]));function s(r){i(0,n=Nt(r.detail.selectedManifest))}window.addEventListener("selectManifest",s)}),[n]}class Jd extends de{constructor(e){super(),fe(this,e,Yd,Gd,ue,{})}}function or(t,e,i){const n=t.slice();return n[5]=e[i],n}function ar(t){let e,i=t[3](t[5])+"",n,s,r;return{c(){e=b("option"),n=G(i),s=N(),e.__value=r=t[5],e.value=e.__value},m(l,o){S(l,e,o),_(e,n),_(e,s)},p(l,o){o&1&&i!==(i=l[3](l[5])+"")&&ce(n,i),o&1&&r!==(r=l[5])&&(e.__value=r,e.value=e.__value)},d(l){l&&k(e)}}}function Xd(t){let e,i,n,s,r,l,o,a,c=t[0],u=[];for(let f=0;f<c.length;f+=1)u[f]=ar(or(t,c,f));return{c(){e=b("div"),i=b("label"),i.textContent=`${V==="en"?"Digitization:":"Numérisation :"}`,n=N(),s=b("div"),r=b("div"),l=b("select");for(let f=0;f<u.length;f+=1)u[f].c();m(i,"for","digit"),m(i,"class","label"),t[1]===void 0&&Ze(()=>t[4].call(l)),m(r,"class","select is-small"),m(s,"id","digit"),m(s,"class","control pl-3"),m(e,"class","field selector is-flex is-right mb-2")},m(f,d){S(f,e,d),_(e,i),_(e,n),_(e,s),_(s,r),_(r,l);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(l,null);Cn(l,t[1],!0),o||(a=[re(l,"change",t[4]),re(l,"change",t[2])],o=!0)},p(f,[d]){if(d&9){c=f[0];let h;for(h=0;h<c.length;h+=1){const p=or(f,c,h);u[h]?u[h].p(p,d):(u[h]=ar(p),u[h].c(),u[h].m(l,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=c.length}d&3&&Cn(l,f[1])},i:$,o:$,d(f){f&&k(e),st(u,f),o=!1,Ie(a)}}}function Qd(t,e,i){let{manifests:n}=e,s=(n==null?void 0:n[0])||"";function r(a){i(1,s=a.target.value),window.dispatchEvent(new CustomEvent("selectManifest",{detail:{selectedManifest:s}}))}function l(a){const c=a.match(/man(\d+)/),u=c?c[1]:"?",f=a.match(/anno(\d+)/),d=f?f[1]:null;let h="";return h+=`${V==="en"?"Manifest":"Manifeste"} #${u}`,d&&(h+=`, ${V==="en"?"Regions extraction":"Extraction de régions"} #${d}`),h}function o(){s=Bl(this),i(1,s),i(0,n)}return t.$$set=a=>{"manifests"in a&&i(0,n=a.manifests)},[n,s,r,l,o]}class Zd extends de{constructor(e){super(),fe(this,e,Qd,Xd,ue,{manifests:0})}}function cr(t,e,i){const n=t.slice();return n[25]=e[i][0],n[26]=e[i][1],n}function ur(t,e,i){const n=t.slice();return n[29]=e[i][0],n[30]=e[i][1],n}function fr(t,e,i){const n=t.slice();return n[35]=e[i],n[37]=i,n}function eh(t){let e,i,n;return i=new No({props:{witness:t[1],editUrl:t[2],viewTitle:t[3]}}),{c(){e=b("div"),ee(i.$$.fragment),m(e,"slot","sidebar")},m(s,r){S(s,e,r),Q(i,e,null),n=!0},p(s,r){const l={};r[0]&2&&(l.witness=s[1]),r[0]&4&&(l.editUrl=s[2]),r[0]&8&&(l.viewTitle=s[3]),i.$set(l)},i(s){n||(M(i.$$.fragment,s),n=!0)},o(s){R(i.$$.fragment,s),n=!1},d(s){s&&k(e),Z(i)}}}function th(t){let e,i,n,s,r,l,o,a,c,u,f,d,h;s=new sa({props:{baseUrl:t[15],currentRegionId:t[16],activeTab:t[33]}});const p=[rh,sh,nh],g=[];function v(C,T){return C[33]==="all"||C[33]==="page"?0:C[33]==="viewer"?1:C[33]==="vectorization"?2:-1}~(o=v(t))&&(a=g[o]=p[o](t));const y=[uh,ch,ah,oh,lh],O=[];function P(C,T){return C[33]==="viewer"?0:C[33]==="all"?1:C[33]==="page"?2:C[33]==="similarity"?3:C[33]==="vectorization"?4:-1}return~(u=P(t))&&(f=O[u]=y[u](t)),{c(){e=b("div"),i=b("div"),n=b("div"),ee(s.$$.fragment),r=N(),l=b("div"),a&&a.c(),c=N(),f&&f.c(),d=he(),m(n,"class","cell is-left"),m(l,"class","cell"),m(i,"class","actions grid"),m(e,"id","nav-actions")},m(C,T){S(C,e,T),_(e,i),_(i,n),Q(s,n,null),_(i,r),_(i,l),~o&&g[o].m(l,null),S(C,c,T),~u&&O[u].m(C,T),S(C,d,T),h=!0},p(C,T){const j={};T[1]&4&&(j.activeTab=C[33]),s.$set(j);let F=o;o=v(C),o===F?~o&&g[o].p(C,T):(a&&(_e(),R(g[F],1,1,()=>{g[F]=null}),ve()),~o?(a=g[o],a?a.p(C,T):(a=g[o]=p[o](C),a.c()),M(a,1),a.m(l,null)):a=null);let E=u;u=P(C),u===E?~u&&O[u].p(C,T):(f&&(_e(),R(O[E],1,1,()=>{O[E]=null}),ve()),~u?(f=O[u],f?f.p(C,T):(f=O[u]=y[u](C),f.c()),M(f,1),f.m(d.parentNode,d)):f=null)},i(C){h||(M(s.$$.fragment,C),M(a),M(f),h=!0)},o(C){R(s.$$.fragment,C),R(a),R(f),h=!1},d(C){C&&k(e),Z(s),~o&&g[o].d(),C&&k(c),~u&&O[u].d(C),C&&k(d)}}}function ih(t){let e,i;return{c(){e=b("article"),i=b("div"),i.textContent=`${V==="en"?"This witness has no digitization.":"Ce témoin n'a pas de numérisation."}`,m(i,"class","message-body"),m(e,"class","message is-warning")},m(n,s){S(n,e,s),_(e,i)},p:$,i:$,o:$,d(n){n&&k(e)}}}function nh(t){let e,i;return e=new Pd({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function sh(t){let e,i;return e=new Zd({props:{manifests:t[0]}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p(n,s){const r={};s[0]&1&&(r.manifests=n[0]),e.$set(r)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function rh(t){let e,i;return e=new da({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function lh(t){let e,i;return e=new Wd({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function oh(t){let e,i;return e=new id({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function ah(t){let e,i;return e=new hd({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function ch(t){let e,i,n={ctx:t,current:null,token:null,hasCatch:!0,pending:hh,then:dh,catch:fh,value:34,error:38,blocks:[,,,]};return ct(t[14],n),{c(){e=b("div"),n.block.c(),m(e,"class","grid is-gap-2 mt-5")},m(s,r){S(s,e,r),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,i=!0},p(s,r){t=s,Ft(n,t,r)},i(s){i||(M(n.block),i=!0)},o(s){for(let r=0;r<3;r+=1){const l=n.blocks[r];R(l)}i=!1},d(s){s&&k(e),n.block.d(),n.token=null,n=null}}}function uh(t){let e,i;return e=new Jd({}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function fh(t){let e,i,n=t[38]+"",s;return{c(){e=b("div"),i=G("Error when retrieving regions: "),s=G(n)},m(r,l){S(r,e,l),_(e,i),_(e,s)},p:$,i:$,o:$,d(r){r&&k(e)}}}function dh(t){let e=[],i=new Map,n,s,r=Object.values(t[9]);const l=a=>a[35].id;for(let a=0;a<r.length;a+=1){let c=fr(t,r,a),u=l(c);i.set(u,e[a]=hr(u,c))}let o=null;return r.length||(o=dr(t)),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);S(a,n,c),o&&o.m(a,c),s=!0},p(a,c){c[0]&98816&&(r=Object.values(a[9]),_e(),e=Ut(e,c,l,1,a,r,i,n.parentNode,Zt,hr,n,fr),ve(),!r.length&&o?o.p(a,c):r.length?o&&(_e(),R(o,1,1,()=>{o=null}),ve()):(o=dr(a),o.c(),M(o,1),o.m(n.parentNode,n)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)M(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)R(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),o&&o.d(a)}}}function dr(t){let e,i;return e=new Rr({props:{currentRegionId:t[16],baseUrl:t[15]}}),{c(){ee(e.$$.fragment)},m(n,s){Q(e,n,s),i=!0},p:$,i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){R(e.$$.fragment,n),i=!1},d(n){Z(e,n)}}}function hr(t,e){let i,n,s;return n=new an({props:{item:e[35],items:Object.values(e[9]),index:e[37]}}),{key:t,first:null,c(){i=he(),ee(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),Q(n,r,l),s=!0},p(r,l){e=r;const o={};l[0]&512&&(o.item=e[35]),l[0]&512&&(o.items=Object.values(e[9])),l[0]&512&&(o.index=e[37]),n.$set(o)},i(r){s||(M(n.$$.fragment,r),s=!0)},o(r){R(n.$$.fragment,r),s=!1},d(r){r&&k(i),Z(n,r)}}}function hh(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"Retrieving regions...":"Récupération des régions..."}`,m(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:$,i:$,o:$,d(i){i&&k(e)}}}function mh(t){let e,i,n,s;const r=[ih,th],l=[];function o(a,c){return a[0].length===0?0:1}return i=o(t),n=l[i]=r[i](t),{c(){e=b("div"),n.c(),m(e,"slot","content")},m(a,c){S(a,e,c),l[i].m(e,null),s=!0},p(a,c){let u=i;i=o(a),i===u?l[i].p(a,c):(_e(),R(l[u],1,1,()=>{l[u]=null}),ve(),n=l[i],n?n.p(a,c):(n=l[i]=r[i](a),n.c()),M(n,1),n.m(e,null))},i(a){s||(M(n),s=!0)},o(a){R(n),s=!1},d(a){a&&k(e),l[i].d()}}}function ph(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"No regions in selection":"Aucune région sélectionnée"}`},m(i,n){S(i,e,n)},p:$,d(i){i&&k(e)}}}function gh(t){let e,i,n=Object.entries(t[7]),s=[];for(let r=0;r<n.length;r+=1)s[r]=pr(cr(t,n,r));return{c(){e=b("div"),i=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(i,"class","grid is-gap-2"),m(e,"class","fixed-grid has-6-cols")},m(r,l){S(r,e,l),_(e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,null)},p(r,l){if(l[0]&4224){n=Object.entries(r[7]);let o;for(o=0;o<n.length;o+=1){const a=cr(r,n,o);s[o]?s[o].p(a,l):(s[o]=pr(a),s[o].c(),s[o].m(i,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},d(r){r&&k(e),st(s,r)}}}function mr(t){let e,i,n,s,r,l,o,a=t[30].title+"",c,u,f,d,h,p;function g(){return t[24](t[29])}return{c(){e=b("div"),i=b("figure"),n=b("img"),r=N(),l=b("div"),o=b("span"),c=G(a),u=N(),f=b("button"),d=N(),We(n.src,s=gt(t[30].img,t[30].xywh,"96,"))||m(n,"src",s),m(n,"alt",""),m(o,"class","overlay-desc"),m(l,"class","overlay is-center svelte-qn8evk"),m(i,"class","image is-64x64 card"),m(f,"class","delete region-btn"),m(e,"class","selection cell svelte-qn8evk")},m(v,y){S(v,e,y),_(e,i),_(i,n),_(i,r),_(i,l),_(l,o),_(o,c),_(e,u),_(e,f),_(e,d),h||(p=re(f,"click",g),h=!0)},p(v,y){t=v,y[0]&128&&!We(n.src,s=gt(t[30].img,t[30].xywh,"96,"))&&m(n,"src",s),y[0]&128&&a!==(a=t[30].title+"")&&ce(c,a)},d(v){v&&k(e),h=!1,p()}}}function pr(t){let e,i=Object.entries(t[26]),n=[];for(let s=0;s<i.length;s+=1)n[s]=mr(ur(t,i,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=he()},m(s,r){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(s,r);S(s,e,r)},p(s,r){if(r[0]&4224){i=Object.entries(s[26]);let l;for(l=0;l<i.length;l+=1){const o=ur(s,i,l);n[l]?n[l].p(o,r):(n[l]=mr(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(s){st(n,s),s&&k(e)}}}function _h(t){let e;function i(r,l){return r[6]?gh:ph}let n=i(t),s=n(t);return{c(){s.c(),e=he()},m(r,l){s.m(r,l),S(r,e,l)},p(r,l){n===(n=i(r))&&s?s.p(r,l):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&k(e)}}}function vh(t){let e,i,n,s,r,l,o,a,c,u;return e=new Lr({props:{visible:t[8]}}),n=new So({}),r=new Go({props:{selectionLength:t[4]}}),o=new Mo({props:{tabList:t[5],$$slots:{content:[mh,({activeTab:f})=>({33:f}),({activeTab:f})=>[0,f?4:0]],sidebar:[eh,({activeTab:f})=>({33:f}),({activeTab:f})=>[0,f?4:0]]},$$scope:{ctx:t}}}),c=new Sd({props:{selectionLength:t[4],selectionStore:ht,$$slots:{default:[_h]},$$scope:{ctx:t}}}),{c(){ee(e.$$.fragment),i=N(),ee(n.$$.fragment),s=N(),ee(r.$$.fragment),l=N(),ee(o.$$.fragment),a=N(),ee(c.$$.fragment)},m(f,d){Q(e,f,d),S(f,i,d),Q(n,f,d),S(f,s,d),Q(r,f,d),S(f,l,d),Q(o,f,d),S(f,a,d),Q(c,f,d),u=!0},p(f,d){const h={};d[0]&256&&(h.visible=f[8]),e.$set(h);const p={};d[0]&16&&(p.selectionLength=f[4]),r.$set(p);const g={};d[0]&32&&(g.tabList=f[5]),d[0]&527|d[1]&260&&(g.$$scope={dirty:d,ctx:f}),o.$set(g);const v={};d[0]&16&&(v.selectionLength=f[4]),d[0]&192|d[1]&256&&(v.$$scope={dirty:d,ctx:f}),c.$set(v)},i(f){u||(M(e.$$.fragment,f),M(n.$$.fragment,f),M(r.$$.fragment,f),M(o.$$.fragment,f),M(c.$$.fragment,f),u=!0)},o(f){R(e.$$.fragment,f),R(n.$$.fragment,f),R(r.$$.fragment,f),R(o.$$.fragment,f),R(c.$$.fragment,f),u=!1},d(f){Z(e,f),f&&k(i),Z(n,f),f&&k(s),Z(r,f),f&&k(l),Z(o,f),f&&k(a),Z(c,f)}}}function bh(t,e,i){let n,s,r,l,o,a,c;oe(t,Et,L=>i(8,a=L));const{selected:u,nbSelected:f,remove:d}=ht;oe(t,u,L=>i(23,o=L)),oe(t,f,L=>i(22,l=L));const{allRegions:h,fetchAll:p}=_t;oe(t,h,L=>i(9,c=L));let{manifest:g=""}=e,{manifests:v=[]}=e,{isValidated:y=!1}=e,{imgPrefix:O=""}=e,{nbOfPages:P=1}=e,{trailingZeros:C=1}=e,{witness:T={}}=e,{editUrl:j=""}=e,{viewTitle:F=""}=e;lt("witness",T),lt("nbOfPages",P),lt("trailingZeros",C),lt("imgPrefix",O),lt("manifest",g),lt("isValidated",y);const E=`${window.location.origin}${window.location.pathname}`,D=parseInt(E.split("regions/")[1].replace("/","")),Y={viewer:V==="en"?"Viewer":"Visionneuse",all:V==="en"?"All regions":"Toutes les régions",page:V==="en"?"Per page":"Par page"};Rt.includes("similarity")&&(Y.similarity=V==="en"?"Similarity":"Similarité"),Rt.includes("vectorization")&&(Y.vectorization=V==="en"?"Vectorization":"Vectorisation");const z=L=>d(L,Jt);return t.$$set=L=>{"manifest"in L&&i(17,g=L.manifest),"manifests"in L&&i(0,v=L.manifests),"isValidated"in L&&i(18,y=L.isValidated),"imgPrefix"in L&&i(19,O=L.imgPrefix),"nbOfPages"in L&&i(20,P=L.nbOfPages),"trailingZeros"in L&&i(21,C=L.trailingZeros),"witness"in L&&i(1,T=L.witness),"editUrl"in L&&i(2,j=L.editUrl),"viewTitle"in L&&i(3,F=L.viewTitle)},t.$$.update=()=>{t.$$.dirty[0]&8388608&&i(7,n=o),t.$$.dirty[0]&4194304&&i(4,s=l),t.$$.dirty[0]&16&&i(6,r=s>0)},[v,T,j,F,s,Y,r,n,a,c,u,f,d,h,p,E,D,g,y,O,P,C,l,o,z]}class wh extends de{constructor(e){super(),fe(this,e,bh,vh,ue,{manifest:17,manifests:0,isValidated:18,imgPrefix:19,nbOfPages:20,trailingZeros:21,witness:1,editUrl:2,viewTitle:3},null,[-1,-1])}}new wh({target:document.getElementById("witness-view"),props:{viewTitle,editUrl,witness,manifest,manifests,isValidated,imgPrefix,nbOfPages,trailingZeros}});export{_e as A,ve as B,st as C,Ie as D,tn as E,vt as F,bi as G,Fo as H,G as I,Ct as J,Rl as K,Qe as L,lt as M,Zr as N,ml as O,Ee as P,ze as Q,an as R,de as S,ki as T,Ae as U,Od as V,Jc as W,Xa as X,Mr as _,m as a,S as b,ee as c,R as d,b as e,k as f,Z as g,ct as h,fe as i,N as j,We as k,V as l,Q as m,_ as n,$ as o,Sh as p,je as q,gt as r,ue as s,M as t,Ft as u,di as v,qe as w,re as x,yh as y,kh as z};
//# sourceMappingURL=witness.js.map
