function j(){}const Us=i=>i;function io(i,e){for(const t in e)i[t]=e[t];return i}function no(i){return!!i&&(typeof i=="object"||typeof i=="function")&&typeof i.then=="function"}function Hs(i){return i()}function Un(){return Object.create(null)}function Ie(i){i.forEach(Hs)}function fi(i){return typeof i=="function"}function le(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}let yi;function $e(i,e){return yi||(yi=document.createElement("a")),yi.href=e,i===yi.href}function ro(i){return Object.keys(i).length===0}function gn(i,...e){if(i==null)return j;const t=i.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function _n(i){let e;return gn(i,t=>e=t)(),e}function ue(i,e,t){i.$$.on_destroy.push(gn(e,t))}function He(i,e,t,n){if(i){const r=Bs(i,e,t,n);return i[0](r)}}function Bs(i,e,t,n){return i[1]&&n?io(t.ctx.slice(),i[1](n(e))):t.ctx}function Be(i,e,t,n){if(i[2]&&n){const r=i[2](n(t));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],l=Math.max(e.dirty.length,r.length);for(let o=0;o<l;o+=1)s[o]=e.dirty[o]|r[o];return s}return e.dirty|r}return e.dirty}function qe(i,e,t,n,r,s){if(r){const l=Bs(e,t,n,s);i.p(l,r)}}function ze(i){if(i.ctx.length>32){const e=[],t=i.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function so(i){const e={};for(const t in i)e[t]=!0;return e}function ki(i){return i??""}function Ti(i){return i&&fi(i.destroy)?i.destroy:j}const qs=typeof window<"u";let lo=qs?()=>window.performance.now():()=>Date.now(),vn=qs?i=>requestAnimationFrame(i):j;const Rt=new Set;function zs(i){Rt.forEach(e=>{e.c(i)||(Rt.delete(e),e.f())}),Rt.size!==0&&vn(zs)}function oo(i){let e;return Rt.size===0&&vn(zs),{promise:new Promise(t=>{Rt.add(e={c:i,f:t})}),abort(){Rt.delete(e)}}}function _(i,e){i.appendChild(e)}function Ks(i){if(!i)return document;const e=i.getRootNode?i.getRootNode():i.ownerDocument;return e&&e.host?e:i.ownerDocument}function ao(i){const e=b("style");return co(Ks(i),e),e.sheet}function co(i,e){return _(i.head||i,e),e.sheet}function C(i,e,t){i.insertBefore(e,t||null)}function E(i){i.parentNode&&i.parentNode.removeChild(i)}function et(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function b(i){return document.createElement(i)}function Ue(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function J(i){return document.createTextNode(i)}function D(){return J(" ")}function _e(){return J("")}function ie(i,e,t,n){return i.addEventListener(e,t,n),()=>i.removeEventListener(e,t,n)}function wt(i){return function(e){return e.preventDefault(),i.call(this,e)}}function Ws(i){return function(e){return e.stopPropagation(),i.call(this,e)}}function m(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}function uo(i){return Array.from(i.childNodes)}function fe(i,e){e=""+e,i.data!==e&&(i.data=e)}function Dt(i,e){i.value=e??""}function ve(i,e,t,n){t==null?i.style.removeProperty(e):i.style.setProperty(e,t,n?"important":"")}function Hn(i,e,t){for(let n=0;n<i.options.length;n+=1){const r=i.options[n];if(r.__value===e){r.selected=!0;return}}(!t||e!==void 0)&&(i.selectedIndex=-1)}function fo(i){const e=i.querySelector(":checked");return e&&e.__value}function Ce(i,e,t){i.classList[t?"add":"remove"](e)}function Gs(i,e,{bubbles:t=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(i,t,n,e),r}class ho{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.is_svg?this.e=Ue(t.nodeName):this.e=b(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)C(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(E)}}const Mi=new Map;let Pi=0;function mo(i){let e=5381,t=i.length;for(;t--;)e=(e<<5)-e^i.charCodeAt(t);return e>>>0}function po(i,e){const t={stylesheet:ao(e),rules:{}};return Mi.set(i,t),t}function Bn(i,e,t,n,r,s,l,o=0){const a=16.666/n;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(t-e)*s(v);c+=v*100+`%{${l(w,1-w)}}
`}const u=c+`100% {${l(t,1-t)}}
}`,h=`__svelte_${mo(u)}_${o}`,f=Ks(i),{stylesheet:d,rules:p}=Mi.get(f)||po(f,i);p[h]||(p[h]=!0,d.insertRule(`@keyframes ${h} ${u}`,d.cssRules.length));const g=i.style.animation||"";return i.style.animation=`${g?`${g}, `:""}${h} ${n}ms linear ${r}ms 1 both`,Pi+=1,h}function go(i,e){const t=(i.style.animation||"").split(", "),n=t.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),r=t.length-n.length;r&&(i.style.animation=n.join(", "),Pi-=r,Pi||_o())}function _o(){vn(()=>{Pi||(Mi.forEach(i=>{const{ownerNode:e}=i.stylesheet;e&&E(e)}),Mi.clear())})}let ai;function ct(i){ai=i}function zt(){if(!ai)throw new Error("Function called outside component initialization");return ai}function st(i){zt().$$.on_mount.push(i)}function di(i){zt().$$.on_destroy.push(i)}function Kt(){const i=zt();return(e,t,{cancelable:n=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=Gs(e,t,{cancelable:n});return r.slice().forEach(l=>{l.call(i,s)}),!s.defaultPrevented}return!0}}function at(i,e){return zt().$$.context.set(i,e),e}function Je(i){return zt().$$.context.get(i)}function Li(i,e){const t=i.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const Pt=[],ft=[];let $t=[];const sn=[],vo=Promise.resolve();let ln=!1;function bo(){ln||(ln=!0,vo.then(bn))}function rt(i){$t.push(i)}function Nt(i){sn.push(i)}const Zi=new Set;let Tt=0;function bn(){if(Tt!==0)return;const i=ai;do{try{for(;Tt<Pt.length;){const e=Pt[Tt];Tt++,ct(e),wo(e.$$)}}catch(e){throw Pt.length=0,Tt=0,e}for(ct(null),Pt.length=0,Tt=0;ft.length;)ft.pop()();for(let e=0;e<$t.length;e+=1){const t=$t[e];Zi.has(t)||(Zi.add(t),t())}$t.length=0}while(Pt.length);for(;sn.length;)sn.pop()();ln=!1,Zi.clear(),ct(i)}function wo(i){if(i.fragment!==null){i.update(),Ie(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(rt)}}function yo(i){const e=[],t=[];$t.forEach(n=>i.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),$t=e}let ti;function ko(){return ti||(ti=Promise.resolve(),ti.then(()=>{ti=null})),ti}function en(i,e,t){i.dispatchEvent(Gs(`${e?"intro":"outro"}${t}`))}const Ii=new Set;let ut;function pe(){ut={r:0,c:[],p:ut}}function ge(){ut.r||Ie(ut.c),ut=ut.p}function O(i,e){i&&i.i&&(Ii.delete(i),i.i(e))}function L(i,e,t,n){if(i&&i.o){if(Ii.has(i))return;Ii.add(i),ut.c.push(()=>{Ii.delete(i),n&&(t&&i.d(1),n())}),i.o(e)}else n&&n()}const So={duration:0};function vt(i,e,t,n){const r={direction:"both"};let s=e(i,t,r),l=n?0:1,o=null,a=null,c=null;function u(){c&&go(i,c)}function h(d,p){const g=d.b-l;return p*=Math.abs(g),{a:l,b:d.b,d:g,duration:p,start:d.start,end:d.start+p,group:d.group}}function f(d){const{delay:p=0,duration:g=300,easing:v=Us,tick:w=j,css:S}=s||So,P={start:lo()+p,b:d};d||(P.group=ut,ut.r+=1),o||a?a=P:(S&&(u(),c=Bn(i,l,d,g,p,v,S)),d&&w(0,1),o=h(P,g),rt(()=>en(i,d,"start")),oo(M=>{if(a&&M>a.start&&(o=h(a,g),a=null,en(i,o.b,"start"),S&&(u(),c=Bn(i,l,o.b,o.duration,0,v,s.css))),o){if(M>=o.end)w(l=o.b,1-l),en(i,o.b,"end"),a||(o.b?u():--o.group.r||Ie(o.group.c)),o=null;else if(M>=o.start){const I=M-o.start;l=o.a+o.d*v(I/o.duration),w(l,1-l)}}return!!(o||a)}))}return{run(d){fi(s)?ko().then(()=>{s=s(r),f(d)}):f(d)},end(){u(),o=a=null}}}function Ze(i,e){const t=e.token={};function n(r,s,l,o){if(e.token!==t)return;e.resolved=o;let a=e.ctx;l!==void 0&&(a=a.slice(),a[l]=o);const c=r&&(e.current=r)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((h,f)=>{f!==s&&h&&(pe(),L(h,1,1,()=>{e.blocks[f]===h&&(e.blocks[f]=null)}),ge())}):e.block.d(1),c.c(),O(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[s]=c),u&&bn()}if(no(i)){const r=zt();if(i.then(s=>{ct(r),n(e.then,1,e.value,s),ct(null)},s=>{if(ct(r),n(e.catch,2,e.error,s),ct(null),!e.hasCatch)throw s}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,i),!0;e.resolved=i}}function At(i,e,t){const n=e.slice(),{resolved:r}=i;i.current===i.then&&(n[i.value]=r),i.current===i.catch&&(n[i.error]=r),i.block.p(n,t)}function Eo(i,e){i.d(1),e.delete(i.key)}function Fi(i,e){L(i,1,1,()=>{e.delete(i.key)})}function hi(i,e,t,n,r,s,l,o,a,c,u,h){let f=i.length,d=s.length,p=f;const g={};for(;p--;)g[i[p].key]=p;const v=[],w=new Map,S=new Map,P=[];for(p=d;p--;){const T=h(r,s,p),y=t(T);let F=l.get(y);F?n&&P.push(()=>F.p(T,e)):(F=c(y,T),F.c()),w.set(y,v[p]=F),y in g&&S.set(y,Math.abs(p-g[y]))}const M=new Set,I=new Set;function R(T){O(T,1),T.m(o,u),l.set(T.key,T),u=T.first,d--}for(;f&&d;){const T=v[d-1],y=i[f-1],F=T.key,Y=y.key;T===y?(u=T.first,f--,d--):w.has(Y)?!l.has(F)||M.has(F)?R(T):I.has(Y)?f--:S.get(F)>S.get(Y)?(I.add(F),R(T)):(M.add(Y),f--):(a(y,l),f--)}for(;f--;){const T=i[f];w.has(T.key)||a(T,l)}for(;d;)R(v[d-1]);return Ie(P),v}function jt(i,e,t){const n=i.$$.props[e];n!==void 0&&(i.$$.bound[n]=t,t(i.$$.ctx[n]))}function G(i){i&&i.c()}function K(i,e,t,n){const{fragment:r,after_update:s}=i.$$;r&&r.m(e,t),n||rt(()=>{const l=i.$$.on_mount.map(Hs).filter(fi);i.$$.on_destroy?i.$$.on_destroy.push(...l):Ie(l),i.$$.on_mount=[]}),s.forEach(rt)}function W(i,e){const t=i.$$;t.fragment!==null&&(yo(t.after_update),Ie(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Co(i,e){i.$$.dirty[0]===-1&&(Pt.push(i),bo(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function oe(i,e,t,n,r,s,l,o=[-1]){const a=ai;ct(i);const c=i.$$={fragment:null,ctx:[],props:s,update:j,not_equal:r,bound:Un(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Un(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};l&&l(c.root);let u=!1;if(c.ctx=t?t(i,e.props||{},(h,f,...d)=>{const p=d.length?d[0]:f;return c.ctx&&r(c.ctx[h],c.ctx[h]=p)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](p),u&&Co(i,h)),f}):[],c.update(),u=!0,Ie(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const h=uo(e.target);c.fragment&&c.fragment.l(h),h.forEach(E)}else c.fragment&&c.fragment.c();e.intro&&O(i.$$.fragment),K(i,e.target,e.anchor,e.customElement),bn()}ct(a)}class ae{$destroy(){W(this,1),this.$destroy=j}$on(e,t){if(!fi(t))return j;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!ro(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Io(i){const e=i-1;return e*e*e+1}function Vt(i,{delay:e=0,duration:t=400,easing:n=Us}={}){const r=+getComputedStyle(i).opacity;return{delay:e,duration:t,easing:n,css:s=>`opacity: ${s*r}`}}function qn(i,{delay:e=0,duration:t=400,easing:n=Io,axis:r="y"}={}){const s=getComputedStyle(i),l=+s.opacity,o=r==="y"?"height":"width",a=parseFloat(s[o]),c=r==="y"?["top","bottom"]:["left","right"],u=c.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),h=parseFloat(s[`padding${u[0]}`]),f=parseFloat(s[`padding${u[1]}`]),d=parseFloat(s[`margin${u[0]}`]),p=parseFloat(s[`margin${u[1]}`]),g=parseFloat(s[`border${u[0]}Width`]),v=parseFloat(s[`border${u[1]}Width`]);return{delay:e,duration:t,easing:n,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*l};${o}: ${w*a}px;padding-${c[0]}: ${w*h}px;padding-${c[1]}: ${w*f}px;margin-${c[0]}: ${w*d}px;margin-${c[1]}: ${w*p}px;border-${c[0]}-width: ${w*g}px;border-${c[1]}-width: ${w*v}px;`}}const Mt=[];function Oo(i,e){return{subscribe:Ee(i,e).subscribe}}function Ee(i,e=j){let t;const n=new Set;function r(o){if(le(i,o)&&(i=o,t)){const a=!Mt.length;for(const c of n)c[1](),Mt.push(c,i);if(a){for(let c=0;c<Mt.length;c+=2)Mt[c][0](Mt[c+1]);Mt.length=0}}}function s(o){r(o(i))}function l(o,a=j){const c=[o,a];return n.add(c),n.size===1&&(t=e(r)||j),o(i),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}return{set:r,update:s,subscribe:l}}function Ye(i,e,t){const n=!Array.isArray(i),r=n?[i]:i,s=e.length<2;return Oo(t,l=>{let o=!1;const a=[];let c=0,u=j;const h=()=>{if(c)return;u();const d=e(n?a[0]:a,l);s?l(d):u=fi(d)?d:j},f=r.map((d,p)=>gn(d,g=>{a[p]=g,c&=~(1<<p),o&&h()},()=>{c|=1<<p}));return o=!0,h(),function(){Ie(f),u(),o=!1}})}const N=APP_LANG,Ve=APP_NAME;WEBAPP_NAME;const Oi=USER_ID,Ao=IS_SUPERUSER,Xe=CSRF_TOKEN,Ft=ADDITIONAL_MODULES,ci="Region";APP_URL;const To=SAS_APP_URL,Mo=CANTALOUPE_APP_URL,Po=MEDIA_PATH,Lo=PAGE_LEN,Ot=Ee(!1),Ys=Ee(""),Ro=i=>typeof i=="string"||i instanceof String;async function Ut(i){Ot.set(!0);try{return await i()}finally{Ot.set(!1)}}function xs(i){return i.match(/\d+/g).toString()}function $o(i){return parseInt(xs(i),10)}function Js(i,e=100){const t=Math.floor(e*.75);return i.length>e?i.slice(0,t)+"..."+i.slice(-e+t):i}function si(){return Mo??"http://localhost:8182"}function Xs(){return To??"http://localhost:8888"}function wn(i,e){if(typeof window<"u"){const t=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(t))return i.set(t),t}return i.set(1),1}function yn(i,e,t){if(e.set(i),typeof window<"u"){const n=new URL(window.location.href);n.searchParams.set(t,i),window.history.pushState({},"",n)}}function Do(i=null){if(i)return i=i.split("_"),i.length<3?void 0:`${i.slice(0,3).join("_").replace(".jpg","")}.jpg`}function No(i=null){const e=Do(i);return e===void 0?void 0:`${si()}/iiif/2/${e}`}function dt(i=null,e=null,t="full"){if(e=Ro(e)?e.replace(".jpg",""):e,!i)return"https://placehold.co/96x96/png?text=No+image";if(!i.startsWith("wit")){const[s,...l]=i.split("_wit");i=`wit${l}`}const n=No(i);if(n===void 0)return"https://placehold.co/96x96/png?text=No+image";const r=i.split("_");return e||(e=r[r.length-1].includes(",")?r.pop().replace(".jpg",""):"full"),`${n}/${e}/${t}/0/default.jpg`}function Ht(i=null,e=1){return`${Xs()}/index.html?iiif-content=${i}&canvas=${e}`}function Re(i,e=null,t=!1){return new Promise(n=>{if(document.getElementById("msg-modal")){t?document.getElementById("modal-footer").hidden=!1:n(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=i,document.getElementById("hidden-msg-btn").click();const s=document.getElementById("cancel-btn"),l=document.getElementById("ok-btn"),o=document.getElementById("modal-bkg"),a=()=>{s.removeEventListener("click",c),o.removeEventListener("click",c),l.removeEventListener("click",u),document.getElementById("modal-footer").hidden=!0},c=()=>{a(),n(!1)},u=()=>{a(),n(!0)};s.addEventListener("click",c),l.addEventListener("click",u)}else t?n(window.confirm(i)):(window.alert(i),n(void 0))})}function Qs(i,e){const t=window.URL.createObjectURL(i),n=document.createElement("a");n.href=t,n.download=`${e}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(t),document.body.removeChild(n)}function Ri(){let i,e,t=(n,r)=>n===r;return{set:n=>{e=i,i=n},setCompareFn:n=>t=n,get:()=>i,getNewAndOld:()=>[i,e],same:()=>t(i,e)}}const kn=(i,e)=>Array.isArray(i)&&Array.isArray(e)&&i.length===e.length&&i.every((t,n)=>t===e[n]||void 0);function Zs(i=null){return i<600?1:i<800?2:i<1e3?3:i<1200?4:i<1400?5:i>=1400?6:4}function el(i){const e=i.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),t=()=>i.classList.remove("is-active");e.forEach(r=>r.addEventListener("click",t));const n=r=>{r.key==="Escape"&&i.classList.contains("is-active")&&t()};return document.addEventListener("keydown",n),{destroy(){e.forEach(r=>r.removeEventListener("click",t)),document.removeEventListener("keydown",n)}}}function tl(i){const e=()=>{const t=document.getElementById(i.dataset.target);t==null||t.classList.add("is-active")};return i.addEventListener("click",e),{destroy(){i.removeEventListener("click",e)}}}function Sn(i){const{type:e,modelName:t,title:n,extractMeta:r=d=>d}=i,s={id:null,type:e,title:n,is_public:!1,selected:{}},l=JSON.parse(localStorage.getItem(e))||s,o=Ee(l),a=Ee(!1);function c(d,p=!1){a.set(p),localStorage.setItem(e,JSON.stringify(d))}function u(){o.update(d=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),d;const p=Object.fromEntries(Object.entries(d.selected).map(([v,w])=>[v,Object.keys(w)])),g=d.id?`${d.id}/edit`:"new";return fetch(`${window.location.origin}/${t}/${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify({title:d.title,is_public:d.is_public,selection:d,...p})}).then(v=>v.json()).then(v=>{if(!(v!=null&&v.document_set_id))throw new Error("Failed to save");o.update(w=>(w.id=v.document_set_id,w.title=v.document_set_title,w.is_public=v.is_public,c(w,!0),w))}).catch(v=>console.error("Error:",v)),d})}const h=d=>o.update(()=>{const p=d.selection.id?d.selection:{...d.selection,id:d.id};return c(p),p}),f=()=>o.update(()=>{const d={...s,selected:{}};return c(d),d});return{type:e,subscribe:o.subscribe,add:d=>o.update(p=>(p.selected[d.class]={...p.selected[d.class]||{},[d.id]:r(d)},c(p),p)),addAll:d=>o.update(p=>(d.forEach(g=>{p.selected[g.class]={...p.selected[g.class]||{},[g.id]:r(g)}}),c(p),p)),remove:(d,p)=>o.update(g=>{const{[d]:v,...w}=g.selected[p];return g.selected[p]=w,c(g),g}),removeAll:(d,p)=>o.update(g=>(d.forEach(v=>{var w;return(w=g.selected[p])==null?!0:delete w[v]}),c(g),g)),toggle:d=>o.update(p=>{var g;if((g=p.selected[d.class])!=null&&g[d.id]){const{[d.id]:v,...w}=p.selected[d.class];p.selected[d.class]=w}else p.selected[d.class]={...p.selected[d.class]||{},[d.id]:r(d)};return c(p),p}),toggleSet:d=>{_n(o).id===d.id?f():h(d)},empty:()=>o.update(d=>(d.id=null,d.title=n,d.selected={},c(d,!0),d)),updateTitle:d=>o.update(p=>(p.title=d,c(p,!0),p)),updatePublic:d=>o.update(p=>(p.is_public=d,c(p,!0),p)),save:u,isSaved:a,selection:o,selectionTitle:Ye(o,d=>d.title),isSelected:Ye(o,d=>p=>{var g;return((g=d.selected[p.class])==null?void 0:g[p.id])||!1}),selected:Ye(o,d=>d.selected),nbSelected:Ye(o,d=>Object.entries(d.selected).reduce((p,[g,v])=>g==="User"?p:p+Object.keys(v).length,0)),isSetSelected:Ye(o,d=>p=>d.id===p.id)}}const jo=Sn({type:"documentSet",modelName:"document-set",title:N==="en"?"Document set":"Set de documents",extractMeta:i=>({title:i.title,url:i.url})}),gt=Sn({type:"regionsSet",modelName:"regions-set",title:N==="en"?"Regions set":"Set de régions",extractMeta:i=>i});function Vo(i){if(!i.startsWith("wit"))return i;const[e,...t]=i.split("_wit");return`wit${t}`}Sn({type:"clusterSet",modelName:"cluster-set",title:N==="en"?"Selected regions":"Régions sélectionnées",extractMeta:i=>({imgRef:i.id,clusterId:i.clusterId,title:i.title,xywh:i.xywh,img:Vo(i.id)})});function Fo(){const i=`${window.location.origin}${window.location.pathname}`,e=Ee(1),t=Ee({}),n=Ee({}),r=Ee("");wn(e,"p");function s(u){r.update(h=>{const f=h===u?"":u;return navigator.clipboard.writeText(f).then(d=>""),f})}const l=(async()=>{try{const u=await fetch(`${i}canvas`);if(!u.ok)return{};const h=await u.json();let f={};return Object.values(h).forEach(d=>{Object.entries(d).forEach(([p,g])=>{f[p]=g})}),t.set(f),h}catch{return{}}})(),o=Ye(e,u=>(async()=>{const f=await(await fetch(`${i}canvas?p=${u}`)).json();return n.set(f),f})());function a(u){yn(u,e,"p")}function c(u){t.update(h=>(delete h[u],{...h})),n.update(h=>{for(const f in h)if(h[f][u]){const{[u]:d,...p}=h[f];return h[f]=p,h}return h})}return{currentPage:e,pageRegions:n,allRegions:t,fetchPages:o,fetchAll:l,handlePageUpdate:a,remove:c,clipBoard:r,copyRef:s}}const bt=Fo();function zn(i){let e,t,n;return{c(){e=b("div"),e.innerHTML='<div class="loader svelte-vizlcg"></div>',m(e,"class","bkg-shade svelte-vizlcg")},m(r,s){C(r,e,s),n=!0},i(r){n||(rt(()=>{n&&(t||(t=vt(e,Vt,{duration:150},!0)),t.run(1))}),n=!0)},o(r){t||(t=vt(e,Vt,{duration:150},!1)),t.run(0),n=!1},d(r){r&&E(e),r&&t&&t.end()}}}function Uo(i){let e,t,n=i[0]&&zn();return{c(){n&&n.c(),e=_e()},m(r,s){n&&n.m(r,s),C(r,e,s),t=!0},p(r,[s]){r[0]?n?s&1&&O(n,1):(n=zn(),n.c(),O(n,1),n.m(e.parentNode,e)):n&&(pe(),L(n,1,1,()=>{n=null}),ge())},i(r){t||(O(n),t=!0)},o(r){L(n),t=!1},d(r){n&&n.d(r),r&&E(e)}}}function Ho(i,e,t){let n;return ue(i,Ot,r=>t(0,n=r)),[n]}class il extends ae{constructor(e){super(),oe(this,e,Ho,Uo,le,{})}}function Bo(){const i=new URLSearchParams(window.location.search).get("tab")??"all",{subscribe:e,set:t}=Ee(i);return{subscribe:e,change:n=>{t(n);const r=new URL(window.location);r.searchParams.set("tab",n),window.history.pushState({},"",r)},init:()=>{const n=new URLSearchParams(window.location.search).get("tab")??"all";t(n)}}}const St=Bo();const qo=i=>({}),Kn=i=>({});function Wn(i,e,t){const n=i.slice();return n[9]=e[t][0],n[10]=e[t][1],n}const zo=i=>({}),Gn=i=>({}),Ko=i=>({}),Yn=i=>({});function Wo(i){let e,t,n=Object.entries(i[2]),r=[];for(let s=0;s<n.length;s+=1)r[s]=xn(Wn(i,n,s));return{c(){e=b("div"),t=b("ul");for(let s=0;s<r.length;s+=1)r[s].c();m(e,"class","tabs")},m(s,l){C(s,e,l),_(e,t);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null)},p(s,l){if(l&12){n=Object.entries(s[2]);let o;for(o=0;o<n.length;o+=1){const a=Wn(s,n,o);r[o]?r[o].p(a,l):(r[o]=xn(a),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},i:j,o:j,d(s){s&&E(e),et(r,s)}}}function Go(i){let e;const t=i[7].tabs,n=He(t,i,i[6],Gn);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&64)&&qe(n,t,r,r[6],e?Be(t,r[6],s,zo):ze(r[6]),Gn)},i(r){e||(O(n,r),e=!0)},o(r){L(n,r),e=!1},d(r){n&&n.d(r)}}}function xn(i){let e,t,n=i[10]+"",r,s,l,o;function a(){return i[8](i[9])}return{c(){e=b("li"),t=b("a"),r=J(n),s=D(),m(t,"href",null),Ce(e,"is-active",i[3]===i[9])},m(c,u){C(c,e,u),_(e,t),_(t,r),_(e,s),l||(o=ie(t,"click",a),l=!0)},p(c,u){i=c,u&4&&n!==(n=i[10]+"")&&fe(r,n),u&12&&Ce(e,"is-active",i[3]===i[9])},d(c){c&&E(e),l=!1,o()}}}function Yo(i){let e,t,n,r,s,l,o,a,c,u,h,f,d;e=new il({});const p=i[7].sidebar,g=He(p,i,i[6],Yn),v=[Go,Wo],w=[];function S(I,R){return R&4&&(a=null),I[4].tabs?0:(a==null&&(a=!!Object.keys(I[2]).length),a?1:-1)}~(c=S(i,-1))&&(u=w[c]=v[c](i));const P=i[7].content,M=He(P,i,i[6],Kn);return{c(){G(e.$$.fragment),t=D(),n=b("div"),r=b("aside"),g&&g.c(),s=D(),l=b("main"),o=b("nav"),u&&u.c(),h=D(),f=b("div"),M&&M.c(),m(r,"class","sidebar svelte-jr84gp"),ve(r,"width",i[0]+"%"),ve(r,"min-height",i[1]),m(o,"id","tabs"),m(o,"class","tabs-bar"),m(f,"class","content-area pl-5 svelte-jr84gp"),m(l,"class","main-content svelte-jr84gp"),ve(l,"width",100-i[0]+"%"),ve(l,"min-height",i[1]),m(n,"class","layout svelte-jr84gp"),ve(n,"min-height",i[1])},m(I,R){K(e,I,R),C(I,t,R),C(I,n,R),_(n,r),g&&g.m(r,null),_(n,s),_(n,l),_(l,o),~c&&w[c].m(o,null),_(l,h),_(l,f),M&&M.m(f,null),d=!0},p(I,[R]){g&&g.p&&(!d||R&64)&&qe(g,p,I,I[6],d?Be(p,I[6],R,Ko):ze(I[6]),Yn),(!d||R&1)&&ve(r,"width",I[0]+"%");let T=c;c=S(I,R),c===T?~c&&w[c].p(I,R):(u&&(pe(),L(w[T],1,1,()=>{w[T]=null}),ge()),~c?(u=w[c],u?u.p(I,R):(u=w[c]=v[c](I),u.c()),O(u,1),u.m(o,null)):u=null),M&&M.p&&(!d||R&64)&&qe(M,P,I,I[6],d?Be(P,I[6],R,qo):ze(I[6]),Kn),(!d||R&1)&&ve(l,"width",100-I[0]+"%")},i(I){d||(O(e.$$.fragment,I),O(g,I),O(u),O(M,I),d=!0)},o(I){L(e.$$.fragment,I),L(g,I),L(u),L(M,I),d=!1},d(I){W(e,I),I&&E(t),I&&E(n),g&&g.d(I),~c&&w[c].d(),M&&M.d(I)}}}function xo(i=null){i||(i=document.getElementById("navbar")),document.documentElement.style.setProperty("--top-offset",`${i.offsetHeight}px`)}function Jo(i,e,t){let n;ue(i,St,f=>t(3,n=f));let{$$slots:r={},$$scope:s}=e;const l=so(r);let{sidebarWidth:o="25"}=e;const a="90vh";let{tabList:c={}}=e,{topOffsetElement:u=null}=e;xo(u),st(()=>(St.init(),window.addEventListener("popstate",()=>St.init()),()=>window.removeEventListener("popstate",()=>St.init())));const h=f=>St.change(f);return i.$$set=f=>{"sidebarWidth"in f&&t(0,o=f.sidebarWidth),"tabList"in f&&t(2,c=f.tabList),"topOffsetElement"in f&&t(5,u=f.topOffsetElement),"$$scope"in f&&t(6,s=f.$$scope)},[o,a,c,n,l,u,s,r,h]}class Xo extends ae{constructor(e){super(),oe(this,e,Jo,Yo,le,{sidebarWidth:0,layoutHeight:1,tabList:2,topOffsetElement:5})}get layoutHeight(){return this.$$.ctx[1]}}function Jn(i,e,t){const n=i.slice();return n[9]=e[t],n}function Qo(i){let e,t=i[1].regions,n=[];for(let r=0;r<t.length;r+=1)n[r]=Xn(Jn(i,t,r));return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=_e()},m(r,s){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(r,s);C(r,e,s)},p(r,s){if(s&6){t=r[1].regions;let l;for(l=0;l<t.length;l+=1){const o=Jn(r,t,l);n[l]?n[l].p(o,s):(n[l]=Xn(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(r){et(n,r),r&&E(e)}}}function Zo(i){let e,t=N==="en"?"Back to all witness view":"Retour à la vue complète du témoin",n,r,s,l=N==="en"?`Delete displayed ${i[0]}`:`Supprimer les ${i[0]} affichés`,o,a,c;return{c(){e=b("a"),n=J(t),r=D(),s=b("button"),o=J(l),m(e,"href",i[4]),m(e,"class","tag is-dark mr-3 mb-3 is-rounded"),m(s,"class","tag ml-3 mb-3 is-danger")},m(u,h){C(u,e,h),_(e,n),C(u,r,h),C(u,s,h),_(s,o),a||(c=ie(s,"click",i[5]),a=!0)},p(u,h){h&1&&l!==(l=N==="en"?`Delete displayed ${u[0]}`:`Supprimer les ${u[0]} affichés`)&&fe(o,l)},d(u){u&&E(e),u&&E(r),u&&E(s),a=!1,c()}}}function Xn(i){let e,t,n=i[9]+"",r;return{c(){e=b("a"),t=J("Regions extraction #"),r=J(n),m(e,"href",""+(i[2]+i[9])),m(e,"class","tag is-dark mr-3 mb-3 is-rounded")},m(s,l){C(s,e,l),_(e,t),_(e,r)},p:j,d(s){s&&E(e)}}}function ea(i){let e;function t(s,l){return s[3]?Zo:Qo}let r=t(i)(i);return{c(){e=b("div"),r.c()},m(s,l){C(s,e,l),r.m(e,null)},p(s,[l]){r.p(s,l)},i:j,o:j,d(s){s&&E(e),r.d()}}}function ta(i,e,t){let n,r;ue(i,St,f=>t(6,r=f));const s=Je("witness"),l=`${window.location.origin}${window.location.pathname}`,o=parseInt(l.split("regions/")[1].replace("/","")),a=l.replace(/\/\d+\/?$/,"");async function c(){if(!await Re(N==="en"?"Are you sure you want to delete all the region extraction of this witness?":"Voulez-vous vraiment supprimer les extractions de régions effectuées sur ce document ?",N==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof o!="number")throw new Error("Invalid region ID");const d=`${window.location.origin}/${Ve}/regions/${o}/delete`;try{const p=await Ut(()=>fetch(d,{method:"DELETE",headers:{"X-CSRFToken":Xe}}));if(p.status!==204)throw new Error(`Failed to delete regions: '${p.statusText}'`);window.location.href=`${l.split("regions/")[0]}regions/`}catch(p){console.error(p)}}async function u(){if(!await Re(N==="en"?"Are you sure you want to delete all similarity scores for this document?":"Voulez-vous vraiment supprimer l'intégralité des scores de similarité pour ce document ?",N==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof o!="number")throw new Error("Invalid region ID");const d=`${window.location.origin}/${Ve}/similarity/reset/${o}`;try{const p=await Ut(()=>fetch(d,{method:"DELETE",headers:{"X-CSRFToken":Xe}}));if(p.status===204||p.status===200)window.location.href=`${l.split("regions/")[0]}regions/`;else throw new Error(`Failed to delete similarity: '${p.statusText}'`)}catch(p){console.error(p),await Re(p.message,"Error")}}function h(){["all","page"].includes(r)?c():r==="similarity"&&u()}return i.$$.update=()=>{i.$$.dirty&64&&t(0,n=["all","page"].includes(r)?N==="en"?"regions":"régions":N==="en"?"similarities":"similarités")},[n,s,l,o,a,h,r]}class ia extends ae{constructor(e){super(),oe(this,e,ta,ea,le,{})}}function Qn(i,e,t){const n=i.slice();return n[7]=e[t],n[9]=t,n}function Zn(i,e,t){const n=i.slice();return n[10]=e[t][0],n[11]=e[t][1],n}function er(i,e,t){const n=i.slice();return n[10]=e[t][0],n[11]=e[t][1],n}function tr(i){let e,t;return{c(){e=b("a"),t=b("span"),m(t,"class","iconify"),m(t,"data-icon","entypo:edit"),m(e,"href",i[2]),m(e,"title","Edit"),m(e,"class","edit-btn button is-small is-rounded is-link px-3 ml-2 mt-1")},m(n,r){C(n,e,r),_(e,t)},p(n,r){r&4&&m(e,"href",n[2])},d(n){n&&E(e)}}}function ir(i){let e,t=i[11].label+"",n,r,s,l=i[11].value+"",o;return{c(){e=b("span"),n=J(t),r=D(),s=b("span"),o=J(l),m(e,"class","witness-key svelte-1g4d9r7"),m(s,"class","witness-value svelte-1g4d9r7")},m(a,c){C(a,e,c),_(e,n),C(a,r,c),C(a,s,c),_(s,o)},p(a,c){c&2&&t!==(t=a[11].label+"")&&fe(n,t),c&2&&l!==(l=a[11].value+"")&&fe(o,l)},d(a){a&&E(e),a&&E(r),a&&E(s)}}}function nr(i){let e,t,n,r=i[1].metadata_full.contents,s=[];for(let l=0;l<r.length;l+=1)s[l]=or(Qn(i,r,l));return{c(){e=b("h3"),e.textContent="Contents",t=D();for(let l=0;l<s.length;l+=1)s[l].c();n=_e(),m(e,"class","title is-5 mb-3")},m(l,o){C(l,e,o),C(l,t,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(l,o);C(l,n,o)},p(l,o){if(o&26){r=l[1].metadata_full.contents;let a;for(a=0;a<r.length;a+=1){const c=Qn(l,r,a);s[a]?s[a].p(c,o):(s[a]=or(c),s[a].c(),s[a].m(n.parentNode,n))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}},d(l){l&&E(e),l&&E(t),et(s,l),l&&E(n)}}}function rr(i){let e;return{c(){e=b("i"),m(e,"class","fa-solid fa-chevron-down")},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function sr(i){let e,t=Object.entries(i[7].content),n=[];for(let r=0;r<t.length;r+=1)n[r]=lr(Zn(i,t,r));return{c(){e=b("div");for(let r=0;r<n.length;r+=1)n[r].c();m(e,"class","mt-2 pl-3")},m(r,s){C(r,e,s);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(r,s){if(s&2){t=Object.entries(r[7].content);let l;for(l=0;l<t.length;l+=1){const o=Zn(r,t,l);n[l]?n[l].p(o,s):(n[l]=lr(o),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(r){r&&E(e),et(n,r)}}}function lr(i){let e,t,n=i[10]+"",r,s,l,o=i[11]+"",a,c;return{c(){e=b("div"),t=b("b"),r=J(n),s=J(":"),l=D(),a=J(o),c=D(),m(e,"class","witness-value svelte-1g4d9r7")},m(u,h){C(u,e,h),_(e,t),_(t,r),_(t,s),_(e,l),_(e,a),_(e,c)},p(u,h){h&2&&n!==(n=u[10]+"")&&fe(r,n),h&2&&o!==(o=u[11]+"")&&fe(a,o)},d(u){u&&E(e)}}}function or(i){let e,t,n=i[7].title+"",r,s,l=Object.entries(i[7].content).length,o,a=i[3].has(i[9]),c,u,h,f=l&&rr();function d(){return i[5](i[9])}let p=a&&sr(i);return{c(){e=b("div"),t=b("div"),r=J(n),s=D(),f&&f.c(),o=D(),p&&p.c(),c=D(),m(t,"class","is-flex is-justify-content-space-between witness-key svelte-1g4d9r7"),m(e,"class","mb-3")},m(g,v){C(g,e,v),_(e,t),_(t,r),_(t,s),f&&f.m(t,null),_(e,o),p&&p.m(e,null),_(e,c),u||(h=[ie(t,"click",d),ie(t,"keypress",null)],u=!0)},p(g,v){i=g,v&2&&n!==(n=i[7].title+"")&&fe(r,n),v&2&&(l=Object.entries(i[7].content).length),l?f||(f=rr(),f.c(),f.m(t,null)):f&&(f.d(1),f=null),v&8&&(a=i[3].has(i[9])),a?p?p.p(i,v):(p=sr(i),p.c(),p.m(e,c)):p&&(p.d(1),p=null)},d(g){g&&E(e),f&&f.d(),p&&p.d(),u=!1,Ie(h)}}}function na(i){var w;let e,t,n,r,s,l,o,a,c,u,h,f,d=i[1].can_edit&&tr(i);c=new ia({});let p=Object.entries(i[1].metadata_full.wit),g=[];for(let S=0;S<p.length;S+=1)g[S]=ir(er(i,p,S));let v=((w=i[1].metadata_full.contents)==null?void 0:w.length)&&nr(i);return{c(){e=b("div"),t=b("div"),n=b("div"),r=b("h1"),s=J(i[0]),l=D(),d&&d.c(),o=D(),a=b("div"),G(c.$$.fragment),u=D();for(let S=0;S<g.length;S+=1)g[S].c();h=D(),v&&v.c(),m(r,"class","title"),m(a,"class","cell is-left is-middle"),m(n,"class","pb-2"),m(t,"class","content is-small mt-4"),m(e,"class","m-4 py-5 px-4")},m(S,P){C(S,e,P),_(e,t),_(t,n),_(n,r),_(r,s),_(r,l),d&&d.m(r,null),_(n,o),_(n,a),K(c,a,null),_(n,u);for(let M=0;M<g.length;M+=1)g[M]&&g[M].m(n,null);_(n,h),v&&v.m(n,null),f=!0},p(S,[P]){var M;if((!f||P&1)&&fe(s,S[0]),S[1].can_edit?d?d.p(S,P):(d=tr(S),d.c(),d.m(r,null)):d&&(d.d(1),d=null),P&2){p=Object.entries(S[1].metadata_full.wit);let I;for(I=0;I<p.length;I+=1){const R=er(S,p,I);g[I]?g[I].p(R,P):(g[I]=ir(R),g[I].c(),g[I].m(n,h))}for(;I<g.length;I+=1)g[I].d(1);g.length=p.length}(M=S[1].metadata_full.contents)!=null&&M.length?v?v.p(S,P):(v=nr(S),v.c(),v.m(n,null)):v&&(v.d(1),v=null)},i(S){f||(O(c.$$.fragment,S),f=!0)},o(S){L(c.$$.fragment,S),f=!1},d(S){S&&E(e),d&&d.d(),W(c),et(g,S),v&&v.d()}}}function ra(i,e,t){let{viewTitle:n=""}=e,{witness:r={}}=e,{editUrl:s=""}=e,l={},o=new Set;st(async()=>{const u=`${window.location.origin}/${Ve}/witness/select`;try{l=await(await fetch(u)).json()}catch(h){return console.error("Error:",h),!1}});function a(u){o.has(u)?o.delete(u):o.add(u),t(3,o=new Set(o))}const c=u=>a(u);return i.$$set=u=>{"viewTitle"in u&&t(0,n=u.viewTitle),"witness"in u&&t(1,r=u.witness),"editUrl"in u&&t(2,s=u.editUrl)},[n,r,s,o,a,c]}class sa extends ae{constructor(e){super(),oe(this,e,ra,na,le,{viewTitle:0,witness:1,editUrl:2})}}function la(i){let e,t,n,r,s,l=N==="en"?"Selection":"Sélection",o,a,c,u,h,f;return{c(){e=b("div"),t=b("button"),n=b("span"),r=b("i"),s=D(),o=J(l),a=J(`
            (`),c=J(i[0]),u=J(")"),m(r,"class","fa-solid fa-book-bookmark"),m(n,"id","btn-content"),m(t,"id","set-btn"),m(t,"class","button px-5 py-4 is-link svelte-gmt9z5"),m(t,"data-target","selection-modal"),m(e,"class","set-container svelte-gmt9z5")},m(d,p){C(d,e,p),_(e,t),_(t,n),_(n,r),_(n,s),_(n,o),_(n,a),_(n,c),_(n,u),h||(f=Ti(tl.call(null,t)),h=!0)},p(d,[p]){p&1&&fe(c,d[0])},i:j,o:j,d(d){d&&E(e),h=!1,f()}}}function oa(i,e,t){let{selectionLength:n=0}=e,r=n;return i.$$set=s=>{"selectionLength"in s&&t(0,n=s.selectionLength)},i.$$.update=()=>{if(i.$$.dirty&3&&n!==r){const s=n>r;t(1,r=n);const l=document.getElementById("btn-content");l&&l.animate([{transform:s?"translateY(-7px)":"translateX(-5px)"},{transform:s?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[n,r]}class aa extends ae{constructor(e){super(),oe(this,e,oa,la,le,{selectionLength:0})}}const ca=i=>({}),ar=i=>({});function ua(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v,w,S,P,M,I;const R=i[1].content,T=He(R,i,i[0],ar);return{c(){e=b("button"),t=D(),n=b("div"),r=b("div"),s=D(),l=b("div"),o=b("div"),o.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,a=D(),c=b("section"),u=b("div"),h=D(),f=b("div"),T&&T.c(),d=D(),p=b("footer"),g=b("div"),v=b("button"),v.textContent=`${N==="en"?"Abort":"Retour"}`,w=D(),S=b("button"),S.textContent="OK",m(e,"id","hidden-msg-btn"),m(e,"data-target","msg-modal"),e.hidden=!0,m(r,"id","modal-bkg"),m(r,"class","modal-background"),m(o,"class","modal-card-head media mb-0"),m(u,"id","modal-msg"),m(f,"class","py-3"),m(c,"id","modal-body"),m(c,"class","modal-card-body"),m(v,"id","cancel-btn"),m(v,"class","button is-link is-light button-close"),m(S,"id","ok-btn"),m(S,"class","button is-link button-close"),m(g,"class","buttons"),m(p,"id","modal-footer"),m(p,"class","modal-card-foot is-center pt-3"),p.hidden=!0,m(l,"class","modal-content"),m(n,"id","msg-modal"),m(n,"class","modal fade"),m(n,"tabindex","-1"),m(n,"aria-labelledby","selection-modal-label"),m(n,"aria-hidden","true")},m(y,F){C(y,e,F),C(y,t,F),C(y,n,F),_(n,r),_(n,s),_(n,l),_(l,o),_(l,a),_(l,c),_(c,u),_(c,h),_(c,f),T&&T.m(f,null),_(l,d),_(l,p),_(p,g),_(g,v),_(g,w),_(g,S),P=!0,M||(I=[Ti(tl.call(null,e)),Ti(el.call(null,n))],M=!0)},p(y,[F]){T&&T.p&&(!P||F&1)&&qe(T,R,y,y[0],P?Be(R,y[0],F,ca):ze(y[0]),ar)},i(y){P||(O(T,y),P=!0)},o(y){L(T,y),P=!1},d(y){y&&E(e),y&&E(t),y&&E(n),T&&T.d(y),M=!1,Ie(I)}}}function fa(i,e,t){let{$$slots:n={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&t(0,r=s.$$scope)},[r,n]}class da extends ae{constructor(e){super(),oe(this,e,fa,ua,le,{})}}function ha(i){let e,t,n;return{c(){e=b("button"),e.textContent=`${N==="en"?"Automatic region extraction":"Extraction automatique des régions"}`,m(e,"class","button is-link is-light")},m(r,s){C(r,e,s),t||(n=ie(e,"click",i[1]),t=!0)},p:j,d(r){r&&E(e),t=!1,n()}}}function ma(i){let e,t,n,r=Ft.includes("regions"),s,l,o=r&&ha(i);return{c(){e=b("div"),t=b("button"),t.textContent=`${N==="en"?"Manually annotate":"Annoter manuellement"}`,n=D(),o&&o.c(),m(t,"class","button is-link"),m(e,"class","is-center buttons is-centered pt-5")},m(a,c){C(a,e,c),_(e,t),_(e,n),o&&o.m(e,null),s||(l=ie(t,"click",i[0]),s=!0)},p(a,[c]){r&&o.p(a,c)},i:j,o:j,d(a){a&&E(e),o&&o.d(),s=!1,l()}}}function pa(i,e,t){const n=Je("witness");let{currentRegionId:r}=e,{baseUrl:s}=e;async function l(){const a=`${window.location.origin}/${Ve}`;let c=`${a}/witness/${n.id}/regions/add`;if(n.regions.length===1||r){const f=r||n.regions[0];c=`${a}/witness/${n.id}/regions/${f}/add`}const u=await Ut(()=>fetch(c,{method:"POST",headers:{"X-CSRFToken":Xe}}));if(!u.ok)throw await Re(`Failed to create regions: '${u.statusText}'`,"Error"),new Error(`Failed to create regions: '${u.statusText}'`);let h;try{h=await u.json()}catch(f){throw await Re(`Failed to parse JSON response: '${f}'`,"Error"),new Error(`Failed to parse JSON response: '${f}'`)}h.hasOwnProperty("mirador_url")&&window.open(h.mirador_url),h.hasOwnProperty("regions_id")&&(window.location.href=`${s.split("regions/")[0]}regions/${h.regions_id}`)}async function o(){const a=`${window.location.origin}/${Ve}/witness/${n.id}/regions/extract`,c=await Ut(()=>fetch(a,{method:"POST",headers:{"X-CSRFToken":Xe}}));let u;if(c.ok)try{u=await c.json(),console.log(u)}catch(h){throw await Re(`Failed to parse JSON response: '${h}'`,"Error"),new Error(`Failed to parse JSON response: '${h}'`)}finally{const h=u.doc_set_id;if(!h)throw await Re("Failed to launch regions extraction: 'No document set id'","Error"),new Error("Failed to launch regions extraction: 'No document set id'");window.location.href=`${window.location.origin}/${Ve}/treatment/add/?document_set=${h}&task_type=regions`}else throw await Re(`Failed to launch regions extraction: '${u.message}'`,"Error"),new Error(`Failed to launch regions extraction: '${u.message}'`)}return i.$$set=a=>{"currentRegionId"in a&&t(2,r=a.currentRegionId),"baseUrl"in a&&t(3,s=a.baseUrl)},[l,o,r,s]}class nl extends ae{constructor(e){super(),oe(this,e,pa,ma,le,{currentRegionId:2,baseUrl:3})}}function ga(i){let e;return{c(){e=Ue("path"),m(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),m(e,"class","svelte-h0t5l9")},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function _a(i){let e;return{c(){e=Ue("path"),m(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),m(e,"class","svelte-h0t5l9")},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function va(i){let e=N==="en"?"Edit":"Modifier",t;return{c(){t=J(e)},m(n,r){C(n,t,r)},p:j,d(n){n&&E(t)}}}function ba(i){let e=N==="en"?"Validate":"Valider",t;return{c(){t=J(e)},m(n,r){C(n,t,r)},p:j,d(n){n&&E(t)}}}function cr(i){let e,t,n,r=N==="en"?"Reload":"Recharger",s,l,o,a,c,u=N==="en"?"Go to editor":"Aller à l'éditeur",h,f,d,p,g,v=N==="en"?"Delete selected regions":"Supprimer les régions sélectionnées",w,S,P;return{c(){e=b("button"),t=b("i"),n=D(),s=J(r),l=D(),o=b("a"),a=b("i"),c=D(),h=J(u),f=D(),d=b("button"),p=b("i"),g=D(),w=J(v),m(t,"class","fa-solid fa-rotate-right"),m(e,"class","tag is-link is-light is-rounded mr-3"),m(a,"class","fa-solid fa-edit"),m(o,"class","tag is-link is-rounded mr-3"),m(o,"href",Ht(i[4])),m(o,"target","_blank"),m(p,"class","fa-solid fa-trash"),m(d,"class","tag is-danger is-rounded")},m(M,I){C(M,e,I),_(e,t),_(e,n),_(e,s),C(M,l,I),C(M,o,I),_(o,a),_(o,c),_(o,h),C(M,f,I),C(M,d,I),_(d,p),_(d,g),_(d,w),S||(P=[ie(e,"click",i[14]),ie(d,"click",i[6])],S=!0)},p:j,d(M){M&&E(e),M&&E(l),M&&E(o),M&&E(f),M&&E(d),S=!1,Ie(P)}}}function wa(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g=N==="en"?"Download":"Télécharger",v,w,S,P,M;function I(U,x){return U[0]?_a:ga}let R=I(i),T=R(i);function y(U,x){return U[0]?ba:va}let F=y(i),Y=F(i),se=i[0]&&cr(i);return{c(){e=b("div"),t=b("button"),n=Ue("svg"),T.c(),r=D(),Y.c(),l=D(),o=b("button"),a=b("i"),c=D(),u=b("span"),u.textContent=`${N==="en"?"Select all":"Tout sélectionner"}`,h=D(),f=b("button"),d=b("i"),p=D(),v=J(g),w=D(),S=b("div"),se&&se.c(),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"viewBox","0 0 384 512"),m(n,"class","pr-3 svelte-h0t5l9"),m(t,"class",s="button "+(i[0]?"is-success":"is-link")+" mr-3"),m(a,"class","fa-solid fa-square-check"),m(u,"id","all-selection"),m(o,"class","button is-link is-light mr-3"),m(d,"class","fa-solid fa-download"),m(f,"class","button is-link is-light"),m(e,"class","is-right mb-3"),m(S,"class","edit-action is-right svelte-h0t5l9")},m(U,x){C(U,e,x),_(e,t),_(t,n),T.m(n,null),_(t,r),Y.m(t,null),_(e,l),_(e,o),_(o,a),_(o,c),_(o,u),_(e,h),_(e,f),_(f,d),_(f,p),_(f,v),C(U,w,x),C(U,S,x),se&&se.m(S,null),P||(M=[ie(t,"click",i[13]),ie(o,"click",i[7]),ie(f,"click",i[8])],P=!0)},p(U,[x]){R!==(R=I(U))&&(T.d(1),T=R(U),T&&(T.c(),T.m(n,null))),F===(F=y(U))&&Y?Y.p(U,x):(Y.d(1),Y=F(U),Y&&(Y.c(),Y.m(t,null))),x&1&&s!==(s="button "+(U[0]?"is-success":"is-link")+" mr-3")&&m(t,"class",s),U[0]?se?se.p(U,x):(se=cr(U),se.c(),se.m(S,null)):se&&(se.d(1),se=null)},i:j,o:j,d(U){U&&E(e),T.d(),Y.d(),U&&E(w),U&&E(S),se&&se.d(),P=!1,Ie(M)}}}async function ya(i){const e=i.id_full,t=`${SAS_APP_URL}/annotation/destroy?uri=${e}`,n=await fetch(t,{method:"DELETE"});if(n.status!==204)throw new Error(`Failed to delete ${t} due to ${n.status}: '${n.statusText}'`)}function ka(i,e,t){let n,r,s,l,o,a,c;const{selected:u,nbSelected:h}=gt;ue(i,u,I=>t(11,a=I)),ue(i,h,I=>t(12,c=I));const{allRegions:f}=bt;ue(i,f,I=>t(10,o=I));const d=Je("manifest"),p=Je("isValidated");function g(){t(0,r=!r)}async function v(){if(await Re(N==="en"?"Are you sure you want to delete these regions?":"Voulez-vous vraiment supprimer ces régions ?",N==="en"?"Confirm deletion":"Confirmer la suppression",!0))for(const[R,T]of Object.entries(s))try{if(!o.hasOwnProperty(R))continue;await ya(T),bt.remove(R),gt.remove(R,ci)}catch(y){await Re(`Failed to delete region ${R}: ${y.message}`,"Error")}}function w(){l?gt.removeAll(Object.keys(o),ci):gt.addAll(Object.values(o))}async function S(){const I=Object.values(s).map(y=>y.ref),T=await(await Ut(()=>fetch(`${window.location.origin}/${Ve}/regions/export`,{method:"POST",headers:{"X-CSRFToken":Xe},body:JSON.stringify({regionsRef:I})}))).blob();Qs(T,"regions.zip")}const P=()=>g(),M=()=>location.reload();return i.$$.update=()=>{i.$$.dirty&4096&&t(9,n=c),i.$$.dirty&2048&&(s=Object.values(a)[0]||{}),i.$$.dirty&1536&&(l=n>=Object.keys(o).length)},t(0,r=!p),[r,u,h,f,d,g,v,w,S,n,o,a,c,P,M]}class Sa extends ae{constructor(e){super(),oe(this,e,ka,wa,le,{})}}function Ea(){const i=`${window.location.origin}${window.location.pathname}`,e=25,t=window.location.pathname.match(/\d+/g).join("-"),n={[t]:{}},r=[2,6],s=Ee(1),l=Ee({}),o=Ee(JSON.parse(localStorage.getItem("selectedRegions"))||n);o.subscribe(U=>localStorage.setItem("selectedRegions",JSON.stringify(U)));const a=Ee(JSON.parse(localStorage.getItem("excludedCategories"))||[]);a.subscribe(U=>localStorage.setItem("excludedCategories",JSON.stringify(U)));const c=Ee(JSON.parse(localStorage.getItem("similarityScoreCutoff"))||void 0);c.subscribe(U=>{U!=null&&localStorage.setItem("similarityScoreCutoff",JSON.stringify(U))});const u=Ee(JSON.parse(localStorage.getItem("propagateRecursionDepth"))||r[1]);u.subscribe(U=>localStorage.setItem("propagateRecursionDepth",JSON.stringify(U)));const h=Ee(JSON.parse(localStorage.getItem("propagateFilterByRegions"))||!1);h.subscribe(U=>localStorage.setItem("propagateFilterByRegions",JSON.stringify(U)));const f=Ye([u,h],([U,x])=>({propagateRecursionDepth:U,propagateFilterByRegions:x})),d=Ye([a,o,c],([U,x,Z])=>({excludedCategories:U,regions:x,similarityScoreCutoff:Z})),p=Ye([f,d],([U,x])=>({propagate:U,similarity:x})),g=Ee([]),v=Ee([]);async function w(){const U=async()=>{const V=await(await fetch(`${i}compared-regions`)).json();l.set(V),o.update(H=>{let re=H[t]||{};if(Object.keys(re).length){let z=Object.keys(re).filter(B=>Object.keys(V).includes(B)).reduce((B,te)=>(B[te]=re[te],B),{});H[t]=z}return H})},x=async()=>{const V=await(await fetch(`${i}query-images`)).json();V.length>0&&(g.set(V),Y(T()))};Ot.set(!0);try{await Promise.all([U(),x()])}catch(Z){console.error("Error:",Z),Ys.set(Z.message)}finally{Ot.set(!1)}}function S(U){localStorage.setItem("selectedRegions",JSON.stringify(U))}function P(U){o.update(x=>{const Z={...x};return delete Z[t][U],S(Z),Z})}function M(U){o.update(x=>{const Z={...x,[t]:{...x[t]||{},[U.ref]:U}};return S(Z),Z})}const I=Ye(o,U=>x=>{var Z;return(Z=U[t])==null?void 0:Z.hasOwnProperty(x)});function R(U){const x=_n(l),Z=Object.keys(x).filter(V=>V.startsWith(U));return Z.length!==1?{title:"Error"}:x[Z[0]]}const T=()=>wn(s,"sp"),y=Ye([s,g],([U,x])=>(async()=>F(U,x))());function F(U,x){const Z=(U-1)*e,V=Z+e,H=x.slice(Z,V);return v.set(H),H}function Y(U){yn(U,s,"sp")}function se(U){l.update(x=>({...x,[U.ref]:U}))}return{currentPage:s,comparedRegions:l,excludedCategories:a,qImgs:g,pageQImgs:v,selectedRegions:o,propagateRecursionDepth:u,propagateFilterByRegions:h,similarityToolbarParams:p,propagateParams:f,similarityScoreCutoff:c,allowedPropagateDepthRange:r,fetchSimilarity:w,setPageQImgs:y,getRegionsInfo:R,handlePageUpdate:Y,unselect:P,select:M,addComparedRegions:se,isSelected:I,pageLength:e}}const xe=Ea();function Ca(i){let e,t,n;const r=i[1].default,s=He(r,i,i[0],null);return{c(){e=b("table"),t=b("tbody"),s&&s.c(),m(e,"class","table is-fullwidth")},m(l,o){C(l,e,o),_(e,t),s&&s.m(t,null),n=!0},p(l,[o]){s&&s.p&&(!n||o&1)&&qe(s,r,l,l[0],n?Be(r,l[0],o,null):ze(l[0]),null)},i(l){n||(O(s,l),n=!0)},o(l){L(s,l),n=!1},d(l){l&&E(e),s&&s.d(l)}}}function Ia(i,e,t){let{$$slots:n={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&t(0,r=s.$$scope)},[r,n]}class Ui extends ae{constructor(e){super(),oe(this,e,Ia,Ca,le,{})}}function ur(i){let e,t,n,r,s,l,o,a,c,u=i[5]>1&&fr(i),h=i[5]<i[3]&&mr(i);return{c(){e=b("nav"),t=b("ul"),u&&u.c(),n=D(),r=b("li"),s=b("a"),l=J(i[5]),o=D(),h&&h.c(),m(s,"class","pagination-link is-current"),m(s,"href",null),m(t,"class","pagination-list ml-0"),m(e,"class","pagination is-centered mb-2"),m(e,"aria-label","pagination")},m(f,d){C(f,e,d),_(e,t),u&&u.m(t,null),_(t,n),_(t,r),_(r,s),_(s,l),_(t,o),h&&h.m(t,null),a||(c=ie(s,"click",wt(i[9])),a=!0)},p(f,d){f[5]>1?u?u.p(f,d):(u=fr(f),u.c(),u.m(t,n)):u&&(u.d(1),u=null),d&32&&fe(l,f[5]),f[5]<f[3]?h?h.p(f,d):(h=mr(f),h.c(),h.m(t,null)):h&&(h.d(1),h=null)},d(f){f&&E(e),u&&u.d(),h&&h.d(),a=!1,c()}}}function fr(i){let e,t,n,r,s,l,o=i[5]-1>1&&dr(i);return{c(){e=b("li"),t=b("a"),t.textContent="1",n=D(),o&&o.c(),r=_e(),m(t,"class","pagination-link"),m(t,"href",null)},m(a,c){C(a,e,c),_(e,t),C(a,n,c),o&&o.m(a,c),C(a,r,c),s||(l=ie(t,"click",wt(i[7])),s=!0)},p(a,c){a[5]-1>1?o?o.p(a,c):(o=dr(a),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},d(a){a&&E(e),a&&E(n),o&&o.d(a),a&&E(r),s=!1,l()}}}function dr(i){let e,t,n,r=i[5]-1+"",s,l,o,a=i[5]-1>2&&hr();return{c(){a&&a.c(),e=D(),t=b("li"),n=b("a"),s=J(r),m(n,"class","pagination-link"),m(n,"href",null)},m(c,u){a&&a.m(c,u),C(c,e,u),C(c,t,u),_(t,n),_(n,s),l||(o=ie(n,"click",wt(i[8])),l=!0)},p(c,u){c[5]-1>2?a||(a=hr(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),u&32&&r!==(r=c[5]-1+"")&&fe(s,r)},d(c){a&&a.d(c),c&&E(e),c&&E(t),l=!1,o()}}}function hr(i){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function mr(i){let e,t,n,r,s,l,o=i[5]+1<i[3]&&pr(i);return{c(){o&&o.c(),e=D(),t=b("li"),n=b("a"),r=J(i[3]),m(n,"class","pagination-link"),m(n,"href",null)},m(a,c){o&&o.m(a,c),C(a,e,c),C(a,t,c),_(t,n),_(n,r),s||(l=ie(n,"click",wt(i[11])),s=!0)},p(a,c){a[5]+1<a[3]?o?o.p(a,c):(o=pr(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),c&8&&fe(r,a[3])},d(a){o&&o.d(a),a&&E(e),a&&E(t),s=!1,l()}}}function pr(i){let e,t,n=i[5]+1+"",r,s,l,o,a,c=i[5]+2<i[3]&&gr();return{c(){e=b("li"),t=b("a"),r=J(n),s=D(),c&&c.c(),l=_e(),m(t,"class","pagination-link"),m(t,"href",null)},m(u,h){C(u,e,h),_(e,t),_(t,r),C(u,s,h),c&&c.m(u,h),C(u,l,h),o||(a=ie(t,"click",wt(i[10])),o=!0)},p(u,h){h&32&&n!==(n=u[5]+1+"")&&fe(r,n),u[5]+2<u[3]?c||(c=gr(),c.c(),c.m(l.parentNode,l)):c&&(c.d(1),c=null)},d(u){u&&E(e),u&&E(s),c&&c.d(u),u&&E(l),o=!1,a()}}}function gr(i){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function Oa(i){let e,t,n=i[5]*i[2]-i[2]+1+"",r,s,l=Math.min(i[5]*i[2],i[1])+"",o,a,c,u,h=i[4]&&ur(i);return{c(){h&&h.c(),e=D(),t=b("div"),r=J(n),s=J(" - "),o=J(l),a=J(" / "),c=J(i[1]),m(t,"class",u="is-size-7 is-center mb-4 "+(i[4]?"":"mt-4"))},m(f,d){h&&h.m(f,d),C(f,e,d),C(f,t,d),_(t,r),_(t,s),_(t,o),_(t,a),_(t,c)},p(f,[d]){f[4]?h?h.p(f,d):(h=ur(f),h.c(),h.m(e.parentNode,e)):h&&(h.d(1),h=null),d&36&&n!==(n=f[5]*f[2]-f[2]+1+"")&&fe(r,n),d&38&&l!==(l=Math.min(f[5]*f[2],f[1])+"")&&fe(o,l),d&2&&fe(c,f[1]),d&16&&u!==(u="is-size-7 is-center mb-4 "+(f[4]?"":"mt-4"))&&m(t,"class",u)},i:j,o:j,d(f){h&&h.d(f),f&&E(e),f&&E(t)}}}function Aa(i,e,t){let n,r,s,{store:l}=e;const{currentPage:o}=l;ue(i,o,g=>t(5,s=g));let{nbOfItems:a}=e,{pageLength:c=Lo}=e;const u=()=>l.handlePageUpdate(1),h=()=>l.handlePageUpdate(s-1),f=()=>l.handlePageUpdate(s),d=()=>l.handlePageUpdate(s+1),p=()=>l.handlePageUpdate(n);return i.$$set=g=>{"store"in g&&t(0,l=g.store),"nbOfItems"in g&&t(1,a=g.nbOfItems),"pageLength"in g&&t(2,c=g.pageLength)},i.$$.update=()=>{i.$$.dirty&6&&t(3,n=c>0?Math.ceil(a/c):1),i.$$.dirty&14&&t(4,r=n>1||a>c)},[l,a,c,n,r,s,o,u,h,f,d,p]}class Bt extends ae{constructor(e){super(),oe(this,e,Aa,Oa,le,{store:0,nbOfItems:1,pageLength:2})}}const En=(i,e,t,n)=>({id:i,img:i,title:`Canvas ${n} - ${t} - ${N==="en"?"Witness":"Témoin"} #${xs(e)}`,xywh:t.split(",").map(Number),canvas:n,ref:i.replace(".jpg",""),type:ci}),Ta=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,rl=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">
        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>
    </svg>`,sl=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">
        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,ll=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">
        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,ol=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,al=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>
    </svg>`,Ma=N==="en"?"no categorization":"aucune catégorisation",cl=N==="en"?"overall visual matches":"correspondances visuelles globales",ul=N==="en"?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",fl=N==="en"?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",dl=N==="en"?"regions without match":"régions sans correspondance",hl=N==="en"?"user specific category":"correspondances spécifiques à l'utilisateur",Si={0:{title:Ma,svg:Ta},1:{title:cl,svg:rl},2:{title:ul,svg:sl},3:{title:fl,svg:ll},4:{title:dl,svg:ol},5:{title:hl,svg:al}};function Pa(i){let e,t=Si[i[2]].svg+"",n,r,s,l;return{c(){e=b("span"),m(e,"class",n="tag py-4 "+i[4]+" "+(i[0]?"is-hoverable":"")),m(e,"title",r=Si[i[2]].title),Ce(e,"is-selected",i[1])},m(o,a){C(o,e,a),e.innerHTML=t,s||(l=[ie(e,"click",i[5]),ie(e,"keyup",null)],s=!0)},p(o,[a]){a&4&&t!==(t=Si[o[2]].svg+"")&&(e.innerHTML=t),a&17&&n!==(n="tag py-4 "+o[4]+" "+(o[0]?"is-hoverable":""))&&m(e,"class",n),a&4&&r!==(r=Si[o[2]].title)&&m(e,"title",r),a&19&&Ce(e,"is-selected",o[1])},i:j,o:j,d(o){o&&E(e),s=!1,Ie(l)}}}function La(i,e,t){let{selectable:n=!0}=e,{isSelected:r=!1}=e,{category:s}=e,{toggle:l=()=>{}}=e,{padding:o="px-2"}=e;const a=()=>l(s);return i.$$set=c=>{"selectable"in c&&t(0,n=c.selectable),"isSelected"in c&&t(1,r=c.isSelected),"category"in c&&t(2,s=c.category),"toggle"in c&&t(3,l=c.toggle),"padding"in c&&t(4,o=c.padding)},[n,r,s,l,o,a]}class ii extends ae{constructor(e){super(),oe(this,e,La,Pa,le,{selectable:0,isSelected:1,category:2,toggle:3,padding:4})}}const Ra=/^(?:(\d+)_)?wit(\d+)_([a-z]{3})(\d+)(?:_anno(\d+))?_(\d+)(?:_([\d,]+))?(?:\.jpg)?$/;function $a(i){if(!i)return null;const e=i.match(Ra);if(!e)return null;const[,t,n,r,s,l,o,a]=e;return{witnessId:parseInt(n,10),digitizationType:r,digitizationId:parseInt(s,10),regionId:t?parseInt(t,10):l?parseInt(l,10):null,canvasNb:parseInt(o,10),canvasDigits:o.length,coord:a?a.split(",").map(Number):null,imgRoot:`wit${n}_${r}${s}_${o}.jpg`}}class $i{constructor(e){this.id=e.id,this.img=e.img??e.ref,this.title=e.title,this.xywh=Array.isArray(e.xywh)?e.xywh.map(Number):e.xywh,this.canvas=e.canvas,this.ref=e.ref,this.type=e.type??ci,this._parsed=null}get parsed(){return this._parsed||(this._parsed=$a(this.img)||{}),this._parsed}get witnessId(){return this.parsed.witnessId}get digitType(){return this.parsed.digitizationType}get digitId(){return this.parsed.digitizationId}get regionId(){return this.parsed.regionId}get canvasNb(){return this.parsed.canvasNb}get canvasDigits(){return this.parsed.canvasDigits}get imgRoot(){return this.parsed.imgRoot}get coord(){return this.parsed.coord??this.xywh}canvasStr(e=this.canvasNb,t=this.canvasDigits){return String(e).padStart(t,"0")}get iiifRoot(){return this.imgRoot?`${si()}/iiif/2/${this.imgRoot}`:null}url(e=null,t="full"){if(!this.iiifRoot)return"https://placehold.co/96x96/png?text=No+image";let n=e??this.coord??"full";return Array.isArray(n)&&(n=n.join(",")),`${this.iiifRoot}/${n}/${t}/0/default.jpg`}info(){return this.iiifRoot?`${this.iiifRoot}/info.json`:null}manifest(){let e=`wit${this.witnessId}_${this.digitType}${this.digitId}`;return this.regionId&&(e+=`_anno${this.regionId}`),`${si()}/iiif/v2/${e}/manifest.json`}urlForCanvas(e=this.canvasNb,t=this.coord,n="full"){const r=this.imgRoot.replace(`_${this.canvasStr()}.jpg`,`_${this.canvasStr(e)}.jpg`),s=Array.isArray(t)?t.join(","):t;return`${si()}/iiif/2/${r}/${s}/${n}/0/default.jpg`}infoUrlForCanvas(e=this.canvasNb){const t=this.imgRoot.replace(`_${this.canvasStr()}.jpg`,`_${this.canvasStr(e)}.jpg`);return`${si()}/iiif/2/${t}/info.json`}urlForMirador(e=this.canvasNb){return`${Xs()}/index.html?iiif-content=${this.manifest()}&canvas=${e}`}}function Da(i){let e,t,n;return{c(){e=b("span"),t=J(i[0]),m(e,"id",i[3]),m(e,"class",n="tooltip "+i[2]+" "+(i[1]?"display":"")+" svelte-1vbe6c4")},m(r,s){C(r,e,s),_(e,t)},p(r,[s]){s&1&&fe(t,r[0]),s&6&&n!==(n="tooltip "+r[2]+" "+(r[1]?"display":"")+" svelte-1vbe6c4")&&m(e,"class",n)},i:j,o:j,d(r){r&&E(e)}}}function Na(i,e,t){let n,r,s,l,{tooltipText:o}=e,{targetHtmlId:a}=e;const c=`tooltip-generic-${window.crypto.randomUUID()}`,u=()=>t(1,l=!0),h=()=>t(1,l=!1),f=()=>t(1,l=!l);return st(()=>{s=a?document.getElementById(a):document.getElementById(c).parentElement,a&&!s&&(console.error(`TooltipGeneric: element with ID ${a} not found, defaulting to the parent element`),s=document.getElementById(c).targetElement),s.addEventListener("mouseover",u),s.addEventListener("mouseout",h),s.addEventListener("click",f)}),di(()=>{s.removeEventListener("mouseover",u),s.removeEventListener("mouseout",h),s.removeEventListener("click",f)}),i.$$set=d=>{"tooltipText"in d&&t(0,o=d.tooltipText),"targetHtmlId"in d&&t(4,a=d.targetHtmlId)},i.$$.update=()=>{i.$$.dirty&33&&t(2,n=r(o))},t(5,r=d=>t(2,n=d.length>100?"tooltip-wide":d.length>20?"tooltip-mid":"tooltip-thin")),s=void 0,t(1,l=!1),[o,l,n,c,a,r]}class mi extends ae{constructor(e){super(),oe(this,e,Na,Da,le,{tooltipText:0,targetHtmlId:4})}}function ja(i){let e,t,n,r,s,l,o,a,c,u,h;return a=new mi({props:{targetHtmlId:i[1],tooltipText:i[2]}}),{c(){e=b("div"),t=b("button"),n=Ue("svg"),r=Ue("path"),s=Ue("path"),l=Ue("path"),o=D(),G(a.$$.fragment),m(r,"d","M53.6443 14.25C47.7042 5.33 37.7293 0 26.9801 0C16.2206 0 6.24576 5.33 0.305653 14.25L0 14.71L0.305653 15.17C6.24576 24.09 16.2206 29.42 26.9801 29.42C37.7293 29.42 47.7042 24.09 53.6443 15.16L53.95 14.71L53.6443 14.25ZM3.25025 14.71C7.63146 8.69001 14.0606 4.65 21.2641 3.22C20.0619 3.83 18.9411 4.62 17.963 5.59C15.5176 8.02 14.1625 11.25 14.1625 14.67C14.1625 18.11 15.5176 21.34 17.963 23.76C19.0124 24.79 20.1943 25.61 21.4781 26.23C14.1829 24.85 7.6824 20.78 3.25025 14.71ZM27.1125 22.64C22.7008 22.64 19.1041 19.08 19.1041 14.7C19.1041 12.59 19.9396 10.6 21.4475 9.10001C22.9555 7.60001 24.9729 6.77 27.1125 6.77C29.2522 6.77 31.2594 7.60001 32.7775 9.10001C34.2855 10.6 35.121 12.59 35.121 14.7C35.121 16.82 34.2855 18.82 32.7775 20.32C31.2594 21.81 29.242 22.64 27.1125 22.64ZM32.9915 26.14C34.204 25.53 35.3146 24.74 36.3029 23.77C38.7482 21.34 40.0932 18.11 40.0932 14.68C40.0932 9.75 37.281 5.47001 33.1647 3.32001C40.1747 4.81001 46.4102 8.83001 50.6896 14.71C46.3797 20.64 40.0728 24.67 32.9915 26.14Z"),m(r,"class","svelte-109pj58"),m(s,"d","M26.9804 25.98C33.3222 25.98 38.4633 20.9343 38.4633 14.71C38.4633 8.48576 33.3222 3.44 26.9804 3.44C20.6386 3.44 15.4976 8.48576 15.4976 14.71C15.4976 20.9343 20.6386 25.98 26.9804 25.98Z"),m(s,"class","svelte-109pj58"),m(l,"d","M17.9529 23.85L36.2928 5.85001"),m(l,"stroke-width","3"),m(l,"stroke-miterlimit","10"),m(l,"class","svelte-109pj58"),m(n,"width","54"),m(n,"height","30"),m(n,"viewBox","0 0 54 30"),m(n,"fill","none"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"class","svelte-109pj58"),m(t,"class","button tag svelte-109pj58"),m(t,"title",i[2]),m(e,"id",i[1])},m(f,d){C(f,e,d),_(e,t),_(t,n),_(n,r),_(n,s),_(n,l),_(t,o),K(a,t,null),c=!0,u||(h=ie(t,"click",Ws(i[3])),u=!0)},p:j,i(f){c||(O(a.$$.fragment,f),c=!0)},o(f){L(a.$$.fragment,f),c=!1},d(f){f&&E(e),W(a),u=!1,h()}}}function Va(i){const e=Kt(),t=`modal-opener-${window.crypto.randomUUID()}`;return[e,t,N==="fr"?"Vue détaillée":"Detailed view",()=>e("open")]}class ml extends ae{constructor(e){super(),oe(this,e,Va,ja,le,{})}}const Fa=i=>({}),_r=i=>({});function vr(i){let e,t,n,r,s,l;function o(d,p){return d[10]?Ha:Ua}let a=o(i),c=a(i);function u(d,p){return d[10]?qa:Ba}let h=u(i),f=h(i);return{c(){e=b("button"),t=Ue("svg"),c.c(),n=D(),r=b("span"),f.c(),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 384 512"),m(t,"class","svelte-g5axbe"),m(r,"class","tooltip"),m(e,"class","button tag")},m(d,p){C(d,e,p),_(e,t),c.m(t,null),_(e,n),_(e,r),f.m(r,null),s||(l=ie(e,"click",Ws(i[21])),s=!0)},p(d,p){a!==(a=o(d))&&(c.d(1),c=a(d),c&&(c.c(),c.m(t,null))),h===(h=u(d))&&f?f.p(d,p):(f.d(1),f=h(d),f&&(f.c(),f.m(r,null)))},d(d){d&&E(e),c.d(),f.d(),s=!1,l()}}}function Ua(i){let e;return{c(){e=Ue("path"),m(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),m(e,"class","svelte-g5axbe")},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function Ha(i){let e;return{c(){e=Ue("path"),m(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),m(e,"class","svelte-g5axbe")},m(t,n){C(t,e,n)},d(t){t&&E(e)}}}function Ba(i){let e=N==="en"?"Copy ID":"Copier l'ID",t;return{c(){t=J(e)},m(n,r){C(n,t,r)},p:j,d(n){n&&E(t)}}}function qa(i){let e=N==="en"?"Copied!":"Copié !",t;return{c(){t=J(e)},m(n,r){C(n,t,r)},p:j,d(n){n&&E(t)}}}function br(i){let e,t;return e=new ml({}),e.$on("open",i[14]),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function za(i){let e,t,n,r,s,l,o,a=i[8].title+"",c,u,h,f,d,p,g,v,w,S,P,M=i[4]&&vr(i),I=!i[5]&&br(i);const R=i[19].actions,T=He(R,i,i[18],_r);return{c(){e=b("div"),t=b("figure"),n=b("img"),s=D(),l=b("div"),o=b("span"),h=D(),f=b("div"),M&&M.c(),d=D(),I&&I.c(),p=D(),T&&T.c(),m(n,"class","region-img svelte-g5axbe"),$e(n.src,r=i[9])||m(n,"src",r),m(n,"alt","Extracted region"),m(o,"class","overlay-desc"),m(l,"class","overlay is-center svelte-g5axbe"),m(t,"class",c="image card region-image "+(i[0]?"is-96x96":"")+" svelte-g5axbe"),m(t,"tabindex","-1"),m(t,"style",u=(i[7]==="full"?"height: 100%":`height: ${i[7]}px; min-width: ${i[7]}px`)+"; "+(i[3]?`border: 5px solid ${i[3]};`:"")),m(f,"class","region-btn ml-1"),m(e,"class",g="region is-center "+(i[6]&&i[11](i[2])?"checked":"")+" svelte-g5axbe"),m(e,"style",v=i[7]==="full"?"height: 100%":"")},m(y,F){C(y,e,F),_(e,t),_(t,n),_(t,s),_(t,l),_(l,o),o.innerHTML=a,_(e,h),_(e,f),M&&M.m(f,null),_(f,d),I&&I.m(f,null),_(f,p),T&&T.m(f,null),w=!0,S||(P=[ie(t,"click",i[20]),ie(t,"keyup",null)],S=!0)},p(y,[F]){(!w||F&512&&!$e(n.src,r=y[9]))&&m(n,"src",r),(!w||F&256)&&a!==(a=y[8].title+"")&&(o.innerHTML=a),(!w||F&1&&c!==(c="image card region-image "+(y[0]?"is-96x96":"")+" svelte-g5axbe"))&&m(t,"class",c),(!w||F&136&&u!==(u=(y[7]==="full"?"height: 100%":`height: ${y[7]}px; min-width: ${y[7]}px`)+"; "+(y[3]?`border: 5px solid ${y[3]};`:"")))&&m(t,"style",u),y[4]?M?M.p(y,F):(M=vr(y),M.c(),M.m(f,d)):M&&(M.d(1),M=null),y[5]?I&&(pe(),L(I,1,1,()=>{I=null}),ge()):I?(I.p(y,F),F&32&&O(I,1)):(I=br(y),I.c(),O(I,1),I.m(f,p)),T&&T.p&&(!w||F&262144)&&qe(T,R,y,y[18],w?Be(R,y[18],F,Fa):ze(y[18]),_r),(!w||F&2116&&g!==(g="region is-center "+(y[6]&&y[11](y[2])?"checked":"")+" svelte-g5axbe"))&&m(e,"class",g),(!w||F&128&&v!==(v=y[7]==="full"?"height: 100%":""))&&m(e,"style",v)},i(y){w||(O(I),O(T,y),w=!0)},o(y){L(I),L(T,y),w=!1},d(y){y&&E(e),M&&M.d(),I&&I.d(),T&&T.d(y),S=!1,Ie(P)}}}function Ka(i,e,t){let n,r,s,l,o,{$$slots:a={},$$scope:c}=e;const{clipBoard:u}=bt;ue(i,u,Y=>t(17,l=Y));let{selectionStore:h}=e;h||(h=gt);let{toggleSelection:f=h.toggle}=e;const{isSelected:d}=h;ue(i,d,Y=>t(11,o=Y));let{item:p}=e,{index:g=null}=e,{borderColor:v=null}=e,{copyable:w=!1}=e,{isInModal:S=!1}=e,{selectable:P=!S}=e,{isSquare:M=!1}=e,{height:I=M?96:140}=e;I==="full"&&(M=!1);const R=Kt(),T=()=>S?null:R("openModal",{index:g}),y=()=>P?f(n):T(),F=()=>bt.copyRef(p.ref);return i.$$set=Y=>{"selectionStore"in Y&&t(15,h=Y.selectionStore),"toggleSelection"in Y&&t(1,f=Y.toggleSelection),"item"in Y&&t(2,p=Y.item),"index"in Y&&t(16,g=Y.index),"borderColor"in Y&&t(3,v=Y.borderColor),"copyable"in Y&&t(4,w=Y.copyable),"isInModal"in Y&&t(5,S=Y.isInModal),"selectable"in Y&&t(6,P=Y.selectable),"isSquare"in Y&&t(0,M=Y.isSquare),"height"in Y&&t(7,I=Y.height),"$$scope"in Y&&t(18,c=Y.$$scope)},i.$$.update=()=>{i.$$.dirty&4&&t(8,n=new $i(p)),i.$$.dirty&131328&&t(10,r=n.ref===l),i.$$.dirty&385&&t(9,s=n.url(null,I==="full"?"full":M?`${I},`:`,${I}`))},[M,f,p,v,w,S,P,I,n,s,r,o,u,d,T,h,g,l,c,a,y,F]}class qt extends ae{constructor(e){super(),oe(this,e,Ka,za,le,{selectionStore:15,toggleSelection:1,item:2,index:16,borderColor:3,copyable:4,isInModal:5,selectable:6,isSquare:0,height:7})}}function wr(i){let e,t,n,r,s,l,o,a,c,u,h;return t=new ii({props:{category:1,isSelected:i[2]===1,toggle:i[5],padding:"pl-3 pr-2"}}),r=new ii({props:{category:2,isSelected:i[2]===2,toggle:i[5]}}),l=new ii({props:{category:3,isSelected:i[2]===3,toggle:i[5]}}),a=new ii({props:{category:4,isSelected:i[2]===4,toggle:i[5]}}),u=new ii({props:{category:5,isSelected:i[2]===5,toggle:i[5],padding:"pl-2 pr-3"}}),{c(){e=b("div"),G(t.$$.fragment),n=D(),G(r.$$.fragment),s=D(),G(l.$$.fragment),o=D(),G(a.$$.fragment),c=D(),G(u.$$.fragment),m(e,"class","tags has-addons is-dark is-center")},m(f,d){C(f,e,d),K(t,e,null),_(e,n),K(r,e,null),_(e,s),K(l,e,null),_(e,o),K(a,e,null),_(e,c),K(u,e,null),h=!0},p(f,d){const p={};d&4&&(p.isSelected=f[2]===1),t.$set(p);const g={};d&4&&(g.isSelected=f[2]===2),r.$set(g);const v={};d&4&&(v.isSelected=f[2]===3),l.$set(v);const w={};d&4&&(w.isSelected=f[2]===4),a.$set(w);const S={};d&4&&(S.isSelected=f[2]===5),u.$set(S)},i(f){h||(O(t.$$.fragment,f),O(r.$$.fragment,f),O(l.$$.fragment,f),O(a.$$.fragment,f),O(u.$$.fragment,f),h=!0)},o(f){L(t.$$.fragment,f),L(r.$$.fragment,f),L(l.$$.fragment,f),L(a.$$.fragment,f),L(u.$$.fragment,f),h=!1},d(f){f&&E(e),W(t),W(r),W(l),W(a),W(u)}}}function Wa(i){let e,t,n,r;t=new qt({props:{item:i[4],height:140,selectable:!1,copyable:!0,isSquare:!1,isInModal:i[1],index:i[0]}}),t.$on("openModal",i[15]);let s=!i[1]&&wr(i);return{c(){e=b("div"),G(t.$$.fragment),n=D(),s&&s.c()},m(l,o){C(l,e,o),K(t,e,null),_(e,n),s&&s.m(e,null),r=!0},p(l,[o]){const a={};o&2&&(a.isInModal=l[1]),o&1&&(a.index=l[0]),t.$set(a),l[1]?s&&(pe(),L(s,1,1,()=>{s=null}),ge()):s?(s.p(l,o),o&2&&O(s,1)):(s=wr(l),s.c(),O(s,1),s.m(e,null))},i(l){r||(O(t.$$.fragment,l),O(s),r=!0)},o(l){L(t.$$.fragment,l),L(s),r=!1},d(l){l&&E(e),W(t),s&&s.d()}}}function Ga(i,e,t){let n,r,s;const{comparedRegions:l}=xe;ue(i,l,V=>t(17,s=V));const a=new URL(window.location.href).origin;let{qImg:c}=e,{sImg:u}=e,{qRegions:h}=e,{sRegions:f}=e,{score:d=0}=e,{category:p=null}=e,{users:g=[]}=e,{isManual:v}=e,{similarityType:w}=e,{index:S=0}=e,{isInModal:P=!1}=e;const[M,I,R,T]=u.split(".")[0].split("_"),F=(()=>{let V=En(u,M,T,R);const H=s[`${M}_${I}_anno${f}`]||{title:V.title};return V.title=`${Js(H.title.replace(/^[^|]+/,""))}<br/>Page ${$o(R)}<br/><b>Score: ${d}</b>`,V})();at("similarityPair",{qImg:c,sImg:u,qRegions:h,sRegions:f,score:d,category:p,users:g,isManual:v,similarityType:w});function Y(V){V=V.slice();let H=V.indexOf(Number(Oi));return r&&H===-1?V.push(Number(Oi)):!r&&H!==-1&&V.splice(H,1),V}const se=()=>({img_1:c,img_2:u,regions_id_1:h,regions_id_2:f,score:d,category:n,category_x:Y(g),similarity_type:w});function U(V){V===5?r=!r:t(2,n=n===V?null:V)}async function x(V){U(V);try{(await fetch(`${a}/${Ve}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify(se())})).ok||(console.error("Error: Network response was not ok"),U(V))}catch(H){console.error("Error:",H),U(V)}}function Z(V){Li.call(this,i,V)}return i.$$set=V=>{"qImg"in V&&t(6,c=V.qImg),"sImg"in V&&t(7,u=V.sImg),"qRegions"in V&&t(8,h=V.qRegions),"sRegions"in V&&t(9,f=V.sRegions),"score"in V&&t(10,d=V.score),"category"in V&&t(11,p=V.category),"users"in V&&t(12,g=V.users),"isManual"in V&&t(13,v=V.isManual),"similarityType"in V&&t(14,w=V.similarityType),"index"in V&&t(0,S=V.index),"isInModal"in V&&t(1,P=V.isInModal)},i.$$.update=()=>{i.$$.dirty&2048&&t(2,n=p),i.$$.dirty&4096&&(r=g.includes(Number(Oi))||!1)},[S,P,n,l,F,x,c,u,h,f,d,p,g,v,w,Z]}class Ya extends ae{constructor(e){super(),oe(this,e,Ga,Wa,le,{qImg:6,sImg:7,qRegions:8,sRegions:9,score:10,category:11,users:12,isManual:13,similarityType:14,index:0,isInModal:1})}}function xa(i){let e,t,n,r,s,l,o,a;return{c(){e=b("button"),t=b("span"),n=b("i"),m(n,"class",r="fas fa-chevron-"+i[0]+" svelte-v4yed0"),m(t,"class","icon is-small p-0"),m(e,"class",s="nav-btn nav-"+i[0]+" svelte-v4yed0"),m(e,"aria-label",l="Navigate "+i[0]),m(e,"style",i[4])},m(c,u){C(c,e,u),_(e,t),_(t,n),o||(a=ie(e,"click",i[5]),o=!0)},p(c,[u]){u&1&&r!==(r="fas fa-chevron-"+c[0]+" svelte-v4yed0")&&m(n,"class",r),u&1&&s!==(s="nav-btn nav-"+c[0]+" svelte-v4yed0")&&m(e,"class",s),u&1&&l!==(l="Navigate "+c[0])&&m(e,"aria-label",l),u&16&&m(e,"style",c[4])},i:j,o:j,d(c){c&&E(e),o=!1,a()}}}function Ja(i,e,t){let{direction:n=""}=e,{delta:r=0}=e,{axis:s=null}=e,{navigationFct:l=()=>{}}=e,{css:o=""}=e;const a=()=>l(r,s);return i.$$set=c=>{"direction"in c&&t(0,n=c.direction),"delta"in c&&t(1,r=c.delta),"axis"in c&&t(2,s=c.axis),"navigationFct"in c&&t(3,l=c.navigationFct),"css"in c&&t(4,o=c.css)},[n,r,s,l,o,a]}class Di extends ae{constructor(e){super(),oe(this,e,Ja,xa,le,{direction:0,delta:1,axis:2,navigationFct:3,css:4})}}const Xa=i=>({item:i&4,index:i&1}),yr=i=>({item:i[2],index:i[0],close:i[4]});function kr(i){let e,t,n,r,s,l,o,a,c,u,h,f,d=i[3]&&Sr(i);const p=i[8].default,g=He(p,i,i[7],yr);let v=i[3]&&Er(i);return{c(){e=b("div"),t=b("div"),n=D(),r=b("div"),d&&d.c(),s=D(),l=b("div"),g&&g.c(),o=D(),v&&v.c(),a=D(),c=b("button"),m(t,"class","modal-background"),m(l,"class","modal-inner svelte-157hwlf"),m(r,"class","modal-content svelte-157hwlf"),m(c,"class","modal-close is-large"),m(c,"aria-label","close"),m(e,"class","modal is-active")},m(w,S){C(w,e,S),_(e,t),_(e,n),_(e,r),d&&d.m(r,null),_(r,s),_(r,l),g&&g.m(l,null),_(r,o),v&&v.m(r,null),_(e,a),_(e,c),u=!0,h||(f=[ie(t,"click",i[4]),ie(t,"keyup",i[9]),ie(c,"click",i[4])],h=!0)},p(w,S){w[3]?d?(d.p(w,S),S&8&&O(d,1)):(d=Sr(w),d.c(),O(d,1),d.m(r,s)):d&&(pe(),L(d,1,1,()=>{d=null}),ge()),g&&g.p&&(!u||S&133)&&qe(g,p,w,w[7],u?Be(p,w[7],S,Xa):ze(w[7]),yr),w[3]?v?(v.p(w,S),S&8&&O(v,1)):(v=Er(w),v.c(),O(v,1),v.m(r,null)):v&&(pe(),L(v,1,1,()=>{v=null}),ge())},i(w){u||(O(d),O(g,w),O(v),u=!0)},o(w){L(d),L(g,w),L(v),u=!1},d(w){w&&E(e),d&&d.d(),g&&g.d(w),v&&v.d(),h=!1,Ie(f)}}}function Sr(i){let e,t;return e=new Di({props:{direction:"left",delta:-1,navigationFct:i[5],css:"position: initial;"}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Er(i){let e,t;return e=new Di({props:{direction:"right",delta:1,navigationFct:i[5],css:"position: initial;"}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Qa(i){let e,t,n=i[1]&&kr(i);return{c(){n&&n.c(),e=_e()},m(r,s){n&&n.m(r,s),C(r,e,s),t=!0},p(r,[s]){r[1]?n?(n.p(r,s),s&2&&O(n,1)):(n=kr(r),n.c(),O(n,1),n.m(e.parentNode,e)):n&&(pe(),L(n,1,1,()=>{n=null}),ge())},i(r){t||(O(n),t=!0)},o(r){L(n),t=!1},d(r){n&&n.d(r),r&&E(e)}}}function Za(i,e,t){let n,r,{$$slots:s={},$$scope:l}=e,{open:o=!1}=e,{items:a=[]}=e,{currentIndex:c=0}=e;const u=Kt(),h=()=>{t(1,o=!1),u("close")},f=g=>{n&&(t(0,c=(c+g+a.length)%a.length),u("navigate",{index:c,item:r}))},d=g=>{o&&(g.key==="Escape"?h():g.key==="ArrowLeft"?f(-1):g.key==="ArrowRight"&&f(1))};st(()=>document.addEventListener("keydown",d)),di(()=>document.removeEventListener("keydown",d));function p(g){Li.call(this,i,g)}return i.$$set=g=>{"open"in g&&t(1,o=g.open),"items"in g&&t(6,a=g.items),"currentIndex"in g&&t(0,c=g.currentIndex),"$$scope"in g&&t(7,l=g.$$scope)},i.$$.update=()=>{i.$$.dirty&64&&t(3,n=a.length>1),i.$$.dirty&65&&t(2,r=a[c]??null)},[c,o,r,n,h,f,a,l,s,p]}class Cn extends ae{constructor(e){super(),oe(this,e,Za,Qa,le,{open:1,items:6,currentIndex:0})}}function Cr(i){i[9]=i[13][0],i[10]=i[13][1],i[11]=i[13][2],i[12]=i[13][3]}function Ir(i){let e,t,n={ctx:i,current:null,token:null,hasCatch:!1,pending:ic,then:tc,catch:ec,value:13};return Ze(t=i[3],n),{c(){e=_e(),n.block.c()},m(r,s){C(r,e,s),n.block.m(r,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e},p(r,s){i=r,n.ctx=i,s&8&&t!==(t=i[3])&&Ze(t,n)||At(n,i,s)},d(r){r&&E(e),n.block.d(r),n.token=null,n=null}}}function ec(i){return{c:j,m:j,p:j,d:j}}function tc(i){Cr(i);let e,t=`${i[9]}%`,n=`${i[10]}%`,r=`${i[11]}%`,s=`${i[12]}%`;return{c(){e=b("div"),m(e,"class","modal-context-bbox svelte-zgr10j"),ve(e,"left",t),ve(e,"top",n),ve(e,"width",r),ve(e,"height",s)},m(l,o){C(l,e,o)},p(l,o){Cr(l),o&8&&t!==(t=`${l[9]}%`)&&ve(e,"left",t),o&8&&n!==(n=`${l[10]}%`)&&ve(e,"top",n),o&8&&r!==(r=`${l[11]}%`)&&ve(e,"width",r),o&8&&s!==(s=`${l[12]}%`)&&ve(e,"height",s)},d(l){l&&E(e)}}}function ic(i){return{c:j,m:j,p:j,d:j}}function nc(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v;c=new Di({props:{direction:"left",delta:-1,navigationFct:i[5],css:"margin-left: -2em;"}});let w=i[0]===0&&Ir(i);return g=new Di({props:{direction:"right",delta:1,navigationFct:i[5],css:"margin-right: -2em;"}}),{c(){e=b("div"),t=b("div"),n=b("a"),r=J("Page "),s=J(i[2]),o=D(),a=b("div"),G(c.$$.fragment),u=D(),h=b("img"),d=D(),w&&w.c(),p=D(),G(g.$$.fragment),m(n,"class","tag button is-small has-text-grey"),m(n,"href",l=i[1].urlForMirador(i[2])),m(n,"target","_blank"),m(t,"class","has-text-centered m-2"),m(h,"class","card modal-context-full-page svelte-zgr10j"),$e(h.src,f=i[4])||m(h,"src",f),m(h,"alt",N==="fr"?"Vue de la page d'où la région est extraite":"View of the page the region is extracted from"),m(a,"class","modal-context-wrapper svelte-zgr10j"),m(e,"class","modal-context-outer is-flex-direction-column pb-4 svelte-zgr10j")},m(S,P){C(S,e,P),_(e,t),_(t,n),_(n,r),_(n,s),_(e,o),_(e,a),K(c,a,null),_(a,u),_(a,h),_(a,d),w&&w.m(a,null),_(a,p),K(g,a,null),v=!0},p(S,[P]){(!v||P&4)&&fe(s,S[2]),(!v||P&6&&l!==(l=S[1].urlForMirador(S[2])))&&m(n,"href",l),(!v||P&16&&!$e(h.src,f=S[4]))&&m(h,"src",f),S[0]===0?w?w.p(S,P):(w=Ir(S),w.c(),w.m(a,p)):w&&(w.d(1),w=null)},i(S){v||(O(c.$$.fragment,S),O(g.$$.fragment,S),v=!0)},o(S){L(c.$$.fragment,S),L(g.$$.fragment,S),v=!1},d(S){S&&E(e),W(c),w&&w.d(),W(g)}}}function rc(i,e,t){let n,r,s,l,o,a,{item:c}=e,u=0;const h=f=>t(0,u+=f);return i.$$set=f=>{"item"in f&&t(6,c=f.item)},i.$$.update=()=>{i.$$.dirty&64&&t(1,n=new $i(c)),i.$$.dirty&3&&t(2,r=n.canvasNb+u),i.$$.dirty&6&&t(4,s=n.urlForCanvas(r,"full")),i.$$.dirty&6&&t(8,l=n.infoUrlForCanvas(r)),i.$$.dirty&2&&t(7,o=n.coord),i.$$.dirty&384&&t(3,a=fetch(l).then(f=>f.json()).then(({width:f,height:d})=>[o[0]/f*100,o[1]/d*100,o[2]/f*100,o[3]/d*100]))},[u,n,r,a,s,h,c,o,l]}class pl extends ae{constructor(e){super(),oe(this,e,rc,nc,le,{item:6})}}function sc(i){let e,t,n,r,s,l,o;return{c(){e=b("button"),t=b("span"),t.innerHTML='<span class="switch-control svelte-g5g8im"><span class="switch-spot"></span></span>',n=D(),r=b("span"),s=J(i[0]),m(t,"class","switch mr-2 svelte-g5g8im"),m(r,"class","label svelte-g5g8im"),m(e,"id",i[3]),m(e,"name",i[3]),m(e,"class","input-checkbox-wrapper is-flex is-align-items-center-is-justify-content-center p-2 pl-3 pr-3 svelte-g5g8im"),m(e,"aria-label",i[0]),Ce(e,"is-checked",i[2]),Ce(e,"is-clickable",i[1]),Ce(e,"button",i[1])},m(a,c){C(a,e,c),_(e,t),_(e,n),_(e,r),_(r,s),l||(o=ie(e,"click",wt(i[4])),l=!0)},p(a,[c]){c&1&&fe(s,a[0]),c&1&&m(e,"aria-label",a[0]),c&4&&Ce(e,"is-checked",a[2]),c&2&&Ce(e,"is-clickable",a[1]),c&2&&Ce(e,"button",a[1])},i:j,o:j,d(a){a&&E(e),l=!1,o()}}}function lc(i,e,t){let n,{toggleLabel:r}=e,{start:s=!1}=e,{buttonDisplay:l=!1}=e;const o=`input-toggle-${window.crypto.randomUUID()}`,a=Kt(),c=Je("resetTrigger")||void 0;c==null||c.subscribe(h);const u=()=>t(2,n=!n);function h(){t(2,n=s)}return i.$$set=f=>{"toggleLabel"in f&&t(0,r=f.toggleLabel),"start"in f&&t(5,s=f.start),"buttonDisplay"in f&&t(1,l=f.buttonDisplay)},i.$$.update=()=>{i.$$.dirty&32&&t(2,n=s),i.$$.dirty&4&&a("updateChecked",n)},[r,l,n,o,u,s]}class gl extends ae{constructor(e){super(),oe(this,e,lc,sc,le,{toggleLabel:0,start:5,buttonDisplay:1})}}var pt;(function(i){i.Range="range",i.Steps="steps",i.Positions="positions",i.Count="count",i.Values="values"})(pt||(pt={}));var Fe;(function(i){i[i.None=-1]="None",i[i.NoValue=0]="NoValue",i[i.LargeValue=1]="LargeValue",i[i.SmallValue=2]="SmallValue"})(Fe||(Fe={}));function oc(i){return Ni(i)&&typeof i.from=="function"}function Ni(i){return typeof i=="object"&&typeof i.to=="function"}function Or(i){i.parentElement.removeChild(i)}function on(i){return i!=null}function Ar(i){i.preventDefault()}function ac(i){return i.filter(function(e){return this[e]?!1:this[e]=!0},{})}function cc(i,e){return Math.round(i/e)*e}function uc(i,e){var t=i.getBoundingClientRect(),n=i.ownerDocument,r=n.documentElement,s=_l(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(s.x=0),e?t.top+s.y-r.clientTop:t.left+s.x-r.clientLeft}function Qe(i){return typeof i=="number"&&!isNaN(i)&&isFinite(i)}function Tr(i,e,t){t>0&&(je(i,e),setTimeout(function(){Ai(i,e)},t))}function Mr(i){return Math.max(Math.min(i,100),0)}function Hi(i){return Array.isArray(i)?i:[i]}function fc(i){i=String(i);var e=i.split(".");return e.length>1?e[1].length:0}function je(i,e){i.classList&&!/\s/.test(e)?i.classList.add(e):i.className+=" "+e}function Ai(i,e){i.classList&&!/\s/.test(e)?i.classList.remove(e):i.className=i.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function dc(i,e){return i.classList?i.classList.contains(e):new RegExp("\\b"+e+"\\b").test(i.className)}function _l(i){var e=window.pageXOffset!==void 0,t=(i.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:t?i.documentElement.scrollLeft:i.body.scrollLeft,r=e?window.pageYOffset:t?i.documentElement.scrollTop:i.body.scrollTop;return{x:n,y:r}}function hc(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function mc(){var i=!1;try{var e=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("test",null,e)}catch{}return i}function pc(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function In(i,e){return 100/(e-i)}function an(i,e,t){return e*100/(i[t+1]-i[t])}function gc(i,e){return an(i,i[0]<0?e+Math.abs(i[0]):e-i[0],0)}function _c(i,e){return e*(i[1]-i[0])/100+i[0]}function ui(i,e){for(var t=1;i>=e[t];)t+=1;return t}function vc(i,e,t){if(t>=i.slice(-1)[0])return 100;var n=ui(t,i),r=i[n-1],s=i[n],l=e[n-1],o=e[n];return l+gc([r,s],t)/In(l,o)}function bc(i,e,t){if(t>=100)return i.slice(-1)[0];var n=ui(t,e),r=i[n-1],s=i[n],l=e[n-1],o=e[n];return _c([r,s],(t-l)*In(l,o))}function wc(i,e,t,n){if(n===100)return n;var r=ui(n,i),s=i[r-1],l=i[r];return t?n-s>(l-s)/2?l:s:e[r-1]?i[r-1]+cc(n-i[r-1],e[r-1]):n}var vl=function(){function i(e,t,n){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=t;var r,s=[];for(Object.keys(e).forEach(function(l){s.push([Hi(e[l]),l])}),s.sort(function(l,o){return l[0][0]-o[0][0]}),r=0;r<s.length;r++)this.handleEntryPoint(s[r][1],s[r][0]);for(this.xNumSteps=this.xSteps.slice(0),r=0;r<this.xNumSteps.length;r++)this.handleStepPoint(r,this.xNumSteps[r])}return i.prototype.getDistance=function(e){for(var t=[],n=0;n<this.xNumSteps.length-1;n++)t[n]=an(this.xVal,e,n);return t},i.prototype.getAbsoluteDistance=function(e,t,n){var r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);!n&&e===this.xPct[r+1]&&r++,t===null&&(t=[]);var s,l=1,o=t[r],a=0,c=0,u=0,h=0;for(n?s=(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):s=(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);o>0;)a=this.xPct[r+1+h]-this.xPct[r+h],t[r+h]*l+100-s*100>100?(c=a*s,l=(o-100*s)/t[r+h],s=1):(c=t[r+h]*a/100*l,l=0),n?(u=u-c,this.xPct.length+h>=1&&h--):(u=u+c,this.xPct.length-h>=1&&h++),o=t[r+h]*l;return e+u},i.prototype.toStepping=function(e){return e=vc(this.xVal,this.xPct,e),e},i.prototype.fromStepping=function(e){return bc(this.xVal,this.xPct,e)},i.prototype.getStep=function(e){return e=wc(this.xPct,this.xSteps,this.snap,e),e},i.prototype.getDefaultStep=function(e,t,n){var r=ui(e,this.xPct);return(e===100||t&&e===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/n},i.prototype.getNearbySteps=function(e){var t=ui(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},i.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(fc);return Math.max.apply(null,e)},i.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},i.prototype.convert=function(e){return this.getStep(this.toStepping(e))},i.prototype.handleEntryPoint=function(e,t){var n;if(e==="min"?n=0:e==="max"?n=100:n=parseFloat(e),!Qe(n)||!Qe(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(t[0]);var r=Number(t[1]);n?this.xSteps.push(isNaN(r)?!1:r):isNaN(r)||(this.xSteps[0]=r),this.xHighestCompleteStep.push(0)},i.prototype.handleStepPoint=function(e,t){if(t){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=an([this.xVal[e],this.xVal[e+1]],t,0)/In(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],r=Math.ceil(Number(n.toFixed(3))-1),s=this.xVal[e]+this.xNumSteps[e]*r;this.xHighestCompleteStep[e]=s}},i}(),Pr={to:function(i){return i===void 0?"":i.toFixed(2)},from:Number},bl={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},mt={tooltips:".__tooltips",aria:".__aria"};function yc(i,e){if(!Qe(e))throw new Error("noUiSlider: 'step' is not numeric.");i.singleStep=e}function kc(i,e){if(!Qe(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");i.keyboardPageMultiplier=e}function Sc(i,e){if(!Qe(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");i.keyboardMultiplier=e}function Ec(i,e){if(!Qe(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");i.keyboardDefaultStep=e}function Cc(i,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");i.spectrum=new vl(e,i.snap||!1,i.singleStep)}function Ic(i,e){if(e=Hi(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");i.handles=e.length,i.start=e}function Oc(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");i.snap=e}function Ac(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");i.animate=e}function Tc(i,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");i.animationDuration=e}function wl(i,e){var t=[!1],n;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(n=1;n<i.handles;n++)t.push(e);t.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==i.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t=e}i.connect=t}function Mc(i,e){switch(e){case"horizontal":i.ort=0;break;case"vertical":i.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function yl(i,e){if(!Qe(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(i.margin=i.spectrum.getDistance(e))}function Pc(i,e){if(!Qe(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(i.limit=i.spectrum.getDistance(e),!i.limit||i.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function Lc(i,e){var t;if(!Qe(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||Qe(e[0])||Qe(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),i.padding=[i.spectrum.getDistance(e[0]),i.spectrum.getDistance(e[1])],t=0;t<i.spectrum.xNumSteps.length-1;t++)if(i.padding[0][t]<0||i.padding[1][t]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var n=e[0]+e[1],r=i.spectrum.xVal[0],s=i.spectrum.xVal[i.spectrum.xVal.length-1];if(n/(s-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function Rc(i,e){switch(e){case"ltr":i.dir=0;break;case"rtl":i.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function $c(i,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var t=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,s=e.indexOf("snap")>=0,l=e.indexOf("hover")>=0,o=e.indexOf("unconstrained")>=0,a=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,u=e.indexOf("smooth-steps")>=0;if(r){if(i.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");yl(i,i.start[1]-i.start[0])}if(a&&i.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(o&&(i.margin||i.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");i.events={tap:t||s,drag:n,dragAll:c,smoothSteps:u,fixed:r,snap:s,hover:l,unconstrained:o,invertConnects:a}}function Dc(i,e){if(e!==!1)if(e===!0||Ni(e)){i.tooltips=[];for(var t=0;t<i.handles;t++)i.tooltips.push(e)}else{if(e=Hi(e),e.length!==i.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(n){if(typeof n!="boolean"&&!Ni(n))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),i.tooltips=e}}function Nc(i,e){if(e.length!==i.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");i.handleAttributes=e}function jc(i,e){if(!Ni(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");i.ariaFormat=e}function Vc(i,e){if(!oc(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");i.format=e}function Fc(i,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");i.keyboardSupport=e}function Uc(i,e){i.documentElement=e}function Hc(i,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");i.cssPrefix=e}function Bc(i,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof i.cssPrefix=="string"?(i.cssClasses={},Object.keys(e).forEach(function(t){i.cssClasses[t]=i.cssPrefix+e[t]})):i.cssClasses=e}function kl(i){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:Pr,format:Pr},t={step:{r:!1,t:yc},keyboardPageMultiplier:{r:!1,t:kc},keyboardMultiplier:{r:!1,t:Sc},keyboardDefaultStep:{r:!1,t:Ec},start:{r:!0,t:Ic},connect:{r:!0,t:wl},direction:{r:!0,t:Rc},snap:{r:!1,t:Oc},animate:{r:!1,t:Ac},animationDuration:{r:!1,t:Tc},range:{r:!0,t:Cc},orientation:{r:!1,t:Mc},margin:{r:!1,t:yl},limit:{r:!1,t:Pc},padding:{r:!1,t:Lc},behaviour:{r:!0,t:$c},ariaFormat:{r:!1,t:jc},format:{r:!1,t:Vc},tooltips:{r:!1,t:Dc},keyboardSupport:{r:!0,t:Fc},documentElement:{r:!1,t:Uc},cssPrefix:{r:!0,t:Hc},cssClasses:{r:!0,t:Bc},handleAttributes:{r:!1,t:Nc}},n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:bl,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};i.format&&!i.ariaFormat&&(i.ariaFormat=i.format),Object.keys(t).forEach(function(a){if(!on(i[a])&&n[a]===void 0){if(t[a].r)throw new Error("noUiSlider: '"+a+"' is required.");return}t[a].t(e,on(i[a])?i[a]:n[a])}),e.pips=i.pips;var r=document.createElement("div"),s=r.style.msTransform!==void 0,l=r.style.transform!==void 0;e.transformRule=l?"transform":s?"msTransform":"webkitTransform";var o=[["left","top"],["right","bottom"]];return e.style=o[e.dir][e.ort],e}function qc(i,e,t){var n=hc(),r=pc(),s=r&&mc(),l=i,o,a,c,u,h,f,d=e.spectrum,p=[],g=[],v=[],w=0,S={},P=!1,M=i.ownerDocument,I=e.documentElement||M.documentElement,R=M.body,T=M.dir==="rtl"||e.ort===1?0:100;function y(k,A){var $=M.createElement("div");return A&&je($,A),k.appendChild($),$}function F(k,A){var $=y(k,e.cssClasses.origin),q=y($,e.cssClasses.handle);if(y(q,e.cssClasses.touchArea),q.setAttribute("data-handle",String(A)),e.keyboardSupport&&(q.setAttribute("tabindex","0"),q.addEventListener("keydown",function(Q){return Wl(Q,A)})),e.handleAttributes!==void 0){var X=e.handleAttributes[A];Object.keys(X).forEach(function(Q){q.setAttribute(Q,X[Q])})}return q.setAttribute("role","slider"),q.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),A===0?je(q,e.cssClasses.handleLower):A===e.handles-1&&je(q,e.cssClasses.handleUpper),$.handle=q,$}function Y(k,A){return A?y(k,e.cssClasses.connect):!1}function se(k,A){a=y(A,e.cssClasses.connects),c=[],u=[],u.push(Y(a,k[0]));for(var $=0;$<e.handles;$++)c.push(F(A,$)),v[$]=$,u.push(Y(a,k[$+1]))}function U(k){je(k,e.cssClasses.target),e.dir===0?je(k,e.cssClasses.ltr):je(k,e.cssClasses.rtl),e.ort===0?je(k,e.cssClasses.horizontal):je(k,e.cssClasses.vertical);var A=getComputedStyle(k).direction;return A==="rtl"?je(k,e.cssClasses.textDirectionRtl):je(k,e.cssClasses.textDirectionLtr),y(k,e.cssClasses.base)}function x(k,A){return!e.tooltips||!e.tooltips[A]?!1:y(k.firstChild,e.cssClasses.tooltip)}function Z(){return l.hasAttribute("disabled")}function V(k){var A=c[k];return A.hasAttribute("disabled")}function H(k){k!=null?(c[k].setAttribute("disabled",""),c[k].handle.removeAttribute("tabindex")):(l.setAttribute("disabled",""),c.forEach(function(A){A.handle.removeAttribute("tabindex")}))}function re(k){k!=null?(c[k].removeAttribute("disabled"),c[k].handle.setAttribute("tabindex","0")):(l.removeAttribute("disabled"),c.forEach(function(A){A.removeAttribute("disabled"),A.handle.setAttribute("tabindex","0")}))}function z(){f&&(Zt("update"+mt.tooltips),f.forEach(function(k){k&&Or(k)}),f=null)}function B(){z(),f=c.map(x),Wi("update"+mt.tooltips,function(k,A,$){if(!(!f||!e.tooltips)&&f[A]!==!1){var q=k[A];e.tooltips[A]!==!0&&(q=e.tooltips[A].to($[A])),f[A].innerHTML=q}})}function te(){Zt("update"+mt.aria),Wi("update"+mt.aria,function(k,A,$,q,X){v.forEach(function(Q){var ne=c[Q],ee=vi(g,Q,0,!0,!0,!0),we=vi(g,Q,100,!0,!0,!0),ye=X[Q],ke=String(e.ariaFormat.to($[Q]));ee=d.fromStepping(ee).toFixed(1),we=d.fromStepping(we).toFixed(1),ye=d.fromStepping(ye).toFixed(1),ne.children[0].setAttribute("aria-valuemin",ee),ne.children[0].setAttribute("aria-valuemax",we),ne.children[0].setAttribute("aria-valuenow",ye),ne.children[0].setAttribute("aria-valuetext",ke)})})}function he(k){if(k.mode===pt.Range||k.mode===pt.Steps)return d.xVal;if(k.mode===pt.Count){if(k.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var A=k.values-1,$=100/A,q=[];A--;)q[A]=A*$;return q.push(100),be(q,k.stepped)}return k.mode===pt.Positions?be(k.values,k.stepped):k.mode===pt.Values?k.stepped?k.values.map(function(X){return d.fromStepping(d.getStep(d.toStepping(X)))}):k.values:[]}function be(k,A){return k.map(function($){return d.fromStepping(A?d.getStep($):$)})}function Gt(k){function A(ye,ke){return Number((ye+ke).toFixed(7))}var $=he(k),q={},X=d.xVal[0],Q=d.xVal[d.xVal.length-1],ne=!1,ee=!1,we=0;return $=ac($.slice().sort(function(ye,ke){return ye-ke})),$[0]!==X&&($.unshift(X),ne=!0),$[$.length-1]!==Q&&($.push(Q),ee=!0),$.forEach(function(ye,ke){var Se,me,Te,De=ye,Me=$[ke+1],Pe,xi,Ji,Xi,jn,Qi,Vn,Fn=k.mode===pt.Steps;for(Fn&&(Se=d.xNumSteps[ke]),Se||(Se=Me-De),Me===void 0&&(Me=De),Se=Math.max(Se,1e-7),me=De;me<=Me;me=A(me,Se)){for(Pe=d.toStepping(me),xi=Pe-we,jn=xi/(k.density||1),Qi=Math.round(jn),Vn=xi/Qi,Te=1;Te<=Qi;Te+=1)Ji=we+Te*Vn,q[Ji.toFixed(5)]=[d.fromStepping(Ji),0];Xi=$.indexOf(me)>-1?Fe.LargeValue:Fn?Fe.SmallValue:Fe.NoValue,!ke&&ne&&me!==Me&&(Xi=0),me===Me&&ee||(q[Pe.toFixed(5)]=[me,Xi]),we=Pe}}),q}function Yt(k,A,$){var q,X,Q=M.createElement("div"),ne=(q={},q[Fe.None]="",q[Fe.NoValue]=e.cssClasses.valueNormal,q[Fe.LargeValue]=e.cssClasses.valueLarge,q[Fe.SmallValue]=e.cssClasses.valueSub,q),ee=(X={},X[Fe.None]="",X[Fe.NoValue]=e.cssClasses.markerNormal,X[Fe.LargeValue]=e.cssClasses.markerLarge,X[Fe.SmallValue]=e.cssClasses.markerSub,X),we=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],ye=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];je(Q,e.cssClasses.pips),je(Q,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function ke(me,Te){var De=Te===e.cssClasses.value,Me=De?we:ye,Pe=De?ne:ee;return Te+" "+Me[e.ort]+" "+Pe[me]}function Se(me,Te,De){if(De=A?A(Te,De):De,De!==Fe.None){var Me=y(Q,!1);Me.className=ke(De,e.cssClasses.marker),Me.style[e.style]=me+"%",De>Fe.NoValue&&(Me=y(Q,!1),Me.className=ke(De,e.cssClasses.value),Me.setAttribute("data-value",String(Te)),Me.style[e.style]=me+"%",Me.innerHTML=String($.to(Te)))}}return Object.keys(k).forEach(function(me){Se(me,k[me][0],k[me][1])}),Q}function xt(){h&&(Or(h),h=null)}function Jt(k){xt();var A=Gt(k),$=k.filter,q=k.format||{to:function(X){return String(Math.round(X))}};return h=l.appendChild(Yt(A,$,q)),h}function pi(){var k=o.getBoundingClientRect(),A="offset"+["Width","Height"][e.ort];return e.ort===0?k.width||o[A]:k.height||o[A]}function lt(k,A,$,q){var X=function(ne){var ee=Xt(ne,q.pageOffset,q.target||A);if(!ee||Z()&&!q.doNotReject||dc(l,e.cssClasses.tap)&&!q.doNotReject||k===n.start&&ee.buttons!==void 0&&ee.buttons>1||q.hover&&ee.buttons)return!1;s||ee.preventDefault(),ee.calcPoint=ee.points[e.ort],$(ee,q)},Q=[];return k.split(" ").forEach(function(ne){A.addEventListener(ne,X,s?{passive:!0}:!1),Q.push([ne,X])}),Q}function Xt(k,A,$){var q=k.type.indexOf("touch")===0,X=k.type.indexOf("mouse")===0,Q=k.type.indexOf("pointer")===0,ne=0,ee=0;if(k.type.indexOf("MSPointer")===0&&(Q=!0),k.type==="mousedown"&&!k.buttons&&!k.touches)return!1;if(q){var we=function(Se){var me=Se.target;return me===$||$.contains(me)||k.composed&&k.composedPath().shift()===$};if(k.type==="touchstart"){var ye=Array.prototype.filter.call(k.touches,we);if(ye.length>1)return!1;ne=ye[0].pageX,ee=ye[0].pageY}else{var ke=Array.prototype.find.call(k.changedTouches,we);if(!ke)return!1;ne=ke.pageX,ee=ke.pageY}}return A=A||_l(M),(X||Q)&&(ne=k.clientX+A.x,ee=k.clientY+A.y),k.pageOffset=A,k.points=[ne,ee],k.cursor=X||Q,k}function Qt(k){var A=k-uc(o,e.ort),$=A*100/pi();return $=Mr($),e.dir?100-$:$}function gi(k){var A=100,$=!1;return c.forEach(function(q,X){if(!V(X)){var Q=g[X],ne=Math.abs(Q-k),ee=ne===100&&A===100,we=ne<A,ye=ne<=A&&k>Q;(we||ye||ee)&&($=X,A=ne)}}),$}function _i(k,A){k.type==="mouseout"&&k.target.nodeName==="HTML"&&k.relatedTarget===null&&zi(k,A)}function ql(k,A){if(navigator.appVersion.indexOf("MSIE 9")===-1&&k.buttons===0&&A.buttonsProperty!==0)return zi(k,A);var $=(e.dir?-1:1)*(k.calcPoint-A.startCalcPoint),q=$*100/A.baseSize;Pn($>0,q,A.locations,A.handleNumbers,A.connect)}function zi(k,A){A.handle&&(Ai(A.handle,e.cssClasses.active),w-=1),A.listeners.forEach(function($){I.removeEventListener($[0],$[1])}),w===0&&(Ai(l,e.cssClasses.drag),Yi(),k.cursor&&(R.style.cursor="",R.removeEventListener("selectstart",Ar))),e.events.smoothSteps&&(A.handleNumbers.forEach(function($){kt($,g[$],!0,!0,!1,!1)}),A.handleNumbers.forEach(function($){Oe("update",$)})),A.handleNumbers.forEach(function($){Oe("change",$),Oe("set",$),Oe("end",$)})}function Ki(k,A){if(!A.handleNumbers.some(V)){var $;if(A.handleNumbers.length===1){var q=c[A.handleNumbers[0]];$=q.children[0],w+=1,je($,e.cssClasses.active)}k.stopPropagation();var X=[],Q=lt(n.move,I,ql,{target:k.target,handle:$,connect:A.connect,listeners:X,startCalcPoint:k.calcPoint,baseSize:pi(),pageOffset:k.pageOffset,handleNumbers:A.handleNumbers,buttonsProperty:k.buttons,locations:g.slice()}),ne=lt(n.end,I,zi,{target:k.target,handle:$,listeners:X,doNotReject:!0,handleNumbers:A.handleNumbers}),ee=lt("mouseout",I,_i,{target:k.target,handle:$,listeners:X,doNotReject:!0,handleNumbers:A.handleNumbers});X.push.apply(X,Q.concat(ne,ee)),k.cursor&&(R.style.cursor=getComputedStyle(k.target).cursor,c.length>1&&je(l,e.cssClasses.drag),R.addEventListener("selectstart",Ar,!1)),A.handleNumbers.forEach(function(we){Oe("start",we)})}}function zl(k){k.stopPropagation();var A=Qt(k.calcPoint),$=gi(A);$!==!1&&(e.events.snap||Tr(l,e.cssClasses.tap,e.animationDuration),kt($,A,!0,!0),Yi(),Oe("slide",$,!0),Oe("update",$,!0),e.events.snap?Ki(k,{handleNumbers:[$]}):(Oe("change",$,!0),Oe("set",$,!0)))}function Kl(k){var A=Qt(k.calcPoint),$=d.getStep(A),q=d.fromStepping($);Object.keys(S).forEach(function(X){X.split(".")[0]==="hover"&&S[X].forEach(function(Q){Q.call(wi,q)})})}function Wl(k,A){if(Z()||V(A))return!1;var $=["Left","Right"],q=["Down","Up"],X=["PageDown","PageUp"],Q=["Home","End"];e.dir&&!e.ort?$.reverse():e.ort&&!e.dir&&(q.reverse(),X.reverse());var ne=k.key.replace("Arrow",""),ee=ne===X[0],we=ne===X[1],ye=ne===q[0]||ne===$[0]||ee,ke=ne===q[1]||ne===$[1]||we,Se=ne===Q[0],me=ne===Q[1];if(!ye&&!ke&&!Se&&!me)return!0;k.preventDefault();var Te;if(ke||ye){var De=ye?0:1,Me=Dn(A),Pe=Me[De];if(Pe===null)return!1;Pe===!1&&(Pe=d.getDefaultStep(g[A],ye,e.keyboardDefaultStep)),we||ee?Pe*=e.keyboardPageMultiplier:Pe*=e.keyboardMultiplier,Pe=Math.max(Pe,1e-7),Pe=(ye?-1:1)*Pe,Te=p[A]+Pe}else me?Te=e.spectrum.xVal[e.spectrum.xVal.length-1]:Te=e.spectrum.xVal[0];return kt(A,d.toStepping(Te),!0,!0),Oe("slide",A),Oe("update",A),Oe("change",A),Oe("set",A),!1}function Mn(k){k.fixed||c.forEach(function(A,$){lt(n.start,A.children[0],Ki,{handleNumbers:[$]})}),k.tap&&lt(n.start,o,zl,{}),k.hover&&lt(n.move,o,Kl,{hover:!0}),k.drag&&u.forEach(function(A,$){if(!(A===!1||$===0||$===u.length-1)){var q=c[$-1],X=c[$],Q=[A],ne=[q,X],ee=[$-1,$];je(A,e.cssClasses.draggable),k.fixed&&(Q.push(q.children[0]),Q.push(X.children[0])),k.dragAll&&(ne=c,ee=v),Q.forEach(function(we){lt(n.start,we,Ki,{handles:ne,handleNumbers:ee,connect:A})})}})}function Wi(k,A){S[k]=S[k]||[],S[k].push(A),k.split(".")[0]==="update"&&c.forEach(function($,q){Oe("update",q)})}function Gl(k){return k===mt.aria||k===mt.tooltips}function Zt(k){var A=k&&k.split(".")[0],$=A?k.substring(A.length):k;Object.keys(S).forEach(function(q){var X=q.split(".")[0],Q=q.substring(X.length);(!A||A===X)&&(!$||$===Q)&&(!Gl(Q)||$===Q)&&delete S[q]})}function Oe(k,A,$){Object.keys(S).forEach(function(q){var X=q.split(".")[0];k===X&&S[q].forEach(function(Q){Q.call(wi,p.map(e.format.to),A,p.slice(),$||!1,g.slice(),wi)})})}function vi(k,A,$,q,X,Q,ne){var ee;return c.length>1&&!e.events.unconstrained&&(q&&A>0&&(ee=d.getAbsoluteDistance(k[A-1],e.margin,!1),$=Math.max($,ee)),X&&A<c.length-1&&(ee=d.getAbsoluteDistance(k[A+1],e.margin,!0),$=Math.min($,ee))),c.length>1&&e.limit&&(q&&A>0&&(ee=d.getAbsoluteDistance(k[A-1],e.limit,!1),$=Math.min($,ee)),X&&A<c.length-1&&(ee=d.getAbsoluteDistance(k[A+1],e.limit,!0),$=Math.max($,ee))),e.padding&&(A===0&&(ee=d.getAbsoluteDistance(0,e.padding[0],!1),$=Math.max($,ee)),A===c.length-1&&(ee=d.getAbsoluteDistance(100,e.padding[1],!0),$=Math.min($,ee))),ne||($=d.getStep($)),$=Mr($),$===k[A]&&!Q?!1:$}function Gi(k,A){var $=e.ort;return($?A:k)+", "+($?k:A)}function Pn(k,A,$,q,X){var Q=$.slice(),ne=q[0],ee=e.events.smoothSteps,we=[!k,k],ye=[k,!k];q=q.slice(),k&&q.reverse(),q.length>1?q.forEach(function(Se,me){var Te=vi(Q,Se,Q[Se]+A,we[me],ye[me],!1,ee);Te===!1?A=0:(A=Te-Q[Se],Q[Se]=Te)}):we=ye=[!0];var ke=!1;q.forEach(function(Se,me){ke=kt(Se,$[Se]+A,we[me],ye[me],!1,ee)||ke}),ke&&(q.forEach(function(Se){Oe("update",Se),Oe("slide",Se)}),X!=null&&Oe("drag",ne))}function Ln(k,A){return e.dir?100-k-A:k}function Yl(k,A){g[k]=A,p[k]=d.fromStepping(A);var $=Ln(A,0)-T,q="translate("+Gi($+"%","0")+")";if(c[k].style[e.transformRule]=q,e.events.invertConnects&&g.length>1){var X=g.every(function(Q,ne,ee){return ne===0||Q>=ee[ne-1]});if(P!==!X){eo();return}}ei(k),ei(k+1),P&&(ei(k-1),ei(k+2))}function Yi(){v.forEach(function(k){var A=g[k]>50?-1:1,$=3+(c.length+A*k);c[k].style.zIndex=String($)})}function kt(k,A,$,q,X,Q){return X||(A=vi(g,k,A,$,q,!1,Q)),A===!1?!1:(Yl(k,A),!0)}function ei(k){if(u[k]){var A=g.slice();P&&A.sort(function(ee,we){return ee-we});var $=0,q=100;k!==0&&($=A[k-1]),k!==u.length-1&&(q=A[k]);var X=q-$,Q="translate("+Gi(Ln($,X)+"%","0")+")",ne="scale("+Gi(X/100,"1")+")";u[k].style[e.transformRule]=Q+" "+ne}}function Rn(k,A){return k===null||k===!1||k===void 0||(typeof k=="number"&&(k=String(k)),k=e.format.from(k),k!==!1&&(k=d.toStepping(k)),k===!1||isNaN(k))?g[A]:k}function bi(k,A,$){var q=Hi(k),X=g[0]===void 0;A=A===void 0?!0:A,e.animate&&!X&&Tr(l,e.cssClasses.tap,e.animationDuration),v.forEach(function(ee){kt(ee,Rn(q[ee],ee),!0,!1,$)});var Q=v.length===1?0:1;if(X&&d.hasNoSize()&&($=!0,g[0]=0,v.length>1)){var ne=100/(v.length-1);v.forEach(function(ee){g[ee]=ee*ne})}for(;Q<v.length;++Q)v.forEach(function(ee){kt(ee,g[ee],!0,!0,$)});Yi(),v.forEach(function(ee){Oe("update",ee),q[ee]!==null&&A&&Oe("set",ee)})}function xl(k){bi(e.start,k)}function Jl(k,A,$,q){if(k=Number(k),!(k>=0&&k<v.length))throw new Error("noUiSlider: invalid handle number, got: "+k);kt(k,Rn(A,k),!0,!0,q),Oe("update",k),$&&Oe("set",k)}function $n(k){if(k===void 0&&(k=!1),k)return p.length===1?p[0]:p.slice(0);var A=p.map(e.format.to);return A.length===1?A[0]:A}function Xl(){for(Zt(mt.aria),Zt(mt.tooltips),Object.keys(e.cssClasses).forEach(function(k){Ai(l,e.cssClasses[k])});l.firstChild;)l.removeChild(l.firstChild);delete l.noUiSlider}function Dn(k){var A=g[k],$=d.getNearbySteps(A),q=p[k],X=$.thisStep.step,Q=null;if(e.snap)return[q-$.stepBefore.startValue||null,$.stepAfter.startValue-q||null];X!==!1&&q+X>$.stepAfter.startValue&&(X=$.stepAfter.startValue-q),q>$.thisStep.startValue?Q=$.thisStep.step:$.stepBefore.step===!1?Q=!1:Q=q-$.stepBefore.highestStep,A===100?X=null:A===0&&(Q=null);var ne=d.countStepDecimals();return X!==null&&X!==!1&&(X=Number(X.toFixed(ne))),Q!==null&&Q!==!1&&(Q=Number(Q.toFixed(ne))),[Q,X]}function Ql(){return v.map(Dn)}function Zl(k,A){var $=$n(),q=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];q.forEach(function(Q){k[Q]!==void 0&&(t[Q]=k[Q])});var X=kl(t);q.forEach(function(Q){k[Q]!==void 0&&(e[Q]=X[Q])}),d=X.spectrum,e.margin=X.margin,e.limit=X.limit,e.padding=X.padding,e.pips?Jt(e.pips):xt(),e.tooltips?B():z(),g=[],bi(on(k.start)?k.start:$,A),k.connect&&Nn()}function Nn(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var k=0;k<=e.handles;k++)u[k]=Y(a,e.connect[k]),ei(k);Mn({drag:e.events.drag,fixed:!0})}function eo(){P=!P,wl(e,e.connect.map(function(k){return!k})),Nn()}function to(){o=U(l),se(e.connect,o),Mn(e.events),bi(e.start),e.pips&&Jt(e.pips),e.tooltips&&B(),te()}to();var wi={destroy:Xl,steps:Ql,on:Wi,off:Zt,get:$n,set:bi,setHandle:Jl,reset:xl,disable:H,enable:re,__moveHandles:function(k,A,$){Pn(k,A,g,$)},options:t,updateOptions:Zl,target:l,removePips:xt,removeTooltips:z,getPositions:function(){return g.slice()},getTooltips:function(){return f},getOrigins:function(){return c},pips:Jt};return wi}function zc(i,e){if(!i||!i.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+i);if(i.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var t=kl(e),n=qc(i,t,e);return i.noUiSlider=n,n}const Kc={__spectrum:vl,cssClasses:bl,create:zc};function Wc(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v;return{c(){e=b("div"),t=b("span"),n=J(i[2]),r=J(" ("),s=J(i[3]),l=J(")"),o=D(),a=b("div"),c=b("span"),u=J(i[0]),h=D(),f=b("div"),d=b("div"),p=D(),g=b("span"),v=J(i[1]),m(c,"class","range-marker svelte-216mtn"),m(d,"class","slider"),m(d,"id",i[4]),m(f,"class","slider-wrapper svelte-216mtn"),m(g,"class","range-marker svelte-216mtn"),m(a,"class","slider-outer-wrapper is-flex flex-direction-row svelte-216mtn")},m(w,S){C(w,e,S),_(e,t),_(t,n),_(t,r),_(t,s),_(t,l),_(e,o),_(e,a),_(a,c),_(c,u),_(a,h),_(a,f),_(f,d),_(a,p),_(a,g),_(g,v)},p(w,[S]){S&4&&fe(n,w[2]),S&8&&fe(s,w[3]),S&1&&fe(u,w[0]),S&2&&fe(v,w[1])},i:j,o:j,d(w){w&&E(e)}}}function Gc(i,e,t){let n,{minVal:r}=e,{maxVal:s}=e,{start:l}=e,{step:o=void 0}=e,{roundTo:a=2}=e,{title:c=""}=e,{emitOnUpdate:u=!1}=e;const h=Kt(),f=`slider-${window.crypto.randomUUID()}`,d=Array.isArray(l)&&l.length===2&&l.every(y=>!isNaN(parseFloat(y))),p=[],g=d?[`noUi-handle-${window.crypto.randomUUID()}`,`noUi-handle-${window.crypto.randomUUID()}`]:[`noUi-handle-${window.crypto.randomUUID()}`],v=Ri();v.setCompareFn(d?kn:(y,F)=>S(y)===S(F)),v.set(l);const w=Je("resetTrigger")||void 0;w==null||w.subscribe(I);const S=y=>Number(y.toFixed(a)),P=(y,F)=>{y=Array.isArray(y)?y.map(S):S(y),t(3,n=y),(F==="set"||F==="update"&&u)&&(v.set(y),v.same()||h("updateSlider",v.get()))};function M(y){p.length&&p.map((F,Y)=>F.$set({tooltipText:d?y[Y]:y}))}function I(){const y=document.getElementById(f);y!=null&&y.noUiSlider&&y.noUiSlider.reset()}function R(){const y=document.getElementById(f);let F;Kc.create(y,{start:l,step:o,connect:d?!0:"lower",range:{min:r,max:s},handleAttributes:g.map(Y=>({id:Y}))}),y.noUiSlider.on("update",()=>{F=y.noUiSlider.get(!0),P(F,"update")}),y.noUiSlider.on("set",()=>{F=y.noUiSlider.get(!0),P(F,"set")})}function T(){g.map((y,F)=>{p.push(new mi({target:document.getElementById(y),props:d?{tooltipText:n[F]}:{tooltipText:n}}))})}return st(()=>{R(),T()}),di(()=>{document.getElementById(f)&&(document.getElementById(f).innerHTML="")}),i.$$set=y=>{"minVal"in y&&t(0,r=y.minVal),"maxVal"in y&&t(1,s=y.maxVal),"start"in y&&t(5,l=y.start),"step"in y&&t(6,o=y.step),"roundTo"in y&&t(7,a=y.roundTo),"title"in y&&t(2,c=y.title),"emitOnUpdate"in y&&t(8,u=y.emitOnUpdate)},i.$$.update=()=>{i.$$.dirty&32&&t(3,n=l),i.$$.dirty&8&&M(n)},[r,s,c,n,f,l,o,a,u]}class Et extends ae{constructor(e){super(),oe(this,e,Gc,Wc,le,{minVal:0,maxVal:1,start:5,step:6,roundTo:7,title:2,emitOnUpdate:8})}}/*! choices.js v11.1.0 | © 2025 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var cn=function(i,e){return cn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])},cn(i,e)};function Sl(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");cn(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var We=function(){return We=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},We.apply(this,arguments)};function Yc(i,e,t){if(t||arguments.length===2)for(var n=0,r=e.length,s;n<r;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return i.concat(s||Array.prototype.slice.call(e))}var Ae={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},Ke={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},Ne={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},xc=["fuseOptions","classNames"],_t={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},Lr=function(i){return{type:Ae.ADD_CHOICE,choice:i}},Jc=function(i){return{type:Ae.REMOVE_CHOICE,choice:i}},Xc=function(i){return{type:Ae.FILTER_CHOICES,results:i}},Qc=function(i){return{type:Ae.ACTIVATE_CHOICES,active:i}},Zc=function(i){return{type:Ae.ADD_GROUP,group:i}},Rr=function(i){return{type:Ae.ADD_ITEM,item:i}},$r=function(i){return{type:Ae.REMOVE_ITEM,item:i}},Ei=function(i,e){return{type:Ae.HIGHLIGHT_ITEM,item:i,highlighted:e}},eu=function(i,e){return Math.floor(Math.random()*(e-i)+i)},Dr=function(i){return Array.from({length:i},function(){return eu(0,36).toString(36)}).join("")},tu=function(i,e){var t=i.id||i.name&&"".concat(i.name,"-").concat(Dr(2))||Dr(4);return t=t.replace(/(:|\.|\[|\]|,)/g,""),t="".concat(e,"-").concat(t),t},iu=function(i,e,t){t===void 0&&(t=1);for(var n="".concat(t>0?"next":"previous","ElementSibling"),r=i[n];r;){if(r.matches(e))return r;r=r[n]}return null},nu=function(i,e,t){t===void 0&&(t=1);var n;return t>0?n=e.scrollTop+e.offsetHeight>=i.offsetTop+i.offsetHeight:n=i.offsetTop>=e.scrollTop,n},Bi=function(i){if(typeof i!="string"){if(i==null)return"";if(typeof i=="object"){if("raw"in i)return Bi(i.raw);if("trusted"in i)return i.trusted}return i}return i.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},ru=function(){var i=document.createElement("div");return function(e){i.innerHTML=e.trim();for(var t=i.children[0];i.firstChild;)i.removeChild(i.firstChild);return t}}(),oi=function(i,e){return typeof i=="function"?i(Bi(e),e):i},Nr=function(i){return typeof i=="function"?i():i},It=function(i){if(typeof i=="string")return i;if(typeof i=="object"){if("trusted"in i)return i.trusted;if("raw"in i)return i.raw}return""},El=function(i){if(typeof i=="string")return i;if(typeof i=="object"){if("escaped"in i)return i.escaped;if("trusted"in i)return i.trusted}return""},On=function(i,e){return i?El(e):Bi(e)},ot=function(i,e,t){i.innerHTML=On(e,t)},su=function(i,e){var t=i.value,n=i.label,r=n===void 0?t:n,s=e.value,l=e.label,o=l===void 0?s:l;return It(r).localeCompare(It(o),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},lu=function(i,e){return i.rank-e.rank},ou=function(i,e,t){t===void 0&&(t=null);var n=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0});return i.dispatchEvent(n)},au=function(i,e){var t=Object.keys(i).sort(),n=Object.keys(e).sort();return t.filter(function(r){return n.indexOf(r)<0})},qi=function(i){return Array.isArray(i)?i:[i]},ni=function(i){return i&&Array.isArray(i)?i.map(function(e){return".".concat(e)}).join(""):".".concat(i)},de=function(i,e){var t;(t=i.classList).add.apply(t,qi(e))},it=function(i,e){var t;(t=i.classList).remove.apply(t,qi(e))},cu=function(i){if(typeof i<"u")try{return JSON.parse(i)}catch{return i}return{}},uu=function(i,e,t){var n=i.itemEl;n&&(it(n,t),de(n,e))},fu=function(){function i(e){var t=e.element,n=e.type,r=e.classNames;this.element=t,this.classNames=r,this.type=n,this.isActive=!1}return i.prototype.show=function(){return de(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},i.prototype.hide=function(){return it(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},i}(),jr=function(){function i(e){var t=e.element,n=e.type,r=e.classNames,s=e.position;this.element=t,this.classNames=r,this.type=n,this.position=s,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return i.prototype.shouldFlip=function(e,t){var n=!1;return this.position==="auto"?n=this.element.getBoundingClientRect().top-t>=0&&!window.matchMedia("(min-height: ".concat(e+1,"px)")).matches:this.position==="top"&&(n=!0),n},i.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},i.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},i.prototype.open=function(e,t){de(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e,t)&&(de(this.element,this.classNames.flippedState),this.isFlipped=!0)},i.prototype.close=function(){it(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(it(this.element,this.classNames.flippedState),this.isFlipped=!1)},i.prototype.addFocusState=function(){de(this.element,this.classNames.focusState)},i.prototype.removeFocusState=function(){it(this.element,this.classNames.focusState)},i.prototype.enable=function(){it(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===_t.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},i.prototype.disable=function(){de(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===_t.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},i.prototype.wrap=function(e){var t=this.element,n=e.parentNode;n&&(e.nextSibling?n.insertBefore(t,e.nextSibling):n.appendChild(t)),t.appendChild(e)},i.prototype.unwrap=function(e){var t=this.element,n=t.parentNode;n&&(n.insertBefore(e,t),n.removeChild(t))},i.prototype.addLoadingState=function(){de(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},i.prototype.removeLoadingState=function(){it(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},i}(),du=function(){function i(e){var t=e.element,n=e.type,r=e.classNames,s=e.preventPaste;this.element=t,this.type=n,this.classNames=r,this.preventPaste=s,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=t.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(i.prototype,"placeholder",{set:function(e){this.element.placeholder=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!1,configurable:!0}),i.prototype.addEventListeners=function(){var e=this.element;e.addEventListener("paste",this._onPaste),e.addEventListener("input",this._onInput,{passive:!0}),e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})},i.prototype.removeEventListeners=function(){var e=this.element;e.removeEventListener("input",this._onInput),e.removeEventListener("paste",this._onPaste),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)},i.prototype.enable=function(){var e=this.element;e.removeAttribute("disabled"),this.isDisabled=!1},i.prototype.disable=function(){var e=this.element;e.setAttribute("disabled",""),this.isDisabled=!0},i.prototype.focus=function(){this.isFocussed||this.element.focus()},i.prototype.blur=function(){this.isFocussed&&this.element.blur()},i.prototype.clear=function(e){return e===void 0&&(e=!0),this.element.value="",e&&this.setWidth(),this},i.prototype.setWidth=function(){var e=this.element;e.style.minWidth="".concat(e.placeholder.length+1,"ch"),e.style.width="".concat(e.value.length+1,"ch")},i.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},i.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},i.prototype._onInput=function(){this.type!==_t.SelectOne&&this.setWidth()},i.prototype._onPaste=function(e){this.preventPaste&&e.preventDefault()},i.prototype._onFocus=function(){this.isFocussed=!0},i.prototype._onBlur=function(){this.isFocussed=!1},i}(),hu=4,Vr=function(){function i(e){var t=e.element;this.element=t,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return i.prototype.prepend=function(e){var t=this.element.firstElementChild;t?this.element.insertBefore(e,t):this.element.append(e)},i.prototype.scrollToTop=function(){this.element.scrollTop=0},i.prototype.scrollToChildElement=function(e,t){var n=this;if(e){var r=this.element.offsetHeight,s=this.element.scrollTop+r,l=e.offsetHeight,o=e.offsetTop+l,a=t>0?this.element.scrollTop+o-s:e.offsetTop;requestAnimationFrame(function(){n._animateScroll(a,t)})}},i.prototype._scrollDown=function(e,t,n){var r=(n-e)/t,s=r>1?r:1;this.element.scrollTop=e+s},i.prototype._scrollUp=function(e,t,n){var r=(e-n)/t,s=r>1?r:1;this.element.scrollTop=e-s},i.prototype._animateScroll=function(e,t){var n=this,r=hu,s=this.element.scrollTop,l=!1;t>0?(this._scrollDown(s,r,e),s<e&&(l=!0)):(this._scrollUp(s,r,e),s>e&&(l=!0)),l&&requestAnimationFrame(function(){n._animateScroll(e,t)})},i}(),Cl=function(){function i(e){var t=e.element,n=e.classNames;this.element=t,this.classNames=n,this.isDisabled=!1}return Object.defineProperty(i.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.setAttribute("value",e),this.element.value=e},enumerable:!1,configurable:!0}),i.prototype.conceal=function(){var e=this.element;de(e,this.classNames.input),e.hidden=!0,e.tabIndex=-1;var t=e.getAttribute("style");t&&e.setAttribute("data-choice-orig-style",t),e.setAttribute("data-choice","active")},i.prototype.reveal=function(){var e=this.element;it(e,this.classNames.input),e.hidden=!1,e.removeAttribute("tabindex");var t=e.getAttribute("data-choice-orig-style");t?(e.removeAttribute("data-choice-orig-style"),e.setAttribute("style",t)):e.removeAttribute("style"),e.removeAttribute("data-choice")},i.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},i.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},i.prototype.triggerEvent=function(e,t){ou(this.element,e,t||{})},i}(),mu=function(i){Sl(e,i);function e(){return i!==null&&i.apply(this,arguments)||this}return e}(Cl),li=function(i,e){return e===void 0&&(e=!0),typeof i>"u"?e:!!i},Il=function(i){if(typeof i=="string"&&(i=i.split(" ").filter(function(e){return e.length})),Array.isArray(i)&&i.length)return i},tt=function(i,e,t){if(t===void 0&&(t=!0),typeof i=="string"){var n=Bi(i),r=t||n===i?i:{escaped:n,raw:i},s=tt({value:i,label:r,selected:!0},!1);return s}var l=i;if("choices"in l){if(!e)throw new TypeError("optGroup is not allowed");var o=l,a=o.choices.map(function(f){return tt(f,!1)}),c={id:0,label:It(o.label)||o.value,active:!!a.length,disabled:!!o.disabled,choices:a};return c}var u=l,h={id:0,group:null,score:0,rank:0,value:u.value,label:u.label||u.value,active:li(u.active),selected:li(u.selected,!1),disabled:li(u.disabled,!1),placeholder:li(u.placeholder,!1),highlighted:!1,labelClass:Il(u.labelClass),labelDescription:u.labelDescription,customProperties:u.customProperties};return h},pu=function(i){return i.tagName==="INPUT"},Ol=function(i){return i.tagName==="SELECT"},gu=function(i){return i.tagName==="OPTION"},_u=function(i){return i.tagName==="OPTGROUP"},vu=function(i){Sl(e,i);function e(t){var n=t.element,r=t.classNames,s=t.template,l=t.extractPlaceholder,o=i.call(this,{element:n,classNames:r})||this;return o.template=s,o.extractPlaceholder=l,o}return Object.defineProperty(e.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),e.prototype.addOptions=function(t){var n=this,r=document.createDocumentFragment();t.forEach(function(s){var l=s;if(!l.element){var o=n.template(l);r.appendChild(o),l.element=o}}),this.element.appendChild(r)},e.prototype.optionsAsChoices=function(){var t=this,n=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(r){gu(r)?n.push(t._optionToChoice(r)):_u(r)&&n.push(t._optgroupToChoice(r))}),n},e.prototype._optionToChoice=function(t){return!t.hasAttribute("value")&&t.hasAttribute("placeholder")&&(t.setAttribute("value",""),t.value=""),{id:0,group:null,score:0,rank:0,value:t.value,label:t.label,element:t,active:!0,selected:this.extractPlaceholder?t.selected:t.hasAttribute("selected"),disabled:t.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!t.value||t.hasAttribute("placeholder")),labelClass:typeof t.dataset.labelClass<"u"?Il(t.dataset.labelClass):void 0,labelDescription:typeof t.dataset.labelDescription<"u"?t.dataset.labelDescription:void 0,customProperties:cu(t.dataset.customProperties)}},e.prototype._optgroupToChoice=function(t){var n=this,r=t.querySelectorAll("option"),s=Array.from(r).map(function(l){return n._optionToChoice(l)});return{id:0,label:t.label||"",element:t,active:!!s.length,disabled:t.disabled,choices:s}},e}(Cl),bu={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},Fr={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(i){return!!i&&i!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:su,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(i){return'Press Enter to add <b>"'.concat(i,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(i){return"Remove item: ".concat(i)},maxItemText:function(i){return"Only ".concat(i," values can be added")},valueComparer:function(i,e){return i===e},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:bu,appendGroupInSearch:!1},Ur=function(i){var e=i.itemEl;e&&(e.remove(),i.itemEl=void 0)};function wu(i,e,t){var n=i,r=!0;switch(e.type){case Ae.ADD_ITEM:{e.item.selected=!0;var s=e.item.element;s&&(s.selected=!0,s.setAttribute("selected","")),n.push(e.item);break}case Ae.REMOVE_ITEM:{e.item.selected=!1;var s=e.item.element;if(s){s.selected=!1,s.removeAttribute("selected");var l=s.parentElement;l&&Ol(l)&&l.type===_t.SelectOne&&(l.value="")}Ur(e.item),n=n.filter(function(u){return u.id!==e.item.id});break}case Ae.REMOVE_CHOICE:{Ur(e.choice),n=n.filter(function(c){return c.id!==e.choice.id});break}case Ae.HIGHLIGHT_ITEM:{var o=e.highlighted,a=n.find(function(c){return c.id===e.item.id});a&&a.highlighted!==o&&(a.highlighted=o,t&&uu(a,o?t.classNames.highlightedState:t.classNames.selectedState,o?t.classNames.selectedState:t.classNames.highlightedState));break}default:{r=!1;break}}return{state:n,update:r}}function yu(i,e){var t=i,n=!0;switch(e.type){case Ae.ADD_GROUP:{t.push(e.group);break}case Ae.CLEAR_CHOICES:{t=[];break}default:{n=!1;break}}return{state:t,update:n}}function ku(i,e,t){var n=i,r=!0;switch(e.type){case Ae.ADD_CHOICE:{n.push(e.choice);break}case Ae.REMOVE_CHOICE:{e.choice.choiceEl=void 0,e.choice.group&&(e.choice.group.choices=e.choice.group.choices.filter(function(l){return l.id!==e.choice.id})),n=n.filter(function(l){return l.id!==e.choice.id});break}case Ae.ADD_ITEM:case Ae.REMOVE_ITEM:{e.item.choiceEl=void 0;break}case Ae.FILTER_CHOICES:{var s=[];e.results.forEach(function(l){s[l.item.id]=l}),n.forEach(function(l){var o=s[l.id];o!==void 0?(l.score=o.score,l.rank=o.rank,l.active=!0):(l.score=0,l.rank=0,l.active=!1),t&&t.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ae.ACTIVATE_CHOICES:{n.forEach(function(l){l.active=e.active,t&&t.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ae.CLEAR_CHOICES:{n=[];break}default:{r=!1;break}}return{state:n,update:r}}var Hr={groups:yu,items:wu,choices:ku},Su=function(){function i(e){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=e}return Object.defineProperty(i.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),i.prototype.changeSet=function(e){return{groups:e,items:e,choices:e}},i.prototype.reset=function(){this._state=this.defaultState;var e=this.changeSet(!0);this._txn?this._changeSet=e:this._listeners.forEach(function(t){return t(e)})},i.prototype.subscribe=function(e){return this._listeners.push(e),this},i.prototype.dispatch=function(e){var t=this,n=this._state,r=!1,s=this._changeSet||this.changeSet(!1);Object.keys(Hr).forEach(function(l){var o=Hr[l](n[l],e,t._context);o.update&&(r=!0,s[l]=!0,n[l]=o.state)}),r&&(this._txn?this._changeSet=s:this._listeners.forEach(function(l){return l(s)}))},i.prototype.withTxn=function(e){this._txn++;try{e()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var t=this._changeSet;t&&(this._changeSet=void 0,this._listeners.forEach(function(n){return n(t)}))}}},Object.defineProperty(i.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(e){return e.active&&e.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"activeChoices",{get:function(){return this.choices.filter(function(e){return e.active})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(e){return!e.disabled&&!e.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"activeGroups",{get:function(){var e=this;return this.state.groups.filter(function(t){var n=t.active&&!t.disabled,r=e.state.choices.some(function(s){return s.active&&!s.disabled});return n&&r},[])},enumerable:!1,configurable:!0}),i.prototype.inTxn=function(){return this._txn>0},i.prototype.getChoiceById=function(e){return this.activeChoices.find(function(t){return t.id===e})},i.prototype.getGroupById=function(e){return this.groups.find(function(t){return t.id===e})},i}(),Le={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Eu(i,e,t){return(e=Iu(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Br(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Lt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Br(Object(t),!0).forEach(function(n){Eu(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Br(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Cu(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Iu(i){var e=Cu(i,"string");return typeof e=="symbol"?e:e+""}function ht(i){return Array.isArray?Array.isArray(i):Ml(i)==="[object Array]"}const Ou=1/0;function Au(i){if(typeof i=="string")return i;let e=i+"";return e=="0"&&1/i==-Ou?"-0":e}function Tu(i){return i==null?"":Au(i)}function nt(i){return typeof i=="string"}function Al(i){return typeof i=="number"}function Mu(i){return i===!0||i===!1||Pu(i)&&Ml(i)=="[object Boolean]"}function Tl(i){return typeof i=="object"}function Pu(i){return Tl(i)&&i!==null}function Ge(i){return i!=null}function tn(i){return!i.trim().length}function Ml(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}const Lu="Incorrect 'index' type",Ru=i=>`Invalid value for key ${i}`,$u=i=>`Pattern length exceeds max of ${i}.`,Du=i=>`Missing ${i} property in key`,Nu=i=>`Property 'weight' in key '${i}' must be a positive integer`,qr=Object.prototype.hasOwnProperty;class ju{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(n=>{let r=Pl(n);this._keys.push(r),this._keyMap[r.id]=r,t+=r.weight}),this._keys.forEach(n=>{n.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Pl(i){let e=null,t=null,n=null,r=1,s=null;if(nt(i)||ht(i))n=i,e=zr(i),t=un(i);else{if(!qr.call(i,"name"))throw new Error(Du("name"));const l=i.name;if(n=l,qr.call(i,"weight")&&(r=i.weight,r<=0))throw new Error(Nu(l));e=zr(l),t=un(l),s=i.getFn}return{path:e,id:t,weight:r,src:n,getFn:s}}function zr(i){return ht(i)?i:i.split(".")}function un(i){return ht(i)?i.join("."):i}function Vu(i,e){let t=[],n=!1;const r=(s,l,o)=>{if(Ge(s))if(!l[o])t.push(s);else{let a=l[o];const c=s[a];if(!Ge(c))return;if(o===l.length-1&&(nt(c)||Al(c)||Mu(c)))t.push(Tu(c));else if(ht(c)){n=!0;for(let u=0,h=c.length;u<h;u+=1)r(c[u],l,o+1)}else l.length&&r(c,l,o+1)}};return r(i,nt(e)?e.split("."):e,0),n?t:t[0]}const Fu={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Uu={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(i,e)=>i.score===e.score?i.idx<e.idx?-1:1:i.score<e.score?-1:1},Hu={location:0,threshold:.6,distance:100},Bu={useExtendedSearch:!1,getFn:Vu,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var ce=Lt(Lt(Lt(Lt({},Uu),Fu),Hu),Bu);const qu=/[^ ]+/g;function zu(i=1,e=3){const t=new Map,n=Math.pow(10,e);return{get(r){const s=r.match(qu).length;if(t.has(s))return t.get(s);const l=1/Math.pow(s,.5*i),o=parseFloat(Math.round(l*n)/n);return t.set(s,o),o},clear(){t.clear()}}}class An{constructor({getFn:e=ce.getFn,fieldNormWeight:t=ce.fieldNormWeight}={}){this.norm=zu(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,n)=>{this._keysMap[t.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,nt(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();nt(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Ge(e)||tn(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((r,s)=>{let l=r.getFn?r.getFn(e):this.getFn(e,r.path);if(Ge(l)){if(ht(l)){let o=[];const a=[{nestedArrIndex:-1,value:l}];for(;a.length;){const{nestedArrIndex:c,value:u}=a.pop();if(Ge(u))if(nt(u)&&!tn(u)){let h={v:u,i:c,n:this.norm.get(u)};o.push(h)}else ht(u)&&u.forEach((h,f)=>{a.push({nestedArrIndex:f,value:h})})}n.$[s]=o}else if(nt(l)&&!tn(l)){let o={v:l,n:this.norm.get(l)};n.$[s]=o}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function Ll(i,e,{getFn:t=ce.getFn,fieldNormWeight:n=ce.fieldNormWeight}={}){const r=new An({getFn:t,fieldNormWeight:n});return r.setKeys(i.map(Pl)),r.setSources(e),r.create(),r}function Ku(i,{getFn:e=ce.getFn,fieldNormWeight:t=ce.fieldNormWeight}={}){const{keys:n,records:r}=i,s=new An({getFn:e,fieldNormWeight:t});return s.setKeys(n),s.setIndexRecords(r),s}function Ci(i,{errors:e=0,currentLocation:t=0,expectedLocation:n=0,distance:r=ce.distance,ignoreLocation:s=ce.ignoreLocation}={}){const l=e/i.length;if(s)return l;const o=Math.abs(n-t);return r?l+o/r:o?1:l}function Wu(i=[],e=ce.minMatchCharLength){let t=[],n=-1,r=-1,s=0;for(let l=i.length;s<l;s+=1){let o=i[s];o&&n===-1?n=s:!o&&n!==-1&&(r=s-1,r-n+1>=e&&t.push([n,r]),n=-1)}return i[s-1]&&s-n>=e&&t.push([n,s-1]),t}const Ct=32;function Gu(i,e,t,{location:n=ce.location,distance:r=ce.distance,threshold:s=ce.threshold,findAllMatches:l=ce.findAllMatches,minMatchCharLength:o=ce.minMatchCharLength,includeMatches:a=ce.includeMatches,ignoreLocation:c=ce.ignoreLocation}={}){if(e.length>Ct)throw new Error($u(Ct));const u=e.length,h=i.length,f=Math.max(0,Math.min(n,h));let d=s,p=f;const g=o>1||a,v=g?Array(h):[];let w;for(;(w=i.indexOf(e,p))>-1;){let T=Ci(e,{currentLocation:w,expectedLocation:f,distance:r,ignoreLocation:c});if(d=Math.min(T,d),p=w+u,g){let y=0;for(;y<u;)v[w+y]=1,y+=1}}p=-1;let S=[],P=1,M=u+h;const I=1<<u-1;for(let T=0;T<u;T+=1){let y=0,F=M;for(;y<F;)Ci(e,{errors:T,currentLocation:f+F,expectedLocation:f,distance:r,ignoreLocation:c})<=d?y=F:M=F,F=Math.floor((M-y)/2+y);M=F;let Y=Math.max(1,f-F+1),se=l?h:Math.min(f+F,h)+u,U=Array(se+2);U[se+1]=(1<<T)-1;for(let Z=se;Z>=Y;Z-=1){let V=Z-1,H=t[i.charAt(V)];if(g&&(v[V]=+!!H),U[Z]=(U[Z+1]<<1|1)&H,T&&(U[Z]|=(S[Z+1]|S[Z])<<1|1|S[Z+1]),U[Z]&I&&(P=Ci(e,{errors:T,currentLocation:V,expectedLocation:f,distance:r,ignoreLocation:c}),P<=d)){if(d=P,p=V,p<=f)break;Y=Math.max(1,2*f-p)}}if(Ci(e,{errors:T+1,currentLocation:f,expectedLocation:f,distance:r,ignoreLocation:c})>d)break;S=U}const R={isMatch:p>=0,score:Math.max(.001,P)};if(g){const T=Wu(v,o);T.length?a&&(R.indices=T):R.isMatch=!1}return R}function Yu(i){let e={};for(let t=0,n=i.length;t<n;t+=1){const r=i.charAt(t);e[r]=(e[r]||0)|1<<n-t-1}return e}class Rl{constructor(e,{location:t=ce.location,threshold:n=ce.threshold,distance:r=ce.distance,includeMatches:s=ce.includeMatches,findAllMatches:l=ce.findAllMatches,minMatchCharLength:o=ce.minMatchCharLength,isCaseSensitive:a=ce.isCaseSensitive,ignoreLocation:c=ce.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:r,includeMatches:s,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(f,d)=>{this.chunks.push({pattern:f,alphabet:Yu(f),startIndex:d})},h=this.pattern.length;if(h>Ct){let f=0;const d=h%Ct,p=h-d;for(;f<p;)u(this.pattern.substr(f,Ct),f),f+=Ct;if(d){const g=h-Ct;u(this.pattern.substr(g),g)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,includeMatches:n}=this.options;if(t||(e=e.toLowerCase()),this.pattern===e){let p={isMatch:!0,score:0};return n&&(p.indices=[[0,e.length-1]]),p}const{location:r,distance:s,threshold:l,findAllMatches:o,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],h=0,f=!1;this.chunks.forEach(({pattern:p,alphabet:g,startIndex:v})=>{const{isMatch:w,score:S,indices:P}=Gu(e,p,g,{location:r+v,distance:s,threshold:l,findAllMatches:o,minMatchCharLength:a,includeMatches:n,ignoreLocation:c});w&&(f=!0),h+=S,w&&P&&(u=[...u,...P])});let d={isMatch:f,score:f?h/this.chunks.length:1};return f&&n&&(d.indices=u),d}}class yt{constructor(e){this.pattern=e}static isMultiMatch(e){return Kr(e,this.multiRegex)}static isSingleMatch(e){return Kr(e,this.singleRegex)}search(){}}function Kr(i,e){const t=i.match(e);return t?t[1]:null}class xu extends yt{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Ju extends yt{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class Xu extends yt{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Qu extends yt{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class Zu extends yt{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class ef extends yt{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class $l extends yt{constructor(e,{location:t=ce.location,threshold:n=ce.threshold,distance:r=ce.distance,includeMatches:s=ce.includeMatches,findAllMatches:l=ce.findAllMatches,minMatchCharLength:o=ce.minMatchCharLength,isCaseSensitive:a=ce.isCaseSensitive,ignoreLocation:c=ce.ignoreLocation}={}){super(e),this._bitapSearch=new Rl(e,{location:t,threshold:n,distance:r,includeMatches:s,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Dl extends yt{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n;const r=[],s=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+s,r.push([n,t-1]);const l=!!r.length;return{isMatch:l,score:l?0:1,indices:r}}}const fn=[xu,Dl,Xu,Qu,ef,Zu,Ju,$l],Wr=fn.length,tf=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,nf="|";function rf(i,e={}){return i.split(nf).map(t=>{let n=t.trim().split(tf).filter(s=>s&&!!s.trim()),r=[];for(let s=0,l=n.length;s<l;s+=1){const o=n[s];let a=!1,c=-1;for(;!a&&++c<Wr;){const u=fn[c];let h=u.isMultiMatch(o);h&&(r.push(new u(h,e)),a=!0)}if(!a)for(c=-1;++c<Wr;){const u=fn[c];let h=u.isSingleMatch(o);if(h){r.push(new u(h,e));break}}}return r})}const sf=new Set([$l.type,Dl.type]);class lf{constructor(e,{isCaseSensitive:t=ce.isCaseSensitive,includeMatches:n=ce.includeMatches,minMatchCharLength:r=ce.minMatchCharLength,ignoreLocation:s=ce.ignoreLocation,findAllMatches:l=ce.findAllMatches,location:o=ce.location,threshold:a=ce.threshold,distance:c=ce.distance}={}){this.query=null,this.options={isCaseSensitive:t,includeMatches:n,minMatchCharLength:r,findAllMatches:l,ignoreLocation:s,location:o,threshold:a,distance:c},this.pattern=t?e:e.toLowerCase(),this.query=rf(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:r}=this.options;e=r?e:e.toLowerCase();let s=0,l=[],o=0;for(let a=0,c=t.length;a<c;a+=1){const u=t[a];l.length=0,s=0;for(let h=0,f=u.length;h<f;h+=1){const d=u[h],{isMatch:p,indices:g,score:v}=d.search(e);if(p){if(s+=1,o+=v,n){const w=d.constructor.type;sf.has(w)?l=[...l,...g]:l.push(g)}}else{o=0,s=0,l.length=0;break}}if(s){let h={isMatch:!0,score:o/s};return n&&(h.indices=l),h}}return{isMatch:!1,score:1}}}const dn=[];function of(...i){dn.push(...i)}function hn(i,e){for(let t=0,n=dn.length;t<n;t+=1){let r=dn[t];if(r.condition(i,e))return new r(i,e)}return new Rl(i,e)}const ji={AND:"$and",OR:"$or"},mn={PATH:"$path",PATTERN:"$val"},pn=i=>!!(i[ji.AND]||i[ji.OR]),af=i=>!!i[mn.PATH],cf=i=>!ht(i)&&Tl(i)&&!pn(i),Gr=i=>({[ji.AND]:Object.keys(i).map(e=>({[e]:i[e]}))});function Nl(i,e,{auto:t=!0}={}){const n=r=>{let s=Object.keys(r);const l=af(r);if(!l&&s.length>1&&!pn(r))return n(Gr(r));if(cf(r)){const a=l?r[mn.PATH]:s[0],c=l?r[mn.PATTERN]:r[a];if(!nt(c))throw new Error(Ru(a));const u={keyId:un(a),pattern:c};return t&&(u.searcher=hn(c,e)),u}let o={children:[],operator:s[0]};return s.forEach(a=>{const c=r[a];ht(c)&&c.forEach(u=>{o.children.push(n(u))})}),o};return pn(i)||(i=Gr(i)),n(i)}function uf(i,{ignoreFieldNorm:e=ce.ignoreFieldNorm}){i.forEach(t=>{let n=1;t.matches.forEach(({key:r,norm:s,score:l})=>{const o=r?r.weight:null;n*=Math.pow(l===0&&o?Number.EPSILON:l,(o||1)*(e?1:s))}),t.score=n})}function ff(i,e){const t=i.matches;e.matches=[],Ge(t)&&t.forEach(n=>{if(!Ge(n.indices)||!n.indices.length)return;const{indices:r,value:s}=n;let l={indices:r,value:s};n.key&&(l.key=n.key.src),n.idx>-1&&(l.refIndex=n.idx),e.matches.push(l)})}function df(i,e){e.score=i.score}function hf(i,e,{includeMatches:t=ce.includeMatches,includeScore:n=ce.includeScore}={}){const r=[];return t&&r.push(ff),n&&r.push(df),i.map(s=>{const{idx:l}=s,o={item:e[l],refIndex:l};return r.length&&r.forEach(a=>{a(s,o)}),o})}class Wt{constructor(e,t={},n){this.options=Lt(Lt({},ce),t),this.options.useExtendedSearch,this._keyStore=new ju(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof An))throw new Error(Lu);this._myIndex=t||Ll(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Ge(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,r=this._docs.length;n<r;n+=1){const s=this._docs[n];e(s,n)&&(this.removeAt(n),n-=1,r-=1,t.push(s))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:r,shouldSort:s,sortFn:l,ignoreFieldNorm:o}=this.options;let a=nt(e)?nt(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return uf(a,{ignoreFieldNorm:o}),s&&a.sort(l),Al(t)&&t>-1&&(a=a.slice(0,t)),hf(a,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(e){const t=hn(e,this.options),{records:n}=this._myIndex,r=[];return n.forEach(({v:s,i:l,n:o})=>{if(!Ge(s))return;const{isMatch:a,score:c,indices:u}=t.searchIn(s);a&&r.push({item:s,idx:l,matches:[{score:c,value:s,norm:o,indices:u}]})}),r}_searchLogical(e){const t=Nl(e,this.options),n=(o,a,c)=>{if(!o.children){const{keyId:h,searcher:f}=o,d=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(a,h),searcher:f});return d&&d.length?[{idx:c,item:a,matches:d}]:[]}const u=[];for(let h=0,f=o.children.length;h<f;h+=1){const d=o.children[h],p=n(d,a,c);if(p.length)u.push(...p);else if(o.operator===ji.AND)return[]}return u},r=this._myIndex.records,s={},l=[];return r.forEach(({$:o,i:a})=>{if(Ge(o)){let c=n(t,o,a);c.length&&(s[a]||(s[a]={idx:a,item:o,matches:[]},l.push(s[a])),c.forEach(({matches:u})=>{s[a].matches.push(...u)}))}}),l}_searchObjectList(e){const t=hn(e,this.options),{keys:n,records:r}=this._myIndex,s=[];return r.forEach(({$:l,i:o})=>{if(!Ge(l))return;let a=[];n.forEach((c,u)=>{a.push(...this._findMatches({key:c,value:l[u],searcher:t}))}),a.length&&s.push({idx:o,item:l,matches:a})}),s}_findMatches({key:e,value:t,searcher:n}){if(!Ge(t))return[];let r=[];if(ht(t))t.forEach(({v:s,i:l,n:o})=>{if(!Ge(s))return;const{isMatch:a,score:c,indices:u}=n.searchIn(s);a&&r.push({score:c,key:e,value:s,idx:l,norm:o,indices:u})});else{const{v:s,n:l}=t,{isMatch:o,score:a,indices:c}=n.searchIn(s);o&&r.push({score:a,key:e,value:s,norm:l,indices:c})}return r}}Wt.version="7.0.0";Wt.createIndex=Ll;Wt.parseIndex=Ku;Wt.config=ce;Wt.parseQuery=Nl;of(lf);var mf=function(){function i(e){this._haystack=[],this._fuseOptions=We(We({},e.fuseOptions),{keys:Yc([],e.searchFields,!0),includeMatches:!0})}return i.prototype.index=function(e){this._haystack=e,this._fuse&&this._fuse.setCollection(e)},i.prototype.reset=function(){this._haystack=[],this._fuse=void 0},i.prototype.isEmptyIndex=function(){return!this._haystack.length},i.prototype.search=function(e){this._fuse||(this._fuse=new Wt(this._haystack,this._fuseOptions));var t=this._fuse.search(e);return t.map(function(n,r){return{item:n.item,score:n.score||0,rank:r+1}})},i}();function pf(i){return new mf(i)}var gf=function(i){for(var e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0},nn=function(i,e,t){var n=i.dataset,r=e.customProperties,s=e.labelClass,l=e.labelDescription;s&&(n.labelClass=qi(s).join(" ")),l&&(n.labelDescription=l),t&&r&&(typeof r=="string"?n.customProperties=r:typeof r=="object"&&!gf(r)&&(n.customProperties=JSON.stringify(r)))},Yr=function(i,e,t){var n=e&&i.querySelector("label[for='".concat(e,"']")),r=n&&n.innerText;r&&t.setAttribute("aria-label",r)},_f={containerOuter:function(i,e,t,n,r,s,l){var o=i.classNames.containerOuter,a=document.createElement("div");return de(a,o),a.dataset.type=s,e&&(a.dir=e),n&&(a.tabIndex=0),t&&(a.setAttribute("role",r?"combobox":"listbox"),r?a.setAttribute("aria-autocomplete","list"):l||Yr(this._docRoot,this.passedElement.element.id,a),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false")),l&&a.setAttribute("aria-labelledby",l),a},containerInner:function(i){var e=i.classNames.containerInner,t=document.createElement("div");return de(t,e),t},itemList:function(i,e){var t=i.searchEnabled,n=i.classNames,r=n.list,s=n.listSingle,l=n.listItems,o=document.createElement("div");return de(o,r),de(o,e?s:l),this._isSelectElement&&t&&o.setAttribute("role","listbox"),o},placeholder:function(i,e){var t=i.allowHTML,n=i.classNames.placeholder,r=document.createElement("div");return de(r,n),ot(r,t,e),r},item:function(i,e,t){var n=i.allowHTML,r=i.removeItemButtonAlignLeft,s=i.removeItemIconText,l=i.removeItemLabelText,o=i.classNames,a=o.item,c=o.button,u=o.highlightedState,h=o.itemSelectable,f=o.placeholder,d=It(e.value),p=document.createElement("div");if(de(p,a),e.labelClass){var g=document.createElement("span");ot(g,n,e.label),de(g,e.labelClass),p.appendChild(g)}else ot(p,n,e.label);if(p.dataset.item="",p.dataset.id=e.id,p.dataset.value=d,nn(p,e,!0),(e.disabled||this.containerOuter.isDisabled)&&p.setAttribute("aria-disabled","true"),this._isSelectElement&&(p.setAttribute("aria-selected","true"),p.setAttribute("role","option")),e.placeholder&&(de(p,f),p.dataset.placeholder=""),de(p,e.highlighted?u:h),t){e.disabled&&it(p,h),p.dataset.deletable="";var v=document.createElement("button");v.type="button",de(v,c),ot(v,!0,oi(s,e.value));var w=oi(l,e.value);w&&v.setAttribute("aria-label",w),v.dataset.button="",r?p.insertAdjacentElement("afterbegin",v):p.appendChild(v)}return p},choiceList:function(i,e){var t=i.classNames.list,n=document.createElement("div");return de(n,t),e||n.setAttribute("aria-multiselectable","true"),n.setAttribute("role","listbox"),n},choiceGroup:function(i,e){var t=i.allowHTML,n=i.classNames,r=n.group,s=n.groupHeading,l=n.itemDisabled,o=e.id,a=e.label,c=e.disabled,u=It(a),h=document.createElement("div");de(h,r),c&&de(h,l),h.setAttribute("role","group"),h.dataset.group="",h.dataset.id=o,h.dataset.value=u,c&&h.setAttribute("aria-disabled","true");var f=document.createElement("div");return de(f,s),ot(f,t,a||""),h.appendChild(f),h},choice:function(i,e,t,n){var r=i.allowHTML,s=i.classNames,l=s.item,o=s.itemChoice,a=s.itemSelectable,c=s.selectedState,u=s.itemDisabled,h=s.description,f=s.placeholder,d=e.label,p=It(e.value),g=document.createElement("div");g.id=e.elementId,de(g,l),de(g,o),n&&typeof d=="string"&&(d=On(r,d),d+=" (".concat(n,")"),d={trusted:d});var v=g;if(e.labelClass){var w=document.createElement("span");ot(w,r,d),de(w,e.labelClass),v=w,g.appendChild(w)}else ot(g,r,d);if(e.labelDescription){var S="".concat(e.elementId,"-description");v.setAttribute("aria-describedby",S);var P=document.createElement("span");ot(P,r,e.labelDescription),P.id=S,de(P,h),g.appendChild(P)}return e.selected&&de(g,c),e.placeholder&&de(g,f),g.setAttribute("role",e.group?"treeitem":"option"),g.dataset.choice="",g.dataset.id=e.id,g.dataset.value=p,t&&(g.dataset.selectText=t),e.group&&(g.dataset.groupId="".concat(e.group.id)),nn(g,e,!1),e.disabled?(de(g,u),g.dataset.choiceDisabled="",g.setAttribute("aria-disabled","true")):(de(g,a),g.dataset.choiceSelectable=""),g},input:function(i,e){var t=i.classNames,n=t.input,r=t.inputCloned,s=i.labelId,l=document.createElement("input");return l.type="search",de(l,n),de(l,r),l.autocomplete="off",l.autocapitalize="off",l.spellcheck=!1,l.setAttribute("aria-autocomplete","list"),e?l.setAttribute("aria-label",e):s||Yr(this._docRoot,this.passedElement.element.id,l),l},dropdown:function(i){var e=i.classNames,t=e.list,n=e.listDropdown,r=document.createElement("div");return de(r,t),de(r,n),r.setAttribute("aria-expanded","false"),r},notice:function(i,e,t){var n=i.classNames,r=n.item,s=n.itemChoice,l=n.addChoice,o=n.noResults,a=n.noChoices,c=n.notice;t===void 0&&(t=Le.generic);var u=document.createElement("div");switch(ot(u,!0,e),de(u,r),de(u,s),de(u,c),t){case Le.addChoice:de(u,l);break;case Le.noResults:de(u,o);break;case Le.noChoices:de(u,a);break}return t===Le.addChoice&&(u.dataset.choiceSelectable="",u.dataset.choice=""),u},option:function(i){var e=It(i.label),t=new Option(e,i.value,!1,i.selected);return nn(t,i,!0),t.disabled=i.disabled,i.selected&&t.setAttribute("selected",""),t}},vf="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,bf={},rn=function(i){if(i)return i.dataset.id?parseInt(i.dataset.id,10):void 0},ri="[data-choice-selectable]",wf=function(){function i(e,t){e===void 0&&(e="[data-choice]"),t===void 0&&(t={});var n=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var r=i.defaults;this.config=We(We(We({},r.allOptions),r.options),t),xc.forEach(function(w){n.config[w]=We(We(We({},r.allOptions[w]),r.options[w]),t[w])});var s=this.config;s.silent||this._validateConfig();var l=s.shadowRoot||document.documentElement;this._docRoot=l;var o=typeof e=="string"?l.querySelector(e):e;if(!o||typeof o!="object"||!(pu(o)||Ol(o)))throw TypeError(!o&&typeof e=="string"?"Selector ".concat(e," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var a=o.type,c=a===_t.Text;(c||s.maxItemCount!==1)&&(s.singleModeForMultiSelect=!1),s.singleModeForMultiSelect&&(a=_t.SelectMultiple);var u=a===_t.SelectOne,h=a===_t.SelectMultiple,f=u||h;if(this._elementType=a,this._isTextElement=c,this._isSelectOneElement=u,this._isSelectMultipleElement=h,this._isSelectElement=u||h,this._canAddUserChoices=c&&s.addItems||f&&s.addChoices,typeof s.renderSelectedChoices!="boolean"&&(s.renderSelectedChoices=s.renderSelectedChoices==="always"||u),s.closeDropdownOnSelect==="auto"?s.closeDropdownOnSelect=c||u||s.singleModeForMultiSelect:s.closeDropdownOnSelect=li(s.closeDropdownOnSelect),s.placeholder&&(s.placeholderValue?this._hasNonChoicePlaceholder=!0:o.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,s.placeholderValue=o.dataset.placeholder)),t.addItemFilter&&typeof t.addItemFilter!="function"){var d=t.addItemFilter instanceof RegExp?t.addItemFilter:new RegExp(t.addItemFilter);s.addItemFilter=d.test.bind(d)}if(this._isTextElement)this.passedElement=new mu({element:o,classNames:s.classNames});else{var p=o;this.passedElement=new vu({element:p,classNames:s.classNames,template:function(w){return n._templates.option(w)},extractPlaceholder:s.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Su(s),this._currentValue="",s.searchEnabled=!c&&s.searchEnabled||h,this._canSearch=s.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=tu(o,"choices-"),this._direction=o.dir,!this._direction){var g=window.getComputedStyle(o).direction,v=window.getComputedStyle(document.documentElement).direction;g!==v&&(this._direction=g)}if(this._idNames={itemChoice:"item-choice"},this._templates=r.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){s.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(w){return w.value})}return Object.defineProperty(i,"defaults",{get:function(){return Object.preventExtensions({get options(){return bf},get allOptions(){return Fr},get templates(){return _f}})},enumerable:!1,configurable:!0}),i.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=pf(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var e=this.config.callbackOnInit;typeof e=="function"&&e.call(this)}},i.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=i.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},i.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},i.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},i.prototype.highlightItem=function(e,t){if(t===void 0&&(t=!0),!e||!e.id)return this;var n=this._store.items.find(function(r){return r.id===e.id});return!n||n.highlighted?this:(this._store.dispatch(Ei(n,!0)),t&&this.passedElement.triggerEvent(Ke.highlightItem,this._getChoiceForOutput(n)),this)},i.prototype.unhighlightItem=function(e,t){if(t===void 0&&(t=!0),!e||!e.id)return this;var n=this._store.items.find(function(r){return r.id===e.id});return!n||!n.highlighted?this:(this._store.dispatch(Ei(n,!1)),t&&this.passedElement.triggerEvent(Ke.unhighlightItem,this._getChoiceForOutput(n)),this)},i.prototype.highlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(t){t.highlighted||(e._store.dispatch(Ei(t,!0)),e.passedElement.triggerEvent(Ke.highlightItem,e._getChoiceForOutput(t)))})}),this},i.prototype.unhighlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(t){t.highlighted&&(e._store.dispatch(Ei(t,!1)),e.passedElement.triggerEvent(Ke.highlightItem,e._getChoiceForOutput(t)))})}),this},i.prototype.removeActiveItemsByValue=function(e){var t=this;return this._store.withTxn(function(){t._store.items.filter(function(n){return n.value===e}).forEach(function(n){return t._removeItem(n)})}),this},i.prototype.removeActiveItems=function(e){var t=this;return this._store.withTxn(function(){t._store.items.filter(function(n){var r=n.id;return r!==e}).forEach(function(n){return t._removeItem(n)})}),this},i.prototype.removeHighlightedItems=function(e){var t=this;return e===void 0&&(e=!1),this._store.withTxn(function(){t._store.highlightedActiveItems.forEach(function(n){t._removeItem(n),e&&t._triggerChange(n.value)})}),this},i.prototype.showDropdown=function(e){var t=this;return this.dropdown.isActive?this:(e===void 0&&(e=!this._canSearch),requestAnimationFrame(function(){t.dropdown.show();var n=t.dropdown.element.getBoundingClientRect();t.containerOuter.open(n.bottom,n.height),e||t.input.focus(),t.passedElement.triggerEvent(Ke.showDropdown)}),this)},i.prototype.hideDropdown=function(e){var t=this;return this.dropdown.isActive?(requestAnimationFrame(function(){t.dropdown.hide(),t.containerOuter.close(),!e&&t._canSearch&&(t.input.removeActiveDescendant(),t.input.blur()),t.passedElement.triggerEvent(Ke.hideDropdown)}),this):this},i.prototype.getValue=function(e){var t=this,n=this._store.items.map(function(r){return e?r.value:t._getChoiceForOutput(r)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?n[0]:n},i.prototype.setValue=function(e){var t=this;return this.initialisedOK?(this._store.withTxn(function(){e.forEach(function(n){n&&t._addChoice(tt(n,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},i.prototype.setChoiceByValue=function(e){var t=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var n=Array.isArray(e)?e:[e];n.forEach(function(r){return t._findAndSelectChoiceByValue(r)}),t.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},i.prototype.setChoices=function(e,t,n,r,s,l){var o=this;if(e===void 0&&(e=[]),t===void 0&&(t="value"),n===void 0&&(n="label"),r===void 0&&(r=!1),s===void 0&&(s=!0),l===void 0&&(l=!1),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof t!="string"||!t)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(typeof e=="function"){var a=e(this);if(typeof Promise=="function"&&a instanceof Promise)return new Promise(function(c){return requestAnimationFrame(c)}).then(function(){return o._handleLoadingState(!0)}).then(function(){return a}).then(function(c){return o.setChoices(c,t,n,r,s,l)}).catch(function(c){o.config.silent||console.error(c)}).then(function(){return o._handleLoadingState(!1)}).then(function(){return o});if(!Array.isArray(a))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof a));return this.setChoices(a,t,n,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){s&&(o._isSearching=!1),r&&o.clearChoices(!0,l);var c=t==="value",u=n==="label";e.forEach(function(h){if("choices"in h){var f=h;u||(f=We(We({},f),{label:f[n]})),o._addGroup(tt(f,!0))}else{var d=h;(!u||!c)&&(d=We(We({},d),{value:d[t],label:d[n]}));var p=tt(d,!1);o._addChoice(p),p.placeholder&&!o._hasNonChoicePlaceholder&&(o._placeholderValue=El(p.label))}}),o.unhighlightAll()}),this._searcher.reset(),this},i.prototype.refresh=function(e,t,n){var r=this;return e===void 0&&(e=!1),t===void 0&&(t=!1),n===void 0&&(n=!1),this._isSelectElement?(this._store.withTxn(function(){var s=r.passedElement.optionsAsChoices(),l={};n||r._store.items.forEach(function(a){a.id&&a.active&&a.selected&&(l[a.value]=!0)}),r.clearStore(!1);var o=function(a){n?r._store.dispatch($r(a)):l[a.value]&&(a.selected=!0)};s.forEach(function(a){if("choices"in a){a.choices.forEach(o);return}o(a)}),r._addPredefinedChoices(s,t,e),r._isSearching&&r._searchChoices(r.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},i.prototype.removeChoice=function(e){var t=this._store.choices.find(function(n){return n.value===e});return t?(this._clearNotice(),this._store.dispatch(Jc(t)),this._searcher.reset(),t.selected&&this.passedElement.triggerEvent(Ke.removeItem,this._getChoiceForOutput(t)),this):this},i.prototype.clearChoices=function(e,t){var n=this;return e===void 0&&(e=!0),t===void 0&&(t=!1),e&&(t?this.passedElement.element.replaceChildren(""):this.passedElement.element.querySelectorAll(":not([selected])").forEach(function(r){r.remove()})),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.withTxn(function(){var r=t?[]:n._store.items;n._store.reset(),r.forEach(function(s){n._store.dispatch(Lr(s)),n._store.dispatch(Rr(s))})}),this._searcher.reset(),this},i.prototype.clearStore=function(e){return e===void 0&&(e=!0),this.clearChoices(e,!0),this._stopSearch(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this},i.prototype.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),this._stopSearch(),this},i.prototype._validateConfig=function(){var e=this.config,t=au(e,Fr);t.length&&console.warn("Unknown config option(s) passed",t.join(", ")),e.allowHTML&&e.allowHtmlUserInput&&(e.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),e.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},i.prototype._render=function(e){e===void 0&&(e={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(e.choices||e.groups)&&this._renderChoices(),e.items&&this._renderItems())},i.prototype._renderChoices=function(){var e=this;if(this._canAddItems()){var t=this,n=t.config,r=t._isSearching,s=this._store,l=s.activeGroups,o=s.activeChoices,a=0;if(r&&n.searchResultLimit>0?a=n.searchResultLimit:n.renderChoiceLimit>0&&(a=n.renderChoiceLimit),this._isSelectElement){var c=o.filter(function(p){return!p.element});c.length&&this.passedElement.addOptions(c)}var u=document.createDocumentFragment(),h=function(p){return p.filter(function(g){return!g.placeholder&&(r?!!g.rank:n.renderSelectedChoices||!g.selected)})},f=!1,d=function(p,g,v){r?p.sort(lu):n.shouldSort&&p.sort(n.sorter);var w=p.length;w=!g&&a&&w>a?a:w,w--,p.every(function(S,P){var M=S.choiceEl||e._templates.choice(n,S,n.itemSelectText,v);return S.choiceEl=M,u.appendChild(M),(r||!S.selected)&&(f=!0),P<w})};o.length&&(n.resetScrollPosition&&requestAnimationFrame(function(){return e.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!r&&this._isSelectOneElement&&d(o.filter(function(p){return p.placeholder&&!p.group}),!1,void 0),l.length&&!r?(n.shouldSort&&l.sort(n.sorter),d(o.filter(function(p){return!p.placeholder&&!p.group}),!1,void 0),l.forEach(function(p){var g=h(p.choices);if(g.length){if(p.label){var v=p.groupEl||e._templates.choiceGroup(e.config,p);p.groupEl=v,v.remove(),u.appendChild(v)}d(g,!0,n.appendGroupInSearch&&r?p.label:void 0)}})):d(h(o),!1,void 0)),!f&&(r||!u.children.length||!n.renderSelectedChoices)&&(this._notice||(this._notice={text:Nr(r?n.noResultsText:n.noChoicesText),type:r?Le.noResults:Le.noChoices}),u.replaceChildren("")),this._renderNotice(u),this.choiceList.element.replaceChildren(u),f&&this._highlightChoice()}},i.prototype._renderItems=function(){var e=this,t=this._store.items||[],n=this.itemList.element,r=this.config,s=document.createDocumentFragment(),l=function(h){return n.querySelector('[data-item][data-id="'.concat(h.id,'"]'))},o=function(h){var f=h.itemEl;f&&f.parentElement||(f=l(h)||e._templates.item(r,h,r.removeItemButton),h.itemEl=f,s.appendChild(f))};t.forEach(o);var a=!!s.childNodes.length;if(this._isSelectOneElement){var c=n.children.length;if(a||c>1){var u=n.querySelector(ni(r.classNames.placeholder));u&&u.remove()}else!a&&!c&&this._placeholderValue&&(a=!0,o(tt({selected:!0,value:"",label:this._placeholderValue,placeholder:!0},!1)))}a&&(n.append(s),r.shouldSortItems&&!this._isSelectOneElement&&(t.sort(r.sorter),t.forEach(function(h){var f=l(h);f&&(f.remove(),s.append(f))}),n.append(s))),this._isTextElement&&(this.passedElement.value=t.map(function(h){var f=h.value;return f}).join(r.delimiter))},i.prototype._displayNotice=function(e,t,n){n===void 0&&(n=!0);var r=this._notice;if(r&&(r.type===t&&r.text===e||r.type===Le.addChoice&&(t===Le.noResults||t===Le.noChoices))){n&&this.showDropdown(!0);return}this._clearNotice(),this._notice=e?{text:e,type:t}:void 0,this._renderNotice(),n&&e&&this.showDropdown(!0)},i.prototype._clearNotice=function(){if(this._notice){var e=this.choiceList.element.querySelector(ni(this.config.classNames.notice));e&&e.remove(),this._notice=void 0}},i.prototype._renderNotice=function(e){var t=this._notice;if(t){var n=this._templates.notice(this.config,t.text,t.type);e?e.append(n):this.choiceList.prepend(n)}},i.prototype._getChoiceForOutput=function(e,t){return{id:e.id,highlighted:e.highlighted,labelClass:e.labelClass,labelDescription:e.labelDescription,customProperties:e.customProperties,disabled:e.disabled,active:e.active,label:e.label,placeholder:e.placeholder,value:e.value,groupValue:e.group?e.group.label:void 0,element:e.element,keyCode:t}},i.prototype._triggerChange=function(e){e!=null&&this.passedElement.triggerEvent(Ke.change,{value:e})},i.prototype._handleButtonAction=function(e){var t=this,n=this._store.items;if(!(!n.length||!this.config.removeItems||!this.config.removeItemButton)){var r=e&&rn(e.parentElement),s=r&&n.find(function(l){return l.id===r});s&&this._store.withTxn(function(){if(t._removeItem(s),t._triggerChange(s.value),t._isSelectOneElement&&!t._hasNonChoicePlaceholder){var l=(t.config.shouldSort?t._store.choices.reverse():t._store.choices).find(function(o){return o.placeholder});l&&(t._addItem(l),t.unhighlightAll(),l.value&&t._triggerChange(l.value))}})}},i.prototype._handleItemAction=function(e,t){var n=this;t===void 0&&(t=!1);var r=this._store.items;if(!(!r.length||!this.config.removeItems||this._isSelectOneElement)){var s=rn(e);s&&(r.forEach(function(l){l.id===s&&!l.highlighted?n.highlightItem(l):!t&&l.highlighted&&n.unhighlightItem(l)}),this.input.focus())}},i.prototype._handleChoiceAction=function(e){var t=this,n=rn(e),r=n&&this._store.getChoiceById(n);if(!r||r.disabled)return!1;var s=this.dropdown.isActive;if(!r.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){t._addItem(r,!0,!0),t.clearInput(),t.unhighlightAll()}),this._triggerChange(r.value)}return s&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},i.prototype._handleBackspace=function(e){var t=this.config;if(!(!t.removeItems||!e.length)){var n=e[e.length-1],r=e.some(function(s){return s.highlighted});t.editItems&&!r&&n?(this.input.value=n.value,this.input.setWidth(),this._removeItem(n),this._triggerChange(n.value)):(r||this.highlightItem(n,!1),this.removeHighlightedItems(!0))}},i.prototype._loadChoices=function(){var e,t=this,n=this.config;if(this._isTextElement){if(this._presetChoices=n.items.map(function(l){return tt(l,!1)}),this.passedElement.value){var r=this.passedElement.value.split(n.delimiter).map(function(l){return tt(l,!1,t.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(r)}this._presetChoices.forEach(function(l){l.selected=!0})}else if(this._isSelectElement){this._presetChoices=n.choices.map(function(l){return tt(l,!0)});var s=this.passedElement.optionsAsChoices();s&&(e=this._presetChoices).push.apply(e,s)}},i.prototype._handleLoadingState=function(e){e===void 0&&(e=!0);var t=this.itemList.element;e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?t.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(t.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},i.prototype._handleSearch=function(e){if(this.input.isFocussed)if(e!==null&&typeof e<"u"&&e.length>=this.config.searchFloor){var t=this.config.searchChoices?this._searchChoices(e):0;t!==null&&this.passedElement.triggerEvent(Ke.search,{value:e,resultCount:t})}else this._store.choices.some(function(n){return!n.active})&&this._stopSearch()},i.prototype._canAddItems=function(){var e=this.config,t=e.maxItemCount,n=e.maxItemText;return!e.singleModeForMultiSelect&&t>0&&t<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof n=="function"?n(t):n,Le.addChoice),!1):(this._notice&&this._notice.type===Le.addChoice&&this._clearNotice(),!0)},i.prototype._canCreateItem=function(e){var t=this.config,n=!0,r="";if(n&&typeof t.addItemFilter=="function"&&!t.addItemFilter(e)&&(n=!1,r=oi(t.customAddItemText,e)),n){var s=this._store.choices.find(function(l){return t.valueComparer(l.value,e)});if(s){if(this._isSelectElement)return this._displayNotice("",Le.addChoice),!1;t.duplicateItemsAllowed||(n=!1,r=oi(t.uniqueItemText,e))}}return n&&(r=oi(t.addItemText,e)),r&&this._displayNotice(r,Le.addChoice),n},i.prototype._searchChoices=function(e){var t=e.trim().replace(/\s{2,}/," ");if(!t.length||t===this._currentValue)return null;var n=this._searcher;n.isEmptyIndex()&&n.index(this._store.searchableChoices);var r=n.search(t);this._currentValue=t,this._highlightPosition=0,this._isSearching=!0;var s=this._notice,l=s&&s.type;return l!==Le.addChoice&&(r.length?this._clearNotice():this._displayNotice(Nr(this.config.noResultsText),Le.noResults)),this._store.dispatch(Xc(r)),r.length},i.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(Qc(!0)),this.passedElement.triggerEvent(Ke.search,{value:"",resultCount:0}))},i.prototype._addEventListeners=function(){var e=this._docRoot,t=this.containerOuter.element,n=this.input.element;e.addEventListener("touchend",this._onTouchEnd,!0),t.addEventListener("keydown",this._onKeyDown,!0),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(t.addEventListener("focus",this._onFocus,{passive:!0}),t.addEventListener("blur",this._onBlur,{passive:!0})),n.addEventListener("keyup",this._onKeyUp,{passive:!0}),n.addEventListener("input",this._onInput,{passive:!0}),n.addEventListener("focus",this._onFocus,{passive:!0}),n.addEventListener("blur",this._onBlur,{passive:!0}),n.form&&n.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},i.prototype._removeEventListeners=function(){var e=this._docRoot,t=this.containerOuter.element,n=this.input.element;e.removeEventListener("touchend",this._onTouchEnd,!0),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur)),n.removeEventListener("keyup",this._onKeyUp),n.removeEventListener("input",this._onInput),n.removeEventListener("focus",this._onFocus),n.removeEventListener("blur",this._onBlur),n.form&&n.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},i.prototype._onKeyDown=function(e){var t=e.keyCode,n=this.dropdown.isActive,r=e.key.length===1||e.key.length===2&&e.key.charCodeAt(0)>=55296||e.key==="Unidentified";switch(!this._isTextElement&&!n&&t!==Ne.ESC_KEY&&t!==Ne.TAB_KEY&&t!==Ne.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&r&&(this.input.value+=e.key,e.key===" "&&e.preventDefault())),t){case Ne.A_KEY:return this._onSelectKey(e,this.itemList.element.hasChildNodes());case Ne.ENTER_KEY:return this._onEnterKey(e,n);case Ne.ESC_KEY:return this._onEscapeKey(e,n);case Ne.UP_KEY:case Ne.PAGE_UP_KEY:case Ne.DOWN_KEY:case Ne.PAGE_DOWN_KEY:return this._onDirectionKey(e,n);case Ne.DELETE_KEY:case Ne.BACK_KEY:return this._onDeleteKey(e,this._store.items,this.input.isFocussed)}},i.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},i.prototype._onInput=function(){var e=this.input.value;if(!e){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(e),this._canAddUserChoices&&(this._canCreateItem(e),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},i.prototype._onSelectKey=function(e,t){if((e.ctrlKey||e.metaKey)&&t){this._canSearch=!1;var n=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;n&&this.highlightAll()}},i.prototype._onEnterKey=function(e,t){var n=this,r=this.input.value,s=e.target;if(e.preventDefault(),s&&s.hasAttribute("data-button")){this._handleButtonAction(s);return}if(!t){(this._isSelectElement||this._notice)&&this.showDropdown();return}var l=this.dropdown.element.querySelector(ni(this.config.classNames.highlightedState));if(!(l&&this._handleChoiceAction(l))){if(!s||!r){this.hideDropdown(!0);return}if(this._canAddItems()){var o=!1;this._store.withTxn(function(){if(o=n._findAndSelectChoiceByValue(r,!0),!o){if(!n._canAddUserChoices||!n._canCreateItem(r))return;n._addChoice(tt(r,!1,n.config.allowHtmlUserInput),!0,!0),o=!0}n.clearInput(),n.unhighlightAll()}),o&&(this._triggerChange(r),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},i.prototype._onEscapeKey=function(e,t){t&&(e.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},i.prototype._onDirectionKey=function(e,t){var n=e.keyCode;if(t||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var r=n===Ne.DOWN_KEY||n===Ne.PAGE_DOWN_KEY?1:-1,s=e.metaKey||n===Ne.PAGE_DOWN_KEY||n===Ne.PAGE_UP_KEY,l=void 0;if(s)r>0?l=this.dropdown.element.querySelector("".concat(ri,":last-of-type")):l=this.dropdown.element.querySelector(ri);else{var o=this.dropdown.element.querySelector(ni(this.config.classNames.highlightedState));o?l=iu(o,ri,r):l=this.dropdown.element.querySelector(ri)}l&&(nu(l,this.choiceList.element,r)||this.choiceList.scrollToChildElement(l,r),this._highlightChoice(l)),e.preventDefault()}},i.prototype._onDeleteKey=function(e,t,n){!this._isSelectOneElement&&!e.target.value&&n&&(this._handleBackspace(t),e.preventDefault())},i.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},i.prototype._onTouchEnd=function(e){var t=(e||e.touches[0]).target,n=this._wasTap&&this.containerOuter.element.contains(t);if(n){var r=t===this.containerOuter.element||t===this.containerInner.element;r&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()}this._wasTap=!0},i.prototype._onMouseDown=function(e){var t=e.target;if(t instanceof HTMLElement){if(vf&&this.choiceList.element.contains(t)){var n=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?e.offsetX>=n.offsetWidth:e.offsetX<n.offsetLeft}if(t!==this.input.element){var r=t.closest("[data-button],[data-item],[data-choice]");r instanceof HTMLElement&&("button"in r.dataset?this._handleButtonAction(r):"item"in r.dataset?this._handleItemAction(r,e.shiftKey):"choice"in r.dataset&&this._handleChoiceAction(r)),e.preventDefault()}}},i.prototype._onMouseOver=function(e){var t=e.target;t instanceof HTMLElement&&"choice"in t.dataset&&this._highlightChoice(t)},i.prototype._onClick=function(e){var t=e.target,n=this.containerOuter,r=n.element.contains(t);r?!this.dropdown.isActive&&!n.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),n.element.focus()):this._isSelectOneElement&&t!==this.input.element&&!this.dropdown.element.contains(t)&&this.hideDropdown():(n.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},i.prototype._onFocus=function(e){var t=e.target,n=this.containerOuter,r=t&&n.element.contains(t);if(r){var s=t===this.input.element;this._isTextElement?s&&n.addFocusState():this._isSelectMultipleElement?s&&(this.showDropdown(!0),n.addFocusState()):(n.addFocusState(),s&&this.showDropdown(!0))}},i.prototype._onBlur=function(e){var t=e.target,n=this.containerOuter,r=t&&n.element.contains(t);r&&!this._isScrollingOnIe?t===this.input.element?(n.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):t===this.containerOuter.element&&(n.removeFocusState(),this._canSearch||this.hideDropdown(!0)):(this._isScrollingOnIe=!1,this.input.element.focus())},i.prototype._onFormReset=function(){var e=this;this._store.withTxn(function(){e.clearInput(),e.hideDropdown(),e.refresh(!1,!1,!0),e._initialItems.length&&e.setChoiceByValue(e._initialItems)})},i.prototype._highlightChoice=function(e){e===void 0&&(e=null);var t=Array.from(this.dropdown.element.querySelectorAll(ri));if(t.length){var n=e,r=this.config.classNames.highlightedState,s=Array.from(this.dropdown.element.querySelectorAll(ni(r)));s.forEach(function(l){it(l,r),l.setAttribute("aria-selected","false")}),n?this._highlightPosition=t.indexOf(n):(t.length>this._highlightPosition?n=t[this._highlightPosition]:n=t[t.length-1],n||(n=t[0])),de(n,r),n.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(Ke.highlightChoice,{el:n}),this.dropdown.isActive&&(this.input.setActiveDescendant(n.id),this.containerOuter.setActiveDescendant(n.id))}},i.prototype._addItem=function(e,t,n){if(t===void 0&&(t=!0),n===void 0&&(n=!1),!e.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e.id),this._store.dispatch(Rr(e)),t&&(this.passedElement.triggerEvent(Ke.addItem,this._getChoiceForOutput(e)),n&&this.passedElement.triggerEvent(Ke.choice,this._getChoiceForOutput(e)))},i.prototype._removeItem=function(e){if(e.id){this._store.dispatch($r(e));var t=this._notice;t&&t.type===Le.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(Ke.removeItem,this._getChoiceForOutput(e))}},i.prototype._addChoice=function(e,t,n){if(t===void 0&&(t=!0),n===void 0&&(n=!1),e.id)throw new TypeError("Can not re-add a choice which has already been added");var r=this.config;if(!(!r.duplicateItemsAllowed&&this._store.choices.find(function(o){return r.valueComparer(o.value,e.value)}))){this._lastAddedChoiceId++,e.id=this._lastAddedChoiceId,e.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(e.id);var s=r.prependValue,l=r.appendValue;s&&(e.value=s+e.value),l&&(e.value+=l.toString()),(s||l)&&e.element&&(e.element.value=e.value),this._clearNotice(),this._store.dispatch(Lr(e)),e.selected&&this._addItem(e,t,n)}},i.prototype._addGroup=function(e,t){var n=this;if(t===void 0&&(t=!0),e.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(Zc(e)),e.choices&&(this._lastAddedGroupId++,e.id=this._lastAddedGroupId,e.choices.forEach(function(r){r.group=e,e.disabled&&(r.disabled=!0),n._addChoice(r,t)}))},i.prototype._createTemplates=function(){var e=this,t=this.config.callbackOnCreateTemplates,n={};typeof t=="function"&&(n=t.call(this,ru,On,qi));var r={};Object.keys(this._templates).forEach(function(s){s in n?r[s]=n[s].bind(e):r[s]=e._templates[s].bind(e)}),this._templates=r},i.prototype._createElements=function(){var e=this._templates,t=this,n=t.config,r=t._isSelectOneElement,s=n.position,l=n.classNames,o=this._elementType;this.containerOuter=new jr({element:e.containerOuter(n,this._direction,this._isSelectElement,r,n.searchEnabled,o,n.labelId),classNames:l,type:o,position:s}),this.containerInner=new jr({element:e.containerInner(n),classNames:l,type:o,position:s}),this.input=new du({element:e.input(n,this._placeholderValue),classNames:l,type:o,preventPaste:!n.paste}),this.choiceList=new Vr({element:e.choiceList(n,r)}),this.itemList=new Vr({element:e.itemList(n,r)}),this.dropdown=new fu({element:e.dropdown(n),classNames:l,type:o})},i.prototype._createStructure=function(){var e=this,t=e.containerInner,n=e.containerOuter,r=e.passedElement,s=this.dropdown.element;r.conceal(),t.wrap(r.element),n.wrap(t.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),n.element.appendChild(t.element),n.element.appendChild(s),t.element.appendChild(this.itemList.element),s.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&s.insertBefore(this.input.element,s.firstChild):t.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},i.prototype._initStore=function(){var e=this;this._store.subscribe(this._render).withTxn(function(){e._addPredefinedChoices(e._presetChoices,e._isSelectOneElement&&!e._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},i.prototype._addPredefinedChoices=function(e,t,n){var r=this;if(t===void 0&&(t=!1),n===void 0&&(n=!0),t){var s=e.findIndex(function(l){return l.selected})===-1;s&&e.some(function(l){return l.disabled||"choices"in l?!1:(l.selected=!0,!0)})}e.forEach(function(l){"choices"in l?r._isSelectElement&&r._addGroup(l,n):r._addChoice(l,n)})},i.prototype._findAndSelectChoiceByValue=function(e,t){var n=this;t===void 0&&(t=!1);var r=this._store.choices.find(function(s){return n.config.valueComparer(s.value,e)});return r&&!r.disabled&&!r.selected?(this._addItem(r,!0,t),!0):!1},i.prototype._generatePlaceholderValue=function(){var e=this.config;if(!e.placeholder)return null;if(this._hasNonChoicePlaceholder)return e.placeholderValue;if(this._isSelectElement){var t=this.passedElement.placeholderOption;return t?t.text:null}return null},i.prototype._warnChoicesInitFailed=function(e){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(e," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(e," called on a non-initialised instance of Choices"))},i.version="11.1.0",i}();function xr(i){let e,t;return{c(){e=b("label"),t=J(i[2]),m(e,"for",i[4])},m(n,r){C(n,e,r),_(e,t)},p(n,r){r&4&&fe(t,n[2])},d(n){n&&E(e)}}}function yf(i){let e;return{c(){e=b("select"),m(e,"id",i[4]),m(e,"name",i[4]),m(e,"aria-label",i[2]),m(e,"class","m-1")},m(t,n){C(t,e,n)},p(t,n){n&4&&m(e,"aria-label",t[2])},i:j,o:j,d(t){t&&E(e)}}}function kf(i){let e,t,n,r=i[3].length&&Jr(i);return{c(){r&&r.c(),e=D(),t=b("select"),m(t,"id",i[4]),m(t,"name",i[4]),m(t,"aria-label",i[2]),m(t,"class","m-1"),t.multiple=!0},m(s,l){r&&r.m(s,l),C(s,e,l),C(s,t,l),n=!0},p(s,l){s[3].length?r?(r.p(s,l),l&8&&O(r,1)):(r=Jr(s),r.c(),O(r,1),r.m(e.parentNode,e)):r&&(pe(),L(r,1,1,()=>{r=null}),ge()),(!n||l&4)&&m(t,"aria-label",s[2])},i(s){n||(O(r),n=!0)},o(s){L(r),n=!1},d(s){r&&r.d(s),s&&E(e),s&&E(t)}}}function Jr(i){let e,t,n=i[3].length+"",r,s,l,o;return l=new mi({props:{targetHtmlId:i[5],tooltipText:`${i[3].length}
                                    ${N==="fr"&&i[3].length>1?"valeurs sélectionnées":N==="fr"&&i[3].length===1?"valeur sélectionnée":N==="en"&&i[3].length>1?"selected values":"selected value"}`}}),{c(){e=b("span"),t=b("span"),r=J(n),s=D(),G(l.$$.fragment),m(t,"id",i[5]),m(t,"class","input-dropdown-count tag m-1 svelte-1epfuu8"),m(e,"class","is-relative")},m(a,c){C(a,e,c),_(e,t),_(t,r),_(e,s),K(l,e,null),o=!0},p(a,c){(!o||c&8)&&n!==(n=a[3].length+"")&&fe(r,n);const u={};c&8&&(u.tooltipText=`${a[3].length}
                                    ${N==="fr"&&a[3].length>1?"valeurs sélectionnées":N==="fr"&&a[3].length===1?"valeur sélectionnée":N==="en"&&a[3].length>1?"selected values":"selected value"}`),l.$set(u)},i(a){o||(O(l.$$.fragment,a),o=!0)},o(a){L(l.$$.fragment,a),o=!1},d(a){a&&E(e),W(l)}}}function Sf(i){let e,t,n,r,s,l,o,a=i[2]!==void 0&&xr(i);const c=[kf,yf],u=[];function h(f,d){return f[0]?0:1}return r=h(i),s=u[r]=c[r](i),{c(){e=b("div"),a&&a.c(),t=D(),n=b("div"),s.c(),m(n,"class",l="input-dropdown-select "+(i[0]?"is-multiple":"is-single")+" "+(i[0]&&i[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(i[1]?"light-display":"")+" svelte-1epfuu8"),m(e,"class","input-dropdown-select-wrapper")},m(f,d){C(f,e,d),a&&a.m(e,null),_(e,t),_(e,n),u[r].m(n,null),o=!0},p(f,[d]){f[2]!==void 0?a?a.p(f,d):(a=xr(f),a.c(),a.m(e,t)):a&&(a.d(1),a=null);let p=r;r=h(f),r===p?u[r].p(f,d):(pe(),L(u[p],1,1,()=>{u[p]=null}),ge(),s=u[r],s?s.p(f,d):(s=u[r]=c[r](f),s.c()),O(s,1),s.m(n,null)),(!o||d&11&&l!==(l="input-dropdown-select "+(f[0]?"is-multiple":"is-single")+" "+(f[0]&&f[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(f[1]?"light-display":"")+" svelte-1epfuu8"))&&m(n,"class",l)},i(f){o||(O(s),o=!0)},o(f){L(s),o=!1},d(f){f&&E(e),a&&a.d(),u[r].d()}}}const Ef=250;function Cf(i,e,t){let n,r,{choicesItems:s}=e,{start:l=[]}=e,{multiple:o}=e,{searchable:a=!0}=e,{lightDisplay:c=!1}=e,{placeholder:u=N==="fr"?"Sélectionner une valeur":"Select a value"}=e,{title:h=void 0}=e,{selectAll:f=!!o}=e;const d=`input-dropdown-select-${window.crypto.randomUUID()}`,p=`input-dropdown-counter-${window.crypto.randomUUID()}`,g=`select-all-${window.crypto.randomUUID()}`,v=`unselect-all-${window.crypto.randomUUID()}`,w=Kt();let S;const P=Ri();P.setCompareFn(kn);const M=Je("resetTrigger")||void 0;M==null||M.subscribe(()=>U(S,s,l,f));const I=()=>{t(11,r=!0),setTimeout(()=>t(11,r=!1),Ef)},R=(H,re)=>{re||(P.set(H),P.same()||w("updateValues",n))},T=H=>`<span class="iconify" data-icon=${H}/>`,y=(H,re)=>H!=null&&re!=null&&H.length&&re.length?`<span class="dropdown-prefix-wrapper">${re==="iconify"?T(H):H}</span>`:"",F=(H,re)=>re?[{value:g,label:`<b>${N==="fr"?"Tout sélectionner":"Select all"}</b>`},{value:v,label:`<b>${N==="fr"?"Tout retirer":"Remove all"}</b>`},...H]:H,Y=(H,re)=>F(H,re).map(z=>(z.id=`dropdown-choice-${window.crypto.randomUUID()}`,z.label=`<span>
                ${y(z.prefix||"",z.prefixType||"")}
                <span class="dropdown-prefix-text">${z.label}</span>
            </span>`,z));function se(H,re,z){return H=structuredClone(H),re=structuredClone(re),H=Y(H,z).map(B=>re.includes(B.value)?{...B,selected:!0}:{...B,selected:!1}),t(3,n=re),H}function U(H,re,z,B){H&&(re=se(re,z,B),H.clearStore().setChoices(re))}const x=(H,re,z,B,te,he)=>(B=structuredClone(B),z=structuredClone(z),H.detail.value===te?(I(),z=z.map(be=>[te,he].includes(be.value)?{...be,selected:!1}:{...be,selected:!0}),re.removeActiveItems().clearChoices(!0,!0).setValue(z).hideDropdown(),B=[...new Set(z.filter(be=>be.selected===!0).map(be=>be.value))]):H.detail.value===he?(re.removeActiveItems().hideDropdown(),B=[]):B=o===!0?[...B,H.detail.value]:[H.detail.value],[...new Set(B)]),Z=(H,re)=>structuredClone(re).filter(z=>z!==H.detail.value);function V(H,re){const z=document.getElementById(d);S=new wf(z,{items:[],choices:H,addChoices:!1,addItems:!1,removeItems:!0,removeItemButton:!0,searchEnabled:a,allowHTML:!0,shouldSort:!re,sorter:(B,te)=>B.label.localeCompare(te.label),placeholderValue:u,classNames:{item:["choices__item","dropdown-item"]},loadingText:N==="fr"?"Chargement...":"Loading...",noResultsText:N==="fr"?"Pas de résultats":"No results found",noChoicesText:N==="fr"?"Pas de choix pour faire la sélection":"No choices to choose from",itemSelectText:N==="fr"?"Cliquer pour sélectionner":"Press to select",uniqueItemText:N==="fr"?"Seules des valeurs uniques peuvent être ajoutées":"Only unique values can be added",customAddItemText:N==="fr"?"Les valeurs ne répondent pas aux conditions attendues":"Only values matching specific conditions can be added",removeItemIconText:N==="fr"?"Retirer l'item":"Remove item",addItemText:B=>N==="fr"?`Cliquer sur Entrer pour ajouter <b>${B}</b>`:`Press Enter to add <b>"${B}"</b>`,removeItemLabelText:B=>N==="fr"?`Retirer l'item: ${B}`:`Remove item: ${B}`,maxItemText:B=>N==="fr"?`Seulement ${B} items peuvent être ajoutées`:`Only ${B} items can be added`}),z.addEventListener("addItem",B=>{t(3,n=x(B,S,H,n,g,v))}),z.addEventListener("removeItem",B=>{t(3,n=Z(B,n))})}return st(()=>{const H=se(s,l,f);V(H,f)}),di(()=>{S.destroy(),S=void 0}),i.$$set=H=>{"choicesItems"in H&&t(6,s=H.choicesItems),"start"in H&&t(7,l=H.start),"multiple"in H&&t(0,o=H.multiple),"searchable"in H&&t(8,a=H.searchable),"lightDisplay"in H&&t(1,c=H.lightDisplay),"placeholder"in H&&t(9,u=H.placeholder),"title"in H&&t(2,h=H.title),"selectAll"in H&&t(10,f=H.selectAll)},i.$$.update=()=>{i.$$.dirty&2056&&R(n,r)},t(3,n=[]),t(11,r=!1),[o,c,h,n,d,p,s,l,a,u,f,r]}class Tn extends ae{constructor(e){super(),oe(this,e,Cf,Sf,le,{choicesItems:6,start:7,multiple:0,searchable:8,lightDisplay:1,placeholder:9,title:2,selectAll:10})}}function If(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v,w,S,P,M,I,R,T,y,F,Y,se,U,x,Z,V,H,re;return a=new Et({props:{minVal:0,maxVal:1,start:.5,emitOnUpdate:!0,title:N==="fr"?"Opacité":"Opacity"}}),a.$on("updateSlider",i[14]),u=new Et({props:{minVal:0,maxVal:360,start:0,step:1,emitOnUpdate:!0,title:"Rotation"}}),u.$on("updateSlider",i[15]),f=new Et({props:{minVal:0,maxVal:200,start:100,step:1,emitOnUpdate:!0,title:N==="fr"?"Redimensionner":"Scale"}}),f.$on("updateSlider",i[16]),p=new Et({props:{minVal:-100,maxVal:100,start:0,step:1,emitOnUpdate:!0,title:N==="fr"?"Translation horizontale":"Horizontal translate"}}),p.$on("updateSlider",i[17]),v=new Et({props:{minVal:-100,maxVal:100,start:0,step:1,emitOnUpdate:!0,title:N==="fr"?"Translation verticale":"Vertical translate"}}),v.$on("updateSlider",i[18]),S=new Tn({props:{choicesItems:i[10],start:[],lightDisplay:!0,placeholder:N==="fr"?"Sélectionner":"Select",title:N==="fr"?"Basculer":"Flip"}}),S.$on("updateValues",i[11]),{c(){e=b("div"),t=b("div"),n=b("div"),r=b("div"),s=b("strong"),s.textContent=`${N==="en"?"Query image transformation":"Modification de l'image requête"}`,l=D(),o=b("div"),G(a.$$.fragment),c=D(),G(u.$$.fragment),h=D(),G(f.$$.fragment),d=D(),G(p.$$.fragment),g=D(),G(v.$$.fragment),w=D(),G(S.$$.fragment),P=D(),M=b("div"),I=b("button"),I.textContent=`${N==="fr"?"Réinitialiser":"Reset"}`,R=D(),T=b("div"),y=b("img"),se=D(),U=b("img"),m(r,"class","toolbar-title mt-0 mb-2 svelte-t3h37q"),m(I,"class","button is-link"),m(M,"class","mt-2 is-flex is-flex-direction-column is-justify-content-center is-align-items-flex-end"),m(o,"class","toolbar-controls is-flex is-flex-direction-column is-align-items-start is-justify-content-center svelte-t3h37q"),m(n,"class","toolbar svelte-t3h37q"),m(t,"class","toolbar-wrapper is-flex is-flex-direction-column is-justify-content-center is-align-items-center svelte-t3h37q"),m(y,"class","compare-img svelte-t3h37q"),$e(y.src,F=i[8])||m(y,"src",F),m(y,"alt",Y=i[1].title),m(U,"class","main-img svelte-t3h37q"),$e(U.src,x=i[9])||m(U,"src",x),m(U,"alt",Z=i[0].title),Ce(U,"overlay-reset",i[6]),ve(U,"opacity",i[5]),ve(U,"transform",i[7]),m(T,"class","overlay-wrapper svelte-t3h37q"),m(e,"class","similarity-overlay-wrapper svelte-t3h37q")},m(z,B){C(z,e,B),_(e,t),_(t,n),_(n,r),_(r,s),_(n,l),_(n,o),K(a,o,null),_(o,c),K(u,o,null),_(o,h),K(f,o,null),_(o,d),K(p,o,null),_(o,g),K(v,o,null),_(o,w),K(S,o,null),_(o,P),_(o,M),_(M,I),_(e,R),_(e,T),_(T,y),_(T,se),_(T,U),V=!0,H||(re=ie(I,"click",i[12]),H=!0)},p(z,[B]){(!V||B&256&&!$e(y.src,F=z[8]))&&m(y,"src",F),(!V||B&2&&Y!==(Y=z[1].title))&&m(y,"alt",Y),(!V||B&512&&!$e(U.src,x=z[9]))&&m(U,"src",x),(!V||B&1&&Z!==(Z=z[0].title))&&m(U,"alt",Z),(!V||B&64)&&Ce(U,"overlay-reset",z[6]),B&32&&ve(U,"opacity",z[5]),B&128&&ve(U,"transform",z[7])},i(z){V||(O(a.$$.fragment,z),O(u.$$.fragment,z),O(f.$$.fragment,z),O(p.$$.fragment,z),O(v.$$.fragment,z),O(S.$$.fragment,z),V=!0)},o(z){L(a.$$.fragment,z),L(u.$$.fragment,z),L(f.$$.fragment,z),L(p.$$.fragment,z),L(v.$$.fragment,z),L(S.$$.fragment,z),V=!1},d(z){z&&E(e),W(a),W(u),W(f),W(p),W(v),W(S),H=!1,re()}}}function Of(i,e,t){let n,r,s,{queryItem:l}=e,{similarItem:o}=e;const a=[{value:"h",label:N==="fr"?"Basculer horizontalement":"Flip horizontally"},{value:"v",label:N==="fr"?"Basculer verticalement":"Flip vertically"},{value:"hv",label:N==="fr"?"Basculer H+V":"Flip H+V"}];let c=.5,u=0,h=100,f=[1,1],d=[0,0],p=!1;const g=R=>{const T=R.detail[0];t(13,f=T==="hv"?[-1,-1]:T==="h"?[-1,1]:T==="v"?[1,-1]:[1,1])},v=()=>{t(5,c=.5),t(2,u=0),t(3,h=100),t(13,f=[1,1]),t(4,d=[0,0]),t(6,p=!0),setTimeout(()=>t(6,p=!1),300)},w=R=>t(5,c=R.detail),S=R=>t(2,u=R.detail),P=R=>t(3,h=R.detail),M=R=>t(4,d=[R.detail,d[1]]),I=R=>t(4,d=[d[0],R.detail]);return i.$$set=R=>{"queryItem"in R&&t(0,l=R.queryItem),"similarItem"in R&&t(1,o=R.similarItem)},i.$$.update=()=>{var R,T;i.$$.dirty&1&&t(9,n=dt(l.img,((R=l.xywh)==null?void 0:R.join(","))||"full","full")),i.$$.dirty&2&&t(8,r=dt(o.img,((T=o.xywh)==null?void 0:T.join(","))||"full","full")),i.$$.dirty&8220&&t(7,s=`translate(${d[0]-50}%, ${d[1]}%)
                        rotate(${u}deg)
                        scale(${f.map(y=>y*(h/100)).join()})`)},[l,o,u,h,d,c,p,s,r,n,a,g,v,f,w,S,P,M,I]}class Af extends ae{constructor(e){super(),oe(this,e,Of,If,le,{queryItem:0,similarItem:1})}}function Tf(i){let e,t,n,r,s,l,o,a,c,u,h;return s=new qt({props:{item:i[0],height:"full",isInModal:!0}}),u=new qt({props:{item:i[1],height:"full",isInModal:!0}}),{c(){e=b("div"),t=b("div"),n=b("span"),n.textContent=`${N==="en"?"Query image":"Image requête"}`,r=D(),G(s.$$.fragment),l=D(),o=b("div"),a=b("span"),a.textContent=`${N==="en"?"Similarity":"Similarité"}`,c=D(),G(u.$$.fragment),m(t,"class","column is-flex is-flex-direction-column is-justify-content-center is-align-items-center"),m(o,"class","column is-flex is-flex-direction-column is-justify-content-center is-align-items-center"),m(e,"class","side-by-side columns svelte-1wmtj1c")},m(f,d){C(f,e,d),_(e,t),_(t,n),_(t,r),K(s,t,null),_(e,l),_(e,o),_(o,a),_(o,c),K(u,o,null),h=!0},p(f,d){const p={};d&1&&(p.item=f[0]),s.$set(p);const g={};d&2&&(g.item=f[1]),u.$set(g)},i(f){h||(O(s.$$.fragment,f),O(u.$$.fragment,f),h=!0)},o(f){L(s.$$.fragment,f),L(u.$$.fragment,f),h=!1},d(f){f&&E(e),W(s),W(u)}}}function Mf(i){let e,t;return e=new Af({props:{queryItem:i[0],similarItem:i[1]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.queryItem=n[0]),r&2&&(s.similarItem=n[1]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Pf(i){let e,t,n,r,s,l,o,a;const c=[Mf,Tf],u=[];function h(f,d){return f[2]?0:1}return n=h(i),r=u[n]=c[n](i),o=new gl({props:{start:!1,buttonDisplay:!0,toggleLabel:N==="en"?"Overlay view":"Vue superposée"}}),o.$on("updateChecked",i[3]),{c(){e=b("div"),t=b("div"),r.c(),s=D(),l=b("div"),G(o.$$.fragment),m(t,"class","modal-similarity-images svelte-1wmtj1c"),Ce(t,"overlay-wrapper",i[2]),Ce(t,"side-by-side-wrapper",!i[2]),m(e,"class","modal-similarity svelte-1wmtj1c")},m(f,d){C(f,e,d),_(e,t),u[n].m(t,null),_(e,s),_(e,l),K(o,l,null),a=!0},p(f,[d]){let p=n;n=h(f),n===p?u[n].p(f,d):(pe(),L(u[p],1,1,()=>{u[p]=null}),ge(),r=u[n],r?r.p(f,d):(r=u[n]=c[n](f),r.c()),O(r,1),r.m(t,null)),(!a||d&4)&&Ce(t,"overlay-wrapper",f[2]),(!a||d&4)&&Ce(t,"side-by-side-wrapper",!f[2])},i(f){a||(O(r),O(o.$$.fragment,f),a=!0)},o(f){L(r),L(o.$$.fragment,f),a=!1},d(f){f&&E(e),u[n].d(),W(o)}}}function Lf(i,e,t){let{queryItem:n}=e,{similarItem:r}=e,s=!1;const l=()=>t(2,s=!s);return i.$$set=o=>{"queryItem"in o&&t(0,n=o.queryItem),"similarItem"in o&&t(1,r=o.similarItem)},[n,r,s,l]}class Rf extends ae{constructor(e){super(),oe(this,e,Lf,Pf,le,{queryItem:0,similarItem:1})}}function $f(i){let e,t,n,r,s,l;return s=new Ul({props:{qImg:i[0].img,isInModal:!0}}),{c(){e=b("div"),t=b("a"),n=b("button"),n.textContent=`${N==="fr"?"Voir toutes les similarités pour ce document":"View all similarities for this document"}`,r=D(),G(s.$$.fragment),m(n,"class","button is-link is-small"),m(t,"href",i[1]()),m(e,"class","is-flex is-align-items-center is-justify-content-end")},m(o,a){C(o,e,a),_(e,t),_(t,n),C(o,r,a),K(s,o,a),l=!0},p(o,[a]){const c={};a&1&&(c.qImg=o[0].img),s.$set(c)},i(o){l||(O(s.$$.fragment,o),l=!0)},o(o){L(s.$$.fragment,o),l=!1},d(o){o&&E(e),o&&E(r),W(s,o)}}}function Df(i,e,t){let{mainImgItem:n}=e;function r(){const s=n.img.match(/wit(\d+)/)[1],l=new URL(window.location.origin);return l.pathname=`${new URL(window.location).pathname.split("/")[1]}/witness/${s}/regions/`,l.searchParams.set("tab","similarity"),l.href}return i.$$set=s=>{"mainImgItem"in s&&t(0,n=s.mainImgItem)},[n,r]}class Nf extends ae{constructor(e){super(),oe(this,e,Df,$f,le,{mainImgItem:0})}}const jf=i=>({activeTab:i&1}),Xr=i=>({activeTab:i[0]});function Qr(i,e,t){const n=i.slice();return n[5]=e[t].id,n[6]=e[t].label,n}function Zr(i){let e,t,n,r=i[1],s=[];for(let l=0;l<r.length;l+=1)s[l]=es(Qr(i,r,l));return{c(){e=b("nav"),t=b("div"),n=b("ul");for(let l=0;l<s.length;l+=1)s[l].c();m(n,"class","svelte-d8a4vd"),m(t,"class","tabs svelte-d8a4vd"),m(e,"class","tabs-bar")},m(l,o){C(l,e,o),_(e,t),_(t,n);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,null)},p(l,o){if(o&3){r=l[1];let a;for(a=0;a<r.length;a+=1){const c=Qr(l,r,a);s[a]?s[a].p(c,o):(s[a]=es(c),s[a].c(),s[a].m(n,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}},d(l){l&&E(e),et(s,l)}}}function es(i){let e,t,n=i[6]+"",r,s,l,o;function a(){return i[4](i[5])}return{c(){e=b("li"),t=b("a"),r=J(n),s=D(),m(t,"href",null),Ce(e,"is-active",i[0]===i[5])},m(c,u){C(c,e,u),_(e,t),_(t,r),_(e,s),l||(o=ie(t,"click",wt(a)),l=!0)},p(c,u){i=c,u&2&&n!==(n=i[6]+"")&&fe(r,n),u&3&&Ce(e,"is-active",i[0]===i[5])},d(c){c&&E(e),l=!1,o()}}}function Vf(i){let e,t,n,r=i[1].length>1&&Zr(i);const s=i[3].default,l=He(s,i,i[2],Xr);return{c(){r&&r.c(),e=D(),t=b("div"),l&&l.c(),m(t,"class","tab-content svelte-d8a4vd")},m(o,a){r&&r.m(o,a),C(o,e,a),C(o,t,a),l&&l.m(t,null),n=!0},p(o,[a]){o[1].length>1?r?r.p(o,a):(r=Zr(o),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),l&&l.p&&(!n||a&5)&&qe(l,s,o,o[2],n?Be(s,o[2],a,jf):ze(o[2]),Xr)},i(o){n||(O(l,o),n=!0)},o(o){L(l,o),n=!1},d(o){r&&r.d(o),o&&E(e),o&&E(t),l&&l.d(o)}}}function Ff(i,e,t){var a;let{$$slots:n={},$$scope:r}=e,{tabs:s=[]}=e,{activeTab:l=((a=s[0])==null?void 0:a.id)??""}=e;const o=c=>t(0,l=c);return i.$$set=c=>{"tabs"in c&&t(1,s=c.tabs),"activeTab"in c&&t(0,l=c.activeTab),"$$scope"in c&&t(2,r=c.$$scope)},[l,s,r,n,o]}class jl extends ae{constructor(e){super(),oe(this,e,Ff,Vf,le,{tabs:1,activeTab:0})}}function ts(i,e,t){const n=i.slice();return n[34]=e[t].uuid,n[35]=e[t].data[0],n[36]=e[t].data[1],n[37]=e[t].data[2],n[38]=e[t].data[3],n[39]=e[t].data[4],n[40]=e[t].data[5],n[41]=e[t].data[6],n[42]=e[t].data[7],n[43]=e[t].data[8],n[45]=t,n}function Uf(i){let e,t=N==="en"?`Error when retrieving similar regions: ${i[5]}`:`Erreur de recupération des régions similaires: ${i[5]}`,n;return{c(){e=b("div"),n=J(t),m(e,"class","faded is-center")},m(r,s){C(r,e,s),_(e,n)},p(r,s){s[0]&32&&t!==(t=N==="en"?`Error when retrieving similar regions: ${r[5]}`:`Erreur de recupération des régions similaires: ${r[5]}`)&&fe(n,t)},i:j,o:j,d(r){r&&E(e)}}}function Hf(i){let e,t,n=i[4].length+"",r,s,l=i[18](i[16],i[4].length)+"",o,a,c,u=[],h=new Map,f,d,p,g,v,w=i[4];const S=T=>T[34];for(let T=0;T<w.length;T+=1){let y=ts(i,w,T),F=S(y);h.set(F,u[T]=ns(F,y))}let P=null;w.length||(P=is(i));function M(T){i[25](T)}function I(T){i[26](T)}let R={items:i[9],$$slots:{default:[Jf,({item:T})=>({32:T}),({item:T})=>[0,T?2:0]]},$$scope:{ctx:i}};return i[3]!==void 0&&(R.currentIndex=i[3]),i[6]!==void 0&&(R.open=i[6]),d=new Cn({props:R}),ft.push(()=>jt(d,"currentIndex",M)),ft.push(()=>jt(d,"open",I)),{c(){e=b("div"),t=b("span"),r=J(n),s=D(),o=J(l),a=D(),c=b("div");for(let T=0;T<u.length;T+=1)u[T].c();P&&P.c(),f=D(),G(d.$$.fragment),m(t,"class","m-2"),m(c,"class","m-2 is-gap-2"),Ce(c,"grid",i[4].length>0)},m(T,y){C(T,e,y),_(e,t),_(t,r),_(t,s),_(t,o),_(e,a),_(e,c);for(let F=0;F<u.length;F+=1)u[F]&&u[F].m(c,null);P&&P.m(c,null),C(T,f,y),K(d,T,y),v=!0},p(T,y){(!v||y[0]&16)&&n!==(n=T[4].length+"")&&fe(r,n),(!v||y[0]&16)&&l!==(l=T[18](T[16],T[4].length)+"")&&fe(o,l),y[0]&526357&&(w=T[4],pe(),u=hi(u,y,S,1,T,w,h,c,Fi,ns,null,ts),ge(),!w.length&&P?P.p(T,y):w.length?P&&(P.d(1),P=null):(P=is(T),P.c(),P.m(c,null))),(!v||y[0]&16)&&Ce(c,"grid",T[4].length>0);const F={};y[0]&512&&(F.items=T[9]),y[0]&384|y[1]&32770&&(F.$$scope={dirty:y,ctx:T}),!p&&y[0]&8&&(p=!0,F.currentIndex=T[3],Nt(()=>p=!1)),!g&&y[0]&64&&(g=!0,F.open=T[6],Nt(()=>g=!1)),d.$set(F)},i(T){if(!v){for(let y=0;y<w.length;y+=1)O(u[y]);O(d.$$.fragment,T),v=!0}},o(T){for(let y=0;y<u.length;y+=1)L(u[y]);L(d.$$.fragment,T),v=!1},d(T){T&&E(e);for(let y=0;y<u.length;y+=1)u[y].d();P&&P.d(),T&&E(f),W(d,T)}}}function Bf(i){let e;function t(s,l){return s[16]?Qf:Xf}let r=t(i)(i);return{c(){e=b("div"),r.c(),m(e,"class","faded is-center")},m(s,l){C(s,e,l),r.m(e,null)},p(s,l){r.p(s,l)},i:j,o:j,d(s){s&&E(e),r.d()}}}function is(i){let e;function t(s,l){return s[11]?zf:qf}let n=t(i),r=n(i);return{c(){r.c(),e=_e()},m(s,l){r.m(s,l),C(s,e,l)},p(s,l){n===(n=t(s))&&r?r.p(s,l):(r.d(1),r=n(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&E(e)}}}function qf(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No similar regions":"Pas de régions similaires"}
                    `,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,d(t){t&&E(e)}}}function zf(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No document selected. Select one to display results.":"Aucun document sélectionné. Sélectionnez-en un pour afficher les résultats."}
                    `,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,d(t){t&&E(e)}}}function ns(i,e){let t,n,r;return n=new Ya({props:{qImg:e[0],sImg:e[37],score:e[35],qRegions:e[38],sRegions:e[39],category:e[40],users:e[41],isManual:e[42],similarityType:e[43],index:e[45],isInModal:e[2]}}),n.$on("openModal",e[19]),{key:i,first:null,c(){t=_e(),G(n.$$.fragment),this.first=t},m(s,l){C(s,t,l),K(n,s,l),r=!0},p(s,l){e=s;const o={};l[0]&1&&(o.qImg=e[0]),l[0]&16&&(o.sImg=e[37]),l[0]&16&&(o.score=e[35]),l[0]&16&&(o.qRegions=e[38]),l[0]&16&&(o.sRegions=e[39]),l[0]&16&&(o.category=e[40]),l[0]&16&&(o.users=e[41]),l[0]&16&&(o.isManual=e[42]),l[0]&16&&(o.similarityType=e[43]),l[0]&16&&(o.index=e[45]),l[0]&4&&(o.isInModal=e[2]),n.$set(o)},i(s){r||(O(n.$$.fragment,s),r=!0)},o(s){L(n.$$.fragment,s),r=!1},d(s){s&&E(t),W(n,s)}}}function Kf(i){let e,t;return e=new Nf({props:{mainImgItem:i[32]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r[1]&2&&(s.mainImgItem=n[32]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Wf(i){let e,t;return e=new Rf({props:{queryItem:i[17],similarItem:i[32],score:i[8]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r[1]&2&&(s.similarItem=n[32]),r[0]&256&&(s.score=n[8]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Gf(i){let e,t;return e=new pl({props:{item:i[32]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r[1]&2&&(s.item=n[32]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Yf(i){let e,t,n;return t=new qt({props:{item:i[32],height:"full",isInModal:!0}}),{c(){e=b("div"),G(t.$$.fragment),m(e,"class","modal-region svelte-jba7xn")},m(r,s){C(r,e,s),K(t,e,null),n=!0},p(r,s){const l={};s[1]&2&&(l.item=r[32]),t.$set(l)},i(r){n||(O(t.$$.fragment,r),n=!0)},o(r){L(t.$$.fragment,r),n=!1},d(r){r&&E(e),W(t)}}}function xf(i){let e,t,n,r;const s=[Yf,Gf,Wf,Kf],l=[];function o(a,c){return a[33]==="region"?0:a[33]==="page"?1:a[33]==="similarity"&&a[17]?2:a[33]==="expansion"?3:-1}return~(e=o(i))&&(t=l[e]=s[e](i)),{c(){t&&t.c(),n=_e()},m(a,c){~e&&l[e].m(a,c),C(a,n,c),r=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(t&&(pe(),L(l[u],1,1,()=>{l[u]=null}),ge()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=s[e](a),t.c()),O(t,1),t.m(n.parentNode,n)):t=null)},i(a){r||(O(t),r=!0)},o(a){L(t),r=!1},d(a){~e&&l[e].d(a),a&&E(n)}}}function Jf(i){let e,t;return e=new jl({props:{tabs:i[7],$$slots:{default:[xf,({activeTab:n})=>({33:n}),({activeTab:n})=>[0,n?4:0]]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r[0]&128&&(s.tabs=n[7]),r[0]&256|r[1]&32774&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Xf(i){let e=N==="en"?"Retrieving similar regions...":"Récupération des régions similaires...",t;return{c(){t=J(e)},m(n,r){C(n,t,r)},p:j,d(n){n&&E(t)}}}function Qf(i){let e=N==="en"?"Retrieving propagated regions...":"Récupération de similarités propagées...",t;return{c(){t=J(e)},m(n,r){C(n,t,r)},p:j,d(n){n&&E(t)}}}function Zf(i){let e,t,n,r;const s=[Bf,Hf,Uf],l=[];function o(a,c){return a[1]&&a[10]==="loading"?0:a[10]==="loaded"?1:a[10]==="error"?2:-1}return~(e=o(i))&&(t=l[e]=s[e](i)),{c(){t&&t.c(),n=_e()},m(a,c){~e&&l[e].m(a,c),C(a,n,c),r=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(t&&(pe(),L(l[u],1,1,()=>{l[u]=null}),ge()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=s[e](a),t.c()),O(t,1),t.m(n.parentNode,n)):t=null)},i(a){r||(O(t),r=!0)},o(a){L(t),r=!1},d(a){~e&&l[e].d(a),a&&E(n)}}}function ed(i,e,t){let n,r,s,l,o,a,c,u,h,f,d,{qImg:p}=e,{sImgsPromise:g}=e,{isInModal:v=!1}=e;const{selectedRegions:w,excludedCategories:S,similarityScoreCutoff:P,propagateFilterByRegions:M}=xe;ue(i,w,B=>t(24,d=B)),ue(i,S,B=>t(23,f=B)),ue(i,P,B=>t(22,h=B)),ue(i,M,B=>t(21,u=B));const I=Je("similarityPropagatedContext")||!1,R=window.location.pathname.match(/\d+/g).join("-"),T=Je("qImgMetadata")||null;let y;const F=(B,te)=>B===null||te===void 0||Number(B)>=te,Y=(B,te,he)=>!he.includes(B),se=(B,te,he,be,Gt,Yt)=>I?!0:F(B,Gt)&&Y(te,he,be),U=(B,te,he,be)=>B.filter(({uuid:Gt,data:[Yt,xt,Jt,pi,lt,Xt,Qt,gi,_i]})=>se(Yt,Xt,Qt,te,he)),x=(B,te)=>{const he=te>1;return B?N==="fr"?he?"similarités propagées":"similarité propagée":he?"propagated matches":"propagated match":N==="fr"?he?"images similaires":"image similaire":he?"similar images":"similar image"};let Z=!1,V=0;const H=B=>{t(3,V=B.detail.index??0),t(6,Z=!0)};function re(B){V=B,t(3,V)}function z(B){Z=B,t(6,Z)}return i.$$set=B=>{"qImg"in B&&t(0,p=B.qImg),"sImgsPromise"in B&&t(1,g=B.sImgsPromise),"isInModal"in B&&t(2,v=B.isInModal)},i.$$.update=()=>{var B;i.$$.dirty[0]&16777216&&t(11,n=Object.values(d).length===0||d[R]===void 0||!Object.keys(d[R]).length),i.$$.dirty[0]&2&&(te=>{t(10,r="loading"),t(4,l=[]),t(20,s=[])})(),i.$$.dirty[0]&2&&g.then(te=>{t(20,s=te.map(he=>({uuid:window.crypto.randomUUID(),data:he}))),t(10,r="loaded")}).catch(te=>{t(5,y=te),t(10,r="error")}),i.$$.dirty[0]&15728640&&t(4,l=U(s,f,h)),i.$$.dirty[0]&16&&t(9,o=l.map(({data:[te,he,be,Gt,Yt,xt,Jt,pi,lt]})=>{const[Xt,Qt,gi,_i]=be.split(".")[0].split("_");return En(be,Xt,_i,gi)})),i.$$.dirty[0]&24&&t(8,a=((B=l[V])==null?void 0:B.data[0])??null)},t(10,r="loading"),t(20,s=[]),t(7,c=[{id:"region",label:N==="en"?"Main view":"Vue principale"},{id:"page",label:N==="en"?"Page View":"Vue de la page"},{id:"similarity",label:N==="en"?"Comparison":"Comparaison"},{id:"expansion",label:N==="en"?"Query Expansion":"Expansion de requête"}]),[p,g,v,V,l,y,Z,c,a,o,r,n,w,S,P,M,I,T,x,H,s,u,h,f,d,re,z]}class Vl extends ae{constructor(e){super(),oe(this,e,ed,Zf,le,{qImg:0,sImgsPromise:1,isInModal:2},null,[-1,-1])}}function td(i){let e,t;return e=new Vl({props:{qImg:i[0],sImgsPromise:i[2],isInModal:i[1]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,[r]){const s={};r&1&&(s.qImg=n[0]),r&4&&(s.sImgsPromise=n[2]),r&2&&(s.isInModal=n[1]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function id(i,e,t){let n,{qImg:r}=e,{isInModal:s=!1}=e,l;const{selectedRegions:o}=xe;ue(i,o,h=>t(4,n=h));const a=`${window.location.origin}${window.location.pathname}`,c=window.location.pathname.match(/\d+/g).join("-");async function u(h,f,d){const p=Object.values(f[c]||{}).map(v=>v.id);return!d&&p.length===0?[]:await(await fetch(`${a}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:p,filterByRegions:!d,qImg:h,topk:10}),headers:{"Content-Type":"application/json","X-CSRFToken":Xe}})).json()}return s?l=u(r,n,s):o.subscribe(h=>{t(2,l=u(r,h,s))}),i.$$set=h=>{"qImg"in h&&t(0,r=h.qImg),"isInModal"in h&&t(1,s=h.isInModal)},[r,s,l,o]}class nd extends ae{constructor(e){super(),oe(this,e,id,td,le,{qImg:0,isInModal:1})}}function rd(i){let e,t,n,r;return n=new Vl({props:{qImg:i[0],sImgsPromise:i[1]}}),{c(){e=b("div"),t=b("div"),G(n.$$.fragment),m(t,"class","matches-suggestion svelte-1cb4wg0"),m(e,"class","block matches-suggestion-wrapper svelte-1cb4wg0")},m(s,l){C(s,e,l),_(e,t),K(n,t,null),r=!0},p(s,[l]){const o={};l&1&&(o.qImg=s[0]),l&2&&(o.sImgsPromise=s[1]),n.$set(o)},i(s){r||(O(n.$$.fragment,s),r=!0)},o(s){L(n.$$.fragment,s),r=!1},d(s){s&&E(e),W(n)}}}function sd(i,e,t){let n,r,{qImg:s}=e,{isInModal:l=!1}=e;const{propagateParams:o,selectedRegions:a}=xe;ue(i,o,v=>t(5,n=v)),ue(i,a,v=>t(6,r=v));const c=`${window.location.origin}${window.location.pathname}`,u=window.location.pathname.match(/\d+/g).join("-");let h;const f=Ri();f.setCompareFn((v,w)=>[v,w].every(S=>S&&S.hasOwnProperty("propagateRecursionDepth")&&S.hasOwnProperty("propagateFilterByRegions"))?v.propagateRecursionDepth===w.propagateRecursionDepth&&v.propagateFilterByRegions===w.propagateFilterByRegions:!1);const d=Ri();d.setCompareFn(kn),at("similarityPropagatedContext",!0);const p=v=>Object.keys(v).includes(u)?Object.values(v[u]).map(w=>w.id):[],g=async(v,w,S)=>fetch(`${c}propagated-matches/${s}`,{method:"POST",body:JSON.stringify({regionsIds:S?[]:w,filterByRegions:S?!1:v.propagateFilterByRegions,recursionDepth:v.propagateRecursionDepth}),headers:{"Content-Type":"application/json","X-CSRFToken":Xe}}).then(P=>P.json()).catch(P=>(console.error("PropagatedMatches.getPropagatedMatches:",P),[]));return o.subscribe(v=>{f.set(v),f.same()||t(1,h=g(f.get(),p(r),l))}),a.subscribe(v=>{d.set(p(v)),n.propagateFilterByRegions===!0&&!d.same()&&t(1,h=g(n,d.get(),l))}),i.$$set=v=>{"qImg"in v&&t(0,s=v.qImg),"isInModal"in v&&t(4,l=v.isInModal)},[s,h,o,a,l]}class ld extends ae{constructor(e){super(),oe(this,e,sd,rd,le,{qImg:0,isInModal:4})}}const od=i=>({}),rs=i=>({}),ad=i=>({}),ss=i=>({}),cd=i=>({}),ls=i=>({});function ud(i){let e;const t=i[4]["row-body"],n=He(t,i,i[3],rs);return{c(){n&&n.c()},m(r,s){n&&n.m(r,s),e=!0},p(r,s){n&&n.p&&(!e||s&8)&&qe(n,t,r,r[3],e?Be(t,r[3],s,od):ze(r[3]),rs)},i(r){e||(O(n,r),e=!0)},o(r){L(n,r),e=!1},d(r){n&&n.d(r)}}}function fd(i){let e,t,n,r;const s=i[4]["row-body"],l=He(s,i,i[3],ss);return{c(){e=b("div"),t=b("div"),l&&l.c(),m(t,"class","grid is-gap-2"),m(e,"class",n="fixed-grid has-"+i[2]+"-cols")},m(o,a){C(o,e,a),_(e,t),l&&l.m(t,null),r=!0},p(o,a){l&&l.p&&(!r||a&8)&&qe(l,s,o,o[3],r?Be(s,o[3],a,ad):ze(o[3]),ss),(!r||a&4&&n!==(n="fixed-grid has-"+o[2]+"-cols"))&&m(e,"class",n)},i(o){r||(O(l,o),r=!0)},o(o){L(l,o),r=!1},d(o){o&&E(e),l&&l.d(o)}}}function dd(i){let e,t,n,r,s,l,o,a,c,u;rt(i[5]);const h=i[4]["row-header"],f=He(h,i,i[3],ls),d=[fd,ud],p=[];function g(v,w){return v[0]?0:1}return l=g(i),o=p[l]=d[l](i),{c(){e=b("tr"),t=b("th"),n=b("div"),f&&f.c(),r=D(),s=b("td"),o.c(),m(n,"class","content-wrapper py-5"),m(t,"class","is-3 center-flex is-narrow"),ve(t,"width","15vw"),m(s,"class","p-5 is-fullwidth")},m(v,w){C(v,e,w),_(e,t),_(t,n),f&&f.m(n,null),_(e,r),_(e,s),p[l].m(s,null),a=!0,c||(u=ie(window,"resize",i[5]),c=!0)},p(v,[w]){f&&f.p&&(!a||w&8)&&qe(f,h,v,v[3],a?Be(h,v[3],w,cd):ze(v[3]),ls);let S=l;l=g(v),l===S?p[l].p(v,w):(pe(),L(p[S],1,1,()=>{p[S]=null}),ge(),o=p[l],o?o.p(v,w):(o=p[l]=d[l](v),o.c()),O(o,1),o.m(s,null))},i(v){a||(O(f,v),O(o),a=!0)},o(v){L(f,v),L(o),a=!1},d(v){v&&E(e),f&&f.d(v),p[l].d(),c=!1,u()}}}function hd(i,e,t){let n,{$$slots:r={},$$scope:s}=e,{useGrid:l=!0}=e,o=0;function a(){t(1,o=window.innerWidth)}return i.$$set=c=>{"useGrid"in c&&t(0,l=c.useGrid),"$$scope"in c&&t(3,s=c.$$scope)},i.$$.update=()=>{i.$$.dirty&2&&t(2,n=Zs(o))},[l,o,n,s,r,a]}class Fl extends ae{constructor(e){super(),oe(this,e,hd,dd,le,{useGrid:0})}}function md(i){let e,t,n,r=parseInt(i[6])+"",s,l,o,a,c,u,h,f,d,p,g,v,w,S,P,M,I,R,T;return{c(){e=b("a"),t=b("i"),n=J(`
            Page `),s=J(r),l=D(),o=b("img"),c=D(),u=b("div"),h=b("div"),f=b("input"),d=D(),p=b("button"),p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',g=D(),v=b("button"),w=Ue("svg"),S=Ue("path"),m(t,"class","fa-solid fa-pen-to-square"),m(e,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),m(e,"href",Ht(i[7],parseInt(i[6]))),m(e,"target","_blank"),$e(o.src,a=dt(i[0],i[0].split("_").pop(),"250,"))||m(o,"src",a),m(o,"alt","Query region"),m(o,"class","mb-3 card query-image svelte-f4ylwc"),m(f,"class","input is-small tag"),m(f,"type","text"),m(f,"placeholder",N==="en"?"Add new match":"Ajouter une correspondance"),m(p,"class","button is-small tag is-link is-center"),m(h,"class","tags has-addons"),ve(h,"flex-wrap","nowrap"),m(S,"fill","white"),m(S,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),m(w,"xmlns","http://www.w3.org/2000/svg"),m(w,"viewBox","0 0 384 512"),m(v,"id","no-match"),m(v,"class",P="button is-small tag is-danger is-center m-0 "+(i[4]===1?"visible":"")+" svelte-f4ylwc"),m(v,"title",N==="en"?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),m(u,"class","new-similarity control pt-2 is-center svelte-f4ylwc")},m(y,F){C(y,e,F),_(e,t),_(e,n),_(e,s),C(y,l,F),C(y,o,F),C(y,c,F),C(y,u,F),_(u,h),_(h,f),Dt(f,i[2]),_(h,d),_(h,p),_(u,g),_(u,v),_(v,w),_(w,S),I=!0,R||(T=[ie(f,"input",i[12]),ie(p,"click",i[8]),ie(v,"click",i[9])],R=!0)},p(y,F){(!I||F&1&&!$e(o.src,a=dt(y[0],y[0].split("_").pop(),"250,")))&&m(o,"src",a),F&4&&f.value!==y[2]&&Dt(f,y[2]),(!I||F&16&&P!==(P="button is-small tag is-danger is-center m-0 "+(y[4]===1?"visible":"")+" svelte-f4ylwc"))&&m(v,"class",P)},i(y){I||(rt(()=>{I&&(M||(M=vt(v,Vt,{duration:500},!0)),M.run(1))}),I=!0)},o(y){M||(M=vt(v,Vt,{duration:500},!1)),M.run(0),I=!1},d(y){y&&E(e),y&&E(l),y&&E(o),y&&E(c),y&&E(u),y&&M&&M.end(),R=!1,Ie(T)}}}function pd(i){let e,t,n,r,s,l,o,a;return t=new nd({props:{qImg:i[0],isInModal:i[1]}}),l=new ld({props:{qImg:i[0],isInModal:i[1]}}),{c(){e=b("div"),G(t.$$.fragment),r=D(),s=b("div"),G(l.$$.fragment),m(e,"class",n=ki(i[1]?"":i[3])+" svelte-f4ylwc"),m(s,"class",o=ki(i[1]?"":i[3])+" svelte-f4ylwc")},m(c,u){C(c,e,u),K(t,e,null),C(c,r,u),C(c,s,u),K(l,s,null),a=!0},p(c,u){const h={};u&1&&(h.qImg=c[0]),u&2&&(h.isInModal=c[1]),t.$set(h),(!a||u&10&&n!==(n=ki(c[1]?"":c[3])+" svelte-f4ylwc"))&&m(e,"class",n);const f={};u&1&&(f.qImg=c[0]),u&2&&(f.isInModal=c[1]),l.$set(f),(!a||u&10&&o!==(o=ki(c[1]?"":c[3])+" svelte-f4ylwc"))&&m(s,"class",o)},i(c){a||(O(t.$$.fragment,c),O(l.$$.fragment,c),a=!0)},o(c){L(t.$$.fragment,c),L(l.$$.fragment,c),a=!1},d(c){c&&E(e),W(t),c&&E(r),c&&E(s),W(l)}}}function gd(i){let e,t;return e=new Fl({props:{useGrid:!1,$$slots:{"row-body":[pd],"row-header":[md]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,[r]){const s={};r&524319&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function _d(i){return i=i.replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(i)}function vd(i,e,t){let n,r,s,l;const{selectedRegions:o}=xe;ue(i,o,R=>t(11,l=R));let{qImg:a}=e,{isInModal:c=!1}=e,u="";const[h,f,d,p]=a.split(".")[0].split("_"),g=`${window.location.origin}${window.location.pathname}`,v=window.location.pathname.match(/\d+/g).join("-"),w=N==="en"?"Error":"Erreur",S=Je("manifest");at("qImgMetadata",En(a,h,p,d));async function P(){if(!u||!_d(u)){await Re(N==="en"?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error");return}try{const R=await fetch(`${g}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify({q_img:a.replace(".jpg",""),s_img:u,similarity_type:2})});R.ok||(console.error("Error: Network response was not ok"),await Re(N==="en"?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",w));const T=await R.json();if(T.hasOwnProperty("error")||!T.hasOwnProperty("s_regions")){await Re(N==="en"?`Request was unsuccessful, match was not added:<br>${T.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${T.error}`,w);return}const y=T.s_regions;xe.addComparedRegions(y),xe.select(y)}catch(R){console.error("Error:",R),await Re(N==="en"?`An error has occurred, match was not added:<br>${R}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${R}`,w)}}async function M(){const R=Object.values(l[v])[0];if(await Re(N==="en"?`Do you confirm this region does not have any match in ${R.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${R.title} ?`,N==="en"?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${g}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify({q_img:a,s_regions:R.id})})).ok||(console.error("Error: Network response was not ok"),await Re(N==="en"?"Problem with network":"Problème de réseau",w)),xe.select(R)}catch(y){console.error("Error:",y),await Re(N==="en"?`An error has occurred, request was unsuccessful:<br>${y}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${y}`,w)}}function I(){u=this.value,t(2,u)}return i.$$set=R=>{"qImg"in R&&t(0,a=R.qImg),"isInModal"in R&&t(1,c=R.isInModal)},i.$$.update=()=>{i.$$.dirty&2048&&t(4,n=l.hasOwnProperty(v)?Object.values(l[v]).length:0),i.$$.dirty&1024&&t(3,s=`fixed-grid has-${r-1}-cols`)},t(10,r=Zs(window.innerWidth)),[a,c,u,s,n,o,d,S,P,M,r,l,I]}class Ul extends ae{constructor(e){super(),oe(this,e,vd,gd,le,{qImg:0,isInModal:1})}}function os(i,e,t){const n=i.slice();return n[8]=e[t],n}function bd(i){let e,t,n=i[11]+"",r;return{c(){e=b("tr"),t=J("Error when retrieving similar regions: "),r=J(n)},m(s,l){C(s,e,l),_(e,t),_(e,r)},p(s,l){l&2&&n!==(n=s[11]+"")&&fe(r,n)},i:j,o:j,d(s){s&&E(e)}}}function wd(i){let e=[],t=new Map,n,r,s=i[2];const l=a=>a[8].id;for(let a=0;a<s.length;a+=1){let c=os(i,s,a),u=l(c);t.set(u,e[a]=cs(u,c))}let o=null;return s.length||(o=as()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=_e(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);C(a,n,c),o&&o.m(a,c),r=!0},p(a,c){c&4&&(s=a[2],pe(),e=hi(e,c,l,1,a,s,t,n.parentNode,Fi,cs,n,os),ge(),!s.length&&o?o.p(a,c):s.length?o&&(o.d(1),o=null):(o=as(),o.c(),o.m(n.parentNode,n)))},i(a){if(!r){for(let c=0;c<s.length;c+=1)O(e[c]);r=!0}},o(a){for(let c=0;c<e.length;c+=1)L(e[c]);r=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&E(n),o&&o.d(a)}}}function as(i){let e,t;return{c(){e=b("tr"),e.textContent=`${N==="en"?"No similarity":"Pas de similarités"}`,t=D(),m(e,"class","faded is-center")},m(n,r){C(n,e,r),C(n,t,r)},p:j,d(n){n&&E(e),n&&E(t)}}}function cs(i,e){let t,n,r;return n=new Ul({props:{qImg:e[8]}}),{key:i,first:null,c(){t=_e(),G(n.$$.fragment),this.first=t},m(s,l){C(s,t,l),K(n,s,l),r=!0},p(s,l){e=s;const o={};l&4&&(o.qImg=e[8]),n.$set(o)},i(s){r||(O(n.$$.fragment,s),r=!0)},o(s){L(n.$$.fragment,s),r=!1},d(s){s&&E(t),W(n,s)}}}function yd(i){let e;return{c(){e=b("tr"),e.textContent=`${N==="en"?"Retrieving similarity page...":"Récupération la page de similarité..."}`,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,i:j,o:j,d(t){t&&E(e)}}}function kd(i){let e,t,n,r={ctx:i,current:null,token:null,hasCatch:!0,pending:yd,then:wd,catch:bd,value:7,error:11,blocks:[,,,]};return Ze(t=i[1],r),{c(){e=_e(),r.block.c()},m(s,l){C(s,e,l),r.block.m(s,r.anchor=l),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(s,l){i=s,r.ctx=i,l&2&&t!==(t=i[1])&&Ze(t,r)||At(r,i,l)},i(s){n||(O(r.block),n=!0)},o(s){for(let l=0;l<3;l+=1){const o=r.blocks[l];L(o)}n=!1},d(s){s&&E(e),r.block.d(s),r.token=null,r=null}}}function Sd(i){let e,t,n,r,s,l,o;return t=new Bt({props:{store:xe,nbOfItems:i[0].length,pageLength:i[6]}}),r=new Ui({props:{$$slots:{default:[kd]},$$scope:{ctx:i}}}),l=new Bt({props:{store:xe,nbOfItems:i[0].length,pageLength:i[6]}}),{c(){e=b("div"),G(t.$$.fragment),n=D(),G(r.$$.fragment),s=D(),G(l.$$.fragment)},m(a,c){C(a,e,c),K(t,e,null),_(e,n),K(r,e,null),_(e,s),K(l,e,null),o=!0},p(a,[c]){const u={};c&1&&(u.nbOfItems=a[0].length),t.$set(u);const h={};c&4102&&(h.$$scope={dirty:c,ctx:a}),r.$set(h);const f={};c&1&&(f.nbOfItems=a[0].length),l.$set(f)},i(a){o||(O(t.$$.fragment,a),O(r.$$.fragment,a),O(l.$$.fragment,a),o=!0)},o(a){L(t.$$.fragment,a),L(r.$$.fragment,a),L(l.$$.fragment,a),o=!1},d(a){a&&E(e),W(t),W(r),W(l)}}}function Ed(i,e,t){let n,r,s;const{qImgs:l,pageQImgs:o,setPageQImgs:a,pageLength:c}=xe;return ue(i,l,u=>t(0,n=u)),ue(i,o,u=>t(2,s=u)),ue(i,a,u=>t(1,r=u)),[n,r,s,l,o,a,c]}class Cd extends ae{constructor(e){super(),oe(this,e,Ed,Sd,le,{})}}function Id(i){let e,t,n,r,s,l;return s=new mi({props:{tooltipText:i[2]}}),{c(){e=b("div"),t=b("button"),n=b("span"),r=D(),G(s.$$.fragment),m(n,"class","iconify"),m(n,"data-icon",i[0]),m(n,"title",i[1]),m(t,"class","svelte-11ixywk"),m(e,"class","is-inline-block icon-tooltip svelte-11ixywk")},m(o,a){C(o,e,a),_(e,t),_(t,n),_(t,r),K(s,t,null),l=!0},p(o,[a]){(!l||a&1)&&m(n,"data-icon",o[0]),(!l||a&2)&&m(n,"title",o[1]);const c={};a&4&&(c.tooltipText=o[2]),s.$set(c)},i(o){l||(O(s.$$.fragment,o),l=!0)},o(o){L(s.$$.fragment,o),l=!1},d(o){o&&E(e),W(s)}}}function Od(i,e,t){let{iconifyIcon:n,altText:r,tooltipText:s}=e;return i.$$set=l=>{"iconifyIcon"in l&&t(0,n=l.iconifyIcon),"altText"in l&&t(1,r=l.altText),"tooltipText"in l&&t(2,s=l.tooltipText)},[n,r,s]}class Ad extends ae{constructor(e){super(),oe(this,e,Od,Id,le,{iconifyIcon:0,altText:1,tooltipText:2})}}const Td=i=>({}),us=i=>({}),Md=i=>({}),fs=i=>({});function ds(i){let e,t,n,r,s,l,o,a,c,u,h,f=i[1]&&hs(i);return a=new mi({props:{tooltipText:i[2][i[1]][N]}}),{c(){f&&f.c(),e=D(),t=b("div"),n=b("button"),r=Ue("svg"),s=Ue("path"),o=D(),G(a.$$.fragment),m(s,"fill","none"),m(s,"stroke","currentColor"),m(s,"stroke-linecap","round"),m(s,"stroke-linejoin","round"),m(s,"stroke-width","1.5"),m(s,"d","M12 3v18m0 0l8.5-8.5M12 21l-8.5-8.5"),m(r,"style",l=`transform: rotate(${i[1]?"180":"0"}deg)`),m(r,"xmlns","http://www.w3.org/2000/svg"),m(r,"width","24"),m(r,"height","24"),m(r,"viewBox","0 0 24 24"),m(r,"class","svelte-jbs1sd"),m(n,"class","button is-link svelte-jbs1sd"),m(t,"class","ctrl-toggle svelte-jbs1sd")},m(d,p){f&&f.m(d,p),C(d,e,p),C(d,t,p),_(t,n),_(n,r),_(r,s),_(n,o),K(a,n,null),c=!0,u||(h=ie(n,"click",wt(i[3])),u=!0)},p(d,p){d[1]?f?(f.p(d,p),p&2&&O(f,1)):(f=hs(d),f.c(),O(f,1),f.m(e.parentNode,e)):f&&(pe(),L(f,1,1,()=>{f=null}),ge()),(!c||p&2&&l!==(l=`transform: rotate(${d[1]?"180":"0"}deg)`))&&m(r,"style",l);const g={};p&2&&(g.tooltipText=d[2][d[1]][N]),a.$set(g)},i(d){c||(O(f),O(a.$$.fragment,d),c=!0)},o(d){L(f),L(a.$$.fragment,d),c=!1},d(d){f&&f.d(d),d&&E(e),d&&E(t),W(a),u=!1,h()}}}function hs(i){let e,t,n;const r=i[5]["toolbar-hidden"],s=He(r,i,i[4],us);return{c(){e=b("div"),s&&s.c(),m(e,"class","ctrl-extra")},m(l,o){C(l,e,o),s&&s.m(e,null),n=!0},p(l,o){s&&s.p&&(!n||o&16)&&qe(s,r,l,l[4],n?Be(r,l[4],o,Td):ze(l[4]),us)},i(l){n||(O(s,l),rt(()=>{n&&(t||(t=vt(e,qn,{axis:"y"},!0)),t.run(1))}),n=!0)},o(l){L(s,l),t||(t=vt(e,qn,{axis:"y"},!1)),t.run(0),n=!1},d(l){l&&E(e),s&&s.d(l),l&&t&&t.end()}}}function Pd(i){let e,t,n,r,s,l,o,a;const c=i[5]["toolbar-visible"],u=He(c,i,i[4],fs);let h=i[0]&&ds(i);return{c(){e=b("div"),t=b("form"),n=b("div"),r=b("div"),s=b("div"),u&&u.c(),l=D(),h&&h.c(),m(s,"class","ctrl-block svelte-jbs1sd"),m(r,"class","ctrl-block-wrapper svelte-jbs1sd"),m(n,"class","ctrl-base"),m(t,"class","ctrl svelte-jbs1sd"),m(e,"id","toolbar"),m(e,"class",o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(i[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd")},m(f,d){C(f,e,d),_(e,t),_(t,n),_(n,r),_(r,s),u&&u.m(s,null),_(t,l),h&&h.m(t,null),a=!0},p(f,[d]){u&&u.p&&(!a||d&16)&&qe(u,c,f,f[4],a?Be(c,f[4],d,Md):ze(f[4]),fs),f[0]?h?(h.p(f,d),d&1&&O(h,1)):(h=ds(f),h.c(),O(h,1),h.m(t,null)):h&&(pe(),L(h,1,1,()=>{h=null}),ge()),(!a||d&2&&o!==(o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(f[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd"))&&m(e,"class",o)},i(f){a||(O(u,f),O(h),a=!0)},o(f){L(u,f),L(h),a=!1},d(f){f&&E(e),u&&u.d(f),h&&h.d()}}}function Ld(i,e,t){let n,{$$slots:r={},$$scope:s}=e,{expandable:l=!0}=e;const o={true:{en:"Collapse the toolbar",fr:"Refermer le menu"},false:{en:"Expand the toolbar",fr:"Ouvrir le menu"}},a=()=>t(1,n=!n);return i.$$set=c=>{"expandable"in c&&t(0,l=c.expandable),"$$scope"in c&&t(4,s=c.$$scope)},t(1,n=!1),[l,n,o,a,s,r]}class Rd extends ae{constructor(e){super(),oe(this,e,Ld,Pd,le,{expandable:0})}}function ms(i){let e,t;return e=new Tn({props:{choicesItems:i[4],multiple:!0,placeholder:"...",start:Object.keys(i[5][i[13]]||{}),lightDisplay:!0,title:N==="fr"?"Régions sélectionnées":"Selected regions",selectAll:!0}}),e.$on("updateValues",i[22]),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&16&&(s.choicesItems=n[4]),r&32&&(s.start=Object.keys(n[5][n[13]]||{})),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function $d(i){return{c:j,m:j,p:j,i:j,o:j,d:j}}function Dd(i){let e,t,n=i[28].length&&Nd(i);return{c(){n&&n.c(),e=_e()},m(r,s){n&&n.m(r,s),C(r,e,s),t=!0},p(r,s){r[28].length&&n.p(r,s)},i(r){t||(O(n),t=!0)},o(r){L(n),t=!1},d(r){n&&n.d(r),r&&E(e)}}}function Nd(i){let e,t;return e=new Et({props:{title:N==="fr"?"Score minimal":"Minimal score",minVal:i[28][0],maxVal:i[28][1],start:i[0]||i[28][0],roundTo:3}}),e.$on("updateSlider",i[18]),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&1&&(s.start=n[0]||n[28][0]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function jd(i){return{c:j,m:j,p:j,i:j,o:j,d:j}}function Vd(i){let e,t,n=Object.keys(i[4]).length,r,s,l,o=n&&ms(i),a={ctx:i,current:null,token:null,hasCatch:!1,pending:jd,then:Dd,catch:$d,value:28,blocks:[,,,]};return Ze(i[17],a),{c(){e=b("div"),t=b("div"),o&&o.c(),r=D(),s=b("div"),a.block.c(),m(t,"class","ctrl-input svelte-8yfni4"),m(s,"class","ctrl-input svelte-8yfni4"),m(e,"slot","toolbar-visible"),m(e,"class","ctrl-block-inputs svelte-8yfni4")},m(c,u){C(c,e,u),_(e,t),o&&o.m(t,null),_(e,r),_(e,s),a.block.m(s,a.anchor=null),a.mount=()=>s,a.anchor=null,l=!0},p(c,u){i=c,u&16&&(n=Object.keys(i[4]).length),n?o?(o.p(i,u),u&16&&O(o,1)):(o=ms(i),o.c(),O(o,1),o.m(t,null)):o&&(pe(),L(o,1,1,()=>{o=null}),ge()),At(a,i,u)},i(c){l||(O(o),O(a.block),l=!0)},o(c){L(o);for(let u=0;u<3;u+=1){const h=a.blocks[u];L(h)}l=!1},d(c){c&&E(e),o&&o.d(),a.block.d(),a.token=null,a=null}}}function Fd(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v,w,S,P,M,I,R,T;return a=new Tn({props:{choicesItems:i[15],multiple:!0,placeholder:"...",start:i[1],lightDisplay:!0,title:N==="fr"?"Catégories masquées":"Hidden categories",selectAll:!0}}),a.$on("updateValues",i[19]),g=new Ad({props:{iconifyIcon:"material-symbols:help-outline",altText:N==="en"?"Display help":"Afficher une explication",tooltipText:i[14]}}),P=new Et({props:{title:N==="fr"?"Profondeur de récursion":"Recursion depth",minVal:i[12][0],maxVal:i[12][1],start:i[2],step:1}}),P.$on("updateSlider",i[20]),R=new gl({props:{toggleLabel:N==="en"?"Filter by region":"Filtrer par région",start:i[3],buttonDisplay:!0}}),R.$on("updateChecked",i[21]),{c(){e=b("div"),t=b("div"),n=b("div"),r=b("span"),r.textContent=`${N==="en"?"Similarity":"Similarité"}`,s=D(),l=b("div"),o=b("div"),G(a.$$.fragment),c=D(),u=b("div"),h=b("div"),f=b("div"),d=b("span"),d.textContent="Propagation",p=D(),G(g.$$.fragment),v=D(),w=b("div"),S=b("div"),G(P.$$.fragment),M=D(),I=b("div"),G(R.$$.fragment),m(r,"class","tag is-medium is-link"),m(n,"class","ctrl-block-title svelte-8yfni4"),m(o,"class","ctrl-input svelte-8yfni4"),m(l,"class","ctrl-block-inputs svelte-8yfni4"),m(t,"class","ctrl-block svelte-8yfni4"),m(e,"class","ctrl-block-wrapper svelte-8yfni4"),m(d,"class","tag is-medium is-link mr-1"),m(f,"class","ctrl-block-title svelte-8yfni4"),m(S,"class","ctrl-input svelte-8yfni4"),m(I,"class","ctrl-input svelte-8yfni4"),m(w,"class","ctrl-block-inputs svelte-8yfni4"),m(h,"class","ctrl-block svelte-8yfni4"),m(u,"class","ctrl-block-wrapper svelte-8yfni4")},m(y,F){C(y,e,F),_(e,t),_(t,n),_(n,r),_(t,s),_(t,l),_(l,o),K(a,o,null),C(y,c,F),C(y,u,F),_(u,h),_(h,f),_(f,d),_(f,p),K(g,f,null),_(h,v),_(h,w),_(w,S),K(P,S,null),_(w,M),_(w,I),K(R,I,null),T=!0},p(y,F){const Y={};F&2&&(Y.start=y[1]),a.$set(Y);const se={};F&4&&(se.start=y[2]),P.$set(se);const U={};F&8&&(U.start=y[3]),R.$set(U)},i(y){T||(O(a.$$.fragment,y),O(g.$$.fragment,y),O(P.$$.fragment,y),O(R.$$.fragment,y),T=!0)},o(y){L(a.$$.fragment,y),L(g.$$.fragment,y),L(P.$$.fragment,y),L(R.$$.fragment,y),T=!1},d(y){y&&E(e),W(a),y&&E(c),y&&E(u),W(g),W(P),W(R)}}}function Ud(i){let e,t;return e=new Rd({props:{$$slots:{"toolbar-hidden":[Fd],"toolbar-visible":[Vd]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,[r]){const s={};r&536870975&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function ps(){const i=document.getElementById("nav-actions");i&&document.documentElement.style.setProperty("--top-offset",`${i.offsetHeight}px`)}function Hd(i,e,t){let n,r,s,l,o,a,c,u;const{selectedRegions:h,comparedRegions:f,excludedCategories:d,similarityScoreCutoff:p,propagateRecursionDepth:g,propagateFilterByRegions:v,allowedPropagateDepthRange:w}=xe;ue(i,h,V=>t(5,u=V)),ue(i,f,V=>t(25,r=V)),ue(i,d,V=>t(1,l=V)),ue(i,p,V=>t(23,s=V)),ue(i,g,V=>t(2,o=V)),ue(i,v,V=>t(3,a=V));let S;st(()=>{ps(),S=new ResizeObserver(()=>{ps()});const V=document.getElementById("nav-actions");return V&&S.observe(V),()=>{S&&V&&(S.unobserve(V),S.disconnect())}});const P=window.location.pathname.match(/\d+/g).join("-"),M=`${window.location.origin}${window.location.pathname}`,I=N==="en"?"Propagated matches are exact matches to images that have an exact match with the current image. There may be up to 6 exact matches connecting the current image and propagated images.":"Les correspondances propagées correspondent à des correspondances exactes à des images ayant une correspondance exacte avec l'image actuelle. Il peut y avoir jusqu'à 6 images reliant l'image actuelle à une correspondance propagée.",R=[{value:1,label:cl,prefix:rl,prefixType:"svg"},{value:2,label:ul,prefix:sl,prefixType:"svg"},{value:3,label:fl,prefix:ll,prefixType:"svg"},{value:4,label:dl,prefix:ol,prefixType:"svg"},{value:5,label:hl,prefix:al,prefixType:"svg"}],T=Ye(f,V=>Object.entries(V).map(([H,re])=>({prefix:`#${re.id}`,prefixType:"text",value:H,label:Js(re.title.replace(/^[^|]+/,""))})));ue(i,T,V=>t(4,c=V));const y=F();async function F(){let V=[];return await fetch(`${M}similarity-score-range`).then(H=>H.json()).then(H=>(V=[H.min,H.max],V.every(re=>typeof re=="number")?t(0,n=s&&V[0]<=s&&V[1]>=s?s:V[0]):(console.error(`fetchSimilarityScoreRange: expected '[number, number]', got '${V}'. Defaulting to '[]'`),V=[]),V)).catch(H=>(console.error("Error on fetchSimilarityScoreRange:",H),errorMsg.set(H.message),V))}const Y=V=>p.set(V.detail),se=V=>d.set(V.detail),U=V=>g.set(V.detail),x=V=>v.set(V.detail),Z=V=>{const H=V.detail,re={[P]:{}};Object.keys(r).forEach(z=>{H.includes(z)&&(re[P][z]=r[z])}),h.set(re)};return i.$$.update=()=>{i.$$.dirty&8388608&&t(0,n=s||void 0)},[n,l,o,a,c,u,h,f,d,p,g,v,w,P,I,R,T,y,Y,se,U,x,Z,s]}class Bd extends ae{constructor(e){super(),oe(this,e,Hd,Ud,le,{})}}function qd(i){let e=Object.keys(i[0]).length,t,n,r,s,l,o=e&&gs();const a=[Wd,Kd,zd],c=[];function u(h,f){return h[1]?0:h[2]?1:2}return n=u(i),r=c[n]=a[n](i),{c(){o&&o.c(),t=D(),r.c(),s=_e()},m(h,f){o&&o.m(h,f),C(h,t,f),c[n].m(h,f),C(h,s,f),l=!0},p(h,f){f&1&&(e=Object.keys(h[0]).length),e?o?f&1&&O(o,1):(o=gs(),o.c(),O(o,1),o.m(t.parentNode,t)):o&&(pe(),L(o,1,1,()=>{o=null}),ge());let d=n;n=u(h),n===d?c[n].p(h,f):(pe(),L(c[d],1,1,()=>{c[d]=null}),ge(),r=c[n],r?r.p(h,f):(r=c[n]=a[n](h),r.c()),O(r,1),r.m(s.parentNode,s))},i(h){l||(O(o),O(r),l=!0)},o(h){L(o),L(r),l=!1},d(h){o&&o.d(h),h&&E(t),c[n].d(h),h&&E(s)}}}function gs(i){let e,t;return e=new Bd({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function zd(i){let e,t;return e=new Cd({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Kd(i){let e,t;return e=new Ui({props:{$$slots:{default:[xd]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&36&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Wd(i){let e,t;return e=new Ui({props:{$$slots:{default:[Jd]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&32&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Gd(i){let e,t;return{c(){e=J("Erreur lors de la récupération des similarités : "),t=J(i[2])},m(n,r){C(n,e,r),C(n,t,r)},p(n,r){r&4&&fe(t,n[2])},d(n){n&&E(e),n&&E(t)}}}function Yd(i){let e,t;return{c(){e=J("Error when retrieving similarities: "),t=J(i[2])},m(n,r){C(n,e,r),C(n,t,r)},p(n,r){r&4&&fe(t,n[2])},d(n){n&&E(e),n&&E(t)}}}function xd(i){let e;function t(s,l){return N==="en"?Yd:Gd}let r=t()(i);return{c(){e=b("tr"),r.c(),m(e,"class","faded is-center")},m(s,l){C(s,e,l),r.m(e,null)},p(s,l){r.p(s,l)},d(s){s&&E(e),r.d()}}}function Jd(i){let e;return{c(){e=b("tr"),e.textContent=`${N==="en"?"Retrieving similarities...":"Récupération des similarités..."}`,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,d(t){t&&E(e)}}}function Xd(i){let e=Ft.includes("similarity"),t,n,r=e&&qd(i);return{c(){r&&r.c(),t=_e()},m(s,l){r&&r.m(s,l),C(s,t,l),n=!0},p(s,[l]){e&&r.p(s,l)},i(s){n||(O(r),n=!0)},o(s){L(r),n=!1},d(s){r&&r.d(s),s&&E(t)}}}function Qd(i,e,t){let n,r,s;ue(i,Ot,a=>t(1,r=a)),ue(i,Ys,a=>t(2,s=a));const{fetchSimilarity:l,comparedRegions:o}=xe;return ue(i,o,a=>t(0,n=a)),st(()=>{Ft.includes("similarity")&&l()}),[n,r,s,o]}class Zd extends ae{constructor(e){super(),oe(this,e,Qd,Xd,le,{})}}function _s(i,e,t){const n=i.slice();return n[15]=e[t],n[17]=t,n}function vs(i,e){let t,n,r;return n=new qt({props:{item:new $i(e[15]),index:e[17],height:e[2],copyable:e[4],selectable:e[3],selectionStore:e[0]}}),n.$on("openModal",e[8]),{key:i,first:null,c(){t=_e(),G(n.$$.fragment),this.first=t},m(s,l){C(s,t,l),K(n,s,l),r=!0},p(s,l){e=s;const o={};l&2&&(o.item=new $i(e[15])),l&2&&(o.index=e[17]),l&4&&(o.height=e[2]),l&16&&(o.copyable=e[4]),l&8&&(o.selectable=e[3]),l&1&&(o.selectionStore=e[0]),n.$set(o)},i(s){r||(O(n.$$.fragment,s),r=!0)},o(s){L(n.$$.fragment,s),r=!1},d(s){s&&E(t),W(n,s)}}}function eh(i){let e,t;return e=new pl({props:{item:i[13]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&8192&&(s.item=n[13]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function th(i){let e,t,n;return t=new qt({props:{item:i[13],height:"full",isInModal:!0,selectable:!1}}),{c(){e=b("div"),G(t.$$.fragment),m(e,"class","modal-region svelte-jba7xn")},m(r,s){C(r,e,s),K(t,e,null),n=!0},p(r,s){const l={};s&8192&&(l.item=r[13]),t.$set(l)},i(r){n||(O(t.$$.fragment,r),n=!0)},o(r){L(t.$$.fragment,r),n=!1},d(r){r&&E(e),W(t)}}}function ih(i){let e,t,n,r;const s=[th,eh],l=[];function o(a,c){return a[14]==="region"?0:a[14]==="page"?1:-1}return~(e=o(i))&&(t=l[e]=s[e](i)),{c(){t&&t.c(),n=_e()},m(a,c){~e&&l[e].m(a,c),C(a,n,c),r=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(t&&(pe(),L(l[u],1,1,()=>{l[u]=null}),ge()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=s[e](a),t.c()),O(t,1),t.m(n.parentNode,n)):t=null)},i(a){r||(O(t),r=!0)},o(a){L(t),r=!1},d(a){~e&&l[e].d(a),a&&E(n)}}}function nh(i){let e,t;return e=new jl({props:{tabs:i[7],$$slots:{default:[ih,({activeTab:n})=>({14:n}),({activeTab:n})=>n?16384:0]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&128&&(s.tabs=n[7]),r&286720&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function rh(i){let e=[],t=new Map,n,r,s,l,o,a=Object.values(i[1]);const c=d=>d[15].id;for(let d=0;d<a.length;d+=1){let p=_s(i,a,d),g=c(p);t.set(g,e[d]=vs(g,p))}function u(d){i[10](d)}function h(d){i[11](d)}let f={items:i[1],$$slots:{default:[nh,({item:d})=>({13:d}),({item:d})=>d?8192:0]},$$scope:{ctx:i}};return i[6]!==void 0&&(f.currentIndex=i[6]),i[5]!==void 0&&(f.open=i[5]),r=new Cn({props:f}),ft.push(()=>jt(r,"currentIndex",u)),ft.push(()=>jt(r,"open",h)),r.$on("navigate",i[9]),{c(){for(let d=0;d<e.length;d+=1)e[d].c();n=D(),G(r.$$.fragment)},m(d,p){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(d,p);C(d,n,p),K(r,d,p),o=!0},p(d,[p]){p&287&&(a=Object.values(d[1]),pe(),e=hi(e,p,c,1,d,a,t,n.parentNode,Fi,vs,n,_s),ge());const g={};p&2&&(g.items=d[1]),p&270464&&(g.$$scope={dirty:p,ctx:d}),!s&&p&64&&(s=!0,g.currentIndex=d[6],Nt(()=>s=!1)),!l&&p&32&&(l=!0,g.open=d[5],Nt(()=>l=!1)),r.$set(g)},i(d){if(!o){for(let p=0;p<a.length;p+=1)O(e[p]);O(r.$$.fragment,d),o=!0}},o(d){for(let p=0;p<e.length;p+=1)L(e[p]);L(r.$$.fragment,d),o=!1},d(d){for(let p=0;p<e.length;p+=1)e[p].d(d);d&&E(n),W(r,d)}}}function sh(i,e,t){let n,{selectionStore:r=gt}=e,{items:s=[]}=e,{height:l=96}=e,{selectable:o=!0}=e,{copyable:a=!0}=e,c=!1,u=0;const h=g=>{t(6,u=g.detail.index??0),t(5,c=!0)},f=g=>{t(6,u=g.detail.index)};function d(g){u=g,t(6,u)}function p(g){c=g,t(5,c)}return i.$$set=g=>{"selectionStore"in g&&t(0,r=g.selectionStore),"items"in g&&t(1,s=g.items),"height"in g&&t(2,l=g.height),"selectable"in g&&t(3,o=g.selectable),"copyable"in g&&t(4,a=g.copyable)},t(7,n=[{id:"region",label:N==="en"?"Main view":"Vue principale"},{id:"page",label:N==="en"?"Page View":"Vue de la page"}]),[r,s,l,o,a,c,u,n,h,f,d,p]}class Hl extends ae{constructor(e){super(),oe(this,e,sh,rh,le,{selectionStore:0,items:1,height:2,selectable:3,copyable:4})}}function bs(i,e,t){const n=i.slice();return n[10]=e[t][0],n[11]=e[t][1],n}function lh(i){let e,t=N==="en"?`Error when retrieving paginated regions: ${i[14]}`:`Erreur de récupération des pages : ${i[14]}`,n;return{c(){e=b("tr"),n=J(t),m(e,"class","faded is-center")},m(r,s){C(r,e,s),_(e,n)},p(r,s){s&1&&t!==(t=N==="en"?`Error when retrieving paginated regions: ${r[14]}`:`Erreur de récupération des pages : ${r[14]}`)&&fe(n,t)},i:j,o:j,d(r){r&&E(e)}}}function oh(i){let e,t,n,r,s;const l=[ch,ah],o=[];function a(c,u){return u&2&&(e=null),e==null&&(e=Object.values(c[1]).length>0),e?0:1}return t=a(i,-1),n=o[t]=l[t](i),{c(){n.c(),r=_e()},m(c,u){o[t].m(c,u),C(c,r,u),s=!0},p(c,u){let h=t;t=a(c,u),t===h?o[t].p(c,u):(pe(),L(o[h],1,1,()=>{o[h]=null}),ge(),n=o[t],n?n.p(c,u):(n=o[t]=l[t](c),n.c()),O(n,1),n.m(r.parentNode,r))},i(c){s||(O(n),s=!0)},o(c){L(n),s=!1},d(c){o[t].d(c),c&&E(r)}}}function ah(i){let e,t,n;return t=new nl({}),{c(){e=b("tr"),G(t.$$.fragment)},m(r,s){C(r,e,s),K(t,e,null),n=!0},p:j,i(r){n||(O(t.$$.fragment,r),n=!0)},o(r){L(t.$$.fragment,r),n=!1},d(r){r&&E(e),W(t)}}}function ch(i){let e,t,n=Object.entries(i[1]),r=[];for(let l=0;l<n.length;l+=1)r[l]=ws(bs(i,n,l));const s=l=>L(r[l],1,1,()=>{r[l]=null});return{c(){for(let l=0;l<r.length;l+=1)r[l].c();e=_e()},m(l,o){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,o);C(l,e,o),t=!0},p(l,o){if(o&98){n=Object.entries(l[1]);let a;for(a=0;a<n.length;a+=1){const c=bs(l,n,a);r[a]?(r[a].p(c,o),O(r[a],1)):(r[a]=ws(c),r[a].c(),O(r[a],1),r[a].m(e.parentNode,e))}for(pe(),a=n.length;a<r.length;a+=1)s(a);ge()}},i(l){if(!t){for(let o=0;o<n.length;o+=1)O(r[o]);t=!0}},o(l){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)L(r[o]);t=!1},d(l){et(r,l),l&&E(e)}}}function uh(i){let e,t,n,r,s,l,o,a,c=i[10]+"",u,h,f;return{c(){e=b("img"),r=D(),s=b("div"),l=b("a"),o=b("i"),a=J(`
                                Page `),u=J(c),f=D(),$e(e.src,t=dt(i[5](i[10]),"full","250,"))||m(e,"src",t),m(e,"alt",n="Canvas "+i[10]),m(e,"class","mb-3 card"),m(o,"class","fa-solid fa-pen-to-square"),m(l,"class","tag px-2 py-1 is-rounded is-hoverable"),m(l,"href",h=Ht(i[6],i[10])),m(l,"target","_blank"),m(s,"class","is-center mb-1")},m(d,p){C(d,e,p),C(d,r,p),C(d,s,p),_(s,l),_(l,o),_(l,a),_(l,u),C(d,f,p)},p(d,p){p&2&&!$e(e.src,t=dt(d[5](d[10]),"full","250,"))&&m(e,"src",t),p&2&&n!==(n="Canvas "+d[10])&&m(e,"alt",n),p&2&&c!==(c=d[10]+"")&&fe(u,c),p&2&&h!==(h=Ht(d[6],d[10]))&&m(l,"href",h)},d(d){d&&E(e),d&&E(r),d&&E(s),d&&E(f)}}}function fh(i){let e,t,n;return e=new Hl({props:{items:Object.values(i[11])}}),{c(){G(e.$$.fragment),t=D()},m(r,s){K(e,r,s),C(r,t,s),n=!0},p(r,s){const l={};s&2&&(l.items=Object.values(r[11])),e.$set(l)},i(r){n||(O(e.$$.fragment,r),n=!0)},o(r){L(e.$$.fragment,r),n=!1},d(r){W(e,r),r&&E(t)}}}function ws(i){let e,t;return e=new Fl({props:{$$slots:{"row-body":[fh],"row-header":[uh]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&32770&&(s.$$scope={dirty:r,ctx:n}),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function dh(i){let e;return{c(){e=b("tr"),e.textContent=`${N==="en"?"Retrieving paginated regions...":"Récupération des pages..."}`,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,i:j,o:j,d(t){t&&E(e)}}}function hh(i){let e,t,n,r={ctx:i,current:null,token:null,hasCatch:!0,pending:dh,then:oh,catch:lh,value:9,error:14,blocks:[,,,]};return Ze(t=i[0],r),{c(){e=_e(),r.block.c()},m(s,l){C(s,e,l),r.block.m(s,r.anchor=l),r.mount=()=>e.parentNode,r.anchor=e,n=!0},p(s,l){i=s,r.ctx=i,l&1&&t!==(t=i[0])&&Ze(t,r)||At(r,i,l)},i(s){n||(O(r.block),n=!0)},o(s){for(let l=0;l<3;l+=1){const o=r.blocks[l];L(o)}n=!1},d(s){s&&E(e),r.block.d(s),r.token=null,r=null}}}function mh(i){let e,t,n,r,s,l;return e=new Bt({props:{store:bt,nbOfItems:i[4]}}),n=new Ui({props:{$$slots:{default:[hh]},$$scope:{ctx:i}}}),s=new Bt({props:{store:bt,nbOfItems:i[4]}}),{c(){G(e.$$.fragment),t=D(),G(n.$$.fragment),r=D(),G(s.$$.fragment)},m(o,a){K(e,o,a),C(o,t,a),K(n,o,a),C(o,r,a),K(s,o,a),l=!0},p(o,[a]){const c={};a&32771&&(c.$$scope={dirty:a,ctx:o}),n.$set(c)},i(o){l||(O(e.$$.fragment,o),O(n.$$.fragment,o),O(s.$$.fragment,o),l=!0)},o(o){L(e.$$.fragment,o),L(n.$$.fragment,o),L(s.$$.fragment,o),l=!1},d(o){W(e,o),o&&E(t),W(n,o),o&&E(r),W(s,o)}}}function ph(i,e,t){let n,r;const{pageRegions:s,fetchPages:l}=bt;ue(i,s,f=>t(1,r=f)),ue(i,l,f=>t(0,n=f));const o=Je("nbOfPages"),a=Je("trailingZeros"),c=(f,d)=>f.toString().padStart(d,"0");function u(f){return`${imgPrefix}_${c(f,a)}`}const h=Je("manifest");return[n,r,s,l,o,u,h]}class gh extends ae{constructor(e){super(),oe(this,e,ph,mh,le,{})}}function _h(i){let e,t,n,r,s=N==="en"?"Save selection":"Sauvegarder la sélection",l,o,a;return{c(){e=b("button"),t=b("span"),n=b("i"),r=D(),l=J(s),m(n,"class","fa-solid fa-floppy-disk"),m(e,"class","button is-link")},m(c,u){C(c,e,u),_(e,t),_(t,n),_(t,r),_(t,l),o||(a=ie(e,"click",i[7]),o=!0)},p:j,d(c){c&&E(e),o=!1,a()}}}function vh(i){let e,t,n,r,s=N==="en"?"Go to treatment":"Accéder au traitement",l,o;return{c(){var a;e=b("a"),t=b("span"),n=b("i"),r=D(),l=J(s),m(n,"class","fa-solid fa-gear"),m(e,"class","button is-link"),m(e,"href",o="/"+Ve+"/treatment/add/?document_set="+((a=i[3])==null?void 0:a.id))},m(a,c){C(a,e,c),_(e,t),_(t,n),_(t,r),_(t,l)},p(a,c){var u;c&8&&o!==(o="/"+Ve+"/treatment/add/?document_set="+((u=a[3])==null?void 0:u.id))&&m(e,"href",o)},d(a){a&&E(e)}}}function ys(i){let e,t,n,r,s,l,o;return{c(){var a,c;e=b("a"),t=b("span"),t.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',r=D(),s=b("a"),l=b("span"),l.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',m(e,"class","button is-link is-dark"),m(e,"href",n="/"+Ve+"/document-set/"+((a=i[3])==null?void 0:a.id)+"/json"),m(e,"target","_blank"),m(s,"class","button is-link is-dark"),m(s,"href",o="/"+Ve+"/document-set/"+((c=i[3])==null?void 0:c.id)+"/zip"),m(s,"target","_blank")},m(a,c){C(a,e,c),_(e,t),C(a,r,c),C(a,s,c),_(s,l)},p(a,c){var u,h;c&8&&n!==(n="/"+Ve+"/document-set/"+((u=a[3])==null?void 0:u.id)+"/json")&&m(e,"href",n),c&8&&o!==(o="/"+Ve+"/document-set/"+((h=a[3])==null?void 0:h.id)+"/zip")&&m(s,"href",o)},d(a){a&&E(e),a&&E(r),a&&E(s)}}}function bh(i){let e,t,n,r,s,l,o;function a(f,d){return f[2]&&!f[1]?vh:_h}let c=a(i),u=c(i),h=!i[1]&&ys(i);return{c(){e=b("footer"),t=b("div"),n=b("button"),n.textContent=`${N==="en"?"Clear selection":"Vider la sélection"}`,r=D(),u.c(),s=D(),h&&h.c(),m(n,"class","button button-close is-link is-light"),m(t,"class","buttons"),m(e,"class","modal-card-foot is-center")},m(f,d){C(f,e,d),_(e,t),_(t,n),_(t,r),u.m(t,null),_(t,s),h&&h.m(t,null),l||(o=ie(n,"click",i[6]),l=!0)},p(f,[d]){c===(c=a(f))&&u?u.p(f,d):(u.d(1),u=c(f),u&&(u.c(),u.m(t,s))),f[1]?h&&(h.d(1),h=null):h?h.p(f,d):(h=ys(f),h.c(),h.m(t,null))},i:j,o:j,d(f){f&&E(e),u.d(),h&&h.d(),l=!1,o()}}}function wh(i,e,t){let n,r,{selectionStore:s}=e;const{isSaved:l,selection:o}=s;ue(i,l,h=>t(2,n=h)),ue(i,o,h=>t(3,r=h));let{isRegion:a=s.type!=="documentSet"}=e;const c=()=>s.empty(),u=()=>s.save();return i.$$set=h=>{"selectionStore"in h&&t(0,s=h.selectionStore),"isRegion"in h&&t(1,a=h.isRegion)},[s,a,n,r,l,o,c,u]}class yh extends ae{constructor(e){super(),oe(this,e,wh,bh,le,{selectionStore:0,isRegion:1})}}function ks(i,e,t){const n=i.slice();return n[31]=e[t],n}function Ss(i,e,t){const n=i.slice();return n[31]=e[t],n}function kh(i){let e,t,n,r,s,l;return{c(){e=b("span"),t=J(i[10]),n=D(),r=b("span"),r.innerHTML='<i class="fas fa-edit"></i>',m(r,"class","pl-3 smaller has-text-link")},m(o,a){C(o,e,a),_(e,t),_(e,n),_(e,r),s||(l=[ie(e,"click",i[14]),ie(e,"keyup",null)],s=!0)},p(o,a){a[0]&1024&&fe(t,o[10])},d(o){o&&E(e),s=!1,Ie(l)}}}function Sh(i){let e,t,n;return{c(){e=b("input"),m(e,"class","input selection-title svelte-fumu7c")},m(r,s){C(r,e,s),i[23](e),Dt(e,i[5]),t||(n=[ie(e,"input",i[24]),ie(e,"keydown",i[15]),ie(e,"blur",i[16])],t=!0)},p(r,s){s[0]&32&&e.value!==r[5]&&Dt(e,r[5])},d(r){r&&E(e),i[23](null),t=!1,Ie(n)}}}function Es(i){let e,t,n;function r(){return i[25](i[31])}return{c(){e=b("button"),m(e,"class","tag is-delete is-link ml-0")},m(s,l){C(s,e,l),t||(n=ie(e,"click",r),t=!0)},p(s,l){i=s},d(s){s&&E(e),t=!1,n()}}}function Cs(i,e){let t,n,r=e[31].username+"",s,l,o,a=e[9]&&Es(e);return{key:i,first:null,c(){t=b("div"),n=b("span"),s=J(r),l=D(),a&&a.c(),o=D(),m(n,"class","tag"),m(t,"class","tags has-addons svelte-fumu7c"),this.first=t},m(c,u){C(c,t,u),_(t,n),_(n,s),_(t,l),a&&a.m(t,null),_(t,o)},p(c,u){e=c,u[0]&256&&r!==(r=e[31].username+"")&&fe(s,r),e[9]?a?a.p(e,u):(a=Es(e),a.c(),a.m(t,o)):a&&(a.d(1),a=null)},d(c){c&&E(t),a&&a.d()}}}function Is(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g=N==="en"?"Make public":"Rendre public",v,w,S,P=i[7].length>0&&Os(i);return{c(){var M;e=b("div"),t=b("div"),n=b("div"),r=b("p"),s=b("input"),l=D(),o=b("span"),o.innerHTML='<i class="fas fa-search"></i>',a=D(),P&&P.c(),c=D(),u=b("div"),h=b("label"),f=b("input"),p=D(),v=J(g),m(s,"class","input svelte-fumu7c"),m(s,"placeholder","Search users…"),m(o,"class","icon is-small is-right"),m(r,"class","control is-expanded has-icons-right"),m(n,"class","field"),m(t,"class","dropdown-trigger"),m(e,"class","dropdown is-active"),m(f,"type","checkbox"),f.checked=d=(M=i[2])==null?void 0:M.is_public,m(h,"class","checkbox"),m(u,"class","field mt-3 is-right")},m(M,I){C(M,e,I),_(e,t),_(t,n),_(n,r),_(r,s),Dt(s,i[6]),_(r,l),_(r,o),_(e,a),P&&P.m(e,null),C(M,c,I),C(M,u,I),_(u,h),_(h,f),_(h,p),_(h,v),w||(S=[ie(s,"input",i[26]),ie(s,"input",i[17]),ie(f,"change",i[28])],w=!0)},p(M,I){var R;I[0]&64&&s.value!==M[6]&&Dt(s,M[6]),M[7].length>0?P?P.p(M,I):(P=Os(M),P.c(),P.m(e,null)):P&&(P.d(1),P=null),I[0]&4&&d!==(d=(R=M[2])==null?void 0:R.is_public)&&(f.checked=d)},d(M){M&&E(e),P&&P.d(),M&&E(c),M&&E(u),w=!1,Ie(S)}}}function Os(i){let e,t,n=i[7],r=[];for(let s=0;s<n.length;s+=1)r[s]=As(ks(i,n,s));return{c(){e=b("div"),t=b("div");for(let s=0;s<r.length;s+=1)r[s].c();m(t,"class","dropdown-content"),m(e,"class","dropdown-menu"),m(e,"id","dropdown-menu"),m(e,"role","menu")},m(s,l){C(s,e,l),_(e,t);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null)},p(s,l){if(l[0]&262272){n=s[7];let o;for(o=0;o<n.length;o+=1){const a=ks(s,n,o);r[o]?r[o].p(a,l):(r[o]=As(a),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(s){s&&E(e),et(r,s)}}}function As(i){let e,t=i[31].username+"",n,r,s,l;function o(){return i[27](i[31])}return{c(){e=b("div"),n=J(t),r=D(),m(e,"class","dropdown-item")},m(a,c){C(a,e,c),_(e,n),_(e,r),s||(l=[ie(e,"click",o),ie(e,"keydown",null)],s=!0)},p(a,c){i=a,c[0]&128&&t!==(t=i[31].username+"")&&fe(n,t)},d(a){a&&E(e),s=!1,Ie(l)}}}function Eh(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v,w,S,P,M=[],I=new Map,R,T,y,F,Y,se;function U(te,he){return te[3]?Sh:kh}let x=U(i),Z=x(i);const V=i[22].default,H=He(V,i,i[21],null);let re=i[8];const z=te=>te[31].id;for(let te=0;te<re.length;te+=1){let he=Ss(i,re,te),be=z(he);I.set(be,M[te]=Cs(be,he))}let B=i[9]&&Is(i);return y=new yh({props:{selectionStore:i[0]}}),{c(){e=b("div"),t=b("div"),n=D(),r=b("div"),s=b("div"),l=b("div"),o=b("i"),a=D(),Z.c(),c=J(`

                (`),u=J(i[1]),h=J(")"),f=D(),d=b("button"),p=D(),g=b("section"),H&&H.c(),v=D(),w=b("h4"),w.textContent=`${N==="en"?"Shared with":"Partagé avec"}`,S=D(),P=b("div");for(let te=0;te<M.length;te+=1)M[te].c();R=D(),B&&B.c(),T=D(),G(y.$$.fragment),m(t,"class","modal-background"),m(o,"class","fa-solid fa-book-bookmark"),m(l,"class","title is-4 mb-0 media-content"),m(d,"class","delete media-left"),m(d,"aria-label","close"),m(s,"class","modal-card-head media mb-0 is-middle"),m(P,"class","field is-grouped is-grouped-multiline"),m(g,"class","modal-card-body"),m(r,"class","modal-content"),m(e,"id","selection-modal"),m(e,"class","modal fade"),m(e,"tabindex","-1"),m(e,"aria-labelledby","selection-modal-label"),m(e,"aria-hidden","true")},m(te,he){C(te,e,he),_(e,t),_(e,n),_(e,r),_(r,s),_(s,l),_(l,o),_(l,a),Z.m(l,null),_(l,c),_(l,u),_(l,h),_(s,f),_(s,d),_(r,p),_(r,g),H&&H.m(g,null),_(g,v),_(g,w),_(g,S),_(g,P);for(let be=0;be<M.length;be+=1)M[be]&&M[be].m(P,null);_(g,R),B&&B.m(g,null),_(r,T),K(y,r,null),F=!0,Y||(se=Ti(el.call(null,e)),Y=!0)},p(te,he){x===(x=U(te))&&Z?Z.p(te,he):(Z.d(1),Z=x(te),Z&&(Z.c(),Z.m(l,c))),(!F||he[0]&2)&&fe(u,te[1]),H&&H.p&&(!F||he[0]&2097152)&&qe(H,V,te,te[21],F?Be(V,te[21],he,null):ze(te[21]),null),he[0]&525056&&(re=te[8],M=hi(M,he,z,1,te,re,I,P,Eo,Cs,null,Ss)),te[9]?B?B.p(te,he):(B=Is(te),B.c(),B.m(g,null)):B&&(B.d(1),B=null);const be={};he[0]&1&&(be.selectionStore=te[0]),y.$set(be)},i(te){F||(O(H,te),O(y.$$.fragment,te),F=!0)},o(te){L(H,te),L(y.$$.fragment,te),F=!1},d(te){te&&E(e),Z.d(),H&&H.d(te);for(let he=0;he<M.length;he+=1)M[he].d();B&&B.d(),W(y),Y=!1,se()}}}function Ch(i,e,t){let n,r,s,l,o,{$$slots:a={},$$scope:c}=e;const{selected:u}=jo;ue(i,u,z=>t(2,l=z));let{selectionStore:h}=e,{selectionLength:f=!1}=e;const{selectionTitle:d,updateTitle:p,updatePublic:g,save:v}=h;ue(i,d,z=>t(10,o=z));let w=!1,S,P;function M(){t(3,w=!0),t(5,P=o),setTimeout(()=>S==null?void 0:S.focus(),0)}function I(z){z.key==="Enter"&&R()}function R(){t(3,w=!1),p(P),v()}let T="",y=[];async function F(){if(T.trim().length<1){t(7,y=[]);return}const B=await(await fetch(`${window.location.origin}/search/user?q=${encodeURIComponent(T)}`)).json();t(7,y=B.users||[])}function Y(z){h.add({id:z.id,class:"User",title:z.username}),t(6,T=""),t(7,y=[])}function se(z){h.remove(z,"User")}function U(z){ft[z?"unshift":"push"](()=>{S=z,t(4,S)})}function x(){P=this.value,t(5,P)}const Z=z=>se(z.id);function V(){T=this.value,t(6,T)}const H=z=>Y(z),re=z=>g(z.target.checked);return i.$$set=z=>{"selectionStore"in z&&t(0,h=z.selectionStore),"selectionLength"in z&&t(1,f=z.selectionLength),"$$scope"in z&&t(21,c=z.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&4&&t(20,n=l==null?void 0:l.owner_id),i.$$.dirty[0]&1048576&&t(9,r=Ao||n===Oi),i.$$.dirty[0]&4&&t(8,s=Object.entries((l==null?void 0:l.User)||{}).map(([z,B])=>({id:Number(z),username:B.title})))},[h,f,l,w,S,P,T,y,s,r,o,u,d,g,M,I,R,F,Y,se,n,c,a,U,x,Z,V,H,re]}class Ih extends ae{constructor(e){super(),oe(this,e,Ch,Eh,le,{selectionStore:0,selectionLength:1},null,[-1,-1])}}function Oh(){const i=`${window.location.origin}${window.location.pathname}`,e=49,t=Ee(1),n=Ee([]),r=Ee([]),s=(async()=>{const u=await fetch(`${i}vectorized-images`).then(h=>h.json()).then(h=>(n.set(h),h)).catch(h=>console.error("Error:",h));return c(l()),u})(),l=()=>wn(t,"vp"),o=Ye(t,u=>(async()=>a(u))());function a(u){const h=(u-1)*e,f=h+e,d=_n(n).slice(h,f);return r.set(d),d}function c(u){yn(u,t,"vp")}return{currentPage:t,pageLength:e,vectImgs:n,fetchVectorization:s,setPageVectImgs:o,pageVectImgs:r,handlePageUpdate:c}}const Vi=Oh();const Ah=i=>({}),Ts=i=>({});function Ms(i){let e,t;return{c(){e=new ho(!1),t=_e(),e.a=t},m(n,r){e.m(i[4],n,r),C(n,t,r)},p(n,r){r&16&&e.p(n[4])},d(n){n&&E(t),n&&e.d()}}}function Th(i){let e,t,n,r,s,l,o,a,c,u,h,f,d,p,g,v,w,S=!i[5]&&i[4]&&Ms(i);const P=i[10].actions,M=He(P,i,i[9],Ts);return{c(){e=b("div"),t=b("figure"),n=b("div"),S&&S.c(),r=D(),s=b("img"),o=D(),a=b("div"),c=b("a"),u=b("i"),h=D(),f=b("span"),f.textContent=`${N==="en"?"Download SVG":"Télécharger le SVG"}`,d=D(),M&&M.c(),m(n,"class","svg-container svelte-c6s83q"),m(s,"class","region-img svelte-c6s83q"),$e(s.src,l=i[8])||m(s,"src",l),m(s,"alt","Extracted region"),m(t,"class","image card region-image svelte-c6s83q"),ve(t,"width",i[2]?"50%":`${i[1]}px`),ve(t,"aspect-ratio",i[6]?i[6].split(" ")[2]/i[6].split(" ")[3]:1),m(u,"class","fa-solid fa-download"),m(f,"class","tooltip"),m(c,"class","button tag svelte-c6s83q"),m(c,"href",i[7]),m(c,"download",i[0]),m(a,"class","region-btn ml-1"),m(e,"class","region is-center"),Ce(e,"checked",i[3])},m(I,R){C(I,e,R),_(e,t),_(t,n),S&&S.m(n,null),_(t,r),_(t,s),_(e,o),_(e,a),_(a,c),_(c,u),_(c,h),_(c,f),_(a,d),M&&M.m(a,null),g=!0,v||(w=[ie(t,"click",i[11]),ie(t,"keyup",i[12]),ie(t,"mouseenter",i[13]),ie(t,"mouseleave",i[14])],v=!0)},p(I,[R]){!I[5]&&I[4]?S?S.p(I,R):(S=Ms(I),S.c(),S.m(n,null)):S&&(S.d(1),S=null),(!g||R&6)&&ve(t,"width",I[2]?"50%":`${I[1]}px`),(!g||R&64)&&ve(t,"aspect-ratio",I[6]?I[6].split(" ")[2]/I[6].split(" ")[3]:1),(!g||R&128)&&m(c,"href",I[7]),(!g||R&1)&&m(c,"download",I[0]),M&&M.p&&(!g||R&512)&&qe(M,P,I,I[9],g?Be(P,I[9],R,Ah):ze(I[9]),Ts),(!g||R&8)&&Ce(e,"checked",I[3])},i(I){g||(O(M,I),rt(()=>{g&&(p||(p=vt(e,Vt,{duration:300},!0)),p.run(1))}),g=!0)},o(I){L(M,I),p||(p=vt(e,Vt,{duration:300},!1)),p.run(0),g=!1},d(I){I&&E(e),S&&S.d(),M&&M.d(I),I&&p&&p.end(),v=!1,Ie(w)}}}function Mh(i,e,t){let{$$slots:n={},$$scope:r}=e,{svgPath:s}=e,{width:l=200}=e,{fullWidth:o=!1}=e,{selected:a=!1}=e;const[c,u,h,f]=s.replace(".svg","").split("_"),d=dt(`${c}_${u}_${h}`,f,`${l},`);let p=!1,g="",v="",w="";di(()=>{w&&URL.revokeObjectURL(w)}),st(async()=>{const T=await(await fetch(`${Po}svg/${s}`)).text(),F=new DOMParser().parseFromString(T,"image/svg+xml"),Y=F.querySelector("svg");t(6,v=Y.getAttribute("viewBox")||`0 0 ${Y.getAttribute("width")} ${Y.getAttribute("height")}`),F.querySelectorAll("image").forEach(se=>se.remove()),Y.setAttribute("viewBox",v),Y.removeAttribute("width"),Y.removeAttribute("height"),t(4,g=new XMLSerializer().serializeToString(F.documentElement))});function S(R){Li.call(this,i,R)}function P(R){Li.call(this,i,R)}const M=()=>t(5,p=!0),I=()=>t(5,p=!1);return i.$$set=R=>{"svgPath"in R&&t(0,s=R.svgPath),"width"in R&&t(1,l=R.width),"fullWidth"in R&&t(2,o=R.fullWidth),"selected"in R&&t(3,a=R.selected),"$$scope"in R&&t(9,r=R.$$scope)},i.$$.update=()=>{if(i.$$.dirty&16&&g){const R=new Blob([g],{type:"image/svg+xml"});t(7,w=URL.createObjectURL(R))}},[s,l,o,a,g,p,v,w,d,r,n,S,P,M,I]}class Bl extends ae{constructor(e){super(),oe(this,e,Mh,Th,le,{svgPath:0,width:1,fullWidth:2,selected:3})}}function Ps(i,e,t){const n=i.slice();return n[15]=e[t],n[17]=t,n}function Ph(i){let e;function t(s,l){return N==="en"?Rh:Lh}let r=t()(i);return{c(){e=b("div"),r.c(),m(e,"class","faded is-center")},m(s,l){C(s,e,l),r.m(e,null)},p(s,l){r.p(s,l)},i:j,o:j,d(s){s&&E(e),r.d()}}}function Lh(i){let e,t=i[18]+"",n;return{c(){e=J("Erreur lors de la récupération des régions vectorisées : "),n=J(t)},m(r,s){C(r,e,s),C(r,n,s)},p(r,s){s&8&&t!==(t=r[18]+"")&&fe(n,t)},d(r){r&&E(e),r&&E(n)}}}function Rh(i){let e,t=i[18]+"",n;return{c(){e=J("Error when retrieving vectorized regions: "),n=J(t)},m(r,s){C(r,e,s),C(r,n,s)},p(r,s){s&8&&t!==(t=r[18]+"")&&fe(n,t)},d(r){r&&E(e),r&&E(n)}}}function $h(i){let e=[],t=new Map,n,r,s,l,o,a=i[4];const c=p=>p[15].id;for(let p=0;p<a.length;p+=1){let g=Ps(i,a,p),v=c(g);t.set(v,e[p]=Rs(v,g))}let u=null;a.length||(u=Ls());function h(p){i[11](p)}function f(p){i[12](p)}let d={items:i[4],$$slots:{default:[Nh,({item:p})=>({14:p}),({item:p})=>p?16384:0]},$$scope:{ctx:i}};return i[1]!==void 0&&(d.currentIndex=i[1]),i[0]!==void 0&&(d.open=i[0]),r=new Cn({props:d}),ft.push(()=>jt(r,"currentIndex",h)),ft.push(()=>jt(r,"open",f)),{c(){for(let p=0;p<e.length;p+=1)e[p].c();u&&u.c(),n=D(),G(r.$$.fragment)},m(p,g){for(let v=0;v<e.length;v+=1)e[v]&&e[v].m(p,g);u&&u.m(p,g),C(p,n,g),K(r,p,g),o=!0},p(p,g){g&528&&(a=p[4],pe(),e=hi(e,g,c,1,p,a,t,n.parentNode,Fi,Rs,n,Ps),ge(),!a.length&&u?u.p(p,g):a.length?u&&(u.d(1),u=null):(u=Ls(),u.c(),u.m(n.parentNode,n)));const v={};g&16&&(v.items=p[4]),g&540672&&(v.$$scope={dirty:g,ctx:p}),!s&&g&2&&(s=!0,v.currentIndex=p[1],Nt(()=>s=!1)),!l&&g&1&&(l=!0,v.open=p[0],Nt(()=>l=!1)),r.$set(v)},i(p){if(!o){for(let g=0;g<a.length;g+=1)O(e[g]);O(r.$$.fragment,p),o=!0}},o(p){for(let g=0;g<e.length;g+=1)L(e[g]);L(r.$$.fragment,p),o=!1},d(p){for(let g=0;g<e.length;g+=1)e[g].d(p);u&&u.d(p),p&&E(n),W(r,p)}}}function Ls(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No vectorization":"Pas de vectorisation"}`,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,d(t){t&&E(e)}}}function Dh(i){let e,t;function n(){return i[10](i[17])}return e=new ml({}),e.$on("open",n),{c(){G(e.$$.fragment)},m(r,s){K(e,r,s),t=!0},p(r,s){i=r},i(r){t||(O(e.$$.fragment,r),t=!0)},o(r){L(e.$$.fragment,r),t=!1},d(r){W(e,r)}}}function Rs(i,e){let t,n,r;return n=new Bl({props:{svgPath:e[15],$$slots:{default:[Dh]},$$scope:{ctx:e}}}),{key:i,first:null,c(){t=_e(),G(n.$$.fragment),this.first=t},m(s,l){C(s,t,l),K(n,s,l),r=!0},p(s,l){e=s;const o={};l&16&&(o.svgPath=e[15]),l&524304&&(o.$$scope={dirty:l,ctx:e}),n.$set(o)},i(s){r||(O(n.$$.fragment,s),r=!0)},o(s){L(n.$$.fragment,s),r=!1},d(s){s&&E(t),W(n,s)}}}function Nh(i){let e,t;return e=new Bl({props:{svgPath:i[14],fullWidth:!0}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r&16384&&(s.svgPath=n[14]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function jh(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"Retrieving vectorization page...":"Récupération la page de vectorisation..."}`,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,i:j,o:j,d(t){t&&E(e)}}}function Vh(i){let e,t,n,r,s,l,o;e=new Bt({props:{store:Vi,nbOfItems:i[2].length,pageLength:i[8]}});let a={ctx:i,current:null,token:null,hasCatch:!0,pending:jh,then:$h,catch:Ph,value:13,error:18,blocks:[,,,]};return Ze(r=i[3],a),l=new Bt({props:{store:Vi,nbOfItems:i[2].length,pageLength:i[8]}}),{c(){G(e.$$.fragment),t=D(),n=b("div"),a.block.c(),s=D(),G(l.$$.fragment),m(n,"class","grid is-gap-2 mx-5 svelte-1mje9rl")},m(c,u){K(e,c,u),C(c,t,u),C(c,n,u),a.block.m(n,a.anchor=null),a.mount=()=>n,a.anchor=null,C(c,s,u),K(l,c,u),o=!0},p(c,[u]){i=c;const h={};u&4&&(h.nbOfItems=i[2].length),e.$set(h),a.ctx=i,u&8&&r!==(r=i[3])&&Ze(r,a)||At(a,i,u);const f={};u&4&&(f.nbOfItems=i[2].length),l.$set(f)},i(c){o||(O(e.$$.fragment,c),O(a.block),O(l.$$.fragment,c),o=!0)},o(c){L(e.$$.fragment,c);for(let u=0;u<3;u+=1){const h=a.blocks[u];L(h)}L(l.$$.fragment,c),o=!1},d(c){W(e,c),c&&E(t),c&&E(n),a.block.d(),a.token=null,a=null,c&&E(s),W(l,c)}}}function Fh(i,e,t){let n,r,s;const{vectImgs:l,pageVectImgs:o,setPageVectImgs:a,pageLength:c}=Vi;ue(i,l,v=>t(2,n=v)),ue(i,o,v=>t(4,s=v)),ue(i,a,v=>t(3,r=v));let u=!1,h=0;const f=v=>{t(1,h=v),t(0,u=!0)},d=v=>f(v);function p(v){h=v,t(1,h)}function g(v){u=v,t(0,u)}return[u,h,n,r,s,l,o,a,c,f,d,p,g]}class Uh extends ae{constructor(e){super(),oe(this,e,Fh,Vh,le,{})}}function Hh(i){let e,t,n={ctx:i,current:null,token:null,hasCatch:!0,pending:Wh,then:Kh,catch:Bh,value:1,error:2,blocks:[,,,]};return Ze(i[0],n),{c(){e=_e(),n.block.c()},m(r,s){C(r,e,s),n.block.m(r,n.anchor=s),n.mount=()=>e.parentNode,n.anchor=e,t=!0},p(r,s){i=r,At(n,i,s)},i(r){t||(O(n.block),t=!0)},o(r){for(let s=0;s<3;s+=1){const l=n.blocks[s];L(l)}t=!1},d(r){r&&E(e),n.block.d(r),n.token=null,n=null}}}function Bh(i){let e;function t(s,l){return N==="en"?zh:qh}let r=t()(i);return{c(){e=b("div"),r.c(),m(e,"class","container faded is-center")},m(s,l){C(s,e,l),r.m(e,null)},p(s,l){r.p(s,l)},i:j,o:j,d(s){s&&E(e),r.d()}}}function qh(i){let e,t=i[2]+"",n;return{c(){e=J("Erreur lors de la récupération des régions vectorisées : "),n=J(t)},m(r,s){C(r,e,s),C(r,n,s)},p:j,d(r){r&&E(e),r&&E(n)}}}function zh(i){let e,t=i[2]+"",n;return{c(){e=J("Error when retrieving vectorized regions: "),n=J(t)},m(r,s){C(r,e,s),C(r,n,s)},p:j,d(r){r&&E(e),r&&E(n)}}}function Kh(i){let e,t;return e=new Uh({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function Wh(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"Retrieving vectorized regions...":"Récupération des régions vectorisées..."}`,m(e,"class","container faded is-center")},m(t,n){C(t,e,n)},p:j,i:j,o:j,d(t){t&&E(e)}}}function Gh(i){let e=Ft.includes("vectorization"),t,n,r=e&&Hh(i);return{c(){r&&r.c(),t=_e()},m(s,l){r&&r.m(s,l),C(s,t,l),n=!0},p(s,[l]){e&&r.p(s,l)},i(s){n||(O(r),n=!0)},o(s){L(r),n=!1},d(s){r&&r.d(s),s&&E(t)}}}function Yh(i){const{fetchVectorization:e}=Vi;return[e]}class xh extends ae{constructor(e){super(),oe(this,e,Yh,Gh,le,{})}}function Jh(i){let e,t;return{c(){e=b("iframe"),$e(e.src,t=i[0])||m(e,"src",t),ve(e,"width","100%"),ve(e,"height","75vh"),ve(e,"border","none"),m(e,"title","Mirador viewer"),e.allowFullscreen=!0},m(n,r){C(n,e,r)},p(n,[r]){r&1&&!$e(e.src,t=n[0])&&m(e,"src",t)},i:j,o:j,d(n){n&&E(e)}}}function Xh(i,e,t){let n="";return st(()=>{manifests.length>0&&t(0,n=Ht(manifests[0]));function r(s){t(0,n=Ht(s.detail.selectedManifest))}window.addEventListener("selectManifest",r)}),[n]}class Qh extends ae{constructor(e){super(),oe(this,e,Xh,Jh,le,{})}}function $s(i,e,t){const n=i.slice();return n[5]=e[t],n}function Ds(i){let e,t=i[3](i[5])+"",n,r,s;return{c(){e=b("option"),n=J(t),r=D(),e.__value=s=i[5],e.value=e.__value},m(l,o){C(l,e,o),_(e,n),_(e,r)},p(l,o){o&1&&t!==(t=l[3](l[5])+"")&&fe(n,t),o&1&&s!==(s=l[5])&&(e.__value=s,e.value=e.__value)},d(l){l&&E(e)}}}function Zh(i){let e,t,n,r,s,l,o,a,c=i[0],u=[];for(let h=0;h<c.length;h+=1)u[h]=Ds($s(i,c,h));return{c(){e=b("div"),t=b("label"),t.textContent=`${N==="en"?"Digitization:":"Numérisation :"}`,n=D(),r=b("div"),s=b("div"),l=b("select");for(let h=0;h<u.length;h+=1)u[h].c();m(t,"for","digit"),m(t,"class","label"),i[1]===void 0&&rt(()=>i[4].call(l)),m(s,"class","select is-small"),m(r,"id","digit"),m(r,"class","control pl-3"),m(e,"class","field selector is-flex is-right mb-2")},m(h,f){C(h,e,f),_(e,t),_(e,n),_(e,r),_(r,s),_(s,l);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(l,null);Hn(l,i[1],!0),o||(a=[ie(l,"change",i[4]),ie(l,"change",i[2])],o=!0)},p(h,[f]){if(f&9){c=h[0];let d;for(d=0;d<c.length;d+=1){const p=$s(h,c,d);u[d]?u[d].p(p,f):(u[d]=Ds(p),u[d].c(),u[d].m(l,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}f&3&&Hn(l,h[1])},i:j,o:j,d(h){h&&E(e),et(u,h),o=!1,Ie(a)}}}function em(i,e,t){let{manifests:n}=e,r=(n==null?void 0:n[0])||"";function s(a){t(1,r=a.target.value),window.dispatchEvent(new CustomEvent("selectManifest",{detail:{selectedManifest:r}}))}function l(a){const c=a.match(/man(\d+)/),u=c?c[1]:"?",h=a.match(/anno(\d+)/),f=h?h[1]:null;let d="";return d+=`${N==="en"?"Manifest":"Manifeste"} #${u}`,f&&(d+=`, ${N==="en"?"Regions extraction":"Extraction de régions"} #${f}`),d}function o(){r=fo(this),t(1,r),t(0,n)}return i.$$set=a=>{"manifests"in a&&t(0,n=a.manifests)},[n,r,s,l,o]}class tm extends ae{constructor(e){super(),oe(this,e,em,Zh,le,{manifests:0})}}function im(i){let e,t,n,r,s=N==="en"?"Download All":"Tout Télécharger",l,o,a;return{c(){e=b("div"),t=b("button"),n=b("i"),r=D(),l=J(s),m(n,"class","fa-solid fa-download"),m(t,"class","button is-link is-light"),m(e,"class","is-right mb-3")},m(c,u){C(c,e,u),_(e,t),_(t,n),_(t,r),_(t,l),o||(a=ie(t,"click",i[0]),o=!0)},p:j,i:j,o:j,d(c){c&&E(e),o=!1,a()}}}function nm(i){const e=`${window.location.origin}${window.location.pathname}`,t=parseInt(e.split("witness/")[1].replace("/","")),n=parseInt(e.split("regions/")[1].replace("/",""));async function r(){if(!n&&!t){console.error("No Region or Witness");return}const s=n?`${window.location.origin}/${Ve}/export-regions-imgs-and-svgs/${n}`:`${window.location.origin}/${Ve}/export-all-imgs-and-svgs/${t}`;try{const l=await Ut(()=>fetch(s,{method:"GET",headers:{"X-CSRFToken":Xe,"Content-Type":"application/json"}}));if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const o=await l.blob();Qs(o,"vectorizations.zip")}catch(l){console.error("Erreur lors du téléchargement des vectorisations:",l)}}return[r]}class rm extends ae{constructor(e){super(),oe(this,e,nm,im,le,{})}}function Ns(i,e,t){const n=i.slice();return n[26]=e[t][0],n[27]=e[t][1],n}function js(i,e,t){const n=i.slice();return n[30]=e[t][0],n[31]=e[t][1],n}function sm(i){let e,t,n;return t=new sa({props:{witness:i[1],editUrl:i[2],viewTitle:i[3]}}),{c(){e=b("div"),G(t.$$.fragment),m(e,"slot","sidebar")},m(r,s){C(r,e,s),K(t,e,null),n=!0},p(r,s){const l={};s[0]&2&&(l.witness=r[1]),s[0]&4&&(l.editUrl=r[2]),s[0]&8&&(l.viewTitle=r[3]),t.$set(l)},i(r){n||(O(t.$$.fragment,r),n=!0)},o(r){L(t.$$.fragment,r),n=!1},d(r){r&&E(e),W(t)}}}function lm(i){let e,t,n,r,s,l,o,a,c,u;const h=[um,cm,am],f=[];function d(w,S){return w[9]==="all"||w[9]==="page"?0:w[9]==="viewer"?1:w[9]==="vectorization"?2:-1}~(r=d(i))&&(s=f[r]=h[r](i));const p=[pm,mm,hm,dm,fm],g=[];function v(w,S){return w[9]==="viewer"?0:w[9]==="all"?1:w[9]==="page"?2:w[9]==="similarity"?3:w[9]==="vectorization"?4:-1}return~(o=v(i))&&(a=g[o]=p[o](i)),{c(){e=b("div"),t=b("div"),n=b("div"),s&&s.c(),l=D(),a&&a.c(),c=_e(),m(n,"class","cell"),m(t,"class","actions grid"),m(e,"id","nav-actions")},m(w,S){C(w,e,S),_(e,t),_(t,n),~r&&f[r].m(n,null),C(w,l,S),~o&&g[o].m(w,S),C(w,c,S),u=!0},p(w,S){let P=r;r=d(w),r===P?~r&&f[r].p(w,S):(s&&(pe(),L(f[P],1,1,()=>{f[P]=null}),ge()),~r?(s=f[r],s?s.p(w,S):(s=f[r]=h[r](w),s.c()),O(s,1),s.m(n,null)):s=null);let M=o;o=v(w),o===M?~o&&g[o].p(w,S):(a&&(pe(),L(g[M],1,1,()=>{g[M]=null}),ge()),~o?(a=g[o],a?a.p(w,S):(a=g[o]=p[o](w),a.c()),O(a,1),a.m(c.parentNode,c)):a=null)},i(w){u||(O(s),O(a),u=!0)},o(w){L(s),L(a),u=!1},d(w){w&&E(e),~r&&f[r].d(),w&&E(l),~o&&g[o].d(w),w&&E(c)}}}function om(i){let e,t;return{c(){e=b("article"),t=b("div"),t.textContent=`${N==="en"?"This witness has no digitization.":"Ce témoin n'a pas de numérisation."}`,m(t,"class","message-body"),m(e,"class","message is-warning")},m(n,r){C(n,e,r),_(e,t)},p:j,i:j,o:j,d(n){n&&E(e)}}}function am(i){let e,t;return e=new rm({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function cm(i){let e,t;return e=new tm({props:{manifests:i[0]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r[0]&1&&(s.manifests=n[0]),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function um(i){let e,t;return e=new Sa({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function fm(i){let e,t;return e=new xh({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function dm(i){let e,t;return e=new Zd({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function hm(i){let e,t;return e=new gh({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function mm(i){let e,t,n={ctx:i,current:null,token:null,hasCatch:!0,pending:wm,then:_m,catch:gm,value:34,error:35,blocks:[,,,]};return Ze(i[15],n),{c(){e=b("div"),n.block.c(),m(e,"class","grid is-gap-2 mt-5")},m(r,s){C(r,e,s),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,t=!0},p(r,s){i=r,At(n,i,s)},i(r){t||(O(n.block),t=!0)},o(r){for(let s=0;s<3;s+=1){const l=n.blocks[s];L(l)}t=!1},d(r){r&&E(e),n.block.d(),n.token=null,n=null}}}function pm(i){let e,t;return e=new Qh({}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function gm(i){let e,t,n=i[35]+"",r;return{c(){e=b("div"),t=J("Error when retrieving regions: "),r=J(n)},m(s,l){C(s,e,l),_(e,t),_(e,r)},p:j,i:j,o:j,d(s){s&&E(e)}}}function _m(i){let e,t,n,r,s;const l=[bm,vm],o=[];function a(c,u){return u[0]&1024&&(e=null),e==null&&(e=!!Object.values(c[10]).length),e?0:1}return t=a(i,[-1,-1]),n=o[t]=l[t](i),{c(){n.c(),r=_e()},m(c,u){o[t].m(c,u),C(c,r,u),s=!0},p(c,u){let h=t;t=a(c,u),t===h?o[t].p(c,u):(pe(),L(o[h],1,1,()=>{o[h]=null}),ge(),n=o[t],n?n.p(c,u):(n=o[t]=l[t](c),n.c()),O(n,1),n.m(r.parentNode,r))},i(c){s||(O(n),s=!0)},o(c){L(n),s=!1},d(c){o[t].d(c),c&&E(r)}}}function vm(i){let e,t;return e=new nl({props:{currentRegionId:i[17],baseUrl:i[16]}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p:j,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function bm(i){let e,t;return e=new Hl({props:{items:Object.values(i[10])}}),{c(){G(e.$$.fragment)},m(n,r){K(e,n,r),t=!0},p(n,r){const s={};r[0]&1024&&(s.items=Object.values(n[10])),e.$set(s)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){L(e.$$.fragment,n),t=!1},d(n){W(e,n)}}}function wm(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"Retrieving regions...":"Récupération des régions..."}`,m(e,"class","faded is-center")},m(t,n){C(t,e,n)},p:j,i:j,o:j,d(t){t&&E(e)}}}function ym(i){let e,t,n,r;const s=[om,lm],l=[];function o(a,c){return a[0].length===0?0:1}return t=o(i),n=l[t]=s[t](i),{c(){e=b("div"),n.c(),m(e,"slot","content")},m(a,c){C(a,e,c),l[t].m(e,null),r=!0},p(a,c){let u=t;t=o(a),t===u?l[t].p(a,c):(pe(),L(l[u],1,1,()=>{l[u]=null}),ge(),n=l[t],n?n.p(a,c):(n=l[t]=s[t](a),n.c()),O(n,1),n.m(e,null))},i(a){r||(O(n),r=!0)},o(a){L(n),r=!1},d(a){a&&E(e),l[t].d()}}}function km(i){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No regions in selection":"Aucune région sélectionnée"}`},m(t,n){C(t,e,n)},p:j,d(t){t&&E(e)}}}function Sm(i){let e,t,n=Object.entries(i[7]),r=[];for(let s=0;s<n.length;s+=1)r[s]=Fs(Ns(i,n,s));return{c(){e=b("div"),t=b("div");for(let s=0;s<r.length;s+=1)r[s].c();m(t,"class","grid is-gap-2"),m(e,"class","fixed-grid has-6-cols")},m(s,l){C(s,e,l),_(e,t);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null)},p(s,l){if(l[0]&8320){n=Object.entries(s[7]);let o;for(o=0;o<n.length;o+=1){const a=Ns(s,n,o);r[o]?r[o].p(a,l):(r[o]=Fs(a),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(s){s&&E(e),et(r,s)}}}function Vs(i){let e,t,n,r,s,l,o,a=i[31].title+"",c,u,h,f,d,p;function g(){return i[25](i[30])}return{c(){e=b("div"),t=b("figure"),n=b("img"),s=D(),l=b("div"),o=b("span"),c=J(a),u=D(),h=b("button"),f=D(),$e(n.src,r=dt(i[31].img,i[31].xywh,"96,"))||m(n,"src",r),m(n,"alt",""),m(o,"class","overlay-desc"),m(l,"class","overlay is-center svelte-qn8evk"),m(t,"class","image is-64x64 card"),m(h,"class","delete region-btn"),m(e,"class","selection cell svelte-qn8evk")},m(v,w){C(v,e,w),_(e,t),_(t,n),_(t,s),_(t,l),_(l,o),_(o,c),_(e,u),_(e,h),_(e,f),d||(p=ie(h,"click",g),d=!0)},p(v,w){i=v,w[0]&128&&!$e(n.src,r=dt(i[31].img,i[31].xywh,"96,"))&&m(n,"src",r),w[0]&128&&a!==(a=i[31].title+"")&&fe(c,a)},d(v){v&&E(e),d=!1,p()}}}function Fs(i){let e,t=Object.entries(i[27]),n=[];for(let r=0;r<t.length;r+=1)n[r]=Vs(js(i,t,r));return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=_e()},m(r,s){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(r,s);C(r,e,s)},p(r,s){if(s[0]&8320){t=Object.entries(r[27]);let l;for(l=0;l<t.length;l+=1){const o=js(r,t,l);n[l]?n[l].p(o,s):(n[l]=Vs(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(r){et(n,r),r&&E(e)}}}function Em(i){let e;function t(s,l){return s[6]?Sm:km}let n=t(i),r=n(i);return{c(){r.c(),e=_e()},m(s,l){r.m(s,l),C(s,e,l)},p(s,l){n===(n=t(s))&&r?r.p(s,l):(r.d(1),r=n(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&E(e)}}}function Cm(i){let e,t,n,r,s,l,o,a,c,u;return e=new il({props:{visible:i[8]}}),n=new da({}),s=new aa({props:{selectionLength:i[4]}}),o=new Xo({props:{tabList:i[5],$$slots:{content:[ym],sidebar:[sm]},$$scope:{ctx:i}}}),c=new Ih({props:{selectionLength:i[4],selectionStore:gt,$$slots:{default:[Em]},$$scope:{ctx:i}}}),{c(){G(e.$$.fragment),t=D(),G(n.$$.fragment),r=D(),G(s.$$.fragment),l=D(),G(o.$$.fragment),a=D(),G(c.$$.fragment)},m(h,f){K(e,h,f),C(h,t,f),K(n,h,f),C(h,r,f),K(s,h,f),C(h,l,f),K(o,h,f),C(h,a,f),K(c,h,f),u=!0},p(h,f){const d={};f[0]&256&&(d.visible=h[8]),e.$set(d);const p={};f[0]&16&&(p.selectionLength=h[4]),s.$set(p);const g={};f[0]&32&&(g.tabList=h[5]),f[0]&1551|f[1]&32&&(g.$$scope={dirty:f,ctx:h}),o.$set(g);const v={};f[0]&16&&(v.selectionLength=h[4]),f[0]&192|f[1]&32&&(v.$$scope={dirty:f,ctx:h}),c.$set(v)},i(h){u||(O(e.$$.fragment,h),O(n.$$.fragment,h),O(s.$$.fragment,h),O(o.$$.fragment,h),O(c.$$.fragment,h),u=!0)},o(h){L(e.$$.fragment,h),L(n.$$.fragment,h),L(s.$$.fragment,h),L(o.$$.fragment,h),L(c.$$.fragment,h),u=!1},d(h){W(e,h),h&&E(t),W(n,h),h&&E(r),W(s,h),h&&E(l),W(o,h),h&&E(a),W(c,h)}}}function Im(i,e,t){let n,r,s,l,o,a,c,u;ue(i,Ot,x=>t(8,a=x)),ue(i,St,x=>t(9,c=x));const{selected:h,nbSelected:f,remove:d}=gt;ue(i,h,x=>t(24,o=x)),ue(i,f,x=>t(23,l=x));const{allRegions:p,fetchAll:g}=bt;ue(i,p,x=>t(10,u=x));let{manifest:v=""}=e,{manifests:w=[]}=e,{isValidated:S=!1}=e,{imgPrefix:P=""}=e,{nbOfPages:M=1}=e,{trailingZeros:I=1}=e,{witness:R={}}=e,{editUrl:T=""}=e,{viewTitle:y=""}=e;at("witness",R),at("nbOfPages",M),at("trailingZeros",I),at("imgPrefix",P),at("manifest",v),at("isValidated",S);const F=`${window.location.origin}${window.location.pathname}`,Y=parseInt(F.split("regions/")[1].replace("/","")),se={viewer:N==="en"?"Viewer":"Visionneuse",all:N==="en"?"All regions":"Toutes les régions",page:N==="en"?"Per page":"Par page"};Ft.includes("similarity")&&(se.similarity=N==="en"?"Similarity":"Similarité"),Ft.includes("vectorization")&&(se.vectorization=N==="en"?"Vectorization":"Vectorisation");const U=x=>d(x,ci);return i.$$set=x=>{"manifest"in x&&t(18,v=x.manifest),"manifests"in x&&t(0,w=x.manifests),"isValidated"in x&&t(19,S=x.isValidated),"imgPrefix"in x&&t(20,P=x.imgPrefix),"nbOfPages"in x&&t(21,M=x.nbOfPages),"trailingZeros"in x&&t(22,I=x.trailingZeros),"witness"in x&&t(1,R=x.witness),"editUrl"in x&&t(2,T=x.editUrl),"viewTitle"in x&&t(3,y=x.viewTitle)},i.$$.update=()=>{i.$$.dirty[0]&16777216&&t(7,n=o),i.$$.dirty[0]&8388608&&t(4,r=l),i.$$.dirty[0]&16&&t(6,s=r>0)},[w,R,T,y,r,se,s,n,a,c,u,h,f,d,p,g,F,Y,v,S,P,M,I,l,o,U]}class Om extends ae{constructor(e){super(),oe(this,e,Im,Cm,le,{manifest:18,manifests:0,isValidated:19,imgPrefix:20,nbOfPages:21,trailingZeros:22,witness:1,editUrl:2,viewTitle:3},null,[-1,-1])}}new Om({target:document.getElementById("witness-view"),props:{viewTitle,editUrl,witness,manifest,manifests,isValidated,imgPrefix,nbOfPages,trailingZeros}});
//# sourceMappingURL=witness.js.map
