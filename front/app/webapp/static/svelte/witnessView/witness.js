function j(){}const Ur=n=>n;function no(n,e){for(const t in e)n[t]=e[t];return n}function io(n){return!!n&&(typeof n=="object"||typeof n=="function")&&typeof n.then=="function"}function Hr(n){return n()}function Fi(){return Object.create(null)}function Ie(n){n.forEach(Hr)}function dn(n){return typeof n=="function"}function le(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let kn;function $e(n,e){return kn||(kn=document.createElement("a")),kn.href=e,n===kn.href}function so(n){return Object.keys(n).length===0}function pi(n,...e){if(n==null)return j;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function gi(n){let e;return pi(n,t=>e=t)(),e}function ue(n,e,t){n.$$.on_destroy.push(pi(e,t))}function He(n,e,t,i){if(n){const s=qr(n,e,t,i);return n[0](s)}}function qr(n,e,t,i){return n[1]&&i?no(t.ctx.slice(),n[1](i(e))):t.ctx}function qe(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],l=Math.max(e.dirty.length,s.length);for(let o=0;o<l;o+=1)r[o]=e.dirty[o]|s[o];return r}return e.dirty|s}return e.dirty}function Be(n,e,t,i,s,r){if(s){const l=qr(e,t,i,r);n.p(l,s)}}function ze(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function ro(n){const e={};for(const t in n)e[t]=!0;return e}function Sn(n){return n??""}function Mn(n){return n&&dn(n.destroy)?n.destroy:j}const Br=typeof window<"u";let lo=Br?()=>window.performance.now():()=>Date.now(),_i=Br?n=>requestAnimationFrame(n):j;const Rt=new Set;function zr(n){Rt.forEach(e=>{e.c(n)||(Rt.delete(e),e.f())}),Rt.size!==0&&_i(zr)}function oo(n){let e;return Rt.size===0&&_i(zr),{promise:new Promise(t=>{Rt.add(e={c:n,f:t})}),abort(){Rt.delete(e)}}}function _(n,e){n.appendChild(e)}function Kr(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function ao(n){const e=b("style");return co(Kr(n),e),e.sheet}function co(n,e){return _(n.head||n,e),e.sheet}function C(n,e,t){n.insertBefore(e,t||null)}function E(n){n.parentNode&&n.parentNode.removeChild(n)}function et(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function b(n){return document.createElement(n)}function Ue(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function J(n){return document.createTextNode(n)}function D(){return J(" ")}function pe(){return J("")}function ne(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function wt(n){return function(e){return e.preventDefault(),n.call(this,e)}}function Wr(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function uo(n){return Array.from(n.childNodes)}function fe(n,e){e=""+e,n.data!==e&&(n.data=e)}function Dt(n,e){n.value=e??""}function ge(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}function Ui(n,e,t){for(let i=0;i<n.options.length;i+=1){const s=n.options[i];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function fo(n){const e=n.querySelector(":checked");return e&&e.__value}function Ce(n,e,t){n.classList[t?"add":"remove"](e)}function Gr(n,e,{bubbles:t=!1,cancelable:i=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(n,t,i,e),s}class ho{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=Ue(t.nodeName):this.e=b(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)C(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(E)}}const Pn=new Map;let Ln=0;function mo(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function po(n,e){const t={stylesheet:ao(e),rules:{}};return Pn.set(n,t),t}function Hi(n,e,t,i,s,r,l,o=0){const a=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(t-e)*r(v);c+=v*100+`%{${l(w,1-w)}}
`}const u=c+`100% {${l(t,1-t)}}
}`,h=`__svelte_${mo(u)}_${o}`,f=Kr(n),{stylesheet:d,rules:p}=Pn.get(f)||po(f,n);p[h]||(p[h]=!0,d.insertRule(`@keyframes ${h} ${u}`,d.cssRules.length));const g=n.style.animation||"";return n.style.animation=`${g?`${g}, `:""}${h} ${i}ms linear ${s}ms 1 both`,Ln+=1,h}function go(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Ln-=s,Ln||_o())}function _o(){_i(()=>{Ln||(Pn.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&E(e)}),Pn.clear())})}let cn;function ct(n){cn=n}function zt(){if(!cn)throw new Error("Function called outside component initialization");return cn}function rt(n){zt().$$.on_mount.push(n)}function hn(n){zt().$$.on_destroy.push(n)}function Kt(){const n=zt();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const r=Gr(e,t,{cancelable:i});return s.slice().forEach(l=>{l.call(n,r)}),!r.defaultPrevented}return!0}}function at(n,e){return zt().$$.context.set(n,e),e}function Je(n){return zt().$$.context.get(n)}function Rn(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(i=>i.call(this,e))}const Pt=[],ft=[];let $t=[];const si=[],vo=Promise.resolve();let ri=!1;function bo(){ri||(ri=!0,vo.then(vi))}function st(n){$t.push(n)}function Nt(n){si.push(n)}const Zn=new Set;let Tt=0;function vi(){if(Tt!==0)return;const n=cn;do{try{for(;Tt<Pt.length;){const e=Pt[Tt];Tt++,ct(e),wo(e.$$)}}catch(e){throw Pt.length=0,Tt=0,e}for(ct(null),Pt.length=0,Tt=0;ft.length;)ft.pop()();for(let e=0;e<$t.length;e+=1){const t=$t[e];Zn.has(t)||(Zn.add(t),t())}$t.length=0}while(Pt.length);for(;si.length;)si.pop()();ri=!1,Zn.clear(),ct(n)}function wo(n){if(n.fragment!==null){n.update(),Ie(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(st)}}function yo(n){const e=[],t=[];$t.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),$t=e}let tn;function ko(){return tn||(tn=Promise.resolve(),tn.then(()=>{tn=null})),tn}function ei(n,e,t){n.dispatchEvent(Gr(`${e?"intro":"outro"}${t}`))}const On=new Set;let ut;function _e(){ut={r:0,c:[],p:ut}}function ve(){ut.r||Ie(ut.c),ut=ut.p}function M(n,e){n&&n.i&&(On.delete(n),n.i(e))}function R(n,e,t,i){if(n&&n.o){if(On.has(n))return;On.add(n),ut.c.push(()=>{On.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const So={duration:0};function vt(n,e,t,i){const s={direction:"both"};let r=e(n,t,s),l=i?0:1,o=null,a=null,c=null;function u(){c&&go(n,c)}function h(d,p){const g=d.b-l;return p*=Math.abs(g),{a:l,b:d.b,d:g,duration:p,start:d.start,end:d.start+p,group:d.group}}function f(d){const{delay:p=0,duration:g=300,easing:v=Ur,tick:w=j,css:S}=r||So,P={start:lo()+p,b:d};d||(P.group=ut,ut.r+=1),o||a?a=P:(S&&(u(),c=Hi(n,l,d,g,p,v,S)),d&&w(0,1),o=h(P,g),st(()=>ei(n,d,"start")),oo(T=>{if(a&&T>a.start&&(o=h(a,g),a=null,ei(n,o.b,"start"),S&&(u(),c=Hi(n,l,o.b,o.duration,0,v,r.css))),o){if(T>=o.end)w(l=o.b,1-l),ei(n,o.b,"end"),a||(o.b?u():--o.group.r||Ie(o.group.c)),o=null;else if(T>=o.start){const I=T-o.start;l=o.a+o.d*v(I/o.duration),w(l,1-l)}}return!!(o||a)}))}return{run(d){dn(r)?ko().then(()=>{r=r(s),f(d)}):f(d)},end(){u(),o=a=null}}}function Ze(n,e){const t=e.token={};function i(s,r,l,o){if(e.token!==t)return;e.resolved=o;let a=e.ctx;l!==void 0&&(a=a.slice(),a[l]=o);const c=s&&(e.current=s)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((h,f)=>{f!==r&&h&&(_e(),R(h,1,1,()=>{e.blocks[f]===h&&(e.blocks[f]=null)}),ve())}):e.block.d(1),c.c(),M(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[r]=c),u&&vi()}if(io(n)){const s=zt();if(n.then(r=>{ct(s),i(e.then,1,e.value,r),ct(null)},r=>{if(ct(s),i(e.catch,2,e.error,r),ct(null),!e.hasCatch)throw r}),e.current!==e.pending)return i(e.pending,0),!0}else{if(e.current!==e.then)return i(e.then,1,e.value,n),!0;e.resolved=n}}function At(n,e,t){const i=e.slice(),{resolved:s}=n;n.current===n.then&&(i[n.value]=s),n.current===n.catch&&(i[n.error]=s),n.block.p(i,t)}function Eo(n,e){n.d(1),e.delete(n.key)}function Fn(n,e){R(n,1,1,()=>{e.delete(n.key)})}function mn(n,e,t,i,s,r,l,o,a,c,u,h){let f=n.length,d=r.length,p=f;const g={};for(;p--;)g[n[p].key]=p;const v=[],w=new Map,S=new Map,P=[];for(p=d;p--;){const A=h(s,r,p),y=t(A);let F=l.get(y);F?i&&P.push(()=>F.p(A,e)):(F=c(y,A),F.c()),w.set(y,v[p]=F),y in g&&S.set(y,Math.abs(p-g[y]))}const T=new Set,I=new Set;function L(A){M(A,1),A.m(o,u),l.set(A.key,A),u=A.first,d--}for(;f&&d;){const A=v[d-1],y=n[f-1],F=A.key,K=y.key;A===y?(u=A.first,f--,d--):w.has(K)?!l.has(F)||T.has(F)?L(A):I.has(K)?f--:S.get(F)>S.get(K)?(I.add(F),L(A)):(T.add(K),f--):(a(y,l),f--)}for(;f--;){const A=n[f];w.has(A.key)||a(A,l)}for(;d;)L(v[d-1]);return Ie(P),v}function jt(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function x(n){n&&n.c()}function W(n,e,t,i){const{fragment:s,after_update:r}=n.$$;s&&s.m(e,t),i||st(()=>{const l=n.$$.on_mount.map(Hr).filter(dn);n.$$.on_destroy?n.$$.on_destroy.push(...l):Ie(l),n.$$.on_mount=[]}),r.forEach(st)}function G(n,e){const t=n.$$;t.fragment!==null&&(yo(t.after_update),Ie(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Co(n,e){n.$$.dirty[0]===-1&&(Pt.push(n),bo(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function oe(n,e,t,i,s,r,l,o=[-1]){const a=cn;ct(n);const c=n.$$={fragment:null,ctx:[],props:r,update:j,not_equal:s,bound:Fi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Fi(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};l&&l(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(h,f,...d)=>{const p=d.length?d[0]:f;return c.ctx&&s(c.ctx[h],c.ctx[h]=p)&&(!c.skip_bound&&c.bound[h]&&c.bound[h](p),u&&Co(n,h)),f}):[],c.update(),u=!0,Ie(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const h=uo(e.target);c.fragment&&c.fragment.l(h),h.forEach(E)}else c.fragment&&c.fragment.c();e.intro&&M(n.$$.fragment),W(n,e.target,e.anchor,e.customElement),vi()}ct(a)}class ae{$destroy(){G(this,1),this.$destroy=j}$on(e,t){if(!dn(t))return j;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!so(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Io(n){const e=n-1;return e*e*e+1}function Vt(n,{delay:e=0,duration:t=400,easing:i=Ur}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:r=>`opacity: ${r*s}`}}function qi(n,{delay:e=0,duration:t=400,easing:i=Io,axis:s="y"}={}){const r=getComputedStyle(n),l=+r.opacity,o=s==="y"?"height":"width",a=parseFloat(r[o]),c=s==="y"?["top","bottom"]:["left","right"],u=c.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),h=parseFloat(r[`padding${u[0]}`]),f=parseFloat(r[`padding${u[1]}`]),d=parseFloat(r[`margin${u[0]}`]),p=parseFloat(r[`margin${u[1]}`]),g=parseFloat(r[`border${u[0]}Width`]),v=parseFloat(r[`border${u[1]}Width`]);return{delay:e,duration:t,easing:i,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*l};${o}: ${w*a}px;padding-${c[0]}: ${w*h}px;padding-${c[1]}: ${w*f}px;margin-${c[0]}: ${w*d}px;margin-${c[1]}: ${w*p}px;border-${c[0]}-width: ${w*g}px;border-${c[1]}-width: ${w*v}px;`}}const Mt=[];function Oo(n,e){return{subscribe:Ee(n,e).subscribe}}function Ee(n,e=j){let t;const i=new Set;function s(o){if(le(n,o)&&(n=o,t)){const a=!Mt.length;for(const c of i)c[1](),Mt.push(c,n);if(a){for(let c=0;c<Mt.length;c+=2)Mt[c][0](Mt[c+1]);Mt.length=0}}}function r(o){s(o(n))}function l(o,a=j){const c=[o,a];return i.add(c),i.size===1&&(t=e(s)||j),o(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:r,subscribe:l}}function Ye(n,e,t){const i=!Array.isArray(n),s=i?[n]:n,r=e.length<2;return Oo(t,l=>{let o=!1;const a=[];let c=0,u=j;const h=()=>{if(c)return;u();const d=e(i?a[0]:a,l);r?l(d):u=dn(d)?d:j},f=s.map((d,p)=>pi(d,g=>{a[p]=g,c&=~(1<<p),o&&h()},()=>{c|=1<<p}));return o=!0,h(),function(){Ie(f),u(),o=!1}})}const N=APP_LANG,Ve=APP_NAME;WEBAPP_NAME;const An=USER_ID,Ao=IS_SUPERUSER,Xe=CSRF_TOKEN,Ft=ADDITIONAL_MODULES,un="Region";APP_URL;const To=SAS_APP_URL,Mo=CANTALOUPE_APP_URL,Po=MEDIA_PATH,Lo=PAGE_LEN,Ot=Ee(!1),Yr=Ee(""),Ro=n=>typeof n=="string"||n instanceof String;async function Ut(n){Ot.set(!0);try{return await n()}finally{Ot.set(!1)}}function xr(n){return n.match(/\d+/g).toString()}function $o(n){return parseInt(xr(n),10)}function Jr(n,e=100){const t=Math.floor(e*.75);return n.length>e?n.slice(0,t)+"..."+n.slice(-e+t):n}function ln(){return Mo??"http://localhost:8182"}function Xr(){return To??"http://localhost:8888"}function bi(n,e){if(typeof window<"u"){const t=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(t))return n.set(t),t}return n.set(1),1}function wi(n,e,t){if(e.set(n),typeof window<"u"){const i=new URL(window.location.href);i.searchParams.set(t,n),window.history.pushState({},"",i)}}function Do(n=null){if(n)return n=n.split("_"),n.length<3?void 0:`${n.slice(0,3).join("_").replace(".jpg","")}.jpg`}function No(n=null){const e=Do(n);return e===void 0?void 0:`${ln()}/iiif/2/${e}`}function dt(n=null,e=null,t="full"){if(e=Ro(e)?e.replace(".jpg",""):e,!n)return"https://placehold.co/96x96/png?text=No+image";if(!n.startsWith("wit")){const[r,...l]=n.split("_wit");n=`wit${l}`}const i=No(n);if(i===void 0)return"https://placehold.co/96x96/png?text=No+image";const s=n.split("_");return e||(e=s[s.length-1].includes(",")?s.pop().replace(".jpg",""):"full"),`${i}/${e}/${t}/0/default.jpg`}function Ht(n=null,e=1){return`${Xr()}/index.html?iiif-content=${n}&canvas=${e}`}function Re(n,e=null,t=!1){return new Promise(i=>{if(document.getElementById("msg-modal")){t?document.getElementById("modal-footer").hidden=!1:i(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=n,document.getElementById("hidden-msg-btn").click();const r=document.getElementById("cancel-btn"),l=document.getElementById("ok-btn"),o=document.getElementById("modal-bkg"),a=()=>{r.removeEventListener("click",c),o.removeEventListener("click",c),l.removeEventListener("click",u),document.getElementById("modal-footer").hidden=!0},c=()=>{a(),i(!1)},u=()=>{a(),i(!0)};r.addEventListener("click",c),l.addEventListener("click",u)}else t?i(window.confirm(n)):(window.alert(n),i(void 0))})}function Qr(n,e){const t=window.URL.createObjectURL(n),i=document.createElement("a");i.href=t,i.download=`${e}`,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(t),document.body.removeChild(i)}function $n(){let n,e,t=(i,s)=>i===s;return{set:i=>{e=n,n=i},setCompareFn:i=>t=i,get:()=>n,getNewAndOld:()=>[n,e],same:()=>t(n,e)}}const yi=(n,e)=>Array.isArray(n)&&Array.isArray(e)&&n.length===e.length&&n.every((t,i)=>t===e[i]||void 0);function Zr(n=null){return n<600?1:n<800?2:n<1e3?3:n<1200?4:n<1400?5:n>=1400?6:4}function el(n){const e=n.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),t=()=>n.classList.remove("is-active");e.forEach(s=>s.addEventListener("click",t));const i=s=>{s.key==="Escape"&&n.classList.contains("is-active")&&t()};return document.addEventListener("keydown",i),{destroy(){e.forEach(s=>s.removeEventListener("click",t)),document.removeEventListener("keydown",i)}}}function tl(n){const e=()=>{const t=document.getElementById(n.dataset.target);t==null||t.classList.add("is-active")};return n.addEventListener("click",e),{destroy(){n.removeEventListener("click",e)}}}function ki(n){const{type:e,modelName:t,title:i,extractMeta:s=d=>d}=n,r={id:null,type:e,title:i,is_public:!1,selected:{}},l=JSON.parse(localStorage.getItem(e))||r,o=Ee(l),a=Ee(!1);function c(d,p=!1){a.set(p),localStorage.setItem(e,JSON.stringify(d))}function u(){o.update(d=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),d;const p=Object.fromEntries(Object.entries(d.selected).map(([v,w])=>[v,Object.keys(w)])),g=d.id?`${d.id}/edit`:"new";return fetch(`${window.location.origin}/${t}/${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify({title:d.title,is_public:d.is_public,selection:d,...p})}).then(v=>v.json()).then(v=>{if(!(v!=null&&v.document_set_id))throw new Error("Failed to save");o.update(w=>(w.id=v.document_set_id,w.title=v.document_set_title,w.is_public=v.is_public,c(w,!0),w))}).catch(v=>console.error("Error:",v)),d})}const h=d=>o.update(()=>{const p=d.selection.id?d.selection:{...d.selection,id:d.id};return c(p),p}),f=()=>o.update(()=>{const d={...r,selected:{}};return c(d),d});return{type:e,subscribe:o.subscribe,add:d=>o.update(p=>(p.selected[d.class]={...p.selected[d.class]||{},[d.id]:s(d)},c(p),p)),addAll:d=>o.update(p=>(d.forEach(g=>{p.selected[g.class]={...p.selected[g.class]||{},[g.id]:s(g)}}),c(p),p)),remove:(d,p)=>o.update(g=>{const{[d]:v,...w}=g.selected[p];return g.selected[p]=w,c(g),g}),removeAll:(d,p)=>o.update(g=>(d.forEach(v=>{var w;return(w=g.selected[p])==null?!0:delete w[v]}),c(g),g)),toggle:d=>o.update(p=>{var g;if((g=p.selected[d.class])!=null&&g[d.id]){const{[d.id]:v,...w}=p.selected[d.class];p.selected[d.class]=w}else p.selected[d.class]={...p.selected[d.class]||{},[d.id]:s(d)};return c(p),p}),toggleSet:d=>{gi(o).id===d.id?f():h(d)},empty:()=>o.update(d=>(d.id=null,d.title=i,d.selected={},c(d,!0),d)),updateTitle:d=>o.update(p=>(p.title=d,c(p,!0),p)),updatePublic:d=>o.update(p=>(p.is_public=d,c(p,!0),p)),save:u,isSaved:a,selection:o,selectionTitle:Ye(o,d=>d.title),isSelected:Ye(o,d=>p=>{var g;return((g=d.selected[p.class])==null?void 0:g[p.id])||!1}),selected:Ye(o,d=>d.selected),nbSelected:Ye(o,d=>Object.entries(d.selected).reduce((p,[g,v])=>g==="User"?p:p+Object.keys(v).length,0)),isSetSelected:Ye(o,d=>p=>d.id===p.id)}}const jo=ki({type:"documentSet",modelName:"document-set",title:N==="en"?"Document set":"Set de documents",extractMeta:n=>({title:n.title,url:n.url})}),gt=ki({type:"regionsSet",modelName:"regions-set",title:N==="en"?"Regions set":"Set de régions",extractMeta:n=>n});function Vo(n){if(!n.startsWith("wit"))return n;const[e,...t]=n.split("_wit");return`wit${t}`}ki({type:"clusterSet",modelName:"cluster-set",title:N==="en"?"Selected regions":"Régions sélectionnées",extractMeta:n=>({imgRef:n.id,clusterId:n.clusterId,title:n.title,xywh:n.xywh,img:Vo(n.id)})});function Fo(){const n=`${window.location.origin}${window.location.pathname}`,e=Ee(1),t=Ee({}),i=Ee({}),s=Ee("");bi(e,"p");function r(u){s.update(h=>{const f=h===u?"":u;return navigator.clipboard.writeText(f).then(d=>""),f})}const l=(async()=>{try{const u=await fetch(`${n}canvas`);if(!u.ok)return{};const h=await u.json();let f={};return Object.values(h).forEach(d=>{Object.entries(d).forEach(([p,g])=>{f[p]=g})}),t.set(f),h}catch{return{}}})(),o=Ye(e,u=>(async()=>{const f=await(await fetch(`${n}canvas?p=${u}`)).json();return i.set(f),f})());function a(u){wi(u,e,"p")}function c(u){t.update(h=>(delete h[u],{...h})),i.update(h=>{for(const f in h)if(h[f][u]){const{[u]:d,...p}=h[f];return h[f]=p,h}return h})}return{currentPage:e,pageRegions:i,allRegions:t,fetchPages:o,fetchAll:l,handlePageUpdate:a,remove:c,clipBoard:s,copyRef:r}}const bt=Fo();function Bi(n){let e,t,i;return{c(){e=b("div"),e.innerHTML='<div class="loader svelte-vizlcg"></div>',m(e,"class","bkg-shade svelte-vizlcg")},m(s,r){C(s,e,r),i=!0},i(s){i||(st(()=>{i&&(t||(t=vt(e,Vt,{duration:150},!0)),t.run(1))}),i=!0)},o(s){t||(t=vt(e,Vt,{duration:150},!1)),t.run(0),i=!1},d(s){s&&E(e),s&&t&&t.end()}}}function Uo(n){let e,t,i=n[0]&&Bi();return{c(){i&&i.c(),e=pe()},m(s,r){i&&i.m(s,r),C(s,e,r),t=!0},p(s,[r]){s[0]?i?r&1&&M(i,1):(i=Bi(),i.c(),M(i,1),i.m(e.parentNode,e)):i&&(_e(),R(i,1,1,()=>{i=null}),ve())},i(s){t||(M(i),t=!0)},o(s){R(i),t=!1},d(s){i&&i.d(s),s&&E(e)}}}function Ho(n,e,t){let i;return ue(n,Ot,s=>t(0,i=s)),[i]}class nl extends ae{constructor(e){super(),oe(this,e,Ho,Uo,le,{})}}function qo(){const n=new URLSearchParams(window.location.search).get("tab")??"all",{subscribe:e,set:t}=Ee(n);return{subscribe:e,change:i=>{t(i);const s=new URL(window.location);s.searchParams.set("tab",i),window.history.pushState({},"",s)},init:()=>{const i=new URLSearchParams(window.location.search).get("tab")??"all";t(i)}}}const St=qo();const Bo=n=>({}),zi=n=>({});function Ki(n,e,t){const i=n.slice();return i[9]=e[t][0],i[10]=e[t][1],i}const zo=n=>({}),Wi=n=>({}),Ko=n=>({}),Gi=n=>({});function Wo(n){let e,t,i=Object.entries(n[2]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Yi(Ki(n,i,r));return{c(){e=b("div"),t=b("ul");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","tabs")},m(r,l){C(r,e,l),_(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,l){if(l&12){i=Object.entries(r[2]);let o;for(o=0;o<i.length;o+=1){const a=Ki(r,i,o);s[o]?s[o].p(a,l):(s[o]=Yi(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:j,o:j,d(r){r&&E(e),et(s,r)}}}function Go(n){let e;const t=n[7].tabs,i=He(t,n,n[6],Wi);return{c(){i&&i.c()},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&64)&&Be(i,t,s,s[6],e?qe(t,s[6],r,zo):ze(s[6]),Wi)},i(s){e||(M(i,s),e=!0)},o(s){R(i,s),e=!1},d(s){i&&i.d(s)}}}function Yi(n){let e,t,i=n[10]+"",s,r,l,o;function a(){return n[8](n[9])}return{c(){e=b("li"),t=b("a"),s=J(i),r=D(),m(t,"href",null),Ce(e,"is-active",n[3]===n[9])},m(c,u){C(c,e,u),_(e,t),_(t,s),_(e,r),l||(o=ne(t,"click",a),l=!0)},p(c,u){n=c,u&4&&i!==(i=n[10]+"")&&fe(s,i),u&12&&Ce(e,"is-active",n[3]===n[9])},d(c){c&&E(e),l=!1,o()}}}function Yo(n){let e,t,i,s,r,l,o,a,c,u,h,f,d;e=new nl({});const p=n[7].sidebar,g=He(p,n,n[6],Gi),v=[Go,Wo],w=[];function S(I,L){return L&4&&(a=null),I[4].tabs?0:(a==null&&(a=!!Object.keys(I[2]).length),a?1:-1)}~(c=S(n,-1))&&(u=w[c]=v[c](n));const P=n[7].content,T=He(P,n,n[6],zi);return{c(){x(e.$$.fragment),t=D(),i=b("div"),s=b("aside"),g&&g.c(),r=D(),l=b("main"),o=b("nav"),u&&u.c(),h=D(),f=b("div"),T&&T.c(),m(s,"class","sidebar svelte-jr84gp"),ge(s,"width",n[0]+"%"),ge(s,"min-height",n[1]),m(o,"id","tabs"),m(o,"class","tabs-bar"),m(f,"class","content-area pl-5 svelte-jr84gp"),m(l,"class","main-content svelte-jr84gp"),ge(l,"width",100-n[0]+"%"),ge(l,"min-height",n[1]),m(i,"class","layout svelte-jr84gp"),ge(i,"min-height",n[1])},m(I,L){W(e,I,L),C(I,t,L),C(I,i,L),_(i,s),g&&g.m(s,null),_(i,r),_(i,l),_(l,o),~c&&w[c].m(o,null),_(l,h),_(l,f),T&&T.m(f,null),d=!0},p(I,[L]){g&&g.p&&(!d||L&64)&&Be(g,p,I,I[6],d?qe(p,I[6],L,Ko):ze(I[6]),Gi),(!d||L&1)&&ge(s,"width",I[0]+"%");let A=c;c=S(I,L),c===A?~c&&w[c].p(I,L):(u&&(_e(),R(w[A],1,1,()=>{w[A]=null}),ve()),~c?(u=w[c],u?u.p(I,L):(u=w[c]=v[c](I),u.c()),M(u,1),u.m(o,null)):u=null),T&&T.p&&(!d||L&64)&&Be(T,P,I,I[6],d?qe(P,I[6],L,Bo):ze(I[6]),zi),(!d||L&1)&&ge(l,"width",100-I[0]+"%")},i(I){d||(M(e.$$.fragment,I),M(g,I),M(u),M(T,I),d=!0)},o(I){R(e.$$.fragment,I),R(g,I),R(u),R(T,I),d=!1},d(I){G(e,I),I&&E(t),I&&E(i),g&&g.d(I),~c&&w[c].d(),T&&T.d(I)}}}function xo(n=null){n||(n=document.getElementById("navbar")),document.documentElement.style.setProperty("--top-offset",`${n.offsetHeight}px`)}function Jo(n,e,t){let i;ue(n,St,f=>t(3,i=f));let{$$slots:s={},$$scope:r}=e;const l=ro(s);let{sidebarWidth:o="25"}=e;const a="90vh";let{tabList:c={}}=e,{topOffsetElement:u=null}=e;xo(u),rt(()=>(St.init(),window.addEventListener("popstate",()=>St.init()),()=>window.removeEventListener("popstate",()=>St.init())));const h=f=>St.change(f);return n.$$set=f=>{"sidebarWidth"in f&&t(0,o=f.sidebarWidth),"tabList"in f&&t(2,c=f.tabList),"topOffsetElement"in f&&t(5,u=f.topOffsetElement),"$$scope"in f&&t(6,r=f.$$scope)},[o,a,c,i,l,u,r,s,h]}class Xo extends ae{constructor(e){super(),oe(this,e,Jo,Yo,le,{sidebarWidth:0,layoutHeight:1,tabList:2,topOffsetElement:5})}get layoutHeight(){return this.$$.ctx[1]}}function xi(n,e,t){const i=n.slice();return i[9]=e[t],i}function Qo(n){let e,t=n[1].regions,i=[];for(let s=0;s<t.length;s+=1)i[s]=Ji(xi(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=pe()},m(s,r){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,r);C(s,e,r)},p(s,r){if(r&6){t=s[1].regions;let l;for(l=0;l<t.length;l+=1){const o=xi(s,t,l);i[l]?i[l].p(o,r):(i[l]=Ji(o),i[l].c(),i[l].m(e.parentNode,e))}for(;l<i.length;l+=1)i[l].d(1);i.length=t.length}},d(s){et(i,s),s&&E(e)}}}function Zo(n){let e,t=N==="en"?"Back to all witness view":"Retour à la vue complète du témoin",i,s,r,l=N==="en"?`Delete displayed ${n[0]}`:`Supprimer les ${n[0]} affichés`,o,a,c;return{c(){e=b("a"),i=J(t),s=D(),r=b("button"),o=J(l),m(e,"href",n[4]),m(e,"class","tag is-dark mr-3 mb-3 is-rounded"),m(r,"class","tag ml-3 mb-3 is-danger")},m(u,h){C(u,e,h),_(e,i),C(u,s,h),C(u,r,h),_(r,o),a||(c=ne(r,"click",n[5]),a=!0)},p(u,h){h&1&&l!==(l=N==="en"?`Delete displayed ${u[0]}`:`Supprimer les ${u[0]} affichés`)&&fe(o,l)},d(u){u&&E(e),u&&E(s),u&&E(r),a=!1,c()}}}function Ji(n){let e,t,i=n[9]+"",s;return{c(){e=b("a"),t=J("Regions extraction #"),s=J(i),m(e,"href",""+(n[2]+n[9])),m(e,"class","tag is-dark mr-3 mb-3 is-rounded")},m(r,l){C(r,e,l),_(e,t),_(e,s)},p:j,d(r){r&&E(e)}}}function ea(n){let e;function t(r,l){return r[3]?Zo:Qo}let s=t(n)(n);return{c(){e=b("div"),s.c()},m(r,l){C(r,e,l),s.m(e,null)},p(r,[l]){s.p(r,l)},i:j,o:j,d(r){r&&E(e),s.d()}}}function ta(n,e,t){let i,s;ue(n,St,f=>t(6,s=f));const r=Je("witness"),l=`${window.location.origin}${window.location.pathname}`,o=parseInt(l.split("regions/")[1].replace("/","")),a=l.replace(/\/\d+\/?$/,"");async function c(){if(!await Re(N==="en"?"Are you sure you want to delete all the region extraction of this witness?":"Voulez-vous vraiment supprimer les extractions de régions effectuées sur ce document ?",N==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof o!="number")throw new Error("Invalid region ID");const d=`${window.location.origin}/${Ve}/regions/${o}/delete`;try{const p=await Ut(()=>fetch(d,{method:"DELETE",headers:{"X-CSRFToken":Xe}}));if(p.status!==204)throw new Error(`Failed to delete regions: '${p.statusText}'`);window.location.href=`${l.split("regions/")[0]}regions/`}catch(p){console.error(p)}}async function u(){if(!await Re(N==="en"?"Are you sure you want to delete all similarity scores for this document?":"Voulez-vous vraiment supprimer l'intégralité des scores de similarité pour ce document ?",N==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof o!="number")throw new Error("Invalid region ID");const d=`${window.location.origin}/${Ve}/similarity/reset/${o}`;try{const p=await Ut(()=>fetch(d,{method:"DELETE",headers:{"X-CSRFToken":Xe}}));if(p.status===204||p.status===200)window.location.href=`${l.split("regions/")[0]}regions/`;else throw new Error(`Failed to delete similarity: '${p.statusText}'`)}catch(p){console.error(p),await Re(p.message,"Error")}}function h(){["all","page"].includes(s)?c():s==="similarity"&&u()}return n.$$.update=()=>{n.$$.dirty&64&&t(0,i=["all","page"].includes(s)?N==="en"?"regions":"régions":N==="en"?"similarities":"similarités")},[i,r,l,o,a,h,s]}class na extends ae{constructor(e){super(),oe(this,e,ta,ea,le,{})}}function Xi(n,e,t){const i=n.slice();return i[7]=e[t],i[9]=t,i}function Qi(n,e,t){const i=n.slice();return i[10]=e[t][0],i[11]=e[t][1],i}function Zi(n,e,t){const i=n.slice();return i[10]=e[t][0],i[11]=e[t][1],i}function es(n){let e,t;return{c(){e=b("a"),t=b("span"),m(t,"class","iconify"),m(t,"data-icon","entypo:edit"),m(e,"href",n[2]),m(e,"title","Edit"),m(e,"class","edit-btn button is-small is-rounded is-link px-3 ml-2 mt-1")},m(i,s){C(i,e,s),_(e,t)},p(i,s){s&4&&m(e,"href",i[2])},d(i){i&&E(e)}}}function ts(n){let e,t=n[11].label+"",i,s,r,l=n[11].value+"",o;return{c(){e=b("span"),i=J(t),s=D(),r=b("span"),o=J(l),m(e,"class","witness-key svelte-1g4d9r7"),m(r,"class","witness-value svelte-1g4d9r7")},m(a,c){C(a,e,c),_(e,i),C(a,s,c),C(a,r,c),_(r,o)},p(a,c){c&2&&t!==(t=a[11].label+"")&&fe(i,t),c&2&&l!==(l=a[11].value+"")&&fe(o,l)},d(a){a&&E(e),a&&E(s),a&&E(r)}}}function ns(n){let e,t,i,s=n[1].metadata_full.contents,r=[];for(let l=0;l<s.length;l+=1)r[l]=ls(Xi(n,s,l));return{c(){e=b("h3"),e.textContent="Contents",t=D();for(let l=0;l<r.length;l+=1)r[l].c();i=pe(),m(e,"class","title is-5 mb-3")},m(l,o){C(l,e,o),C(l,t,o);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,o);C(l,i,o)},p(l,o){if(o&26){s=l[1].metadata_full.contents;let a;for(a=0;a<s.length;a+=1){const c=Xi(l,s,a);r[a]?r[a].p(c,o):(r[a]=ls(c),r[a].c(),r[a].m(i.parentNode,i))}for(;a<r.length;a+=1)r[a].d(1);r.length=s.length}},d(l){l&&E(e),l&&E(t),et(r,l),l&&E(i)}}}function is(n){let e;return{c(){e=b("i"),m(e,"class","fa-solid fa-chevron-down")},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function ss(n){let e,t=Object.entries(n[7].content),i=[];for(let s=0;s<t.length;s+=1)i[s]=rs(Qi(n,t,s));return{c(){e=b("div");for(let s=0;s<i.length;s+=1)i[s].c();m(e,"class","mt-2 pl-3")},m(s,r){C(s,e,r);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null)},p(s,r){if(r&2){t=Object.entries(s[7].content);let l;for(l=0;l<t.length;l+=1){const o=Qi(s,t,l);i[l]?i[l].p(o,r):(i[l]=rs(o),i[l].c(),i[l].m(e,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=t.length}},d(s){s&&E(e),et(i,s)}}}function rs(n){let e,t,i=n[10]+"",s,r,l,o=n[11]+"",a,c;return{c(){e=b("div"),t=b("b"),s=J(i),r=J(":"),l=D(),a=J(o),c=D(),m(e,"class","witness-value svelte-1g4d9r7")},m(u,h){C(u,e,h),_(e,t),_(t,s),_(t,r),_(e,l),_(e,a),_(e,c)},p(u,h){h&2&&i!==(i=u[10]+"")&&fe(s,i),h&2&&o!==(o=u[11]+"")&&fe(a,o)},d(u){u&&E(e)}}}function ls(n){let e,t,i=n[7].title+"",s,r,l=Object.entries(n[7].content).length,o,a=n[3].has(n[9]),c,u,h,f=l&&is();function d(){return n[5](n[9])}let p=a&&ss(n);return{c(){e=b("div"),t=b("div"),s=J(i),r=D(),f&&f.c(),o=D(),p&&p.c(),c=D(),m(t,"class","is-flex is-justify-content-space-between witness-key svelte-1g4d9r7"),m(e,"class","mb-3")},m(g,v){C(g,e,v),_(e,t),_(t,s),_(t,r),f&&f.m(t,null),_(e,o),p&&p.m(e,null),_(e,c),u||(h=[ne(t,"click",d),ne(t,"keypress",null)],u=!0)},p(g,v){n=g,v&2&&i!==(i=n[7].title+"")&&fe(s,i),v&2&&(l=Object.entries(n[7].content).length),l?f||(f=is(),f.c(),f.m(t,null)):f&&(f.d(1),f=null),v&8&&(a=n[3].has(n[9])),a?p?p.p(n,v):(p=ss(n),p.c(),p.m(e,c)):p&&(p.d(1),p=null)},d(g){g&&E(e),f&&f.d(),p&&p.d(),u=!1,Ie(h)}}}function ia(n){var w;let e,t,i,s,r,l,o,a,c,u,h,f,d=n[1].can_edit&&es(n);c=new na({});let p=Object.entries(n[1].metadata_full.wit),g=[];for(let S=0;S<p.length;S+=1)g[S]=ts(Zi(n,p,S));let v=((w=n[1].metadata_full.contents)==null?void 0:w.length)&&ns(n);return{c(){e=b("div"),t=b("div"),i=b("div"),s=b("h1"),r=J(n[0]),l=D(),d&&d.c(),o=D(),a=b("div"),x(c.$$.fragment),u=D();for(let S=0;S<g.length;S+=1)g[S].c();h=D(),v&&v.c(),m(s,"class","title"),m(a,"class","cell is-left is-middle"),m(i,"class","pb-2"),m(t,"class","content is-small mt-4"),m(e,"class","m-4 py-5 px-4")},m(S,P){C(S,e,P),_(e,t),_(t,i),_(i,s),_(s,r),_(s,l),d&&d.m(s,null),_(i,o),_(i,a),W(c,a,null),_(i,u);for(let T=0;T<g.length;T+=1)g[T]&&g[T].m(i,null);_(i,h),v&&v.m(i,null),f=!0},p(S,[P]){var T;if((!f||P&1)&&fe(r,S[0]),S[1].can_edit?d?d.p(S,P):(d=es(S),d.c(),d.m(s,null)):d&&(d.d(1),d=null),P&2){p=Object.entries(S[1].metadata_full.wit);let I;for(I=0;I<p.length;I+=1){const L=Zi(S,p,I);g[I]?g[I].p(L,P):(g[I]=ts(L),g[I].c(),g[I].m(i,h))}for(;I<g.length;I+=1)g[I].d(1);g.length=p.length}(T=S[1].metadata_full.contents)!=null&&T.length?v?v.p(S,P):(v=ns(S),v.c(),v.m(i,null)):v&&(v.d(1),v=null)},i(S){f||(M(c.$$.fragment,S),f=!0)},o(S){R(c.$$.fragment,S),f=!1},d(S){S&&E(e),d&&d.d(),G(c),et(g,S),v&&v.d()}}}function sa(n,e,t){let{viewTitle:i=""}=e,{witness:s={}}=e,{editUrl:r=""}=e,l={},o=new Set;rt(async()=>{const u=`${window.location.origin}/${Ve}/witness/select`;try{l=await(await fetch(u)).json()}catch(h){return console.error("Error:",h),!1}});function a(u){o.has(u)?o.delete(u):o.add(u),t(3,o=new Set(o))}const c=u=>a(u);return n.$$set=u=>{"viewTitle"in u&&t(0,i=u.viewTitle),"witness"in u&&t(1,s=u.witness),"editUrl"in u&&t(2,r=u.editUrl)},[i,s,r,o,a,c]}class ra extends ae{constructor(e){super(),oe(this,e,sa,ia,le,{viewTitle:0,witness:1,editUrl:2})}}function la(n){let e,t,i,s,r,l=N==="en"?"Selection":"Sélection",o,a,c,u,h,f;return{c(){e=b("div"),t=b("button"),i=b("span"),s=b("i"),r=D(),o=J(l),a=J(`
            (`),c=J(n[0]),u=J(")"),m(s,"class","fa-solid fa-book-bookmark"),m(i,"id","btn-content"),m(t,"id","set-btn"),m(t,"class","button px-5 py-4 is-link svelte-gmt9z5"),m(t,"data-target","selection-modal"),m(e,"class","set-container svelte-gmt9z5")},m(d,p){C(d,e,p),_(e,t),_(t,i),_(i,s),_(i,r),_(i,o),_(i,a),_(i,c),_(i,u),h||(f=Mn(tl.call(null,t)),h=!0)},p(d,[p]){p&1&&fe(c,d[0])},i:j,o:j,d(d){d&&E(e),h=!1,f()}}}function oa(n,e,t){let{selectionLength:i=0}=e,s=i;return n.$$set=r=>{"selectionLength"in r&&t(0,i=r.selectionLength)},n.$$.update=()=>{if(n.$$.dirty&3&&i!==s){const r=i>s;t(1,s=i);const l=document.getElementById("btn-content");l&&l.animate([{transform:r?"translateY(-7px)":"translateX(-5px)"},{transform:r?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[i,s]}class aa extends ae{constructor(e){super(),oe(this,e,oa,la,le,{selectionLength:0})}}const ca=n=>({}),os=n=>({});function ua(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v,w,S,P,T,I;const L=n[1].content,A=He(L,n,n[0],os);return{c(){e=b("button"),t=D(),i=b("div"),s=b("div"),r=D(),l=b("div"),o=b("div"),o.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,a=D(),c=b("section"),u=b("div"),h=D(),f=b("div"),A&&A.c(),d=D(),p=b("footer"),g=b("div"),v=b("button"),v.textContent=`${N==="en"?"Abort":"Retour"}`,w=D(),S=b("button"),S.textContent="OK",m(e,"id","hidden-msg-btn"),m(e,"data-target","msg-modal"),e.hidden=!0,m(s,"id","modal-bkg"),m(s,"class","modal-background"),m(o,"class","modal-card-head media mb-0"),m(u,"id","modal-msg"),m(f,"class","py-3"),m(c,"id","modal-body"),m(c,"class","modal-card-body"),m(v,"id","cancel-btn"),m(v,"class","button is-link is-light button-close"),m(S,"id","ok-btn"),m(S,"class","button is-link button-close"),m(g,"class","buttons"),m(p,"id","modal-footer"),m(p,"class","modal-card-foot is-center pt-3"),p.hidden=!0,m(l,"class","modal-content"),m(i,"id","msg-modal"),m(i,"class","modal fade"),m(i,"tabindex","-1"),m(i,"aria-labelledby","selection-modal-label"),m(i,"aria-hidden","true")},m(y,F){C(y,e,F),C(y,t,F),C(y,i,F),_(i,s),_(i,r),_(i,l),_(l,o),_(l,a),_(l,c),_(c,u),_(c,h),_(c,f),A&&A.m(f,null),_(l,d),_(l,p),_(p,g),_(g,v),_(g,w),_(g,S),P=!0,T||(I=[Mn(tl.call(null,e)),Mn(el.call(null,i))],T=!0)},p(y,[F]){A&&A.p&&(!P||F&1)&&Be(A,L,y,y[0],P?qe(L,y[0],F,ca):ze(y[0]),os)},i(y){P||(M(A,y),P=!0)},o(y){R(A,y),P=!1},d(y){y&&E(e),y&&E(t),y&&E(i),A&&A.d(y),T=!1,Ie(I)}}}function fa(n,e,t){let{$$slots:i={},$$scope:s}=e;return n.$$set=r=>{"$$scope"in r&&t(0,s=r.$$scope)},[s,i]}class da extends ae{constructor(e){super(),oe(this,e,fa,ua,le,{})}}function ha(n){let e,t,i;return{c(){e=b("button"),e.textContent=`${N==="en"?"Automatic region extraction":"Extraction automatique des régions"}`,m(e,"class","button is-link is-light")},m(s,r){C(s,e,r),t||(i=ne(e,"click",n[1]),t=!0)},p:j,d(s){s&&E(e),t=!1,i()}}}function ma(n){let e,t,i,s=Ft.includes("regions"),r,l,o=s&&ha(n);return{c(){e=b("div"),t=b("button"),t.textContent=`${N==="en"?"Manually annotate":"Annoter manuellement"}`,i=D(),o&&o.c(),m(t,"class","button is-link"),m(e,"class","is-center buttons is-centered pt-5")},m(a,c){C(a,e,c),_(e,t),_(e,i),o&&o.m(e,null),r||(l=ne(t,"click",n[0]),r=!0)},p(a,[c]){s&&o.p(a,c)},i:j,o:j,d(a){a&&E(e),o&&o.d(),r=!1,l()}}}function pa(n,e,t){const i=Je("witness");let{currentRegionId:s}=e,{baseUrl:r}=e;async function l(){const a=`${window.location.origin}/${Ve}`;let c=`${a}/witness/${i.id}/regions/add`;if(i.regions.length===1||s){const f=s||i.regions[0];c=`${a}/witness/${i.id}/regions/${f}/add`}const u=await Ut(()=>fetch(c,{method:"POST",headers:{"X-CSRFToken":Xe}}));if(!u.ok)throw await Re(`Failed to create regions: '${u.statusText}'`,"Error"),new Error(`Failed to create regions: '${u.statusText}'`);let h;try{h=await u.json()}catch(f){throw await Re(`Failed to parse JSON response: '${f}'`,"Error"),new Error(`Failed to parse JSON response: '${f}'`)}h.hasOwnProperty("mirador_url")&&window.open(h.mirador_url),h.hasOwnProperty("regions_id")&&(window.location.href=`${r.split("regions/")[0]}regions/${h.regions_id}`)}async function o(){const a=`${window.location.origin}/${Ve}/witness/${i.id}/regions/extract`,c=await Ut(()=>fetch(a,{method:"POST",headers:{"X-CSRFToken":Xe}}));let u;if(c.ok)try{u=await c.json(),console.log(u)}catch(h){throw await Re(`Failed to parse JSON response: '${h}'`,"Error"),new Error(`Failed to parse JSON response: '${h}'`)}finally{const h=u.doc_set_id;if(!h)throw await Re("Failed to launch regions extraction: 'No document set id'","Error"),new Error("Failed to launch regions extraction: 'No document set id'");window.location.href=`${window.location.origin}/${Ve}/treatment/add/?document_set=${h}&task_type=regions`}else throw await Re(`Failed to launch regions extraction: '${u.message}'`,"Error"),new Error(`Failed to launch regions extraction: '${u.message}'`)}return n.$$set=a=>{"currentRegionId"in a&&t(2,s=a.currentRegionId),"baseUrl"in a&&t(3,r=a.baseUrl)},[l,o,s,r]}class il extends ae{constructor(e){super(),oe(this,e,pa,ma,le,{currentRegionId:2,baseUrl:3})}}function ga(n){let e;return{c(){e=Ue("path"),m(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),m(e,"class","svelte-h0t5l9")},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function _a(n){let e;return{c(){e=Ue("path"),m(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),m(e,"class","svelte-h0t5l9")},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function va(n){let e=N==="en"?"Edit":"Modifier",t;return{c(){t=J(e)},m(i,s){C(i,t,s)},p:j,d(i){i&&E(t)}}}function ba(n){let e=N==="en"?"Validate":"Valider",t;return{c(){t=J(e)},m(i,s){C(i,t,s)},p:j,d(i){i&&E(t)}}}function as(n){let e,t,i,s=N==="en"?"Reload":"Recharger",r,l,o,a,c,u=N==="en"?"Go to editor":"Aller à l'éditeur",h,f,d,p,g,v=N==="en"?"Delete selected regions":"Supprimer les régions sélectionnées",w,S,P;return{c(){e=b("button"),t=b("i"),i=D(),r=J(s),l=D(),o=b("a"),a=b("i"),c=D(),h=J(u),f=D(),d=b("button"),p=b("i"),g=D(),w=J(v),m(t,"class","fa-solid fa-rotate-right"),m(e,"class","tag is-link is-light is-rounded mr-3"),m(a,"class","fa-solid fa-edit"),m(o,"class","tag is-link is-rounded mr-3"),m(o,"href",Ht(n[4])),m(o,"target","_blank"),m(p,"class","fa-solid fa-trash"),m(d,"class","tag is-danger is-rounded")},m(T,I){C(T,e,I),_(e,t),_(e,i),_(e,r),C(T,l,I),C(T,o,I),_(o,a),_(o,c),_(o,h),C(T,f,I),C(T,d,I),_(d,p),_(d,g),_(d,w),S||(P=[ne(e,"click",n[14]),ne(d,"click",n[6])],S=!0)},p:j,d(T){T&&E(e),T&&E(l),T&&E(o),T&&E(f),T&&E(d),S=!1,Ie(P)}}}function wa(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g=N==="en"?"Download":"Télécharger",v,w,S,P,T;function I(U,Y){return U[0]?_a:ga}let L=I(n),A=L(n);function y(U,Y){return U[0]?ba:va}let F=y(n),K=F(n),re=n[0]&&as(n);return{c(){e=b("div"),t=b("button"),i=Ue("svg"),A.c(),s=D(),K.c(),l=D(),o=b("button"),a=b("i"),c=D(),u=b("span"),u.textContent=`${N==="en"?"Select all":"Tout sélectionner"}`,h=D(),f=b("button"),d=b("i"),p=D(),v=J(g),w=D(),S=b("div"),re&&re.c(),m(i,"xmlns","http://www.w3.org/2000/svg"),m(i,"viewBox","0 0 384 512"),m(i,"class","pr-3 svelte-h0t5l9"),m(t,"class",r="button "+(n[0]?"is-success":"is-link")+" mr-3"),m(a,"class","fa-solid fa-square-check"),m(u,"id","all-selection"),m(o,"class","button is-link is-light mr-3"),m(d,"class","fa-solid fa-download"),m(f,"class","button is-link is-light"),m(e,"class","is-right mb-3"),m(S,"class","edit-action is-right svelte-h0t5l9")},m(U,Y){C(U,e,Y),_(e,t),_(t,i),A.m(i,null),_(t,s),K.m(t,null),_(e,l),_(e,o),_(o,a),_(o,c),_(o,u),_(e,h),_(e,f),_(f,d),_(f,p),_(f,v),C(U,w,Y),C(U,S,Y),re&&re.m(S,null),P||(T=[ne(t,"click",n[13]),ne(o,"click",n[7]),ne(f,"click",n[8])],P=!0)},p(U,[Y]){L!==(L=I(U))&&(A.d(1),A=L(U),A&&(A.c(),A.m(i,null))),F===(F=y(U))&&K?K.p(U,Y):(K.d(1),K=F(U),K&&(K.c(),K.m(t,null))),Y&1&&r!==(r="button "+(U[0]?"is-success":"is-link")+" mr-3")&&m(t,"class",r),U[0]?re?re.p(U,Y):(re=as(U),re.c(),re.m(S,null)):re&&(re.d(1),re=null)},i:j,o:j,d(U){U&&E(e),A.d(),K.d(),U&&E(w),U&&E(S),re&&re.d(),P=!1,Ie(T)}}}async function ya(n){const e=n.id_full,t=`${SAS_APP_URL}/annotation/destroy?uri=${e}`,i=await fetch(t,{method:"DELETE"});if(i.status!==204)throw new Error(`Failed to delete ${t} due to ${i.status}: '${i.statusText}'`)}function ka(n,e,t){let i,s,r,l,o,a,c;const{selected:u,nbSelected:h}=gt;ue(n,u,I=>t(11,a=I)),ue(n,h,I=>t(12,c=I));const{allRegions:f}=bt;ue(n,f,I=>t(10,o=I));const d=Je("manifest"),p=Je("isValidated");function g(){t(0,s=!s)}async function v(){if(await Re(N==="en"?"Are you sure you want to delete these regions?":"Voulez-vous vraiment supprimer ces régions ?",N==="en"?"Confirm deletion":"Confirmer la suppression",!0))for(const[L,A]of Object.entries(r))try{if(!o.hasOwnProperty(L))continue;await ya(A),bt.remove(L),gt.remove(L,un)}catch(y){await Re(`Failed to delete region ${L}: ${y.message}`,"Error")}}function w(){l?gt.removeAll(Object.keys(o),un):gt.addAll(Object.values(o))}async function S(){const I=Object.values(r).map(y=>y.ref),A=await(await Ut(()=>fetch(`${window.location.origin}/${Ve}/regions/export`,{method:"POST",headers:{"X-CSRFToken":Xe},body:JSON.stringify({regionsRef:I})}))).blob();Qr(A,"regions.zip")}const P=()=>g(),T=()=>location.reload();return n.$$.update=()=>{n.$$.dirty&4096&&t(9,i=c),n.$$.dirty&2048&&(r=Object.values(a)[0]||{}),n.$$.dirty&1536&&(l=i>=Object.keys(o).length)},t(0,s=!p),[s,u,h,f,d,g,v,w,S,i,o,a,c,P,T]}class Sa extends ae{constructor(e){super(),oe(this,e,ka,wa,le,{})}}function Ea(){const n=`${window.location.origin}${window.location.pathname}`,e=25,t=window.location.pathname.match(/\d+/g).join("-"),i={[t]:{}},s=[2,6],r=Ee(1),l=Ee({}),o=Ee(JSON.parse(localStorage.getItem("selectedRegions"))||i);o.subscribe(U=>localStorage.setItem("selectedRegions",JSON.stringify(U)));const a=Ee(JSON.parse(localStorage.getItem("excludedCategories"))||[]);a.subscribe(U=>localStorage.setItem("excludedCategories",JSON.stringify(U)));const c=Ee(JSON.parse(localStorage.getItem("similarityScoreCutoff"))||void 0);c.subscribe(U=>{U!=null&&localStorage.setItem("similarityScoreCutoff",JSON.stringify(U))});const u=Ee(JSON.parse(localStorage.getItem("propagateRecursionDepth"))||s[1]);u.subscribe(U=>localStorage.setItem("propagateRecursionDepth",JSON.stringify(U)));const h=Ee(JSON.parse(localStorage.getItem("propagateFilterByRegions"))||!1);h.subscribe(U=>localStorage.setItem("propagateFilterByRegions",JSON.stringify(U)));const f=Ye([u,h],([U,Y])=>({propagateRecursionDepth:U,propagateFilterByRegions:Y})),d=Ye([a,o,c],([U,Y,Z])=>({excludedCategories:U,regions:Y,similarityScoreCutoff:Z})),p=Ye([f,d],([U,Y])=>({propagate:U,similarity:Y})),g=Ee([]),v=Ee([]);async function w(){const U=async()=>{const V=await(await fetch(`${n}compared-regions`)).json();l.set(V),o.update(H=>{let se=H[t]||{};if(Object.keys(se).length){let z=Object.keys(se).filter(q=>Object.keys(V).includes(q)).reduce((q,te)=>(q[te]=se[te],q),{});H[t]=z}return H})},Y=async()=>{const V=await(await fetch(`${n}query-images`)).json();V.length>0&&(g.set(V),K(A()))};Ot.set(!0);try{await Promise.all([U(),Y()])}catch(Z){console.error("Error:",Z),Yr.set(Z.message)}finally{Ot.set(!1)}}function S(U){localStorage.setItem("selectedRegions",JSON.stringify(U))}function P(U){o.update(Y=>{const Z={...Y};return delete Z[t][U],S(Z),Z})}function T(U){o.update(Y=>{const Z={...Y,[t]:{...Y[t]||{},[U.ref]:U}};return S(Z),Z})}const I=Ye(o,U=>Y=>{var Z;return(Z=U[t])==null?void 0:Z.hasOwnProperty(Y)});function L(U){const Y=gi(l),Z=Object.keys(Y).filter(V=>V.startsWith(U));return Z.length!==1?{title:"Error"}:Y[Z[0]]}const A=()=>bi(r,"sp"),y=Ye([r,g],([U,Y])=>(async()=>F(U,Y))());function F(U,Y){const Z=(U-1)*e,V=Z+e,H=Y.slice(Z,V);return v.set(H),H}function K(U){wi(U,r,"sp")}function re(U){l.update(Y=>({...Y,[U.ref]:U}))}return{currentPage:r,comparedRegions:l,excludedCategories:a,qImgs:g,pageQImgs:v,selectedRegions:o,propagateRecursionDepth:u,propagateFilterByRegions:h,similarityToolbarParams:p,propagateParams:f,similarityScoreCutoff:c,allowedPropagateDepthRange:s,fetchSimilarity:w,setPageQImgs:y,getRegionsInfo:L,handlePageUpdate:K,unselect:P,select:T,addComparedRegions:re,isSelected:I,pageLength:e}}const xe=Ea();function Ca(n){let e,t,i;const s=n[1].default,r=He(s,n,n[0],null);return{c(){e=b("table"),t=b("tbody"),r&&r.c(),m(e,"class","table is-fullwidth")},m(l,o){C(l,e,o),_(e,t),r&&r.m(t,null),i=!0},p(l,[o]){r&&r.p&&(!i||o&1)&&Be(r,s,l,l[0],i?qe(s,l[0],o,null):ze(l[0]),null)},i(l){i||(M(r,l),i=!0)},o(l){R(r,l),i=!1},d(l){l&&E(e),r&&r.d(l)}}}function Ia(n,e,t){let{$$slots:i={},$$scope:s}=e;return n.$$set=r=>{"$$scope"in r&&t(0,s=r.$$scope)},[s,i]}class Un extends ae{constructor(e){super(),oe(this,e,Ia,Ca,le,{})}}function cs(n){let e,t,i,s,r,l,o,a,c,u=n[5]>1&&us(n),h=n[5]<n[3]&&hs(n);return{c(){e=b("nav"),t=b("ul"),u&&u.c(),i=D(),s=b("li"),r=b("a"),l=J(n[5]),o=D(),h&&h.c(),m(r,"class","pagination-link is-current"),m(r,"href",null),m(t,"class","pagination-list ml-0"),m(e,"class","pagination is-centered mb-2"),m(e,"aria-label","pagination")},m(f,d){C(f,e,d),_(e,t),u&&u.m(t,null),_(t,i),_(t,s),_(s,r),_(r,l),_(t,o),h&&h.m(t,null),a||(c=ne(r,"click",wt(n[9])),a=!0)},p(f,d){f[5]>1?u?u.p(f,d):(u=us(f),u.c(),u.m(t,i)):u&&(u.d(1),u=null),d&32&&fe(l,f[5]),f[5]<f[3]?h?h.p(f,d):(h=hs(f),h.c(),h.m(t,null)):h&&(h.d(1),h=null)},d(f){f&&E(e),u&&u.d(),h&&h.d(),a=!1,c()}}}function us(n){let e,t,i,s,r,l,o=n[5]-1>1&&fs(n);return{c(){e=b("li"),t=b("a"),t.textContent="1",i=D(),o&&o.c(),s=pe(),m(t,"class","pagination-link"),m(t,"href",null)},m(a,c){C(a,e,c),_(e,t),C(a,i,c),o&&o.m(a,c),C(a,s,c),r||(l=ne(t,"click",wt(n[7])),r=!0)},p(a,c){a[5]-1>1?o?o.p(a,c):(o=fs(a),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},d(a){a&&E(e),a&&E(i),o&&o.d(a),a&&E(s),r=!1,l()}}}function fs(n){let e,t,i,s=n[5]-1+"",r,l,o,a=n[5]-1>2&&ds();return{c(){a&&a.c(),e=D(),t=b("li"),i=b("a"),r=J(s),m(i,"class","pagination-link"),m(i,"href",null)},m(c,u){a&&a.m(c,u),C(c,e,u),C(c,t,u),_(t,i),_(i,r),l||(o=ne(i,"click",wt(n[8])),l=!0)},p(c,u){c[5]-1>2?a||(a=ds(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),u&32&&s!==(s=c[5]-1+"")&&fe(r,s)},d(c){a&&a.d(c),c&&E(e),c&&E(t),l=!1,o()}}}function ds(n){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function hs(n){let e,t,i,s,r,l,o=n[5]+1<n[3]&&ms(n);return{c(){o&&o.c(),e=D(),t=b("li"),i=b("a"),s=J(n[3]),m(i,"class","pagination-link"),m(i,"href",null)},m(a,c){o&&o.m(a,c),C(a,e,c),C(a,t,c),_(t,i),_(i,s),r||(l=ne(i,"click",wt(n[11])),r=!0)},p(a,c){a[5]+1<a[3]?o?o.p(a,c):(o=ms(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),c&8&&fe(s,a[3])},d(a){o&&o.d(a),a&&E(e),a&&E(t),r=!1,l()}}}function ms(n){let e,t,i=n[5]+1+"",s,r,l,o,a,c=n[5]+2<n[3]&&ps();return{c(){e=b("li"),t=b("a"),s=J(i),r=D(),c&&c.c(),l=pe(),m(t,"class","pagination-link"),m(t,"href",null)},m(u,h){C(u,e,h),_(e,t),_(t,s),C(u,r,h),c&&c.m(u,h),C(u,l,h),o||(a=ne(t,"click",wt(n[10])),o=!0)},p(u,h){h&32&&i!==(i=u[5]+1+"")&&fe(s,i),u[5]+2<u[3]?c||(c=ps(),c.c(),c.m(l.parentNode,l)):c&&(c.d(1),c=null)},d(u){u&&E(e),u&&E(r),c&&c.d(u),u&&E(l),o=!1,a()}}}function ps(n){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function Oa(n){let e,t,i=n[5]*n[2]-n[2]+1+"",s,r,l=Math.min(n[5]*n[2],n[1])+"",o,a,c,u,h=n[4]&&cs(n);return{c(){h&&h.c(),e=D(),t=b("div"),s=J(i),r=J(" - "),o=J(l),a=J(" / "),c=J(n[1]),m(t,"class",u="is-size-7 is-center mb-4 "+(n[4]?"":"mt-4"))},m(f,d){h&&h.m(f,d),C(f,e,d),C(f,t,d),_(t,s),_(t,r),_(t,o),_(t,a),_(t,c)},p(f,[d]){f[4]?h?h.p(f,d):(h=cs(f),h.c(),h.m(e.parentNode,e)):h&&(h.d(1),h=null),d&36&&i!==(i=f[5]*f[2]-f[2]+1+"")&&fe(s,i),d&38&&l!==(l=Math.min(f[5]*f[2],f[1])+"")&&fe(o,l),d&2&&fe(c,f[1]),d&16&&u!==(u="is-size-7 is-center mb-4 "+(f[4]?"":"mt-4"))&&m(t,"class",u)},i:j,o:j,d(f){h&&h.d(f),f&&E(e),f&&E(t)}}}function Aa(n,e,t){let i,s,r,{store:l}=e;const{currentPage:o}=l;ue(n,o,g=>t(5,r=g));let{nbOfItems:a}=e,{pageLength:c=Lo}=e;const u=()=>l.handlePageUpdate(1),h=()=>l.handlePageUpdate(r-1),f=()=>l.handlePageUpdate(r),d=()=>l.handlePageUpdate(r+1),p=()=>l.handlePageUpdate(i);return n.$$set=g=>{"store"in g&&t(0,l=g.store),"nbOfItems"in g&&t(1,a=g.nbOfItems),"pageLength"in g&&t(2,c=g.pageLength)},n.$$.update=()=>{n.$$.dirty&6&&t(3,i=c>0?Math.ceil(a/c):1),n.$$.dirty&14&&t(4,s=i>1||a>c)},[l,a,c,i,s,r,o,u,h,f,d,p]}class qt extends ae{constructor(e){super(),oe(this,e,Aa,Oa,le,{store:0,nbOfItems:1,pageLength:2})}}const Si=(n,e,t,i)=>({id:n,img:n,title:`Canvas ${i} - ${t} - ${N==="en"?"Witness":"Témoin"} #${xr(e)}`,xywh:t.split(",").map(Number),canvas:i,ref:n.replace(".jpg",""),type:un}),Ta=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,sl=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">
        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>
    </svg>`,rl=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">
        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,ll=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">
        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,ol=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,al=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>
    </svg>`,Ma=N==="en"?"no categorization":"aucune catégorisation",cl=N==="en"?"overall visual matches":"correspondances visuelles globales",ul=N==="en"?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",fl=N==="en"?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",dl=N==="en"?"regions without match":"régions sans correspondance",hl=N==="en"?"user specific category":"correspondances spécifiques à l'utilisateur",En={0:{title:Ma,svg:Ta},1:{title:cl,svg:sl},2:{title:ul,svg:rl},3:{title:fl,svg:ll},4:{title:dl,svg:ol},5:{title:hl,svg:al}};function Pa(n){let e,t=En[n[2]].svg+"",i,s,r,l;return{c(){e=b("span"),m(e,"class",i="tag py-4 "+n[4]+" "+(n[0]?"is-hoverable":"")),m(e,"title",s=En[n[2]].title),Ce(e,"is-selected",n[1])},m(o,a){C(o,e,a),e.innerHTML=t,r||(l=[ne(e,"click",n[5]),ne(e,"keyup",null)],r=!0)},p(o,[a]){a&4&&t!==(t=En[o[2]].svg+"")&&(e.innerHTML=t),a&17&&i!==(i="tag py-4 "+o[4]+" "+(o[0]?"is-hoverable":""))&&m(e,"class",i),a&4&&s!==(s=En[o[2]].title)&&m(e,"title",s),a&19&&Ce(e,"is-selected",o[1])},i:j,o:j,d(o){o&&E(e),r=!1,Ie(l)}}}function La(n,e,t){let{selectable:i=!0}=e,{isSelected:s=!1}=e,{category:r}=e,{toggle:l=()=>{}}=e,{padding:o="px-2"}=e;const a=()=>l(r);return n.$$set=c=>{"selectable"in c&&t(0,i=c.selectable),"isSelected"in c&&t(1,s=c.isSelected),"category"in c&&t(2,r=c.category),"toggle"in c&&t(3,l=c.toggle),"padding"in c&&t(4,o=c.padding)},[i,s,r,l,o,a]}class nn extends ae{constructor(e){super(),oe(this,e,La,Pa,le,{selectable:0,isSelected:1,category:2,toggle:3,padding:4})}}const Ra=/^(?:(\d+)_)?wit(\d+)_([a-z]{3})(\d+)(?:_anno(\d+))?_(\d+)(?:_([\d,]+))?(?:\.jpg)?$/;function $a(n){if(!n)return null;const e=n.match(Ra);if(!e)return null;const[,t,i,s,r,l,o,a]=e;return{witnessId:parseInt(i,10),digitizationType:s,digitizationId:parseInt(r,10),regionId:t?parseInt(t,10):l?parseInt(l,10):null,canvasNb:parseInt(o,10),canvasDigits:o.length,coord:a?a.split(",").map(Number):null,imgRoot:`wit${i}_${s}${r}_${o}.jpg`}}class Dn{constructor(e){this.id=e.id,this.img=e.img??e.ref,this.title=e.title,this.xywh=Array.isArray(e.xywh)?e.xywh.map(Number):e.xywh,this.canvas=e.canvas,this.ref=e.ref,this.type=e.type??un,this._parsed=null}get parsed(){return this._parsed||(this._parsed=$a(this.img)||{}),this._parsed}get witnessId(){return this.parsed.witnessId}get digitType(){return this.parsed.digitizationType}get digitId(){return this.parsed.digitizationId}get regionId(){return this.parsed.regionId}get canvasNb(){return this.parsed.canvasNb}get canvasDigits(){return this.parsed.canvasDigits}get imgRoot(){return this.parsed.imgRoot}get coord(){return this.parsed.coord??this.xywh}canvasStr(e=this.canvasNb,t=this.canvasDigits){return String(e).padStart(t,"0")}get iiifRoot(){return this.imgRoot?`${ln()}/iiif/2/${this.imgRoot}`:null}url(e=null,t="full"){if(!this.iiifRoot)return"https://placehold.co/96x96/png?text=No+image";let i=e??this.coord??"full";return Array.isArray(i)&&(i=i.join(",")),`${this.iiifRoot}/${i}/${t}/0/default.jpg`}info(){return this.iiifRoot?`${this.iiifRoot}/info.json`:null}manifest(){let e=`wit${this.witnessId}_${this.digitType}${this.digitId}`;return this.regionId&&(e+=`_anno${this.regionId}`),`${ln()}/iiif/v2/${e}/manifest.json`}urlForCanvas(e=this.canvasNb,t=this.coord,i="full"){const s=this.imgRoot.replace(`_${this.canvasStr()}.jpg`,`_${this.canvasStr(e)}.jpg`),r=Array.isArray(t)?t.join(","):t;return`${ln()}/iiif/2/${s}/${r}/${i}/0/default.jpg`}infoUrlForCanvas(e=this.canvasNb){const t=this.imgRoot.replace(`_${this.canvasStr()}.jpg`,`_${this.canvasStr(e)}.jpg`);return`${ln()}/iiif/2/${t}/info.json`}urlForMirador(e=this.canvasNb){return`${Xr()}/index.html?iiif-content=${this.manifest()}&canvas=${e}`}}function Da(n){let e,t,i;return{c(){e=b("span"),t=J(n[0]),m(e,"id",n[3]),m(e,"class",i="tooltip "+n[2]+" "+(n[1]?"display":"")+" svelte-1vbe6c4")},m(s,r){C(s,e,r),_(e,t)},p(s,[r]){r&1&&fe(t,s[0]),r&6&&i!==(i="tooltip "+s[2]+" "+(s[1]?"display":"")+" svelte-1vbe6c4")&&m(e,"class",i)},i:j,o:j,d(s){s&&E(e)}}}function Na(n,e,t){let i,s,r,l,{tooltipText:o}=e,{targetHtmlId:a}=e;const c=`tooltip-generic-${window.crypto.randomUUID()}`,u=()=>t(1,l=!0),h=()=>t(1,l=!1),f=()=>t(1,l=!l);return rt(()=>{r=a?document.getElementById(a):document.getElementById(c).parentElement,a&&!r&&(console.error(`TooltipGeneric: element with ID ${a} not found, defaulting to the parent element`),r=document.getElementById(c).targetElement),r.addEventListener("mouseover",u),r.addEventListener("mouseout",h),r.addEventListener("click",f)}),hn(()=>{r.removeEventListener("mouseover",u),r.removeEventListener("mouseout",h),r.removeEventListener("click",f)}),n.$$set=d=>{"tooltipText"in d&&t(0,o=d.tooltipText),"targetHtmlId"in d&&t(4,a=d.targetHtmlId)},n.$$.update=()=>{n.$$.dirty&33&&t(2,i=s(o))},t(5,s=d=>t(2,i=d.length>100?"tooltip-wide":d.length>20?"tooltip-mid":"tooltip-thin")),r=void 0,t(1,l=!1),[o,l,i,c,a,s]}class pn extends ae{constructor(e){super(),oe(this,e,Na,Da,le,{tooltipText:0,targetHtmlId:4})}}function ja(n){let e,t,i,s,r,l,o,a,c,u,h;return a=new pn({props:{targetHtmlId:n[1],tooltipText:n[2]}}),{c(){e=b("div"),t=b("button"),i=Ue("svg"),s=Ue("path"),r=Ue("path"),l=Ue("path"),o=D(),x(a.$$.fragment),m(s,"d","M53.6443 14.25C47.7042 5.33 37.7293 0 26.9801 0C16.2206 0 6.24576 5.33 0.305653 14.25L0 14.71L0.305653 15.17C6.24576 24.09 16.2206 29.42 26.9801 29.42C37.7293 29.42 47.7042 24.09 53.6443 15.16L53.95 14.71L53.6443 14.25ZM3.25025 14.71C7.63146 8.69001 14.0606 4.65 21.2641 3.22C20.0619 3.83 18.9411 4.62 17.963 5.59C15.5176 8.02 14.1625 11.25 14.1625 14.67C14.1625 18.11 15.5176 21.34 17.963 23.76C19.0124 24.79 20.1943 25.61 21.4781 26.23C14.1829 24.85 7.6824 20.78 3.25025 14.71ZM27.1125 22.64C22.7008 22.64 19.1041 19.08 19.1041 14.7C19.1041 12.59 19.9396 10.6 21.4475 9.10001C22.9555 7.60001 24.9729 6.77 27.1125 6.77C29.2522 6.77 31.2594 7.60001 32.7775 9.10001C34.2855 10.6 35.121 12.59 35.121 14.7C35.121 16.82 34.2855 18.82 32.7775 20.32C31.2594 21.81 29.242 22.64 27.1125 22.64ZM32.9915 26.14C34.204 25.53 35.3146 24.74 36.3029 23.77C38.7482 21.34 40.0932 18.11 40.0932 14.68C40.0932 9.75 37.281 5.47001 33.1647 3.32001C40.1747 4.81001 46.4102 8.83001 50.6896 14.71C46.3797 20.64 40.0728 24.67 32.9915 26.14Z"),m(s,"class","svelte-109pj58"),m(r,"d","M26.9804 25.98C33.3222 25.98 38.4633 20.9343 38.4633 14.71C38.4633 8.48576 33.3222 3.44 26.9804 3.44C20.6386 3.44 15.4976 8.48576 15.4976 14.71C15.4976 20.9343 20.6386 25.98 26.9804 25.98Z"),m(r,"class","svelte-109pj58"),m(l,"d","M17.9529 23.85L36.2928 5.85001"),m(l,"stroke-width","3"),m(l,"stroke-miterlimit","10"),m(l,"class","svelte-109pj58"),m(i,"width","54"),m(i,"height","30"),m(i,"viewBox","0 0 54 30"),m(i,"fill","none"),m(i,"xmlns","http://www.w3.org/2000/svg"),m(i,"class","svelte-109pj58"),m(t,"class","button tag svelte-109pj58"),m(t,"title",n[2]),m(e,"id",n[1])},m(f,d){C(f,e,d),_(e,t),_(t,i),_(i,s),_(i,r),_(i,l),_(t,o),W(a,t,null),c=!0,u||(h=ne(t,"click",Wr(n[3])),u=!0)},p:j,i(f){c||(M(a.$$.fragment,f),c=!0)},o(f){R(a.$$.fragment,f),c=!1},d(f){f&&E(e),G(a),u=!1,h()}}}function Va(n){const e=Kt(),t=`modal-opener-${window.crypto.randomUUID()}`;return[e,t,N==="fr"?"Vue détaillée":"Detailed view",()=>e("open")]}class ml extends ae{constructor(e){super(),oe(this,e,Va,ja,le,{})}}const Fa=n=>({}),gs=n=>({});function _s(n){let e,t,i,s,r,l;function o(d,p){return d[10]?Ha:Ua}let a=o(n),c=a(n);function u(d,p){return d[10]?Ba:qa}let h=u(n),f=h(n);return{c(){e=b("button"),t=Ue("svg"),c.c(),i=D(),s=b("span"),f.c(),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 384 512"),m(t,"class","svelte-g5axbe"),m(s,"class","tooltip"),m(e,"class","button tag")},m(d,p){C(d,e,p),_(e,t),c.m(t,null),_(e,i),_(e,s),f.m(s,null),r||(l=ne(e,"click",Wr(n[21])),r=!0)},p(d,p){a!==(a=o(d))&&(c.d(1),c=a(d),c&&(c.c(),c.m(t,null))),h===(h=u(d))&&f?f.p(d,p):(f.d(1),f=h(d),f&&(f.c(),f.m(s,null)))},d(d){d&&E(e),c.d(),f.d(),r=!1,l()}}}function Ua(n){let e;return{c(){e=Ue("path"),m(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),m(e,"class","svelte-g5axbe")},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function Ha(n){let e;return{c(){e=Ue("path"),m(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),m(e,"class","svelte-g5axbe")},m(t,i){C(t,e,i)},d(t){t&&E(e)}}}function qa(n){let e=N==="en"?"Copy ID":"Copier l'ID",t;return{c(){t=J(e)},m(i,s){C(i,t,s)},p:j,d(i){i&&E(t)}}}function Ba(n){let e=N==="en"?"Copied!":"Copié !",t;return{c(){t=J(e)},m(i,s){C(i,t,s)},p:j,d(i){i&&E(t)}}}function vs(n){let e,t;return e=new ml({}),e.$on("open",n[14]),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function za(n){let e,t,i,s,r,l,o,a=n[8].title+"",c,u,h,f,d,p,g,v,w,S,P,T=n[4]&&_s(n),I=!n[5]&&vs(n);const L=n[19].actions,A=He(L,n,n[18],gs);return{c(){e=b("div"),t=b("figure"),i=b("img"),r=D(),l=b("div"),o=b("span"),h=D(),f=b("div"),T&&T.c(),d=D(),I&&I.c(),p=D(),A&&A.c(),m(i,"class","region-img svelte-g5axbe"),$e(i.src,s=n[9])||m(i,"src",s),m(i,"alt","Extracted region"),m(o,"class","overlay-desc"),m(l,"class","overlay is-center svelte-g5axbe"),m(t,"class",c="image card region-image "+(n[0]?"is-96x96":"")+" svelte-g5axbe"),m(t,"tabindex","-1"),m(t,"style",u=(n[7]==="full"?"height: 100%":`height: ${n[7]}px; min-width: ${n[7]}px`)+"; "+(n[3]?`border: 5px solid ${n[3]};`:"")),m(f,"class","region-btn ml-1"),m(e,"class",g="region is-center "+(n[6]&&n[11](n[2])?"checked":"")+" svelte-g5axbe"),m(e,"style",v=n[7]==="full"?"height: 100%":"")},m(y,F){C(y,e,F),_(e,t),_(t,i),_(t,r),_(t,l),_(l,o),o.innerHTML=a,_(e,h),_(e,f),T&&T.m(f,null),_(f,d),I&&I.m(f,null),_(f,p),A&&A.m(f,null),w=!0,S||(P=[ne(t,"click",n[20]),ne(t,"keyup",null)],S=!0)},p(y,[F]){(!w||F&512&&!$e(i.src,s=y[9]))&&m(i,"src",s),(!w||F&256)&&a!==(a=y[8].title+"")&&(o.innerHTML=a),(!w||F&1&&c!==(c="image card region-image "+(y[0]?"is-96x96":"")+" svelte-g5axbe"))&&m(t,"class",c),(!w||F&136&&u!==(u=(y[7]==="full"?"height: 100%":`height: ${y[7]}px; min-width: ${y[7]}px`)+"; "+(y[3]?`border: 5px solid ${y[3]};`:"")))&&m(t,"style",u),y[4]?T?T.p(y,F):(T=_s(y),T.c(),T.m(f,d)):T&&(T.d(1),T=null),y[5]?I&&(_e(),R(I,1,1,()=>{I=null}),ve()):I?(I.p(y,F),F&32&&M(I,1)):(I=vs(y),I.c(),M(I,1),I.m(f,p)),A&&A.p&&(!w||F&262144)&&Be(A,L,y,y[18],w?qe(L,y[18],F,Fa):ze(y[18]),gs),(!w||F&2116&&g!==(g="region is-center "+(y[6]&&y[11](y[2])?"checked":"")+" svelte-g5axbe"))&&m(e,"class",g),(!w||F&128&&v!==(v=y[7]==="full"?"height: 100%":""))&&m(e,"style",v)},i(y){w||(M(I),M(A,y),w=!0)},o(y){R(I),R(A,y),w=!1},d(y){y&&E(e),T&&T.d(),I&&I.d(),A&&A.d(y),S=!1,Ie(P)}}}function Ka(n,e,t){let i,s,r,l,o,{$$slots:a={},$$scope:c}=e;const{clipBoard:u}=bt;ue(n,u,K=>t(17,l=K));let{selectionStore:h}=e;h||(h=gt);let{toggleSelection:f=h.toggle}=e;const{isSelected:d}=h;ue(n,d,K=>t(11,o=K));let{item:p}=e,{index:g=null}=e,{borderColor:v=null}=e,{copyable:w=!1}=e,{isInModal:S=!1}=e,{selectable:P=!S}=e,{isSquare:T=!1}=e,{height:I=T?96:140}=e;I==="full"&&(T=!1);const L=Kt(),A=()=>S?null:L("openModal",{index:g}),y=()=>P?f(i):A(),F=()=>bt.copyRef(p.ref);return n.$$set=K=>{"selectionStore"in K&&t(15,h=K.selectionStore),"toggleSelection"in K&&t(1,f=K.toggleSelection),"item"in K&&t(2,p=K.item),"index"in K&&t(16,g=K.index),"borderColor"in K&&t(3,v=K.borderColor),"copyable"in K&&t(4,w=K.copyable),"isInModal"in K&&t(5,S=K.isInModal),"selectable"in K&&t(6,P=K.selectable),"isSquare"in K&&t(0,T=K.isSquare),"height"in K&&t(7,I=K.height),"$$scope"in K&&t(18,c=K.$$scope)},n.$$.update=()=>{n.$$.dirty&4&&t(8,i=new Dn(p)),n.$$.dirty&131328&&t(10,s=i.ref===l),n.$$.dirty&385&&t(9,r=i.url(null,I==="full"?"full":T?`${I},`:`,${I}`))},[T,f,p,v,w,S,P,I,i,r,s,o,u,d,A,h,g,l,c,a,y,F]}class Bt extends ae{constructor(e){super(),oe(this,e,Ka,za,le,{selectionStore:15,toggleSelection:1,item:2,index:16,borderColor:3,copyable:4,isInModal:5,selectable:6,isSquare:0,height:7})}}function bs(n){let e,t,i,s,r,l,o,a,c,u,h;return t=new nn({props:{category:1,isSelected:n[2]===1,toggle:n[5],padding:"pl-3 pr-2"}}),s=new nn({props:{category:2,isSelected:n[2]===2,toggle:n[5]}}),l=new nn({props:{category:3,isSelected:n[2]===3,toggle:n[5]}}),a=new nn({props:{category:4,isSelected:n[2]===4,toggle:n[5]}}),u=new nn({props:{category:5,isSelected:n[2]===5,toggle:n[5],padding:"pl-2 pr-3"}}),{c(){e=b("div"),x(t.$$.fragment),i=D(),x(s.$$.fragment),r=D(),x(l.$$.fragment),o=D(),x(a.$$.fragment),c=D(),x(u.$$.fragment),m(e,"class","tags has-addons is-dark is-center")},m(f,d){C(f,e,d),W(t,e,null),_(e,i),W(s,e,null),_(e,r),W(l,e,null),_(e,o),W(a,e,null),_(e,c),W(u,e,null),h=!0},p(f,d){const p={};d&4&&(p.isSelected=f[2]===1),t.$set(p);const g={};d&4&&(g.isSelected=f[2]===2),s.$set(g);const v={};d&4&&(v.isSelected=f[2]===3),l.$set(v);const w={};d&4&&(w.isSelected=f[2]===4),a.$set(w);const S={};d&4&&(S.isSelected=f[2]===5),u.$set(S)},i(f){h||(M(t.$$.fragment,f),M(s.$$.fragment,f),M(l.$$.fragment,f),M(a.$$.fragment,f),M(u.$$.fragment,f),h=!0)},o(f){R(t.$$.fragment,f),R(s.$$.fragment,f),R(l.$$.fragment,f),R(a.$$.fragment,f),R(u.$$.fragment,f),h=!1},d(f){f&&E(e),G(t),G(s),G(l),G(a),G(u)}}}function Wa(n){let e,t,i,s;t=new Bt({props:{item:n[4],height:140,selectable:!1,copyable:!0,isSquare:!1,isInModal:n[1],index:n[0]}}),t.$on("openModal",n[15]);let r=!n[1]&&bs(n);return{c(){e=b("div"),x(t.$$.fragment),i=D(),r&&r.c()},m(l,o){C(l,e,o),W(t,e,null),_(e,i),r&&r.m(e,null),s=!0},p(l,[o]){const a={};o&2&&(a.isInModal=l[1]),o&1&&(a.index=l[0]),t.$set(a),l[1]?r&&(_e(),R(r,1,1,()=>{r=null}),ve()):r?(r.p(l,o),o&2&&M(r,1)):(r=bs(l),r.c(),M(r,1),r.m(e,null))},i(l){s||(M(t.$$.fragment,l),M(r),s=!0)},o(l){R(t.$$.fragment,l),R(r),s=!1},d(l){l&&E(e),G(t),r&&r.d()}}}function Ga(n,e,t){let i,s,r;const{comparedRegions:l}=xe;ue(n,l,V=>t(17,r=V));const a=new URL(window.location.href).origin;let{qImg:c}=e,{sImg:u}=e,{qRegions:h}=e,{sRegions:f}=e,{score:d=0}=e,{category:p=null}=e,{users:g=[]}=e,{isManual:v}=e,{similarityType:w}=e,{index:S=0}=e,{isInModal:P=!1}=e;const[T,I,L,A]=u.split(".")[0].split("_"),F=(()=>{let V=Si(u,T,A,L);const H=r[`${T}_${I}_anno${f}`]||{title:V.title};return V.title=`${Jr(H.title.replace(/^[^|]+/,""))}<br/>Page ${$o(L)}<br/><b>Score: ${d}</b>`,V})();at("similarityPair",{qImg:c,sImg:u,qRegions:h,sRegions:f,score:d,category:p,users:g,isManual:v,similarityType:w});function K(V){V=V.slice();let H=V.indexOf(Number(An));return s&&H===-1?V.push(Number(An)):!s&&H!==-1&&V.splice(H,1),V}const re=()=>({img_1:c,img_2:u,regions_id_1:h,regions_id_2:f,score:d,category:i,category_x:K(g),similarity_type:w});function U(V){V===5?s=!s:t(2,i=i===V?null:V)}async function Y(V){U(V);try{(await fetch(`${a}/${Ve}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify(re())})).ok||(console.error("Error: Network response was not ok"),U(V))}catch(H){console.error("Error:",H),U(V)}}function Z(V){Rn.call(this,n,V)}return n.$$set=V=>{"qImg"in V&&t(6,c=V.qImg),"sImg"in V&&t(7,u=V.sImg),"qRegions"in V&&t(8,h=V.qRegions),"sRegions"in V&&t(9,f=V.sRegions),"score"in V&&t(10,d=V.score),"category"in V&&t(11,p=V.category),"users"in V&&t(12,g=V.users),"isManual"in V&&t(13,v=V.isManual),"similarityType"in V&&t(14,w=V.similarityType),"index"in V&&t(0,S=V.index),"isInModal"in V&&t(1,P=V.isInModal)},n.$$.update=()=>{n.$$.dirty&2048&&t(2,i=p),n.$$.dirty&4096&&(s=g.includes(Number(An))||!1)},[S,P,i,l,F,Y,c,u,h,f,d,p,g,v,w,Z]}class Ya extends ae{constructor(e){super(),oe(this,e,Ga,Wa,le,{qImg:6,sImg:7,qRegions:8,sRegions:9,score:10,category:11,users:12,isManual:13,similarityType:14,index:0,isInModal:1})}}const xa=n=>({item:n&4,index:n&1}),ws=n=>({item:n[2],index:n[0],close:n[4]});function ys(n){let e,t,i,s,r,l,o,a,c,u,h,f,d=n[3]&&ks(n);const p=n[8].default,g=He(p,n,n[7],ws);let v=n[3]&&Ss(n);return{c(){e=b("div"),t=b("div"),i=D(),s=b("div"),d&&d.c(),r=D(),l=b("div"),g&&g.c(),o=D(),v&&v.c(),a=D(),c=b("button"),m(t,"class","modal-background"),m(l,"class","modal-inner svelte-1da92kq"),m(s,"class","modal-content svelte-1da92kq"),m(c,"class","modal-close is-large"),m(c,"aria-label","close"),m(e,"class","modal is-active")},m(w,S){C(w,e,S),_(e,t),_(e,i),_(e,s),d&&d.m(s,null),_(s,r),_(s,l),g&&g.m(l,null),_(s,o),v&&v.m(s,null),_(e,a),_(e,c),u=!0,h||(f=[ne(t,"click",n[4]),ne(t,"keyup",n[9]),ne(c,"click",n[4])],h=!0)},p(w,S){w[3]?d?d.p(w,S):(d=ks(w),d.c(),d.m(s,r)):d&&(d.d(1),d=null),g&&g.p&&(!u||S&133)&&Be(g,p,w,w[7],u?qe(p,w[7],S,xa):ze(w[7]),ws),w[3]?v?v.p(w,S):(v=Ss(w),v.c(),v.m(s,null)):v&&(v.d(1),v=null)},i(w){u||(M(g,w),u=!0)},o(w){R(g,w),u=!1},d(w){w&&E(e),d&&d.d(),g&&g.d(w),v&&v.d(),h=!1,Ie(f)}}}function ks(n){let e,t,i;return{c(){e=b("button"),e.innerHTML='<span class="icon"><i class="fas fa-chevron-left"></i></span>',m(e,"class","nav-btn svelte-1da92kq")},m(s,r){C(s,e,r),t||(i=ne(e,"click",n[10]),t=!0)},p:j,d(s){s&&E(e),t=!1,i()}}}function Ss(n){let e,t,i;return{c(){e=b("button"),e.innerHTML='<span class="icon"><i class="fas fa-chevron-right"></i></span>',m(e,"class","nav-btn svelte-1da92kq")},m(s,r){C(s,e,r),t||(i=ne(e,"click",n[11]),t=!0)},p:j,d(s){s&&E(e),t=!1,i()}}}function Ja(n){let e,t,i=n[1]&&ys(n);return{c(){i&&i.c(),e=pe()},m(s,r){i&&i.m(s,r),C(s,e,r),t=!0},p(s,[r]){s[1]?i?(i.p(s,r),r&2&&M(i,1)):(i=ys(s),i.c(),M(i,1),i.m(e.parentNode,e)):i&&(_e(),R(i,1,1,()=>{i=null}),ve())},i(s){t||(M(i),t=!0)},o(s){R(i),t=!1},d(s){i&&i.d(s),s&&E(e)}}}function Xa(n,e,t){let i,s,{$$slots:r={},$$scope:l}=e,{open:o=!1}=e,{items:a=[]}=e,{currentIndex:c=0}=e;const u=Kt(),h=()=>{t(1,o=!1),u("close")},f=w=>{i&&(t(0,c=(c+w+a.length)%a.length),u("navigate",{index:c,item:s}))},d=w=>{o&&(w.key==="Escape"?h():w.key==="ArrowLeft"?f(-1):w.key==="ArrowRight"&&f(1))};rt(()=>document.addEventListener("keydown",d)),hn(()=>document.removeEventListener("keydown",d));function p(w){Rn.call(this,n,w)}const g=()=>f(-1),v=()=>f(1);return n.$$set=w=>{"open"in w&&t(1,o=w.open),"items"in w&&t(6,a=w.items),"currentIndex"in w&&t(0,c=w.currentIndex),"$$scope"in w&&t(7,l=w.$$scope)},n.$$.update=()=>{n.$$.dirty&64&&t(3,i=a.length>1),n.$$.dirty&65&&t(2,s=a[c]??null)},[c,o,s,i,h,f,a,l,r,p,g,v]}class Ei extends ae{constructor(e){super(),oe(this,e,Xa,Ja,le,{open:1,items:6,currentIndex:0})}}function Qa(n){let e,t,i,s,r,l,o,a;return{c(){e=b("button"),t=b("span"),i=b("i"),m(i,"class",s="fas fa-chevron-"+n[0]+" svelte-v4yed0"),m(t,"class","icon is-small p-0"),m(e,"class",r="nav-btn nav-"+n[0]+" svelte-v4yed0"),m(e,"aria-label",l="Navigate "+n[0]),m(e,"style",n[4])},m(c,u){C(c,e,u),_(e,t),_(t,i),o||(a=ne(e,"click",n[5]),o=!0)},p(c,[u]){u&1&&s!==(s="fas fa-chevron-"+c[0]+" svelte-v4yed0")&&m(i,"class",s),u&1&&r!==(r="nav-btn nav-"+c[0]+" svelte-v4yed0")&&m(e,"class",r),u&1&&l!==(l="Navigate "+c[0])&&m(e,"aria-label",l),u&16&&m(e,"style",c[4])},i:j,o:j,d(c){c&&E(e),o=!1,a()}}}function Za(n,e,t){let{direction:i=""}=e,{delta:s=0}=e,{axis:r=null}=e,{navigationFct:l=()=>{}}=e,{css:o=""}=e;const a=()=>l(s,r);return n.$$set=c=>{"direction"in c&&t(0,i=c.direction),"delta"in c&&t(1,s=c.delta),"axis"in c&&t(2,r=c.axis),"navigationFct"in c&&t(3,l=c.navigationFct),"css"in c&&t(4,o=c.css)},[i,s,r,l,o,a]}class Es extends ae{constructor(e){super(),oe(this,e,Za,Qa,le,{direction:0,delta:1,axis:2,navigationFct:3,css:4})}}function Cs(n){n[9]=n[13][0],n[10]=n[13][1],n[11]=n[13][2],n[12]=n[13][3]}function Is(n){let e,t,i={ctx:n,current:null,token:null,hasCatch:!1,pending:nc,then:tc,catch:ec,value:13};return Ze(t=n[3],i),{c(){e=pe(),i.block.c()},m(s,r){C(s,e,r),i.block.m(s,i.anchor=r),i.mount=()=>e.parentNode,i.anchor=e},p(s,r){n=s,i.ctx=n,r&8&&t!==(t=n[3])&&Ze(t,i)||At(i,n,r)},d(s){s&&E(e),i.block.d(s),i.token=null,i=null}}}function ec(n){return{c:j,m:j,p:j,d:j}}function tc(n){Cs(n);let e,t=`${n[9]}%`,i=`${n[10]}%`,s=`${n[11]}%`,r=`${n[12]}%`;return{c(){e=b("div"),m(e,"class","modal-context-bbox svelte-zgr10j"),ge(e,"left",t),ge(e,"top",i),ge(e,"width",s),ge(e,"height",r)},m(l,o){C(l,e,o)},p(l,o){Cs(l),o&8&&t!==(t=`${l[9]}%`)&&ge(e,"left",t),o&8&&i!==(i=`${l[10]}%`)&&ge(e,"top",i),o&8&&s!==(s=`${l[11]}%`)&&ge(e,"width",s),o&8&&r!==(r=`${l[12]}%`)&&ge(e,"height",r)},d(l){l&&E(e)}}}function nc(n){return{c:j,m:j,p:j,d:j}}function ic(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v;c=new Es({props:{direction:"left",delta:-1,navigationFct:n[5],css:"margin-left: -2em;"}});let w=n[0]===0&&Is(n);return g=new Es({props:{direction:"right",delta:1,navigationFct:n[5],css:"margin-right: -2em;"}}),{c(){e=b("div"),t=b("div"),i=b("a"),s=J("Page "),r=J(n[2]),o=D(),a=b("div"),x(c.$$.fragment),u=D(),h=b("img"),d=D(),w&&w.c(),p=D(),x(g.$$.fragment),m(i,"class","tag button is-small has-text-grey"),m(i,"href",l=n[1].urlForMirador(n[2])),m(i,"target","_blank"),m(t,"class","has-text-centered m-2"),m(h,"class","card modal-context-full-page svelte-zgr10j"),$e(h.src,f=n[4])||m(h,"src",f),m(h,"alt",N==="fr"?"Vue de la page d'où la région est extraite":"View of the page the region is extracted from"),m(a,"class","modal-context-wrapper svelte-zgr10j"),m(e,"class","modal-context-outer is-flex-direction-column pb-4 svelte-zgr10j")},m(S,P){C(S,e,P),_(e,t),_(t,i),_(i,s),_(i,r),_(e,o),_(e,a),W(c,a,null),_(a,u),_(a,h),_(a,d),w&&w.m(a,null),_(a,p),W(g,a,null),v=!0},p(S,[P]){(!v||P&4)&&fe(r,S[2]),(!v||P&6&&l!==(l=S[1].urlForMirador(S[2])))&&m(i,"href",l),(!v||P&16&&!$e(h.src,f=S[4]))&&m(h,"src",f),S[0]===0?w?w.p(S,P):(w=Is(S),w.c(),w.m(a,p)):w&&(w.d(1),w=null)},i(S){v||(M(c.$$.fragment,S),M(g.$$.fragment,S),v=!0)},o(S){R(c.$$.fragment,S),R(g.$$.fragment,S),v=!1},d(S){S&&E(e),G(c),w&&w.d(),G(g)}}}function sc(n,e,t){let i,s,r,l,o,a,{item:c}=e,u=0;const h=f=>t(0,u+=f);return n.$$set=f=>{"item"in f&&t(6,c=f.item)},n.$$.update=()=>{n.$$.dirty&64&&t(1,i=new Dn(c)),n.$$.dirty&3&&t(2,s=i.canvasNb+u),n.$$.dirty&6&&t(4,r=i.urlForCanvas(s,"full")),n.$$.dirty&6&&t(8,l=i.infoUrlForCanvas(s)),n.$$.dirty&2&&t(7,o=i.coord),n.$$.dirty&384&&t(3,a=fetch(l).then(f=>f.json()).then(({width:f,height:d})=>[o[0]/f*100,o[1]/d*100,o[2]/f*100,o[3]/d*100]))},[u,i,s,a,r,h,c,o,l]}class pl extends ae{constructor(e){super(),oe(this,e,sc,ic,le,{item:6})}}function rc(n){let e,t,i,s,r,l,o;return{c(){e=b("button"),t=b("span"),t.innerHTML='<span class="switch-control svelte-g5g8im"><span class="switch-spot"></span></span>',i=D(),s=b("span"),r=J(n[0]),m(t,"class","switch mr-2 svelte-g5g8im"),m(s,"class","label svelte-g5g8im"),m(e,"id",n[3]),m(e,"name",n[3]),m(e,"class","input-checkbox-wrapper is-flex is-align-items-center-is-justify-content-center p-2 pl-3 pr-3 svelte-g5g8im"),m(e,"aria-label",n[0]),Ce(e,"is-checked",n[2]),Ce(e,"is-clickable",n[1]),Ce(e,"button",n[1])},m(a,c){C(a,e,c),_(e,t),_(e,i),_(e,s),_(s,r),l||(o=ne(e,"click",wt(n[4])),l=!0)},p(a,[c]){c&1&&fe(r,a[0]),c&1&&m(e,"aria-label",a[0]),c&4&&Ce(e,"is-checked",a[2]),c&2&&Ce(e,"is-clickable",a[1]),c&2&&Ce(e,"button",a[1])},i:j,o:j,d(a){a&&E(e),l=!1,o()}}}function lc(n,e,t){let i,{toggleLabel:s}=e,{start:r=!1}=e,{buttonDisplay:l=!1}=e;const o=`input-toggle-${window.crypto.randomUUID()}`,a=Kt(),c=Je("resetTrigger")||void 0;c==null||c.subscribe(h);const u=()=>t(2,i=!i);function h(){t(2,i=r)}return n.$$set=f=>{"toggleLabel"in f&&t(0,s=f.toggleLabel),"start"in f&&t(5,r=f.start),"buttonDisplay"in f&&t(1,l=f.buttonDisplay)},n.$$.update=()=>{n.$$.dirty&32&&t(2,i=r),n.$$.dirty&4&&a("updateChecked",i)},[s,l,i,o,u,r]}class gl extends ae{constructor(e){super(),oe(this,e,lc,rc,le,{toggleLabel:0,start:5,buttonDisplay:1})}}var pt;(function(n){n.Range="range",n.Steps="steps",n.Positions="positions",n.Count="count",n.Values="values"})(pt||(pt={}));var Fe;(function(n){n[n.None=-1]="None",n[n.NoValue=0]="NoValue",n[n.LargeValue=1]="LargeValue",n[n.SmallValue=2]="SmallValue"})(Fe||(Fe={}));function oc(n){return Nn(n)&&typeof n.from=="function"}function Nn(n){return typeof n=="object"&&typeof n.to=="function"}function Os(n){n.parentElement.removeChild(n)}function li(n){return n!=null}function As(n){n.preventDefault()}function ac(n){return n.filter(function(e){return this[e]?!1:this[e]=!0},{})}function cc(n,e){return Math.round(n/e)*e}function uc(n,e){var t=n.getBoundingClientRect(),i=n.ownerDocument,s=i.documentElement,r=_l(i);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(r.x=0),e?t.top+r.y-s.clientTop:t.left+r.x-s.clientLeft}function Qe(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}function Ts(n,e,t){t>0&&(je(n,e),setTimeout(function(){Tn(n,e)},t))}function Ms(n){return Math.max(Math.min(n,100),0)}function Hn(n){return Array.isArray(n)?n:[n]}function fc(n){n=String(n);var e=n.split(".");return e.length>1?e[1].length:0}function je(n,e){n.classList&&!/\s/.test(e)?n.classList.add(e):n.className+=" "+e}function Tn(n,e){n.classList&&!/\s/.test(e)?n.classList.remove(e):n.className=n.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function dc(n,e){return n.classList?n.classList.contains(e):new RegExp("\\b"+e+"\\b").test(n.className)}function _l(n){var e=window.pageXOffset!==void 0,t=(n.compatMode||"")==="CSS1Compat",i=e?window.pageXOffset:t?n.documentElement.scrollLeft:n.body.scrollLeft,s=e?window.pageYOffset:t?n.documentElement.scrollTop:n.body.scrollTop;return{x:i,y:s}}function hc(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function mc(){var n=!1;try{var e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,e)}catch{}return n}function pc(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function Ci(n,e){return 100/(e-n)}function oi(n,e,t){return e*100/(n[t+1]-n[t])}function gc(n,e){return oi(n,n[0]<0?e+Math.abs(n[0]):e-n[0],0)}function _c(n,e){return e*(n[1]-n[0])/100+n[0]}function fn(n,e){for(var t=1;n>=e[t];)t+=1;return t}function vc(n,e,t){if(t>=n.slice(-1)[0])return 100;var i=fn(t,n),s=n[i-1],r=n[i],l=e[i-1],o=e[i];return l+gc([s,r],t)/Ci(l,o)}function bc(n,e,t){if(t>=100)return n.slice(-1)[0];var i=fn(t,e),s=n[i-1],r=n[i],l=e[i-1],o=e[i];return _c([s,r],(t-l)*Ci(l,o))}function wc(n,e,t,i){if(i===100)return i;var s=fn(i,n),r=n[s-1],l=n[s];return t?i-r>(l-r)/2?l:r:e[s-1]?n[s-1]+cc(i-n[s-1],e[s-1]):i}var vl=function(){function n(e,t,i){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[i||!1],this.xNumSteps=[!1],this.snap=t;var s,r=[];for(Object.keys(e).forEach(function(l){r.push([Hn(e[l]),l])}),r.sort(function(l,o){return l[0][0]-o[0][0]}),s=0;s<r.length;s++)this.handleEntryPoint(r[s][1],r[s][0]);for(this.xNumSteps=this.xSteps.slice(0),s=0;s<this.xNumSteps.length;s++)this.handleStepPoint(s,this.xNumSteps[s])}return n.prototype.getDistance=function(e){for(var t=[],i=0;i<this.xNumSteps.length-1;i++)t[i]=oi(this.xVal,e,i);return t},n.prototype.getAbsoluteDistance=function(e,t,i){var s=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[s+1];)s++;else e===this.xPct[this.xPct.length-1]&&(s=this.xPct.length-2);!i&&e===this.xPct[s+1]&&s++,t===null&&(t=[]);var r,l=1,o=t[s],a=0,c=0,u=0,h=0;for(i?r=(e-this.xPct[s])/(this.xPct[s+1]-this.xPct[s]):r=(this.xPct[s+1]-e)/(this.xPct[s+1]-this.xPct[s]);o>0;)a=this.xPct[s+1+h]-this.xPct[s+h],t[s+h]*l+100-r*100>100?(c=a*r,l=(o-100*r)/t[s+h],r=1):(c=t[s+h]*a/100*l,l=0),i?(u=u-c,this.xPct.length+h>=1&&h--):(u=u+c,this.xPct.length-h>=1&&h++),o=t[s+h]*l;return e+u},n.prototype.toStepping=function(e){return e=vc(this.xVal,this.xPct,e),e},n.prototype.fromStepping=function(e){return bc(this.xVal,this.xPct,e)},n.prototype.getStep=function(e){return e=wc(this.xPct,this.xSteps,this.snap,e),e},n.prototype.getDefaultStep=function(e,t,i){var s=fn(e,this.xPct);return(e===100||t&&e===this.xPct[s-1])&&(s=Math.max(s-1,1)),(this.xVal[s]-this.xVal[s-1])/i},n.prototype.getNearbySteps=function(e){var t=fn(e,this.xPct);return{stepBefore:{startValue:this.xVal[t-2],step:this.xNumSteps[t-2],highestStep:this.xHighestCompleteStep[t-2]},thisStep:{startValue:this.xVal[t-1],step:this.xNumSteps[t-1],highestStep:this.xHighestCompleteStep[t-1]},stepAfter:{startValue:this.xVal[t],step:this.xNumSteps[t],highestStep:this.xHighestCompleteStep[t]}}},n.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(fc);return Math.max.apply(null,e)},n.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},n.prototype.convert=function(e){return this.getStep(this.toStepping(e))},n.prototype.handleEntryPoint=function(e,t){var i;if(e==="min"?i=0:e==="max"?i=100:i=parseFloat(e),!Qe(i)||!Qe(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(i),this.xVal.push(t[0]);var s=Number(t[1]);i?this.xSteps.push(isNaN(s)?!1:s):isNaN(s)||(this.xSteps[0]=s),this.xHighestCompleteStep.push(0)},n.prototype.handleStepPoint=function(e,t){if(t){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=oi([this.xVal[e],this.xVal[e+1]],t,0)/Ci(this.xPct[e],this.xPct[e+1]);var i=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],s=Math.ceil(Number(i.toFixed(3))-1),r=this.xVal[e]+this.xNumSteps[e]*s;this.xHighestCompleteStep[e]=r}},n}(),Ps={to:function(n){return n===void 0?"":n.toFixed(2)},from:Number},bl={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},mt={tooltips:".__tooltips",aria:".__aria"};function yc(n,e){if(!Qe(e))throw new Error("noUiSlider: 'step' is not numeric.");n.singleStep=e}function kc(n,e){if(!Qe(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");n.keyboardPageMultiplier=e}function Sc(n,e){if(!Qe(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");n.keyboardMultiplier=e}function Ec(n,e){if(!Qe(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");n.keyboardDefaultStep=e}function Cc(n,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");n.spectrum=new vl(e,n.snap||!1,n.singleStep)}function Ic(n,e){if(e=Hn(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");n.handles=e.length,n.start=e}function Oc(n,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");n.snap=e}function Ac(n,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");n.animate=e}function Tc(n,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");n.animationDuration=e}function wl(n,e){var t=[!1],i;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(i=1;i<n.handles;i++)t.push(e);t.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==n.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");t=e}n.connect=t}function Mc(n,e){switch(e){case"horizontal":n.ort=0;break;case"vertical":n.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function yl(n,e){if(!Qe(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(n.margin=n.spectrum.getDistance(e))}function Pc(n,e){if(!Qe(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(n.limit=n.spectrum.getDistance(e),!n.limit||n.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function Lc(n,e){var t;if(!Qe(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||Qe(e[0])||Qe(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),n.padding=[n.spectrum.getDistance(e[0]),n.spectrum.getDistance(e[1])],t=0;t<n.spectrum.xNumSteps.length-1;t++)if(n.padding[0][t]<0||n.padding[1][t]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var i=e[0]+e[1],s=n.spectrum.xVal[0],r=n.spectrum.xVal[n.spectrum.xVal.length-1];if(i/(r-s)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function Rc(n,e){switch(e){case"ltr":n.dir=0;break;case"rtl":n.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function $c(n,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var t=e.indexOf("tap")>=0,i=e.indexOf("drag")>=0,s=e.indexOf("fixed")>=0,r=e.indexOf("snap")>=0,l=e.indexOf("hover")>=0,o=e.indexOf("unconstrained")>=0,a=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,u=e.indexOf("smooth-steps")>=0;if(s){if(n.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");yl(n,n.start[1]-n.start[0])}if(a&&n.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(o&&(n.margin||n.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");n.events={tap:t||r,drag:i,dragAll:c,smoothSteps:u,fixed:s,snap:r,hover:l,unconstrained:o,invertConnects:a}}function Dc(n,e){if(e!==!1)if(e===!0||Nn(e)){n.tooltips=[];for(var t=0;t<n.handles;t++)n.tooltips.push(e)}else{if(e=Hn(e),e.length!==n.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(i){if(typeof i!="boolean"&&!Nn(i))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),n.tooltips=e}}function Nc(n,e){if(e.length!==n.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");n.handleAttributes=e}function jc(n,e){if(!Nn(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");n.ariaFormat=e}function Vc(n,e){if(!oc(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");n.format=e}function Fc(n,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");n.keyboardSupport=e}function Uc(n,e){n.documentElement=e}function Hc(n,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");n.cssPrefix=e}function qc(n,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof n.cssPrefix=="string"?(n.cssClasses={},Object.keys(e).forEach(function(t){n.cssClasses[t]=n.cssPrefix+e[t]})):n.cssClasses=e}function kl(n){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:Ps,format:Ps},t={step:{r:!1,t:yc},keyboardPageMultiplier:{r:!1,t:kc},keyboardMultiplier:{r:!1,t:Sc},keyboardDefaultStep:{r:!1,t:Ec},start:{r:!0,t:Ic},connect:{r:!0,t:wl},direction:{r:!0,t:Rc},snap:{r:!1,t:Oc},animate:{r:!1,t:Ac},animationDuration:{r:!1,t:Tc},range:{r:!0,t:Cc},orientation:{r:!1,t:Mc},margin:{r:!1,t:yl},limit:{r:!1,t:Pc},padding:{r:!1,t:Lc},behaviour:{r:!0,t:$c},ariaFormat:{r:!1,t:jc},format:{r:!1,t:Vc},tooltips:{r:!1,t:Dc},keyboardSupport:{r:!0,t:Fc},documentElement:{r:!1,t:Uc},cssPrefix:{r:!0,t:Hc},cssClasses:{r:!0,t:qc},handleAttributes:{r:!1,t:Nc}},i={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:bl,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};n.format&&!n.ariaFormat&&(n.ariaFormat=n.format),Object.keys(t).forEach(function(a){if(!li(n[a])&&i[a]===void 0){if(t[a].r)throw new Error("noUiSlider: '"+a+"' is required.");return}t[a].t(e,li(n[a])?n[a]:i[a])}),e.pips=n.pips;var s=document.createElement("div"),r=s.style.msTransform!==void 0,l=s.style.transform!==void 0;e.transformRule=l?"transform":r?"msTransform":"webkitTransform";var o=[["left","top"],["right","bottom"]];return e.style=o[e.dir][e.ort],e}function Bc(n,e,t){var i=hc(),s=pc(),r=s&&mc(),l=n,o,a,c,u,h,f,d=e.spectrum,p=[],g=[],v=[],w=0,S={},P=!1,T=n.ownerDocument,I=e.documentElement||T.documentElement,L=T.body,A=T.dir==="rtl"||e.ort===1?0:100;function y(k,O){var $=T.createElement("div");return O&&je($,O),k.appendChild($),$}function F(k,O){var $=y(k,e.cssClasses.origin),B=y($,e.cssClasses.handle);if(y(B,e.cssClasses.touchArea),B.setAttribute("data-handle",String(O)),e.keyboardSupport&&(B.setAttribute("tabindex","0"),B.addEventListener("keydown",function(Q){return Wl(Q,O)})),e.handleAttributes!==void 0){var X=e.handleAttributes[O];Object.keys(X).forEach(function(Q){B.setAttribute(Q,X[Q])})}return B.setAttribute("role","slider"),B.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),O===0?je(B,e.cssClasses.handleLower):O===e.handles-1&&je(B,e.cssClasses.handleUpper),$.handle=B,$}function K(k,O){return O?y(k,e.cssClasses.connect):!1}function re(k,O){a=y(O,e.cssClasses.connects),c=[],u=[],u.push(K(a,k[0]));for(var $=0;$<e.handles;$++)c.push(F(O,$)),v[$]=$,u.push(K(a,k[$+1]))}function U(k){je(k,e.cssClasses.target),e.dir===0?je(k,e.cssClasses.ltr):je(k,e.cssClasses.rtl),e.ort===0?je(k,e.cssClasses.horizontal):je(k,e.cssClasses.vertical);var O=getComputedStyle(k).direction;return O==="rtl"?je(k,e.cssClasses.textDirectionRtl):je(k,e.cssClasses.textDirectionLtr),y(k,e.cssClasses.base)}function Y(k,O){return!e.tooltips||!e.tooltips[O]?!1:y(k.firstChild,e.cssClasses.tooltip)}function Z(){return l.hasAttribute("disabled")}function V(k){var O=c[k];return O.hasAttribute("disabled")}function H(k){k!=null?(c[k].setAttribute("disabled",""),c[k].handle.removeAttribute("tabindex")):(l.setAttribute("disabled",""),c.forEach(function(O){O.handle.removeAttribute("tabindex")}))}function se(k){k!=null?(c[k].removeAttribute("disabled"),c[k].handle.setAttribute("tabindex","0")):(l.removeAttribute("disabled"),c.forEach(function(O){O.removeAttribute("disabled"),O.handle.setAttribute("tabindex","0")}))}function z(){f&&(Zt("update"+mt.tooltips),f.forEach(function(k){k&&Os(k)}),f=null)}function q(){z(),f=c.map(Y),Wn("update"+mt.tooltips,function(k,O,$){if(!(!f||!e.tooltips)&&f[O]!==!1){var B=k[O];e.tooltips[O]!==!0&&(B=e.tooltips[O].to($[O])),f[O].innerHTML=B}})}function te(){Zt("update"+mt.aria),Wn("update"+mt.aria,function(k,O,$,B,X){v.forEach(function(Q){var ie=c[Q],ee=bn(g,Q,0,!0,!0,!0),we=bn(g,Q,100,!0,!0,!0),ye=X[Q],ke=String(e.ariaFormat.to($[Q]));ee=d.fromStepping(ee).toFixed(1),we=d.fromStepping(we).toFixed(1),ye=d.fromStepping(ye).toFixed(1),ie.children[0].setAttribute("aria-valuemin",ee),ie.children[0].setAttribute("aria-valuemax",we),ie.children[0].setAttribute("aria-valuenow",ye),ie.children[0].setAttribute("aria-valuetext",ke)})})}function he(k){if(k.mode===pt.Range||k.mode===pt.Steps)return d.xVal;if(k.mode===pt.Count){if(k.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var O=k.values-1,$=100/O,B=[];O--;)B[O]=O*$;return B.push(100),be(B,k.stepped)}return k.mode===pt.Positions?be(k.values,k.stepped):k.mode===pt.Values?k.stepped?k.values.map(function(X){return d.fromStepping(d.getStep(d.toStepping(X)))}):k.values:[]}function be(k,O){return k.map(function($){return d.fromStepping(O?d.getStep($):$)})}function Gt(k){function O(ye,ke){return Number((ye+ke).toFixed(7))}var $=he(k),B={},X=d.xVal[0],Q=d.xVal[d.xVal.length-1],ie=!1,ee=!1,we=0;return $=ac($.slice().sort(function(ye,ke){return ye-ke})),$[0]!==X&&($.unshift(X),ie=!0),$[$.length-1]!==Q&&($.push(Q),ee=!0),$.forEach(function(ye,ke){var Se,me,Te,De=ye,Me=$[ke+1],Pe,xn,Jn,Xn,Ni,Qn,ji,Vi=k.mode===pt.Steps;for(Vi&&(Se=d.xNumSteps[ke]),Se||(Se=Me-De),Me===void 0&&(Me=De),Se=Math.max(Se,1e-7),me=De;me<=Me;me=O(me,Se)){for(Pe=d.toStepping(me),xn=Pe-we,Ni=xn/(k.density||1),Qn=Math.round(Ni),ji=xn/Qn,Te=1;Te<=Qn;Te+=1)Jn=we+Te*ji,B[Jn.toFixed(5)]=[d.fromStepping(Jn),0];Xn=$.indexOf(me)>-1?Fe.LargeValue:Vi?Fe.SmallValue:Fe.NoValue,!ke&&ie&&me!==Me&&(Xn=0),me===Me&&ee||(B[Pe.toFixed(5)]=[me,Xn]),we=Pe}}),B}function Yt(k,O,$){var B,X,Q=T.createElement("div"),ie=(B={},B[Fe.None]="",B[Fe.NoValue]=e.cssClasses.valueNormal,B[Fe.LargeValue]=e.cssClasses.valueLarge,B[Fe.SmallValue]=e.cssClasses.valueSub,B),ee=(X={},X[Fe.None]="",X[Fe.NoValue]=e.cssClasses.markerNormal,X[Fe.LargeValue]=e.cssClasses.markerLarge,X[Fe.SmallValue]=e.cssClasses.markerSub,X),we=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],ye=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];je(Q,e.cssClasses.pips),je(Q,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function ke(me,Te){var De=Te===e.cssClasses.value,Me=De?we:ye,Pe=De?ie:ee;return Te+" "+Me[e.ort]+" "+Pe[me]}function Se(me,Te,De){if(De=O?O(Te,De):De,De!==Fe.None){var Me=y(Q,!1);Me.className=ke(De,e.cssClasses.marker),Me.style[e.style]=me+"%",De>Fe.NoValue&&(Me=y(Q,!1),Me.className=ke(De,e.cssClasses.value),Me.setAttribute("data-value",String(Te)),Me.style[e.style]=me+"%",Me.innerHTML=String($.to(Te)))}}return Object.keys(k).forEach(function(me){Se(me,k[me][0],k[me][1])}),Q}function xt(){h&&(Os(h),h=null)}function Jt(k){xt();var O=Gt(k),$=k.filter,B=k.format||{to:function(X){return String(Math.round(X))}};return h=l.appendChild(Yt(O,$,B)),h}function gn(){var k=o.getBoundingClientRect(),O="offset"+["Width","Height"][e.ort];return e.ort===0?k.width||o[O]:k.height||o[O]}function lt(k,O,$,B){var X=function(ie){var ee=Xt(ie,B.pageOffset,B.target||O);if(!ee||Z()&&!B.doNotReject||dc(l,e.cssClasses.tap)&&!B.doNotReject||k===i.start&&ee.buttons!==void 0&&ee.buttons>1||B.hover&&ee.buttons)return!1;r||ee.preventDefault(),ee.calcPoint=ee.points[e.ort],$(ee,B)},Q=[];return k.split(" ").forEach(function(ie){O.addEventListener(ie,X,r?{passive:!0}:!1),Q.push([ie,X])}),Q}function Xt(k,O,$){var B=k.type.indexOf("touch")===0,X=k.type.indexOf("mouse")===0,Q=k.type.indexOf("pointer")===0,ie=0,ee=0;if(k.type.indexOf("MSPointer")===0&&(Q=!0),k.type==="mousedown"&&!k.buttons&&!k.touches)return!1;if(B){var we=function(Se){var me=Se.target;return me===$||$.contains(me)||k.composed&&k.composedPath().shift()===$};if(k.type==="touchstart"){var ye=Array.prototype.filter.call(k.touches,we);if(ye.length>1)return!1;ie=ye[0].pageX,ee=ye[0].pageY}else{var ke=Array.prototype.find.call(k.changedTouches,we);if(!ke)return!1;ie=ke.pageX,ee=ke.pageY}}return O=O||_l(T),(X||Q)&&(ie=k.clientX+O.x,ee=k.clientY+O.y),k.pageOffset=O,k.points=[ie,ee],k.cursor=X||Q,k}function Qt(k){var O=k-uc(o,e.ort),$=O*100/gn();return $=Ms($),e.dir?100-$:$}function _n(k){var O=100,$=!1;return c.forEach(function(B,X){if(!V(X)){var Q=g[X],ie=Math.abs(Q-k),ee=ie===100&&O===100,we=ie<O,ye=ie<=O&&k>Q;(we||ye||ee)&&($=X,O=ie)}}),$}function vn(k,O){k.type==="mouseout"&&k.target.nodeName==="HTML"&&k.relatedTarget===null&&zn(k,O)}function Bl(k,O){if(navigator.appVersion.indexOf("MSIE 9")===-1&&k.buttons===0&&O.buttonsProperty!==0)return zn(k,O);var $=(e.dir?-1:1)*(k.calcPoint-O.startCalcPoint),B=$*100/O.baseSize;Mi($>0,B,O.locations,O.handleNumbers,O.connect)}function zn(k,O){O.handle&&(Tn(O.handle,e.cssClasses.active),w-=1),O.listeners.forEach(function($){I.removeEventListener($[0],$[1])}),w===0&&(Tn(l,e.cssClasses.drag),Yn(),k.cursor&&(L.style.cursor="",L.removeEventListener("selectstart",As))),e.events.smoothSteps&&(O.handleNumbers.forEach(function($){kt($,g[$],!0,!0,!1,!1)}),O.handleNumbers.forEach(function($){Oe("update",$)})),O.handleNumbers.forEach(function($){Oe("change",$),Oe("set",$),Oe("end",$)})}function Kn(k,O){if(!O.handleNumbers.some(V)){var $;if(O.handleNumbers.length===1){var B=c[O.handleNumbers[0]];$=B.children[0],w+=1,je($,e.cssClasses.active)}k.stopPropagation();var X=[],Q=lt(i.move,I,Bl,{target:k.target,handle:$,connect:O.connect,listeners:X,startCalcPoint:k.calcPoint,baseSize:gn(),pageOffset:k.pageOffset,handleNumbers:O.handleNumbers,buttonsProperty:k.buttons,locations:g.slice()}),ie=lt(i.end,I,zn,{target:k.target,handle:$,listeners:X,doNotReject:!0,handleNumbers:O.handleNumbers}),ee=lt("mouseout",I,vn,{target:k.target,handle:$,listeners:X,doNotReject:!0,handleNumbers:O.handleNumbers});X.push.apply(X,Q.concat(ie,ee)),k.cursor&&(L.style.cursor=getComputedStyle(k.target).cursor,c.length>1&&je(l,e.cssClasses.drag),L.addEventListener("selectstart",As,!1)),O.handleNumbers.forEach(function(we){Oe("start",we)})}}function zl(k){k.stopPropagation();var O=Qt(k.calcPoint),$=_n(O);$!==!1&&(e.events.snap||Ts(l,e.cssClasses.tap,e.animationDuration),kt($,O,!0,!0),Yn(),Oe("slide",$,!0),Oe("update",$,!0),e.events.snap?Kn(k,{handleNumbers:[$]}):(Oe("change",$,!0),Oe("set",$,!0)))}function Kl(k){var O=Qt(k.calcPoint),$=d.getStep(O),B=d.fromStepping($);Object.keys(S).forEach(function(X){X.split(".")[0]==="hover"&&S[X].forEach(function(Q){Q.call(yn,B)})})}function Wl(k,O){if(Z()||V(O))return!1;var $=["Left","Right"],B=["Down","Up"],X=["PageDown","PageUp"],Q=["Home","End"];e.dir&&!e.ort?$.reverse():e.ort&&!e.dir&&(B.reverse(),X.reverse());var ie=k.key.replace("Arrow",""),ee=ie===X[0],we=ie===X[1],ye=ie===B[0]||ie===$[0]||ee,ke=ie===B[1]||ie===$[1]||we,Se=ie===Q[0],me=ie===Q[1];if(!ye&&!ke&&!Se&&!me)return!0;k.preventDefault();var Te;if(ke||ye){var De=ye?0:1,Me=$i(O),Pe=Me[De];if(Pe===null)return!1;Pe===!1&&(Pe=d.getDefaultStep(g[O],ye,e.keyboardDefaultStep)),we||ee?Pe*=e.keyboardPageMultiplier:Pe*=e.keyboardMultiplier,Pe=Math.max(Pe,1e-7),Pe=(ye?-1:1)*Pe,Te=p[O]+Pe}else me?Te=e.spectrum.xVal[e.spectrum.xVal.length-1]:Te=e.spectrum.xVal[0];return kt(O,d.toStepping(Te),!0,!0),Oe("slide",O),Oe("update",O),Oe("change",O),Oe("set",O),!1}function Ti(k){k.fixed||c.forEach(function(O,$){lt(i.start,O.children[0],Kn,{handleNumbers:[$]})}),k.tap&&lt(i.start,o,zl,{}),k.hover&&lt(i.move,o,Kl,{hover:!0}),k.drag&&u.forEach(function(O,$){if(!(O===!1||$===0||$===u.length-1)){var B=c[$-1],X=c[$],Q=[O],ie=[B,X],ee=[$-1,$];je(O,e.cssClasses.draggable),k.fixed&&(Q.push(B.children[0]),Q.push(X.children[0])),k.dragAll&&(ie=c,ee=v),Q.forEach(function(we){lt(i.start,we,Kn,{handles:ie,handleNumbers:ee,connect:O})})}})}function Wn(k,O){S[k]=S[k]||[],S[k].push(O),k.split(".")[0]==="update"&&c.forEach(function($,B){Oe("update",B)})}function Gl(k){return k===mt.aria||k===mt.tooltips}function Zt(k){var O=k&&k.split(".")[0],$=O?k.substring(O.length):k;Object.keys(S).forEach(function(B){var X=B.split(".")[0],Q=B.substring(X.length);(!O||O===X)&&(!$||$===Q)&&(!Gl(Q)||$===Q)&&delete S[B]})}function Oe(k,O,$){Object.keys(S).forEach(function(B){var X=B.split(".")[0];k===X&&S[B].forEach(function(Q){Q.call(yn,p.map(e.format.to),O,p.slice(),$||!1,g.slice(),yn)})})}function bn(k,O,$,B,X,Q,ie){var ee;return c.length>1&&!e.events.unconstrained&&(B&&O>0&&(ee=d.getAbsoluteDistance(k[O-1],e.margin,!1),$=Math.max($,ee)),X&&O<c.length-1&&(ee=d.getAbsoluteDistance(k[O+1],e.margin,!0),$=Math.min($,ee))),c.length>1&&e.limit&&(B&&O>0&&(ee=d.getAbsoluteDistance(k[O-1],e.limit,!1),$=Math.min($,ee)),X&&O<c.length-1&&(ee=d.getAbsoluteDistance(k[O+1],e.limit,!0),$=Math.max($,ee))),e.padding&&(O===0&&(ee=d.getAbsoluteDistance(0,e.padding[0],!1),$=Math.max($,ee)),O===c.length-1&&(ee=d.getAbsoluteDistance(100,e.padding[1],!0),$=Math.min($,ee))),ie||($=d.getStep($)),$=Ms($),$===k[O]&&!Q?!1:$}function Gn(k,O){var $=e.ort;return($?O:k)+", "+($?k:O)}function Mi(k,O,$,B,X){var Q=$.slice(),ie=B[0],ee=e.events.smoothSteps,we=[!k,k],ye=[k,!k];B=B.slice(),k&&B.reverse(),B.length>1?B.forEach(function(Se,me){var Te=bn(Q,Se,Q[Se]+O,we[me],ye[me],!1,ee);Te===!1?O=0:(O=Te-Q[Se],Q[Se]=Te)}):we=ye=[!0];var ke=!1;B.forEach(function(Se,me){ke=kt(Se,$[Se]+O,we[me],ye[me],!1,ee)||ke}),ke&&(B.forEach(function(Se){Oe("update",Se),Oe("slide",Se)}),X!=null&&Oe("drag",ie))}function Pi(k,O){return e.dir?100-k-O:k}function Yl(k,O){g[k]=O,p[k]=d.fromStepping(O);var $=Pi(O,0)-A,B="translate("+Gn($+"%","0")+")";if(c[k].style[e.transformRule]=B,e.events.invertConnects&&g.length>1){var X=g.every(function(Q,ie,ee){return ie===0||Q>=ee[ie-1]});if(P!==!X){eo();return}}en(k),en(k+1),P&&(en(k-1),en(k+2))}function Yn(){v.forEach(function(k){var O=g[k]>50?-1:1,$=3+(c.length+O*k);c[k].style.zIndex=String($)})}function kt(k,O,$,B,X,Q){return X||(O=bn(g,k,O,$,B,!1,Q)),O===!1?!1:(Yl(k,O),!0)}function en(k){if(u[k]){var O=g.slice();P&&O.sort(function(ee,we){return ee-we});var $=0,B=100;k!==0&&($=O[k-1]),k!==u.length-1&&(B=O[k]);var X=B-$,Q="translate("+Gn(Pi($,X)+"%","0")+")",ie="scale("+Gn(X/100,"1")+")";u[k].style[e.transformRule]=Q+" "+ie}}function Li(k,O){return k===null||k===!1||k===void 0||(typeof k=="number"&&(k=String(k)),k=e.format.from(k),k!==!1&&(k=d.toStepping(k)),k===!1||isNaN(k))?g[O]:k}function wn(k,O,$){var B=Hn(k),X=g[0]===void 0;O=O===void 0?!0:O,e.animate&&!X&&Ts(l,e.cssClasses.tap,e.animationDuration),v.forEach(function(ee){kt(ee,Li(B[ee],ee),!0,!1,$)});var Q=v.length===1?0:1;if(X&&d.hasNoSize()&&($=!0,g[0]=0,v.length>1)){var ie=100/(v.length-1);v.forEach(function(ee){g[ee]=ee*ie})}for(;Q<v.length;++Q)v.forEach(function(ee){kt(ee,g[ee],!0,!0,$)});Yn(),v.forEach(function(ee){Oe("update",ee),B[ee]!==null&&O&&Oe("set",ee)})}function xl(k){wn(e.start,k)}function Jl(k,O,$,B){if(k=Number(k),!(k>=0&&k<v.length))throw new Error("noUiSlider: invalid handle number, got: "+k);kt(k,Li(O,k),!0,!0,B),Oe("update",k),$&&Oe("set",k)}function Ri(k){if(k===void 0&&(k=!1),k)return p.length===1?p[0]:p.slice(0);var O=p.map(e.format.to);return O.length===1?O[0]:O}function Xl(){for(Zt(mt.aria),Zt(mt.tooltips),Object.keys(e.cssClasses).forEach(function(k){Tn(l,e.cssClasses[k])});l.firstChild;)l.removeChild(l.firstChild);delete l.noUiSlider}function $i(k){var O=g[k],$=d.getNearbySteps(O),B=p[k],X=$.thisStep.step,Q=null;if(e.snap)return[B-$.stepBefore.startValue||null,$.stepAfter.startValue-B||null];X!==!1&&B+X>$.stepAfter.startValue&&(X=$.stepAfter.startValue-B),B>$.thisStep.startValue?Q=$.thisStep.step:$.stepBefore.step===!1?Q=!1:Q=B-$.stepBefore.highestStep,O===100?X=null:O===0&&(Q=null);var ie=d.countStepDecimals();return X!==null&&X!==!1&&(X=Number(X.toFixed(ie))),Q!==null&&Q!==!1&&(Q=Number(Q.toFixed(ie))),[Q,X]}function Ql(){return v.map($i)}function Zl(k,O){var $=Ri(),B=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];B.forEach(function(Q){k[Q]!==void 0&&(t[Q]=k[Q])});var X=kl(t);B.forEach(function(Q){k[Q]!==void 0&&(e[Q]=X[Q])}),d=X.spectrum,e.margin=X.margin,e.limit=X.limit,e.padding=X.padding,e.pips?Jt(e.pips):xt(),e.tooltips?q():z(),g=[],wn(li(k.start)?k.start:$,O),k.connect&&Di()}function Di(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var k=0;k<=e.handles;k++)u[k]=K(a,e.connect[k]),en(k);Ti({drag:e.events.drag,fixed:!0})}function eo(){P=!P,wl(e,e.connect.map(function(k){return!k})),Di()}function to(){o=U(l),re(e.connect,o),Ti(e.events),wn(e.start),e.pips&&Jt(e.pips),e.tooltips&&q(),te()}to();var yn={destroy:Xl,steps:Ql,on:Wn,off:Zt,get:Ri,set:wn,setHandle:Jl,reset:xl,disable:H,enable:se,__moveHandles:function(k,O,$){Mi(k,O,g,$)},options:t,updateOptions:Zl,target:l,removePips:xt,removeTooltips:z,getPositions:function(){return g.slice()},getTooltips:function(){return f},getOrigins:function(){return c},pips:Jt};return yn}function zc(n,e){if(!n||!n.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+n);if(n.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var t=kl(e),i=Bc(n,t,e);return n.noUiSlider=i,i}const Kc={__spectrum:vl,cssClasses:bl,create:zc};function Wc(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v;return{c(){e=b("div"),t=b("span"),i=J(n[2]),s=J(" ("),r=J(n[3]),l=J(")"),o=D(),a=b("div"),c=b("span"),u=J(n[0]),h=D(),f=b("div"),d=b("div"),p=D(),g=b("span"),v=J(n[1]),m(c,"class","range-marker svelte-216mtn"),m(d,"class","slider"),m(d,"id",n[4]),m(f,"class","slider-wrapper svelte-216mtn"),m(g,"class","range-marker svelte-216mtn"),m(a,"class","slider-outer-wrapper is-flex flex-direction-row svelte-216mtn")},m(w,S){C(w,e,S),_(e,t),_(t,i),_(t,s),_(t,r),_(t,l),_(e,o),_(e,a),_(a,c),_(c,u),_(a,h),_(a,f),_(f,d),_(a,p),_(a,g),_(g,v)},p(w,[S]){S&4&&fe(i,w[2]),S&8&&fe(r,w[3]),S&1&&fe(u,w[0]),S&2&&fe(v,w[1])},i:j,o:j,d(w){w&&E(e)}}}function Gc(n,e,t){let i,{minVal:s}=e,{maxVal:r}=e,{start:l}=e,{step:o=void 0}=e,{roundTo:a=2}=e,{title:c=""}=e,{emitOnUpdate:u=!1}=e;const h=Kt(),f=`slider-${window.crypto.randomUUID()}`,d=Array.isArray(l)&&l.length===2&&l.every(y=>!isNaN(parseFloat(y))),p=[],g=d?[`noUi-handle-${window.crypto.randomUUID()}`,`noUi-handle-${window.crypto.randomUUID()}`]:[`noUi-handle-${window.crypto.randomUUID()}`],v=$n();v.setCompareFn(d?yi:(y,F)=>S(y)===S(F)),v.set(l);const w=Je("resetTrigger")||void 0;w==null||w.subscribe(I);const S=y=>Number(y.toFixed(a)),P=(y,F)=>{y=Array.isArray(y)?y.map(S):S(y),t(3,i=y),(F==="set"||F==="update"&&u)&&(v.set(y),v.same()||h("updateSlider",v.get()))};function T(y){p.length&&p.map((F,K)=>F.$set({tooltipText:d?y[K]:y}))}function I(){const y=document.getElementById(f);y!=null&&y.noUiSlider&&y.noUiSlider.reset()}function L(){const y=document.getElementById(f);let F;Kc.create(y,{start:l,step:o,connect:d?!0:"lower",range:{min:s,max:r},handleAttributes:g.map(K=>({id:K}))}),y.noUiSlider.on("update",()=>{F=y.noUiSlider.get(!0),P(F,"update")}),y.noUiSlider.on("set",()=>{F=y.noUiSlider.get(!0),P(F,"set")})}function A(){g.map((y,F)=>{p.push(new pn({target:document.getElementById(y),props:d?{tooltipText:i[F]}:{tooltipText:i}}))})}return rt(()=>{L(),A()}),hn(()=>{document.getElementById(f)&&(document.getElementById(f).innerHTML="")}),n.$$set=y=>{"minVal"in y&&t(0,s=y.minVal),"maxVal"in y&&t(1,r=y.maxVal),"start"in y&&t(5,l=y.start),"step"in y&&t(6,o=y.step),"roundTo"in y&&t(7,a=y.roundTo),"title"in y&&t(2,c=y.title),"emitOnUpdate"in y&&t(8,u=y.emitOnUpdate)},n.$$.update=()=>{n.$$.dirty&32&&t(3,i=l),n.$$.dirty&8&&T(i)},[s,r,c,i,f,l,o,a,u]}class Et extends ae{constructor(e){super(),oe(this,e,Gc,Wc,le,{minVal:0,maxVal:1,start:5,step:6,roundTo:7,title:2,emitOnUpdate:8})}}/*! choices.js v11.1.0 | © 2025 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var ai=function(n,e){return ai=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])},ai(n,e)};function Sl(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ai(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var We=function(){return We=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},We.apply(this,arguments)};function Yc(n,e,t){if(t||arguments.length===2)for(var i=0,s=e.length,r;i<s;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))}var Ae={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},Ke={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},Ne={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},xc=["fuseOptions","classNames"],_t={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},Ls=function(n){return{type:Ae.ADD_CHOICE,choice:n}},Jc=function(n){return{type:Ae.REMOVE_CHOICE,choice:n}},Xc=function(n){return{type:Ae.FILTER_CHOICES,results:n}},Qc=function(n){return{type:Ae.ACTIVATE_CHOICES,active:n}},Zc=function(n){return{type:Ae.ADD_GROUP,group:n}},Rs=function(n){return{type:Ae.ADD_ITEM,item:n}},$s=function(n){return{type:Ae.REMOVE_ITEM,item:n}},Cn=function(n,e){return{type:Ae.HIGHLIGHT_ITEM,item:n,highlighted:e}},eu=function(n,e){return Math.floor(Math.random()*(e-n)+n)},Ds=function(n){return Array.from({length:n},function(){return eu(0,36).toString(36)}).join("")},tu=function(n,e){var t=n.id||n.name&&"".concat(n.name,"-").concat(Ds(2))||Ds(4);return t=t.replace(/(:|\.|\[|\]|,)/g,""),t="".concat(e,"-").concat(t),t},nu=function(n,e,t){t===void 0&&(t=1);for(var i="".concat(t>0?"next":"previous","ElementSibling"),s=n[i];s;){if(s.matches(e))return s;s=s[i]}return null},iu=function(n,e,t){t===void 0&&(t=1);var i;return t>0?i=e.scrollTop+e.offsetHeight>=n.offsetTop+n.offsetHeight:i=n.offsetTop>=e.scrollTop,i},qn=function(n){if(typeof n!="string"){if(n==null)return"";if(typeof n=="object"){if("raw"in n)return qn(n.raw);if("trusted"in n)return n.trusted}return n}return n.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},su=function(){var n=document.createElement("div");return function(e){n.innerHTML=e.trim();for(var t=n.children[0];n.firstChild;)n.removeChild(n.firstChild);return t}}(),an=function(n,e){return typeof n=="function"?n(qn(e),e):n},Ns=function(n){return typeof n=="function"?n():n},It=function(n){if(typeof n=="string")return n;if(typeof n=="object"){if("trusted"in n)return n.trusted;if("raw"in n)return n.raw}return""},El=function(n){if(typeof n=="string")return n;if(typeof n=="object"){if("escaped"in n)return n.escaped;if("trusted"in n)return n.trusted}return""},Ii=function(n,e){return n?El(e):qn(e)},ot=function(n,e,t){n.innerHTML=Ii(e,t)},ru=function(n,e){var t=n.value,i=n.label,s=i===void 0?t:i,r=e.value,l=e.label,o=l===void 0?r:l;return It(s).localeCompare(It(o),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},lu=function(n,e){return n.rank-e.rank},ou=function(n,e,t){t===void 0&&(t=null);var i=new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0});return n.dispatchEvent(i)},au=function(n,e){var t=Object.keys(n).sort(),i=Object.keys(e).sort();return t.filter(function(s){return i.indexOf(s)<0})},Bn=function(n){return Array.isArray(n)?n:[n]},sn=function(n){return n&&Array.isArray(n)?n.map(function(e){return".".concat(e)}).join(""):".".concat(n)},de=function(n,e){var t;(t=n.classList).add.apply(t,Bn(e))},nt=function(n,e){var t;(t=n.classList).remove.apply(t,Bn(e))},cu=function(n){if(typeof n<"u")try{return JSON.parse(n)}catch{return n}return{}},uu=function(n,e,t){var i=n.itemEl;i&&(nt(i,t),de(i,e))},fu=function(){function n(e){var t=e.element,i=e.type,s=e.classNames;this.element=t,this.classNames=s,this.type=i,this.isActive=!1}return n.prototype.show=function(){return de(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},n.prototype.hide=function(){return nt(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},n}(),js=function(){function n(e){var t=e.element,i=e.type,s=e.classNames,r=e.position;this.element=t,this.classNames=s,this.type=i,this.position=r,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return n.prototype.shouldFlip=function(e,t){var i=!1;return this.position==="auto"?i=this.element.getBoundingClientRect().top-t>=0&&!window.matchMedia("(min-height: ".concat(e+1,"px)")).matches:this.position==="top"&&(i=!0),i},n.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},n.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},n.prototype.open=function(e,t){de(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e,t)&&(de(this.element,this.classNames.flippedState),this.isFlipped=!0)},n.prototype.close=function(){nt(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(nt(this.element,this.classNames.flippedState),this.isFlipped=!1)},n.prototype.addFocusState=function(){de(this.element,this.classNames.focusState)},n.prototype.removeFocusState=function(){nt(this.element,this.classNames.focusState)},n.prototype.enable=function(){nt(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===_t.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},n.prototype.disable=function(){de(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===_t.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},n.prototype.wrap=function(e){var t=this.element,i=e.parentNode;i&&(e.nextSibling?i.insertBefore(t,e.nextSibling):i.appendChild(t)),t.appendChild(e)},n.prototype.unwrap=function(e){var t=this.element,i=t.parentNode;i&&(i.insertBefore(e,t),i.removeChild(t))},n.prototype.addLoadingState=function(){de(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},n.prototype.removeLoadingState=function(){nt(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},n}(),du=function(){function n(e){var t=e.element,i=e.type,s=e.classNames,r=e.preventPaste;this.element=t,this.type=i,this.classNames=s,this.preventPaste=r,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=t.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(n.prototype,"placeholder",{set:function(e){this.element.placeholder=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!1,configurable:!0}),n.prototype.addEventListeners=function(){var e=this.element;e.addEventListener("paste",this._onPaste),e.addEventListener("input",this._onInput,{passive:!0}),e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})},n.prototype.removeEventListeners=function(){var e=this.element;e.removeEventListener("input",this._onInput),e.removeEventListener("paste",this._onPaste),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)},n.prototype.enable=function(){var e=this.element;e.removeAttribute("disabled"),this.isDisabled=!1},n.prototype.disable=function(){var e=this.element;e.setAttribute("disabled",""),this.isDisabled=!0},n.prototype.focus=function(){this.isFocussed||this.element.focus()},n.prototype.blur=function(){this.isFocussed&&this.element.blur()},n.prototype.clear=function(e){return e===void 0&&(e=!0),this.element.value="",e&&this.setWidth(),this},n.prototype.setWidth=function(){var e=this.element;e.style.minWidth="".concat(e.placeholder.length+1,"ch"),e.style.width="".concat(e.value.length+1,"ch")},n.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},n.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},n.prototype._onInput=function(){this.type!==_t.SelectOne&&this.setWidth()},n.prototype._onPaste=function(e){this.preventPaste&&e.preventDefault()},n.prototype._onFocus=function(){this.isFocussed=!0},n.prototype._onBlur=function(){this.isFocussed=!1},n}(),hu=4,Vs=function(){function n(e){var t=e.element;this.element=t,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return n.prototype.prepend=function(e){var t=this.element.firstElementChild;t?this.element.insertBefore(e,t):this.element.append(e)},n.prototype.scrollToTop=function(){this.element.scrollTop=0},n.prototype.scrollToChildElement=function(e,t){var i=this;if(e){var s=this.element.offsetHeight,r=this.element.scrollTop+s,l=e.offsetHeight,o=e.offsetTop+l,a=t>0?this.element.scrollTop+o-r:e.offsetTop;requestAnimationFrame(function(){i._animateScroll(a,t)})}},n.prototype._scrollDown=function(e,t,i){var s=(i-e)/t,r=s>1?s:1;this.element.scrollTop=e+r},n.prototype._scrollUp=function(e,t,i){var s=(e-i)/t,r=s>1?s:1;this.element.scrollTop=e-r},n.prototype._animateScroll=function(e,t){var i=this,s=hu,r=this.element.scrollTop,l=!1;t>0?(this._scrollDown(r,s,e),r<e&&(l=!0)):(this._scrollUp(r,s,e),r>e&&(l=!0)),l&&requestAnimationFrame(function(){i._animateScroll(e,t)})},n}(),Cl=function(){function n(e){var t=e.element,i=e.classNames;this.element=t,this.classNames=i,this.isDisabled=!1}return Object.defineProperty(n.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.setAttribute("value",e),this.element.value=e},enumerable:!1,configurable:!0}),n.prototype.conceal=function(){var e=this.element;de(e,this.classNames.input),e.hidden=!0,e.tabIndex=-1;var t=e.getAttribute("style");t&&e.setAttribute("data-choice-orig-style",t),e.setAttribute("data-choice","active")},n.prototype.reveal=function(){var e=this.element;nt(e,this.classNames.input),e.hidden=!1,e.removeAttribute("tabindex");var t=e.getAttribute("data-choice-orig-style");t?(e.removeAttribute("data-choice-orig-style"),e.setAttribute("style",t)):e.removeAttribute("style"),e.removeAttribute("data-choice")},n.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},n.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},n.prototype.triggerEvent=function(e,t){ou(this.element,e,t||{})},n}(),mu=function(n){Sl(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Cl),on=function(n,e){return e===void 0&&(e=!0),typeof n>"u"?e:!!n},Il=function(n){if(typeof n=="string"&&(n=n.split(" ").filter(function(e){return e.length})),Array.isArray(n)&&n.length)return n},tt=function(n,e,t){if(t===void 0&&(t=!0),typeof n=="string"){var i=qn(n),s=t||i===n?n:{escaped:i,raw:n},r=tt({value:n,label:s,selected:!0},!1);return r}var l=n;if("choices"in l){if(!e)throw new TypeError("optGroup is not allowed");var o=l,a=o.choices.map(function(f){return tt(f,!1)}),c={id:0,label:It(o.label)||o.value,active:!!a.length,disabled:!!o.disabled,choices:a};return c}var u=l,h={id:0,group:null,score:0,rank:0,value:u.value,label:u.label||u.value,active:on(u.active),selected:on(u.selected,!1),disabled:on(u.disabled,!1),placeholder:on(u.placeholder,!1),highlighted:!1,labelClass:Il(u.labelClass),labelDescription:u.labelDescription,customProperties:u.customProperties};return h},pu=function(n){return n.tagName==="INPUT"},Ol=function(n){return n.tagName==="SELECT"},gu=function(n){return n.tagName==="OPTION"},_u=function(n){return n.tagName==="OPTGROUP"},vu=function(n){Sl(e,n);function e(t){var i=t.element,s=t.classNames,r=t.template,l=t.extractPlaceholder,o=n.call(this,{element:i,classNames:s})||this;return o.template=r,o.extractPlaceholder=l,o}return Object.defineProperty(e.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),e.prototype.addOptions=function(t){var i=this,s=document.createDocumentFragment();t.forEach(function(r){var l=r;if(!l.element){var o=i.template(l);s.appendChild(o),l.element=o}}),this.element.appendChild(s)},e.prototype.optionsAsChoices=function(){var t=this,i=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(s){gu(s)?i.push(t._optionToChoice(s)):_u(s)&&i.push(t._optgroupToChoice(s))}),i},e.prototype._optionToChoice=function(t){return!t.hasAttribute("value")&&t.hasAttribute("placeholder")&&(t.setAttribute("value",""),t.value=""),{id:0,group:null,score:0,rank:0,value:t.value,label:t.label,element:t,active:!0,selected:this.extractPlaceholder?t.selected:t.hasAttribute("selected"),disabled:t.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!t.value||t.hasAttribute("placeholder")),labelClass:typeof t.dataset.labelClass<"u"?Il(t.dataset.labelClass):void 0,labelDescription:typeof t.dataset.labelDescription<"u"?t.dataset.labelDescription:void 0,customProperties:cu(t.dataset.customProperties)}},e.prototype._optgroupToChoice=function(t){var i=this,s=t.querySelectorAll("option"),r=Array.from(s).map(function(l){return i._optionToChoice(l)});return{id:0,label:t.label||"",element:t,active:!!r.length,disabled:t.disabled,choices:r}},e}(Cl),bu={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},Fs={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(n){return!!n&&n!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:ru,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(n){return'Press Enter to add <b>"'.concat(n,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(n){return"Remove item: ".concat(n)},maxItemText:function(n){return"Only ".concat(n," values can be added")},valueComparer:function(n,e){return n===e},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:bu,appendGroupInSearch:!1},Us=function(n){var e=n.itemEl;e&&(e.remove(),n.itemEl=void 0)};function wu(n,e,t){var i=n,s=!0;switch(e.type){case Ae.ADD_ITEM:{e.item.selected=!0;var r=e.item.element;r&&(r.selected=!0,r.setAttribute("selected","")),i.push(e.item);break}case Ae.REMOVE_ITEM:{e.item.selected=!1;var r=e.item.element;if(r){r.selected=!1,r.removeAttribute("selected");var l=r.parentElement;l&&Ol(l)&&l.type===_t.SelectOne&&(l.value="")}Us(e.item),i=i.filter(function(u){return u.id!==e.item.id});break}case Ae.REMOVE_CHOICE:{Us(e.choice),i=i.filter(function(c){return c.id!==e.choice.id});break}case Ae.HIGHLIGHT_ITEM:{var o=e.highlighted,a=i.find(function(c){return c.id===e.item.id});a&&a.highlighted!==o&&(a.highlighted=o,t&&uu(a,o?t.classNames.highlightedState:t.classNames.selectedState,o?t.classNames.selectedState:t.classNames.highlightedState));break}default:{s=!1;break}}return{state:i,update:s}}function yu(n,e){var t=n,i=!0;switch(e.type){case Ae.ADD_GROUP:{t.push(e.group);break}case Ae.CLEAR_CHOICES:{t=[];break}default:{i=!1;break}}return{state:t,update:i}}function ku(n,e,t){var i=n,s=!0;switch(e.type){case Ae.ADD_CHOICE:{i.push(e.choice);break}case Ae.REMOVE_CHOICE:{e.choice.choiceEl=void 0,e.choice.group&&(e.choice.group.choices=e.choice.group.choices.filter(function(l){return l.id!==e.choice.id})),i=i.filter(function(l){return l.id!==e.choice.id});break}case Ae.ADD_ITEM:case Ae.REMOVE_ITEM:{e.item.choiceEl=void 0;break}case Ae.FILTER_CHOICES:{var r=[];e.results.forEach(function(l){r[l.item.id]=l}),i.forEach(function(l){var o=r[l.id];o!==void 0?(l.score=o.score,l.rank=o.rank,l.active=!0):(l.score=0,l.rank=0,l.active=!1),t&&t.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ae.ACTIVATE_CHOICES:{i.forEach(function(l){l.active=e.active,t&&t.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ae.CLEAR_CHOICES:{i=[];break}default:{s=!1;break}}return{state:i,update:s}}var Hs={groups:yu,items:wu,choices:ku},Su=function(){function n(e){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=e}return Object.defineProperty(n.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),n.prototype.changeSet=function(e){return{groups:e,items:e,choices:e}},n.prototype.reset=function(){this._state=this.defaultState;var e=this.changeSet(!0);this._txn?this._changeSet=e:this._listeners.forEach(function(t){return t(e)})},n.prototype.subscribe=function(e){return this._listeners.push(e),this},n.prototype.dispatch=function(e){var t=this,i=this._state,s=!1,r=this._changeSet||this.changeSet(!1);Object.keys(Hs).forEach(function(l){var o=Hs[l](i[l],e,t._context);o.update&&(s=!0,r[l]=!0,i[l]=o.state)}),s&&(this._txn?this._changeSet=r:this._listeners.forEach(function(l){return l(r)}))},n.prototype.withTxn=function(e){this._txn++;try{e()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var t=this._changeSet;t&&(this._changeSet=void 0,this._listeners.forEach(function(i){return i(t)}))}}},Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(e){return e.active&&e.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"activeChoices",{get:function(){return this.choices.filter(function(e){return e.active})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(e){return!e.disabled&&!e.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"activeGroups",{get:function(){var e=this;return this.state.groups.filter(function(t){var i=t.active&&!t.disabled,s=e.state.choices.some(function(r){return r.active&&!r.disabled});return i&&s},[])},enumerable:!1,configurable:!0}),n.prototype.inTxn=function(){return this._txn>0},n.prototype.getChoiceById=function(e){return this.activeChoices.find(function(t){return t.id===e})},n.prototype.getGroupById=function(e){return this.groups.find(function(t){return t.id===e})},n}(),Le={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Eu(n,e,t){return(e=Iu(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qs(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Lt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?qs(Object(t),!0).forEach(function(i){Eu(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):qs(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Cu(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Iu(n){var e=Cu(n,"string");return typeof e=="symbol"?e:e+""}function ht(n){return Array.isArray?Array.isArray(n):Ml(n)==="[object Array]"}const Ou=1/0;function Au(n){if(typeof n=="string")return n;let e=n+"";return e=="0"&&1/n==-Ou?"-0":e}function Tu(n){return n==null?"":Au(n)}function it(n){return typeof n=="string"}function Al(n){return typeof n=="number"}function Mu(n){return n===!0||n===!1||Pu(n)&&Ml(n)=="[object Boolean]"}function Tl(n){return typeof n=="object"}function Pu(n){return Tl(n)&&n!==null}function Ge(n){return n!=null}function ti(n){return!n.trim().length}function Ml(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}const Lu="Incorrect 'index' type",Ru=n=>`Invalid value for key ${n}`,$u=n=>`Pattern length exceeds max of ${n}.`,Du=n=>`Missing ${n} property in key`,Nu=n=>`Property 'weight' in key '${n}' must be a positive integer`,Bs=Object.prototype.hasOwnProperty;class ju{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(i=>{let s=Pl(i);this._keys.push(s),this._keyMap[s.id]=s,t+=s.weight}),this._keys.forEach(i=>{i.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Pl(n){let e=null,t=null,i=null,s=1,r=null;if(it(n)||ht(n))i=n,e=zs(n),t=ci(n);else{if(!Bs.call(n,"name"))throw new Error(Du("name"));const l=n.name;if(i=l,Bs.call(n,"weight")&&(s=n.weight,s<=0))throw new Error(Nu(l));e=zs(l),t=ci(l),r=n.getFn}return{path:e,id:t,weight:s,src:i,getFn:r}}function zs(n){return ht(n)?n:n.split(".")}function ci(n){return ht(n)?n.join("."):n}function Vu(n,e){let t=[],i=!1;const s=(r,l,o)=>{if(Ge(r))if(!l[o])t.push(r);else{let a=l[o];const c=r[a];if(!Ge(c))return;if(o===l.length-1&&(it(c)||Al(c)||Mu(c)))t.push(Tu(c));else if(ht(c)){i=!0;for(let u=0,h=c.length;u<h;u+=1)s(c[u],l,o+1)}else l.length&&s(c,l,o+1)}};return s(n,it(e)?e.split("."):e,0),i?t:t[0]}const Fu={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Uu={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(n,e)=>n.score===e.score?n.idx<e.idx?-1:1:n.score<e.score?-1:1},Hu={location:0,threshold:.6,distance:100},qu={useExtendedSearch:!1,getFn:Vu,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var ce=Lt(Lt(Lt(Lt({},Uu),Fu),Hu),qu);const Bu=/[^ ]+/g;function zu(n=1,e=3){const t=new Map,i=Math.pow(10,e);return{get(s){const r=s.match(Bu).length;if(t.has(r))return t.get(r);const l=1/Math.pow(r,.5*n),o=parseFloat(Math.round(l*i)/i);return t.set(r,o),o},clear(){t.clear()}}}class Oi{constructor({getFn:e=ce.getFn,fieldNormWeight:t=ce.fieldNormWeight}={}){this.norm=zu(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,i)=>{this._keysMap[t.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,it(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();it(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,i=this.size();t<i;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Ge(e)||ti(e))return;let i={v:e,i:t,n:this.norm.get(e)};this.records.push(i)}_addObject(e,t){let i={i:t,$:{}};this.keys.forEach((s,r)=>{let l=s.getFn?s.getFn(e):this.getFn(e,s.path);if(Ge(l)){if(ht(l)){let o=[];const a=[{nestedArrIndex:-1,value:l}];for(;a.length;){const{nestedArrIndex:c,value:u}=a.pop();if(Ge(u))if(it(u)&&!ti(u)){let h={v:u,i:c,n:this.norm.get(u)};o.push(h)}else ht(u)&&u.forEach((h,f)=>{a.push({nestedArrIndex:f,value:h})})}i.$[r]=o}else if(it(l)&&!ti(l)){let o={v:l,n:this.norm.get(l)};i.$[r]=o}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function Ll(n,e,{getFn:t=ce.getFn,fieldNormWeight:i=ce.fieldNormWeight}={}){const s=new Oi({getFn:t,fieldNormWeight:i});return s.setKeys(n.map(Pl)),s.setSources(e),s.create(),s}function Ku(n,{getFn:e=ce.getFn,fieldNormWeight:t=ce.fieldNormWeight}={}){const{keys:i,records:s}=n,r=new Oi({getFn:e,fieldNormWeight:t});return r.setKeys(i),r.setIndexRecords(s),r}function In(n,{errors:e=0,currentLocation:t=0,expectedLocation:i=0,distance:s=ce.distance,ignoreLocation:r=ce.ignoreLocation}={}){const l=e/n.length;if(r)return l;const o=Math.abs(i-t);return s?l+o/s:o?1:l}function Wu(n=[],e=ce.minMatchCharLength){let t=[],i=-1,s=-1,r=0;for(let l=n.length;r<l;r+=1){let o=n[r];o&&i===-1?i=r:!o&&i!==-1&&(s=r-1,s-i+1>=e&&t.push([i,s]),i=-1)}return n[r-1]&&r-i>=e&&t.push([i,r-1]),t}const Ct=32;function Gu(n,e,t,{location:i=ce.location,distance:s=ce.distance,threshold:r=ce.threshold,findAllMatches:l=ce.findAllMatches,minMatchCharLength:o=ce.minMatchCharLength,includeMatches:a=ce.includeMatches,ignoreLocation:c=ce.ignoreLocation}={}){if(e.length>Ct)throw new Error($u(Ct));const u=e.length,h=n.length,f=Math.max(0,Math.min(i,h));let d=r,p=f;const g=o>1||a,v=g?Array(h):[];let w;for(;(w=n.indexOf(e,p))>-1;){let A=In(e,{currentLocation:w,expectedLocation:f,distance:s,ignoreLocation:c});if(d=Math.min(A,d),p=w+u,g){let y=0;for(;y<u;)v[w+y]=1,y+=1}}p=-1;let S=[],P=1,T=u+h;const I=1<<u-1;for(let A=0;A<u;A+=1){let y=0,F=T;for(;y<F;)In(e,{errors:A,currentLocation:f+F,expectedLocation:f,distance:s,ignoreLocation:c})<=d?y=F:T=F,F=Math.floor((T-y)/2+y);T=F;let K=Math.max(1,f-F+1),re=l?h:Math.min(f+F,h)+u,U=Array(re+2);U[re+1]=(1<<A)-1;for(let Z=re;Z>=K;Z-=1){let V=Z-1,H=t[n.charAt(V)];if(g&&(v[V]=+!!H),U[Z]=(U[Z+1]<<1|1)&H,A&&(U[Z]|=(S[Z+1]|S[Z])<<1|1|S[Z+1]),U[Z]&I&&(P=In(e,{errors:A,currentLocation:V,expectedLocation:f,distance:s,ignoreLocation:c}),P<=d)){if(d=P,p=V,p<=f)break;K=Math.max(1,2*f-p)}}if(In(e,{errors:A+1,currentLocation:f,expectedLocation:f,distance:s,ignoreLocation:c})>d)break;S=U}const L={isMatch:p>=0,score:Math.max(.001,P)};if(g){const A=Wu(v,o);A.length?a&&(L.indices=A):L.isMatch=!1}return L}function Yu(n){let e={};for(let t=0,i=n.length;t<i;t+=1){const s=n.charAt(t);e[s]=(e[s]||0)|1<<i-t-1}return e}class Rl{constructor(e,{location:t=ce.location,threshold:i=ce.threshold,distance:s=ce.distance,includeMatches:r=ce.includeMatches,findAllMatches:l=ce.findAllMatches,minMatchCharLength:o=ce.minMatchCharLength,isCaseSensitive:a=ce.isCaseSensitive,ignoreLocation:c=ce.ignoreLocation}={}){if(this.options={location:t,threshold:i,distance:s,includeMatches:r,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(f,d)=>{this.chunks.push({pattern:f,alphabet:Yu(f),startIndex:d})},h=this.pattern.length;if(h>Ct){let f=0;const d=h%Ct,p=h-d;for(;f<p;)u(this.pattern.substr(f,Ct),f),f+=Ct;if(d){const g=h-Ct;u(this.pattern.substr(g),g)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,includeMatches:i}=this.options;if(t||(e=e.toLowerCase()),this.pattern===e){let p={isMatch:!0,score:0};return i&&(p.indices=[[0,e.length-1]]),p}const{location:s,distance:r,threshold:l,findAllMatches:o,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],h=0,f=!1;this.chunks.forEach(({pattern:p,alphabet:g,startIndex:v})=>{const{isMatch:w,score:S,indices:P}=Gu(e,p,g,{location:s+v,distance:r,threshold:l,findAllMatches:o,minMatchCharLength:a,includeMatches:i,ignoreLocation:c});w&&(f=!0),h+=S,w&&P&&(u=[...u,...P])});let d={isMatch:f,score:f?h/this.chunks.length:1};return f&&i&&(d.indices=u),d}}class yt{constructor(e){this.pattern=e}static isMultiMatch(e){return Ks(e,this.multiRegex)}static isSingleMatch(e){return Ks(e,this.singleRegex)}search(){}}function Ks(n,e){const t=n.match(e);return t?t[1]:null}class xu extends yt{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Ju extends yt{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const i=e.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class Xu extends yt{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Qu extends yt{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class Zu extends yt{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class ef extends yt{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class $l extends yt{constructor(e,{location:t=ce.location,threshold:i=ce.threshold,distance:s=ce.distance,includeMatches:r=ce.includeMatches,findAllMatches:l=ce.findAllMatches,minMatchCharLength:o=ce.minMatchCharLength,isCaseSensitive:a=ce.isCaseSensitive,ignoreLocation:c=ce.ignoreLocation}={}){super(e),this._bitapSearch=new Rl(e,{location:t,threshold:i,distance:s,includeMatches:r,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Dl extends yt{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,i;const s=[],r=this.pattern.length;for(;(i=e.indexOf(this.pattern,t))>-1;)t=i+r,s.push([i,t-1]);const l=!!s.length;return{isMatch:l,score:l?0:1,indices:s}}}const ui=[xu,Dl,Xu,Qu,ef,Zu,Ju,$l],Ws=ui.length,tf=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,nf="|";function sf(n,e={}){return n.split(nf).map(t=>{let i=t.trim().split(tf).filter(r=>r&&!!r.trim()),s=[];for(let r=0,l=i.length;r<l;r+=1){const o=i[r];let a=!1,c=-1;for(;!a&&++c<Ws;){const u=ui[c];let h=u.isMultiMatch(o);h&&(s.push(new u(h,e)),a=!0)}if(!a)for(c=-1;++c<Ws;){const u=ui[c];let h=u.isSingleMatch(o);if(h){s.push(new u(h,e));break}}}return s})}const rf=new Set([$l.type,Dl.type]);class lf{constructor(e,{isCaseSensitive:t=ce.isCaseSensitive,includeMatches:i=ce.includeMatches,minMatchCharLength:s=ce.minMatchCharLength,ignoreLocation:r=ce.ignoreLocation,findAllMatches:l=ce.findAllMatches,location:o=ce.location,threshold:a=ce.threshold,distance:c=ce.distance}={}){this.query=null,this.options={isCaseSensitive:t,includeMatches:i,minMatchCharLength:s,findAllMatches:l,ignoreLocation:r,location:o,threshold:a,distance:c},this.pattern=t?e:e.toLowerCase(),this.query=sf(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:s}=this.options;e=s?e:e.toLowerCase();let r=0,l=[],o=0;for(let a=0,c=t.length;a<c;a+=1){const u=t[a];l.length=0,r=0;for(let h=0,f=u.length;h<f;h+=1){const d=u[h],{isMatch:p,indices:g,score:v}=d.search(e);if(p){if(r+=1,o+=v,i){const w=d.constructor.type;rf.has(w)?l=[...l,...g]:l.push(g)}}else{o=0,r=0,l.length=0;break}}if(r){let h={isMatch:!0,score:o/r};return i&&(h.indices=l),h}}return{isMatch:!1,score:1}}}const fi=[];function of(...n){fi.push(...n)}function di(n,e){for(let t=0,i=fi.length;t<i;t+=1){let s=fi[t];if(s.condition(n,e))return new s(n,e)}return new Rl(n,e)}const jn={AND:"$and",OR:"$or"},hi={PATH:"$path",PATTERN:"$val"},mi=n=>!!(n[jn.AND]||n[jn.OR]),af=n=>!!n[hi.PATH],cf=n=>!ht(n)&&Tl(n)&&!mi(n),Gs=n=>({[jn.AND]:Object.keys(n).map(e=>({[e]:n[e]}))});function Nl(n,e,{auto:t=!0}={}){const i=s=>{let r=Object.keys(s);const l=af(s);if(!l&&r.length>1&&!mi(s))return i(Gs(s));if(cf(s)){const a=l?s[hi.PATH]:r[0],c=l?s[hi.PATTERN]:s[a];if(!it(c))throw new Error(Ru(a));const u={keyId:ci(a),pattern:c};return t&&(u.searcher=di(c,e)),u}let o={children:[],operator:r[0]};return r.forEach(a=>{const c=s[a];ht(c)&&c.forEach(u=>{o.children.push(i(u))})}),o};return mi(n)||(n=Gs(n)),i(n)}function uf(n,{ignoreFieldNorm:e=ce.ignoreFieldNorm}){n.forEach(t=>{let i=1;t.matches.forEach(({key:s,norm:r,score:l})=>{const o=s?s.weight:null;i*=Math.pow(l===0&&o?Number.EPSILON:l,(o||1)*(e?1:r))}),t.score=i})}function ff(n,e){const t=n.matches;e.matches=[],Ge(t)&&t.forEach(i=>{if(!Ge(i.indices)||!i.indices.length)return;const{indices:s,value:r}=i;let l={indices:s,value:r};i.key&&(l.key=i.key.src),i.idx>-1&&(l.refIndex=i.idx),e.matches.push(l)})}function df(n,e){e.score=n.score}function hf(n,e,{includeMatches:t=ce.includeMatches,includeScore:i=ce.includeScore}={}){const s=[];return t&&s.push(ff),i&&s.push(df),n.map(r=>{const{idx:l}=r,o={item:e[l],refIndex:l};return s.length&&s.forEach(a=>{a(r,o)}),o})}class Wt{constructor(e,t={},i){this.options=Lt(Lt({},ce),t),this.options.useExtendedSearch,this._keyStore=new ju(this.options.keys),this.setCollection(e,i)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof Oi))throw new Error(Lu);this._myIndex=t||Ll(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Ge(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let i=0,s=this._docs.length;i<s;i+=1){const r=this._docs[i];e(r,i)&&(this.removeAt(i),i-=1,s-=1,t.push(r))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:i,includeScore:s,shouldSort:r,sortFn:l,ignoreFieldNorm:o}=this.options;let a=it(e)?it(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return uf(a,{ignoreFieldNorm:o}),r&&a.sort(l),Al(t)&&t>-1&&(a=a.slice(0,t)),hf(a,this._docs,{includeMatches:i,includeScore:s})}_searchStringList(e){const t=di(e,this.options),{records:i}=this._myIndex,s=[];return i.forEach(({v:r,i:l,n:o})=>{if(!Ge(r))return;const{isMatch:a,score:c,indices:u}=t.searchIn(r);a&&s.push({item:r,idx:l,matches:[{score:c,value:r,norm:o,indices:u}]})}),s}_searchLogical(e){const t=Nl(e,this.options),i=(o,a,c)=>{if(!o.children){const{keyId:h,searcher:f}=o,d=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(a,h),searcher:f});return d&&d.length?[{idx:c,item:a,matches:d}]:[]}const u=[];for(let h=0,f=o.children.length;h<f;h+=1){const d=o.children[h],p=i(d,a,c);if(p.length)u.push(...p);else if(o.operator===jn.AND)return[]}return u},s=this._myIndex.records,r={},l=[];return s.forEach(({$:o,i:a})=>{if(Ge(o)){let c=i(t,o,a);c.length&&(r[a]||(r[a]={idx:a,item:o,matches:[]},l.push(r[a])),c.forEach(({matches:u})=>{r[a].matches.push(...u)}))}}),l}_searchObjectList(e){const t=di(e,this.options),{keys:i,records:s}=this._myIndex,r=[];return s.forEach(({$:l,i:o})=>{if(!Ge(l))return;let a=[];i.forEach((c,u)=>{a.push(...this._findMatches({key:c,value:l[u],searcher:t}))}),a.length&&r.push({idx:o,item:l,matches:a})}),r}_findMatches({key:e,value:t,searcher:i}){if(!Ge(t))return[];let s=[];if(ht(t))t.forEach(({v:r,i:l,n:o})=>{if(!Ge(r))return;const{isMatch:a,score:c,indices:u}=i.searchIn(r);a&&s.push({score:c,key:e,value:r,idx:l,norm:o,indices:u})});else{const{v:r,n:l}=t,{isMatch:o,score:a,indices:c}=i.searchIn(r);o&&s.push({score:a,key:e,value:r,norm:l,indices:c})}return s}}Wt.version="7.0.0";Wt.createIndex=Ll;Wt.parseIndex=Ku;Wt.config=ce;Wt.parseQuery=Nl;of(lf);var mf=function(){function n(e){this._haystack=[],this._fuseOptions=We(We({},e.fuseOptions),{keys:Yc([],e.searchFields,!0),includeMatches:!0})}return n.prototype.index=function(e){this._haystack=e,this._fuse&&this._fuse.setCollection(e)},n.prototype.reset=function(){this._haystack=[],this._fuse=void 0},n.prototype.isEmptyIndex=function(){return!this._haystack.length},n.prototype.search=function(e){this._fuse||(this._fuse=new Wt(this._haystack,this._fuseOptions));var t=this._fuse.search(e);return t.map(function(i,s){return{item:i.item,score:i.score||0,rank:s+1}})},n}();function pf(n){return new mf(n)}var gf=function(n){for(var e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0},ni=function(n,e,t){var i=n.dataset,s=e.customProperties,r=e.labelClass,l=e.labelDescription;r&&(i.labelClass=Bn(r).join(" ")),l&&(i.labelDescription=l),t&&s&&(typeof s=="string"?i.customProperties=s:typeof s=="object"&&!gf(s)&&(i.customProperties=JSON.stringify(s)))},Ys=function(n,e,t){var i=e&&n.querySelector("label[for='".concat(e,"']")),s=i&&i.innerText;s&&t.setAttribute("aria-label",s)},_f={containerOuter:function(n,e,t,i,s,r,l){var o=n.classNames.containerOuter,a=document.createElement("div");return de(a,o),a.dataset.type=r,e&&(a.dir=e),i&&(a.tabIndex=0),t&&(a.setAttribute("role",s?"combobox":"listbox"),s?a.setAttribute("aria-autocomplete","list"):l||Ys(this._docRoot,this.passedElement.element.id,a),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false")),l&&a.setAttribute("aria-labelledby",l),a},containerInner:function(n){var e=n.classNames.containerInner,t=document.createElement("div");return de(t,e),t},itemList:function(n,e){var t=n.searchEnabled,i=n.classNames,s=i.list,r=i.listSingle,l=i.listItems,o=document.createElement("div");return de(o,s),de(o,e?r:l),this._isSelectElement&&t&&o.setAttribute("role","listbox"),o},placeholder:function(n,e){var t=n.allowHTML,i=n.classNames.placeholder,s=document.createElement("div");return de(s,i),ot(s,t,e),s},item:function(n,e,t){var i=n.allowHTML,s=n.removeItemButtonAlignLeft,r=n.removeItemIconText,l=n.removeItemLabelText,o=n.classNames,a=o.item,c=o.button,u=o.highlightedState,h=o.itemSelectable,f=o.placeholder,d=It(e.value),p=document.createElement("div");if(de(p,a),e.labelClass){var g=document.createElement("span");ot(g,i,e.label),de(g,e.labelClass),p.appendChild(g)}else ot(p,i,e.label);if(p.dataset.item="",p.dataset.id=e.id,p.dataset.value=d,ni(p,e,!0),(e.disabled||this.containerOuter.isDisabled)&&p.setAttribute("aria-disabled","true"),this._isSelectElement&&(p.setAttribute("aria-selected","true"),p.setAttribute("role","option")),e.placeholder&&(de(p,f),p.dataset.placeholder=""),de(p,e.highlighted?u:h),t){e.disabled&&nt(p,h),p.dataset.deletable="";var v=document.createElement("button");v.type="button",de(v,c),ot(v,!0,an(r,e.value));var w=an(l,e.value);w&&v.setAttribute("aria-label",w),v.dataset.button="",s?p.insertAdjacentElement("afterbegin",v):p.appendChild(v)}return p},choiceList:function(n,e){var t=n.classNames.list,i=document.createElement("div");return de(i,t),e||i.setAttribute("aria-multiselectable","true"),i.setAttribute("role","listbox"),i},choiceGroup:function(n,e){var t=n.allowHTML,i=n.classNames,s=i.group,r=i.groupHeading,l=i.itemDisabled,o=e.id,a=e.label,c=e.disabled,u=It(a),h=document.createElement("div");de(h,s),c&&de(h,l),h.setAttribute("role","group"),h.dataset.group="",h.dataset.id=o,h.dataset.value=u,c&&h.setAttribute("aria-disabled","true");var f=document.createElement("div");return de(f,r),ot(f,t,a||""),h.appendChild(f),h},choice:function(n,e,t,i){var s=n.allowHTML,r=n.classNames,l=r.item,o=r.itemChoice,a=r.itemSelectable,c=r.selectedState,u=r.itemDisabled,h=r.description,f=r.placeholder,d=e.label,p=It(e.value),g=document.createElement("div");g.id=e.elementId,de(g,l),de(g,o),i&&typeof d=="string"&&(d=Ii(s,d),d+=" (".concat(i,")"),d={trusted:d});var v=g;if(e.labelClass){var w=document.createElement("span");ot(w,s,d),de(w,e.labelClass),v=w,g.appendChild(w)}else ot(g,s,d);if(e.labelDescription){var S="".concat(e.elementId,"-description");v.setAttribute("aria-describedby",S);var P=document.createElement("span");ot(P,s,e.labelDescription),P.id=S,de(P,h),g.appendChild(P)}return e.selected&&de(g,c),e.placeholder&&de(g,f),g.setAttribute("role",e.group?"treeitem":"option"),g.dataset.choice="",g.dataset.id=e.id,g.dataset.value=p,t&&(g.dataset.selectText=t),e.group&&(g.dataset.groupId="".concat(e.group.id)),ni(g,e,!1),e.disabled?(de(g,u),g.dataset.choiceDisabled="",g.setAttribute("aria-disabled","true")):(de(g,a),g.dataset.choiceSelectable=""),g},input:function(n,e){var t=n.classNames,i=t.input,s=t.inputCloned,r=n.labelId,l=document.createElement("input");return l.type="search",de(l,i),de(l,s),l.autocomplete="off",l.autocapitalize="off",l.spellcheck=!1,l.setAttribute("aria-autocomplete","list"),e?l.setAttribute("aria-label",e):r||Ys(this._docRoot,this.passedElement.element.id,l),l},dropdown:function(n){var e=n.classNames,t=e.list,i=e.listDropdown,s=document.createElement("div");return de(s,t),de(s,i),s.setAttribute("aria-expanded","false"),s},notice:function(n,e,t){var i=n.classNames,s=i.item,r=i.itemChoice,l=i.addChoice,o=i.noResults,a=i.noChoices,c=i.notice;t===void 0&&(t=Le.generic);var u=document.createElement("div");switch(ot(u,!0,e),de(u,s),de(u,r),de(u,c),t){case Le.addChoice:de(u,l);break;case Le.noResults:de(u,o);break;case Le.noChoices:de(u,a);break}return t===Le.addChoice&&(u.dataset.choiceSelectable="",u.dataset.choice=""),u},option:function(n){var e=It(n.label),t=new Option(e,n.value,!1,n.selected);return ni(t,n,!0),t.disabled=n.disabled,n.selected&&t.setAttribute("selected",""),t}},vf="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,bf={},ii=function(n){if(n)return n.dataset.id?parseInt(n.dataset.id,10):void 0},rn="[data-choice-selectable]",wf=function(){function n(e,t){e===void 0&&(e="[data-choice]"),t===void 0&&(t={});var i=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var s=n.defaults;this.config=We(We(We({},s.allOptions),s.options),t),xc.forEach(function(w){i.config[w]=We(We(We({},s.allOptions[w]),s.options[w]),t[w])});var r=this.config;r.silent||this._validateConfig();var l=r.shadowRoot||document.documentElement;this._docRoot=l;var o=typeof e=="string"?l.querySelector(e):e;if(!o||typeof o!="object"||!(pu(o)||Ol(o)))throw TypeError(!o&&typeof e=="string"?"Selector ".concat(e," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var a=o.type,c=a===_t.Text;(c||r.maxItemCount!==1)&&(r.singleModeForMultiSelect=!1),r.singleModeForMultiSelect&&(a=_t.SelectMultiple);var u=a===_t.SelectOne,h=a===_t.SelectMultiple,f=u||h;if(this._elementType=a,this._isTextElement=c,this._isSelectOneElement=u,this._isSelectMultipleElement=h,this._isSelectElement=u||h,this._canAddUserChoices=c&&r.addItems||f&&r.addChoices,typeof r.renderSelectedChoices!="boolean"&&(r.renderSelectedChoices=r.renderSelectedChoices==="always"||u),r.closeDropdownOnSelect==="auto"?r.closeDropdownOnSelect=c||u||r.singleModeForMultiSelect:r.closeDropdownOnSelect=on(r.closeDropdownOnSelect),r.placeholder&&(r.placeholderValue?this._hasNonChoicePlaceholder=!0:o.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,r.placeholderValue=o.dataset.placeholder)),t.addItemFilter&&typeof t.addItemFilter!="function"){var d=t.addItemFilter instanceof RegExp?t.addItemFilter:new RegExp(t.addItemFilter);r.addItemFilter=d.test.bind(d)}if(this._isTextElement)this.passedElement=new mu({element:o,classNames:r.classNames});else{var p=o;this.passedElement=new vu({element:p,classNames:r.classNames,template:function(w){return i._templates.option(w)},extractPlaceholder:r.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Su(r),this._currentValue="",r.searchEnabled=!c&&r.searchEnabled||h,this._canSearch=r.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=tu(o,"choices-"),this._direction=o.dir,!this._direction){var g=window.getComputedStyle(o).direction,v=window.getComputedStyle(document.documentElement).direction;g!==v&&(this._direction=g)}if(this._idNames={itemChoice:"item-choice"},this._templates=s.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){r.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(w){return w.value})}return Object.defineProperty(n,"defaults",{get:function(){return Object.preventExtensions({get options(){return bf},get allOptions(){return Fs},get templates(){return _f}})},enumerable:!1,configurable:!0}),n.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=pf(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var e=this.config.callbackOnInit;typeof e=="function"&&e.call(this)}},n.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=n.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},n.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},n.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},n.prototype.highlightItem=function(e,t){if(t===void 0&&(t=!0),!e||!e.id)return this;var i=this._store.items.find(function(s){return s.id===e.id});return!i||i.highlighted?this:(this._store.dispatch(Cn(i,!0)),t&&this.passedElement.triggerEvent(Ke.highlightItem,this._getChoiceForOutput(i)),this)},n.prototype.unhighlightItem=function(e,t){if(t===void 0&&(t=!0),!e||!e.id)return this;var i=this._store.items.find(function(s){return s.id===e.id});return!i||!i.highlighted?this:(this._store.dispatch(Cn(i,!1)),t&&this.passedElement.triggerEvent(Ke.unhighlightItem,this._getChoiceForOutput(i)),this)},n.prototype.highlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(t){t.highlighted||(e._store.dispatch(Cn(t,!0)),e.passedElement.triggerEvent(Ke.highlightItem,e._getChoiceForOutput(t)))})}),this},n.prototype.unhighlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(t){t.highlighted&&(e._store.dispatch(Cn(t,!1)),e.passedElement.triggerEvent(Ke.highlightItem,e._getChoiceForOutput(t)))})}),this},n.prototype.removeActiveItemsByValue=function(e){var t=this;return this._store.withTxn(function(){t._store.items.filter(function(i){return i.value===e}).forEach(function(i){return t._removeItem(i)})}),this},n.prototype.removeActiveItems=function(e){var t=this;return this._store.withTxn(function(){t._store.items.filter(function(i){var s=i.id;return s!==e}).forEach(function(i){return t._removeItem(i)})}),this},n.prototype.removeHighlightedItems=function(e){var t=this;return e===void 0&&(e=!1),this._store.withTxn(function(){t._store.highlightedActiveItems.forEach(function(i){t._removeItem(i),e&&t._triggerChange(i.value)})}),this},n.prototype.showDropdown=function(e){var t=this;return this.dropdown.isActive?this:(e===void 0&&(e=!this._canSearch),requestAnimationFrame(function(){t.dropdown.show();var i=t.dropdown.element.getBoundingClientRect();t.containerOuter.open(i.bottom,i.height),e||t.input.focus(),t.passedElement.triggerEvent(Ke.showDropdown)}),this)},n.prototype.hideDropdown=function(e){var t=this;return this.dropdown.isActive?(requestAnimationFrame(function(){t.dropdown.hide(),t.containerOuter.close(),!e&&t._canSearch&&(t.input.removeActiveDescendant(),t.input.blur()),t.passedElement.triggerEvent(Ke.hideDropdown)}),this):this},n.prototype.getValue=function(e){var t=this,i=this._store.items.map(function(s){return e?s.value:t._getChoiceForOutput(s)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?i[0]:i},n.prototype.setValue=function(e){var t=this;return this.initialisedOK?(this._store.withTxn(function(){e.forEach(function(i){i&&t._addChoice(tt(i,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},n.prototype.setChoiceByValue=function(e){var t=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var i=Array.isArray(e)?e:[e];i.forEach(function(s){return t._findAndSelectChoiceByValue(s)}),t.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},n.prototype.setChoices=function(e,t,i,s,r,l){var o=this;if(e===void 0&&(e=[]),t===void 0&&(t="value"),i===void 0&&(i="label"),s===void 0&&(s=!1),r===void 0&&(r=!0),l===void 0&&(l=!1),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof t!="string"||!t)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(typeof e=="function"){var a=e(this);if(typeof Promise=="function"&&a instanceof Promise)return new Promise(function(c){return requestAnimationFrame(c)}).then(function(){return o._handleLoadingState(!0)}).then(function(){return a}).then(function(c){return o.setChoices(c,t,i,s,r,l)}).catch(function(c){o.config.silent||console.error(c)}).then(function(){return o._handleLoadingState(!1)}).then(function(){return o});if(!Array.isArray(a))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof a));return this.setChoices(a,t,i,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){r&&(o._isSearching=!1),s&&o.clearChoices(!0,l);var c=t==="value",u=i==="label";e.forEach(function(h){if("choices"in h){var f=h;u||(f=We(We({},f),{label:f[i]})),o._addGroup(tt(f,!0))}else{var d=h;(!u||!c)&&(d=We(We({},d),{value:d[t],label:d[i]}));var p=tt(d,!1);o._addChoice(p),p.placeholder&&!o._hasNonChoicePlaceholder&&(o._placeholderValue=El(p.label))}}),o.unhighlightAll()}),this._searcher.reset(),this},n.prototype.refresh=function(e,t,i){var s=this;return e===void 0&&(e=!1),t===void 0&&(t=!1),i===void 0&&(i=!1),this._isSelectElement?(this._store.withTxn(function(){var r=s.passedElement.optionsAsChoices(),l={};i||s._store.items.forEach(function(a){a.id&&a.active&&a.selected&&(l[a.value]=!0)}),s.clearStore(!1);var o=function(a){i?s._store.dispatch($s(a)):l[a.value]&&(a.selected=!0)};r.forEach(function(a){if("choices"in a){a.choices.forEach(o);return}o(a)}),s._addPredefinedChoices(r,t,e),s._isSearching&&s._searchChoices(s.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},n.prototype.removeChoice=function(e){var t=this._store.choices.find(function(i){return i.value===e});return t?(this._clearNotice(),this._store.dispatch(Jc(t)),this._searcher.reset(),t.selected&&this.passedElement.triggerEvent(Ke.removeItem,this._getChoiceForOutput(t)),this):this},n.prototype.clearChoices=function(e,t){var i=this;return e===void 0&&(e=!0),t===void 0&&(t=!1),e&&(t?this.passedElement.element.replaceChildren(""):this.passedElement.element.querySelectorAll(":not([selected])").forEach(function(s){s.remove()})),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.withTxn(function(){var s=t?[]:i._store.items;i._store.reset(),s.forEach(function(r){i._store.dispatch(Ls(r)),i._store.dispatch(Rs(r))})}),this._searcher.reset(),this},n.prototype.clearStore=function(e){return e===void 0&&(e=!0),this.clearChoices(e,!0),this._stopSearch(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this},n.prototype.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),this._stopSearch(),this},n.prototype._validateConfig=function(){var e=this.config,t=au(e,Fs);t.length&&console.warn("Unknown config option(s) passed",t.join(", ")),e.allowHTML&&e.allowHtmlUserInput&&(e.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),e.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},n.prototype._render=function(e){e===void 0&&(e={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(e.choices||e.groups)&&this._renderChoices(),e.items&&this._renderItems())},n.prototype._renderChoices=function(){var e=this;if(this._canAddItems()){var t=this,i=t.config,s=t._isSearching,r=this._store,l=r.activeGroups,o=r.activeChoices,a=0;if(s&&i.searchResultLimit>0?a=i.searchResultLimit:i.renderChoiceLimit>0&&(a=i.renderChoiceLimit),this._isSelectElement){var c=o.filter(function(p){return!p.element});c.length&&this.passedElement.addOptions(c)}var u=document.createDocumentFragment(),h=function(p){return p.filter(function(g){return!g.placeholder&&(s?!!g.rank:i.renderSelectedChoices||!g.selected)})},f=!1,d=function(p,g,v){s?p.sort(lu):i.shouldSort&&p.sort(i.sorter);var w=p.length;w=!g&&a&&w>a?a:w,w--,p.every(function(S,P){var T=S.choiceEl||e._templates.choice(i,S,i.itemSelectText,v);return S.choiceEl=T,u.appendChild(T),(s||!S.selected)&&(f=!0),P<w})};o.length&&(i.resetScrollPosition&&requestAnimationFrame(function(){return e.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!s&&this._isSelectOneElement&&d(o.filter(function(p){return p.placeholder&&!p.group}),!1,void 0),l.length&&!s?(i.shouldSort&&l.sort(i.sorter),d(o.filter(function(p){return!p.placeholder&&!p.group}),!1,void 0),l.forEach(function(p){var g=h(p.choices);if(g.length){if(p.label){var v=p.groupEl||e._templates.choiceGroup(e.config,p);p.groupEl=v,v.remove(),u.appendChild(v)}d(g,!0,i.appendGroupInSearch&&s?p.label:void 0)}})):d(h(o),!1,void 0)),!f&&(s||!u.children.length||!i.renderSelectedChoices)&&(this._notice||(this._notice={text:Ns(s?i.noResultsText:i.noChoicesText),type:s?Le.noResults:Le.noChoices}),u.replaceChildren("")),this._renderNotice(u),this.choiceList.element.replaceChildren(u),f&&this._highlightChoice()}},n.prototype._renderItems=function(){var e=this,t=this._store.items||[],i=this.itemList.element,s=this.config,r=document.createDocumentFragment(),l=function(h){return i.querySelector('[data-item][data-id="'.concat(h.id,'"]'))},o=function(h){var f=h.itemEl;f&&f.parentElement||(f=l(h)||e._templates.item(s,h,s.removeItemButton),h.itemEl=f,r.appendChild(f))};t.forEach(o);var a=!!r.childNodes.length;if(this._isSelectOneElement){var c=i.children.length;if(a||c>1){var u=i.querySelector(sn(s.classNames.placeholder));u&&u.remove()}else!a&&!c&&this._placeholderValue&&(a=!0,o(tt({selected:!0,value:"",label:this._placeholderValue,placeholder:!0},!1)))}a&&(i.append(r),s.shouldSortItems&&!this._isSelectOneElement&&(t.sort(s.sorter),t.forEach(function(h){var f=l(h);f&&(f.remove(),r.append(f))}),i.append(r))),this._isTextElement&&(this.passedElement.value=t.map(function(h){var f=h.value;return f}).join(s.delimiter))},n.prototype._displayNotice=function(e,t,i){i===void 0&&(i=!0);var s=this._notice;if(s&&(s.type===t&&s.text===e||s.type===Le.addChoice&&(t===Le.noResults||t===Le.noChoices))){i&&this.showDropdown(!0);return}this._clearNotice(),this._notice=e?{text:e,type:t}:void 0,this._renderNotice(),i&&e&&this.showDropdown(!0)},n.prototype._clearNotice=function(){if(this._notice){var e=this.choiceList.element.querySelector(sn(this.config.classNames.notice));e&&e.remove(),this._notice=void 0}},n.prototype._renderNotice=function(e){var t=this._notice;if(t){var i=this._templates.notice(this.config,t.text,t.type);e?e.append(i):this.choiceList.prepend(i)}},n.prototype._getChoiceForOutput=function(e,t){return{id:e.id,highlighted:e.highlighted,labelClass:e.labelClass,labelDescription:e.labelDescription,customProperties:e.customProperties,disabled:e.disabled,active:e.active,label:e.label,placeholder:e.placeholder,value:e.value,groupValue:e.group?e.group.label:void 0,element:e.element,keyCode:t}},n.prototype._triggerChange=function(e){e!=null&&this.passedElement.triggerEvent(Ke.change,{value:e})},n.prototype._handleButtonAction=function(e){var t=this,i=this._store.items;if(!(!i.length||!this.config.removeItems||!this.config.removeItemButton)){var s=e&&ii(e.parentElement),r=s&&i.find(function(l){return l.id===s});r&&this._store.withTxn(function(){if(t._removeItem(r),t._triggerChange(r.value),t._isSelectOneElement&&!t._hasNonChoicePlaceholder){var l=(t.config.shouldSort?t._store.choices.reverse():t._store.choices).find(function(o){return o.placeholder});l&&(t._addItem(l),t.unhighlightAll(),l.value&&t._triggerChange(l.value))}})}},n.prototype._handleItemAction=function(e,t){var i=this;t===void 0&&(t=!1);var s=this._store.items;if(!(!s.length||!this.config.removeItems||this._isSelectOneElement)){var r=ii(e);r&&(s.forEach(function(l){l.id===r&&!l.highlighted?i.highlightItem(l):!t&&l.highlighted&&i.unhighlightItem(l)}),this.input.focus())}},n.prototype._handleChoiceAction=function(e){var t=this,i=ii(e),s=i&&this._store.getChoiceById(i);if(!s||s.disabled)return!1;var r=this.dropdown.isActive;if(!s.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){t._addItem(s,!0,!0),t.clearInput(),t.unhighlightAll()}),this._triggerChange(s.value)}return r&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},n.prototype._handleBackspace=function(e){var t=this.config;if(!(!t.removeItems||!e.length)){var i=e[e.length-1],s=e.some(function(r){return r.highlighted});t.editItems&&!s&&i?(this.input.value=i.value,this.input.setWidth(),this._removeItem(i),this._triggerChange(i.value)):(s||this.highlightItem(i,!1),this.removeHighlightedItems(!0))}},n.prototype._loadChoices=function(){var e,t=this,i=this.config;if(this._isTextElement){if(this._presetChoices=i.items.map(function(l){return tt(l,!1)}),this.passedElement.value){var s=this.passedElement.value.split(i.delimiter).map(function(l){return tt(l,!1,t.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(s)}this._presetChoices.forEach(function(l){l.selected=!0})}else if(this._isSelectElement){this._presetChoices=i.choices.map(function(l){return tt(l,!0)});var r=this.passedElement.optionsAsChoices();r&&(e=this._presetChoices).push.apply(e,r)}},n.prototype._handleLoadingState=function(e){e===void 0&&(e=!0);var t=this.itemList.element;e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?t.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(t.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},n.prototype._handleSearch=function(e){if(this.input.isFocussed)if(e!==null&&typeof e<"u"&&e.length>=this.config.searchFloor){var t=this.config.searchChoices?this._searchChoices(e):0;t!==null&&this.passedElement.triggerEvent(Ke.search,{value:e,resultCount:t})}else this._store.choices.some(function(i){return!i.active})&&this._stopSearch()},n.prototype._canAddItems=function(){var e=this.config,t=e.maxItemCount,i=e.maxItemText;return!e.singleModeForMultiSelect&&t>0&&t<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof i=="function"?i(t):i,Le.addChoice),!1):(this._notice&&this._notice.type===Le.addChoice&&this._clearNotice(),!0)},n.prototype._canCreateItem=function(e){var t=this.config,i=!0,s="";if(i&&typeof t.addItemFilter=="function"&&!t.addItemFilter(e)&&(i=!1,s=an(t.customAddItemText,e)),i){var r=this._store.choices.find(function(l){return t.valueComparer(l.value,e)});if(r){if(this._isSelectElement)return this._displayNotice("",Le.addChoice),!1;t.duplicateItemsAllowed||(i=!1,s=an(t.uniqueItemText,e))}}return i&&(s=an(t.addItemText,e)),s&&this._displayNotice(s,Le.addChoice),i},n.prototype._searchChoices=function(e){var t=e.trim().replace(/\s{2,}/," ");if(!t.length||t===this._currentValue)return null;var i=this._searcher;i.isEmptyIndex()&&i.index(this._store.searchableChoices);var s=i.search(t);this._currentValue=t,this._highlightPosition=0,this._isSearching=!0;var r=this._notice,l=r&&r.type;return l!==Le.addChoice&&(s.length?this._clearNotice():this._displayNotice(Ns(this.config.noResultsText),Le.noResults)),this._store.dispatch(Xc(s)),s.length},n.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(Qc(!0)),this.passedElement.triggerEvent(Ke.search,{value:"",resultCount:0}))},n.prototype._addEventListeners=function(){var e=this._docRoot,t=this.containerOuter.element,i=this.input.element;e.addEventListener("touchend",this._onTouchEnd,!0),t.addEventListener("keydown",this._onKeyDown,!0),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(t.addEventListener("focus",this._onFocus,{passive:!0}),t.addEventListener("blur",this._onBlur,{passive:!0})),i.addEventListener("keyup",this._onKeyUp,{passive:!0}),i.addEventListener("input",this._onInput,{passive:!0}),i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0}),i.form&&i.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},n.prototype._removeEventListeners=function(){var e=this._docRoot,t=this.containerOuter.element,i=this.input.element;e.removeEventListener("touchend",this._onTouchEnd,!0),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur)),i.removeEventListener("keyup",this._onKeyUp),i.removeEventListener("input",this._onInput),i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur),i.form&&i.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},n.prototype._onKeyDown=function(e){var t=e.keyCode,i=this.dropdown.isActive,s=e.key.length===1||e.key.length===2&&e.key.charCodeAt(0)>=55296||e.key==="Unidentified";switch(!this._isTextElement&&!i&&t!==Ne.ESC_KEY&&t!==Ne.TAB_KEY&&t!==Ne.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&s&&(this.input.value+=e.key,e.key===" "&&e.preventDefault())),t){case Ne.A_KEY:return this._onSelectKey(e,this.itemList.element.hasChildNodes());case Ne.ENTER_KEY:return this._onEnterKey(e,i);case Ne.ESC_KEY:return this._onEscapeKey(e,i);case Ne.UP_KEY:case Ne.PAGE_UP_KEY:case Ne.DOWN_KEY:case Ne.PAGE_DOWN_KEY:return this._onDirectionKey(e,i);case Ne.DELETE_KEY:case Ne.BACK_KEY:return this._onDeleteKey(e,this._store.items,this.input.isFocussed)}},n.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},n.prototype._onInput=function(){var e=this.input.value;if(!e){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(e),this._canAddUserChoices&&(this._canCreateItem(e),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},n.prototype._onSelectKey=function(e,t){if((e.ctrlKey||e.metaKey)&&t){this._canSearch=!1;var i=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;i&&this.highlightAll()}},n.prototype._onEnterKey=function(e,t){var i=this,s=this.input.value,r=e.target;if(e.preventDefault(),r&&r.hasAttribute("data-button")){this._handleButtonAction(r);return}if(!t){(this._isSelectElement||this._notice)&&this.showDropdown();return}var l=this.dropdown.element.querySelector(sn(this.config.classNames.highlightedState));if(!(l&&this._handleChoiceAction(l))){if(!r||!s){this.hideDropdown(!0);return}if(this._canAddItems()){var o=!1;this._store.withTxn(function(){if(o=i._findAndSelectChoiceByValue(s,!0),!o){if(!i._canAddUserChoices||!i._canCreateItem(s))return;i._addChoice(tt(s,!1,i.config.allowHtmlUserInput),!0,!0),o=!0}i.clearInput(),i.unhighlightAll()}),o&&(this._triggerChange(s),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},n.prototype._onEscapeKey=function(e,t){t&&(e.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},n.prototype._onDirectionKey=function(e,t){var i=e.keyCode;if(t||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var s=i===Ne.DOWN_KEY||i===Ne.PAGE_DOWN_KEY?1:-1,r=e.metaKey||i===Ne.PAGE_DOWN_KEY||i===Ne.PAGE_UP_KEY,l=void 0;if(r)s>0?l=this.dropdown.element.querySelector("".concat(rn,":last-of-type")):l=this.dropdown.element.querySelector(rn);else{var o=this.dropdown.element.querySelector(sn(this.config.classNames.highlightedState));o?l=nu(o,rn,s):l=this.dropdown.element.querySelector(rn)}l&&(iu(l,this.choiceList.element,s)||this.choiceList.scrollToChildElement(l,s),this._highlightChoice(l)),e.preventDefault()}},n.prototype._onDeleteKey=function(e,t,i){!this._isSelectOneElement&&!e.target.value&&i&&(this._handleBackspace(t),e.preventDefault())},n.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},n.prototype._onTouchEnd=function(e){var t=(e||e.touches[0]).target,i=this._wasTap&&this.containerOuter.element.contains(t);if(i){var s=t===this.containerOuter.element||t===this.containerInner.element;s&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()}this._wasTap=!0},n.prototype._onMouseDown=function(e){var t=e.target;if(t instanceof HTMLElement){if(vf&&this.choiceList.element.contains(t)){var i=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?e.offsetX>=i.offsetWidth:e.offsetX<i.offsetLeft}if(t!==this.input.element){var s=t.closest("[data-button],[data-item],[data-choice]");s instanceof HTMLElement&&("button"in s.dataset?this._handleButtonAction(s):"item"in s.dataset?this._handleItemAction(s,e.shiftKey):"choice"in s.dataset&&this._handleChoiceAction(s)),e.preventDefault()}}},n.prototype._onMouseOver=function(e){var t=e.target;t instanceof HTMLElement&&"choice"in t.dataset&&this._highlightChoice(t)},n.prototype._onClick=function(e){var t=e.target,i=this.containerOuter,s=i.element.contains(t);s?!this.dropdown.isActive&&!i.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),i.element.focus()):this._isSelectOneElement&&t!==this.input.element&&!this.dropdown.element.contains(t)&&this.hideDropdown():(i.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},n.prototype._onFocus=function(e){var t=e.target,i=this.containerOuter,s=t&&i.element.contains(t);if(s){var r=t===this.input.element;this._isTextElement?r&&i.addFocusState():this._isSelectMultipleElement?r&&(this.showDropdown(!0),i.addFocusState()):(i.addFocusState(),r&&this.showDropdown(!0))}},n.prototype._onBlur=function(e){var t=e.target,i=this.containerOuter,s=t&&i.element.contains(t);s&&!this._isScrollingOnIe?t===this.input.element?(i.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):t===this.containerOuter.element&&(i.removeFocusState(),this._canSearch||this.hideDropdown(!0)):(this._isScrollingOnIe=!1,this.input.element.focus())},n.prototype._onFormReset=function(){var e=this;this._store.withTxn(function(){e.clearInput(),e.hideDropdown(),e.refresh(!1,!1,!0),e._initialItems.length&&e.setChoiceByValue(e._initialItems)})},n.prototype._highlightChoice=function(e){e===void 0&&(e=null);var t=Array.from(this.dropdown.element.querySelectorAll(rn));if(t.length){var i=e,s=this.config.classNames.highlightedState,r=Array.from(this.dropdown.element.querySelectorAll(sn(s)));r.forEach(function(l){nt(l,s),l.setAttribute("aria-selected","false")}),i?this._highlightPosition=t.indexOf(i):(t.length>this._highlightPosition?i=t[this._highlightPosition]:i=t[t.length-1],i||(i=t[0])),de(i,s),i.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(Ke.highlightChoice,{el:i}),this.dropdown.isActive&&(this.input.setActiveDescendant(i.id),this.containerOuter.setActiveDescendant(i.id))}},n.prototype._addItem=function(e,t,i){if(t===void 0&&(t=!0),i===void 0&&(i=!1),!e.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e.id),this._store.dispatch(Rs(e)),t&&(this.passedElement.triggerEvent(Ke.addItem,this._getChoiceForOutput(e)),i&&this.passedElement.triggerEvent(Ke.choice,this._getChoiceForOutput(e)))},n.prototype._removeItem=function(e){if(e.id){this._store.dispatch($s(e));var t=this._notice;t&&t.type===Le.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(Ke.removeItem,this._getChoiceForOutput(e))}},n.prototype._addChoice=function(e,t,i){if(t===void 0&&(t=!0),i===void 0&&(i=!1),e.id)throw new TypeError("Can not re-add a choice which has already been added");var s=this.config;if(!(!s.duplicateItemsAllowed&&this._store.choices.find(function(o){return s.valueComparer(o.value,e.value)}))){this._lastAddedChoiceId++,e.id=this._lastAddedChoiceId,e.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(e.id);var r=s.prependValue,l=s.appendValue;r&&(e.value=r+e.value),l&&(e.value+=l.toString()),(r||l)&&e.element&&(e.element.value=e.value),this._clearNotice(),this._store.dispatch(Ls(e)),e.selected&&this._addItem(e,t,i)}},n.prototype._addGroup=function(e,t){var i=this;if(t===void 0&&(t=!0),e.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(Zc(e)),e.choices&&(this._lastAddedGroupId++,e.id=this._lastAddedGroupId,e.choices.forEach(function(s){s.group=e,e.disabled&&(s.disabled=!0),i._addChoice(s,t)}))},n.prototype._createTemplates=function(){var e=this,t=this.config.callbackOnCreateTemplates,i={};typeof t=="function"&&(i=t.call(this,su,Ii,Bn));var s={};Object.keys(this._templates).forEach(function(r){r in i?s[r]=i[r].bind(e):s[r]=e._templates[r].bind(e)}),this._templates=s},n.prototype._createElements=function(){var e=this._templates,t=this,i=t.config,s=t._isSelectOneElement,r=i.position,l=i.classNames,o=this._elementType;this.containerOuter=new js({element:e.containerOuter(i,this._direction,this._isSelectElement,s,i.searchEnabled,o,i.labelId),classNames:l,type:o,position:r}),this.containerInner=new js({element:e.containerInner(i),classNames:l,type:o,position:r}),this.input=new du({element:e.input(i,this._placeholderValue),classNames:l,type:o,preventPaste:!i.paste}),this.choiceList=new Vs({element:e.choiceList(i,s)}),this.itemList=new Vs({element:e.itemList(i,s)}),this.dropdown=new fu({element:e.dropdown(i),classNames:l,type:o})},n.prototype._createStructure=function(){var e=this,t=e.containerInner,i=e.containerOuter,s=e.passedElement,r=this.dropdown.element;s.conceal(),t.wrap(s.element),i.wrap(t.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),i.element.appendChild(t.element),i.element.appendChild(r),t.element.appendChild(this.itemList.element),r.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&r.insertBefore(this.input.element,r.firstChild):t.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},n.prototype._initStore=function(){var e=this;this._store.subscribe(this._render).withTxn(function(){e._addPredefinedChoices(e._presetChoices,e._isSelectOneElement&&!e._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},n.prototype._addPredefinedChoices=function(e,t,i){var s=this;if(t===void 0&&(t=!1),i===void 0&&(i=!0),t){var r=e.findIndex(function(l){return l.selected})===-1;r&&e.some(function(l){return l.disabled||"choices"in l?!1:(l.selected=!0,!0)})}e.forEach(function(l){"choices"in l?s._isSelectElement&&s._addGroup(l,i):s._addChoice(l,i)})},n.prototype._findAndSelectChoiceByValue=function(e,t){var i=this;t===void 0&&(t=!1);var s=this._store.choices.find(function(r){return i.config.valueComparer(r.value,e)});return s&&!s.disabled&&!s.selected?(this._addItem(s,!0,t),!0):!1},n.prototype._generatePlaceholderValue=function(){var e=this.config;if(!e.placeholder)return null;if(this._hasNonChoicePlaceholder)return e.placeholderValue;if(this._isSelectElement){var t=this.passedElement.placeholderOption;return t?t.text:null}return null},n.prototype._warnChoicesInitFailed=function(e){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(e," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(e," called on a non-initialised instance of Choices"))},n.version="11.1.0",n}();function xs(n){let e,t;return{c(){e=b("label"),t=J(n[2]),m(e,"for",n[4])},m(i,s){C(i,e,s),_(e,t)},p(i,s){s&4&&fe(t,i[2])},d(i){i&&E(e)}}}function yf(n){let e;return{c(){e=b("select"),m(e,"id",n[4]),m(e,"name",n[4]),m(e,"aria-label",n[2]),m(e,"class","m-1")},m(t,i){C(t,e,i)},p(t,i){i&4&&m(e,"aria-label",t[2])},i:j,o:j,d(t){t&&E(e)}}}function kf(n){let e,t,i,s=n[3].length&&Js(n);return{c(){s&&s.c(),e=D(),t=b("select"),m(t,"id",n[4]),m(t,"name",n[4]),m(t,"aria-label",n[2]),m(t,"class","m-1"),t.multiple=!0},m(r,l){s&&s.m(r,l),C(r,e,l),C(r,t,l),i=!0},p(r,l){r[3].length?s?(s.p(r,l),l&8&&M(s,1)):(s=Js(r),s.c(),M(s,1),s.m(e.parentNode,e)):s&&(_e(),R(s,1,1,()=>{s=null}),ve()),(!i||l&4)&&m(t,"aria-label",r[2])},i(r){i||(M(s),i=!0)},o(r){R(s),i=!1},d(r){s&&s.d(r),r&&E(e),r&&E(t)}}}function Js(n){let e,t,i=n[3].length+"",s,r,l,o;return l=new pn({props:{targetHtmlId:n[5],tooltipText:`${n[3].length}
                                    ${N==="fr"&&n[3].length>1?"valeurs sélectionnées":N==="fr"&&n[3].length===1?"valeur sélectionnée":N==="en"&&n[3].length>1?"selected values":"selected value"}`}}),{c(){e=b("span"),t=b("span"),s=J(i),r=D(),x(l.$$.fragment),m(t,"id",n[5]),m(t,"class","input-dropdown-count tag m-1 svelte-1epfuu8"),m(e,"class","is-relative")},m(a,c){C(a,e,c),_(e,t),_(t,s),_(e,r),W(l,e,null),o=!0},p(a,c){(!o||c&8)&&i!==(i=a[3].length+"")&&fe(s,i);const u={};c&8&&(u.tooltipText=`${a[3].length}
                                    ${N==="fr"&&a[3].length>1?"valeurs sélectionnées":N==="fr"&&a[3].length===1?"valeur sélectionnée":N==="en"&&a[3].length>1?"selected values":"selected value"}`),l.$set(u)},i(a){o||(M(l.$$.fragment,a),o=!0)},o(a){R(l.$$.fragment,a),o=!1},d(a){a&&E(e),G(l)}}}function Sf(n){let e,t,i,s,r,l,o,a=n[2]!==void 0&&xs(n);const c=[kf,yf],u=[];function h(f,d){return f[0]?0:1}return s=h(n),r=u[s]=c[s](n),{c(){e=b("div"),a&&a.c(),t=D(),i=b("div"),r.c(),m(i,"class",l="input-dropdown-select "+(n[0]?"is-multiple":"is-single")+" "+(n[0]&&n[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(n[1]?"light-display":"")+" svelte-1epfuu8"),m(e,"class","input-dropdown-select-wrapper")},m(f,d){C(f,e,d),a&&a.m(e,null),_(e,t),_(e,i),u[s].m(i,null),o=!0},p(f,[d]){f[2]!==void 0?a?a.p(f,d):(a=xs(f),a.c(),a.m(e,t)):a&&(a.d(1),a=null);let p=s;s=h(f),s===p?u[s].p(f,d):(_e(),R(u[p],1,1,()=>{u[p]=null}),ve(),r=u[s],r?r.p(f,d):(r=u[s]=c[s](f),r.c()),M(r,1),r.m(i,null)),(!o||d&11&&l!==(l="input-dropdown-select "+(f[0]?"is-multiple":"is-single")+" "+(f[0]&&f[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(f[1]?"light-display":"")+" svelte-1epfuu8"))&&m(i,"class",l)},i(f){o||(M(r),o=!0)},o(f){R(r),o=!1},d(f){f&&E(e),a&&a.d(),u[s].d()}}}const Ef=250;function Cf(n,e,t){let i,s,{choicesItems:r}=e,{start:l=[]}=e,{multiple:o}=e,{searchable:a=!0}=e,{lightDisplay:c=!1}=e,{placeholder:u=N==="fr"?"Sélectionner une valeur":"Select a value"}=e,{title:h=void 0}=e,{selectAll:f=!!o}=e;const d=`input-dropdown-select-${window.crypto.randomUUID()}`,p=`input-dropdown-counter-${window.crypto.randomUUID()}`,g=`select-all-${window.crypto.randomUUID()}`,v=`unselect-all-${window.crypto.randomUUID()}`,w=Kt();let S;const P=$n();P.setCompareFn(yi);const T=Je("resetTrigger")||void 0;T==null||T.subscribe(()=>U(S,r,l,f));const I=()=>{t(11,s=!0),setTimeout(()=>t(11,s=!1),Ef)},L=(H,se)=>{se||(P.set(H),P.same()||w("updateValues",i))},A=H=>`<span class="iconify" data-icon=${H}/>`,y=(H,se)=>H!=null&&se!=null&&H.length&&se.length?`<span class="dropdown-prefix-wrapper">${se==="iconify"?A(H):H}</span>`:"",F=(H,se)=>se?[{value:g,label:`<b>${N==="fr"?"Tout sélectionner":"Select all"}</b>`},{value:v,label:`<b>${N==="fr"?"Tout retirer":"Remove all"}</b>`},...H]:H,K=(H,se)=>F(H,se).map(z=>(z.id=`dropdown-choice-${window.crypto.randomUUID()}`,z.label=`<span>
                ${y(z.prefix||"",z.prefixType||"")}
                <span class="dropdown-prefix-text">${z.label}</span>
            </span>`,z));function re(H,se,z){return H=structuredClone(H),se=structuredClone(se),H=K(H,z).map(q=>se.includes(q.value)?{...q,selected:!0}:{...q,selected:!1}),t(3,i=se),H}function U(H,se,z,q){H&&(se=re(se,z,q),H.clearStore().setChoices(se))}const Y=(H,se,z,q,te,he)=>(q=structuredClone(q),z=structuredClone(z),H.detail.value===te?(I(),z=z.map(be=>[te,he].includes(be.value)?{...be,selected:!1}:{...be,selected:!0}),se.removeActiveItems().clearChoices(!0,!0).setValue(z).hideDropdown(),q=[...new Set(z.filter(be=>be.selected===!0).map(be=>be.value))]):H.detail.value===he?(se.removeActiveItems().hideDropdown(),q=[]):q=o===!0?[...q,H.detail.value]:[H.detail.value],[...new Set(q)]),Z=(H,se)=>structuredClone(se).filter(z=>z!==H.detail.value);function V(H,se){const z=document.getElementById(d);S=new wf(z,{items:[],choices:H,addChoices:!1,addItems:!1,removeItems:!0,removeItemButton:!0,searchEnabled:a,allowHTML:!0,shouldSort:!se,sorter:(q,te)=>q.label.localeCompare(te.label),placeholderValue:u,classNames:{item:["choices__item","dropdown-item"]},loadingText:N==="fr"?"Chargement...":"Loading...",noResultsText:N==="fr"?"Pas de résultats":"No results found",noChoicesText:N==="fr"?"Pas de choix pour faire la sélection":"No choices to choose from",itemSelectText:N==="fr"?"Cliquer pour sélectionner":"Press to select",uniqueItemText:N==="fr"?"Seules des valeurs uniques peuvent être ajoutées":"Only unique values can be added",customAddItemText:N==="fr"?"Les valeurs ne répondent pas aux conditions attendues":"Only values matching specific conditions can be added",removeItemIconText:N==="fr"?"Retirer l'item":"Remove item",addItemText:q=>N==="fr"?`Cliquer sur Entrer pour ajouter <b>${q}</b>`:`Press Enter to add <b>"${q}"</b>`,removeItemLabelText:q=>N==="fr"?`Retirer l'item: ${q}`:`Remove item: ${q}`,maxItemText:q=>N==="fr"?`Seulement ${q} items peuvent être ajoutées`:`Only ${q} items can be added`}),z.addEventListener("addItem",q=>{t(3,i=Y(q,S,H,i,g,v))}),z.addEventListener("removeItem",q=>{t(3,i=Z(q,i))})}return rt(()=>{const H=re(r,l,f);V(H,f)}),hn(()=>{S.destroy(),S=void 0}),n.$$set=H=>{"choicesItems"in H&&t(6,r=H.choicesItems),"start"in H&&t(7,l=H.start),"multiple"in H&&t(0,o=H.multiple),"searchable"in H&&t(8,a=H.searchable),"lightDisplay"in H&&t(1,c=H.lightDisplay),"placeholder"in H&&t(9,u=H.placeholder),"title"in H&&t(2,h=H.title),"selectAll"in H&&t(10,f=H.selectAll)},n.$$.update=()=>{n.$$.dirty&2056&&L(i,s)},t(3,i=[]),t(11,s=!1),[o,c,h,i,d,p,r,l,a,u,f,s]}class Ai extends ae{constructor(e){super(),oe(this,e,Cf,Sf,le,{choicesItems:6,start:7,multiple:0,searchable:8,lightDisplay:1,placeholder:9,title:2,selectAll:10})}}function If(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v,w,S,P,T,I,L,A,y,F,K,re,U,Y,Z,V,H,se;return a=new Et({props:{minVal:0,maxVal:1,start:.5,emitOnUpdate:!0,title:N==="fr"?"Opacité":"Opacity"}}),a.$on("updateSlider",n[14]),u=new Et({props:{minVal:0,maxVal:360,start:0,step:1,emitOnUpdate:!0,title:"Rotation"}}),u.$on("updateSlider",n[15]),f=new Et({props:{minVal:0,maxVal:200,start:100,step:1,emitOnUpdate:!0,title:N==="fr"?"Redimensionner":"Scale"}}),f.$on("updateSlider",n[16]),p=new Et({props:{minVal:-100,maxVal:100,start:0,step:1,emitOnUpdate:!0,title:N==="fr"?"Translation horizontale":"Horizontal translate"}}),p.$on("updateSlider",n[17]),v=new Et({props:{minVal:-100,maxVal:100,start:0,step:1,emitOnUpdate:!0,title:N==="fr"?"Translation verticale":"Vertical translate"}}),v.$on("updateSlider",n[18]),S=new Ai({props:{choicesItems:n[10],start:[],lightDisplay:!0,placeholder:N==="fr"?"Sélectionner":"Select",title:N==="fr"?"Basculer":"Flip"}}),S.$on("updateValues",n[11]),{c(){e=b("div"),t=b("div"),i=b("div"),s=b("div"),r=b("strong"),r.textContent=`${N==="en"?"Query image transformation":"Modification de l'image requête"}`,l=D(),o=b("div"),x(a.$$.fragment),c=D(),x(u.$$.fragment),h=D(),x(f.$$.fragment),d=D(),x(p.$$.fragment),g=D(),x(v.$$.fragment),w=D(),x(S.$$.fragment),P=D(),T=b("div"),I=b("button"),I.textContent=`${N==="fr"?"Réinitialiser":"Reset"}`,L=D(),A=b("div"),y=b("img"),re=D(),U=b("img"),m(s,"class","toolbar-title mt-0 mb-2 svelte-t3h37q"),m(I,"class","button is-link"),m(T,"class","mt-2 is-flex is-flex-direction-column is-justify-content-center is-align-items-flex-end"),m(o,"class","toolbar-controls is-flex is-flex-direction-column is-align-items-start is-justify-content-center svelte-t3h37q"),m(i,"class","toolbar svelte-t3h37q"),m(t,"class","toolbar-wrapper is-flex is-flex-direction-column is-justify-content-center is-align-items-center svelte-t3h37q"),m(y,"class","compare-img svelte-t3h37q"),$e(y.src,F=n[8])||m(y,"src",F),m(y,"alt",K=n[1].title),m(U,"class","main-img svelte-t3h37q"),$e(U.src,Y=n[9])||m(U,"src",Y),m(U,"alt",Z=n[0].title),Ce(U,"overlay-reset",n[6]),ge(U,"opacity",n[5]),ge(U,"transform",n[7]),m(A,"class","overlay-wrapper svelte-t3h37q"),m(e,"class","similarity-overlay-wrapper svelte-t3h37q")},m(z,q){C(z,e,q),_(e,t),_(t,i),_(i,s),_(s,r),_(i,l),_(i,o),W(a,o,null),_(o,c),W(u,o,null),_(o,h),W(f,o,null),_(o,d),W(p,o,null),_(o,g),W(v,o,null),_(o,w),W(S,o,null),_(o,P),_(o,T),_(T,I),_(e,L),_(e,A),_(A,y),_(A,re),_(A,U),V=!0,H||(se=ne(I,"click",n[12]),H=!0)},p(z,[q]){(!V||q&256&&!$e(y.src,F=z[8]))&&m(y,"src",F),(!V||q&2&&K!==(K=z[1].title))&&m(y,"alt",K),(!V||q&512&&!$e(U.src,Y=z[9]))&&m(U,"src",Y),(!V||q&1&&Z!==(Z=z[0].title))&&m(U,"alt",Z),(!V||q&64)&&Ce(U,"overlay-reset",z[6]),q&32&&ge(U,"opacity",z[5]),q&128&&ge(U,"transform",z[7])},i(z){V||(M(a.$$.fragment,z),M(u.$$.fragment,z),M(f.$$.fragment,z),M(p.$$.fragment,z),M(v.$$.fragment,z),M(S.$$.fragment,z),V=!0)},o(z){R(a.$$.fragment,z),R(u.$$.fragment,z),R(f.$$.fragment,z),R(p.$$.fragment,z),R(v.$$.fragment,z),R(S.$$.fragment,z),V=!1},d(z){z&&E(e),G(a),G(u),G(f),G(p),G(v),G(S),H=!1,se()}}}function Of(n,e,t){let i,s,r,{queryItem:l}=e,{similarItem:o}=e;const a=[{value:"h",label:N==="fr"?"Basculer horizontalement":"Flip horizontally"},{value:"v",label:N==="fr"?"Basculer verticalement":"Flip vertically"},{value:"hv",label:N==="fr"?"Basculer H+V":"Flip H+V"}];let c=.5,u=0,h=100,f=[1,1],d=[0,0],p=!1;const g=L=>{const A=L.detail[0];t(13,f=A==="hv"?[-1,-1]:A==="h"?[-1,1]:A==="v"?[1,-1]:[1,1])},v=()=>{t(5,c=.5),t(2,u=0),t(3,h=100),t(13,f=[1,1]),t(4,d=[0,0]),t(6,p=!0),setTimeout(()=>t(6,p=!1),300)},w=L=>t(5,c=L.detail),S=L=>t(2,u=L.detail),P=L=>t(3,h=L.detail),T=L=>t(4,d=[L.detail,d[1]]),I=L=>t(4,d=[d[0],L.detail]);return n.$$set=L=>{"queryItem"in L&&t(0,l=L.queryItem),"similarItem"in L&&t(1,o=L.similarItem)},n.$$.update=()=>{var L,A;n.$$.dirty&1&&t(9,i=dt(l.img,((L=l.xywh)==null?void 0:L.join(","))||"full","full")),n.$$.dirty&2&&t(8,s=dt(o.img,((A=o.xywh)==null?void 0:A.join(","))||"full","full")),n.$$.dirty&8220&&t(7,r=`translate(${d[0]-50}%, ${d[1]}%)
                        rotate(${u}deg)
                        scale(${f.map(y=>y*(h/100)).join()})`)},[l,o,u,h,d,c,p,r,s,i,a,g,v,f,w,S,P,T,I]}class Af extends ae{constructor(e){super(),oe(this,e,Of,If,le,{queryItem:0,similarItem:1})}}function Tf(n){let e,t,i,s,r,l,o,a,c,u,h;return r=new Bt({props:{item:n[0],height:"full",isInModal:!0}}),u=new Bt({props:{item:n[1],height:"full",isInModal:!0}}),{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent=`${N==="en"?"Query image":"Image requête"}`,s=D(),x(r.$$.fragment),l=D(),o=b("div"),a=b("span"),a.textContent=`${N==="en"?"Similarity":"Similarité"}`,c=D(),x(u.$$.fragment),m(t,"class","column is-flex is-flex-direction-column is-justify-content-center is-align-items-center"),m(o,"class","column is-flex is-flex-direction-column is-justify-content-center is-align-items-center"),m(e,"class","side-by-side columns svelte-1wmtj1c")},m(f,d){C(f,e,d),_(e,t),_(t,i),_(t,s),W(r,t,null),_(e,l),_(e,o),_(o,a),_(o,c),W(u,o,null),h=!0},p(f,d){const p={};d&1&&(p.item=f[0]),r.$set(p);const g={};d&2&&(g.item=f[1]),u.$set(g)},i(f){h||(M(r.$$.fragment,f),M(u.$$.fragment,f),h=!0)},o(f){R(r.$$.fragment,f),R(u.$$.fragment,f),h=!1},d(f){f&&E(e),G(r),G(u)}}}function Mf(n){let e,t;return e=new Af({props:{queryItem:n[0],similarItem:n[1]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&1&&(r.queryItem=i[0]),s&2&&(r.similarItem=i[1]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Pf(n){let e,t,i,s,r,l,o,a;const c=[Mf,Tf],u=[];function h(f,d){return f[2]?0:1}return i=h(n),s=u[i]=c[i](n),o=new gl({props:{start:!1,buttonDisplay:!0,toggleLabel:N==="en"?"Overlay view":"Vue superposée"}}),o.$on("updateChecked",n[3]),{c(){e=b("div"),t=b("div"),s.c(),r=D(),l=b("div"),x(o.$$.fragment),m(t,"class","modal-similarity-images svelte-1wmtj1c"),Ce(t,"overlay-wrapper",n[2]),Ce(t,"side-by-side-wrapper",!n[2]),m(e,"class","modal-similarity svelte-1wmtj1c")},m(f,d){C(f,e,d),_(e,t),u[i].m(t,null),_(e,r),_(e,l),W(o,l,null),a=!0},p(f,[d]){let p=i;i=h(f),i===p?u[i].p(f,d):(_e(),R(u[p],1,1,()=>{u[p]=null}),ve(),s=u[i],s?s.p(f,d):(s=u[i]=c[i](f),s.c()),M(s,1),s.m(t,null)),(!a||d&4)&&Ce(t,"overlay-wrapper",f[2]),(!a||d&4)&&Ce(t,"side-by-side-wrapper",!f[2])},i(f){a||(M(s),M(o.$$.fragment,f),a=!0)},o(f){R(s),R(o.$$.fragment,f),a=!1},d(f){f&&E(e),u[i].d(),G(o)}}}function Lf(n,e,t){let{queryItem:i}=e,{similarItem:s}=e,r=!1;const l=()=>t(2,r=!r);return n.$$set=o=>{"queryItem"in o&&t(0,i=o.queryItem),"similarItem"in o&&t(1,s=o.similarItem)},[i,s,r,l]}class Rf extends ae{constructor(e){super(),oe(this,e,Lf,Pf,le,{queryItem:0,similarItem:1})}}function $f(n){let e,t,i,s,r,l;return r=new Ul({props:{qImg:n[0].img,isInModal:!0}}),{c(){e=b("div"),t=b("a"),i=b("button"),i.textContent=`${N==="fr"?"Voir toutes les similarités pour ce document":"View all similarities for this document"}`,s=D(),x(r.$$.fragment),m(i,"class","button is-link is-small"),m(t,"href",n[1]()),m(e,"class","is-flex is-align-items-center is-justify-content-end")},m(o,a){C(o,e,a),_(e,t),_(t,i),C(o,s,a),W(r,o,a),l=!0},p(o,[a]){const c={};a&1&&(c.qImg=o[0].img),r.$set(c)},i(o){l||(M(r.$$.fragment,o),l=!0)},o(o){R(r.$$.fragment,o),l=!1},d(o){o&&E(e),o&&E(s),G(r,o)}}}function Df(n,e,t){let{mainImgItem:i}=e;function s(){const r=i.img.match(/wit(\d+)/)[1],l=new URL(window.location.origin);return l.pathname=`${new URL(window.location).pathname.split("/")[1]}/witness/${r}/regions/`,l.searchParams.set("tab","similarity"),l.href}return n.$$set=r=>{"mainImgItem"in r&&t(0,i=r.mainImgItem)},[i,s]}class Nf extends ae{constructor(e){super(),oe(this,e,Df,$f,le,{mainImgItem:0})}}const jf=n=>({activeTab:n&1}),Xs=n=>({activeTab:n[0]});function Qs(n,e,t){const i=n.slice();return i[5]=e[t].id,i[6]=e[t].label,i}function Zs(n){let e,t,i,s=n[1],r=[];for(let l=0;l<s.length;l+=1)r[l]=er(Qs(n,s,l));return{c(){e=b("nav"),t=b("div"),i=b("ul");for(let l=0;l<r.length;l+=1)r[l].c();m(i,"class","svelte-d8a4vd"),m(t,"class","tabs svelte-d8a4vd"),m(e,"class","tabs-bar")},m(l,o){C(l,e,o),_(e,t),_(t,i);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(i,null)},p(l,o){if(o&3){s=l[1];let a;for(a=0;a<s.length;a+=1){const c=Qs(l,s,a);r[a]?r[a].p(c,o):(r[a]=er(c),r[a].c(),r[a].m(i,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=s.length}},d(l){l&&E(e),et(r,l)}}}function er(n){let e,t,i=n[6]+"",s,r,l,o;function a(){return n[4](n[5])}return{c(){e=b("li"),t=b("a"),s=J(i),r=D(),m(t,"href",null),Ce(e,"is-active",n[0]===n[5])},m(c,u){C(c,e,u),_(e,t),_(t,s),_(e,r),l||(o=ne(t,"click",wt(a)),l=!0)},p(c,u){n=c,u&2&&i!==(i=n[6]+"")&&fe(s,i),u&3&&Ce(e,"is-active",n[0]===n[5])},d(c){c&&E(e),l=!1,o()}}}function Vf(n){let e,t,i,s=n[1].length>1&&Zs(n);const r=n[3].default,l=He(r,n,n[2],Xs);return{c(){s&&s.c(),e=D(),t=b("div"),l&&l.c(),m(t,"class","tab-content svelte-d8a4vd")},m(o,a){s&&s.m(o,a),C(o,e,a),C(o,t,a),l&&l.m(t,null),i=!0},p(o,[a]){o[1].length>1?s?s.p(o,a):(s=Zs(o),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),l&&l.p&&(!i||a&5)&&Be(l,r,o,o[2],i?qe(r,o[2],a,jf):ze(o[2]),Xs)},i(o){i||(M(l,o),i=!0)},o(o){R(l,o),i=!1},d(o){s&&s.d(o),o&&E(e),o&&E(t),l&&l.d(o)}}}function Ff(n,e,t){var a;let{$$slots:i={},$$scope:s}=e,{tabs:r=[]}=e,{activeTab:l=((a=r[0])==null?void 0:a.id)??""}=e;const o=c=>t(0,l=c);return n.$$set=c=>{"tabs"in c&&t(1,r=c.tabs),"activeTab"in c&&t(0,l=c.activeTab),"$$scope"in c&&t(2,s=c.$$scope)},[l,r,s,i,o]}class jl extends ae{constructor(e){super(),oe(this,e,Ff,Vf,le,{tabs:1,activeTab:0})}}function tr(n,e,t){const i=n.slice();return i[34]=e[t].uuid,i[35]=e[t].data[0],i[36]=e[t].data[1],i[37]=e[t].data[2],i[38]=e[t].data[3],i[39]=e[t].data[4],i[40]=e[t].data[5],i[41]=e[t].data[6],i[42]=e[t].data[7],i[43]=e[t].data[8],i[45]=t,i}function Uf(n){let e,t=N==="en"?`Error when retrieving similar regions: ${n[5]}`:`Erreur de recupération des régions similaires: ${n[5]}`,i;return{c(){e=b("div"),i=J(t),m(e,"class","faded is-center")},m(s,r){C(s,e,r),_(e,i)},p(s,r){r[0]&32&&t!==(t=N==="en"?`Error when retrieving similar regions: ${s[5]}`:`Erreur de recupération des régions similaires: ${s[5]}`)&&fe(i,t)},i:j,o:j,d(s){s&&E(e)}}}function Hf(n){let e,t,i=n[4].length+"",s,r,l=n[18](n[16],n[4].length)+"",o,a,c,u=[],h=new Map,f,d,p,g,v,w=n[4];const S=A=>A[34];for(let A=0;A<w.length;A+=1){let y=tr(n,w,A),F=S(y);h.set(F,u[A]=ir(F,y))}let P=null;w.length||(P=nr(n));function T(A){n[25](A)}function I(A){n[26](A)}let L={items:n[9],$$slots:{default:[Jf,({item:A})=>({32:A}),({item:A})=>[0,A?2:0]]},$$scope:{ctx:n}};return n[3]!==void 0&&(L.currentIndex=n[3]),n[6]!==void 0&&(L.open=n[6]),d=new Ei({props:L}),ft.push(()=>jt(d,"currentIndex",T)),ft.push(()=>jt(d,"open",I)),{c(){e=b("div"),t=b("span"),s=J(i),r=D(),o=J(l),a=D(),c=b("div");for(let A=0;A<u.length;A+=1)u[A].c();P&&P.c(),f=D(),x(d.$$.fragment),m(t,"class","m-2"),m(c,"class","m-2 is-gap-2"),Ce(c,"grid",n[4].length>0)},m(A,y){C(A,e,y),_(e,t),_(t,s),_(t,r),_(t,o),_(e,a),_(e,c);for(let F=0;F<u.length;F+=1)u[F]&&u[F].m(c,null);P&&P.m(c,null),C(A,f,y),W(d,A,y),v=!0},p(A,y){(!v||y[0]&16)&&i!==(i=A[4].length+"")&&fe(s,i),(!v||y[0]&16)&&l!==(l=A[18](A[16],A[4].length)+"")&&fe(o,l),y[0]&526357&&(w=A[4],_e(),u=mn(u,y,S,1,A,w,h,c,Fn,ir,null,tr),ve(),!w.length&&P?P.p(A,y):w.length?P&&(P.d(1),P=null):(P=nr(A),P.c(),P.m(c,null))),(!v||y[0]&16)&&Ce(c,"grid",A[4].length>0);const F={};y[0]&512&&(F.items=A[9]),y[0]&384|y[1]&32770&&(F.$$scope={dirty:y,ctx:A}),!p&&y[0]&8&&(p=!0,F.currentIndex=A[3],Nt(()=>p=!1)),!g&&y[0]&64&&(g=!0,F.open=A[6],Nt(()=>g=!1)),d.$set(F)},i(A){if(!v){for(let y=0;y<w.length;y+=1)M(u[y]);M(d.$$.fragment,A),v=!0}},o(A){for(let y=0;y<u.length;y+=1)R(u[y]);R(d.$$.fragment,A),v=!1},d(A){A&&E(e);for(let y=0;y<u.length;y+=1)u[y].d();P&&P.d(),A&&E(f),G(d,A)}}}function qf(n){let e;function t(r,l){return r[16]?Qf:Xf}let s=t(n)(n);return{c(){e=b("div"),s.c(),m(e,"class","faded is-center")},m(r,l){C(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:j,o:j,d(r){r&&E(e),s.d()}}}function nr(n){let e;function t(r,l){return r[11]?zf:Bf}let i=t(n),s=i(n);return{c(){s.c(),e=pe()},m(r,l){s.m(r,l),C(r,e,l)},p(r,l){i===(i=t(r))&&s?s.p(r,l):(s.d(1),s=i(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&E(e)}}}function Bf(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No similar regions":"Pas de régions similaires"}
                    `,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,d(t){t&&E(e)}}}function zf(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No document selected. Select one to display results.":"Aucun document sélectionné. Sélectionnez-en un pour afficher les résultats."}
                    `,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,d(t){t&&E(e)}}}function ir(n,e){let t,i,s;return i=new Ya({props:{qImg:e[0],sImg:e[37],score:e[35],qRegions:e[38],sRegions:e[39],category:e[40],users:e[41],isManual:e[42],similarityType:e[43],index:e[45],isInModal:e[2]}}),i.$on("openModal",e[19]),{key:n,first:null,c(){t=pe(),x(i.$$.fragment),this.first=t},m(r,l){C(r,t,l),W(i,r,l),s=!0},p(r,l){e=r;const o={};l[0]&1&&(o.qImg=e[0]),l[0]&16&&(o.sImg=e[37]),l[0]&16&&(o.score=e[35]),l[0]&16&&(o.qRegions=e[38]),l[0]&16&&(o.sRegions=e[39]),l[0]&16&&(o.category=e[40]),l[0]&16&&(o.users=e[41]),l[0]&16&&(o.isManual=e[42]),l[0]&16&&(o.similarityType=e[43]),l[0]&16&&(o.index=e[45]),l[0]&4&&(o.isInModal=e[2]),i.$set(o)},i(r){s||(M(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&E(t),G(i,r)}}}function Kf(n){let e,t;return e=new Nf({props:{mainImgItem:n[32]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s[1]&2&&(r.mainImgItem=i[32]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Wf(n){let e,t;return e=new Rf({props:{queryItem:n[17],similarItem:n[32],score:n[8]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s[1]&2&&(r.similarItem=i[32]),s[0]&256&&(r.score=i[8]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Gf(n){let e,t;return e=new pl({props:{item:n[32]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s[1]&2&&(r.item=i[32]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Yf(n){let e,t,i;return t=new Bt({props:{item:n[32],height:"full",isInModal:!0}}),{c(){e=b("div"),x(t.$$.fragment),m(e,"class","modal-region svelte-jba7xn")},m(s,r){C(s,e,r),W(t,e,null),i=!0},p(s,r){const l={};r[1]&2&&(l.item=s[32]),t.$set(l)},i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){R(t.$$.fragment,s),i=!1},d(s){s&&E(e),G(t)}}}function xf(n){let e,t,i,s;const r=[Yf,Gf,Wf,Kf],l=[];function o(a,c){return a[33]==="region"?0:a[33]==="page"?1:a[33]==="similarity"&&a[17]?2:a[33]==="expansion"?3:-1}return~(e=o(n))&&(t=l[e]=r[e](n)),{c(){t&&t.c(),i=pe()},m(a,c){~e&&l[e].m(a,c),C(a,i,c),s=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(t&&(_e(),R(l[u],1,1,()=>{l[u]=null}),ve()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=r[e](a),t.c()),M(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(M(t),s=!0)},o(a){R(t),s=!1},d(a){~e&&l[e].d(a),a&&E(i)}}}function Jf(n){let e,t;return e=new jl({props:{tabs:n[7],$$slots:{default:[xf,({activeTab:i})=>({33:i}),({activeTab:i})=>[0,i?4:0]]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s[0]&128&&(r.tabs=i[7]),s[0]&256|s[1]&32774&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Xf(n){let e=N==="en"?"Retrieving similar regions...":"Récupération des régions similaires...",t;return{c(){t=J(e)},m(i,s){C(i,t,s)},p:j,d(i){i&&E(t)}}}function Qf(n){let e=N==="en"?"Retrieving propagated regions...":"Récupération de similarités propagées...",t;return{c(){t=J(e)},m(i,s){C(i,t,s)},p:j,d(i){i&&E(t)}}}function Zf(n){let e,t,i,s;const r=[qf,Hf,Uf],l=[];function o(a,c){return a[1]&&a[10]==="loading"?0:a[10]==="loaded"?1:a[10]==="error"?2:-1}return~(e=o(n))&&(t=l[e]=r[e](n)),{c(){t&&t.c(),i=pe()},m(a,c){~e&&l[e].m(a,c),C(a,i,c),s=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(t&&(_e(),R(l[u],1,1,()=>{l[u]=null}),ve()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=r[e](a),t.c()),M(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(M(t),s=!0)},o(a){R(t),s=!1},d(a){~e&&l[e].d(a),a&&E(i)}}}function ed(n,e,t){let i,s,r,l,o,a,c,u,h,f,d,{qImg:p}=e,{sImgsPromise:g}=e,{isInModal:v=!1}=e;const{selectedRegions:w,excludedCategories:S,similarityScoreCutoff:P,propagateFilterByRegions:T}=xe;ue(n,w,q=>t(24,d=q)),ue(n,S,q=>t(23,f=q)),ue(n,P,q=>t(22,h=q)),ue(n,T,q=>t(21,u=q));const I=Je("similarityPropagatedContext")||!1,L=window.location.pathname.match(/\d+/g).join("-"),A=Je("qImgMetadata")||null;let y;const F=(q,te)=>q===null||te===void 0||Number(q)>=te,K=(q,te,he)=>!he.includes(q),re=(q,te,he,be,Gt,Yt)=>I?!0:F(q,Gt)&&K(te,he,be),U=(q,te,he,be)=>q.filter(({uuid:Gt,data:[Yt,xt,Jt,gn,lt,Xt,Qt,_n,vn]})=>re(Yt,Xt,Qt,te,he)),Y=(q,te)=>{const he=te>1;return q?N==="fr"?he?"similarités propagées":"similarité propagée":he?"propagated matches":"propagated match":N==="fr"?he?"images similaires":"image similaire":he?"similar images":"similar image"};let Z=!1,V=0;const H=q=>{t(3,V=q.detail.index??0),t(6,Z=!0)};function se(q){V=q,t(3,V)}function z(q){Z=q,t(6,Z)}return n.$$set=q=>{"qImg"in q&&t(0,p=q.qImg),"sImgsPromise"in q&&t(1,g=q.sImgsPromise),"isInModal"in q&&t(2,v=q.isInModal)},n.$$.update=()=>{var q;n.$$.dirty[0]&16777216&&t(11,i=Object.values(d).length===0||d[L]===void 0||!Object.keys(d[L]).length),n.$$.dirty[0]&2&&(te=>{t(10,s="loading"),t(4,l=[]),t(20,r=[])})(),n.$$.dirty[0]&2&&g.then(te=>{t(20,r=te.map(he=>({uuid:window.crypto.randomUUID(),data:he}))),t(10,s="loaded")}).catch(te=>{t(5,y=te),t(10,s="error")}),n.$$.dirty[0]&15728640&&t(4,l=U(r,f,h)),n.$$.dirty[0]&16&&t(9,o=l.map(({data:[te,he,be,Gt,Yt,xt,Jt,gn,lt]})=>{const[Xt,Qt,_n,vn]=be.split(".")[0].split("_");return Si(be,Xt,vn,_n)})),n.$$.dirty[0]&24&&t(8,a=((q=l[V])==null?void 0:q.data[0])??null)},t(10,s="loading"),t(20,r=[]),t(7,c=[{id:"region",label:N==="en"?"Main view":"Vue principale"},{id:"page",label:N==="en"?"Page View":"Vue de la page"},{id:"similarity",label:N==="en"?"Comparison":"Comparaison"},{id:"expansion",label:N==="en"?"Query Expansion":"Expansion de requête"}]),[p,g,v,V,l,y,Z,c,a,o,s,i,w,S,P,T,I,A,Y,H,r,u,h,f,d,se,z]}class Vl extends ae{constructor(e){super(),oe(this,e,ed,Zf,le,{qImg:0,sImgsPromise:1,isInModal:2},null,[-1,-1])}}function td(n){let e,t;return e=new Vl({props:{qImg:n[0],sImgsPromise:n[2],isInModal:n[1]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,[s]){const r={};s&1&&(r.qImg=i[0]),s&4&&(r.sImgsPromise=i[2]),s&2&&(r.isInModal=i[1]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function nd(n,e,t){let i,{qImg:s}=e,{isInModal:r=!1}=e,l;const{selectedRegions:o}=xe;ue(n,o,h=>t(4,i=h));const a=`${window.location.origin}${window.location.pathname}`,c=window.location.pathname.match(/\d+/g).join("-");async function u(h,f,d){const p=Object.values(f[c]||{}).map(v=>v.id);return!d&&p.length===0?[]:await(await fetch(`${a}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:p,filterByRegions:!d,qImg:h,topk:10}),headers:{"Content-Type":"application/json","X-CSRFToken":Xe}})).json()}return r?l=u(s,i,r):o.subscribe(h=>{t(2,l=u(s,h,r))}),n.$$set=h=>{"qImg"in h&&t(0,s=h.qImg),"isInModal"in h&&t(1,r=h.isInModal)},[s,r,l,o]}class id extends ae{constructor(e){super(),oe(this,e,nd,td,le,{qImg:0,isInModal:1})}}function sd(n){let e,t,i,s;return i=new Vl({props:{qImg:n[0],sImgsPromise:n[1]}}),{c(){e=b("div"),t=b("div"),x(i.$$.fragment),m(t,"class","matches-suggestion svelte-1cb4wg0"),m(e,"class","block matches-suggestion-wrapper svelte-1cb4wg0")},m(r,l){C(r,e,l),_(e,t),W(i,t,null),s=!0},p(r,[l]){const o={};l&1&&(o.qImg=r[0]),l&2&&(o.sImgsPromise=r[1]),i.$set(o)},i(r){s||(M(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&E(e),G(i)}}}function rd(n,e,t){let i,s,{qImg:r}=e,{isInModal:l=!1}=e;const{propagateParams:o,selectedRegions:a}=xe;ue(n,o,v=>t(5,i=v)),ue(n,a,v=>t(6,s=v));const c=`${window.location.origin}${window.location.pathname}`,u=window.location.pathname.match(/\d+/g).join("-");let h;const f=$n();f.setCompareFn((v,w)=>[v,w].every(S=>S&&S.hasOwnProperty("propagateRecursionDepth")&&S.hasOwnProperty("propagateFilterByRegions"))?v.propagateRecursionDepth===w.propagateRecursionDepth&&v.propagateFilterByRegions===w.propagateFilterByRegions:!1);const d=$n();d.setCompareFn(yi),at("similarityPropagatedContext",!0);const p=v=>Object.keys(v).includes(u)?Object.values(v[u]).map(w=>w.id):[],g=async(v,w,S)=>fetch(`${c}propagated-matches/${r}`,{method:"POST",body:JSON.stringify({regionsIds:S?[]:w,filterByRegions:S?!1:v.propagateFilterByRegions,recursionDepth:v.propagateRecursionDepth}),headers:{"Content-Type":"application/json","X-CSRFToken":Xe}}).then(P=>P.json()).catch(P=>(console.error("PropagatedMatches.getPropagatedMatches:",P),[]));return o.subscribe(v=>{f.set(v),f.same()||t(1,h=g(f.get(),p(s),l))}),a.subscribe(v=>{d.set(p(v)),i.propagateFilterByRegions===!0&&!d.same()&&t(1,h=g(i,d.get(),l))}),n.$$set=v=>{"qImg"in v&&t(0,r=v.qImg),"isInModal"in v&&t(4,l=v.isInModal)},[r,h,o,a,l]}class ld extends ae{constructor(e){super(),oe(this,e,rd,sd,le,{qImg:0,isInModal:4})}}const od=n=>({}),sr=n=>({}),ad=n=>({}),rr=n=>({}),cd=n=>({}),lr=n=>({});function ud(n){let e;const t=n[4]["row-body"],i=He(t,n,n[3],sr);return{c(){i&&i.c()},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&8)&&Be(i,t,s,s[3],e?qe(t,s[3],r,od):ze(s[3]),sr)},i(s){e||(M(i,s),e=!0)},o(s){R(i,s),e=!1},d(s){i&&i.d(s)}}}function fd(n){let e,t,i,s;const r=n[4]["row-body"],l=He(r,n,n[3],rr);return{c(){e=b("div"),t=b("div"),l&&l.c(),m(t,"class","grid is-gap-2"),m(e,"class",i="fixed-grid has-"+n[2]+"-cols")},m(o,a){C(o,e,a),_(e,t),l&&l.m(t,null),s=!0},p(o,a){l&&l.p&&(!s||a&8)&&Be(l,r,o,o[3],s?qe(r,o[3],a,ad):ze(o[3]),rr),(!s||a&4&&i!==(i="fixed-grid has-"+o[2]+"-cols"))&&m(e,"class",i)},i(o){s||(M(l,o),s=!0)},o(o){R(l,o),s=!1},d(o){o&&E(e),l&&l.d(o)}}}function dd(n){let e,t,i,s,r,l,o,a,c,u;st(n[5]);const h=n[4]["row-header"],f=He(h,n,n[3],lr),d=[fd,ud],p=[];function g(v,w){return v[0]?0:1}return l=g(n),o=p[l]=d[l](n),{c(){e=b("tr"),t=b("th"),i=b("div"),f&&f.c(),s=D(),r=b("td"),o.c(),m(i,"class","content-wrapper py-5"),m(t,"class","is-3 center-flex is-narrow"),ge(t,"width","15vw"),m(r,"class","p-5 is-fullwidth")},m(v,w){C(v,e,w),_(e,t),_(t,i),f&&f.m(i,null),_(e,s),_(e,r),p[l].m(r,null),a=!0,c||(u=ne(window,"resize",n[5]),c=!0)},p(v,[w]){f&&f.p&&(!a||w&8)&&Be(f,h,v,v[3],a?qe(h,v[3],w,cd):ze(v[3]),lr);let S=l;l=g(v),l===S?p[l].p(v,w):(_e(),R(p[S],1,1,()=>{p[S]=null}),ve(),o=p[l],o?o.p(v,w):(o=p[l]=d[l](v),o.c()),M(o,1),o.m(r,null))},i(v){a||(M(f,v),M(o),a=!0)},o(v){R(f,v),R(o),a=!1},d(v){v&&E(e),f&&f.d(v),p[l].d(),c=!1,u()}}}function hd(n,e,t){let i,{$$slots:s={},$$scope:r}=e,{useGrid:l=!0}=e,o=0;function a(){t(1,o=window.innerWidth)}return n.$$set=c=>{"useGrid"in c&&t(0,l=c.useGrid),"$$scope"in c&&t(3,r=c.$$scope)},n.$$.update=()=>{n.$$.dirty&2&&t(2,i=Zr(o))},[l,o,i,r,s,a]}class Fl extends ae{constructor(e){super(),oe(this,e,hd,dd,le,{useGrid:0})}}function md(n){let e,t,i,s=parseInt(n[6])+"",r,l,o,a,c,u,h,f,d,p,g,v,w,S,P,T,I,L,A;return{c(){e=b("a"),t=b("i"),i=J(`
            Page `),r=J(s),l=D(),o=b("img"),c=D(),u=b("div"),h=b("div"),f=b("input"),d=D(),p=b("button"),p.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',g=D(),v=b("button"),w=Ue("svg"),S=Ue("path"),m(t,"class","fa-solid fa-pen-to-square"),m(e,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),m(e,"href",Ht(n[7],parseInt(n[6]))),m(e,"target","_blank"),$e(o.src,a=dt(n[0],n[0].split("_").pop(),"250,"))||m(o,"src",a),m(o,"alt","Query region"),m(o,"class","mb-3 card query-image svelte-f4ylwc"),m(f,"class","input is-small tag"),m(f,"type","text"),m(f,"placeholder",N==="en"?"Add new match":"Ajouter une correspondance"),m(p,"class","button is-small tag is-link is-center"),m(h,"class","tags has-addons"),ge(h,"flex-wrap","nowrap"),m(S,"fill","white"),m(S,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),m(w,"xmlns","http://www.w3.org/2000/svg"),m(w,"viewBox","0 0 384 512"),m(v,"id","no-match"),m(v,"class",P="button is-small tag is-danger is-center m-0 "+(n[4]===1?"visible":"")+" svelte-f4ylwc"),m(v,"title",N==="en"?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),m(u,"class","new-similarity control pt-2 is-center svelte-f4ylwc")},m(y,F){C(y,e,F),_(e,t),_(e,i),_(e,r),C(y,l,F),C(y,o,F),C(y,c,F),C(y,u,F),_(u,h),_(h,f),Dt(f,n[2]),_(h,d),_(h,p),_(u,g),_(u,v),_(v,w),_(w,S),I=!0,L||(A=[ne(f,"input",n[12]),ne(p,"click",n[8]),ne(v,"click",n[9])],L=!0)},p(y,F){(!I||F&1&&!$e(o.src,a=dt(y[0],y[0].split("_").pop(),"250,")))&&m(o,"src",a),F&4&&f.value!==y[2]&&Dt(f,y[2]),(!I||F&16&&P!==(P="button is-small tag is-danger is-center m-0 "+(y[4]===1?"visible":"")+" svelte-f4ylwc"))&&m(v,"class",P)},i(y){I||(st(()=>{I&&(T||(T=vt(v,Vt,{duration:500},!0)),T.run(1))}),I=!0)},o(y){T||(T=vt(v,Vt,{duration:500},!1)),T.run(0),I=!1},d(y){y&&E(e),y&&E(l),y&&E(o),y&&E(c),y&&E(u),y&&T&&T.end(),L=!1,Ie(A)}}}function pd(n){let e,t,i,s,r,l,o,a;return t=new id({props:{qImg:n[0],isInModal:n[1]}}),l=new ld({props:{qImg:n[0],isInModal:n[1]}}),{c(){e=b("div"),x(t.$$.fragment),s=D(),r=b("div"),x(l.$$.fragment),m(e,"class",i=Sn(n[1]?"":n[3])+" svelte-f4ylwc"),m(r,"class",o=Sn(n[1]?"":n[3])+" svelte-f4ylwc")},m(c,u){C(c,e,u),W(t,e,null),C(c,s,u),C(c,r,u),W(l,r,null),a=!0},p(c,u){const h={};u&1&&(h.qImg=c[0]),u&2&&(h.isInModal=c[1]),t.$set(h),(!a||u&10&&i!==(i=Sn(c[1]?"":c[3])+" svelte-f4ylwc"))&&m(e,"class",i);const f={};u&1&&(f.qImg=c[0]),u&2&&(f.isInModal=c[1]),l.$set(f),(!a||u&10&&o!==(o=Sn(c[1]?"":c[3])+" svelte-f4ylwc"))&&m(r,"class",o)},i(c){a||(M(t.$$.fragment,c),M(l.$$.fragment,c),a=!0)},o(c){R(t.$$.fragment,c),R(l.$$.fragment,c),a=!1},d(c){c&&E(e),G(t),c&&E(s),c&&E(r),G(l)}}}function gd(n){let e,t;return e=new Fl({props:{useGrid:!1,$$slots:{"row-body":[pd],"row-header":[md]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,[s]){const r={};s&524319&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function _d(n){return n=n.replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(n)}function vd(n,e,t){let i,s,r,l;const{selectedRegions:o}=xe;ue(n,o,L=>t(11,l=L));let{qImg:a}=e,{isInModal:c=!1}=e,u="";const[h,f,d,p]=a.split(".")[0].split("_"),g=`${window.location.origin}${window.location.pathname}`,v=window.location.pathname.match(/\d+/g).join("-"),w=N==="en"?"Error":"Erreur",S=Je("manifest");at("qImgMetadata",Si(a,h,p,d));async function P(){if(!u||!_d(u)){await Re(N==="en"?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error");return}try{const L=await fetch(`${g}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify({q_img:a.replace(".jpg",""),s_img:u,similarity_type:2})});L.ok||(console.error("Error: Network response was not ok"),await Re(N==="en"?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",w));const A=await L.json();if(A.hasOwnProperty("error")||!A.hasOwnProperty("s_regions")){await Re(N==="en"?`Request was unsuccessful, match was not added:<br>${A.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${A.error}`,w);return}const y=A.s_regions;xe.addComparedRegions(y),xe.select(y)}catch(L){console.error("Error:",L),await Re(N==="en"?`An error has occurred, match was not added:<br>${L}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${L}`,w)}}async function T(){const L=Object.values(l[v])[0];if(await Re(N==="en"?`Do you confirm this region does not have any match in ${L.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${L.title} ?`,N==="en"?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${g}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Xe},body:JSON.stringify({q_img:a,s_regions:L.id})})).ok||(console.error("Error: Network response was not ok"),await Re(N==="en"?"Problem with network":"Problème de réseau",w)),xe.select(L)}catch(y){console.error("Error:",y),await Re(N==="en"?`An error has occurred, request was unsuccessful:<br>${y}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${y}`,w)}}function I(){u=this.value,t(2,u)}return n.$$set=L=>{"qImg"in L&&t(0,a=L.qImg),"isInModal"in L&&t(1,c=L.isInModal)},n.$$.update=()=>{n.$$.dirty&2048&&t(4,i=l.hasOwnProperty(v)?Object.values(l[v]).length:0),n.$$.dirty&1024&&t(3,r=`fixed-grid has-${s-1}-cols`)},t(10,s=Zr(window.innerWidth)),[a,c,u,r,i,o,d,S,P,T,s,l,I]}class Ul extends ae{constructor(e){super(),oe(this,e,vd,gd,le,{qImg:0,isInModal:1})}}function or(n,e,t){const i=n.slice();return i[8]=e[t],i}function bd(n){let e,t,i=n[11]+"",s;return{c(){e=b("tr"),t=J("Error when retrieving similar regions: "),s=J(i)},m(r,l){C(r,e,l),_(e,t),_(e,s)},p(r,l){l&2&&i!==(i=r[11]+"")&&fe(s,i)},i:j,o:j,d(r){r&&E(e)}}}function wd(n){let e=[],t=new Map,i,s,r=n[2];const l=a=>a[8].id;for(let a=0;a<r.length;a+=1){let c=or(n,r,a),u=l(c);t.set(u,e[a]=cr(u,c))}let o=null;return r.length||(o=ar()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();i=pe(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);C(a,i,c),o&&o.m(a,c),s=!0},p(a,c){c&4&&(r=a[2],_e(),e=mn(e,c,l,1,a,r,t,i.parentNode,Fn,cr,i,or),ve(),!r.length&&o?o.p(a,c):r.length?o&&(o.d(1),o=null):(o=ar(),o.c(),o.m(i.parentNode,i)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)M(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)R(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&E(i),o&&o.d(a)}}}function ar(n){let e,t;return{c(){e=b("tr"),e.textContent=`${N==="en"?"No similarity":"Pas de similarités"}`,t=D(),m(e,"class","faded is-center")},m(i,s){C(i,e,s),C(i,t,s)},p:j,d(i){i&&E(e),i&&E(t)}}}function cr(n,e){let t,i,s;return i=new Ul({props:{qImg:e[8]}}),{key:n,first:null,c(){t=pe(),x(i.$$.fragment),this.first=t},m(r,l){C(r,t,l),W(i,r,l),s=!0},p(r,l){e=r;const o={};l&4&&(o.qImg=e[8]),i.$set(o)},i(r){s||(M(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&E(t),G(i,r)}}}function yd(n){let e;return{c(){e=b("tr"),e.textContent=`${N==="en"?"Retrieving similarity page...":"Récupération la page de similarité..."}`,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,i:j,o:j,d(t){t&&E(e)}}}function kd(n){let e,t,i,s={ctx:n,current:null,token:null,hasCatch:!0,pending:yd,then:wd,catch:bd,value:7,error:11,blocks:[,,,]};return Ze(t=n[1],s),{c(){e=pe(),s.block.c()},m(r,l){C(r,e,l),s.block.m(r,s.anchor=l),s.mount=()=>e.parentNode,s.anchor=e,i=!0},p(r,l){n=r,s.ctx=n,l&2&&t!==(t=n[1])&&Ze(t,s)||At(s,n,l)},i(r){i||(M(s.block),i=!0)},o(r){for(let l=0;l<3;l+=1){const o=s.blocks[l];R(o)}i=!1},d(r){r&&E(e),s.block.d(r),s.token=null,s=null}}}function Sd(n){let e,t,i,s,r,l,o;return t=new qt({props:{store:xe,nbOfItems:n[0].length,pageLength:n[6]}}),s=new Un({props:{$$slots:{default:[kd]},$$scope:{ctx:n}}}),l=new qt({props:{store:xe,nbOfItems:n[0].length,pageLength:n[6]}}),{c(){e=b("div"),x(t.$$.fragment),i=D(),x(s.$$.fragment),r=D(),x(l.$$.fragment)},m(a,c){C(a,e,c),W(t,e,null),_(e,i),W(s,e,null),_(e,r),W(l,e,null),o=!0},p(a,[c]){const u={};c&1&&(u.nbOfItems=a[0].length),t.$set(u);const h={};c&4102&&(h.$$scope={dirty:c,ctx:a}),s.$set(h);const f={};c&1&&(f.nbOfItems=a[0].length),l.$set(f)},i(a){o||(M(t.$$.fragment,a),M(s.$$.fragment,a),M(l.$$.fragment,a),o=!0)},o(a){R(t.$$.fragment,a),R(s.$$.fragment,a),R(l.$$.fragment,a),o=!1},d(a){a&&E(e),G(t),G(s),G(l)}}}function Ed(n,e,t){let i,s,r;const{qImgs:l,pageQImgs:o,setPageQImgs:a,pageLength:c}=xe;return ue(n,l,u=>t(0,i=u)),ue(n,o,u=>t(2,r=u)),ue(n,a,u=>t(1,s=u)),[i,s,r,l,o,a,c]}class Cd extends ae{constructor(e){super(),oe(this,e,Ed,Sd,le,{})}}function Id(n){let e,t,i,s,r,l;return r=new pn({props:{tooltipText:n[2]}}),{c(){e=b("div"),t=b("button"),i=b("span"),s=D(),x(r.$$.fragment),m(i,"class","iconify"),m(i,"data-icon",n[0]),m(i,"title",n[1]),m(t,"class","svelte-11ixywk"),m(e,"class","is-inline-block icon-tooltip svelte-11ixywk")},m(o,a){C(o,e,a),_(e,t),_(t,i),_(t,s),W(r,t,null),l=!0},p(o,[a]){(!l||a&1)&&m(i,"data-icon",o[0]),(!l||a&2)&&m(i,"title",o[1]);const c={};a&4&&(c.tooltipText=o[2]),r.$set(c)},i(o){l||(M(r.$$.fragment,o),l=!0)},o(o){R(r.$$.fragment,o),l=!1},d(o){o&&E(e),G(r)}}}function Od(n,e,t){let{iconifyIcon:i,altText:s,tooltipText:r}=e;return n.$$set=l=>{"iconifyIcon"in l&&t(0,i=l.iconifyIcon),"altText"in l&&t(1,s=l.altText),"tooltipText"in l&&t(2,r=l.tooltipText)},[i,s,r]}class Ad extends ae{constructor(e){super(),oe(this,e,Od,Id,le,{iconifyIcon:0,altText:1,tooltipText:2})}}const Td=n=>({}),ur=n=>({}),Md=n=>({}),fr=n=>({});function dr(n){let e,t,i,s,r,l,o,a,c,u,h,f=n[1]&&hr(n);return a=new pn({props:{tooltipText:n[2][n[1]][N]}}),{c(){f&&f.c(),e=D(),t=b("div"),i=b("button"),s=Ue("svg"),r=Ue("path"),o=D(),x(a.$$.fragment),m(r,"fill","none"),m(r,"stroke","currentColor"),m(r,"stroke-linecap","round"),m(r,"stroke-linejoin","round"),m(r,"stroke-width","1.5"),m(r,"d","M12 3v18m0 0l8.5-8.5M12 21l-8.5-8.5"),m(s,"style",l=`transform: rotate(${n[1]?"180":"0"}deg)`),m(s,"xmlns","http://www.w3.org/2000/svg"),m(s,"width","24"),m(s,"height","24"),m(s,"viewBox","0 0 24 24"),m(s,"class","svelte-jbs1sd"),m(i,"class","button is-link svelte-jbs1sd"),m(t,"class","ctrl-toggle svelte-jbs1sd")},m(d,p){f&&f.m(d,p),C(d,e,p),C(d,t,p),_(t,i),_(i,s),_(s,r),_(i,o),W(a,i,null),c=!0,u||(h=ne(i,"click",wt(n[3])),u=!0)},p(d,p){d[1]?f?(f.p(d,p),p&2&&M(f,1)):(f=hr(d),f.c(),M(f,1),f.m(e.parentNode,e)):f&&(_e(),R(f,1,1,()=>{f=null}),ve()),(!c||p&2&&l!==(l=`transform: rotate(${d[1]?"180":"0"}deg)`))&&m(s,"style",l);const g={};p&2&&(g.tooltipText=d[2][d[1]][N]),a.$set(g)},i(d){c||(M(f),M(a.$$.fragment,d),c=!0)},o(d){R(f),R(a.$$.fragment,d),c=!1},d(d){f&&f.d(d),d&&E(e),d&&E(t),G(a),u=!1,h()}}}function hr(n){let e,t,i;const s=n[5]["toolbar-hidden"],r=He(s,n,n[4],ur);return{c(){e=b("div"),r&&r.c(),m(e,"class","ctrl-extra")},m(l,o){C(l,e,o),r&&r.m(e,null),i=!0},p(l,o){r&&r.p&&(!i||o&16)&&Be(r,s,l,l[4],i?qe(s,l[4],o,Td):ze(l[4]),ur)},i(l){i||(M(r,l),st(()=>{i&&(t||(t=vt(e,qi,{axis:"y"},!0)),t.run(1))}),i=!0)},o(l){R(r,l),t||(t=vt(e,qi,{axis:"y"},!1)),t.run(0),i=!1},d(l){l&&E(e),r&&r.d(l),l&&t&&t.end()}}}function Pd(n){let e,t,i,s,r,l,o,a;const c=n[5]["toolbar-visible"],u=He(c,n,n[4],fr);let h=n[0]&&dr(n);return{c(){e=b("div"),t=b("form"),i=b("div"),s=b("div"),r=b("div"),u&&u.c(),l=D(),h&&h.c(),m(r,"class","ctrl-block svelte-jbs1sd"),m(s,"class","ctrl-block-wrapper svelte-jbs1sd"),m(i,"class","ctrl-base"),m(t,"class","ctrl svelte-jbs1sd"),m(e,"id","toolbar"),m(e,"class",o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(n[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd")},m(f,d){C(f,e,d),_(e,t),_(t,i),_(i,s),_(s,r),u&&u.m(r,null),_(t,l),h&&h.m(t,null),a=!0},p(f,[d]){u&&u.p&&(!a||d&16)&&Be(u,c,f,f[4],a?qe(c,f[4],d,Md):ze(f[4]),fr),f[0]?h?(h.p(f,d),d&1&&M(h,1)):(h=dr(f),h.c(),M(h,1),h.m(t,null)):h&&(_e(),R(h,1,1,()=>{h=null}),ve()),(!a||d&2&&o!==(o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(f[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd"))&&m(e,"class",o)},i(f){a||(M(u,f),M(h),a=!0)},o(f){R(u,f),R(h),a=!1},d(f){f&&E(e),u&&u.d(f),h&&h.d()}}}function Ld(n,e,t){let i,{$$slots:s={},$$scope:r}=e,{expandable:l=!0}=e;const o={true:{en:"Collapse the toolbar",fr:"Refermer le menu"},false:{en:"Expand the toolbar",fr:"Ouvrir le menu"}},a=()=>t(1,i=!i);return n.$$set=c=>{"expandable"in c&&t(0,l=c.expandable),"$$scope"in c&&t(4,r=c.$$scope)},t(1,i=!1),[l,i,o,a,r,s]}class Rd extends ae{constructor(e){super(),oe(this,e,Ld,Pd,le,{expandable:0})}}function mr(n){let e,t;return e=new Ai({props:{choicesItems:n[4],multiple:!0,placeholder:"...",start:Object.keys(n[5][n[13]]||{}),lightDisplay:!0,title:N==="fr"?"Régions sélectionnées":"Selected regions",selectAll:!0}}),e.$on("updateValues",n[22]),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&16&&(r.choicesItems=i[4]),s&32&&(r.start=Object.keys(i[5][i[13]]||{})),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function $d(n){return{c:j,m:j,p:j,i:j,o:j,d:j}}function Dd(n){let e,t,i=n[28].length&&Nd(n);return{c(){i&&i.c(),e=pe()},m(s,r){i&&i.m(s,r),C(s,e,r),t=!0},p(s,r){s[28].length&&i.p(s,r)},i(s){t||(M(i),t=!0)},o(s){R(i),t=!1},d(s){i&&i.d(s),s&&E(e)}}}function Nd(n){let e,t;return e=new Et({props:{title:N==="fr"?"Score minimal":"Minimal score",minVal:n[28][0],maxVal:n[28][1],start:n[0]||n[28][0],roundTo:3}}),e.$on("updateSlider",n[18]),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&1&&(r.start=i[0]||i[28][0]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function jd(n){return{c:j,m:j,p:j,i:j,o:j,d:j}}function Vd(n){let e,t,i=Object.keys(n[4]).length,s,r,l,o=i&&mr(n),a={ctx:n,current:null,token:null,hasCatch:!1,pending:jd,then:Dd,catch:$d,value:28,blocks:[,,,]};return Ze(n[17],a),{c(){e=b("div"),t=b("div"),o&&o.c(),s=D(),r=b("div"),a.block.c(),m(t,"class","ctrl-input svelte-8yfni4"),m(r,"class","ctrl-input svelte-8yfni4"),m(e,"slot","toolbar-visible"),m(e,"class","ctrl-block-inputs svelte-8yfni4")},m(c,u){C(c,e,u),_(e,t),o&&o.m(t,null),_(e,s),_(e,r),a.block.m(r,a.anchor=null),a.mount=()=>r,a.anchor=null,l=!0},p(c,u){n=c,u&16&&(i=Object.keys(n[4]).length),i?o?(o.p(n,u),u&16&&M(o,1)):(o=mr(n),o.c(),M(o,1),o.m(t,null)):o&&(_e(),R(o,1,1,()=>{o=null}),ve()),At(a,n,u)},i(c){l||(M(o),M(a.block),l=!0)},o(c){R(o);for(let u=0;u<3;u+=1){const h=a.blocks[u];R(h)}l=!1},d(c){c&&E(e),o&&o.d(),a.block.d(),a.token=null,a=null}}}function Fd(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v,w,S,P,T,I,L,A;return a=new Ai({props:{choicesItems:n[15],multiple:!0,placeholder:"...",start:n[1],lightDisplay:!0,title:N==="fr"?"Catégories masquées":"Hidden categories",selectAll:!0}}),a.$on("updateValues",n[19]),g=new Ad({props:{iconifyIcon:"material-symbols:help-outline",altText:N==="en"?"Display help":"Afficher une explication",tooltipText:n[14]}}),P=new Et({props:{title:N==="fr"?"Profondeur de récursion":"Recursion depth",minVal:n[12][0],maxVal:n[12][1],start:n[2],step:1}}),P.$on("updateSlider",n[20]),L=new gl({props:{toggleLabel:N==="en"?"Filter by region":"Filtrer par région",start:n[3],buttonDisplay:!0}}),L.$on("updateChecked",n[21]),{c(){e=b("div"),t=b("div"),i=b("div"),s=b("span"),s.textContent=`${N==="en"?"Similarity":"Similarité"}`,r=D(),l=b("div"),o=b("div"),x(a.$$.fragment),c=D(),u=b("div"),h=b("div"),f=b("div"),d=b("span"),d.textContent="Propagation",p=D(),x(g.$$.fragment),v=D(),w=b("div"),S=b("div"),x(P.$$.fragment),T=D(),I=b("div"),x(L.$$.fragment),m(s,"class","tag is-medium is-link"),m(i,"class","ctrl-block-title svelte-8yfni4"),m(o,"class","ctrl-input svelte-8yfni4"),m(l,"class","ctrl-block-inputs svelte-8yfni4"),m(t,"class","ctrl-block svelte-8yfni4"),m(e,"class","ctrl-block-wrapper svelte-8yfni4"),m(d,"class","tag is-medium is-link mr-1"),m(f,"class","ctrl-block-title svelte-8yfni4"),m(S,"class","ctrl-input svelte-8yfni4"),m(I,"class","ctrl-input svelte-8yfni4"),m(w,"class","ctrl-block-inputs svelte-8yfni4"),m(h,"class","ctrl-block svelte-8yfni4"),m(u,"class","ctrl-block-wrapper svelte-8yfni4")},m(y,F){C(y,e,F),_(e,t),_(t,i),_(i,s),_(t,r),_(t,l),_(l,o),W(a,o,null),C(y,c,F),C(y,u,F),_(u,h),_(h,f),_(f,d),_(f,p),W(g,f,null),_(h,v),_(h,w),_(w,S),W(P,S,null),_(w,T),_(w,I),W(L,I,null),A=!0},p(y,F){const K={};F&2&&(K.start=y[1]),a.$set(K);const re={};F&4&&(re.start=y[2]),P.$set(re);const U={};F&8&&(U.start=y[3]),L.$set(U)},i(y){A||(M(a.$$.fragment,y),M(g.$$.fragment,y),M(P.$$.fragment,y),M(L.$$.fragment,y),A=!0)},o(y){R(a.$$.fragment,y),R(g.$$.fragment,y),R(P.$$.fragment,y),R(L.$$.fragment,y),A=!1},d(y){y&&E(e),G(a),y&&E(c),y&&E(u),G(g),G(P),G(L)}}}function Ud(n){let e,t;return e=new Rd({props:{$$slots:{"toolbar-hidden":[Fd],"toolbar-visible":[Vd]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,[s]){const r={};s&536870975&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function pr(){const n=document.getElementById("nav-actions");n&&document.documentElement.style.setProperty("--top-offset",`${n.offsetHeight}px`)}function Hd(n,e,t){let i,s,r,l,o,a,c,u;const{selectedRegions:h,comparedRegions:f,excludedCategories:d,similarityScoreCutoff:p,propagateRecursionDepth:g,propagateFilterByRegions:v,allowedPropagateDepthRange:w}=xe;ue(n,h,V=>t(5,u=V)),ue(n,f,V=>t(25,s=V)),ue(n,d,V=>t(1,l=V)),ue(n,p,V=>t(23,r=V)),ue(n,g,V=>t(2,o=V)),ue(n,v,V=>t(3,a=V));let S;rt(()=>{pr(),S=new ResizeObserver(()=>{pr()});const V=document.getElementById("nav-actions");return V&&S.observe(V),()=>{S&&V&&(S.unobserve(V),S.disconnect())}});const P=window.location.pathname.match(/\d+/g).join("-"),T=`${window.location.origin}${window.location.pathname}`,I=N==="en"?"Propagated matches are exact matches to images that have an exact match with the current image. There may be up to 6 exact matches connecting the current image and propagated images.":"Les correspondances propagées correspondent à des correspondances exactes à des images ayant une correspondance exacte avec l'image actuelle. Il peut y avoir jusqu'à 6 images reliant l'image actuelle à une correspondance propagée.",L=[{value:1,label:cl,prefix:sl,prefixType:"svg"},{value:2,label:ul,prefix:rl,prefixType:"svg"},{value:3,label:fl,prefix:ll,prefixType:"svg"},{value:4,label:dl,prefix:ol,prefixType:"svg"},{value:5,label:hl,prefix:al,prefixType:"svg"}],A=Ye(f,V=>Object.entries(V).map(([H,se])=>({prefix:`#${se.id}`,prefixType:"text",value:H,label:Jr(se.title.replace(/^[^|]+/,""))})));ue(n,A,V=>t(4,c=V));const y=F();async function F(){let V=[];return await fetch(`${T}similarity-score-range`).then(H=>H.json()).then(H=>(V=[H.min,H.max],V.every(se=>typeof se=="number")?t(0,i=r&&V[0]<=r&&V[1]>=r?r:V[0]):(console.error(`fetchSimilarityScoreRange: expected '[number, number]', got '${V}'. Defaulting to '[]'`),V=[]),V)).catch(H=>(console.error("Error on fetchSimilarityScoreRange:",H),errorMsg.set(H.message),V))}const K=V=>p.set(V.detail),re=V=>d.set(V.detail),U=V=>g.set(V.detail),Y=V=>v.set(V.detail),Z=V=>{const H=V.detail,se={[P]:{}};Object.keys(s).forEach(z=>{H.includes(z)&&(se[P][z]=s[z])}),h.set(se)};return n.$$.update=()=>{n.$$.dirty&8388608&&t(0,i=r||void 0)},[i,l,o,a,c,u,h,f,d,p,g,v,w,P,I,L,A,y,K,re,U,Y,Z,r]}class qd extends ae{constructor(e){super(),oe(this,e,Hd,Ud,le,{})}}function Bd(n){let e=Object.keys(n[0]).length,t,i,s,r,l,o=e&&gr();const a=[Wd,Kd,zd],c=[];function u(h,f){return h[1]?0:h[2]?1:2}return i=u(n),s=c[i]=a[i](n),{c(){o&&o.c(),t=D(),s.c(),r=pe()},m(h,f){o&&o.m(h,f),C(h,t,f),c[i].m(h,f),C(h,r,f),l=!0},p(h,f){f&1&&(e=Object.keys(h[0]).length),e?o?f&1&&M(o,1):(o=gr(),o.c(),M(o,1),o.m(t.parentNode,t)):o&&(_e(),R(o,1,1,()=>{o=null}),ve());let d=i;i=u(h),i===d?c[i].p(h,f):(_e(),R(c[d],1,1,()=>{c[d]=null}),ve(),s=c[i],s?s.p(h,f):(s=c[i]=a[i](h),s.c()),M(s,1),s.m(r.parentNode,r))},i(h){l||(M(o),M(s),l=!0)},o(h){R(o),R(s),l=!1},d(h){o&&o.d(h),h&&E(t),c[i].d(h),h&&E(r)}}}function gr(n){let e,t;return e=new qd({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function zd(n){let e,t;return e=new Cd({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Kd(n){let e,t;return e=new Un({props:{$$slots:{default:[xd]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&36&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Wd(n){let e,t;return e=new Un({props:{$$slots:{default:[Jd]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&32&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Gd(n){let e,t;return{c(){e=J("Erreur lors de la récupération des similarités : "),t=J(n[2])},m(i,s){C(i,e,s),C(i,t,s)},p(i,s){s&4&&fe(t,i[2])},d(i){i&&E(e),i&&E(t)}}}function Yd(n){let e,t;return{c(){e=J("Error when retrieving similarities: "),t=J(n[2])},m(i,s){C(i,e,s),C(i,t,s)},p(i,s){s&4&&fe(t,i[2])},d(i){i&&E(e),i&&E(t)}}}function xd(n){let e;function t(r,l){return N==="en"?Yd:Gd}let s=t()(n);return{c(){e=b("tr"),s.c(),m(e,"class","faded is-center")},m(r,l){C(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},d(r){r&&E(e),s.d()}}}function Jd(n){let e;return{c(){e=b("tr"),e.textContent=`${N==="en"?"Retrieving similarities...":"Récupération des similarités..."}`,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,d(t){t&&E(e)}}}function Xd(n){let e=Ft.includes("similarity"),t,i,s=e&&Bd(n);return{c(){s&&s.c(),t=pe()},m(r,l){s&&s.m(r,l),C(r,t,l),i=!0},p(r,[l]){e&&s.p(r,l)},i(r){i||(M(s),i=!0)},o(r){R(s),i=!1},d(r){s&&s.d(r),r&&E(t)}}}function Qd(n,e,t){let i,s,r;ue(n,Ot,a=>t(1,s=a)),ue(n,Yr,a=>t(2,r=a));const{fetchSimilarity:l,comparedRegions:o}=xe;return ue(n,o,a=>t(0,i=a)),rt(()=>{Ft.includes("similarity")&&l()}),[i,s,r,o]}class Zd extends ae{constructor(e){super(),oe(this,e,Qd,Xd,le,{})}}function _r(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}function vr(n,e){let t,i,s;return i=new Bt({props:{item:new Dn(e[15]),index:e[17],height:e[2],copyable:e[4],selectable:e[3],selectionStore:e[0]}}),i.$on("openModal",e[8]),{key:n,first:null,c(){t=pe(),x(i.$$.fragment),this.first=t},m(r,l){C(r,t,l),W(i,r,l),s=!0},p(r,l){e=r;const o={};l&2&&(o.item=new Dn(e[15])),l&2&&(o.index=e[17]),l&4&&(o.height=e[2]),l&16&&(o.copyable=e[4]),l&8&&(o.selectable=e[3]),l&1&&(o.selectionStore=e[0]),i.$set(o)},i(r){s||(M(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&E(t),G(i,r)}}}function eh(n){let e,t;return e=new pl({props:{item:n[13]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&8192&&(r.item=i[13]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function th(n){let e,t,i;return t=new Bt({props:{item:n[13],height:"full",isInModal:!0,selectable:!1}}),{c(){e=b("div"),x(t.$$.fragment),m(e,"class","modal-region svelte-jba7xn")},m(s,r){C(s,e,r),W(t,e,null),i=!0},p(s,r){const l={};r&8192&&(l.item=s[13]),t.$set(l)},i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){R(t.$$.fragment,s),i=!1},d(s){s&&E(e),G(t)}}}function nh(n){let e,t,i,s;const r=[th,eh],l=[];function o(a,c){return a[14]==="region"?0:a[14]==="page"?1:-1}return~(e=o(n))&&(t=l[e]=r[e](n)),{c(){t&&t.c(),i=pe()},m(a,c){~e&&l[e].m(a,c),C(a,i,c),s=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(t&&(_e(),R(l[u],1,1,()=>{l[u]=null}),ve()),~e?(t=l[e],t?t.p(a,c):(t=l[e]=r[e](a),t.c()),M(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(M(t),s=!0)},o(a){R(t),s=!1},d(a){~e&&l[e].d(a),a&&E(i)}}}function ih(n){let e,t;return e=new jl({props:{tabs:n[7],$$slots:{default:[nh,({activeTab:i})=>({14:i}),({activeTab:i})=>i?16384:0]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&128&&(r.tabs=i[7]),s&286720&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function sh(n){let e=[],t=new Map,i,s,r,l,o,a=Object.values(n[1]);const c=d=>d[15].id;for(let d=0;d<a.length;d+=1){let p=_r(n,a,d),g=c(p);t.set(g,e[d]=vr(g,p))}function u(d){n[10](d)}function h(d){n[11](d)}let f={items:n[1],$$slots:{default:[ih,({item:d})=>({13:d}),({item:d})=>d?8192:0]},$$scope:{ctx:n}};return n[6]!==void 0&&(f.currentIndex=n[6]),n[5]!==void 0&&(f.open=n[5]),s=new Ei({props:f}),ft.push(()=>jt(s,"currentIndex",u)),ft.push(()=>jt(s,"open",h)),s.$on("navigate",n[9]),{c(){for(let d=0;d<e.length;d+=1)e[d].c();i=D(),x(s.$$.fragment)},m(d,p){for(let g=0;g<e.length;g+=1)e[g]&&e[g].m(d,p);C(d,i,p),W(s,d,p),o=!0},p(d,[p]){p&287&&(a=Object.values(d[1]),_e(),e=mn(e,p,c,1,d,a,t,i.parentNode,Fn,vr,i,_r),ve());const g={};p&2&&(g.items=d[1]),p&270464&&(g.$$scope={dirty:p,ctx:d}),!r&&p&64&&(r=!0,g.currentIndex=d[6],Nt(()=>r=!1)),!l&&p&32&&(l=!0,g.open=d[5],Nt(()=>l=!1)),s.$set(g)},i(d){if(!o){for(let p=0;p<a.length;p+=1)M(e[p]);M(s.$$.fragment,d),o=!0}},o(d){for(let p=0;p<e.length;p+=1)R(e[p]);R(s.$$.fragment,d),o=!1},d(d){for(let p=0;p<e.length;p+=1)e[p].d(d);d&&E(i),G(s,d)}}}function rh(n,e,t){let i,{selectionStore:s=gt}=e,{items:r=[]}=e,{height:l=96}=e,{selectable:o=!0}=e,{copyable:a=!0}=e,c=!1,u=0;const h=g=>{t(6,u=g.detail.index??0),t(5,c=!0)},f=g=>{t(6,u=g.detail.index)};function d(g){u=g,t(6,u)}function p(g){c=g,t(5,c)}return n.$$set=g=>{"selectionStore"in g&&t(0,s=g.selectionStore),"items"in g&&t(1,r=g.items),"height"in g&&t(2,l=g.height),"selectable"in g&&t(3,o=g.selectable),"copyable"in g&&t(4,a=g.copyable)},t(7,i=[{id:"region",label:N==="en"?"Main view":"Vue principale"},{id:"page",label:N==="en"?"Page View":"Vue de la page"}]),[s,r,l,o,a,c,u,i,h,f,d,p]}class Hl extends ae{constructor(e){super(),oe(this,e,rh,sh,le,{selectionStore:0,items:1,height:2,selectable:3,copyable:4})}}function br(n,e,t){const i=n.slice();return i[10]=e[t][0],i[11]=e[t][1],i}function lh(n){let e,t=N==="en"?`Error when retrieving paginated regions: ${n[14]}`:`Erreur de récupération des pages : ${n[14]}`,i;return{c(){e=b("tr"),i=J(t),m(e,"class","faded is-center")},m(s,r){C(s,e,r),_(e,i)},p(s,r){r&1&&t!==(t=N==="en"?`Error when retrieving paginated regions: ${s[14]}`:`Erreur de récupération des pages : ${s[14]}`)&&fe(i,t)},i:j,o:j,d(s){s&&E(e)}}}function oh(n){let e,t,i,s,r;const l=[ch,ah],o=[];function a(c,u){return u&2&&(e=null),e==null&&(e=Object.values(c[1]).length>0),e?0:1}return t=a(n,-1),i=o[t]=l[t](n),{c(){i.c(),s=pe()},m(c,u){o[t].m(c,u),C(c,s,u),r=!0},p(c,u){let h=t;t=a(c,u),t===h?o[t].p(c,u):(_e(),R(o[h],1,1,()=>{o[h]=null}),ve(),i=o[t],i?i.p(c,u):(i=o[t]=l[t](c),i.c()),M(i,1),i.m(s.parentNode,s))},i(c){r||(M(i),r=!0)},o(c){R(i),r=!1},d(c){o[t].d(c),c&&E(s)}}}function ah(n){let e,t,i;return t=new il({}),{c(){e=b("tr"),x(t.$$.fragment)},m(s,r){C(s,e,r),W(t,e,null),i=!0},p:j,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){R(t.$$.fragment,s),i=!1},d(s){s&&E(e),G(t)}}}function ch(n){let e,t,i=Object.entries(n[1]),s=[];for(let l=0;l<i.length;l+=1)s[l]=wr(br(n,i,l));const r=l=>R(s[l],1,1,()=>{s[l]=null});return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=pe()},m(l,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(l,o);C(l,e,o),t=!0},p(l,o){if(o&98){i=Object.entries(l[1]);let a;for(a=0;a<i.length;a+=1){const c=br(l,i,a);s[a]?(s[a].p(c,o),M(s[a],1)):(s[a]=wr(c),s[a].c(),M(s[a],1),s[a].m(e.parentNode,e))}for(_e(),a=i.length;a<s.length;a+=1)r(a);ve()}},i(l){if(!t){for(let o=0;o<i.length;o+=1)M(s[o]);t=!0}},o(l){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)R(s[o]);t=!1},d(l){et(s,l),l&&E(e)}}}function uh(n){let e,t,i,s,r,l,o,a,c=n[10]+"",u,h,f;return{c(){e=b("img"),s=D(),r=b("div"),l=b("a"),o=b("i"),a=J(`
                                Page `),u=J(c),f=D(),$e(e.src,t=dt(n[5](n[10]),"full","250,"))||m(e,"src",t),m(e,"alt",i="Canvas "+n[10]),m(e,"class","mb-3 card"),m(o,"class","fa-solid fa-pen-to-square"),m(l,"class","tag px-2 py-1 is-rounded is-hoverable"),m(l,"href",h=Ht(n[6],n[10])),m(l,"target","_blank"),m(r,"class","is-center mb-1")},m(d,p){C(d,e,p),C(d,s,p),C(d,r,p),_(r,l),_(l,o),_(l,a),_(l,u),C(d,f,p)},p(d,p){p&2&&!$e(e.src,t=dt(d[5](d[10]),"full","250,"))&&m(e,"src",t),p&2&&i!==(i="Canvas "+d[10])&&m(e,"alt",i),p&2&&c!==(c=d[10]+"")&&fe(u,c),p&2&&h!==(h=Ht(d[6],d[10]))&&m(l,"href",h)},d(d){d&&E(e),d&&E(s),d&&E(r),d&&E(f)}}}function fh(n){let e,t,i;return e=new Hl({props:{items:Object.values(n[11])}}),{c(){x(e.$$.fragment),t=D()},m(s,r){W(e,s,r),C(s,t,r),i=!0},p(s,r){const l={};r&2&&(l.items=Object.values(s[11])),e.$set(l)},i(s){i||(M(e.$$.fragment,s),i=!0)},o(s){R(e.$$.fragment,s),i=!1},d(s){G(e,s),s&&E(t)}}}function wr(n){let e,t;return e=new Fl({props:{$$slots:{"row-body":[fh],"row-header":[uh]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&32770&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function dh(n){let e;return{c(){e=b("tr"),e.textContent=`${N==="en"?"Retrieving paginated regions...":"Récupération des pages..."}`,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,i:j,o:j,d(t){t&&E(e)}}}function hh(n){let e,t,i,s={ctx:n,current:null,token:null,hasCatch:!0,pending:dh,then:oh,catch:lh,value:9,error:14,blocks:[,,,]};return Ze(t=n[0],s),{c(){e=pe(),s.block.c()},m(r,l){C(r,e,l),s.block.m(r,s.anchor=l),s.mount=()=>e.parentNode,s.anchor=e,i=!0},p(r,l){n=r,s.ctx=n,l&1&&t!==(t=n[0])&&Ze(t,s)||At(s,n,l)},i(r){i||(M(s.block),i=!0)},o(r){for(let l=0;l<3;l+=1){const o=s.blocks[l];R(o)}i=!1},d(r){r&&E(e),s.block.d(r),s.token=null,s=null}}}function mh(n){let e,t,i,s,r,l;return e=new qt({props:{store:bt,nbOfItems:n[4]}}),i=new Un({props:{$$slots:{default:[hh]},$$scope:{ctx:n}}}),r=new qt({props:{store:bt,nbOfItems:n[4]}}),{c(){x(e.$$.fragment),t=D(),x(i.$$.fragment),s=D(),x(r.$$.fragment)},m(o,a){W(e,o,a),C(o,t,a),W(i,o,a),C(o,s,a),W(r,o,a),l=!0},p(o,[a]){const c={};a&32771&&(c.$$scope={dirty:a,ctx:o}),i.$set(c)},i(o){l||(M(e.$$.fragment,o),M(i.$$.fragment,o),M(r.$$.fragment,o),l=!0)},o(o){R(e.$$.fragment,o),R(i.$$.fragment,o),R(r.$$.fragment,o),l=!1},d(o){G(e,o),o&&E(t),G(i,o),o&&E(s),G(r,o)}}}function ph(n,e,t){let i,s;const{pageRegions:r,fetchPages:l}=bt;ue(n,r,f=>t(1,s=f)),ue(n,l,f=>t(0,i=f));const o=Je("nbOfPages"),a=Je("trailingZeros"),c=(f,d)=>f.toString().padStart(d,"0");function u(f){return`${imgPrefix}_${c(f,a)}`}const h=Je("manifest");return[i,s,r,l,o,u,h]}class gh extends ae{constructor(e){super(),oe(this,e,ph,mh,le,{})}}function _h(n){let e,t,i,s,r=N==="en"?"Save selection":"Sauvegarder la sélection",l,o,a;return{c(){e=b("button"),t=b("span"),i=b("i"),s=D(),l=J(r),m(i,"class","fa-solid fa-floppy-disk"),m(e,"class","button is-link")},m(c,u){C(c,e,u),_(e,t),_(t,i),_(t,s),_(t,l),o||(a=ne(e,"click",n[7]),o=!0)},p:j,d(c){c&&E(e),o=!1,a()}}}function vh(n){let e,t,i,s,r=N==="en"?"Go to treatment":"Accéder au traitement",l,o;return{c(){var a;e=b("a"),t=b("span"),i=b("i"),s=D(),l=J(r),m(i,"class","fa-solid fa-gear"),m(e,"class","button is-link"),m(e,"href",o="/"+Ve+"/treatment/add/?document_set="+((a=n[3])==null?void 0:a.id))},m(a,c){C(a,e,c),_(e,t),_(t,i),_(t,s),_(t,l)},p(a,c){var u;c&8&&o!==(o="/"+Ve+"/treatment/add/?document_set="+((u=a[3])==null?void 0:u.id))&&m(e,"href",o)},d(a){a&&E(e)}}}function yr(n){let e,t,i,s,r,l,o;return{c(){var a,c;e=b("a"),t=b("span"),t.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',s=D(),r=b("a"),l=b("span"),l.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',m(e,"class","button is-link is-dark"),m(e,"href",i="/"+Ve+"/document-set/"+((a=n[3])==null?void 0:a.id)+"/json"),m(e,"target","_blank"),m(r,"class","button is-link is-dark"),m(r,"href",o="/"+Ve+"/document-set/"+((c=n[3])==null?void 0:c.id)+"/zip"),m(r,"target","_blank")},m(a,c){C(a,e,c),_(e,t),C(a,s,c),C(a,r,c),_(r,l)},p(a,c){var u,h;c&8&&i!==(i="/"+Ve+"/document-set/"+((u=a[3])==null?void 0:u.id)+"/json")&&m(e,"href",i),c&8&&o!==(o="/"+Ve+"/document-set/"+((h=a[3])==null?void 0:h.id)+"/zip")&&m(r,"href",o)},d(a){a&&E(e),a&&E(s),a&&E(r)}}}function bh(n){let e,t,i,s,r,l,o;function a(f,d){return f[2]&&!f[1]?vh:_h}let c=a(n),u=c(n),h=!n[1]&&yr(n);return{c(){e=b("footer"),t=b("div"),i=b("button"),i.textContent=`${N==="en"?"Clear selection":"Vider la sélection"}`,s=D(),u.c(),r=D(),h&&h.c(),m(i,"class","button button-close is-link is-light"),m(t,"class","buttons"),m(e,"class","modal-card-foot is-center")},m(f,d){C(f,e,d),_(e,t),_(t,i),_(t,s),u.m(t,null),_(t,r),h&&h.m(t,null),l||(o=ne(i,"click",n[6]),l=!0)},p(f,[d]){c===(c=a(f))&&u?u.p(f,d):(u.d(1),u=c(f),u&&(u.c(),u.m(t,r))),f[1]?h&&(h.d(1),h=null):h?h.p(f,d):(h=yr(f),h.c(),h.m(t,null))},i:j,o:j,d(f){f&&E(e),u.d(),h&&h.d(),l=!1,o()}}}function wh(n,e,t){let i,s,{selectionStore:r}=e;const{isSaved:l,selection:o}=r;ue(n,l,h=>t(2,i=h)),ue(n,o,h=>t(3,s=h));let{isRegion:a=r.type!=="documentSet"}=e;const c=()=>r.empty(),u=()=>r.save();return n.$$set=h=>{"selectionStore"in h&&t(0,r=h.selectionStore),"isRegion"in h&&t(1,a=h.isRegion)},[r,a,i,s,l,o,c,u]}class yh extends ae{constructor(e){super(),oe(this,e,wh,bh,le,{selectionStore:0,isRegion:1})}}function kr(n,e,t){const i=n.slice();return i[31]=e[t],i}function Sr(n,e,t){const i=n.slice();return i[31]=e[t],i}function kh(n){let e,t,i,s,r,l;return{c(){e=b("span"),t=J(n[10]),i=D(),s=b("span"),s.innerHTML='<i class="fas fa-edit"></i>',m(s,"class","pl-3 smaller has-text-link")},m(o,a){C(o,e,a),_(e,t),_(e,i),_(e,s),r||(l=[ne(e,"click",n[14]),ne(e,"keyup",null)],r=!0)},p(o,a){a[0]&1024&&fe(t,o[10])},d(o){o&&E(e),r=!1,Ie(l)}}}function Sh(n){let e,t,i;return{c(){e=b("input"),m(e,"class","input selection-title svelte-fumu7c")},m(s,r){C(s,e,r),n[23](e),Dt(e,n[5]),t||(i=[ne(e,"input",n[24]),ne(e,"keydown",n[15]),ne(e,"blur",n[16])],t=!0)},p(s,r){r[0]&32&&e.value!==s[5]&&Dt(e,s[5])},d(s){s&&E(e),n[23](null),t=!1,Ie(i)}}}function Er(n){let e,t,i;function s(){return n[25](n[31])}return{c(){e=b("button"),m(e,"class","tag is-delete is-link ml-0")},m(r,l){C(r,e,l),t||(i=ne(e,"click",s),t=!0)},p(r,l){n=r},d(r){r&&E(e),t=!1,i()}}}function Cr(n,e){let t,i,s=e[31].username+"",r,l,o,a=e[9]&&Er(e);return{key:n,first:null,c(){t=b("div"),i=b("span"),r=J(s),l=D(),a&&a.c(),o=D(),m(i,"class","tag"),m(t,"class","tags has-addons svelte-fumu7c"),this.first=t},m(c,u){C(c,t,u),_(t,i),_(i,r),_(t,l),a&&a.m(t,null),_(t,o)},p(c,u){e=c,u[0]&256&&s!==(s=e[31].username+"")&&fe(r,s),e[9]?a?a.p(e,u):(a=Er(e),a.c(),a.m(t,o)):a&&(a.d(1),a=null)},d(c){c&&E(t),a&&a.d()}}}function Ir(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g=N==="en"?"Make public":"Rendre public",v,w,S,P=n[7].length>0&&Or(n);return{c(){var T;e=b("div"),t=b("div"),i=b("div"),s=b("p"),r=b("input"),l=D(),o=b("span"),o.innerHTML='<i class="fas fa-search"></i>',a=D(),P&&P.c(),c=D(),u=b("div"),h=b("label"),f=b("input"),p=D(),v=J(g),m(r,"class","input svelte-fumu7c"),m(r,"placeholder","Search users…"),m(o,"class","icon is-small is-right"),m(s,"class","control is-expanded has-icons-right"),m(i,"class","field"),m(t,"class","dropdown-trigger"),m(e,"class","dropdown is-active"),m(f,"type","checkbox"),f.checked=d=(T=n[2])==null?void 0:T.is_public,m(h,"class","checkbox"),m(u,"class","field mt-3 is-right")},m(T,I){C(T,e,I),_(e,t),_(t,i),_(i,s),_(s,r),Dt(r,n[6]),_(s,l),_(s,o),_(e,a),P&&P.m(e,null),C(T,c,I),C(T,u,I),_(u,h),_(h,f),_(h,p),_(h,v),w||(S=[ne(r,"input",n[26]),ne(r,"input",n[17]),ne(f,"change",n[28])],w=!0)},p(T,I){var L;I[0]&64&&r.value!==T[6]&&Dt(r,T[6]),T[7].length>0?P?P.p(T,I):(P=Or(T),P.c(),P.m(e,null)):P&&(P.d(1),P=null),I[0]&4&&d!==(d=(L=T[2])==null?void 0:L.is_public)&&(f.checked=d)},d(T){T&&E(e),P&&P.d(),T&&E(c),T&&E(u),w=!1,Ie(S)}}}function Or(n){let e,t,i=n[7],s=[];for(let r=0;r<i.length;r+=1)s[r]=Ar(kr(n,i,r));return{c(){e=b("div"),t=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(t,"class","dropdown-content"),m(e,"class","dropdown-menu"),m(e,"id","dropdown-menu"),m(e,"role","menu")},m(r,l){C(r,e,l),_(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,l){if(l[0]&262272){i=r[7];let o;for(o=0;o<i.length;o+=1){const a=kr(r,i,o);s[o]?s[o].p(a,l):(s[o]=Ar(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},d(r){r&&E(e),et(s,r)}}}function Ar(n){let e,t=n[31].username+"",i,s,r,l;function o(){return n[27](n[31])}return{c(){e=b("div"),i=J(t),s=D(),m(e,"class","dropdown-item")},m(a,c){C(a,e,c),_(e,i),_(e,s),r||(l=[ne(e,"click",o),ne(e,"keydown",null)],r=!0)},p(a,c){n=a,c[0]&128&&t!==(t=n[31].username+"")&&fe(i,t)},d(a){a&&E(e),r=!1,Ie(l)}}}function Eh(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v,w,S,P,T=[],I=new Map,L,A,y,F,K,re;function U(te,he){return te[3]?Sh:kh}let Y=U(n),Z=Y(n);const V=n[22].default,H=He(V,n,n[21],null);let se=n[8];const z=te=>te[31].id;for(let te=0;te<se.length;te+=1){let he=Sr(n,se,te),be=z(he);I.set(be,T[te]=Cr(be,he))}let q=n[9]&&Ir(n);return y=new yh({props:{selectionStore:n[0]}}),{c(){e=b("div"),t=b("div"),i=D(),s=b("div"),r=b("div"),l=b("div"),o=b("i"),a=D(),Z.c(),c=J(`

                (`),u=J(n[1]),h=J(")"),f=D(),d=b("button"),p=D(),g=b("section"),H&&H.c(),v=D(),w=b("h4"),w.textContent=`${N==="en"?"Shared with":"Partagé avec"}`,S=D(),P=b("div");for(let te=0;te<T.length;te+=1)T[te].c();L=D(),q&&q.c(),A=D(),x(y.$$.fragment),m(t,"class","modal-background"),m(o,"class","fa-solid fa-book-bookmark"),m(l,"class","title is-4 mb-0 media-content"),m(d,"class","delete media-left"),m(d,"aria-label","close"),m(r,"class","modal-card-head media mb-0 is-middle"),m(P,"class","field is-grouped is-grouped-multiline"),m(g,"class","modal-card-body"),m(s,"class","modal-content"),m(e,"id","selection-modal"),m(e,"class","modal fade"),m(e,"tabindex","-1"),m(e,"aria-labelledby","selection-modal-label"),m(e,"aria-hidden","true")},m(te,he){C(te,e,he),_(e,t),_(e,i),_(e,s),_(s,r),_(r,l),_(l,o),_(l,a),Z.m(l,null),_(l,c),_(l,u),_(l,h),_(r,f),_(r,d),_(s,p),_(s,g),H&&H.m(g,null),_(g,v),_(g,w),_(g,S),_(g,P);for(let be=0;be<T.length;be+=1)T[be]&&T[be].m(P,null);_(g,L),q&&q.m(g,null),_(s,A),W(y,s,null),F=!0,K||(re=Mn(el.call(null,e)),K=!0)},p(te,he){Y===(Y=U(te))&&Z?Z.p(te,he):(Z.d(1),Z=Y(te),Z&&(Z.c(),Z.m(l,c))),(!F||he[0]&2)&&fe(u,te[1]),H&&H.p&&(!F||he[0]&2097152)&&Be(H,V,te,te[21],F?qe(V,te[21],he,null):ze(te[21]),null),he[0]&525056&&(se=te[8],T=mn(T,he,z,1,te,se,I,P,Eo,Cr,null,Sr)),te[9]?q?q.p(te,he):(q=Ir(te),q.c(),q.m(g,null)):q&&(q.d(1),q=null);const be={};he[0]&1&&(be.selectionStore=te[0]),y.$set(be)},i(te){F||(M(H,te),M(y.$$.fragment,te),F=!0)},o(te){R(H,te),R(y.$$.fragment,te),F=!1},d(te){te&&E(e),Z.d(),H&&H.d(te);for(let he=0;he<T.length;he+=1)T[he].d();q&&q.d(),G(y),K=!1,re()}}}function Ch(n,e,t){let i,s,r,l,o,{$$slots:a={},$$scope:c}=e;const{selected:u}=jo;ue(n,u,z=>t(2,l=z));let{selectionStore:h}=e,{selectionLength:f=!1}=e;const{selectionTitle:d,updateTitle:p,updatePublic:g,save:v}=h;ue(n,d,z=>t(10,o=z));let w=!1,S,P;function T(){t(3,w=!0),t(5,P=o),setTimeout(()=>S==null?void 0:S.focus(),0)}function I(z){z.key==="Enter"&&L()}function L(){t(3,w=!1),p(P),v()}let A="",y=[];async function F(){if(A.trim().length<1){t(7,y=[]);return}const q=await(await fetch(`${window.location.origin}/search/user?q=${encodeURIComponent(A)}`)).json();t(7,y=q.users||[])}function K(z){h.add({id:z.id,class:"User",title:z.username}),t(6,A=""),t(7,y=[])}function re(z){h.remove(z,"User")}function U(z){ft[z?"unshift":"push"](()=>{S=z,t(4,S)})}function Y(){P=this.value,t(5,P)}const Z=z=>re(z.id);function V(){A=this.value,t(6,A)}const H=z=>K(z),se=z=>g(z.target.checked);return n.$$set=z=>{"selectionStore"in z&&t(0,h=z.selectionStore),"selectionLength"in z&&t(1,f=z.selectionLength),"$$scope"in z&&t(21,c=z.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&4&&t(20,i=l==null?void 0:l.owner_id),n.$$.dirty[0]&1048576&&t(9,s=Ao||i===An),n.$$.dirty[0]&4&&t(8,r=Object.entries((l==null?void 0:l.User)||{}).map(([z,q])=>({id:Number(z),username:q.title})))},[h,f,l,w,S,P,A,y,r,s,o,u,d,g,T,I,L,F,K,re,i,c,a,U,Y,Z,V,H,se]}class Ih extends ae{constructor(e){super(),oe(this,e,Ch,Eh,le,{selectionStore:0,selectionLength:1},null,[-1,-1])}}function Oh(){const n=`${window.location.origin}${window.location.pathname}`,e=49,t=Ee(1),i=Ee([]),s=Ee([]),r=(async()=>{const u=await fetch(`${n}vectorized-images`).then(h=>h.json()).then(h=>(i.set(h),h)).catch(h=>console.error("Error:",h));return c(l()),u})(),l=()=>bi(t,"vp"),o=Ye(t,u=>(async()=>a(u))());function a(u){const h=(u-1)*e,f=h+e,d=gi(i).slice(h,f);return s.set(d),d}function c(u){wi(u,t,"vp")}return{currentPage:t,pageLength:e,vectImgs:i,fetchVectorization:r,setPageVectImgs:o,pageVectImgs:s,handlePageUpdate:c}}const Vn=Oh();const Ah=n=>({}),Tr=n=>({});function Mr(n){let e,t;return{c(){e=new ho(!1),t=pe(),e.a=t},m(i,s){e.m(n[4],i,s),C(i,t,s)},p(i,s){s&16&&e.p(i[4])},d(i){i&&E(t),i&&e.d()}}}function Th(n){let e,t,i,s,r,l,o,a,c,u,h,f,d,p,g,v,w,S=!n[5]&&n[4]&&Mr(n);const P=n[10].actions,T=He(P,n,n[9],Tr);return{c(){e=b("div"),t=b("figure"),i=b("div"),S&&S.c(),s=D(),r=b("img"),o=D(),a=b("div"),c=b("a"),u=b("i"),h=D(),f=b("span"),f.textContent=`${N==="en"?"Download SVG":"Télécharger le SVG"}`,d=D(),T&&T.c(),m(i,"class","svg-container svelte-c6s83q"),m(r,"class","region-img svelte-c6s83q"),$e(r.src,l=n[8])||m(r,"src",l),m(r,"alt","Extracted region"),m(t,"class","image card region-image svelte-c6s83q"),ge(t,"width",n[2]?"50%":`${n[1]}px`),ge(t,"aspect-ratio",n[6]?n[6].split(" ")[2]/n[6].split(" ")[3]:1),m(u,"class","fa-solid fa-download"),m(f,"class","tooltip"),m(c,"class","button tag svelte-c6s83q"),m(c,"href",n[7]),m(c,"download",n[0]),m(a,"class","region-btn ml-1"),m(e,"class","region is-center"),Ce(e,"checked",n[3])},m(I,L){C(I,e,L),_(e,t),_(t,i),S&&S.m(i,null),_(t,s),_(t,r),_(e,o),_(e,a),_(a,c),_(c,u),_(c,h),_(c,f),_(a,d),T&&T.m(a,null),g=!0,v||(w=[ne(t,"click",n[11]),ne(t,"keyup",n[12]),ne(t,"mouseenter",n[13]),ne(t,"mouseleave",n[14])],v=!0)},p(I,[L]){!I[5]&&I[4]?S?S.p(I,L):(S=Mr(I),S.c(),S.m(i,null)):S&&(S.d(1),S=null),(!g||L&6)&&ge(t,"width",I[2]?"50%":`${I[1]}px`),(!g||L&64)&&ge(t,"aspect-ratio",I[6]?I[6].split(" ")[2]/I[6].split(" ")[3]:1),(!g||L&128)&&m(c,"href",I[7]),(!g||L&1)&&m(c,"download",I[0]),T&&T.p&&(!g||L&512)&&Be(T,P,I,I[9],g?qe(P,I[9],L,Ah):ze(I[9]),Tr),(!g||L&8)&&Ce(e,"checked",I[3])},i(I){g||(M(T,I),st(()=>{g&&(p||(p=vt(e,Vt,{duration:300},!0)),p.run(1))}),g=!0)},o(I){R(T,I),p||(p=vt(e,Vt,{duration:300},!1)),p.run(0),g=!1},d(I){I&&E(e),S&&S.d(),T&&T.d(I),I&&p&&p.end(),v=!1,Ie(w)}}}function Mh(n,e,t){let{$$slots:i={},$$scope:s}=e,{svgPath:r}=e,{width:l=200}=e,{fullWidth:o=!1}=e,{selected:a=!1}=e;const[c,u,h,f]=r.replace(".svg","").split("_"),d=dt(`${c}_${u}_${h}`,f,`${l},`);let p=!1,g="",v="",w="";hn(()=>{w&&URL.revokeObjectURL(w)}),rt(async()=>{const A=await(await fetch(`${Po}svg/${r}`)).text(),F=new DOMParser().parseFromString(A,"image/svg+xml"),K=F.querySelector("svg");t(6,v=K.getAttribute("viewBox")||`0 0 ${K.getAttribute("width")} ${K.getAttribute("height")}`),F.querySelectorAll("image").forEach(re=>re.remove()),K.setAttribute("viewBox",v),K.removeAttribute("width"),K.removeAttribute("height"),t(4,g=new XMLSerializer().serializeToString(F.documentElement))});function S(L){Rn.call(this,n,L)}function P(L){Rn.call(this,n,L)}const T=()=>t(5,p=!0),I=()=>t(5,p=!1);return n.$$set=L=>{"svgPath"in L&&t(0,r=L.svgPath),"width"in L&&t(1,l=L.width),"fullWidth"in L&&t(2,o=L.fullWidth),"selected"in L&&t(3,a=L.selected),"$$scope"in L&&t(9,s=L.$$scope)},n.$$.update=()=>{if(n.$$.dirty&16&&g){const L=new Blob([g],{type:"image/svg+xml"});t(7,w=URL.createObjectURL(L))}},[r,l,o,a,g,p,v,w,d,s,i,S,P,T,I]}class ql extends ae{constructor(e){super(),oe(this,e,Mh,Th,le,{svgPath:0,width:1,fullWidth:2,selected:3})}}function Pr(n,e,t){const i=n.slice();return i[15]=e[t],i[17]=t,i}function Ph(n){let e;function t(r,l){return N==="en"?Rh:Lh}let s=t()(n);return{c(){e=b("div"),s.c(),m(e,"class","faded is-center")},m(r,l){C(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:j,o:j,d(r){r&&E(e),s.d()}}}function Lh(n){let e,t=n[18]+"",i;return{c(){e=J("Erreur lors de la récupération des régions vectorisées : "),i=J(t)},m(s,r){C(s,e,r),C(s,i,r)},p(s,r){r&8&&t!==(t=s[18]+"")&&fe(i,t)},d(s){s&&E(e),s&&E(i)}}}function Rh(n){let e,t=n[18]+"",i;return{c(){e=J("Error when retrieving vectorized regions: "),i=J(t)},m(s,r){C(s,e,r),C(s,i,r)},p(s,r){r&8&&t!==(t=s[18]+"")&&fe(i,t)},d(s){s&&E(e),s&&E(i)}}}function $h(n){let e=[],t=new Map,i,s,r,l,o,a=n[4];const c=p=>p[15].id;for(let p=0;p<a.length;p+=1){let g=Pr(n,a,p),v=c(g);t.set(v,e[p]=Rr(v,g))}let u=null;a.length||(u=Lr());function h(p){n[11](p)}function f(p){n[12](p)}let d={items:n[4],$$slots:{default:[Nh,({item:p})=>({14:p}),({item:p})=>p?16384:0]},$$scope:{ctx:n}};return n[1]!==void 0&&(d.currentIndex=n[1]),n[0]!==void 0&&(d.open=n[0]),s=new Ei({props:d}),ft.push(()=>jt(s,"currentIndex",h)),ft.push(()=>jt(s,"open",f)),{c(){for(let p=0;p<e.length;p+=1)e[p].c();u&&u.c(),i=D(),x(s.$$.fragment)},m(p,g){for(let v=0;v<e.length;v+=1)e[v]&&e[v].m(p,g);u&&u.m(p,g),C(p,i,g),W(s,p,g),o=!0},p(p,g){g&528&&(a=p[4],_e(),e=mn(e,g,c,1,p,a,t,i.parentNode,Fn,Rr,i,Pr),ve(),!a.length&&u?u.p(p,g):a.length?u&&(u.d(1),u=null):(u=Lr(),u.c(),u.m(i.parentNode,i)));const v={};g&16&&(v.items=p[4]),g&540672&&(v.$$scope={dirty:g,ctx:p}),!r&&g&2&&(r=!0,v.currentIndex=p[1],Nt(()=>r=!1)),!l&&g&1&&(l=!0,v.open=p[0],Nt(()=>l=!1)),s.$set(v)},i(p){if(!o){for(let g=0;g<a.length;g+=1)M(e[g]);M(s.$$.fragment,p),o=!0}},o(p){for(let g=0;g<e.length;g+=1)R(e[g]);R(s.$$.fragment,p),o=!1},d(p){for(let g=0;g<e.length;g+=1)e[g].d(p);u&&u.d(p),p&&E(i),G(s,p)}}}function Lr(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No vectorization":"Pas de vectorisation"}`,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,d(t){t&&E(e)}}}function Dh(n){let e,t;function i(){return n[10](n[17])}return e=new ml({}),e.$on("open",i),{c(){x(e.$$.fragment)},m(s,r){W(e,s,r),t=!0},p(s,r){n=s},i(s){t||(M(e.$$.fragment,s),t=!0)},o(s){R(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Rr(n,e){let t,i,s;return i=new ql({props:{svgPath:e[15],$$slots:{default:[Dh]},$$scope:{ctx:e}}}),{key:n,first:null,c(){t=pe(),x(i.$$.fragment),this.first=t},m(r,l){C(r,t,l),W(i,r,l),s=!0},p(r,l){e=r;const o={};l&16&&(o.svgPath=e[15]),l&524304&&(o.$$scope={dirty:l,ctx:e}),i.$set(o)},i(r){s||(M(i.$$.fragment,r),s=!0)},o(r){R(i.$$.fragment,r),s=!1},d(r){r&&E(t),G(i,r)}}}function Nh(n){let e,t;return e=new ql({props:{svgPath:n[14],fullWidth:!0}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s&16384&&(r.svgPath=i[14]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function jh(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"Retrieving vectorization page...":"Récupération la page de vectorisation..."}`,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,i:j,o:j,d(t){t&&E(e)}}}function Vh(n){let e,t,i,s,r,l,o;e=new qt({props:{store:Vn,nbOfItems:n[2].length,pageLength:n[8]}});let a={ctx:n,current:null,token:null,hasCatch:!0,pending:jh,then:$h,catch:Ph,value:13,error:18,blocks:[,,,]};return Ze(s=n[3],a),l=new qt({props:{store:Vn,nbOfItems:n[2].length,pageLength:n[8]}}),{c(){x(e.$$.fragment),t=D(),i=b("div"),a.block.c(),r=D(),x(l.$$.fragment),m(i,"class","grid is-gap-2 mx-5 svelte-1mje9rl")},m(c,u){W(e,c,u),C(c,t,u),C(c,i,u),a.block.m(i,a.anchor=null),a.mount=()=>i,a.anchor=null,C(c,r,u),W(l,c,u),o=!0},p(c,[u]){n=c;const h={};u&4&&(h.nbOfItems=n[2].length),e.$set(h),a.ctx=n,u&8&&s!==(s=n[3])&&Ze(s,a)||At(a,n,u);const f={};u&4&&(f.nbOfItems=n[2].length),l.$set(f)},i(c){o||(M(e.$$.fragment,c),M(a.block),M(l.$$.fragment,c),o=!0)},o(c){R(e.$$.fragment,c);for(let u=0;u<3;u+=1){const h=a.blocks[u];R(h)}R(l.$$.fragment,c),o=!1},d(c){G(e,c),c&&E(t),c&&E(i),a.block.d(),a.token=null,a=null,c&&E(r),G(l,c)}}}function Fh(n,e,t){let i,s,r;const{vectImgs:l,pageVectImgs:o,setPageVectImgs:a,pageLength:c}=Vn;ue(n,l,v=>t(2,i=v)),ue(n,o,v=>t(4,r=v)),ue(n,a,v=>t(3,s=v));let u=!1,h=0;const f=v=>{t(1,h=v),t(0,u=!0)},d=v=>f(v);function p(v){h=v,t(1,h)}function g(v){u=v,t(0,u)}return[u,h,i,s,r,l,o,a,c,f,d,p,g]}class Uh extends ae{constructor(e){super(),oe(this,e,Fh,Vh,le,{})}}function Hh(n){let e,t,i={ctx:n,current:null,token:null,hasCatch:!0,pending:Wh,then:Kh,catch:qh,value:1,error:2,blocks:[,,,]};return Ze(n[0],i),{c(){e=pe(),i.block.c()},m(s,r){C(s,e,r),i.block.m(s,i.anchor=r),i.mount=()=>e.parentNode,i.anchor=e,t=!0},p(s,r){n=s,At(i,n,r)},i(s){t||(M(i.block),t=!0)},o(s){for(let r=0;r<3;r+=1){const l=i.blocks[r];R(l)}t=!1},d(s){s&&E(e),i.block.d(s),i.token=null,i=null}}}function qh(n){let e;function t(r,l){return N==="en"?zh:Bh}let s=t()(n);return{c(){e=b("div"),s.c(),m(e,"class","container faded is-center")},m(r,l){C(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:j,o:j,d(r){r&&E(e),s.d()}}}function Bh(n){let e,t=n[2]+"",i;return{c(){e=J("Erreur lors de la récupération des régions vectorisées : "),i=J(t)},m(s,r){C(s,e,r),C(s,i,r)},p:j,d(s){s&&E(e),s&&E(i)}}}function zh(n){let e,t=n[2]+"",i;return{c(){e=J("Error when retrieving vectorized regions: "),i=J(t)},m(s,r){C(s,e,r),C(s,i,r)},p:j,d(s){s&&E(e),s&&E(i)}}}function Kh(n){let e,t;return e=new Uh({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function Wh(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"Retrieving vectorized regions...":"Récupération des régions vectorisées..."}`,m(e,"class","container faded is-center")},m(t,i){C(t,e,i)},p:j,i:j,o:j,d(t){t&&E(e)}}}function Gh(n){let e=Ft.includes("vectorization"),t,i,s=e&&Hh(n);return{c(){s&&s.c(),t=pe()},m(r,l){s&&s.m(r,l),C(r,t,l),i=!0},p(r,[l]){e&&s.p(r,l)},i(r){i||(M(s),i=!0)},o(r){R(s),i=!1},d(r){s&&s.d(r),r&&E(t)}}}function Yh(n){const{fetchVectorization:e}=Vn;return[e]}class xh extends ae{constructor(e){super(),oe(this,e,Yh,Gh,le,{})}}function Jh(n){let e,t;return{c(){e=b("iframe"),$e(e.src,t=n[0])||m(e,"src",t),ge(e,"width","100%"),ge(e,"height","75vh"),ge(e,"border","none"),m(e,"title","Mirador viewer"),e.allowFullscreen=!0},m(i,s){C(i,e,s)},p(i,[s]){s&1&&!$e(e.src,t=i[0])&&m(e,"src",t)},i:j,o:j,d(i){i&&E(e)}}}function Xh(n,e,t){let i="";return rt(()=>{manifests.length>0&&t(0,i=Ht(manifests[0]));function s(r){t(0,i=Ht(r.detail.selectedManifest))}window.addEventListener("selectManifest",s)}),[i]}class Qh extends ae{constructor(e){super(),oe(this,e,Xh,Jh,le,{})}}function $r(n,e,t){const i=n.slice();return i[5]=e[t],i}function Dr(n){let e,t=n[3](n[5])+"",i,s,r;return{c(){e=b("option"),i=J(t),s=D(),e.__value=r=n[5],e.value=e.__value},m(l,o){C(l,e,o),_(e,i),_(e,s)},p(l,o){o&1&&t!==(t=l[3](l[5])+"")&&fe(i,t),o&1&&r!==(r=l[5])&&(e.__value=r,e.value=e.__value)},d(l){l&&E(e)}}}function Zh(n){let e,t,i,s,r,l,o,a,c=n[0],u=[];for(let h=0;h<c.length;h+=1)u[h]=Dr($r(n,c,h));return{c(){e=b("div"),t=b("label"),t.textContent=`${N==="en"?"Digitization:":"Numérisation :"}`,i=D(),s=b("div"),r=b("div"),l=b("select");for(let h=0;h<u.length;h+=1)u[h].c();m(t,"for","digit"),m(t,"class","label"),n[1]===void 0&&st(()=>n[4].call(l)),m(r,"class","select is-small"),m(s,"id","digit"),m(s,"class","control pl-3"),m(e,"class","field selector is-flex is-right mb-2")},m(h,f){C(h,e,f),_(e,t),_(e,i),_(e,s),_(s,r),_(r,l);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(l,null);Ui(l,n[1],!0),o||(a=[ne(l,"change",n[4]),ne(l,"change",n[2])],o=!0)},p(h,[f]){if(f&9){c=h[0];let d;for(d=0;d<c.length;d+=1){const p=$r(h,c,d);u[d]?u[d].p(p,f):(u[d]=Dr(p),u[d].c(),u[d].m(l,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}f&3&&Ui(l,h[1])},i:j,o:j,d(h){h&&E(e),et(u,h),o=!1,Ie(a)}}}function em(n,e,t){let{manifests:i}=e,s=(i==null?void 0:i[0])||"";function r(a){t(1,s=a.target.value),window.dispatchEvent(new CustomEvent("selectManifest",{detail:{selectedManifest:s}}))}function l(a){const c=a.match(/man(\d+)/),u=c?c[1]:"?",h=a.match(/anno(\d+)/),f=h?h[1]:null;let d="";return d+=`${N==="en"?"Manifest":"Manifeste"} #${u}`,f&&(d+=`, ${N==="en"?"Regions extraction":"Extraction de régions"} #${f}`),d}function o(){s=fo(this),t(1,s),t(0,i)}return n.$$set=a=>{"manifests"in a&&t(0,i=a.manifests)},[i,s,r,l,o]}class tm extends ae{constructor(e){super(),oe(this,e,em,Zh,le,{manifests:0})}}function nm(n){let e,t,i,s,r=N==="en"?"Download All":"Tout Télécharger",l,o,a;return{c(){e=b("div"),t=b("button"),i=b("i"),s=D(),l=J(r),m(i,"class","fa-solid fa-download"),m(t,"class","button is-link is-light"),m(e,"class","is-right mb-3")},m(c,u){C(c,e,u),_(e,t),_(t,i),_(t,s),_(t,l),o||(a=ne(t,"click",n[0]),o=!0)},p:j,i:j,o:j,d(c){c&&E(e),o=!1,a()}}}function im(n){const e=`${window.location.origin}${window.location.pathname}`,t=parseInt(e.split("witness/")[1].replace("/","")),i=parseInt(e.split("regions/")[1].replace("/",""));async function s(){if(!i&&!t){console.error("No Region or Witness");return}const r=i?`${window.location.origin}/${Ve}/export-regions-imgs-and-svgs/${i}`:`${window.location.origin}/${Ve}/export-all-imgs-and-svgs/${t}`;try{const l=await Ut(()=>fetch(r,{method:"GET",headers:{"X-CSRFToken":Xe,"Content-Type":"application/json"}}));if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const o=await l.blob();Qr(o,"vectorizations.zip")}catch(l){console.error("Erreur lors du téléchargement des vectorisations:",l)}}return[s]}class sm extends ae{constructor(e){super(),oe(this,e,im,nm,le,{})}}function Nr(n,e,t){const i=n.slice();return i[26]=e[t][0],i[27]=e[t][1],i}function jr(n,e,t){const i=n.slice();return i[30]=e[t][0],i[31]=e[t][1],i}function rm(n){let e,t,i;return t=new ra({props:{witness:n[1],editUrl:n[2],viewTitle:n[3]}}),{c(){e=b("div"),x(t.$$.fragment),m(e,"slot","sidebar")},m(s,r){C(s,e,r),W(t,e,null),i=!0},p(s,r){const l={};r[0]&2&&(l.witness=s[1]),r[0]&4&&(l.editUrl=s[2]),r[0]&8&&(l.viewTitle=s[3]),t.$set(l)},i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){R(t.$$.fragment,s),i=!1},d(s){s&&E(e),G(t)}}}function lm(n){let e,t,i,s,r,l,o,a,c,u;const h=[um,cm,am],f=[];function d(w,S){return w[9]==="all"||w[9]==="page"?0:w[9]==="viewer"?1:w[9]==="vectorization"?2:-1}~(s=d(n))&&(r=f[s]=h[s](n));const p=[pm,mm,hm,dm,fm],g=[];function v(w,S){return w[9]==="viewer"?0:w[9]==="all"?1:w[9]==="page"?2:w[9]==="similarity"?3:w[9]==="vectorization"?4:-1}return~(o=v(n))&&(a=g[o]=p[o](n)),{c(){e=b("div"),t=b("div"),i=b("div"),r&&r.c(),l=D(),a&&a.c(),c=pe(),m(i,"class","cell"),m(t,"class","actions grid"),m(e,"id","nav-actions")},m(w,S){C(w,e,S),_(e,t),_(t,i),~s&&f[s].m(i,null),C(w,l,S),~o&&g[o].m(w,S),C(w,c,S),u=!0},p(w,S){let P=s;s=d(w),s===P?~s&&f[s].p(w,S):(r&&(_e(),R(f[P],1,1,()=>{f[P]=null}),ve()),~s?(r=f[s],r?r.p(w,S):(r=f[s]=h[s](w),r.c()),M(r,1),r.m(i,null)):r=null);let T=o;o=v(w),o===T?~o&&g[o].p(w,S):(a&&(_e(),R(g[T],1,1,()=>{g[T]=null}),ve()),~o?(a=g[o],a?a.p(w,S):(a=g[o]=p[o](w),a.c()),M(a,1),a.m(c.parentNode,c)):a=null)},i(w){u||(M(r),M(a),u=!0)},o(w){R(r),R(a),u=!1},d(w){w&&E(e),~s&&f[s].d(),w&&E(l),~o&&g[o].d(w),w&&E(c)}}}function om(n){let e,t;return{c(){e=b("article"),t=b("div"),t.textContent=`${N==="en"?"This witness has no digitization.":"Ce témoin n'a pas de numérisation."}`,m(t,"class","message-body"),m(e,"class","message is-warning")},m(i,s){C(i,e,s),_(e,t)},p:j,i:j,o:j,d(i){i&&E(e)}}}function am(n){let e,t;return e=new sm({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function cm(n){let e,t;return e=new tm({props:{manifests:n[0]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s[0]&1&&(r.manifests=i[0]),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function um(n){let e,t;return e=new Sa({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function fm(n){let e,t;return e=new xh({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function dm(n){let e,t;return e=new Zd({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function hm(n){let e,t;return e=new gh({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function mm(n){let e,t,i={ctx:n,current:null,token:null,hasCatch:!0,pending:wm,then:_m,catch:gm,value:34,error:35,blocks:[,,,]};return Ze(n[15],i),{c(){e=b("div"),i.block.c(),m(e,"class","grid is-gap-2 mt-5")},m(s,r){C(s,e,r),i.block.m(e,i.anchor=null),i.mount=()=>e,i.anchor=null,t=!0},p(s,r){n=s,At(i,n,r)},i(s){t||(M(i.block),t=!0)},o(s){for(let r=0;r<3;r+=1){const l=i.blocks[r];R(l)}t=!1},d(s){s&&E(e),i.block.d(),i.token=null,i=null}}}function pm(n){let e,t;return e=new Qh({}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function gm(n){let e,t,i=n[35]+"",s;return{c(){e=b("div"),t=J("Error when retrieving regions: "),s=J(i)},m(r,l){C(r,e,l),_(e,t),_(e,s)},p:j,i:j,o:j,d(r){r&&E(e)}}}function _m(n){let e,t,i,s,r;const l=[bm,vm],o=[];function a(c,u){return u[0]&1024&&(e=null),e==null&&(e=!!Object.values(c[10]).length),e?0:1}return t=a(n,[-1,-1]),i=o[t]=l[t](n),{c(){i.c(),s=pe()},m(c,u){o[t].m(c,u),C(c,s,u),r=!0},p(c,u){let h=t;t=a(c,u),t===h?o[t].p(c,u):(_e(),R(o[h],1,1,()=>{o[h]=null}),ve(),i=o[t],i?i.p(c,u):(i=o[t]=l[t](c),i.c()),M(i,1),i.m(s.parentNode,s))},i(c){r||(M(i),r=!0)},o(c){R(i),r=!1},d(c){o[t].d(c),c&&E(s)}}}function vm(n){let e,t;return e=new il({props:{currentRegionId:n[17],baseUrl:n[16]}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p:j,i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function bm(n){let e,t;return e=new Hl({props:{items:Object.values(n[10])}}),{c(){x(e.$$.fragment)},m(i,s){W(e,i,s),t=!0},p(i,s){const r={};s[0]&1024&&(r.items=Object.values(i[10])),e.$set(r)},i(i){t||(M(e.$$.fragment,i),t=!0)},o(i){R(e.$$.fragment,i),t=!1},d(i){G(e,i)}}}function wm(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"Retrieving regions...":"Récupération des régions..."}`,m(e,"class","faded is-center")},m(t,i){C(t,e,i)},p:j,i:j,o:j,d(t){t&&E(e)}}}function ym(n){let e,t,i,s;const r=[om,lm],l=[];function o(a,c){return a[0].length===0?0:1}return t=o(n),i=l[t]=r[t](n),{c(){e=b("div"),i.c(),m(e,"slot","content")},m(a,c){C(a,e,c),l[t].m(e,null),s=!0},p(a,c){let u=t;t=o(a),t===u?l[t].p(a,c):(_e(),R(l[u],1,1,()=>{l[u]=null}),ve(),i=l[t],i?i.p(a,c):(i=l[t]=r[t](a),i.c()),M(i,1),i.m(e,null))},i(a){s||(M(i),s=!0)},o(a){R(i),s=!1},d(a){a&&E(e),l[t].d()}}}function km(n){let e;return{c(){e=b("div"),e.textContent=`${N==="en"?"No regions in selection":"Aucune région sélectionnée"}`},m(t,i){C(t,e,i)},p:j,d(t){t&&E(e)}}}function Sm(n){let e,t,i=Object.entries(n[7]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Fr(Nr(n,i,r));return{c(){e=b("div"),t=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(t,"class","grid is-gap-2"),m(e,"class","fixed-grid has-6-cols")},m(r,l){C(r,e,l),_(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,l){if(l[0]&8320){i=Object.entries(r[7]);let o;for(o=0;o<i.length;o+=1){const a=Nr(r,i,o);s[o]?s[o].p(a,l):(s[o]=Fr(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},d(r){r&&E(e),et(s,r)}}}function Vr(n){let e,t,i,s,r,l,o,a=n[31].title+"",c,u,h,f,d,p;function g(){return n[25](n[30])}return{c(){e=b("div"),t=b("figure"),i=b("img"),r=D(),l=b("div"),o=b("span"),c=J(a),u=D(),h=b("button"),f=D(),$e(i.src,s=dt(n[31].img,n[31].xywh,"96,"))||m(i,"src",s),m(i,"alt",""),m(o,"class","overlay-desc"),m(l,"class","overlay is-center svelte-qn8evk"),m(t,"class","image is-64x64 card"),m(h,"class","delete region-btn"),m(e,"class","selection cell svelte-qn8evk")},m(v,w){C(v,e,w),_(e,t),_(t,i),_(t,r),_(t,l),_(l,o),_(o,c),_(e,u),_(e,h),_(e,f),d||(p=ne(h,"click",g),d=!0)},p(v,w){n=v,w[0]&128&&!$e(i.src,s=dt(n[31].img,n[31].xywh,"96,"))&&m(i,"src",s),w[0]&128&&a!==(a=n[31].title+"")&&fe(c,a)},d(v){v&&E(e),d=!1,p()}}}function Fr(n){let e,t=Object.entries(n[27]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Vr(jr(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=pe()},m(s,r){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(s,r);C(s,e,r)},p(s,r){if(r[0]&8320){t=Object.entries(s[27]);let l;for(l=0;l<t.length;l+=1){const o=jr(s,t,l);i[l]?i[l].p(o,r):(i[l]=Vr(o),i[l].c(),i[l].m(e.parentNode,e))}for(;l<i.length;l+=1)i[l].d(1);i.length=t.length}},d(s){et(i,s),s&&E(e)}}}function Em(n){let e;function t(r,l){return r[6]?Sm:km}let i=t(n),s=i(n);return{c(){s.c(),e=pe()},m(r,l){s.m(r,l),C(r,e,l)},p(r,l){i===(i=t(r))&&s?s.p(r,l):(s.d(1),s=i(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&E(e)}}}function Cm(n){let e,t,i,s,r,l,o,a,c,u;return e=new nl({props:{visible:n[8]}}),i=new da({}),r=new aa({props:{selectionLength:n[4]}}),o=new Xo({props:{tabList:n[5],$$slots:{content:[ym],sidebar:[rm]},$$scope:{ctx:n}}}),c=new Ih({props:{selectionLength:n[4],selectionStore:gt,$$slots:{default:[Em]},$$scope:{ctx:n}}}),{c(){x(e.$$.fragment),t=D(),x(i.$$.fragment),s=D(),x(r.$$.fragment),l=D(),x(o.$$.fragment),a=D(),x(c.$$.fragment)},m(h,f){W(e,h,f),C(h,t,f),W(i,h,f),C(h,s,f),W(r,h,f),C(h,l,f),W(o,h,f),C(h,a,f),W(c,h,f),u=!0},p(h,f){const d={};f[0]&256&&(d.visible=h[8]),e.$set(d);const p={};f[0]&16&&(p.selectionLength=h[4]),r.$set(p);const g={};f[0]&32&&(g.tabList=h[5]),f[0]&1551|f[1]&32&&(g.$$scope={dirty:f,ctx:h}),o.$set(g);const v={};f[0]&16&&(v.selectionLength=h[4]),f[0]&192|f[1]&32&&(v.$$scope={dirty:f,ctx:h}),c.$set(v)},i(h){u||(M(e.$$.fragment,h),M(i.$$.fragment,h),M(r.$$.fragment,h),M(o.$$.fragment,h),M(c.$$.fragment,h),u=!0)},o(h){R(e.$$.fragment,h),R(i.$$.fragment,h),R(r.$$.fragment,h),R(o.$$.fragment,h),R(c.$$.fragment,h),u=!1},d(h){G(e,h),h&&E(t),G(i,h),h&&E(s),G(r,h),h&&E(l),G(o,h),h&&E(a),G(c,h)}}}function Im(n,e,t){let i,s,r,l,o,a,c,u;ue(n,Ot,Y=>t(8,a=Y)),ue(n,St,Y=>t(9,c=Y));const{selected:h,nbSelected:f,remove:d}=gt;ue(n,h,Y=>t(24,o=Y)),ue(n,f,Y=>t(23,l=Y));const{allRegions:p,fetchAll:g}=bt;ue(n,p,Y=>t(10,u=Y));let{manifest:v=""}=e,{manifests:w=[]}=e,{isValidated:S=!1}=e,{imgPrefix:P=""}=e,{nbOfPages:T=1}=e,{trailingZeros:I=1}=e,{witness:L={}}=e,{editUrl:A=""}=e,{viewTitle:y=""}=e;at("witness",L),at("nbOfPages",T),at("trailingZeros",I),at("imgPrefix",P),at("manifest",v),at("isValidated",S);const F=`${window.location.origin}${window.location.pathname}`,K=parseInt(F.split("regions/")[1].replace("/","")),re={viewer:N==="en"?"Viewer":"Visionneuse",all:N==="en"?"All regions":"Toutes les régions",page:N==="en"?"Per page":"Par page"};Ft.includes("similarity")&&(re.similarity=N==="en"?"Similarity":"Similarité"),Ft.includes("vectorization")&&(re.vectorization=N==="en"?"Vectorization":"Vectorisation");const U=Y=>d(Y,un);return n.$$set=Y=>{"manifest"in Y&&t(18,v=Y.manifest),"manifests"in Y&&t(0,w=Y.manifests),"isValidated"in Y&&t(19,S=Y.isValidated),"imgPrefix"in Y&&t(20,P=Y.imgPrefix),"nbOfPages"in Y&&t(21,T=Y.nbOfPages),"trailingZeros"in Y&&t(22,I=Y.trailingZeros),"witness"in Y&&t(1,L=Y.witness),"editUrl"in Y&&t(2,A=Y.editUrl),"viewTitle"in Y&&t(3,y=Y.viewTitle)},n.$$.update=()=>{n.$$.dirty[0]&16777216&&t(7,i=o),n.$$.dirty[0]&8388608&&t(4,s=l),n.$$.dirty[0]&16&&t(6,r=s>0)},[w,L,A,y,s,re,r,i,a,c,u,h,f,d,p,g,F,K,v,S,P,T,I,l,o,U]}class Om extends ae{constructor(e){super(),oe(this,e,Im,Cm,le,{manifest:18,manifests:0,isValidated:19,imgPrefix:20,nbOfPages:21,trailingZeros:22,witness:1,editUrl:2,viewTitle:3},null,[-1,-1])}}new Om({target:document.getElementById("witness-view"),props:{viewTitle,editUrl,witness,manifest,manifests,isValidated,imgPrefix,nbOfPages,trailingZeros}});
//# sourceMappingURL=witness.js.map
