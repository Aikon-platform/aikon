function j(){}const gr=t=>t;function Rl(t,e){for(const i in e)t[i]=e[i];return t}function Dl(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function _r(t){return t()}function En(){return Object.create(null)}function Ie(t){t.forEach(_r)}function Xt(t){return typeof t=="function"}function ue(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ii;function We(t,e){return ii||(ii=document.createElement("a")),ii.href=e,t===ii.href}function Nl(t){return Object.keys(t).length===0}function Qi(t,...e){if(t==null)return j;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function Zi(t){let e;return Qi(t,i=>e=i)(),e}function oe(t,e,i){t.$$.on_destroy.push(Qi(e,i))}function Ge(t,e,i,n){if(t){const s=vr(t,e,i,n);return t[0](s)}}function vr(t,e,i,n){return t[1]&&n?Rl(i.ctx.slice(),t[1](n(e))):i.ctx}function Ye(t,e,i,n){if(t[2]&&n){const s=t[2](n(i));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],l=Math.max(e.dirty.length,s.length);for(let o=0;o<l;o+=1)r[o]=e.dirty[o]|s[o];return r}return e.dirty|s}return e.dirty}function Je(t,e,i,n,s,r){if(s){const l=vr(e,i,n,r);t.p(l,s)}}function Xe(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function $l(t){const e={};for(const i in t)e[i]=!0;return e}function ni(t){return t??""}function ui(t){return t&&Xt(t.destroy)?t.destroy:j}const br=typeof window<"u";let jl=br?()=>window.performance.now():()=>Date.now(),en=br?t=>requestAnimationFrame(t):j;const Pt=new Set;function yr(t){Pt.forEach(e=>{e.c(t)||(Pt.delete(e),e.f())}),Pt.size!==0&&en(yr)}function Fl(t){let e;return Pt.size===0&&en(yr),{promise:new Promise(i=>{Pt.add(e={c:t,f:i})}),abort(){Pt.delete(e)}}}function _(t,e){t.appendChild(e)}function wr(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ul(t){const e=b("style");return Vl(wr(t),e),e.sheet}function Vl(t,e){return _(t.head||t,e),e.sheet}function S(t,e,i){t.insertBefore(e,i||null)}function k(t){t.parentNode&&t.parentNode.removeChild(t)}function st(t,e){for(let i=0;i<t.length;i+=1)t[i]&&t[i].d(e)}function b(t){return document.createElement(t)}function Qe(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function W(t){return document.createTextNode(t)}function N(){return W(" ")}function he(){return W("")}function re(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Ct(t){return function(e){return e.preventDefault(),t.call(this,e)}}function p(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function Hl(t){return Array.from(t.childNodes)}function ce(t,e){e=""+e,t.data!==e&&(t.data=e)}function Mt(t,e){t.value=e??""}function $e(t,e,i,n){i==null?t.style.removeProperty(e):t.style.setProperty(e,i,n?"important":"")}function Cn(t,e,i){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e){s.selected=!0;return}}(!i||e!==void 0)&&(t.selectedIndex=-1)}function Bl(t){const e=t.querySelector(":checked");return e&&e.__value}function qe(t,e,i){t.classList[i?"add":"remove"](e)}function kr(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,i,n,e),s}class zl{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=Qe(i.nodeName):this.e=b(i.nodeType===11?"TEMPLATE":i.nodeName),this.t=i.tagName!=="TEMPLATE"?i:i.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)S(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(k)}}function fi(t,e){return new t(e)}const di=new Map;let hi=0;function ql(t){let e=5381,i=t.length;for(;i--;)e=(e<<5)-e^t.charCodeAt(i);return e>>>0}function Kl(t,e){const i={stylesheet:Ul(e),rules:{}};return di.set(t,i),i}function In(t,e,i,n,s,r,l,o=0){const a=16.666/n;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(i-e)*r(v);c+=v*100+`%{${l(w,1-w)}}
`}const u=c+`100% {${l(i,1-i)}}
}`,f=`__svelte_${ql(u)}_${o}`,d=wr(t),{stylesheet:h,rules:m}=di.get(d)||Kl(d,t);m[f]||(m[f]=!0,h.insertRule(`@keyframes ${f} ${u}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${n}ms linear ${s}ms 1 both`,hi+=1,f}function xl(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?r=>r.indexOf(e)<0:r=>r.indexOf("__svelte")===-1),s=i.length-n.length;s&&(t.style.animation=n.join(", "),hi-=s,hi||Wl())}function Wl(){en(()=>{hi||(di.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&k(e)}),di.clear())})}let Yt;function ot(t){Yt=t}function jt(){if(!Yt)throw new Error("Function called outside component initialization");return Yt}function vt(t){jt().$$.on_mount.push(t)}function bi(t){jt().$$.on_destroy.push(t)}function tn(){const t=jt();return(e,i,{cancelable:n=!1}={})=>{const s=t.$$.callbacks[e];if(s){const r=kr(e,i,{cancelable:n});return s.slice().forEach(l=>{l.call(t,r)}),!r.defaultPrevented}return!0}}function lt(t,e){return jt().$$.context.set(t,e),e}function Ae(t){return jt().$$.context.get(t)}const At=[],Hi=[];let Lt=[];const On=[],Gl=Promise.resolve();let Bi=!1;function Yl(){Bi||(Bi=!0,Gl.then(nn))}function Ze(t){Lt.push(t)}const $i=new Set;let It=0;function nn(){if(It!==0)return;const t=Yt;do{try{for(;It<At.length;){const e=At[It];It++,ot(e),Jl(e.$$)}}catch(e){throw At.length=0,It=0,e}for(ot(null),At.length=0,It=0;Hi.length;)Hi.pop()();for(let e=0;e<Lt.length;e+=1){const i=Lt[e];$i.has(i)||($i.add(i),i())}Lt.length=0}while(At.length);for(;On.length;)On.pop()();Bi=!1,$i.clear(),ot(t)}function Jl(t){if(t.fragment!==null){t.update(),Ie(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ze)}}function Xl(t){const e=[],i=[];Lt.forEach(n=>t.indexOf(n)===-1?e.push(n):i.push(n)),i.forEach(n=>n()),Lt=e}let zt;function Ql(){return zt||(zt=Promise.resolve(),zt.then(()=>{zt=null})),zt}function ji(t,e,i){t.dispatchEvent(kr(`${e?"intro":"outro"}${i}`))}const oi=new Set;let at;function _e(){at={r:0,c:[],p:at}}function ve(){at.r||Ie(at.c),at=at.p}function R(t,e){t&&t.i&&(oi.delete(t),t.i(e))}function D(t,e,i,n){if(t&&t.o){if(oi.has(t))return;oi.add(t),at.c.push(()=>{oi.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const Zl={duration:0};function nt(t,e,i,n){const s={direction:"both"};let r=e(t,i,s),l=n?0:1,o=null,a=null,c=null;function u(){c&&xl(t,c)}function f(h,m){const g=h.b-l;return m*=Math.abs(g),{a:l,b:h.b,d:g,duration:m,start:h.start,end:h.start+m,group:h.group}}function d(h){const{delay:m=0,duration:g=300,easing:v=gr,tick:w=j,css:O}=r||Zl,L={start:jl()+m,b:h};h||(L.group=at,at.r+=1),o||a?a=L:(O&&(u(),c=In(t,l,h,g,m,v,O)),h&&w(0,1),o=f(L,g),Ze(()=>ji(t,h,"start")),Fl(C=>{if(a&&C>a.start&&(o=f(a,g),a=null,ji(t,o.b,"start"),O&&(u(),c=In(t,l,o.b,o.duration,0,v,r.css))),o){if(C>=o.end)w(l=o.b,1-l),ji(t,o.b,"end"),a||(o.b?u():--o.group.r||Ie(o.group.c)),o=null;else if(C>=o.start){const T=C-o.start;l=o.a+o.d*v(T/o.duration),w(l,1-l)}}return!!(o||a)}))}return{run(h){Xt(r)?Ql().then(()=>{r=r(s),d(h)}):d(h)},end(){u(),o=a=null}}}function ct(t,e){const i=e.token={};function n(s,r,l,o){if(e.token!==i)return;e.resolved=o;let a=e.ctx;l!==void 0&&(a=a.slice(),a[l]=o);const c=s&&(e.current=s)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((f,d)=>{d!==r&&f&&(_e(),D(f,1,1,()=>{e.blocks[d]===f&&(e.blocks[d]=null)}),ve())}):e.block.d(1),c.c(),R(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[r]=c),u&&nn()}if(Dl(t)){const s=jt();if(t.then(r=>{ot(s),n(e.then,1,e.value,r),ot(null)},r=>{if(ot(s),n(e.catch,2,e.error,r),ot(null),!e.hasCatch)throw r}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function Ft(t,e,i){const n=e.slice(),{resolved:s}=t;t.current===t.then&&(n[t.value]=s),t.current===t.catch&&(n[t.error]=s),t.block.p(n,i)}function eo(t,e){t.d(1),e.delete(t.key)}function Qt(t,e){D(t,1,1,()=>{e.delete(t.key)})}function Ut(t,e,i,n,s,r,l,o,a,c,u,f){let d=t.length,h=r.length,m=d;const g={};for(;m--;)g[t[m].key]=m;const v=[],w=new Map,O=new Map,L=[];for(m=h;m--;){const F=f(s,r,m),E=i(F);let P=l.get(E);P?n&&L.push(()=>P.p(F,e)):(P=c(E,F),P.c()),w.set(E,v[m]=P),E in g&&O.set(E,Math.abs(m-g[E]))}const C=new Set,T=new Set;function $(F){R(F,1),F.m(o,u),l.set(F.key,F),u=F.first,h--}for(;d&&h;){const F=v[h-1],E=t[d-1],P=F.key,G=E.key;F===E?(u=F.first,d--,h--):w.has(G)?!l.has(P)||C.has(P)?$(F):T.has(G)?d--:O.get(P)>O.get(G)?(T.add(P),$(F)):(C.add(G),d--):(a(E,l),d--)}for(;d--;){const F=t[d];w.has(F.key)||a(F,l)}for(;h;)$(v[h-1]);return Ie(L),v}function bh(t,e){const i={},n={},s={$$scope:1};let r=t.length;for(;r--;){const l=t[r],o=e[r];if(o){for(const a in l)a in o||(n[a]=1);for(const a in o)s[a]||(i[a]=o[a],s[a]=1);t[r]=o}else for(const a in l)s[a]=1}for(const l in n)l in i||(i[l]=void 0);return i}function yh(t){return typeof t=="object"&&t!==null?t:{}}function Z(t){t&&t.c()}function X(t,e,i,n){const{fragment:s,after_update:r}=t.$$;s&&s.m(e,i),n||Ze(()=>{const l=t.$$.on_mount.map(_r).filter(Xt);t.$$.on_destroy?t.$$.on_destroy.push(...l):Ie(l),t.$$.on_mount=[]}),r.forEach(Ze)}function Q(t,e){const i=t.$$;i.fragment!==null&&(Xl(i.after_update),Ie(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function to(t,e){t.$$.dirty[0]===-1&&(At.push(t),Yl(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function fe(t,e,i,n,s,r,l,o=[-1]){const a=Yt;ot(t);const c=t.$$={fragment:null,ctx:[],props:r,update:j,not_equal:s,bound:En(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:En(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};l&&l(c.root);let u=!1;if(c.ctx=i?i(t,e.props||{},(f,d,...h)=>{const m=h.length?h[0]:d;return c.ctx&&s(c.ctx[f],c.ctx[f]=m)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](m),u&&to(t,f)),d}):[],c.update(),u=!0,Ie(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const f=Hl(e.target);c.fragment&&c.fragment.l(f),f.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&R(t.$$.fragment),X(t,e.target,e.anchor,e.customElement),nn()}ot(a)}class de{$destroy(){Q(this,1),this.$destroy=j}$on(e,i){if(!Xt(i))return j;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const s=n.indexOf(i);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Nl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function io(t){const e=t-1;return e*e*e+1}function mt(t,{delay:e=0,duration:i=400,easing:n=gr}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:r=>`opacity: ${r*s}`}}function An(t,{delay:e=0,duration:i=400,easing:n=io,axis:s="y"}={}){const r=getComputedStyle(t),l=+r.opacity,o=s==="y"?"height":"width",a=parseFloat(r[o]),c=s==="y"?["top","bottom"]:["left","right"],u=c.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),f=parseFloat(r[`padding${u[0]}`]),d=parseFloat(r[`padding${u[1]}`]),h=parseFloat(r[`margin${u[0]}`]),m=parseFloat(r[`margin${u[1]}`]),g=parseFloat(r[`border${u[0]}Width`]),v=parseFloat(r[`border${u[1]}Width`]);return{delay:e,duration:i,easing:n,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*l};${o}: ${w*a}px;padding-${c[0]}: ${w*f}px;padding-${c[1]}: ${w*d}px;margin-${c[0]}: ${w*h}px;margin-${c[1]}: ${w*m}px;border-${c[0]}-width: ${w*g}px;border-${c[1]}-width: ${w*v}px;`}}const Ot=[];function no(t,e){return{subscribe:Ee(t,e).subscribe}}function Ee(t,e=j){let i;const n=new Set;function s(o){if(ue(t,o)&&(t=o,i)){const a=!Ot.length;for(const c of n)c[1](),Ot.push(c,t);if(a){for(let c=0;c<Ot.length;c+=2)Ot[c][0](Ot[c+1]);Ot.length=0}}}function r(o){s(o(t))}function l(o,a=j){const c=[o,a];return n.add(c),n.size===1&&(i=e(s)||j),o(t),()=>{n.delete(c),n.size===0&&i&&(i(),i=null)}}return{set:s,update:r,subscribe:l}}function Be(t,e,i){const n=!Array.isArray(t),s=n?[t]:t,r=e.length<2;return no(i,l=>{let o=!1;const a=[];let c=0,u=j;const f=()=>{if(c)return;u();const h=e(n?a[0]:a,l);r?l(h):u=Xt(h)?h:j},d=s.map((h,m)=>Qi(h,g=>{a[m]=g,c&=~(1<<m),o&&f()},()=>{c|=1<<m}));return o=!0,f(),function(){Ie(d),u(),o=!1}})}const V=APP_LANG,je=APP_NAME;WEBAPP_NAME;const ai=USER_ID,so=IS_SUPERUSER,Ke=CSRF_TOKEN,Rt=ADDITIONAL_MODULES,pi="Region";APP_URL;const ro=SAS_APP_URL;CANTALOUPE_APP_URL;const lo=MEDIA_PATH,oo=PAGE_LEN,Et=Ee(!1),Sr=Ee(""),ao=t=>typeof t=="string"||t instanceof String;async function Dt(t){Et.set(!0);try{return await t()}finally{Et.set(!1)}}function Er(t){return t.match(/\d+/g).toString()}function co(t){return parseInt(Er(t),10)}function Cr(t,e=100){const i=Math.floor(e*.75);return t.length>e?t.slice(0,i)+"..."+t.slice(-e+i):t}function uo(){return"https://vhs.huma-num.fr"}function fo(){return ro??"http://localhost:8888"}function sn(t,e){if(typeof window<"u"){const i=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(i))return t.set(i),i}return t.set(1),1}function rn(t,e,i){if(e.set(t),typeof window<"u"){const n=new URL(window.location.href);n.searchParams.set(i,t),window.history.pushState({},"",n)}}function ho(t=null){return t=t.split("_"),t.length<3?void 0:`${t.slice(0,3).join("_").replace(".jpg","")}.jpg`}function Ir(t=null){const e=ho(t);return e===void 0?void 0:`${uo()}/iiif/2/${e}`}function gt(t=null,e=null,i="full"){if(e=ao(e)?e.replace(".jpg",""):e,!t)return"https://placehold.co/96x96/png?text=No+image";if(!t.startsWith("wit")){const[r,...l]=t.split("_wit");t=`wit${l}`}const n=Ir(t);if(n===void 0)return"https://placehold.co/96x96/png?text=No+image";const s=t.split("_");return e||(e=s[s.length-1].includes(",")?s.pop().replace(".jpg",""):"full"),`${n}/${e}/${i}/0/default.jpg`}function wh(t=null){return`${Ir(t)}/info.json`}function Nt(t=null,e=1){return`${fo()}/index.html?iiif-content=${t}&canvas=${e}`}function Me(t,e=null,i=!1){return new Promise(n=>{if(document.getElementById("msg-modal")){i?document.getElementById("modal-footer").hidden=!1:n(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=t,document.getElementById("hidden-msg-btn").click();const r=document.getElementById("cancel-btn"),l=document.getElementById("ok-btn"),o=document.getElementById("modal-bkg"),a=()=>{r.removeEventListener("click",c),o.removeEventListener("click",c),l.removeEventListener("click",u),document.getElementById("modal-footer").hidden=!0},c=()=>{a(),n(!1)},u=()=>{a(),n(!0)};r.addEventListener("click",c),l.addEventListener("click",u)}else i?n(window.confirm(t)):(window.alert(t),n(void 0))})}function Or(t,e){const i=window.URL.createObjectURL(t),n=document.createElement("a");n.href=i,n.download=`${e}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(i),document.body.removeChild(n)}function mi(){let t,e,i=(n,s)=>n===s;return{set:n=>{e=t,t=n},setCompareFn:n=>i=n,get:()=>t,getNewAndOld:()=>[t,e],same:()=>i(t,e)}}const ln=(t,e)=>Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((i,n)=>i===e[n]||void 0);function Ar(t=null){return t<600?1:t<800?2:t<1e3?3:t<1200?4:t<1400?5:t>=1400?6:4}function Tr(t){const e=t.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),i=()=>t.classList.remove("is-active");e.forEach(s=>s.addEventListener("click",i));const n=s=>{s.key==="Escape"&&t.classList.contains("is-active")&&i()};return document.addEventListener("keydown",n),{destroy(){e.forEach(s=>s.removeEventListener("click",i)),document.removeEventListener("keydown",n)}}}function Pr(t){const e=()=>{const i=document.getElementById(t.dataset.target);i==null||i.classList.add("is-active")};return t.addEventListener("click",e),{destroy(){t.removeEventListener("click",e)}}}function on(t){const{type:e,modelName:i,title:n,extractMeta:s=h=>h}=t,r={id:null,type:e,title:n,is_public:!1,selected:{}},l=JSON.parse(localStorage.getItem(e))||r,o=Ee(l),a=Ee(!1);function c(h,m=!1){a.set(m),localStorage.setItem(e,JSON.stringify(h))}function u(){o.update(h=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),h;const m=Object.fromEntries(Object.entries(h.selected).map(([v,w])=>[v,Object.keys(w)])),g=h.id?`${h.id}/edit`:"new";return fetch(`${window.location.origin}/${i}/${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify({title:h.title,is_public:h.is_public,selection:h,...m})}).then(v=>v.json()).then(v=>{if(!(v!=null&&v.document_set_id))throw new Error("Failed to save");o.update(w=>(w.id=v.document_set_id,w.title=v.document_set_title,w.is_public=v.is_public,c(w,!0),w))}).catch(v=>console.error("Error:",v)),h})}const f=h=>o.update(()=>{const m=h.selection.id?h.selection:{...h.selection,id:h.id};return c(m),m}),d=()=>o.update(()=>{const h={...r,selected:{}};return c(h),h});return{type:e,subscribe:o.subscribe,add:h=>o.update(m=>(m.selected[h.class]={...m.selected[h.class]||{},[h.id]:s(h)},c(m),m)),addAll:h=>o.update(m=>(h.forEach(g=>{m.selected[g.class]={...m.selected[g.class]||{},[g.id]:s(g)}}),c(m),m)),remove:(h,m)=>o.update(g=>{const{[h]:v,...w}=g.selected[m];return g.selected[m]=w,c(g),g}),removeAll:(h,m)=>o.update(g=>(h.forEach(v=>{var w;return(w=g.selected[m])==null?!0:delete w[v]}),c(g),g)),toggle:h=>o.update(m=>{var g;if((g=m.selected[h.class])!=null&&g[h.id]){const{[h.id]:v,...w}=m.selected[h.class];m.selected[h.class]=w}else m.selected[h.class]={...m.selected[h.class]||{},[h.id]:s(h)};return c(m),m}),toggleSet:h=>{Zi(o).id===h.id?d():f(h)},empty:()=>o.update(h=>(h.id=null,h.title=n,h.selected={},c(h,!0),h)),updateTitle:h=>o.update(m=>(m.title=h,c(m,!0),m)),updatePublic:h=>o.update(m=>(m.is_public=h,c(m,!0),m)),save:u,isSaved:a,selection:o,selectionTitle:Be(o,h=>h.title),isSelected:Be(o,h=>m=>{var g;return((g=h.selected[m.class])==null?void 0:g[m.id])||!1}),selected:Be(o,h=>h.selected),nbSelected:Be(o,h=>Object.entries(h.selected).reduce((m,[g,v])=>g==="User"?m:m+Object.keys(v).length,0)),isSetSelected:Be(o,h=>m=>h.id===m.id)}}const po=on({type:"documentSet",modelName:"document-set",title:V==="en"?"Document set":"Set de documents",extractMeta:t=>({title:t.title,url:t.url})}),ht=on({type:"regionsSet",modelName:"regions-set",title:V==="en"?"Regions set":"Set de régions",extractMeta:t=>t});function mo(t){if(!t.startsWith("wit"))return t;const[e,...i]=t.split("_wit");return`wit${i}`}on({type:"clusterSet",modelName:"cluster-set",title:V==="en"?"Selected regions":"Régions sélectionnées",extractMeta:t=>({imgRef:t.id,clusterId:t.clusterId,title:t.title,xywh:t.xywh,img:mo(t.id)})});function go(){const t=`${window.location.origin}${window.location.pathname}`,e=Ee(1),i=Ee({}),n=Ee({}),s=Ee("");sn(e,"p");function r(u){s.update(f=>{const d=f===u?"":u;return navigator.clipboard.writeText(d).then(h=>""),d})}const l=(async()=>{try{const u=await fetch(`${t}canvas`);if(!u.ok)return{};const f=await u.json();let d={};return Object.values(f).forEach(h=>{Object.entries(h).forEach(([m,g])=>{d[m]=g})}),i.set(d),f}catch{return{}}})(),o=Be(e,u=>(async()=>{const d=await(await fetch(`${t}canvas?p=${u}`)).json();return n.set(d),d})());function a(u){rn(u,e,"p")}function c(u){i.update(f=>(delete f[u],{...f})),n.update(f=>{for(const d in f)if(f[d][u]){const{[u]:h,...m}=f[d];return f[d]=m,f}return f})}return{currentPage:e,pageRegions:n,allRegions:i,fetchPages:o,fetchAll:l,handlePageUpdate:a,remove:c,clipBoard:s,copyRef:r}}const _t=go();function Tn(t){let e,i,n;return{c(){e=b("div"),e.innerHTML='<div class="loader svelte-vizlcg"></div>',p(e,"class","bkg-shade svelte-vizlcg")},m(s,r){S(s,e,r),n=!0},i(s){n||(Ze(()=>{n&&(i||(i=nt(e,mt,{duration:150},!0)),i.run(1))}),n=!0)},o(s){i||(i=nt(e,mt,{duration:150},!1)),i.run(0),n=!1},d(s){s&&k(e),s&&i&&i.end()}}}function _o(t){let e,i,n=t[0]&&Tn();return{c(){n&&n.c(),e=he()},m(s,r){n&&n.m(s,r),S(s,e,r),i=!0},p(s,[r]){s[0]?n?r&1&&R(n,1):(n=Tn(),n.c(),R(n,1),n.m(e.parentNode,e)):n&&(_e(),D(n,1,1,()=>{n=null}),ve())},i(s){i||(R(n),i=!0)},o(s){D(n),i=!1},d(s){n&&n.d(s),s&&k(e)}}}function vo(t,e,i){let n;return oe(t,Et,s=>i(0,n=s)),[n]}class Lr extends de{constructor(e){super(),fe(this,e,vo,_o,ue,{})}}const bo=t=>({}),Pn=t=>({});function yo(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g,v,w,O,L,C,T;const $=t[1].content,F=Ge($,t,t[0],Pn);return{c(){e=b("button"),i=N(),n=b("div"),s=b("div"),r=N(),l=b("div"),o=b("div"),o.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,a=N(),c=b("section"),u=b("div"),f=N(),d=b("div"),F&&F.c(),h=N(),m=b("footer"),g=b("div"),v=b("button"),v.textContent=`${V==="en"?"Abort":"Retour"}`,w=N(),O=b("button"),O.textContent="OK",p(e,"id","hidden-msg-btn"),p(e,"data-target","msg-modal"),e.hidden=!0,p(s,"id","modal-bkg"),p(s,"class","modal-background"),p(o,"class","modal-card-head media mb-0"),p(u,"id","modal-msg"),p(d,"class","py-3"),p(c,"id","modal-body"),p(c,"class","modal-card-body"),p(v,"id","cancel-btn"),p(v,"class","button is-link is-light button-close"),p(O,"id","ok-btn"),p(O,"class","button is-link button-close"),p(g,"class","buttons"),p(m,"id","modal-footer"),p(m,"class","modal-card-foot is-center pt-3"),m.hidden=!0,p(l,"class","modal-content"),p(n,"id","msg-modal"),p(n,"class","modal fade"),p(n,"tabindex","-1"),p(n,"aria-labelledby","selection-modal-label"),p(n,"aria-hidden","true")},m(E,P){S(E,e,P),S(E,i,P),S(E,n,P),_(n,s),_(n,r),_(n,l),_(l,o),_(l,a),_(l,c),_(c,u),_(c,f),_(c,d),F&&F.m(d,null),_(l,h),_(l,m),_(m,g),_(g,v),_(g,w),_(g,O),L=!0,C||(T=[ui(Pr.call(null,e)),ui(Tr.call(null,n))],C=!0)},p(E,[P]){F&&F.p&&(!L||P&1)&&Je(F,$,E,E[0],L?Ye($,E[0],P,bo):Xe(E[0]),Pn)},i(E){L||(R(F,E),L=!0)},o(E){D(F,E),L=!1},d(E){E&&k(e),E&&k(i),E&&k(n),F&&F.d(E),C=!1,Ie(T)}}}function wo(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=r=>{"$$scope"in r&&i(0,s=r.$$scope)},[s,n]}class ko extends de{constructor(e){super(),fe(this,e,wo,yo,ue,{})}}const So=t=>({activeTab:t&8}),Ln=t=>({activeTab:t[3]});function Mn(t,e,i){const n=t.slice();return n[11]=e[i][0],n[12]=e[i][1],n}const Eo=t=>({activeTab:t&8}),Rn=t=>({activeTab:t[3]}),Co=t=>({}),Dn=t=>({});function Io(t){let e,i,n=Object.entries(t[2]),s=[];for(let r=0;r<n.length;r+=1)s[r]=Nn(Mn(t,n,r));return{c(){e=b("div"),i=b("ul");for(let r=0;r<s.length;r+=1)s[r].c();p(e,"class","tabs")},m(r,l){S(r,e,l),_(e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,null)},p(r,l){if(l&28){n=Object.entries(r[2]);let o;for(o=0;o<n.length;o+=1){const a=Mn(r,n,o);s[o]?s[o].p(a,l):(s[o]=Nn(a),s[o].c(),s[o].m(i,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},i:j,o:j,d(r){r&&k(e),st(s,r)}}}function Oo(t){let e;const i=t[8].tabs,n=Ge(i,t,t[7],Rn);return{c(){n&&n.c()},m(s,r){n&&n.m(s,r),e=!0},p(s,r){n&&n.p&&(!e||r&136)&&Je(n,i,s,s[7],e?Ye(i,s[7],r,Eo):Xe(s[7]),Rn)},i(s){e||(R(n,s),e=!0)},o(s){D(n,s),e=!1},d(s){n&&n.d(s)}}}function Nn(t){let e,i,n=t[12]+"",s,r,l,o;function a(){return t[9](t[11])}return{c(){e=b("li"),i=b("a"),s=W(n),r=N(),p(i,"href",null),qe(e,"is-active",t[3]===t[11])},m(c,u){S(c,e,u),_(e,i),_(i,s),_(e,r),l||(o=re(i,"click",a),l=!0)},p(c,u){t=c,u&4&&n!==(n=t[12]+"")&&ce(s,n),u&12&&qe(e,"is-active",t[3]===t[11])},d(c){c&&k(e),l=!1,o()}}}function Ao(t){let e,i,n,s,r,l,o,a,c,u,f,d,h;e=new Lr({});const m=t[8].sidebar,g=Ge(m,t,t[7],Dn),v=[Oo,Io],w=[];function O(T,$){return $&4&&(a=null),T[5].tabs?0:(a==null&&(a=!!Object.keys(T[2]).length),a?1:-1)}~(c=O(t,-1))&&(u=w[c]=v[c](t));const L=t[8].content,C=Ge(L,t,t[7],Ln);return{c(){Z(e.$$.fragment),i=N(),n=b("div"),s=b("aside"),g&&g.c(),r=N(),l=b("main"),o=b("nav"),u&&u.c(),f=N(),d=b("div"),C&&C.c(),p(s,"class","sidebar svelte-jexg"),$e(s,"width",t[0]+"%"),$e(s,"min-height",t[1]),p(o,"id","tabs"),p(o,"class","tabs-bar svelte-jexg"),p(d,"class","content-area pl-5 svelte-jexg"),p(l,"class","main-content svelte-jexg"),$e(l,"width",100-t[0]+"%"),$e(l,"min-height",t[1]),p(n,"class","layout svelte-jexg"),$e(n,"min-height",t[1])},m(T,$){X(e,T,$),S(T,i,$),S(T,n,$),_(n,s),g&&g.m(s,null),_(n,r),_(n,l),_(l,o),~c&&w[c].m(o,null),_(l,f),_(l,d),C&&C.m(d,null),h=!0},p(T,[$]){g&&g.p&&(!h||$&128)&&Je(g,m,T,T[7],h?Ye(m,T[7],$,Co):Xe(T[7]),Dn),(!h||$&1)&&$e(s,"width",T[0]+"%");let F=c;c=O(T,$),c===F?~c&&w[c].p(T,$):(u&&(_e(),D(w[F],1,1,()=>{w[F]=null}),ve()),~c?(u=w[c],u?u.p(T,$):(u=w[c]=v[c](T),u.c()),R(u,1),u.m(o,null)):u=null),C&&C.p&&(!h||$&136)&&Je(C,L,T,T[7],h?Ye(L,T[7],$,So):Xe(T[7]),Ln),(!h||$&1)&&$e(l,"width",100-T[0]+"%")},i(T){h||(R(e.$$.fragment,T),R(g,T),R(u),R(C,T),h=!0)},o(T){D(e.$$.fragment,T),D(g,T),D(u),D(C,T),h=!1},d(T){Q(e,T),T&&k(i),T&&k(n),g&&g.d(T),~c&&w[c].d(),C&&C.d(T)}}}function To(t=null){t||(t=document.getElementById("navbar")),document.documentElement.style.setProperty("--top-offset",`${t.offsetHeight}px`)}function Po(t,e,i){let n,{$$slots:s={},$$scope:r}=e;const l=$l(s);let{sidebarWidth:o="25"}=e;const a="90vh";let{tabList:c={}}=e,u=Object.keys(c),{topOffsetElement:f=null}=e;To(f);function d(m){if(!u.includes(m)){console.warn(`Tab "${m}" is not available.`);return}i(3,n=m);const g=new URL(window.location);g.searchParams.set("tab",m),window.history.pushState({},"",g)}const h=m=>d(m);return t.$$set=m=>{"sidebarWidth"in m&&i(0,o=m.sidebarWidth),"tabList"in m&&i(2,c=m.tabList),"topOffsetElement"in m&&i(6,f=m.topOffsetElement),"$$scope"in m&&i(7,r=m.$$scope)},i(3,n=new URLSearchParams(window.location.search).get("tab")??u[0]??null),[o,a,c,n,d,l,f,r,s,h]}class Lo extends de{constructor(e){super(),fe(this,e,Po,Ao,ue,{sidebarWidth:0,layoutHeight:1,tabList:2,topOffsetElement:6})}get layoutHeight(){return this.$$.ctx[1]}}function $n(t,e,i){const n=t.slice();return n[8]=e[i],n[10]=i,n}function jn(t,e,i){const n=t.slice();return n[11]=e[i][0],n[12]=e[i][1],n}function Fn(t,e,i){const n=t.slice();return n[11]=e[i][0],n[12]=e[i][1],n}function Un(t){let e,i;return{c(){e=b("a"),i=b("span"),p(i,"class","iconify"),p(i,"data-icon","entypo:edit"),p(e,"href",t[2]),p(e,"class","edit-btn button is-small is-rounded is-link px-3 ml-2 mt-1"),p(e,"title","Edit")},m(n,s){S(n,e,s),_(e,i)},p(n,s){s&4&&p(e,"href",n[2])},d(n){n&&k(e)}}}function Vn(t){let e,i=t[12].label+"",n,s,r,l,o=t[12].value+"",a;return{c(){e=b("span"),n=W(i),s=N(),r=b("span"),l=b("span"),a=W(o),p(e,"class","witness-key svelte-1yrx5r8"),p(r,"class","witness-value svelte-1yrx5r8")},m(c,u){S(c,e,u),_(e,n),S(c,s,u),S(c,r,u),_(r,l),_(l,a)},p(c,u){u&2&&i!==(i=c[12].label+"")&&ce(n,i),u&2&&o!==(o=c[12].value+"")&&ce(a,o)},d(c){c&&k(e),c&&k(s),c&&k(r)}}}function Hn(t){let e,i,n,s=t[1].metadata_full.contents,r=[];for(let l=0;l<s.length;l+=1)r[l]=Kn($n(t,s,l));return{c(){e=b("h3"),e.textContent="Contents",i=N();for(let l=0;l<r.length;l+=1)r[l].c();n=he(),p(e,"class","title is-5 mb-3")},m(l,o){S(l,e,o),S(l,i,o);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,o);S(l,n,o)},p(l,o){if(o&26){s=l[1].metadata_full.contents;let a;for(a=0;a<s.length;a+=1){const c=$n(l,s,a);r[a]?r[a].p(c,o):(r[a]=Kn(c),r[a].c(),r[a].m(n.parentNode,n))}for(;a<r.length;a+=1)r[a].d(1);r.length=s.length}},d(l){l&&k(e),l&&k(i),st(r,l),l&&k(n)}}}function Bn(t){let e;return{c(){e=b("i"),p(e,"class","fa-solid fa-chevron-down")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function zn(t){let e,i=Object.entries(t[8].content),n=[];for(let s=0;s<i.length;s+=1)n[s]=qn(jn(t,i,s));return{c(){e=b("div");for(let s=0;s<n.length;s+=1)n[s].c();p(e,"class","mt-2 pl-3")},m(s,r){S(s,e,r);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(s,r){if(r&2){i=Object.entries(s[8].content);let l;for(l=0;l<i.length;l+=1){const o=jn(s,i,l);n[l]?n[l].p(o,r):(n[l]=qn(o),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(s){s&&k(e),st(n,s)}}}function qn(t){let e,i,n=t[11]+"",s,r,l,o=t[12]+"",a;return{c(){e=b("div"),i=b("b"),s=W(n),r=W(":"),l=N(),a=W(o),p(e,"class","witness-value svelte-1yrx5r8")},m(c,u){S(c,e,u),_(e,i),_(i,s),_(i,r),_(e,l),_(e,a)},p(c,u){u&2&&n!==(n=c[11]+"")&&ce(s,n),u&2&&o!==(o=c[12]+"")&&ce(a,o)},d(c){c&&k(e)}}}function Kn(t){let e,i,n=t[8].title+"",s,r,l=Object.entries(t[8].content).length,o,a=t[3].has(t[10]),c,u,f,d=l&&Bn();function h(){return t[5](t[10])}function m(){return t[6](t[10])}let g=a&&zn(t);return{c(){e=b("div"),i=b("div"),s=W(n),r=N(),d&&d.c(),o=N(),g&&g.c(),c=N(),p(i,"class","is-flex is-justify-content-space-between witness-key svelte-1yrx5r8"),p(e,"class","mb-3")},m(v,w){S(v,e,w),_(e,i),_(i,s),_(i,r),d&&d.m(i,null),_(e,o),g&&g.m(e,null),_(e,c),u||(f=[re(i,"click",h),re(i,"keypress",m)],u=!0)},p(v,w){t=v,w&2&&n!==(n=t[8].title+"")&&ce(s,n),w&2&&(l=Object.entries(t[8].content).length),l?d||(d=Bn(),d.c(),d.m(i,null)):d&&(d.d(1),d=null),w&8&&(a=t[3].has(t[10])),a?g?g.p(t,w):(g=zn(t),g.c(),g.m(e,c)):g&&(g.d(1),g=null)},d(v){v&&k(e),d&&d.d(),g&&g.d(),u=!1,Ie(f)}}}function Mo(t){var h;let e,i,n,s,r,l,o,a,c=t[1].can_edit&&Un(t),u=Object.entries(t[1].metadata_full.wit),f=[];for(let m=0;m<u.length;m+=1)f[m]=Vn(Fn(t,u,m));let d=((h=t[1].metadata_full.contents)==null?void 0:h.length)&&Hn(t);return{c(){e=b("div"),i=b("div"),n=b("div"),s=b("h1"),r=W(t[0]),l=N(),c&&c.c(),o=N();for(let m=0;m<f.length;m+=1)f[m].c();a=N(),d&&d.c(),p(s,"class","title"),p(n,"class","pb-2"),p(i,"class","content is-small mt-4"),p(e,"class","m-4 py-5 px-4")},m(m,g){S(m,e,g),_(e,i),_(i,n),_(n,s),_(s,r),_(s,l),c&&c.m(s,null),_(n,o);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(n,null);_(n,a),d&&d.m(n,null)},p(m,[g]){var v;if(g&1&&ce(r,m[0]),m[1].can_edit?c?c.p(m,g):(c=Un(m),c.c(),c.m(s,null)):c&&(c.d(1),c=null),g&2){u=Object.entries(m[1].metadata_full.wit);let w;for(w=0;w<u.length;w+=1){const O=Fn(m,u,w);f[w]?f[w].p(O,g):(f[w]=Vn(O),f[w].c(),f[w].m(n,a))}for(;w<f.length;w+=1)f[w].d(1);f.length=u.length}(v=m[1].metadata_full.contents)!=null&&v.length?d?d.p(m,g):(d=Hn(m),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},i:j,o:j,d(m){m&&k(e),c&&c.d(),st(f,m),d&&d.d()}}}function Ro(t,e,i){let{viewTitle:n=""}=e,{witness:s={}}=e,{editUrl:r=""}=e,l={},o=new Set;vt(async()=>{const f=`${window.location.origin}/${je}/witness/select`;try{l=await(await fetch(f)).json()}catch(d){return console.error("Error:",d),!1}});function a(f){o.has(f)?o.delete(f):o.add(f),i(3,o=new Set(o))}const c=f=>a(f),u=f=>a(f);return t.$$set=f=>{"viewTitle"in f&&i(0,n=f.viewTitle),"witness"in f&&i(1,s=f.witness),"editUrl"in f&&i(2,r=f.editUrl)},[n,s,r,o,a,c,u]}class Do extends de{constructor(e){super(),fe(this,e,Ro,Mo,ue,{viewTitle:0,witness:1,editUrl:2})}}const No="modulepreload",$o=function(t){return"/"+t},xn={},Mr=function(e,i,n){if(!i||i.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(i.map(r=>{if(r=$o(r),r in xn)return;xn[r]=!0;const l=r.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!n)for(let u=s.length-1;u>=0;u--){const f=s[u];if(f.href===r&&(!l||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${r}"]${o}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":No,l||(c.as="script",c.crossOrigin=""),c.href=r,document.head.appendChild(c),l)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e()).catch(r=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r})};function jo(t){let e;return{c(){e=Qe("path"),p(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),p(e,"class","svelte-1829hp2")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function Fo(t){let e;return{c(){e=Qe("path"),p(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),p(e,"class","svelte-1829hp2")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function Uo(t){let e=V==="en"?"Copy ID":"Copier l'ID",i;return{c(){i=W(e)},m(n,s){S(n,i,s)},p:j,d(n){n&&k(i)}}}function Vo(t){let e=V==="en"?"Copied!":"Copié !",i;return{c(){i=W(e)},m(n,s){S(n,i,s)},p:j,d(n){n&&k(i)}}}function Wn(t){let e,i,n;var s=t[7];function r(l){return{props:{mainImgItem:l[1],compareImgItem:l[14]}}}return s&&(e=fi(s,r(t))),{c(){e&&Z(e.$$.fragment),i=he()},m(l,o){e&&X(e,l,o),S(l,i,o),n=!0},p(l,o){const a={};if(o&2&&(a.mainImgItem=l[1]),o&128&&s!==(s=l[7])){if(e){_e();const c=e;D(c.$$.fragment,1,0,()=>{Q(c,1)}),ve()}s?(e=fi(s,r(l)),Z(e.$$.fragment),R(e.$$.fragment,1),X(e,i.parentNode,i)):e=null}else s&&e.$set(a)},i(l){n||(e&&R(e.$$.fragment,l),n=!0)},o(l){e&&D(e.$$.fragment,l),n=!1},d(l){l&&k(i),e&&Q(e,l)}}}function Ho(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g,v,w,O,L,C,T,$,F;function E(q,U){return q[8]?Fo:jo}let P=E(t),G=P(t);function ee(q,U){return q[8]?Vo:Uo}let M=ee(t),H=M(t),z=t[7]&&Wn(t);return{c(){e=b("div"),i=b("figure"),n=b("img"),r=N(),l=b("div"),o=b("span"),u=N(),f=b("div"),d=b("button"),h=Qe("svg"),G.c(),m=N(),g=b("span"),H.c(),w=N(),z&&z.c(),p(n,"class","region-img svelte-1829hp2"),We(n.src,s=t[9])||p(n,"src",s),p(n,"alt","Extracted region"),p(o,"class","overlay-desc"),p(l,"class","overlay is-center svelte-1829hp2"),p(i,"class",a="image card region-image "+(t[0]?"is-96x96":"")+" svelte-1829hp2"),p(i,"tabindex","-1"),p(i,"style",c=(t[2]==="full"?"height: 100%":`height: ${t[2]}px; min-width: ${t[2]}px`)+"; "+(t[3]?`border: 5px solid ${t[3]};`:"")),p(h,"xmlns","http://www.w3.org/2000/svg"),p(h,"viewBox","0 0 384 512"),p(h,"class","svelte-1829hp2"),p(g,"class","tooltip svelte-1829hp2"),p(d,"class","button tag svelte-1829hp2"),p(d,"style",v=t[6]?"":"display: none;"),p(f,"class","region-btn ml-1 svelte-1829hp2"),p(e,"class",O="region is-center "+(t[5]&&t[11](t[1])?"checked":"")+" svelte-1829hp2"),p(e,"style",L=t[2]==="full"?"height: 100%":"")},m(q,U){S(q,e,U),_(e,i),_(i,n),_(i,r),_(i,l),_(l,o),o.innerHTML=t[10],_(e,u),_(e,f),_(f,d),_(d,h),G.m(h,null),_(d,m),_(d,g),H.m(g,null),_(f,w),z&&z.m(f,null),T=!0,$||(F=[re(i,"click",t[19]),re(i,"keyup",Bo),re(d,"click",t[20])],$=!0)},p(q,[U]){t=q,(!T||U&512&&!We(n.src,s=t[9]))&&p(n,"src",s),(!T||U&1024)&&(o.innerHTML=t[10]),(!T||U&1&&a!==(a="image card region-image "+(t[0]?"is-96x96":"")+" svelte-1829hp2"))&&p(i,"class",a),(!T||U&12&&c!==(c=(t[2]==="full"?"height: 100%":`height: ${t[2]}px; min-width: ${t[2]}px`)+"; "+(t[3]?`border: 5px solid ${t[3]};`:"")))&&p(i,"style",c),P!==(P=E(t))&&(G.d(1),G=P(t),G&&(G.c(),G.m(h,null))),M===(M=ee(t))&&H?H.p(t,U):(H.d(1),H=M(t),H&&(H.c(),H.m(g,null))),(!T||U&64&&v!==(v=t[6]?"":"display: none;"))&&p(d,"style",v),t[7]?z?(z.p(t,U),U&128&&R(z,1)):(z=Wn(t),z.c(),R(z,1),z.m(f,null)):z&&(_e(),D(z,1,1,()=>{z=null}),ve()),(!T||U&2082&&O!==(O="region is-center "+(t[5]&&t[11](t[1])?"checked":"")+" svelte-1829hp2"))&&p(e,"class",O),(!T||U&4&&L!==(L=t[2]==="full"?"height: 100%":""))&&p(e,"style",L)},i(q){T||(R(z),Ze(()=>{T&&(C||(C=nt(e,mt,{duration:t[15]},!0)),C.run(1))}),T=!0)},o(q){D(z),C||(C=nt(e,mt,{duration:t[15]},!1)),C.run(0),T=!1},d(q){q&&k(e),G.d(),H.d(),z&&z.d(),q&&C&&C.end(),$=!1,Ie(F)}}}const Bo=()=>null;function zo(t,e,i){let n,s,r,l,o,{selectionStore:a}=e;a||(a=ht);const{isSelected:c}=a;oe(t,c,P=>i(11,o=P));const{clipBoard:u}=_t;oe(t,u,P=>i(18,l=P));let{item:f}=e,{descPromise:d=void 0}=e,{isSquare:h=!0}=e,{height:m=h?96:140}=e;m==="full"&&(h=!1);let{borderColor:g=null}=e,{toggleSelection:v=a.toggle}=e;const w=Ae("qImgMetadata")||void 0,O=Ae("isInModal")||!1,L=O?0:500;let C;O||Mr(()=>import("./ModalController-68284a21.js"),[]).then(P=>i(7,C=P.default));let{selectable:T=!O}=e,{copyable:$=!0}=e;const F=()=>T?v(f):null,E=()=>$?_t.copyRef(f.ref):null;return t.$$set=P=>{"selectionStore"in P&&i(16,a=P.selectionStore),"item"in P&&i(1,f=P.item),"descPromise"in P&&i(17,d=P.descPromise),"isSquare"in P&&i(0,h=P.isSquare),"height"in P&&i(2,m=P.height),"borderColor"in P&&i(3,g=P.borderColor),"toggleSelection"in P&&i(4,v=P.toggleSelection),"selectable"in P&&i(5,T=P.selectable),"copyable"in P&&i(6,$=P.copyable)},t.$$.update=()=>{t.$$.dirty&2&&i(10,n=f.title),t.$$.dirty&131072&&d&&d.then(P=>i(10,n=P)),t.$$.dirty&7&&i(9,s=gt(f.img??f.ref,f.xywh,m==="full"?m:h?`${m},`:`,${m}`)),t.$$.dirty&262146&&i(8,r=f.ref===l)},[h,f,m,g,v,T,$,C,r,s,n,o,c,u,w,L,a,d,l,F,E]}class an extends de{constructor(e){super(),fe(this,e,zo,Ho,ue,{selectionStore:16,item:1,descPromise:17,isSquare:0,height:2,borderColor:3,toggleSelection:4,selectable:5,copyable:6})}}function qo(t){let e,i,n,s,r,l=V==="en"?"Selection":"Sélection",o,a,c,u,f,d;return{c(){e=b("div"),i=b("button"),n=b("span"),s=b("i"),r=N(),o=W(l),a=W(`
            (`),c=W(t[0]),u=W(")"),p(s,"class","fa-solid fa-book-bookmark"),p(n,"id","btn-content"),p(i,"id","set-btn"),p(i,"class","button px-5 py-4 is-link svelte-gmt9z5"),p(i,"data-target","selection-modal"),p(e,"class","set-container svelte-gmt9z5")},m(h,m){S(h,e,m),_(e,i),_(i,n),_(n,s),_(n,r),_(n,o),_(n,a),_(n,c),_(n,u),f||(d=ui(Pr.call(null,i)),f=!0)},p(h,[m]){m&1&&ce(c,h[0])},i:j,o:j,d(h){h&&k(e),f=!1,d()}}}function Ko(t,e,i){let{selectionLength:n=0}=e,s=n;return t.$$set=r=>{"selectionLength"in r&&i(0,n=r.selectionLength)},t.$$.update=()=>{if(t.$$.dirty&3&&n!==s){const r=n>s;i(1,s=n);const l=document.getElementById("btn-content");l&&l.animate([{transform:r?"translateY(-7px)":"translateX(-5px)"},{transform:r?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[n,s]}class xo extends de{constructor(e){super(),fe(this,e,Ko,qo,ue,{selectionLength:0})}}function Wo(t){let e,i,n;return{c(){e=b("button"),e.textContent=`${V==="en"?"Automatic region extraction":"Extraction automatique des régions"}`,p(e,"class","button is-link is-light")},m(s,r){S(s,e,r),i||(n=re(e,"click",t[1]),i=!0)},p:j,d(s){s&&k(e),i=!1,n()}}}function Go(t){let e,i,n,s=Rt.includes("regions"),r,l,o=s&&Wo(t);return{c(){e=b("div"),i=b("button"),i.textContent=`${V==="en"?"Manually annotate":"Annoter manuellement"}`,n=N(),o&&o.c(),p(i,"class","button is-link"),p(e,"class","is-center buttons is-centered pt-5")},m(a,c){S(a,e,c),_(e,i),_(e,n),o&&o.m(e,null),r||(l=re(i,"click",t[0]),r=!0)},p(a,[c]){s&&o.p(a,c)},i:j,o:j,d(a){a&&k(e),o&&o.d(),r=!1,l()}}}function Yo(t,e,i){const n=Ae("witness");let{currentRegionId:s}=e,{baseUrl:r}=e;async function l(){const a=`${window.location.origin}/${je}`;let c=`${a}/witness/${n.id}/regions/add`;if(n.regions.length===1||s){const d=s||n.regions[0];c=`${a}/witness/${n.id}/regions/${d}/add`}const u=await Dt(()=>fetch(c,{method:"POST",headers:{"X-CSRFToken":Ke}}));if(!u.ok)throw await Me(`Failed to create regions: '${u.statusText}'`,"Error"),new Error(`Failed to create regions: '${u.statusText}'`);let f;try{f=await u.json()}catch(d){throw await Me(`Failed to parse JSON response: '${d}'`,"Error"),new Error(`Failed to parse JSON response: '${d}'`)}f.hasOwnProperty("mirador_url")&&window.open(f.mirador_url),f.hasOwnProperty("regions_id")&&(window.location.href=`${r.split("regions/")[0]}regions/${f.regions_id}`)}async function o(){const a=`${window.location.origin}/${je}/witness/${n.id}/regions/extract`,c=await Dt(()=>fetch(a,{method:"POST",headers:{"X-CSRFToken":Ke}}));let u;if(c.ok)try{u=await c.json(),console.log(u)}catch(f){throw await Me(`Failed to parse JSON response: '${f}'`,"Error"),new Error(`Failed to parse JSON response: '${f}'`)}finally{const f=u.doc_set_id;if(!f)throw await Me("Failed to launch regions extraction: 'No document set id'","Error"),new Error("Failed to launch regions extraction: 'No document set id'");window.location.href=`${window.location.origin}/${je}/treatment/add/?document_set=${f}&task_type=regions`}else throw await Me(`Failed to launch regions extraction: '${u.message}'`,"Error"),new Error(`Failed to launch regions extraction: '${u.message}'`)}return t.$$set=a=>{"currentRegionId"in a&&i(2,s=a.currentRegionId),"baseUrl"in a&&i(3,r=a.baseUrl)},[l,o,s,r]}class Rr extends de{constructor(e){super(),fe(this,e,Yo,Go,ue,{currentRegionId:2,baseUrl:3})}}function Gn(t,e,i){const n=t.slice();return n[7]=e[i],n}function Jo(t){let e,i=t[3].regions,n=[];for(let s=0;s<i.length;s+=1)n[s]=Yn(Gn(t,i,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=he()},m(s,r){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(s,r);S(s,e,r)},p(s,r){if(r&9){i=s[3].regions;let l;for(l=0;l<i.length;l+=1){const o=Gn(s,i,l);n[l]?n[l].p(o,r):(n[l]=Yn(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(s){st(n,s),s&&k(e)}}}function Xo(t){let e,i;function n(l,o){if(o&4&&(e=null),e==null&&(e=!!["all","page"].includes(l[2])),e)return Zo;if(l[2]==="similarity")return Qo}let s=n(t,-1),r=s&&s(t);return{c(){r&&r.c(),i=he()},m(l,o){r&&r.m(l,o),S(l,i,o)},p(l,o){s===(s=n(l,o))&&r?r.p(l,o):(r&&r.d(1),r=s&&s(l),r&&(r.c(),r.m(i.parentNode,i)))},d(l){r&&r.d(l),l&&k(i)}}}function Yn(t){let e,i,n=t[7]+"",s,r;return{c(){e=b("a"),i=W("Regions extraction #"),s=W(n),p(e,"href",r=""+(t[0]+t[7])),p(e,"class","tag is-dark mr-3 is-rounded")},m(l,o){S(l,e,o),_(e,i),_(e,s)},p(l,o){o&1&&r!==(r=""+(l[0]+l[7]))&&p(e,"href",r)},d(l){l&&k(e)}}}function Qo(t){let e,i,n;return{c(){e=b("button"),e.textContent=`${V==="en"?"Delete all regions similarity":"Supprimer toutes les similarités du document"}`,p(e,"class","tag is-danger")},m(s,r){S(s,e,r),i||(n=re(e,"click",t[6]),i=!0)},p:j,d(s){s&&k(e),i=!1,n()}}}function Zo(t){let e,i,n,s,r,l;return{c(){e=b("a"),i=W("All regions"),n=N(),s=b("button"),s.textContent=`${V==="en"?"Delete regions extraction record":"Supprimer l'extraction de régions"}`,p(e,"href",t[4]),p(e,"class","tag is-dark mr-3 is-rounded"),p(s,"class","tag is-danger")},m(o,a){S(o,e,a),_(e,i),S(o,n,a),S(o,s,a),r||(l=re(s,"click",t[5]),r=!0)},p:j,d(o){o&&k(e),o&&k(n),o&&k(s),r=!1,l()}}}function ea(t){let e,i;function n(l,o){if(o&4&&(i=null),l[1])return Xo;if(i==null&&(i=!!["all","page","similarity"].includes(l[2])),i)return Jo}let s=n(t,-1),r=s&&s(t);return{c(){e=b("div"),r&&r.c()},m(l,o){S(l,e,o),r&&r.m(e,null)},p(l,[o]){s===(s=n(l,o))&&r?r.p(l,o):(r&&r.d(1),r=s&&s(l),r&&(r.c(),r.m(e,null)))},i:j,o:j,d(l){l&&k(e),r&&r.d()}}}function ta(t,e,i){const n=Ae("witness");let{baseUrl:s=`${window.location.origin}${window.location.pathname}`}=e,{currentRegionId:r}=e,{activeTab:l}=e;const o=s.replace(/\/\d+\/?$/,"");async function a(){if(!await Me(V==="en"?"Are you sure you want to delete this record?":"Voulez-vous vraiment supprimer cet enregistrement ?",V==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof r!="number")throw new Error("Invalid region ID");const f=`${window.location.origin}/${je}/regions/${r}/delete`;try{const d=await Dt(()=>fetch(f,{method:"DELETE",headers:{"X-CSRFToken":Ke}}));if(d.status!==204)throw new Error(`Failed to delete regions: '${d.statusText}'`);window.location.href=`${s.split("regions/")[0]}regions/`}catch(d){console.error(d)}}async function c(){if(!await Me(V==="en"?"Are you sure you want to delete all similarity scores for this document?":"Voulez-vous vraiment supprimer l'intégralité des scores de similarité pour ce document ?",V==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;if(typeof r!="number")throw new Error("Invalid region ID");const f=`${window.location.origin}/${je}/similarity/reset/${r}`;try{const d=await Dt(()=>fetch(f,{method:"DELETE",headers:{"X-CSRFToken":Ke}}));if(d.status===204||d.status===200)window.location.href=`${s.split("regions/")[0]}regions/`;else throw new Error(`Failed to delete similarity: '${d.statusText}'`)}catch(d){console.error(d),await Me(d.message,"Error")}}return t.$$set=u=>{"baseUrl"in u&&i(0,s=u.baseUrl),"currentRegionId"in u&&i(1,r=u.currentRegionId),"activeTab"in u&&i(2,l=u.activeTab)},[s,r,l,n,o,a,c]}class ia extends de{constructor(e){super(),fe(this,e,ta,ea,ue,{baseUrl:0,currentRegionId:1,activeTab:2})}}function na(t){let e;return{c(){e=Qe("path"),p(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),p(e,"class","svelte-h0t5l9")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function sa(t){let e;return{c(){e=Qe("path"),p(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),p(e,"class","svelte-h0t5l9")},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function ra(t){let e=V==="en"?"Edit":"Modifier",i;return{c(){i=W(e)},m(n,s){S(n,i,s)},p:j,d(n){n&&k(i)}}}function la(t){let e=V==="en"?"Validate":"Valider",i;return{c(){i=W(e)},m(n,s){S(n,i,s)},p:j,d(n){n&&k(i)}}}function Jn(t){let e,i,n,s=V==="en"?"Reload":"Recharger",r,l,o,a,c,u=V==="en"?"Go to editor":"Aller à l'éditeur",f,d,h,m,g,v=V==="en"?"Delete selected regions":"Supprimer les régions sélectionnées",w,O,L;return{c(){e=b("button"),i=b("i"),n=N(),r=W(s),l=N(),o=b("a"),a=b("i"),c=N(),f=W(u),d=N(),h=b("button"),m=b("i"),g=N(),w=W(v),p(i,"class","fa-solid fa-rotate-right"),p(e,"class","tag is-link is-light is-rounded mr-3"),p(a,"class","fa-solid fa-edit"),p(o,"class","tag is-link is-rounded mr-3"),p(o,"href",Nt(t[4])),p(o,"target","_blank"),p(m,"class","fa-solid fa-trash"),p(h,"class","tag is-danger is-rounded")},m(C,T){S(C,e,T),_(e,i),_(e,n),_(e,r),S(C,l,T),S(C,o,T),_(o,a),_(o,c),_(o,f),S(C,d,T),S(C,h,T),_(h,m),_(h,g),_(h,w),O||(L=[re(e,"click",t[14]),re(h,"click",t[6])],O=!0)},p:j,d(C){C&&k(e),C&&k(l),C&&k(o),C&&k(d),C&&k(h),O=!1,Ie(L)}}}function oa(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g=V==="en"?"Download":"Télécharger",v,w,O,L,C;function T(M,H){return M[0]?sa:na}let $=T(t),F=$(t);function E(M,H){return M[0]?la:ra}let P=E(t),G=P(t),ee=t[0]&&Jn(t);return{c(){e=b("div"),i=b("button"),n=Qe("svg"),F.c(),s=N(),G.c(),l=N(),o=b("button"),a=b("i"),c=N(),u=b("span"),u.textContent=`${V==="en"?"Select all":"Tout sélectionner"}`,f=N(),d=b("button"),h=b("i"),m=N(),v=W(g),w=N(),O=b("div"),ee&&ee.c(),p(n,"xmlns","http://www.w3.org/2000/svg"),p(n,"viewBox","0 0 384 512"),p(n,"class","pr-3 svelte-h0t5l9"),p(i,"class",r="button "+(t[0]?"is-success":"is-link")+" mr-3"),p(a,"class","fa-solid fa-square-check"),p(u,"id","all-selection"),p(o,"class","button is-link is-light mr-3"),p(h,"class","fa-solid fa-download"),p(d,"class","button is-link is-light"),p(e,"class","is-right mb-3"),p(O,"class","edit-action is-right svelte-h0t5l9")},m(M,H){S(M,e,H),_(e,i),_(i,n),F.m(n,null),_(i,s),G.m(i,null),_(e,l),_(e,o),_(o,a),_(o,c),_(o,u),_(e,f),_(e,d),_(d,h),_(d,m),_(d,v),S(M,w,H),S(M,O,H),ee&&ee.m(O,null),L||(C=[re(i,"click",t[13]),re(o,"click",t[7]),re(d,"click",t[8])],L=!0)},p(M,[H]){$!==($=T(M))&&(F.d(1),F=$(M),F&&(F.c(),F.m(n,null))),P===(P=E(M))&&G?G.p(M,H):(G.d(1),G=P(M),G&&(G.c(),G.m(i,null))),H&1&&r!==(r="button "+(M[0]?"is-success":"is-link")+" mr-3")&&p(i,"class",r),M[0]?ee?ee.p(M,H):(ee=Jn(M),ee.c(),ee.m(O,null)):ee&&(ee.d(1),ee=null)},i:j,o:j,d(M){M&&k(e),F.d(),G.d(),M&&k(w),M&&k(O),ee&&ee.d(),L=!1,Ie(C)}}}async function aa(t){const e=t.id_full,i=`${SAS_APP_URL}/annotation/destroy?uri=${e}`,n=await fetch(i,{method:"DELETE"});if(n.status!==204)throw new Error(`Failed to delete ${i} due to ${n.status}: '${n.statusText}'`)}function ca(t,e,i){let n,s,r,l,o,a,c;const{selected:u,nbSelected:f}=ht;oe(t,u,T=>i(11,a=T)),oe(t,f,T=>i(12,c=T));const{allRegions:d}=_t;oe(t,d,T=>i(10,o=T));const h=Ae("manifest"),m=Ae("isValidated");function g(){i(0,s=!s)}async function v(){if(await Me(V==="en"?"Are you sure you want to delete these regions?":"Voulez-vous vraiment supprimer ces régions ?",V==="en"?"Confirm deletion":"Confirmer la suppression",!0))for(const[$,F]of Object.entries(r))try{if(!o.hasOwnProperty($))continue;await aa(F),_t.remove($),ht.remove($,pi)}catch(E){await Me(`Failed to delete region ${$}: ${E.message}`,"Error")}}function w(){l?ht.removeAll(Object.keys(o),pi):ht.addAll(Object.values(o))}async function O(){const T=Object.values(r).map(E=>E.ref),F=await(await Dt(()=>fetch(`${window.location.origin}/${je}/regions/export`,{method:"POST",headers:{"X-CSRFToken":Ke},body:JSON.stringify({regionsRef:T})}))).blob();Or(F,"regions.zip")}const L=()=>g(),C=()=>location.reload();return t.$$.update=()=>{t.$$.dirty&4096&&i(9,n=c),t.$$.dirty&2048&&(r=Object.values(a)[0]||{}),t.$$.dirty&1536&&(l=n>=Object.keys(o).length)},i(0,s=!m),[s,u,f,d,h,g,v,w,O,n,o,a,c,L,C]}class ua extends de{constructor(e){super(),fe(this,e,ca,oa,ue,{})}}function fa(){const t=`${window.location.origin}${window.location.pathname}`,e=25,i=window.location.pathname.match(/\d+/g).join("-"),n={[i]:{}},s=[2,6],r=Ee(1),l=Ee({}),o=Ee(JSON.parse(localStorage.getItem("selectedRegions"))||n);o.subscribe(M=>localStorage.setItem("selectedRegions",JSON.stringify(M)));const a=Ee(JSON.parse(localStorage.getItem("excludedCategories"))||[]);a.subscribe(M=>localStorage.setItem("excludedCategories",JSON.stringify(M)));const c=Ee(JSON.parse(localStorage.getItem("similarityScoreCutoff"))||void 0);c.subscribe(M=>{M!=null&&localStorage.setItem("similarityScoreCutoff",JSON.stringify(M))});const u=Ee(JSON.parse(localStorage.getItem("propagateRecursionDepth"))||s[1]);u.subscribe(M=>localStorage.setItem("propagateRecursionDepth",JSON.stringify(M)));const f=Ee(JSON.parse(localStorage.getItem("propagateFilterByRegions"))||!1);f.subscribe(M=>localStorage.setItem("propagateFilterByRegions",JSON.stringify(M)));const d=Be([u,f],([M,H])=>({propagateRecursionDepth:M,propagateFilterByRegions:H})),h=Be([a,o,c],([M,H,z])=>({excludedCategories:M,regions:H,similarityScoreCutoff:z})),m=Be([d,h],([M,H])=>({propagate:M,similarity:H})),g=Ee([]),v=Ee([]);async function w(){const M=async()=>{const q=await(await fetch(`${t}compared-regions`)).json();l.set(q),o.update(U=>{let se=U[i]||{};if(Object.keys(se).length){let Y=Object.keys(se).filter(te=>Object.keys(q).includes(te)).reduce((te,ne)=>(te[ne]=se[ne],te),{});U[i]=Y}return U})},H=async()=>{const q=await(await fetch(`${t}query-images`)).json();q.length>0&&(g.set(q),G(F()))};Et.set(!0);try{await Promise.all([M(),H()])}catch(z){console.error("Error:",z),Sr.set(z.message)}finally{Et.set(!1)}}function O(M){localStorage.setItem("selectedRegions",JSON.stringify(M))}function L(M){o.update(H=>{const z={...H};return delete z[i][M],O(z),z})}function C(M){o.update(H=>{const z={...H,[i]:{...H[i]||{},[M.ref]:M}};return O(z),z})}const T=Be(o,M=>H=>{var z;return(z=M[i])==null?void 0:z.hasOwnProperty(H)});function $(M){const H=Zi(l),z=Object.keys(H).filter(q=>q.startsWith(M));return z.length!==1?{title:"Error"}:H[z[0]]}const F=()=>sn(r,"sp"),E=Be([r,g],([M,H])=>(async()=>P(M,H))());function P(M,H){const z=(M-1)*e,q=z+e,U=H.slice(z,q);return v.set(U),U}function G(M){rn(M,r,"sp")}function ee(M){l.update(H=>({...H,[M.ref]:M}))}return{currentPage:r,comparedRegions:l,excludedCategories:a,qImgs:g,pageQImgs:v,selectedRegions:o,propagateRecursionDepth:u,propagateFilterByRegions:f,similarityToolbarParams:m,propagateParams:d,similarityScoreCutoff:c,allowedPropagateDepthRange:s,fetchSimilarity:w,setPageQImgs:E,getRegionsInfo:$,handlePageUpdate:G,unselect:L,select:C,addComparedRegions:ee,isSelected:T,pageLength:e}}const ze=fa();function da(t){let e,i,n;const s=t[1].default,r=Ge(s,t,t[0],null);return{c(){e=b("table"),i=b("tbody"),r&&r.c(),p(e,"class","table is-fullwidth")},m(l,o){S(l,e,o),_(e,i),r&&r.m(i,null),n=!0},p(l,[o]){r&&r.p&&(!n||o&1)&&Je(r,s,l,l[0],n?Ye(s,l[0],o,null):Xe(l[0]),null)},i(l){n||(R(r,l),n=!0)},o(l){D(r,l),n=!1},d(l){l&&k(e),r&&r.d(l)}}}function ha(t,e,i){let{$$slots:n={},$$scope:s}=e;return t.$$set=r=>{"$$scope"in r&&i(0,s=r.$$scope)},[s,n]}class yi extends de{constructor(e){super(),fe(this,e,ha,da,ue,{})}}function Xn(t){let e,i,n,s,r,l,o,a,c,u=t[5]>1&&Qn(t),f=t[5]<t[3]&&ts(t);return{c(){e=b("nav"),i=b("ul"),u&&u.c(),n=N(),s=b("li"),r=b("a"),l=W(t[5]),o=N(),f&&f.c(),p(r,"class","pagination-link is-current"),p(r,"href",null),p(i,"class","pagination-list ml-0"),p(e,"class","pagination is-centered mb-2"),p(e,"aria-label","pagination")},m(d,h){S(d,e,h),_(e,i),u&&u.m(i,null),_(i,n),_(i,s),_(s,r),_(r,l),_(i,o),f&&f.m(i,null),a||(c=re(r,"click",Ct(t[9])),a=!0)},p(d,h){d[5]>1?u?u.p(d,h):(u=Qn(d),u.c(),u.m(i,n)):u&&(u.d(1),u=null),h&32&&ce(l,d[5]),d[5]<d[3]?f?f.p(d,h):(f=ts(d),f.c(),f.m(i,null)):f&&(f.d(1),f=null)},d(d){d&&k(e),u&&u.d(),f&&f.d(),a=!1,c()}}}function Qn(t){let e,i,n,s,r,l,o=t[5]-1>1&&Zn(t);return{c(){e=b("li"),i=b("a"),i.textContent="1",n=N(),o&&o.c(),s=he(),p(i,"class","pagination-link"),p(i,"href",null)},m(a,c){S(a,e,c),_(e,i),S(a,n,c),o&&o.m(a,c),S(a,s,c),r||(l=re(i,"click",Ct(t[7])),r=!0)},p(a,c){a[5]-1>1?o?o.p(a,c):(o=Zn(a),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},d(a){a&&k(e),a&&k(n),o&&o.d(a),a&&k(s),r=!1,l()}}}function Zn(t){let e,i,n,s=t[5]-1+"",r,l,o,a=t[5]-1>2&&es();return{c(){a&&a.c(),e=N(),i=b("li"),n=b("a"),r=W(s),p(n,"class","pagination-link"),p(n,"href",null)},m(c,u){a&&a.m(c,u),S(c,e,u),S(c,i,u),_(i,n),_(n,r),l||(o=re(n,"click",Ct(t[8])),l=!0)},p(c,u){c[5]-1>2?a||(a=es(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),u&32&&s!==(s=c[5]-1+"")&&ce(r,s)},d(c){a&&a.d(c),c&&k(e),c&&k(i),l=!1,o()}}}function es(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function ts(t){let e,i,n,s,r,l,o=t[5]+1<t[3]&&is(t);return{c(){o&&o.c(),e=N(),i=b("li"),n=b("a"),s=W(t[3]),p(n,"class","pagination-link"),p(n,"href",null)},m(a,c){o&&o.m(a,c),S(a,e,c),S(a,i,c),_(i,n),_(n,s),r||(l=re(n,"click",Ct(t[11])),r=!0)},p(a,c){a[5]+1<a[3]?o?o.p(a,c):(o=is(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),c&8&&ce(s,a[3])},d(a){o&&o.d(a),a&&k(e),a&&k(i),r=!1,l()}}}function is(t){let e,i,n=t[5]+1+"",s,r,l,o,a,c=t[5]+2<t[3]&&ns();return{c(){e=b("li"),i=b("a"),s=W(n),r=N(),c&&c.c(),l=he(),p(i,"class","pagination-link"),p(i,"href",null)},m(u,f){S(u,e,f),_(e,i),_(i,s),S(u,r,f),c&&c.m(u,f),S(u,l,f),o||(a=re(i,"click",Ct(t[10])),o=!0)},p(u,f){f&32&&n!==(n=u[5]+1+"")&&ce(s,n),u[5]+2<u[3]?c||(c=ns(),c.c(),c.m(l.parentNode,l)):c&&(c.d(1),c=null)},d(u){u&&k(e),u&&k(r),c&&c.d(u),u&&k(l),o=!1,a()}}}function ns(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(i,n){S(i,e,n)},d(i){i&&k(e)}}}function pa(t){let e,i,n=t[5]*t[2]-t[2]+1+"",s,r,l=Math.min(t[5]*t[2],t[1])+"",o,a,c,u,f=t[4]&&Xn(t);return{c(){f&&f.c(),e=N(),i=b("div"),s=W(n),r=W(" - "),o=W(l),a=W(" / "),c=W(t[1]),p(i,"class",u="is-size-7 is-center mb-4 "+(t[4]?"":"mt-4"))},m(d,h){f&&f.m(d,h),S(d,e,h),S(d,i,h),_(i,s),_(i,r),_(i,o),_(i,a),_(i,c)},p(d,[h]){d[4]?f?f.p(d,h):(f=Xn(d),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),h&36&&n!==(n=d[5]*d[2]-d[2]+1+"")&&ce(s,n),h&38&&l!==(l=Math.min(d[5]*d[2],d[1])+"")&&ce(o,l),h&2&&ce(c,d[1]),h&16&&u!==(u="is-size-7 is-center mb-4 "+(d[4]?"":"mt-4"))&&p(i,"class",u)},i:j,o:j,d(d){f&&f.d(d),d&&k(e),d&&k(i)}}}function ma(t,e,i){let n,s,r,{store:l}=e;const{currentPage:o}=l;oe(t,o,g=>i(5,r=g));let{nbOfItems:a}=e,{pageLength:c=oo}=e;const u=()=>l.handlePageUpdate(1),f=()=>l.handlePageUpdate(r-1),d=()=>l.handlePageUpdate(r),h=()=>l.handlePageUpdate(r+1),m=()=>l.handlePageUpdate(n);return t.$$set=g=>{"store"in g&&i(0,l=g.store),"nbOfItems"in g&&i(1,a=g.nbOfItems),"pageLength"in g&&i(2,c=g.pageLength)},t.$$.update=()=>{t.$$.dirty&6&&i(3,n=c>0?Math.ceil(a/c):1),t.$$.dirty&14&&i(4,s=n>1||a>c)},[l,a,c,n,s,r,o,u,f,d,h,m]}class $t extends de{constructor(e){super(),fe(this,e,ma,pa,ue,{store:0,nbOfItems:1,pageLength:2})}}const Dr=(t,e,i,n)=>({id:t,img:t,title:`Canvas ${n} - ${i} - ${V==="en"?"Witness":"Témoin"} #${Er(e)}`,xywh:i.split(",").map(Number),canvas:n,ref:t.replace(".jpg",""),type:pi}),ga=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,Nr=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">
        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>
    </svg>`,$r=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">
        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,jr=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">
        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`,Fr=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`,Ur=`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>
    </svg>`,_a=V==="en"?"no categorization":"aucune catégorisation",Vr=V==="en"?"overall visual matches":"correspondances visuelles globales",Hr=V==="en"?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",Br=V==="en"?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",zr=V==="en"?"regions without match":"régions sans correspondance",qr=V==="en"?"user specific category":"correspondances spécifiques à l'utilisateur",si={0:{title:_a,svg:ga},1:{title:Vr,svg:Nr},2:{title:Hr,svg:$r},3:{title:Br,svg:jr},4:{title:zr,svg:Fr},5:{title:qr,svg:Ur}};function va(t){let e,i=si[t[2]].svg+"",n,s,r,l;return{c(){e=b("span"),p(e,"class",n="tag py-4 "+t[4]+" "+(t[0]?"is-hoverable":"")),p(e,"title",s=si[t[2]].title),qe(e,"is-selected",t[1])},m(o,a){S(o,e,a),e.innerHTML=i,r||(l=[re(e,"click",t[5]),re(e,"keyup",null)],r=!0)},p(o,[a]){a&4&&i!==(i=si[o[2]].svg+"")&&(e.innerHTML=i),a&17&&n!==(n="tag py-4 "+o[4]+" "+(o[0]?"is-hoverable":""))&&p(e,"class",n),a&4&&s!==(s=si[o[2]].title)&&p(e,"title",s),a&19&&qe(e,"is-selected",o[1])},i:j,o:j,d(o){o&&k(e),r=!1,Ie(l)}}}function ba(t,e,i){let{selectable:n=!0}=e,{isSelected:s=!1}=e,{category:r}=e,{toggle:l=()=>{}}=e,{padding:o="px-2"}=e;const a=()=>l(r);return t.$$set=c=>{"selectable"in c&&i(0,n=c.selectable),"isSelected"in c&&i(1,s=c.isSelected),"category"in c&&i(2,r=c.category),"toggle"in c&&i(3,l=c.toggle),"padding"in c&&i(4,o=c.padding)},[n,s,r,l,o,a]}class qt extends de{constructor(e){super(),fe(this,e,ba,va,ue,{selectable:0,isSelected:1,category:2,toggle:3,padding:4})}}function ya(t){let e,i,n,s,r,l,o,a,c,u,f;return i=new qt({props:{category:1,isSelected:t[0]===1,toggle:t[4],padding:"pl-3 pr-2"}}),s=new qt({props:{category:2,isSelected:t[0]===2,toggle:t[4]}}),l=new qt({props:{category:3,isSelected:t[0]===3,toggle:t[4]}}),a=new qt({props:{category:4,isSelected:t[0]===4,toggle:t[4]}}),u=new qt({props:{category:5,isSelected:t[0]===5,toggle:t[4],padding:"pl-2 pr-3"}}),{c(){e=b("div"),Z(i.$$.fragment),n=N(),Z(s.$$.fragment),r=N(),Z(l.$$.fragment),o=N(),Z(a.$$.fragment),c=N(),Z(u.$$.fragment),p(e,"class","tags has-addons is-dark is-center")},m(d,h){S(d,e,h),X(i,e,null),_(e,n),X(s,e,null),_(e,r),X(l,e,null),_(e,o),X(a,e,null),_(e,c),X(u,e,null),f=!0},p(d,h){const m={};h&1&&(m.isSelected=d[0]===1),i.$set(m);const g={};h&1&&(g.isSelected=d[0]===2),s.$set(g);const v={};h&1&&(v.isSelected=d[0]===3),l.$set(v);const w={};h&1&&(w.isSelected=d[0]===4),a.$set(w);const O={};h&1&&(O.isSelected=d[0]===5),u.$set(O)},i(d){f||(R(i.$$.fragment,d),R(s.$$.fragment,d),R(l.$$.fragment,d),R(a.$$.fragment,d),R(u.$$.fragment,d),f=!0)},o(d){D(i.$$.fragment,d),D(s.$$.fragment,d),D(l.$$.fragment,d),D(a.$$.fragment,d),D(u.$$.fragment,d),f=!1},d(d){d&&k(e),Q(i),Q(s),Q(l),Q(a),Q(u)}}}function wa(t){let e,i,n,s;i=new an({props:{item:t[3],size:256,selectable:!1,isSquare:!1}});let r=!t[2]&&ya(t);return{c(){e=b("div"),Z(i.$$.fragment),n=N(),r&&r.c()},m(l,o){S(l,e,o),X(i,e,null),_(e,n),r&&r.m(e,null),s=!0},p(l,[o]){l[2]||r.p(l,o)},i(l){s||(R(i.$$.fragment,l),R(r),s=!0)},o(l){D(i.$$.fragment,l),D(r),s=!1},d(l){l&&k(e),Q(i),r&&r.d()}}}function ka(t,e,i){let n,s,r;const{comparedRegions:l}=ze;oe(t,l,H=>i(15,r=H));const o=new URL(window.location.href),a=o.origin;o.pathname;let{qImg:c}=e,{sImg:u}=e,{qRegions:f}=e,{sRegions:d}=e,{score:h=0}=e,{category:m=null}=e,{users:g=[]}=e,{isManual:v}=e,{similarityType:w}=e;const O=Ae("isInModal")||!1,[L,C,T,$]=u.split(".")[0].split("_"),E=(()=>{let H=Dr(u,L,$,T);const z=r[`${L}_${C}_anno${d}`]||{title:H.title};return H.title=`${Cr(z.title.replace(/^[^|]+/,""))}<br/>Page ${co(T)}<br/><b>Score: ${h}</b>`,H})();lt("similarityPair",{qImg:c,sImg:u,qRegions:f,sRegions:d,score:h,category:m,users:g,isManual:v,similarityType:w});function P(H){H=H.slice();let z=H.indexOf(Number(ai));return s&&z===-1?H.push(Number(ai)):!s&&z!==-1&&H.splice(z,1),H}const G=()=>({img_1:c,img_2:u,regions_id_1:f,regions_id_2:d,score:h,category:n,category_x:P(g),similarity_type:w});function ee(H){H===5?s=!s:i(0,n=n===H?null:H)}async function M(H){ee(H);try{(await fetch(`${a}/${je}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify(G())})).ok||(console.error("Error: Network response was not ok"),ee(H))}catch(z){console.error("Error:",z),ee(H)}}return t.$$set=H=>{"qImg"in H&&i(5,c=H.qImg),"sImg"in H&&i(6,u=H.sImg),"qRegions"in H&&i(7,f=H.qRegions),"sRegions"in H&&i(8,d=H.sRegions),"score"in H&&i(9,h=H.score),"category"in H&&i(10,m=H.category),"users"in H&&i(11,g=H.users),"isManual"in H&&i(12,v=H.isManual),"similarityType"in H&&i(13,w=H.similarityType)},t.$$.update=()=>{t.$$.dirty&1024&&i(0,n=m),t.$$.dirty&2048&&(s=g.includes(Number(ai))||!1)},[n,l,O,E,M,c,u,f,d,h,m,g,v,w]}class Sa extends de{constructor(e){super(),fe(this,e,ka,wa,ue,{qImg:5,sImg:6,qRegions:7,sRegions:8,score:9,category:10,users:11,isManual:12,similarityType:13})}}function ss(t,e,i){const n=t.slice();return n[22]=e[i].uuid,n[23]=e[i].data[0],n[24]=e[i].data[1],n[25]=e[i].data[2],n[26]=e[i].data[3],n[27]=e[i].data[4],n[28]=e[i].data[5],n[29]=e[i].data[6],n[30]=e[i].data[7],n[31]=e[i].data[8],n}function Ea(t){let e,i=V==="en"?`Error when retrieving similar regions: ${t[2]}`:`Erreur de recupération des régions similaires: ${t[2]}`,n;return{c(){e=b("div"),n=W(i),p(e,"class","faded is-center")},m(s,r){S(s,e,r),_(e,n)},p(s,r){r[0]&4&&i!==(i=V==="en"?`Error when retrieving similar regions: ${s[2]}`:`Erreur de recupération des régions similaires: ${s[2]}`)&&ce(n,i)},i:j,o:j,d(s){s&&k(e)}}}function Ca(t){let e,i,n=t[4].length+"",s,r,l=t[11](t[10],t[4].length)+"",o,a,c,u=[],f=new Map,d,h=t[4];const m=v=>v[22];for(let v=0;v<h.length;v+=1){let w=ss(t,h,v),O=m(w);f.set(O,u[v]=ls(O,w))}let g=null;return h.length||(g=rs(t)),{c(){e=b("div"),i=b("span"),s=W(n),r=N(),o=W(l),a=N(),c=b("div");for(let v=0;v<u.length;v+=1)u[v].c();g&&g.c(),p(i,"class","m-2"),p(c,"class","m-2 is-gap-2"),qe(c,"grid",t[4].length>0)},m(v,w){S(v,e,w),_(e,i),_(i,s),_(i,r),_(i,o),_(e,a),_(e,c);for(let O=0;O<u.length;O+=1)u[O]&&u[O].m(c,null);g&&g.m(c,null),d=!0},p(v,w){(!d||w[0]&16)&&n!==(n=v[4].length+"")&&ce(s,n),(!d||w[0]&16)&&l!==(l=v[11](v[10],v[4].length)+"")&&ce(o,l),w[0]&49&&(h=v[4],_e(),u=Ut(u,w,m,1,v,h,f,c,Qt,ls,null,ss),ve(),!h.length&&g?g.p(v,w):h.length?g&&(g.d(1),g=null):(g=rs(v),g.c(),g.m(c,null))),(!d||w[0]&16)&&qe(c,"grid",v[4].length>0)},i(v){if(!d){for(let w=0;w<h.length;w+=1)R(u[w]);d=!0}},o(v){for(let w=0;w<u.length;w+=1)D(u[w]);d=!1},d(v){v&&k(e);for(let w=0;w<u.length;w+=1)u[w].d();g&&g.d()}}}function Ia(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"&&!t[10]?"Retrieving similar regions...":V==="fr"&&!t[10]?"Récupération des régions similaires...":V==="en"&&t[10]?"Retrieving propagated regions...":"Récupération de similarités propagées..."}`,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,i:j,o:j,d(i){i&&k(e)}}}function rs(t){let e;function i(r,l){return r[5]?Aa:Oa}let n=i(t),s=n(t);return{c(){s.c(),e=he()},m(r,l){s.m(r,l),S(r,e,l)},p(r,l){n===(n=i(r))&&s?s.p(r,l):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&k(e)}}}function Oa(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"No similar regions":"Pas de régions similaires"}
                    `,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,d(i){i&&k(e)}}}function Aa(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"No document selected. Select one to display results.":"Aucun document sélectionné. Sélectionnez-en un pour afficher les résultats."}
                    `,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,d(i){i&&k(e)}}}function ls(t,e){let i,n,s;return n=new Sa({props:{qImg:e[0],sImg:e[25],score:e[23],qRegions:e[26],sRegions:e[27],category:e[28],users:e[29],isManual:e[30],similarityType:e[31]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),X(n,r,l),s=!0},p(r,l){e=r;const o={};l[0]&1&&(o.qImg=e[0]),l[0]&16&&(o.sImg=e[25]),l[0]&16&&(o.score=e[23]),l[0]&16&&(o.qRegions=e[26]),l[0]&16&&(o.sRegions=e[27]),l[0]&16&&(o.category=e[28]),l[0]&16&&(o.users=e[29]),l[0]&16&&(o.isManual=e[30]),l[0]&16&&(o.similarityType=e[31]),n.$set(o)},i(r){s||(R(n.$$.fragment,r),s=!0)},o(r){D(n.$$.fragment,r),s=!1},d(r){r&&k(i),Q(n,r)}}}function Ta(t){let e,i,n,s;const r=[Ia,Ca,Ea],l=[];function o(a,c){return a[1]&&a[3]==="loading"?0:a[3]==="loaded"?1:a[3]==="error"?2:-1}return~(e=o(t))&&(i=l[e]=r[e](t)),{c(){i&&i.c(),n=he()},m(a,c){~e&&l[e].m(a,c),S(a,n,c),s=!0},p(a,c){let u=e;e=o(a),e===u?~e&&l[e].p(a,c):(i&&(_e(),D(l[u],1,1,()=>{l[u]=null}),ve()),~e?(i=l[e],i?i.p(a,c):(i=l[e]=r[e](a),i.c()),R(i,1),i.m(n.parentNode,n)):i=null)},i(a){s||(R(i),s=!0)},o(a){D(i),s=!1},d(a){~e&&l[e].d(a),a&&k(n)}}}function Pa(t,e,i){let n,s,r,l,o,a,c,u,{qImg:f}=e,{sImgsPromise:d}=e;const{selectedRegions:h,excludedCategories:m,similarityScoreCutoff:g,propagateFilterByRegions:v}=ze;oe(t,h,P=>i(16,u=P)),oe(t,m,P=>i(15,c=P)),oe(t,g,P=>i(14,a=P)),oe(t,v,P=>i(13,o=P));const w=Ae("similarityPropagatedContext")||!1,O=window.location.pathname.match(/\d+/g).join("-");let L;const C=(P,G)=>P===null||G===void 0||Number(P)>=G,T=(P,G,ee)=>!ee.includes(P),$=(P,G,ee,M,H,z)=>w?!0:C(P,H)&&T(G,ee,M),F=(P,G,ee,M)=>P.filter(({uuid:H,data:[z,q,U,se,Y,te,ne,be,ke]})=>$(z,te,ne,G,ee)),E=(P,G)=>{const ee=G>1;return P?V==="fr"?ee?"similarités propagées":"similarité propagée":ee?"propagated matches":"propagated match":V==="fr"?ee?"images similaires":"image similaire":ee?"similar images":"similar image"};return t.$$set=P=>{"qImg"in P&&i(0,f=P.qImg),"sImgsPromise"in P&&i(1,d=P.sImgsPromise)},t.$$.update=()=>{t.$$.dirty[0]&65536&&i(5,n=Object.values(u).length===0||u[O]===void 0||!Object.keys(u[O]).length),t.$$.dirty[0]&2&&(P=>{i(3,s="loading"),i(4,l=[]),i(12,r=[])})(),t.$$.dirty[0]&2&&d.then(P=>{i(12,r=P.map(G=>({uuid:window.crypto.randomUUID(),data:G}))),i(3,s="loaded")}).catch(P=>{i(2,L=P),i(3,s="error")}),t.$$.dirty[0]&61440&&i(4,l=F(r,c,a))},i(3,s="loading"),i(12,r=[]),[f,d,L,s,l,n,h,m,g,v,w,E,r,o,a,c,u]}class Kr extends de{constructor(e){super(),fe(this,e,Pa,Ta,ue,{qImg:0,sImgsPromise:1},null,[-1,-1])}}function La(t){let e,i;return e=new Kr({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,[s]){const r={};s&1&&(r.qImg=n[0]),s&2&&(r.sImgsPromise=n[1]),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Ma(t,e,i){let n,s,{qImg:r}=e,l;const o=Ae("isInModal")||!1,{selectedRegions:a,comparedRegions:c}=ze;oe(t,a,m=>i(4,n=m)),oe(t,c,m=>i(5,s=m));const u=`${window.location.origin}${window.location.pathname}`,f=window.location.pathname.match(/\d+/g).join("-"),d=(m,g)=>g?Object.keys(s).map(v=>s[v].id):Object.values(m[f]||{}).map(v=>v.id);async function h(m,g,v){const w=d(g,v);return w.length===0?[]:await(await fetch(`${u}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:w,qImg:m,topk:12}),headers:{"Content-Type":"application/json","X-CSRFToken":Ke}})).json()}return o?l=h(r,n,o):a.subscribe(m=>{i(1,l=h(r,m,o))}),t.$$set=m=>{"qImg"in m&&i(0,r=m.qImg)},[r,l,a,c]}class Ra extends de{constructor(e){super(),fe(this,e,Ma,La,ue,{qImg:0})}}function Da(t){let e,i,n,s;return n=new Kr({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){e=b("div"),i=b("div"),Z(n.$$.fragment),p(i,"class","matches-suggestion svelte-1cb4wg0"),p(e,"class","block matches-suggestion-wrapper svelte-1cb4wg0")},m(r,l){S(r,e,l),_(e,i),X(n,i,null),s=!0},p(r,[l]){const o={};l&1&&(o.qImg=r[0]),l&2&&(o.sImgsPromise=r[1]),n.$set(o)},i(r){s||(R(n.$$.fragment,r),s=!0)},o(r){D(n.$$.fragment,r),s=!1},d(r){r&&k(e),Q(n)}}}function Na(t,e,i){let n,s,{qImg:r}=e;const{propagateParams:l,selectedRegions:o}=ze;oe(t,l,v=>i(4,n=v)),oe(t,o,v=>i(5,s=v));const a=`${window.location.origin}${window.location.pathname}`,c=window.location.pathname.match(/\d+/g).join("-"),u=Ae("isInModal")||!1;let f;const d=mi();d.setCompareFn((v,w)=>[v,w].every(O=>O&&O.hasOwnProperty("propagateRecursionDepth")&&O.hasOwnProperty("propagateFilterByRegions"))?v.propagateRecursionDepth===w.propagateRecursionDepth&&v.propagateFilterByRegions===w.propagateFilterByRegions:!1);const h=mi();h.setCompareFn(ln),lt("similarityPropagatedContext",!0);const m=v=>Object.keys(v).includes(c)?Object.values(v[c]).map(w=>w.id):[],g=async(v,w,O)=>fetch(`${a}propagated-matches/${r}`,{method:"POST",body:JSON.stringify({regionsIds:O?[]:w,filterByRegions:O?!1:v.propagateFilterByRegions,recursionDepth:v.propagateRecursionDepth}),headers:{"Content-Type":"application/json","X-CSRFToken":Ke}}).then(L=>L.json()).catch(L=>(console.error("PropagatedMatches.getPropagatedMatches:",L),[]));return l.subscribe(v=>{d.set(v),d.same()||i(1,f=g(d.get(),m(s),u))}),o.subscribe(v=>{h.set(m(v)),n.propagateFilterByRegions===!0&&!h.same()&&i(1,f=g(n,h.get(),u))}),t.$$set=v=>{"qImg"in v&&i(0,r=v.qImg)},[r,f,l,o]}class $a extends de{constructor(e){super(),fe(this,e,Na,Da,ue,{qImg:0})}}const ja=t=>({}),os=t=>({}),Fa=t=>({}),as=t=>({}),Ua=t=>({}),cs=t=>({});function Va(t){let e;const i=t[4]["row-body"],n=Ge(i,t,t[3],os);return{c(){n&&n.c()},m(s,r){n&&n.m(s,r),e=!0},p(s,r){n&&n.p&&(!e||r&8)&&Je(n,i,s,s[3],e?Ye(i,s[3],r,ja):Xe(s[3]),os)},i(s){e||(R(n,s),e=!0)},o(s){D(n,s),e=!1},d(s){n&&n.d(s)}}}function Ha(t){let e,i,n,s;const r=t[4]["row-body"],l=Ge(r,t,t[3],as);return{c(){e=b("div"),i=b("div"),l&&l.c(),p(i,"class","grid is-gap-2"),p(e,"class",n="fixed-grid has-"+t[2]+"-cols")},m(o,a){S(o,e,a),_(e,i),l&&l.m(i,null),s=!0},p(o,a){l&&l.p&&(!s||a&8)&&Je(l,r,o,o[3],s?Ye(r,o[3],a,Fa):Xe(o[3]),as),(!s||a&4&&n!==(n="fixed-grid has-"+o[2]+"-cols"))&&p(e,"class",n)},i(o){s||(R(l,o),s=!0)},o(o){D(l,o),s=!1},d(o){o&&k(e),l&&l.d(o)}}}function Ba(t){let e,i,n,s,r,l,o,a,c,u;Ze(t[5]);const f=t[4]["row-header"],d=Ge(f,t,t[3],cs),h=[Ha,Va],m=[];function g(v,w){return v[0]?0:1}return l=g(t),o=m[l]=h[l](t),{c(){e=b("tr"),i=b("th"),n=b("div"),d&&d.c(),s=N(),r=b("td"),o.c(),p(n,"class","content-wrapper py-5"),p(i,"class","is-3 center-flex is-narrow"),$e(i,"width","15vw"),p(r,"class","p-5 is-fullwidth")},m(v,w){S(v,e,w),_(e,i),_(i,n),d&&d.m(n,null),_(e,s),_(e,r),m[l].m(r,null),a=!0,c||(u=re(window,"resize",t[5]),c=!0)},p(v,[w]){d&&d.p&&(!a||w&8)&&Je(d,f,v,v[3],a?Ye(f,v[3],w,Ua):Xe(v[3]),cs);let O=l;l=g(v),l===O?m[l].p(v,w):(_e(),D(m[O],1,1,()=>{m[O]=null}),ve(),o=m[l],o?o.p(v,w):(o=m[l]=h[l](v),o.c()),R(o,1),o.m(r,null))},i(v){a||(R(d,v),R(o),a=!0)},o(v){D(d,v),D(o),a=!1},d(v){v&&k(e),d&&d.d(v),m[l].d(),c=!1,u()}}}function za(t,e,i){let n,{$$slots:s={},$$scope:r}=e,{useGrid:l=!0}=e,o=0;function a(){i(1,o=window.innerWidth)}return t.$$set=c=>{"useGrid"in c&&i(0,l=c.useGrid),"$$scope"in c&&i(3,r=c.$$scope)},t.$$.update=()=>{t.$$.dirty&2&&i(2,n=Ar(o))},[l,o,n,r,s,a]}class xr extends de{constructor(e){super(),fe(this,e,za,Ba,ue,{useGrid:0})}}function qa(t){let e,i,n,s=parseInt(t[5])+"",r,l,o,a,c,u,f,d,h,m,g,v,w,O,L,C,T,$,F;return{c(){e=b("a"),i=b("i"),n=W(`
            Page `),r=W(s),l=N(),o=b("img"),c=N(),u=b("div"),f=b("div"),d=b("input"),h=N(),m=b("button"),m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',g=N(),v=b("button"),w=Qe("svg"),O=Qe("path"),p(i,"class","fa-solid fa-pen-to-square"),p(e,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),p(e,"href",Nt(t[6],parseInt(t[5]))),p(e,"target","_blank"),We(o.src,a=gt(t[0],t[0].split("_").pop(),"250,"))||p(o,"src",a),p(o,"alt","Query region"),p(o,"class","mb-3 card query-image svelte-f4ylwc"),p(d,"class","input is-small tag"),p(d,"type","text"),p(d,"placeholder",V==="en"?"Add new match":"Ajouter une correspondance"),p(m,"class","button is-small tag is-link is-center"),p(f,"class","tags has-addons"),$e(f,"flex-wrap","nowrap"),p(O,"fill","white"),p(O,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),p(w,"xmlns","http://www.w3.org/2000/svg"),p(w,"viewBox","0 0 384 512"),p(v,"id","no-match"),p(v,"class",L="button is-small tag is-danger is-center m-0 "+(t[3]===1?"visible":"")+" svelte-f4ylwc"),p(v,"title",V==="en"?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),p(u,"class","new-similarity control pt-2 is-center svelte-f4ylwc")},m(E,P){S(E,e,P),_(e,i),_(e,n),_(e,r),S(E,l,P),S(E,o,P),S(E,c,P),S(E,u,P),_(u,f),_(f,d),Mt(d,t[1]),_(f,h),_(f,m),_(u,g),_(u,v),_(v,w),_(w,O),T=!0,$||(F=[re(d,"input",t[12]),re(m,"click",t[8]),re(v,"click",t[9])],$=!0)},p(E,P){(!T||P&1&&!We(o.src,a=gt(E[0],E[0].split("_").pop(),"250,")))&&p(o,"src",a),P&2&&d.value!==E[1]&&Mt(d,E[1]),(!T||P&8&&L!==(L="button is-small tag is-danger is-center m-0 "+(E[3]===1?"visible":"")+" svelte-f4ylwc"))&&p(v,"class",L)},i(E){T||(Ze(()=>{T&&(C||(C=nt(v,mt,{duration:500},!0)),C.run(1))}),T=!0)},o(E){C||(C=nt(v,mt,{duration:500},!1)),C.run(0),T=!1},d(E){E&&k(e),E&&k(l),E&&k(o),E&&k(c),E&&k(u),E&&C&&C.end(),$=!1,Ie(F)}}}function Ka(t){let e,i,n,s,r,l,o,a;return i=new Ra({props:{qImg:t[0]}}),l=new $a({props:{qImg:t[0]}}),{c(){e=b("div"),Z(i.$$.fragment),s=N(),r=b("div"),Z(l.$$.fragment),p(e,"class",n=ni(t[7]?"":t[2])+" svelte-f4ylwc"),p(r,"class",o=ni(t[7]?"":t[2])+" svelte-f4ylwc")},m(c,u){S(c,e,u),X(i,e,null),S(c,s,u),S(c,r,u),X(l,r,null),a=!0},p(c,u){const f={};u&1&&(f.qImg=c[0]),i.$set(f),(!a||u&4&&n!==(n=ni(c[7]?"":c[2])+" svelte-f4ylwc"))&&p(e,"class",n);const d={};u&1&&(d.qImg=c[0]),l.$set(d),(!a||u&4&&o!==(o=ni(c[7]?"":c[2])+" svelte-f4ylwc"))&&p(r,"class",o)},i(c){a||(R(i.$$.fragment,c),R(l.$$.fragment,c),a=!0)},o(c){D(i.$$.fragment,c),D(l.$$.fragment,c),a=!1},d(c){c&&k(e),Q(i),c&&k(s),c&&k(r),Q(l)}}}function xa(t){let e,i;return e=new xr({props:{useGrid:!1,$$slots:{"row-body":[Ka],"row-header":[qa]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,[s]){const r={};s&1048591&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Wa(t){return t=t.replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(t)}function Ga(t,e,i){let n,s,r,l;const{selectedRegions:o}=ze;oe(t,o,$=>i(11,l=$));let{qImg:a}=e,c="";const[u,f,d,h]=a.split(".")[0].split("_"),m=`${window.location.origin}${window.location.pathname}`,g=window.location.pathname.match(/\d+/g).join("-"),v=V==="en"?"Error":"Erreur",w=Ae("manifest"),O=Ae("isInModal")||!1;lt("qImgMetadata",Dr(a,u,h,d));async function L(){if(!c||!Wa(c)){await Me(V==="en"?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error");return}try{const $=await fetch(`${m}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify({q_img:a.replace(".jpg",""),s_img:c,similarity_type:2})});$.ok||(console.error("Error: Network response was not ok"),await Me(V==="en"?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",v));const F=await $.json();if(F.hasOwnProperty("error")||!F.hasOwnProperty("s_regions")){await Me(V==="en"?`Request was unsuccessful, match was not added:<br>${F.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${F.error}`,v);return}const E=F.s_regions;ze.addComparedRegions(E),ze.select(E)}catch($){console.error("Error:",$),await Me(V==="en"?`An error has occurred, match was not added:<br>${$}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${$}`,v)}}async function C(){const $=Object.values(l[g])[0];if(await Me(V==="en"?`Do you confirm this region does not have any match in ${$.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${$.title} ?`,V==="en"?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${m}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ke},body:JSON.stringify({q_img:a,s_regions:$.id})})).ok||(console.error("Error: Network response was not ok"),await Me(V==="en"?"Problem with network":"Problème de réseau",v)),ze.select($)}catch(E){console.error("Error:",E),await Me(V==="en"?`An error has occurred, request was unsuccessful:<br>${E}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${E}`,v)}}function T(){c=this.value,i(1,c)}return t.$$set=$=>{"qImg"in $&&i(0,a=$.qImg)},t.$$.update=()=>{t.$$.dirty&2048&&i(3,n=l.hasOwnProperty(g)?Object.values(l[g]).length:0),t.$$.dirty&1024&&i(2,r=`fixed-grid has-${s-1}-cols`)},i(10,s=Ar(window.innerWidth)),[a,c,r,n,o,d,w,O,L,C,s,l,T]}class Ya extends de{constructor(e){super(),fe(this,e,Ga,xa,ue,{qImg:0})}}function us(t,e,i){const n=t.slice();return n[8]=e[i],n}function Ja(t){let e,i,n=t[11]+"",s;return{c(){e=b("tr"),i=W("Error when retrieving similar regions: "),s=W(n)},m(r,l){S(r,e,l),_(e,i),_(e,s)},p(r,l){l&2&&n!==(n=r[11]+"")&&ce(s,n)},i:j,o:j,d(r){r&&k(e)}}}function Xa(t){let e=[],i=new Map,n,s,r=t[2];const l=a=>a[8].id;for(let a=0;a<r.length;a+=1){let c=us(t,r,a),u=l(c);i.set(u,e[a]=ds(u,c))}let o=null;return r.length||(o=fs()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);S(a,n,c),o&&o.m(a,c),s=!0},p(a,c){c&4&&(r=a[2],_e(),e=Ut(e,c,l,1,a,r,i,n.parentNode,Qt,ds,n,us),ve(),!r.length&&o?o.p(a,c):r.length?o&&(o.d(1),o=null):(o=fs(),o.c(),o.m(n.parentNode,n)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)R(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)D(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),o&&o.d(a)}}}function fs(t){let e,i;return{c(){e=b("tr"),e.textContent=`${V==="en"?"No similarity":"Pas de similarités"}`,i=N(),p(e,"class","faded is-center")},m(n,s){S(n,e,s),S(n,i,s)},p:j,d(n){n&&k(e),n&&k(i)}}}function ds(t,e){let i,n,s;return n=new Ya({props:{qImg:e[8]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),X(n,r,l),s=!0},p(r,l){e=r;const o={};l&4&&(o.qImg=e[8]),n.$set(o)},i(r){s||(R(n.$$.fragment,r),s=!0)},o(r){D(n.$$.fragment,r),s=!1},d(r){r&&k(i),Q(n,r)}}}function Qa(t){let e;return{c(){e=b("tr"),e.textContent=`${V==="en"?"Retrieving similarity page...":"Récupération la page de similarité..."}`,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,i:j,o:j,d(i){i&&k(e)}}}function Za(t){let e,i,n,s={ctx:t,current:null,token:null,hasCatch:!0,pending:Qa,then:Xa,catch:Ja,value:7,error:11,blocks:[,,,]};return ct(i=t[1],s),{c(){e=he(),s.block.c()},m(r,l){S(r,e,l),s.block.m(r,s.anchor=l),s.mount=()=>e.parentNode,s.anchor=e,n=!0},p(r,l){t=r,s.ctx=t,l&2&&i!==(i=t[1])&&ct(i,s)||Ft(s,t,l)},i(r){n||(R(s.block),n=!0)},o(r){for(let l=0;l<3;l+=1){const o=s.blocks[l];D(o)}n=!1},d(r){r&&k(e),s.block.d(r),s.token=null,s=null}}}function ec(t){let e,i,n,s,r,l,o;return i=new $t({props:{store:ze,nbOfItems:t[0].length,pageLength:t[6]}}),s=new yi({props:{$$slots:{default:[Za]},$$scope:{ctx:t}}}),l=new $t({props:{store:ze,nbOfItems:t[0].length,pageLength:t[6]}}),{c(){e=b("div"),Z(i.$$.fragment),n=N(),Z(s.$$.fragment),r=N(),Z(l.$$.fragment)},m(a,c){S(a,e,c),X(i,e,null),_(e,n),X(s,e,null),_(e,r),X(l,e,null),o=!0},p(a,[c]){const u={};c&1&&(u.nbOfItems=a[0].length),i.$set(u);const f={};c&4102&&(f.$$scope={dirty:c,ctx:a}),s.$set(f);const d={};c&1&&(d.nbOfItems=a[0].length),l.$set(d)},i(a){o||(R(i.$$.fragment,a),R(s.$$.fragment,a),R(l.$$.fragment,a),o=!0)},o(a){D(i.$$.fragment,a),D(s.$$.fragment,a),D(l.$$.fragment,a),o=!1},d(a){a&&k(e),Q(i),Q(s),Q(l)}}}function tc(t,e,i){let n,s,r;const{qImgs:l,pageQImgs:o,setPageQImgs:a,pageLength:c}=ze;return oe(t,l,u=>i(0,n=u)),oe(t,o,u=>i(2,r=u)),oe(t,a,u=>i(1,s=u)),[n,s,r,l,o,a,c]}class ic extends de{constructor(e){super(),fe(this,e,tc,ec,ue,{})}}var dt;(function(t){t.Range="range",t.Steps="steps",t.Positions="positions",t.Count="count",t.Values="values"})(dt||(dt={}));var Fe;(function(t){t[t.None=-1]="None",t[t.NoValue=0]="NoValue",t[t.LargeValue=1]="LargeValue",t[t.SmallValue=2]="SmallValue"})(Fe||(Fe={}));function nc(t){return gi(t)&&typeof t.from=="function"}function gi(t){return typeof t=="object"&&typeof t.to=="function"}function hs(t){t.parentElement.removeChild(t)}function zi(t){return t!=null}function ps(t){t.preventDefault()}function sc(t){return t.filter(function(e){return this[e]?!1:this[e]=!0},{})}function rc(t,e){return Math.round(t/e)*e}function lc(t,e){var i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.documentElement,r=Wr(n);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(r.x=0),e?i.top+r.y-s.clientTop:i.left+r.x-s.clientLeft}function xe(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function ms(t,e,i){i>0&&(Ne(t,e),setTimeout(function(){ci(t,e)},i))}function gs(t){return Math.max(Math.min(t,100),0)}function wi(t){return Array.isArray(t)?t:[t]}function oc(t){t=String(t);var e=t.split(".");return e.length>1?e[1].length:0}function Ne(t,e){t.classList&&!/\s/.test(e)?t.classList.add(e):t.className+=" "+e}function ci(t,e){t.classList&&!/\s/.test(e)?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function ac(t,e){return t.classList?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)}function Wr(t){var e=window.pageXOffset!==void 0,i=(t.compatMode||"")==="CSS1Compat",n=e?window.pageXOffset:i?t.documentElement.scrollLeft:t.body.scrollLeft,s=e?window.pageYOffset:i?t.documentElement.scrollTop:t.body.scrollTop;return{x:n,y:s}}function cc(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function uc(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch{}return t}function fc(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function cn(t,e){return 100/(e-t)}function qi(t,e,i){return e*100/(t[i+1]-t[i])}function dc(t,e){return qi(t,t[0]<0?e+Math.abs(t[0]):e-t[0],0)}function hc(t,e){return e*(t[1]-t[0])/100+t[0]}function Jt(t,e){for(var i=1;t>=e[i];)i+=1;return i}function pc(t,e,i){if(i>=t.slice(-1)[0])return 100;var n=Jt(i,t),s=t[n-1],r=t[n],l=e[n-1],o=e[n];return l+dc([s,r],i)/cn(l,o)}function mc(t,e,i){if(i>=100)return t.slice(-1)[0];var n=Jt(i,e),s=t[n-1],r=t[n],l=e[n-1],o=e[n];return hc([s,r],(i-l)*cn(l,o))}function gc(t,e,i,n){if(n===100)return n;var s=Jt(n,t),r=t[s-1],l=t[s];return i?n-r>(l-r)/2?l:r:e[s-1]?t[s-1]+rc(n-t[s-1],e[s-1]):n}var Gr=function(){function t(e,i,n){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.snap=i;var s,r=[];for(Object.keys(e).forEach(function(l){r.push([wi(e[l]),l])}),r.sort(function(l,o){return l[0][0]-o[0][0]}),s=0;s<r.length;s++)this.handleEntryPoint(r[s][1],r[s][0]);for(this.xNumSteps=this.xSteps.slice(0),s=0;s<this.xNumSteps.length;s++)this.handleStepPoint(s,this.xNumSteps[s])}return t.prototype.getDistance=function(e){for(var i=[],n=0;n<this.xNumSteps.length-1;n++)i[n]=qi(this.xVal,e,n);return i},t.prototype.getAbsoluteDistance=function(e,i,n){var s=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[s+1];)s++;else e===this.xPct[this.xPct.length-1]&&(s=this.xPct.length-2);!n&&e===this.xPct[s+1]&&s++,i===null&&(i=[]);var r,l=1,o=i[s],a=0,c=0,u=0,f=0;for(n?r=(e-this.xPct[s])/(this.xPct[s+1]-this.xPct[s]):r=(this.xPct[s+1]-e)/(this.xPct[s+1]-this.xPct[s]);o>0;)a=this.xPct[s+1+f]-this.xPct[s+f],i[s+f]*l+100-r*100>100?(c=a*r,l=(o-100*r)/i[s+f],r=1):(c=i[s+f]*a/100*l,l=0),n?(u=u-c,this.xPct.length+f>=1&&f--):(u=u+c,this.xPct.length-f>=1&&f++),o=i[s+f]*l;return e+u},t.prototype.toStepping=function(e){return e=pc(this.xVal,this.xPct,e),e},t.prototype.fromStepping=function(e){return mc(this.xVal,this.xPct,e)},t.prototype.getStep=function(e){return e=gc(this.xPct,this.xSteps,this.snap,e),e},t.prototype.getDefaultStep=function(e,i,n){var s=Jt(e,this.xPct);return(e===100||i&&e===this.xPct[s-1])&&(s=Math.max(s-1,1)),(this.xVal[s]-this.xVal[s-1])/n},t.prototype.getNearbySteps=function(e){var i=Jt(e,this.xPct);return{stepBefore:{startValue:this.xVal[i-2],step:this.xNumSteps[i-2],highestStep:this.xHighestCompleteStep[i-2]},thisStep:{startValue:this.xVal[i-1],step:this.xNumSteps[i-1],highestStep:this.xHighestCompleteStep[i-1]},stepAfter:{startValue:this.xVal[i],step:this.xNumSteps[i],highestStep:this.xHighestCompleteStep[i]}}},t.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(oc);return Math.max.apply(null,e)},t.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},t.prototype.convert=function(e){return this.getStep(this.toStepping(e))},t.prototype.handleEntryPoint=function(e,i){var n;if(e==="min"?n=0:e==="max"?n=100:n=parseFloat(e),!xe(n)||!xe(i[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(n),this.xVal.push(i[0]);var s=Number(i[1]);n?this.xSteps.push(isNaN(s)?!1:s):isNaN(s)||(this.xSteps[0]=s),this.xHighestCompleteStep.push(0)},t.prototype.handleStepPoint=function(e,i){if(i){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=qi([this.xVal[e],this.xVal[e+1]],i,0)/cn(this.xPct[e],this.xPct[e+1]);var n=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],s=Math.ceil(Number(n.toFixed(3))-1),r=this.xVal[e]+this.xNumSteps[e]*s;this.xHighestCompleteStep[e]=r}},t}(),_s={to:function(t){return t===void 0?"":t.toFixed(2)},from:Number},Yr={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},ft={tooltips:".__tooltips",aria:".__aria"};function _c(t,e){if(!xe(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function vc(t,e){if(!xe(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");t.keyboardPageMultiplier=e}function bc(t,e){if(!xe(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");t.keyboardMultiplier=e}function yc(t,e){if(!xe(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");t.keyboardDefaultStep=e}function wc(t,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");t.spectrum=new Gr(e,t.snap||!1,t.singleStep)}function kc(t,e){if(e=wi(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=e.length,t.start=e}function Sc(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");t.snap=e}function Ec(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");t.animate=e}function Cc(t,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");t.animationDuration=e}function Jr(t,e){var i=[!1],n;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(n=1;n<t.handles;n++)i.push(e);i.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");i=e}t.connect=i}function Ic(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function Xr(t,e){if(!xe(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(t.margin=t.spectrum.getDistance(e))}function Oc(t,e){if(!xe(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getDistance(e),!t.limit||t.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function Ac(t,e){var i;if(!xe(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||xe(e[0])||xe(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),t.padding=[t.spectrum.getDistance(e[0]),t.spectrum.getDistance(e[1])],i=0;i<t.spectrum.xNumSteps.length-1;i++)if(t.padding[0][i]<0||t.padding[1][i]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var n=e[0]+e[1],s=t.spectrum.xVal[0],r=t.spectrum.xVal[t.spectrum.xVal.length-1];if(n/(r-s)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function Tc(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Pc(t,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var i=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,s=e.indexOf("fixed")>=0,r=e.indexOf("snap")>=0,l=e.indexOf("hover")>=0,o=e.indexOf("unconstrained")>=0,a=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,u=e.indexOf("smooth-steps")>=0;if(s){if(t.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");Xr(t,t.start[1]-t.start[0])}if(a&&t.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(o&&(t.margin||t.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:i||r,drag:n,dragAll:c,smoothSteps:u,fixed:s,snap:r,hover:l,unconstrained:o,invertConnects:a}}function Lc(t,e){if(e!==!1)if(e===!0||gi(e)){t.tooltips=[];for(var i=0;i<t.handles;i++)t.tooltips.push(e)}else{if(e=wi(e),e.length!==t.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(n){if(typeof n!="boolean"&&!gi(n))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),t.tooltips=e}}function Mc(t,e){if(e.length!==t.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");t.handleAttributes=e}function Rc(t,e){if(!gi(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");t.ariaFormat=e}function Dc(t,e){if(!nc(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");t.format=e}function Nc(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");t.keyboardSupport=e}function $c(t,e){t.documentElement=e}function jc(t,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function Fc(t,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof t.cssPrefix=="string"?(t.cssClasses={},Object.keys(e).forEach(function(i){t.cssClasses[i]=t.cssPrefix+e[i]})):t.cssClasses=e}function Qr(t){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:_s,format:_s},i={step:{r:!1,t:_c},keyboardPageMultiplier:{r:!1,t:vc},keyboardMultiplier:{r:!1,t:bc},keyboardDefaultStep:{r:!1,t:yc},start:{r:!0,t:kc},connect:{r:!0,t:Jr},direction:{r:!0,t:Tc},snap:{r:!1,t:Sc},animate:{r:!1,t:Ec},animationDuration:{r:!1,t:Cc},range:{r:!0,t:wc},orientation:{r:!1,t:Ic},margin:{r:!1,t:Xr},limit:{r:!1,t:Oc},padding:{r:!1,t:Ac},behaviour:{r:!0,t:Pc},ariaFormat:{r:!1,t:Rc},format:{r:!1,t:Dc},tooltips:{r:!1,t:Lc},keyboardSupport:{r:!0,t:Nc},documentElement:{r:!1,t:$c},cssPrefix:{r:!0,t:jc},cssClasses:{r:!0,t:Fc},handleAttributes:{r:!1,t:Mc}},n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:Yr,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(i).forEach(function(a){if(!zi(t[a])&&n[a]===void 0){if(i[a].r)throw new Error("noUiSlider: '"+a+"' is required.");return}i[a].t(e,zi(t[a])?t[a]:n[a])}),e.pips=t.pips;var s=document.createElement("div"),r=s.style.msTransform!==void 0,l=s.style.transform!==void 0;e.transformRule=l?"transform":r?"msTransform":"webkitTransform";var o=[["left","top"],["right","bottom"]];return e.style=o[e.dir][e.ort],e}function Uc(t,e,i){var n=cc(),s=fc(),r=s&&uc(),l=t,o,a,c,u,f,d,h=e.spectrum,m=[],g=[],v=[],w=0,O={},L=!1,C=t.ownerDocument,T=e.documentElement||C.documentElement,$=C.body,F=C.dir==="rtl"||e.ort===1?0:100;function E(y,I){var A=C.createElement("div");return I&&Ne(A,I),y.appendChild(A),A}function P(y,I){var A=E(y,e.cssClasses.origin),B=E(A,e.cssClasses.handle);if(E(B,e.cssClasses.touchArea),B.setAttribute("data-handle",String(I)),e.keyboardSupport&&(B.setAttribute("tabindex","0"),B.addEventListener("keydown",function(x){return Sl(x,I)})),e.handleAttributes!==void 0){var K=e.handleAttributes[I];Object.keys(K).forEach(function(x){B.setAttribute(x,K[x])})}return B.setAttribute("role","slider"),B.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),I===0?Ne(B,e.cssClasses.handleLower):I===e.handles-1&&Ne(B,e.cssClasses.handleUpper),A.handle=B,A}function G(y,I){return I?E(y,e.cssClasses.connect):!1}function ee(y,I){a=E(I,e.cssClasses.connects),c=[],u=[],u.push(G(a,y[0]));for(var A=0;A<e.handles;A++)c.push(P(I,A)),v[A]=A,u.push(G(a,y[A+1]))}function M(y){Ne(y,e.cssClasses.target),e.dir===0?Ne(y,e.cssClasses.ltr):Ne(y,e.cssClasses.rtl),e.ort===0?Ne(y,e.cssClasses.horizontal):Ne(y,e.cssClasses.vertical);var I=getComputedStyle(y).direction;return I==="rtl"?Ne(y,e.cssClasses.textDirectionRtl):Ne(y,e.cssClasses.textDirectionLtr),E(y,e.cssClasses.base)}function H(y,I){return!e.tooltips||!e.tooltips[I]?!1:E(y.firstChild,e.cssClasses.tooltip)}function z(){return l.hasAttribute("disabled")}function q(y){var I=c[y];return I.hasAttribute("disabled")}function U(y){y!=null?(c[y].setAttribute("disabled",""),c[y].handle.removeAttribute("tabindex")):(l.setAttribute("disabled",""),c.forEach(function(I){I.handle.removeAttribute("tabindex")}))}function se(y){y!=null?(c[y].removeAttribute("disabled"),c[y].handle.setAttribute("tabindex","0")):(l.removeAttribute("disabled"),c.forEach(function(I){I.removeAttribute("disabled"),I.handle.setAttribute("tabindex","0")}))}function Y(){d&&(Ht("update"+ft.tooltips),d.forEach(function(y){y&&hs(y)}),d=null)}function te(){Y(),d=c.map(H),Ti("update"+ft.tooltips,function(y,I,A){if(!(!d||!e.tooltips)&&d[I]!==!1){var B=y[I];e.tooltips[I]!==!0&&(B=e.tooltips[I].to(A[I])),d[I].innerHTML=B}})}function ne(){Ht("update"+ft.aria),Ti("update"+ft.aria,function(y,I,A,B,K){v.forEach(function(x){var ie=c[x],J=Zt(g,x,0,!0,!0,!0),me=Zt(g,x,100,!0,!0,!0),ge=K[x],ye=String(e.ariaFormat.to(A[x]));J=h.fromStepping(J).toFixed(1),me=h.fromStepping(me).toFixed(1),ge=h.fromStepping(ge).toFixed(1),ie.children[0].setAttribute("aria-valuemin",J),ie.children[0].setAttribute("aria-valuemax",me),ie.children[0].setAttribute("aria-valuenow",ge),ie.children[0].setAttribute("aria-valuetext",ye)})})}function be(y){if(y.mode===dt.Range||y.mode===dt.Steps)return h.xVal;if(y.mode===dt.Count){if(y.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var I=y.values-1,A=100/I,B=[];I--;)B[I]=I*A;return B.push(100),ke(B,y.stepped)}return y.mode===dt.Positions?ke(y.values,y.stepped):y.mode===dt.Values?y.stepped?y.values.map(function(K){return h.fromStepping(h.getStep(h.toStepping(K)))}):y.values:[]}function ke(y,I){return y.map(function(A){return h.fromStepping(I?h.getStep(A):A)})}function ml(y){function I(ge,ye){return Number((ge+ye).toFixed(7))}var A=be(y),B={},K=h.xVal[0],x=h.xVal[h.xVal.length-1],ie=!1,J=!1,me=0;return A=sc(A.slice().sort(function(ge,ye){return ge-ye})),A[0]!==K&&(A.unshift(K),ie=!0),A[A.length-1]!==x&&(A.push(x),J=!0),A.forEach(function(ge,ye){var we,pe,Oe,Re=ge,Te=A[ye+1],Pe,Mi,Ri,Di,wn,Ni,kn,Sn=y.mode===dt.Steps;for(Sn&&(we=h.xNumSteps[ye]),we||(we=Te-Re),Te===void 0&&(Te=Re),we=Math.max(we,1e-7),pe=Re;pe<=Te;pe=I(pe,we)){for(Pe=h.toStepping(pe),Mi=Pe-me,wn=Mi/(y.density||1),Ni=Math.round(wn),kn=Mi/Ni,Oe=1;Oe<=Ni;Oe+=1)Ri=me+Oe*kn,B[Ri.toFixed(5)]=[h.fromStepping(Ri),0];Di=A.indexOf(pe)>-1?Fe.LargeValue:Sn?Fe.SmallValue:Fe.NoValue,!ye&&ie&&pe!==Te&&(Di=0),pe===Te&&J||(B[Pe.toFixed(5)]=[pe,Di]),me=Pe}}),B}function gl(y,I,A){var B,K,x=C.createElement("div"),ie=(B={},B[Fe.None]="",B[Fe.NoValue]=e.cssClasses.valueNormal,B[Fe.LargeValue]=e.cssClasses.valueLarge,B[Fe.SmallValue]=e.cssClasses.valueSub,B),J=(K={},K[Fe.None]="",K[Fe.NoValue]=e.cssClasses.markerNormal,K[Fe.LargeValue]=e.cssClasses.markerLarge,K[Fe.SmallValue]=e.cssClasses.markerSub,K),me=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],ge=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];Ne(x,e.cssClasses.pips),Ne(x,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function ye(pe,Oe){var Re=Oe===e.cssClasses.value,Te=Re?me:ge,Pe=Re?ie:J;return Oe+" "+Te[e.ort]+" "+Pe[pe]}function we(pe,Oe,Re){if(Re=I?I(Oe,Re):Re,Re!==Fe.None){var Te=E(x,!1);Te.className=ye(Re,e.cssClasses.marker),Te.style[e.style]=pe+"%",Re>Fe.NoValue&&(Te=E(x,!1),Te.className=ye(Re,e.cssClasses.value),Te.setAttribute("data-value",String(Oe)),Te.style[e.style]=pe+"%",Te.innerHTML=String(A.to(Oe)))}}return Object.keys(y).forEach(function(pe){we(pe,y[pe][0],y[pe][1])}),x}function Ci(){f&&(hs(f),f=null)}function Ii(y){Ci();var I=ml(y),A=y.filter,B=y.format||{to:function(K){return String(Math.round(K))}};return f=l.appendChild(gl(I,A,B)),f}function dn(){var y=o.getBoundingClientRect(),I="offset"+["Width","Height"][e.ort];return e.ort===0?y.width||o[I]:y.height||o[I]}function yt(y,I,A,B){var K=function(ie){var J=_l(ie,B.pageOffset,B.target||I);if(!J||z()&&!B.doNotReject||ac(l,e.cssClasses.tap)&&!B.doNotReject||y===n.start&&J.buttons!==void 0&&J.buttons>1||B.hover&&J.buttons)return!1;r||J.preventDefault(),J.calcPoint=J.points[e.ort],A(J,B)},x=[];return y.split(" ").forEach(function(ie){I.addEventListener(ie,K,r?{passive:!0}:!1),x.push([ie,K])}),x}function _l(y,I,A){var B=y.type.indexOf("touch")===0,K=y.type.indexOf("mouse")===0,x=y.type.indexOf("pointer")===0,ie=0,J=0;if(y.type.indexOf("MSPointer")===0&&(x=!0),y.type==="mousedown"&&!y.buttons&&!y.touches)return!1;if(B){var me=function(we){var pe=we.target;return pe===A||A.contains(pe)||y.composed&&y.composedPath().shift()===A};if(y.type==="touchstart"){var ge=Array.prototype.filter.call(y.touches,me);if(ge.length>1)return!1;ie=ge[0].pageX,J=ge[0].pageY}else{var ye=Array.prototype.find.call(y.changedTouches,me);if(!ye)return!1;ie=ye.pageX,J=ye.pageY}}return I=I||Wr(C),(K||x)&&(ie=y.clientX+I.x,J=y.clientY+I.y),y.pageOffset=I,y.points=[ie,J],y.cursor=K||x,y}function hn(y){var I=y-lc(o,e.ort),A=I*100/dn();return A=gs(A),e.dir?100-A:A}function vl(y){var I=100,A=!1;return c.forEach(function(B,K){if(!q(K)){var x=g[K],ie=Math.abs(x-y),J=ie===100&&I===100,me=ie<I,ge=ie<=I&&y>x;(me||ge||J)&&(A=K,I=ie)}}),A}function bl(y,I){y.type==="mouseout"&&y.target.nodeName==="HTML"&&y.relatedTarget===null&&Oi(y,I)}function yl(y,I){if(navigator.appVersion.indexOf("MSIE 9")===-1&&y.buttons===0&&I.buttonsProperty!==0)return Oi(y,I);var A=(e.dir?-1:1)*(y.calcPoint-I.startCalcPoint),B=A*100/I.baseSize;mn(A>0,B,I.locations,I.handleNumbers,I.connect)}function Oi(y,I){I.handle&&(ci(I.handle,e.cssClasses.active),w-=1),I.listeners.forEach(function(A){T.removeEventListener(A[0],A[1])}),w===0&&(ci(l,e.cssClasses.drag),Li(),y.cursor&&($.style.cursor="",$.removeEventListener("selectstart",ps))),e.events.smoothSteps&&(I.handleNumbers.forEach(function(A){wt(A,g[A],!0,!0,!1,!1)}),I.handleNumbers.forEach(function(A){Se("update",A)})),I.handleNumbers.forEach(function(A){Se("change",A),Se("set",A),Se("end",A)})}function Ai(y,I){if(!I.handleNumbers.some(q)){var A;if(I.handleNumbers.length===1){var B=c[I.handleNumbers[0]];A=B.children[0],w+=1,Ne(A,e.cssClasses.active)}y.stopPropagation();var K=[],x=yt(n.move,T,yl,{target:y.target,handle:A,connect:I.connect,listeners:K,startCalcPoint:y.calcPoint,baseSize:dn(),pageOffset:y.pageOffset,handleNumbers:I.handleNumbers,buttonsProperty:y.buttons,locations:g.slice()}),ie=yt(n.end,T,Oi,{target:y.target,handle:A,listeners:K,doNotReject:!0,handleNumbers:I.handleNumbers}),J=yt("mouseout",T,bl,{target:y.target,handle:A,listeners:K,doNotReject:!0,handleNumbers:I.handleNumbers});K.push.apply(K,x.concat(ie,J)),y.cursor&&($.style.cursor=getComputedStyle(y.target).cursor,c.length>1&&Ne(l,e.cssClasses.drag),$.addEventListener("selectstart",ps,!1)),I.handleNumbers.forEach(function(me){Se("start",me)})}}function wl(y){y.stopPropagation();var I=hn(y.calcPoint),A=vl(I);A!==!1&&(e.events.snap||ms(l,e.cssClasses.tap,e.animationDuration),wt(A,I,!0,!0),Li(),Se("slide",A,!0),Se("update",A,!0),e.events.snap?Ai(y,{handleNumbers:[A]}):(Se("change",A,!0),Se("set",A,!0)))}function kl(y){var I=hn(y.calcPoint),A=h.getStep(I),B=h.fromStepping(A);Object.keys(O).forEach(function(K){K.split(".")[0]==="hover"&&O[K].forEach(function(x){x.call(ti,B)})})}function Sl(y,I){if(z()||q(I))return!1;var A=["Left","Right"],B=["Down","Up"],K=["PageDown","PageUp"],x=["Home","End"];e.dir&&!e.ort?A.reverse():e.ort&&!e.dir&&(B.reverse(),K.reverse());var ie=y.key.replace("Arrow",""),J=ie===K[0],me=ie===K[1],ge=ie===B[0]||ie===A[0]||J,ye=ie===B[1]||ie===A[1]||me,we=ie===x[0],pe=ie===x[1];if(!ge&&!ye&&!we&&!pe)return!0;y.preventDefault();var Oe;if(ye||ge){var Re=ge?0:1,Te=bn(I),Pe=Te[Re];if(Pe===null)return!1;Pe===!1&&(Pe=h.getDefaultStep(g[I],ge,e.keyboardDefaultStep)),me||J?Pe*=e.keyboardPageMultiplier:Pe*=e.keyboardMultiplier,Pe=Math.max(Pe,1e-7),Pe=(ge?-1:1)*Pe,Oe=m[I]+Pe}else pe?Oe=e.spectrum.xVal[e.spectrum.xVal.length-1]:Oe=e.spectrum.xVal[0];return wt(I,h.toStepping(Oe),!0,!0),Se("slide",I),Se("update",I),Se("change",I),Se("set",I),!1}function pn(y){y.fixed||c.forEach(function(I,A){yt(n.start,I.children[0],Ai,{handleNumbers:[A]})}),y.tap&&yt(n.start,o,wl,{}),y.hover&&yt(n.move,o,kl,{hover:!0}),y.drag&&u.forEach(function(I,A){if(!(I===!1||A===0||A===u.length-1)){var B=c[A-1],K=c[A],x=[I],ie=[B,K],J=[A-1,A];Ne(I,e.cssClasses.draggable),y.fixed&&(x.push(B.children[0]),x.push(K.children[0])),y.dragAll&&(ie=c,J=v),x.forEach(function(me){yt(n.start,me,Ai,{handles:ie,handleNumbers:J,connect:I})})}})}function Ti(y,I){O[y]=O[y]||[],O[y].push(I),y.split(".")[0]==="update"&&c.forEach(function(A,B){Se("update",B)})}function El(y){return y===ft.aria||y===ft.tooltips}function Ht(y){var I=y&&y.split(".")[0],A=I?y.substring(I.length):y;Object.keys(O).forEach(function(B){var K=B.split(".")[0],x=B.substring(K.length);(!I||I===K)&&(!A||A===x)&&(!El(x)||A===x)&&delete O[B]})}function Se(y,I,A){Object.keys(O).forEach(function(B){var K=B.split(".")[0];y===K&&O[B].forEach(function(x){x.call(ti,m.map(e.format.to),I,m.slice(),A||!1,g.slice(),ti)})})}function Zt(y,I,A,B,K,x,ie){var J;return c.length>1&&!e.events.unconstrained&&(B&&I>0&&(J=h.getAbsoluteDistance(y[I-1],e.margin,!1),A=Math.max(A,J)),K&&I<c.length-1&&(J=h.getAbsoluteDistance(y[I+1],e.margin,!0),A=Math.min(A,J))),c.length>1&&e.limit&&(B&&I>0&&(J=h.getAbsoluteDistance(y[I-1],e.limit,!1),A=Math.min(A,J)),K&&I<c.length-1&&(J=h.getAbsoluteDistance(y[I+1],e.limit,!0),A=Math.max(A,J))),e.padding&&(I===0&&(J=h.getAbsoluteDistance(0,e.padding[0],!1),A=Math.max(A,J)),I===c.length-1&&(J=h.getAbsoluteDistance(100,e.padding[1],!0),A=Math.min(A,J))),ie||(A=h.getStep(A)),A=gs(A),A===y[I]&&!x?!1:A}function Pi(y,I){var A=e.ort;return(A?I:y)+", "+(A?y:I)}function mn(y,I,A,B,K){var x=A.slice(),ie=B[0],J=e.events.smoothSteps,me=[!y,y],ge=[y,!y];B=B.slice(),y&&B.reverse(),B.length>1?B.forEach(function(we,pe){var Oe=Zt(x,we,x[we]+I,me[pe],ge[pe],!1,J);Oe===!1?I=0:(I=Oe-x[we],x[we]=Oe)}):me=ge=[!0];var ye=!1;B.forEach(function(we,pe){ye=wt(we,A[we]+I,me[pe],ge[pe],!1,J)||ye}),ye&&(B.forEach(function(we){Se("update",we),Se("slide",we)}),K!=null&&Se("drag",ie))}function gn(y,I){return e.dir?100-y-I:y}function Cl(y,I){g[y]=I,m[y]=h.fromStepping(I);var A=gn(I,0)-F,B="translate("+Pi(A+"%","0")+")";if(c[y].style[e.transformRule]=B,e.events.invertConnects&&g.length>1){var K=g.every(function(x,ie,J){return ie===0||x>=J[ie-1]});if(L!==!K){Ll();return}}Bt(y),Bt(y+1),L&&(Bt(y-1),Bt(y+2))}function Li(){v.forEach(function(y){var I=g[y]>50?-1:1,A=3+(c.length+I*y);c[y].style.zIndex=String(A)})}function wt(y,I,A,B,K,x){return K||(I=Zt(g,y,I,A,B,!1,x)),I===!1?!1:(Cl(y,I),!0)}function Bt(y){if(u[y]){var I=g.slice();L&&I.sort(function(J,me){return J-me});var A=0,B=100;y!==0&&(A=I[y-1]),y!==u.length-1&&(B=I[y]);var K=B-A,x="translate("+Pi(gn(A,K)+"%","0")+")",ie="scale("+Pi(K/100,"1")+")";u[y].style[e.transformRule]=x+" "+ie}}function _n(y,I){return y===null||y===!1||y===void 0||(typeof y=="number"&&(y=String(y)),y=e.format.from(y),y!==!1&&(y=h.toStepping(y)),y===!1||isNaN(y))?g[I]:y}function ei(y,I,A){var B=wi(y),K=g[0]===void 0;I=I===void 0?!0:I,e.animate&&!K&&ms(l,e.cssClasses.tap,e.animationDuration),v.forEach(function(J){wt(J,_n(B[J],J),!0,!1,A)});var x=v.length===1?0:1;if(K&&h.hasNoSize()&&(A=!0,g[0]=0,v.length>1)){var ie=100/(v.length-1);v.forEach(function(J){g[J]=J*ie})}for(;x<v.length;++x)v.forEach(function(J){wt(J,g[J],!0,!0,A)});Li(),v.forEach(function(J){Se("update",J),B[J]!==null&&I&&Se("set",J)})}function Il(y){ei(e.start,y)}function Ol(y,I,A,B){if(y=Number(y),!(y>=0&&y<v.length))throw new Error("noUiSlider: invalid handle number, got: "+y);wt(y,_n(I,y),!0,!0,B),Se("update",y),A&&Se("set",y)}function vn(y){if(y===void 0&&(y=!1),y)return m.length===1?m[0]:m.slice(0);var I=m.map(e.format.to);return I.length===1?I[0]:I}function Al(){for(Ht(ft.aria),Ht(ft.tooltips),Object.keys(e.cssClasses).forEach(function(y){ci(l,e.cssClasses[y])});l.firstChild;)l.removeChild(l.firstChild);delete l.noUiSlider}function bn(y){var I=g[y],A=h.getNearbySteps(I),B=m[y],K=A.thisStep.step,x=null;if(e.snap)return[B-A.stepBefore.startValue||null,A.stepAfter.startValue-B||null];K!==!1&&B+K>A.stepAfter.startValue&&(K=A.stepAfter.startValue-B),B>A.thisStep.startValue?x=A.thisStep.step:A.stepBefore.step===!1?x=!1:x=B-A.stepBefore.highestStep,I===100?K=null:I===0&&(x=null);var ie=h.countStepDecimals();return K!==null&&K!==!1&&(K=Number(K.toFixed(ie))),x!==null&&x!==!1&&(x=Number(x.toFixed(ie))),[x,K]}function Tl(){return v.map(bn)}function Pl(y,I){var A=vn(),B=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];B.forEach(function(x){y[x]!==void 0&&(i[x]=y[x])});var K=Qr(i);B.forEach(function(x){y[x]!==void 0&&(e[x]=K[x])}),h=K.spectrum,e.margin=K.margin,e.limit=K.limit,e.padding=K.padding,e.pips?Ii(e.pips):Ci(),e.tooltips?te():Y(),g=[],ei(zi(y.start)?y.start:A,I),y.connect&&yn()}function yn(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var y=0;y<=e.handles;y++)u[y]=G(a,e.connect[y]),Bt(y);pn({drag:e.events.drag,fixed:!0})}function Ll(){L=!L,Jr(e,e.connect.map(function(y){return!y})),yn()}function Ml(){o=M(l),ee(e.connect,o),pn(e.events),ei(e.start),e.pips&&Ii(e.pips),e.tooltips&&te(),ne()}Ml();var ti={destroy:Al,steps:Tl,on:Ti,off:Ht,get:vn,set:ei,setHandle:Ol,reset:Il,disable:U,enable:se,__moveHandles:function(y,I,A){mn(y,I,g,A)},options:i,updateOptions:Pl,target:l,removePips:Ci,removeTooltips:Y,getPositions:function(){return g.slice()},getTooltips:function(){return d},getOrigins:function(){return c},pips:Ii};return ti}function Vc(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var i=Qr(e),n=Uc(t,i,e);return t.noUiSlider=n,n}const Hc={__spectrum:Gr,cssClasses:Yr,create:Vc};function Bc(t){let e,i,n;return{c(){e=b("span"),i=W(t[0]),p(e,"id",t[3]),p(e,"class",n="tooltip "+t[2]+" "+(t[1]?"display":"")+" svelte-1am23me")},m(s,r){S(s,e,r),_(e,i)},p(s,[r]){r&1&&ce(i,s[0]),r&6&&n!==(n="tooltip "+s[2]+" "+(s[1]?"display":"")+" svelte-1am23me")&&p(e,"class",n)},i:j,o:j,d(s){s&&k(e)}}}function zc(t,e,i){let n,s,r,l,{tooltipText:o}=e,{targetHtmlId:a}=e;const c=`tooltip-generic-${window.crypto.randomUUID()}`,u=()=>i(1,l=!0),f=()=>i(1,l=!1),d=()=>i(1,l=!l);return vt(()=>{r=a?document.getElementById(a):document.getElementById(c).parentElement,a&&!r&&(console.error(`TooltipGeneric: element with ID ${a} not found, defaulting to the parent element`),r=document.getElementById(c).targetElement),r.addEventListener("mouseover",u),r.addEventListener("mouseout",f),r.addEventListener("click",d)}),bi(()=>{r.removeEventListener("mouseover",u),r.removeEventListener("mouseout",f),r.removeEventListener("click",d)}),t.$$set=h=>{"tooltipText"in h&&i(0,o=h.tooltipText),"targetHtmlId"in h&&i(4,a=h.targetHtmlId)},t.$$.update=()=>{t.$$.dirty&33&&i(2,n=s(o))},i(5,s=h=>i(2,n=h.length>100?"tooltip-wide":h.length>20?"tooltip-mid":"tooltip-thin")),r=void 0,i(1,l=!1),[o,l,n,c,a,s]}class ki extends de{constructor(e){super(),fe(this,e,zc,Bc,ue,{tooltipText:0,targetHtmlId:4})}}function qc(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g,v;return{c(){e=b("div"),i=b("span"),n=W(t[2]),s=W(" ("),r=W(t[3]),l=W(")"),o=N(),a=b("div"),c=b("span"),u=W(t[0]),f=N(),d=b("div"),h=b("div"),m=N(),g=b("span"),v=W(t[1]),p(c,"class","range-marker svelte-216mtn"),p(h,"class","slider"),p(h,"id",t[4]),p(d,"class","slider-wrapper svelte-216mtn"),p(g,"class","range-marker svelte-216mtn"),p(a,"class","slider-outer-wrapper is-flex flex-direction-row svelte-216mtn")},m(w,O){S(w,e,O),_(e,i),_(i,n),_(i,s),_(i,r),_(i,l),_(e,o),_(e,a),_(a,c),_(c,u),_(a,f),_(a,d),_(d,h),_(a,m),_(a,g),_(g,v)},p(w,[O]){O&4&&ce(n,w[2]),O&8&&ce(r,w[3]),O&1&&ce(u,w[0]),O&2&&ce(v,w[1])},i:j,o:j,d(w){w&&k(e)}}}function Kc(t,e,i){let n,{minVal:s}=e,{maxVal:r}=e,{start:l}=e,{step:o=void 0}=e,{roundTo:a=2}=e,{title:c=""}=e,{emitOnUpdate:u=!1}=e;const f=tn(),d=`slider-${window.crypto.randomUUID()}`,h=Array.isArray(l)&&l.length===2&&l.every(E=>!isNaN(parseFloat(E))),m=[],g=h?[`noUi-handle-${window.crypto.randomUUID()}`,`noUi-handle-${window.crypto.randomUUID()}`]:[`noUi-handle-${window.crypto.randomUUID()}`],v=mi();v.setCompareFn(h?ln:(E,P)=>O(E)===O(P)),v.set(l);const w=Ae("resetTrigger")||void 0;w==null||w.subscribe(T);const O=E=>Number(E.toFixed(a)),L=(E,P)=>{E=Array.isArray(E)?E.map(O):O(E),i(3,n=E),(P==="set"||P==="update"&&u)&&(v.set(E),v.same()||f("updateSlider",v.get()))};function C(E){m.length&&m.map((P,G)=>P.$set({tooltipText:h?E[G]:E}))}function T(){const E=document.getElementById(d);E!=null&&E.noUiSlider&&E.noUiSlider.reset()}function $(){const E=document.getElementById(d);let P;Hc.create(E,{start:l,step:o,connect:h?!0:"lower",range:{min:s,max:r},handleAttributes:g.map(G=>({id:G}))}),E.noUiSlider.on("update",()=>{P=E.noUiSlider.get(!0),L(P,"update")}),E.noUiSlider.on("set",()=>{P=E.noUiSlider.get(!0),L(P,"set")})}function F(){g.map((E,P)=>{m.push(new ki({target:document.getElementById(E),props:h?{tooltipText:n[P]}:{tooltipText:n}}))})}return vt(()=>{$(),F()}),bi(()=>{document.getElementById(d)&&(document.getElementById(d).innerHTML="")}),t.$$set=E=>{"minVal"in E&&i(0,s=E.minVal),"maxVal"in E&&i(1,r=E.maxVal),"start"in E&&i(5,l=E.start),"step"in E&&i(6,o=E.step),"roundTo"in E&&i(7,a=E.roundTo),"title"in E&&i(2,c=E.title),"emitOnUpdate"in E&&i(8,u=E.emitOnUpdate)},t.$$.update=()=>{t.$$.dirty&32&&i(3,n=l),t.$$.dirty&8&&C(n)},[s,r,c,n,d,l,o,a,u]}class Zr extends de{constructor(e){super(),fe(this,e,Kc,qc,ue,{minVal:0,maxVal:1,start:5,step:6,roundTo:7,title:2,emitOnUpdate:8})}}function xc(t){let e,i,n,s,r,l,o;return{c(){e=b("button"),i=b("span"),i.innerHTML='<span class="switch-control svelte-g5g8im"><span class="switch-spot"></span></span>',n=N(),s=b("span"),r=W(t[0]),p(i,"class","switch mr-2 svelte-g5g8im"),p(s,"class","label svelte-g5g8im"),p(e,"id",t[3]),p(e,"name",t[3]),p(e,"class","input-checkbox-wrapper is-flex is-align-items-center-is-justify-content-center p-2 pl-3 pr-3 svelte-g5g8im"),p(e,"aria-label",t[0]),qe(e,"is-checked",t[2]),qe(e,"is-clickable",t[1]),qe(e,"button",t[1])},m(a,c){S(a,e,c),_(e,i),_(e,n),_(e,s),_(s,r),l||(o=re(e,"click",Ct(t[4])),l=!0)},p(a,[c]){c&1&&ce(r,a[0]),c&1&&p(e,"aria-label",a[0]),c&4&&qe(e,"is-checked",a[2]),c&2&&qe(e,"is-clickable",a[1]),c&2&&qe(e,"button",a[1])},i:j,o:j,d(a){a&&k(e),l=!1,o()}}}function Wc(t,e,i){let n,{toggleLabel:s}=e,{start:r=!1}=e,{buttonDisplay:l=!1}=e;const o=`input-toggle-${window.crypto.randomUUID()}`,a=tn(),c=Ae("resetTrigger")||void 0;c==null||c.subscribe(f);const u=()=>i(2,n=!n);function f(){i(2,n=r)}return t.$$set=d=>{"toggleLabel"in d&&i(0,s=d.toggleLabel),"start"in d&&i(5,r=d.start),"buttonDisplay"in d&&i(1,l=d.buttonDisplay)},t.$$.update=()=>{t.$$.dirty&32&&i(2,n=r),t.$$.dirty&4&&a("updateChecked",n)},[s,l,n,o,u,r]}class Gc extends de{constructor(e){super(),fe(this,e,Wc,xc,ue,{toggleLabel:0,start:5,buttonDisplay:1})}}/*! choices.js v11.1.0 | © 2025 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var Ki=function(t,e){return Ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},Ki(t,e)};function el(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ki(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var Ve=function(){return Ve=Object.assign||function(e){for(var i,n=1,s=arguments.length;n<s;n++){i=arguments[n];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Ve.apply(this,arguments)};function Yc(t,e,i){if(i||arguments.length===2)for(var n=0,s=e.length,r;n<s;n++)(r||!(n in e))&&(r||(r=Array.prototype.slice.call(e,0,n)),r[n]=e[n]);return t.concat(r||Array.prototype.slice.call(e))}var Ce={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},Ue={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},De={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},Jc=["fuseOptions","classNames"],pt={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},vs=function(t){return{type:Ce.ADD_CHOICE,choice:t}},Xc=function(t){return{type:Ce.REMOVE_CHOICE,choice:t}},Qc=function(t){return{type:Ce.FILTER_CHOICES,results:t}},Zc=function(t){return{type:Ce.ACTIVATE_CHOICES,active:t}},eu=function(t){return{type:Ce.ADD_GROUP,group:t}},bs=function(t){return{type:Ce.ADD_ITEM,item:t}},ys=function(t){return{type:Ce.REMOVE_ITEM,item:t}},ri=function(t,e){return{type:Ce.HIGHLIGHT_ITEM,item:t,highlighted:e}},tu=function(t,e){return Math.floor(Math.random()*(e-t)+t)},ws=function(t){return Array.from({length:t},function(){return tu(0,36).toString(36)}).join("")},iu=function(t,e){var i=t.id||t.name&&"".concat(t.name,"-").concat(ws(2))||ws(4);return i=i.replace(/(:|\.|\[|\]|,)/g,""),i="".concat(e,"-").concat(i),i},nu=function(t,e,i){i===void 0&&(i=1);for(var n="".concat(i>0?"next":"previous","ElementSibling"),s=t[n];s;){if(s.matches(e))return s;s=s[n]}return null},su=function(t,e,i){i===void 0&&(i=1);var n;return i>0?n=e.scrollTop+e.offsetHeight>=t.offsetTop+t.offsetHeight:n=t.offsetTop>=e.scrollTop,n},Si=function(t){if(typeof t!="string"){if(t==null)return"";if(typeof t=="object"){if("raw"in t)return Si(t.raw);if("trusted"in t)return t.trusted}return t}return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},ru=function(){var t=document.createElement("div");return function(e){t.innerHTML=e.trim();for(var i=t.children[0];t.firstChild;)t.removeChild(t.firstChild);return i}}(),Gt=function(t,e){return typeof t=="function"?t(Si(e),e):t},ks=function(t){return typeof t=="function"?t():t},St=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("trusted"in t)return t.trusted;if("raw"in t)return t.raw}return""},tl=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("escaped"in t)return t.escaped;if("trusted"in t)return t.trusted}return""},un=function(t,e){return t?tl(e):Si(e)},rt=function(t,e,i){t.innerHTML=un(e,i)},lu=function(t,e){var i=t.value,n=t.label,s=n===void 0?i:n,r=e.value,l=e.label,o=l===void 0?r:l;return St(s).localeCompare(St(o),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},ou=function(t,e){return t.rank-e.rank},au=function(t,e,i){i===void 0&&(i=null);var n=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0});return t.dispatchEvent(n)},cu=function(t,e){var i=Object.keys(t).sort(),n=Object.keys(e).sort();return i.filter(function(s){return n.indexOf(s)<0})},Ei=function(t){return Array.isArray(t)?t:[t]},Kt=function(t){return t&&Array.isArray(t)?t.map(function(e){return".".concat(e)}).join(""):".".concat(t)},ae=function(t,e){var i;(i=t.classList).add.apply(i,Ei(e))},tt=function(t,e){var i;(i=t.classList).remove.apply(i,Ei(e))},uu=function(t){if(typeof t<"u")try{return JSON.parse(t)}catch{return t}return{}},fu=function(t,e,i){var n=t.itemEl;n&&(tt(n,i),ae(n,e))},du=function(){function t(e){var i=e.element,n=e.type,s=e.classNames;this.element=i,this.classNames=s,this.type=n,this.isActive=!1}return t.prototype.show=function(){return ae(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},t.prototype.hide=function(){return tt(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},t}(),Ss=function(){function t(e){var i=e.element,n=e.type,s=e.classNames,r=e.position;this.element=i,this.classNames=s,this.type=n,this.position=r,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return t.prototype.shouldFlip=function(e,i){var n=!1;return this.position==="auto"?n=this.element.getBoundingClientRect().top-i>=0&&!window.matchMedia("(min-height: ".concat(e+1,"px)")).matches:this.position==="top"&&(n=!0),n},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype.open=function(e,i){ae(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e,i)&&(ae(this.element,this.classNames.flippedState),this.isFlipped=!0)},t.prototype.close=function(){tt(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(tt(this.element,this.classNames.flippedState),this.isFlipped=!1)},t.prototype.addFocusState=function(){ae(this.element,this.classNames.focusState)},t.prototype.removeFocusState=function(){tt(this.element,this.classNames.focusState)},t.prototype.enable=function(){tt(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===pt.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},t.prototype.disable=function(){ae(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===pt.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},t.prototype.wrap=function(e){var i=this.element,n=e.parentNode;n&&(e.nextSibling?n.insertBefore(i,e.nextSibling):n.appendChild(i)),i.appendChild(e)},t.prototype.unwrap=function(e){var i=this.element,n=i.parentNode;n&&(n.insertBefore(e,i),n.removeChild(i))},t.prototype.addLoadingState=function(){ae(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},t.prototype.removeLoadingState=function(){tt(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},t}(),hu=function(){function t(e){var i=e.element,n=e.type,s=e.classNames,r=e.preventPaste;this.element=i,this.type=n,this.classNames=s,this.preventPaste=r,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=i.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(t.prototype,"placeholder",{set:function(e){this.element.placeholder=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.addEventListeners=function(){var e=this.element;e.addEventListener("paste",this._onPaste),e.addEventListener("input",this._onInput,{passive:!0}),e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})},t.prototype.removeEventListeners=function(){var e=this.element;e.removeEventListener("input",this._onInput),e.removeEventListener("paste",this._onPaste),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)},t.prototype.enable=function(){var e=this.element;e.removeAttribute("disabled"),this.isDisabled=!1},t.prototype.disable=function(){var e=this.element;e.setAttribute("disabled",""),this.isDisabled=!0},t.prototype.focus=function(){this.isFocussed||this.element.focus()},t.prototype.blur=function(){this.isFocussed&&this.element.blur()},t.prototype.clear=function(e){return e===void 0&&(e=!0),this.element.value="",e&&this.setWidth(),this},t.prototype.setWidth=function(){var e=this.element;e.style.minWidth="".concat(e.placeholder.length+1,"ch"),e.style.width="".concat(e.value.length+1,"ch")},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype._onInput=function(){this.type!==pt.SelectOne&&this.setWidth()},t.prototype._onPaste=function(e){this.preventPaste&&e.preventDefault()},t.prototype._onFocus=function(){this.isFocussed=!0},t.prototype._onBlur=function(){this.isFocussed=!1},t}(),pu=4,Es=function(){function t(e){var i=e.element;this.element=i,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return t.prototype.prepend=function(e){var i=this.element.firstElementChild;i?this.element.insertBefore(e,i):this.element.append(e)},t.prototype.scrollToTop=function(){this.element.scrollTop=0},t.prototype.scrollToChildElement=function(e,i){var n=this;if(e){var s=this.element.offsetHeight,r=this.element.scrollTop+s,l=e.offsetHeight,o=e.offsetTop+l,a=i>0?this.element.scrollTop+o-r:e.offsetTop;requestAnimationFrame(function(){n._animateScroll(a,i)})}},t.prototype._scrollDown=function(e,i,n){var s=(n-e)/i,r=s>1?s:1;this.element.scrollTop=e+r},t.prototype._scrollUp=function(e,i,n){var s=(e-n)/i,r=s>1?s:1;this.element.scrollTop=e-r},t.prototype._animateScroll=function(e,i){var n=this,s=pu,r=this.element.scrollTop,l=!1;i>0?(this._scrollDown(r,s,e),r<e&&(l=!0)):(this._scrollUp(r,s,e),r>e&&(l=!0)),l&&requestAnimationFrame(function(){n._animateScroll(e,i)})},t}(),il=function(){function t(e){var i=e.element,n=e.classNames;this.element=i,this.classNames=n,this.isDisabled=!1}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.setAttribute("value",e),this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.conceal=function(){var e=this.element;ae(e,this.classNames.input),e.hidden=!0,e.tabIndex=-1;var i=e.getAttribute("style");i&&e.setAttribute("data-choice-orig-style",i),e.setAttribute("data-choice","active")},t.prototype.reveal=function(){var e=this.element;tt(e,this.classNames.input),e.hidden=!1,e.removeAttribute("tabindex");var i=e.getAttribute("data-choice-orig-style");i?(e.removeAttribute("data-choice-orig-style"),e.setAttribute("style",i)):e.removeAttribute("style"),e.removeAttribute("data-choice")},t.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},t.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},t.prototype.triggerEvent=function(e,i){au(this.element,e,i||{})},t}(),mu=function(t){el(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(il),Wt=function(t,e){return e===void 0&&(e=!0),typeof t>"u"?e:!!t},nl=function(t){if(typeof t=="string"&&(t=t.split(" ").filter(function(e){return e.length})),Array.isArray(t)&&t.length)return t},et=function(t,e,i){if(i===void 0&&(i=!0),typeof t=="string"){var n=Si(t),s=i||n===t?t:{escaped:n,raw:t},r=et({value:t,label:s,selected:!0},!1);return r}var l=t;if("choices"in l){if(!e)throw new TypeError("optGroup is not allowed");var o=l,a=o.choices.map(function(d){return et(d,!1)}),c={id:0,label:St(o.label)||o.value,active:!!a.length,disabled:!!o.disabled,choices:a};return c}var u=l,f={id:0,group:null,score:0,rank:0,value:u.value,label:u.label||u.value,active:Wt(u.active),selected:Wt(u.selected,!1),disabled:Wt(u.disabled,!1),placeholder:Wt(u.placeholder,!1),highlighted:!1,labelClass:nl(u.labelClass),labelDescription:u.labelDescription,customProperties:u.customProperties};return f},gu=function(t){return t.tagName==="INPUT"},sl=function(t){return t.tagName==="SELECT"},_u=function(t){return t.tagName==="OPTION"},vu=function(t){return t.tagName==="OPTGROUP"},bu=function(t){el(e,t);function e(i){var n=i.element,s=i.classNames,r=i.template,l=i.extractPlaceholder,o=t.call(this,{element:n,classNames:s})||this;return o.template=r,o.extractPlaceholder=l,o}return Object.defineProperty(e.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),e.prototype.addOptions=function(i){var n=this,s=document.createDocumentFragment();i.forEach(function(r){var l=r;if(!l.element){var o=n.template(l);s.appendChild(o),l.element=o}}),this.element.appendChild(s)},e.prototype.optionsAsChoices=function(){var i=this,n=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(s){_u(s)?n.push(i._optionToChoice(s)):vu(s)&&n.push(i._optgroupToChoice(s))}),n},e.prototype._optionToChoice=function(i){return!i.hasAttribute("value")&&i.hasAttribute("placeholder")&&(i.setAttribute("value",""),i.value=""),{id:0,group:null,score:0,rank:0,value:i.value,label:i.label,element:i,active:!0,selected:this.extractPlaceholder?i.selected:i.hasAttribute("selected"),disabled:i.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!i.value||i.hasAttribute("placeholder")),labelClass:typeof i.dataset.labelClass<"u"?nl(i.dataset.labelClass):void 0,labelDescription:typeof i.dataset.labelDescription<"u"?i.dataset.labelDescription:void 0,customProperties:uu(i.dataset.customProperties)}},e.prototype._optgroupToChoice=function(i){var n=this,s=i.querySelectorAll("option"),r=Array.from(s).map(function(l){return n._optionToChoice(l)});return{id:0,label:i.label||"",element:i,active:!!r.length,disabled:i.disabled,choices:r}},e}(il),yu={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},Cs={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(t){return!!t&&t!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:lu,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(t){return'Press Enter to add <b>"'.concat(t,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(t){return"Remove item: ".concat(t)},maxItemText:function(t){return"Only ".concat(t," values can be added")},valueComparer:function(t,e){return t===e},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:yu,appendGroupInSearch:!1},Is=function(t){var e=t.itemEl;e&&(e.remove(),t.itemEl=void 0)};function wu(t,e,i){var n=t,s=!0;switch(e.type){case Ce.ADD_ITEM:{e.item.selected=!0;var r=e.item.element;r&&(r.selected=!0,r.setAttribute("selected","")),n.push(e.item);break}case Ce.REMOVE_ITEM:{e.item.selected=!1;var r=e.item.element;if(r){r.selected=!1,r.removeAttribute("selected");var l=r.parentElement;l&&sl(l)&&l.type===pt.SelectOne&&(l.value="")}Is(e.item),n=n.filter(function(u){return u.id!==e.item.id});break}case Ce.REMOVE_CHOICE:{Is(e.choice),n=n.filter(function(c){return c.id!==e.choice.id});break}case Ce.HIGHLIGHT_ITEM:{var o=e.highlighted,a=n.find(function(c){return c.id===e.item.id});a&&a.highlighted!==o&&(a.highlighted=o,i&&fu(a,o?i.classNames.highlightedState:i.classNames.selectedState,o?i.classNames.selectedState:i.classNames.highlightedState));break}default:{s=!1;break}}return{state:n,update:s}}function ku(t,e){var i=t,n=!0;switch(e.type){case Ce.ADD_GROUP:{i.push(e.group);break}case Ce.CLEAR_CHOICES:{i=[];break}default:{n=!1;break}}return{state:i,update:n}}function Su(t,e,i){var n=t,s=!0;switch(e.type){case Ce.ADD_CHOICE:{n.push(e.choice);break}case Ce.REMOVE_CHOICE:{e.choice.choiceEl=void 0,e.choice.group&&(e.choice.group.choices=e.choice.group.choices.filter(function(l){return l.id!==e.choice.id})),n=n.filter(function(l){return l.id!==e.choice.id});break}case Ce.ADD_ITEM:case Ce.REMOVE_ITEM:{e.item.choiceEl=void 0;break}case Ce.FILTER_CHOICES:{var r=[];e.results.forEach(function(l){r[l.item.id]=l}),n.forEach(function(l){var o=r[l.id];o!==void 0?(l.score=o.score,l.rank=o.rank,l.active=!0):(l.score=0,l.rank=0,l.active=!1),i&&i.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ce.ACTIVATE_CHOICES:{n.forEach(function(l){l.active=e.active,i&&i.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Ce.CLEAR_CHOICES:{n=[];break}default:{s=!1;break}}return{state:n,update:s}}var Os={groups:ku,items:wu,choices:Su},Eu=function(){function t(e){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=e}return Object.defineProperty(t.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),t.prototype.changeSet=function(e){return{groups:e,items:e,choices:e}},t.prototype.reset=function(){this._state=this.defaultState;var e=this.changeSet(!0);this._txn?this._changeSet=e:this._listeners.forEach(function(i){return i(e)})},t.prototype.subscribe=function(e){return this._listeners.push(e),this},t.prototype.dispatch=function(e){var i=this,n=this._state,s=!1,r=this._changeSet||this.changeSet(!1);Object.keys(Os).forEach(function(l){var o=Os[l](n[l],e,i._context);o.update&&(s=!0,r[l]=!0,n[l]=o.state)}),s&&(this._txn?this._changeSet=r:this._listeners.forEach(function(l){return l(r)}))},t.prototype.withTxn=function(e){this._txn++;try{e()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var i=this._changeSet;i&&(this._changeSet=void 0,this._listeners.forEach(function(n){return n(i)}))}}},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(e){return e.active&&e.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeChoices",{get:function(){return this.choices.filter(function(e){return e.active})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(e){return!e.disabled&&!e.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeGroups",{get:function(){var e=this;return this.state.groups.filter(function(i){var n=i.active&&!i.disabled,s=e.state.choices.some(function(r){return r.active&&!r.disabled});return n&&s},[])},enumerable:!1,configurable:!0}),t.prototype.inTxn=function(){return this._txn>0},t.prototype.getChoiceById=function(e){return this.activeChoices.find(function(i){return i.id===e})},t.prototype.getGroupById=function(e){return this.groups.find(function(i){return i.id===e})},t}(),Le={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Cu(t,e,i){return(e=Ou(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function As(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),i.push.apply(i,n)}return i}function Tt(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?As(Object(i),!0).forEach(function(n){Cu(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):As(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function Iu(t,e){if(typeof t!="object"||!t)return t;var i=t[Symbol.toPrimitive];if(i!==void 0){var n=i.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ou(t){var e=Iu(t,"string");return typeof e=="symbol"?e:e+""}function ut(t){return Array.isArray?Array.isArray(t):ol(t)==="[object Array]"}const Au=1/0;function Tu(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-Au?"-0":e}function Pu(t){return t==null?"":Tu(t)}function it(t){return typeof t=="string"}function rl(t){return typeof t=="number"}function Lu(t){return t===!0||t===!1||Mu(t)&&ol(t)=="[object Boolean]"}function ll(t){return typeof t=="object"}function Mu(t){return ll(t)&&t!==null}function He(t){return t!=null}function Fi(t){return!t.trim().length}function ol(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Ru="Incorrect 'index' type",Du=t=>`Invalid value for key ${t}`,Nu=t=>`Pattern length exceeds max of ${t}.`,$u=t=>`Missing ${t} property in key`,ju=t=>`Property 'weight' in key '${t}' must be a positive integer`,Ts=Object.prototype.hasOwnProperty;class Fu{constructor(e){this._keys=[],this._keyMap={};let i=0;e.forEach(n=>{let s=al(n);this._keys.push(s),this._keyMap[s.id]=s,i+=s.weight}),this._keys.forEach(n=>{n.weight/=i})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function al(t){let e=null,i=null,n=null,s=1,r=null;if(it(t)||ut(t))n=t,e=Ps(t),i=xi(t);else{if(!Ts.call(t,"name"))throw new Error($u("name"));const l=t.name;if(n=l,Ts.call(t,"weight")&&(s=t.weight,s<=0))throw new Error(ju(l));e=Ps(l),i=xi(l),r=t.getFn}return{path:e,id:i,weight:s,src:n,getFn:r}}function Ps(t){return ut(t)?t:t.split(".")}function xi(t){return ut(t)?t.join("."):t}function Uu(t,e){let i=[],n=!1;const s=(r,l,o)=>{if(He(r))if(!l[o])i.push(r);else{let a=l[o];const c=r[a];if(!He(c))return;if(o===l.length-1&&(it(c)||rl(c)||Lu(c)))i.push(Pu(c));else if(ut(c)){n=!0;for(let u=0,f=c.length;u<f;u+=1)s(c[u],l,o+1)}else l.length&&s(c,l,o+1)}};return s(t,it(e)?e.split("."):e,0),n?i:i[0]}const Vu={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Hu={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},Bu={location:0,threshold:.6,distance:100},zu={useExtendedSearch:!1,getFn:Uu,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var le=Tt(Tt(Tt(Tt({},Hu),Vu),Bu),zu);const qu=/[^ ]+/g;function Ku(t=1,e=3){const i=new Map,n=Math.pow(10,e);return{get(s){const r=s.match(qu).length;if(i.has(r))return i.get(r);const l=1/Math.pow(r,.5*t),o=parseFloat(Math.round(l*n)/n);return i.set(r,o),o},clear(){i.clear()}}}class fn{constructor({getFn:e=le.getFn,fieldNormWeight:i=le.fieldNormWeight}={}){this.norm=Ku(i,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((i,n)=>{this._keysMap[i.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,it(this.docs[0])?this.docs.forEach((e,i)=>{this._addString(e,i)}):this.docs.forEach((e,i)=>{this._addObject(e,i)}),this.norm.clear())}add(e){const i=this.size();it(e)?this._addString(e,i):this._addObject(e,i)}removeAt(e){this.records.splice(e,1);for(let i=e,n=this.size();i<n;i+=1)this.records[i].i-=1}getValueForItemAtKeyId(e,i){return e[this._keysMap[i]]}size(){return this.records.length}_addString(e,i){if(!He(e)||Fi(e))return;let n={v:e,i,n:this.norm.get(e)};this.records.push(n)}_addObject(e,i){let n={i,$:{}};this.keys.forEach((s,r)=>{let l=s.getFn?s.getFn(e):this.getFn(e,s.path);if(He(l)){if(ut(l)){let o=[];const a=[{nestedArrIndex:-1,value:l}];for(;a.length;){const{nestedArrIndex:c,value:u}=a.pop();if(He(u))if(it(u)&&!Fi(u)){let f={v:u,i:c,n:this.norm.get(u)};o.push(f)}else ut(u)&&u.forEach((f,d)=>{a.push({nestedArrIndex:d,value:f})})}n.$[r]=o}else if(it(l)&&!Fi(l)){let o={v:l,n:this.norm.get(l)};n.$[r]=o}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function cl(t,e,{getFn:i=le.getFn,fieldNormWeight:n=le.fieldNormWeight}={}){const s=new fn({getFn:i,fieldNormWeight:n});return s.setKeys(t.map(al)),s.setSources(e),s.create(),s}function xu(t,{getFn:e=le.getFn,fieldNormWeight:i=le.fieldNormWeight}={}){const{keys:n,records:s}=t,r=new fn({getFn:e,fieldNormWeight:i});return r.setKeys(n),r.setIndexRecords(s),r}function li(t,{errors:e=0,currentLocation:i=0,expectedLocation:n=0,distance:s=le.distance,ignoreLocation:r=le.ignoreLocation}={}){const l=e/t.length;if(r)return l;const o=Math.abs(n-i);return s?l+o/s:o?1:l}function Wu(t=[],e=le.minMatchCharLength){let i=[],n=-1,s=-1,r=0;for(let l=t.length;r<l;r+=1){let o=t[r];o&&n===-1?n=r:!o&&n!==-1&&(s=r-1,s-n+1>=e&&i.push([n,s]),n=-1)}return t[r-1]&&r-n>=e&&i.push([n,r-1]),i}const kt=32;function Gu(t,e,i,{location:n=le.location,distance:s=le.distance,threshold:r=le.threshold,findAllMatches:l=le.findAllMatches,minMatchCharLength:o=le.minMatchCharLength,includeMatches:a=le.includeMatches,ignoreLocation:c=le.ignoreLocation}={}){if(e.length>kt)throw new Error(Nu(kt));const u=e.length,f=t.length,d=Math.max(0,Math.min(n,f));let h=r,m=d;const g=o>1||a,v=g?Array(f):[];let w;for(;(w=t.indexOf(e,m))>-1;){let F=li(e,{currentLocation:w,expectedLocation:d,distance:s,ignoreLocation:c});if(h=Math.min(F,h),m=w+u,g){let E=0;for(;E<u;)v[w+E]=1,E+=1}}m=-1;let O=[],L=1,C=u+f;const T=1<<u-1;for(let F=0;F<u;F+=1){let E=0,P=C;for(;E<P;)li(e,{errors:F,currentLocation:d+P,expectedLocation:d,distance:s,ignoreLocation:c})<=h?E=P:C=P,P=Math.floor((C-E)/2+E);C=P;let G=Math.max(1,d-P+1),ee=l?f:Math.min(d+P,f)+u,M=Array(ee+2);M[ee+1]=(1<<F)-1;for(let z=ee;z>=G;z-=1){let q=z-1,U=i[t.charAt(q)];if(g&&(v[q]=+!!U),M[z]=(M[z+1]<<1|1)&U,F&&(M[z]|=(O[z+1]|O[z])<<1|1|O[z+1]),M[z]&T&&(L=li(e,{errors:F,currentLocation:q,expectedLocation:d,distance:s,ignoreLocation:c}),L<=h)){if(h=L,m=q,m<=d)break;G=Math.max(1,2*d-m)}}if(li(e,{errors:F+1,currentLocation:d,expectedLocation:d,distance:s,ignoreLocation:c})>h)break;O=M}const $={isMatch:m>=0,score:Math.max(.001,L)};if(g){const F=Wu(v,o);F.length?a&&($.indices=F):$.isMatch=!1}return $}function Yu(t){let e={};for(let i=0,n=t.length;i<n;i+=1){const s=t.charAt(i);e[s]=(e[s]||0)|1<<n-i-1}return e}class ul{constructor(e,{location:i=le.location,threshold:n=le.threshold,distance:s=le.distance,includeMatches:r=le.includeMatches,findAllMatches:l=le.findAllMatches,minMatchCharLength:o=le.minMatchCharLength,isCaseSensitive:a=le.isCaseSensitive,ignoreLocation:c=le.ignoreLocation}={}){if(this.options={location:i,threshold:n,distance:s,includeMatches:r,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(d,h)=>{this.chunks.push({pattern:d,alphabet:Yu(d),startIndex:h})},f=this.pattern.length;if(f>kt){let d=0;const h=f%kt,m=f-h;for(;d<m;)u(this.pattern.substr(d,kt),d),d+=kt;if(h){const g=f-kt;u(this.pattern.substr(g),g)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:i,includeMatches:n}=this.options;if(i||(e=e.toLowerCase()),this.pattern===e){let m={isMatch:!0,score:0};return n&&(m.indices=[[0,e.length-1]]),m}const{location:s,distance:r,threshold:l,findAllMatches:o,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],f=0,d=!1;this.chunks.forEach(({pattern:m,alphabet:g,startIndex:v})=>{const{isMatch:w,score:O,indices:L}=Gu(e,m,g,{location:s+v,distance:r,threshold:l,findAllMatches:o,minMatchCharLength:a,includeMatches:n,ignoreLocation:c});w&&(d=!0),f+=O,w&&L&&(u=[...u,...L])});let h={isMatch:d,score:d?f/this.chunks.length:1};return d&&n&&(h.indices=u),h}}class bt{constructor(e){this.pattern=e}static isMultiMatch(e){return Ls(e,this.multiRegex)}static isSingleMatch(e){return Ls(e,this.singleRegex)}search(){}}function Ls(t,e){const i=t.match(e);return i?i[1]:null}class Ju extends bt{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const i=e===this.pattern;return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}}class Xu extends bt{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class Qu extends bt{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const i=e.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}}class Zu extends bt{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const i=!e.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class ef extends bt{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const i=e.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class tf extends bt{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const i=!e.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class fl extends bt{constructor(e,{location:i=le.location,threshold:n=le.threshold,distance:s=le.distance,includeMatches:r=le.includeMatches,findAllMatches:l=le.findAllMatches,minMatchCharLength:o=le.minMatchCharLength,isCaseSensitive:a=le.isCaseSensitive,ignoreLocation:c=le.ignoreLocation}={}){super(e),this._bitapSearch=new ul(e,{location:i,threshold:n,distance:s,includeMatches:r,findAllMatches:l,minMatchCharLength:o,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class dl extends bt{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let i=0,n;const s=[],r=this.pattern.length;for(;(n=e.indexOf(this.pattern,i))>-1;)i=n+r,s.push([n,i-1]);const l=!!s.length;return{isMatch:l,score:l?0:1,indices:s}}}const Wi=[Ju,dl,Qu,Zu,tf,ef,Xu,fl],Ms=Wi.length,nf=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,sf="|";function rf(t,e={}){return t.split(sf).map(i=>{let n=i.trim().split(nf).filter(r=>r&&!!r.trim()),s=[];for(let r=0,l=n.length;r<l;r+=1){const o=n[r];let a=!1,c=-1;for(;!a&&++c<Ms;){const u=Wi[c];let f=u.isMultiMatch(o);f&&(s.push(new u(f,e)),a=!0)}if(!a)for(c=-1;++c<Ms;){const u=Wi[c];let f=u.isSingleMatch(o);if(f){s.push(new u(f,e));break}}}return s})}const lf=new Set([fl.type,dl.type]);class of{constructor(e,{isCaseSensitive:i=le.isCaseSensitive,includeMatches:n=le.includeMatches,minMatchCharLength:s=le.minMatchCharLength,ignoreLocation:r=le.ignoreLocation,findAllMatches:l=le.findAllMatches,location:o=le.location,threshold:a=le.threshold,distance:c=le.distance}={}){this.query=null,this.options={isCaseSensitive:i,includeMatches:n,minMatchCharLength:s,findAllMatches:l,ignoreLocation:r,location:o,threshold:a,distance:c},this.pattern=i?e:e.toLowerCase(),this.query=rf(this.pattern,this.options)}static condition(e,i){return i.useExtendedSearch}searchIn(e){const i=this.query;if(!i)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:s}=this.options;e=s?e:e.toLowerCase();let r=0,l=[],o=0;for(let a=0,c=i.length;a<c;a+=1){const u=i[a];l.length=0,r=0;for(let f=0,d=u.length;f<d;f+=1){const h=u[f],{isMatch:m,indices:g,score:v}=h.search(e);if(m){if(r+=1,o+=v,n){const w=h.constructor.type;lf.has(w)?l=[...l,...g]:l.push(g)}}else{o=0,r=0,l.length=0;break}}if(r){let f={isMatch:!0,score:o/r};return n&&(f.indices=l),f}}return{isMatch:!1,score:1}}}const Gi=[];function af(...t){Gi.push(...t)}function Yi(t,e){for(let i=0,n=Gi.length;i<n;i+=1){let s=Gi[i];if(s.condition(t,e))return new s(t,e)}return new ul(t,e)}const _i={AND:"$and",OR:"$or"},Ji={PATH:"$path",PATTERN:"$val"},Xi=t=>!!(t[_i.AND]||t[_i.OR]),cf=t=>!!t[Ji.PATH],uf=t=>!ut(t)&&ll(t)&&!Xi(t),Rs=t=>({[_i.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function hl(t,e,{auto:i=!0}={}){const n=s=>{let r=Object.keys(s);const l=cf(s);if(!l&&r.length>1&&!Xi(s))return n(Rs(s));if(uf(s)){const a=l?s[Ji.PATH]:r[0],c=l?s[Ji.PATTERN]:s[a];if(!it(c))throw new Error(Du(a));const u={keyId:xi(a),pattern:c};return i&&(u.searcher=Yi(c,e)),u}let o={children:[],operator:r[0]};return r.forEach(a=>{const c=s[a];ut(c)&&c.forEach(u=>{o.children.push(n(u))})}),o};return Xi(t)||(t=Rs(t)),n(t)}function ff(t,{ignoreFieldNorm:e=le.ignoreFieldNorm}){t.forEach(i=>{let n=1;i.matches.forEach(({key:s,norm:r,score:l})=>{const o=s?s.weight:null;n*=Math.pow(l===0&&o?Number.EPSILON:l,(o||1)*(e?1:r))}),i.score=n})}function df(t,e){const i=t.matches;e.matches=[],He(i)&&i.forEach(n=>{if(!He(n.indices)||!n.indices.length)return;const{indices:s,value:r}=n;let l={indices:s,value:r};n.key&&(l.key=n.key.src),n.idx>-1&&(l.refIndex=n.idx),e.matches.push(l)})}function hf(t,e){e.score=t.score}function pf(t,e,{includeMatches:i=le.includeMatches,includeScore:n=le.includeScore}={}){const s=[];return i&&s.push(df),n&&s.push(hf),t.map(r=>{const{idx:l}=r,o={item:e[l],refIndex:l};return s.length&&s.forEach(a=>{a(r,o)}),o})}class Vt{constructor(e,i={},n){this.options=Tt(Tt({},le),i),this.options.useExtendedSearch,this._keyStore=new Fu(this.options.keys),this.setCollection(e,n)}setCollection(e,i){if(this._docs=e,i&&!(i instanceof fn))throw new Error(Ru);this._myIndex=i||cl(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){He(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const i=[];for(let n=0,s=this._docs.length;n<s;n+=1){const r=this._docs[n];e(r,n)&&(this.removeAt(n),n-=1,s-=1,i.push(r))}return i}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:i=-1}={}){const{includeMatches:n,includeScore:s,shouldSort:r,sortFn:l,ignoreFieldNorm:o}=this.options;let a=it(e)?it(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return ff(a,{ignoreFieldNorm:o}),r&&a.sort(l),rl(i)&&i>-1&&(a=a.slice(0,i)),pf(a,this._docs,{includeMatches:n,includeScore:s})}_searchStringList(e){const i=Yi(e,this.options),{records:n}=this._myIndex,s=[];return n.forEach(({v:r,i:l,n:o})=>{if(!He(r))return;const{isMatch:a,score:c,indices:u}=i.searchIn(r);a&&s.push({item:r,idx:l,matches:[{score:c,value:r,norm:o,indices:u}]})}),s}_searchLogical(e){const i=hl(e,this.options),n=(o,a,c)=>{if(!o.children){const{keyId:f,searcher:d}=o,h=this._findMatches({key:this._keyStore.get(f),value:this._myIndex.getValueForItemAtKeyId(a,f),searcher:d});return h&&h.length?[{idx:c,item:a,matches:h}]:[]}const u=[];for(let f=0,d=o.children.length;f<d;f+=1){const h=o.children[f],m=n(h,a,c);if(m.length)u.push(...m);else if(o.operator===_i.AND)return[]}return u},s=this._myIndex.records,r={},l=[];return s.forEach(({$:o,i:a})=>{if(He(o)){let c=n(i,o,a);c.length&&(r[a]||(r[a]={idx:a,item:o,matches:[]},l.push(r[a])),c.forEach(({matches:u})=>{r[a].matches.push(...u)}))}}),l}_searchObjectList(e){const i=Yi(e,this.options),{keys:n,records:s}=this._myIndex,r=[];return s.forEach(({$:l,i:o})=>{if(!He(l))return;let a=[];n.forEach((c,u)=>{a.push(...this._findMatches({key:c,value:l[u],searcher:i}))}),a.length&&r.push({idx:o,item:l,matches:a})}),r}_findMatches({key:e,value:i,searcher:n}){if(!He(i))return[];let s=[];if(ut(i))i.forEach(({v:r,i:l,n:o})=>{if(!He(r))return;const{isMatch:a,score:c,indices:u}=n.searchIn(r);a&&s.push({score:c,key:e,value:r,idx:l,norm:o,indices:u})});else{const{v:r,n:l}=i,{isMatch:o,score:a,indices:c}=n.searchIn(r);o&&s.push({score:a,key:e,value:r,norm:l,indices:c})}return s}}Vt.version="7.0.0";Vt.createIndex=cl;Vt.parseIndex=xu;Vt.config=le;Vt.parseQuery=hl;af(of);var mf=function(){function t(e){this._haystack=[],this._fuseOptions=Ve(Ve({},e.fuseOptions),{keys:Yc([],e.searchFields,!0),includeMatches:!0})}return t.prototype.index=function(e){this._haystack=e,this._fuse&&this._fuse.setCollection(e)},t.prototype.reset=function(){this._haystack=[],this._fuse=void 0},t.prototype.isEmptyIndex=function(){return!this._haystack.length},t.prototype.search=function(e){this._fuse||(this._fuse=new Vt(this._haystack,this._fuseOptions));var i=this._fuse.search(e);return i.map(function(n,s){return{item:n.item,score:n.score||0,rank:s+1}})},t}();function gf(t){return new mf(t)}var _f=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},Ui=function(t,e,i){var n=t.dataset,s=e.customProperties,r=e.labelClass,l=e.labelDescription;r&&(n.labelClass=Ei(r).join(" ")),l&&(n.labelDescription=l),i&&s&&(typeof s=="string"?n.customProperties=s:typeof s=="object"&&!_f(s)&&(n.customProperties=JSON.stringify(s)))},Ds=function(t,e,i){var n=e&&t.querySelector("label[for='".concat(e,"']")),s=n&&n.innerText;s&&i.setAttribute("aria-label",s)},vf={containerOuter:function(t,e,i,n,s,r,l){var o=t.classNames.containerOuter,a=document.createElement("div");return ae(a,o),a.dataset.type=r,e&&(a.dir=e),n&&(a.tabIndex=0),i&&(a.setAttribute("role",s?"combobox":"listbox"),s?a.setAttribute("aria-autocomplete","list"):l||Ds(this._docRoot,this.passedElement.element.id,a),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false")),l&&a.setAttribute("aria-labelledby",l),a},containerInner:function(t){var e=t.classNames.containerInner,i=document.createElement("div");return ae(i,e),i},itemList:function(t,e){var i=t.searchEnabled,n=t.classNames,s=n.list,r=n.listSingle,l=n.listItems,o=document.createElement("div");return ae(o,s),ae(o,e?r:l),this._isSelectElement&&i&&o.setAttribute("role","listbox"),o},placeholder:function(t,e){var i=t.allowHTML,n=t.classNames.placeholder,s=document.createElement("div");return ae(s,n),rt(s,i,e),s},item:function(t,e,i){var n=t.allowHTML,s=t.removeItemButtonAlignLeft,r=t.removeItemIconText,l=t.removeItemLabelText,o=t.classNames,a=o.item,c=o.button,u=o.highlightedState,f=o.itemSelectable,d=o.placeholder,h=St(e.value),m=document.createElement("div");if(ae(m,a),e.labelClass){var g=document.createElement("span");rt(g,n,e.label),ae(g,e.labelClass),m.appendChild(g)}else rt(m,n,e.label);if(m.dataset.item="",m.dataset.id=e.id,m.dataset.value=h,Ui(m,e,!0),(e.disabled||this.containerOuter.isDisabled)&&m.setAttribute("aria-disabled","true"),this._isSelectElement&&(m.setAttribute("aria-selected","true"),m.setAttribute("role","option")),e.placeholder&&(ae(m,d),m.dataset.placeholder=""),ae(m,e.highlighted?u:f),i){e.disabled&&tt(m,f),m.dataset.deletable="";var v=document.createElement("button");v.type="button",ae(v,c),rt(v,!0,Gt(r,e.value));var w=Gt(l,e.value);w&&v.setAttribute("aria-label",w),v.dataset.button="",s?m.insertAdjacentElement("afterbegin",v):m.appendChild(v)}return m},choiceList:function(t,e){var i=t.classNames.list,n=document.createElement("div");return ae(n,i),e||n.setAttribute("aria-multiselectable","true"),n.setAttribute("role","listbox"),n},choiceGroup:function(t,e){var i=t.allowHTML,n=t.classNames,s=n.group,r=n.groupHeading,l=n.itemDisabled,o=e.id,a=e.label,c=e.disabled,u=St(a),f=document.createElement("div");ae(f,s),c&&ae(f,l),f.setAttribute("role","group"),f.dataset.group="",f.dataset.id=o,f.dataset.value=u,c&&f.setAttribute("aria-disabled","true");var d=document.createElement("div");return ae(d,r),rt(d,i,a||""),f.appendChild(d),f},choice:function(t,e,i,n){var s=t.allowHTML,r=t.classNames,l=r.item,o=r.itemChoice,a=r.itemSelectable,c=r.selectedState,u=r.itemDisabled,f=r.description,d=r.placeholder,h=e.label,m=St(e.value),g=document.createElement("div");g.id=e.elementId,ae(g,l),ae(g,o),n&&typeof h=="string"&&(h=un(s,h),h+=" (".concat(n,")"),h={trusted:h});var v=g;if(e.labelClass){var w=document.createElement("span");rt(w,s,h),ae(w,e.labelClass),v=w,g.appendChild(w)}else rt(g,s,h);if(e.labelDescription){var O="".concat(e.elementId,"-description");v.setAttribute("aria-describedby",O);var L=document.createElement("span");rt(L,s,e.labelDescription),L.id=O,ae(L,f),g.appendChild(L)}return e.selected&&ae(g,c),e.placeholder&&ae(g,d),g.setAttribute("role",e.group?"treeitem":"option"),g.dataset.choice="",g.dataset.id=e.id,g.dataset.value=m,i&&(g.dataset.selectText=i),e.group&&(g.dataset.groupId="".concat(e.group.id)),Ui(g,e,!1),e.disabled?(ae(g,u),g.dataset.choiceDisabled="",g.setAttribute("aria-disabled","true")):(ae(g,a),g.dataset.choiceSelectable=""),g},input:function(t,e){var i=t.classNames,n=i.input,s=i.inputCloned,r=t.labelId,l=document.createElement("input");return l.type="search",ae(l,n),ae(l,s),l.autocomplete="off",l.autocapitalize="off",l.spellcheck=!1,l.setAttribute("aria-autocomplete","list"),e?l.setAttribute("aria-label",e):r||Ds(this._docRoot,this.passedElement.element.id,l),l},dropdown:function(t){var e=t.classNames,i=e.list,n=e.listDropdown,s=document.createElement("div");return ae(s,i),ae(s,n),s.setAttribute("aria-expanded","false"),s},notice:function(t,e,i){var n=t.classNames,s=n.item,r=n.itemChoice,l=n.addChoice,o=n.noResults,a=n.noChoices,c=n.notice;i===void 0&&(i=Le.generic);var u=document.createElement("div");switch(rt(u,!0,e),ae(u,s),ae(u,r),ae(u,c),i){case Le.addChoice:ae(u,l);break;case Le.noResults:ae(u,o);break;case Le.noChoices:ae(u,a);break}return i===Le.addChoice&&(u.dataset.choiceSelectable="",u.dataset.choice=""),u},option:function(t){var e=St(t.label),i=new Option(e,t.value,!1,t.selected);return Ui(i,t,!0),i.disabled=t.disabled,t.selected&&i.setAttribute("selected",""),i}},bf="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,yf={},Vi=function(t){if(t)return t.dataset.id?parseInt(t.dataset.id,10):void 0},xt="[data-choice-selectable]",wf=function(){function t(e,i){e===void 0&&(e="[data-choice]"),i===void 0&&(i={});var n=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var s=t.defaults;this.config=Ve(Ve(Ve({},s.allOptions),s.options),i),Jc.forEach(function(w){n.config[w]=Ve(Ve(Ve({},s.allOptions[w]),s.options[w]),i[w])});var r=this.config;r.silent||this._validateConfig();var l=r.shadowRoot||document.documentElement;this._docRoot=l;var o=typeof e=="string"?l.querySelector(e):e;if(!o||typeof o!="object"||!(gu(o)||sl(o)))throw TypeError(!o&&typeof e=="string"?"Selector ".concat(e," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var a=o.type,c=a===pt.Text;(c||r.maxItemCount!==1)&&(r.singleModeForMultiSelect=!1),r.singleModeForMultiSelect&&(a=pt.SelectMultiple);var u=a===pt.SelectOne,f=a===pt.SelectMultiple,d=u||f;if(this._elementType=a,this._isTextElement=c,this._isSelectOneElement=u,this._isSelectMultipleElement=f,this._isSelectElement=u||f,this._canAddUserChoices=c&&r.addItems||d&&r.addChoices,typeof r.renderSelectedChoices!="boolean"&&(r.renderSelectedChoices=r.renderSelectedChoices==="always"||u),r.closeDropdownOnSelect==="auto"?r.closeDropdownOnSelect=c||u||r.singleModeForMultiSelect:r.closeDropdownOnSelect=Wt(r.closeDropdownOnSelect),r.placeholder&&(r.placeholderValue?this._hasNonChoicePlaceholder=!0:o.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,r.placeholderValue=o.dataset.placeholder)),i.addItemFilter&&typeof i.addItemFilter!="function"){var h=i.addItemFilter instanceof RegExp?i.addItemFilter:new RegExp(i.addItemFilter);r.addItemFilter=h.test.bind(h)}if(this._isTextElement)this.passedElement=new mu({element:o,classNames:r.classNames});else{var m=o;this.passedElement=new bu({element:m,classNames:r.classNames,template:function(w){return n._templates.option(w)},extractPlaceholder:r.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Eu(r),this._currentValue="",r.searchEnabled=!c&&r.searchEnabled||f,this._canSearch=r.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=iu(o,"choices-"),this._direction=o.dir,!this._direction){var g=window.getComputedStyle(o).direction,v=window.getComputedStyle(document.documentElement).direction;g!==v&&(this._direction=g)}if(this._idNames={itemChoice:"item-choice"},this._templates=s.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){r.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(w){return w.value})}return Object.defineProperty(t,"defaults",{get:function(){return Object.preventExtensions({get options(){return yf},get allOptions(){return Cs},get templates(){return vf}})},enumerable:!1,configurable:!0}),t.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=gf(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var e=this.config.callbackOnInit;typeof e=="function"&&e.call(this)}},t.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=t.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},t.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},t.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},t.prototype.highlightItem=function(e,i){if(i===void 0&&(i=!0),!e||!e.id)return this;var n=this._store.items.find(function(s){return s.id===e.id});return!n||n.highlighted?this:(this._store.dispatch(ri(n,!0)),i&&this.passedElement.triggerEvent(Ue.highlightItem,this._getChoiceForOutput(n)),this)},t.prototype.unhighlightItem=function(e,i){if(i===void 0&&(i=!0),!e||!e.id)return this;var n=this._store.items.find(function(s){return s.id===e.id});return!n||!n.highlighted?this:(this._store.dispatch(ri(n,!1)),i&&this.passedElement.triggerEvent(Ue.unhighlightItem,this._getChoiceForOutput(n)),this)},t.prototype.highlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(i){i.highlighted||(e._store.dispatch(ri(i,!0)),e.passedElement.triggerEvent(Ue.highlightItem,e._getChoiceForOutput(i)))})}),this},t.prototype.unhighlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(i){i.highlighted&&(e._store.dispatch(ri(i,!1)),e.passedElement.triggerEvent(Ue.highlightItem,e._getChoiceForOutput(i)))})}),this},t.prototype.removeActiveItemsByValue=function(e){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(n){return n.value===e}).forEach(function(n){return i._removeItem(n)})}),this},t.prototype.removeActiveItems=function(e){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(n){var s=n.id;return s!==e}).forEach(function(n){return i._removeItem(n)})}),this},t.prototype.removeHighlightedItems=function(e){var i=this;return e===void 0&&(e=!1),this._store.withTxn(function(){i._store.highlightedActiveItems.forEach(function(n){i._removeItem(n),e&&i._triggerChange(n.value)})}),this},t.prototype.showDropdown=function(e){var i=this;return this.dropdown.isActive?this:(e===void 0&&(e=!this._canSearch),requestAnimationFrame(function(){i.dropdown.show();var n=i.dropdown.element.getBoundingClientRect();i.containerOuter.open(n.bottom,n.height),e||i.input.focus(),i.passedElement.triggerEvent(Ue.showDropdown)}),this)},t.prototype.hideDropdown=function(e){var i=this;return this.dropdown.isActive?(requestAnimationFrame(function(){i.dropdown.hide(),i.containerOuter.close(),!e&&i._canSearch&&(i.input.removeActiveDescendant(),i.input.blur()),i.passedElement.triggerEvent(Ue.hideDropdown)}),this):this},t.prototype.getValue=function(e){var i=this,n=this._store.items.map(function(s){return e?s.value:i._getChoiceForOutput(s)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?n[0]:n},t.prototype.setValue=function(e){var i=this;return this.initialisedOK?(this._store.withTxn(function(){e.forEach(function(n){n&&i._addChoice(et(n,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},t.prototype.setChoiceByValue=function(e){var i=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var n=Array.isArray(e)?e:[e];n.forEach(function(s){return i._findAndSelectChoiceByValue(s)}),i.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},t.prototype.setChoices=function(e,i,n,s,r,l){var o=this;if(e===void 0&&(e=[]),i===void 0&&(i="value"),n===void 0&&(n="label"),s===void 0&&(s=!1),r===void 0&&(r=!0),l===void 0&&(l=!1),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof i!="string"||!i)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(typeof e=="function"){var a=e(this);if(typeof Promise=="function"&&a instanceof Promise)return new Promise(function(c){return requestAnimationFrame(c)}).then(function(){return o._handleLoadingState(!0)}).then(function(){return a}).then(function(c){return o.setChoices(c,i,n,s,r,l)}).catch(function(c){o.config.silent||console.error(c)}).then(function(){return o._handleLoadingState(!1)}).then(function(){return o});if(!Array.isArray(a))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof a));return this.setChoices(a,i,n,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){r&&(o._isSearching=!1),s&&o.clearChoices(!0,l);var c=i==="value",u=n==="label";e.forEach(function(f){if("choices"in f){var d=f;u||(d=Ve(Ve({},d),{label:d[n]})),o._addGroup(et(d,!0))}else{var h=f;(!u||!c)&&(h=Ve(Ve({},h),{value:h[i],label:h[n]}));var m=et(h,!1);o._addChoice(m),m.placeholder&&!o._hasNonChoicePlaceholder&&(o._placeholderValue=tl(m.label))}}),o.unhighlightAll()}),this._searcher.reset(),this},t.prototype.refresh=function(e,i,n){var s=this;return e===void 0&&(e=!1),i===void 0&&(i=!1),n===void 0&&(n=!1),this._isSelectElement?(this._store.withTxn(function(){var r=s.passedElement.optionsAsChoices(),l={};n||s._store.items.forEach(function(a){a.id&&a.active&&a.selected&&(l[a.value]=!0)}),s.clearStore(!1);var o=function(a){n?s._store.dispatch(ys(a)):l[a.value]&&(a.selected=!0)};r.forEach(function(a){if("choices"in a){a.choices.forEach(o);return}o(a)}),s._addPredefinedChoices(r,i,e),s._isSearching&&s._searchChoices(s.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},t.prototype.removeChoice=function(e){var i=this._store.choices.find(function(n){return n.value===e});return i?(this._clearNotice(),this._store.dispatch(Xc(i)),this._searcher.reset(),i.selected&&this.passedElement.triggerEvent(Ue.removeItem,this._getChoiceForOutput(i)),this):this},t.prototype.clearChoices=function(e,i){var n=this;return e===void 0&&(e=!0),i===void 0&&(i=!1),e&&(i?this.passedElement.element.replaceChildren(""):this.passedElement.element.querySelectorAll(":not([selected])").forEach(function(s){s.remove()})),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.withTxn(function(){var s=i?[]:n._store.items;n._store.reset(),s.forEach(function(r){n._store.dispatch(vs(r)),n._store.dispatch(bs(r))})}),this._searcher.reset(),this},t.prototype.clearStore=function(e){return e===void 0&&(e=!0),this.clearChoices(e,!0),this._stopSearch(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this},t.prototype.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),this._stopSearch(),this},t.prototype._validateConfig=function(){var e=this.config,i=cu(e,Cs);i.length&&console.warn("Unknown config option(s) passed",i.join(", ")),e.allowHTML&&e.allowHtmlUserInput&&(e.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),e.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},t.prototype._render=function(e){e===void 0&&(e={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(e.choices||e.groups)&&this._renderChoices(),e.items&&this._renderItems())},t.prototype._renderChoices=function(){var e=this;if(this._canAddItems()){var i=this,n=i.config,s=i._isSearching,r=this._store,l=r.activeGroups,o=r.activeChoices,a=0;if(s&&n.searchResultLimit>0?a=n.searchResultLimit:n.renderChoiceLimit>0&&(a=n.renderChoiceLimit),this._isSelectElement){var c=o.filter(function(m){return!m.element});c.length&&this.passedElement.addOptions(c)}var u=document.createDocumentFragment(),f=function(m){return m.filter(function(g){return!g.placeholder&&(s?!!g.rank:n.renderSelectedChoices||!g.selected)})},d=!1,h=function(m,g,v){s?m.sort(ou):n.shouldSort&&m.sort(n.sorter);var w=m.length;w=!g&&a&&w>a?a:w,w--,m.every(function(O,L){var C=O.choiceEl||e._templates.choice(n,O,n.itemSelectText,v);return O.choiceEl=C,u.appendChild(C),(s||!O.selected)&&(d=!0),L<w})};o.length&&(n.resetScrollPosition&&requestAnimationFrame(function(){return e.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!s&&this._isSelectOneElement&&h(o.filter(function(m){return m.placeholder&&!m.group}),!1,void 0),l.length&&!s?(n.shouldSort&&l.sort(n.sorter),h(o.filter(function(m){return!m.placeholder&&!m.group}),!1,void 0),l.forEach(function(m){var g=f(m.choices);if(g.length){if(m.label){var v=m.groupEl||e._templates.choiceGroup(e.config,m);m.groupEl=v,v.remove(),u.appendChild(v)}h(g,!0,n.appendGroupInSearch&&s?m.label:void 0)}})):h(f(o),!1,void 0)),!d&&(s||!u.children.length||!n.renderSelectedChoices)&&(this._notice||(this._notice={text:ks(s?n.noResultsText:n.noChoicesText),type:s?Le.noResults:Le.noChoices}),u.replaceChildren("")),this._renderNotice(u),this.choiceList.element.replaceChildren(u),d&&this._highlightChoice()}},t.prototype._renderItems=function(){var e=this,i=this._store.items||[],n=this.itemList.element,s=this.config,r=document.createDocumentFragment(),l=function(f){return n.querySelector('[data-item][data-id="'.concat(f.id,'"]'))},o=function(f){var d=f.itemEl;d&&d.parentElement||(d=l(f)||e._templates.item(s,f,s.removeItemButton),f.itemEl=d,r.appendChild(d))};i.forEach(o);var a=!!r.childNodes.length;if(this._isSelectOneElement){var c=n.children.length;if(a||c>1){var u=n.querySelector(Kt(s.classNames.placeholder));u&&u.remove()}else!a&&!c&&this._placeholderValue&&(a=!0,o(et({selected:!0,value:"",label:this._placeholderValue,placeholder:!0},!1)))}a&&(n.append(r),s.shouldSortItems&&!this._isSelectOneElement&&(i.sort(s.sorter),i.forEach(function(f){var d=l(f);d&&(d.remove(),r.append(d))}),n.append(r))),this._isTextElement&&(this.passedElement.value=i.map(function(f){var d=f.value;return d}).join(s.delimiter))},t.prototype._displayNotice=function(e,i,n){n===void 0&&(n=!0);var s=this._notice;if(s&&(s.type===i&&s.text===e||s.type===Le.addChoice&&(i===Le.noResults||i===Le.noChoices))){n&&this.showDropdown(!0);return}this._clearNotice(),this._notice=e?{text:e,type:i}:void 0,this._renderNotice(),n&&e&&this.showDropdown(!0)},t.prototype._clearNotice=function(){if(this._notice){var e=this.choiceList.element.querySelector(Kt(this.config.classNames.notice));e&&e.remove(),this._notice=void 0}},t.prototype._renderNotice=function(e){var i=this._notice;if(i){var n=this._templates.notice(this.config,i.text,i.type);e?e.append(n):this.choiceList.prepend(n)}},t.prototype._getChoiceForOutput=function(e,i){return{id:e.id,highlighted:e.highlighted,labelClass:e.labelClass,labelDescription:e.labelDescription,customProperties:e.customProperties,disabled:e.disabled,active:e.active,label:e.label,placeholder:e.placeholder,value:e.value,groupValue:e.group?e.group.label:void 0,element:e.element,keyCode:i}},t.prototype._triggerChange=function(e){e!=null&&this.passedElement.triggerEvent(Ue.change,{value:e})},t.prototype._handleButtonAction=function(e){var i=this,n=this._store.items;if(!(!n.length||!this.config.removeItems||!this.config.removeItemButton)){var s=e&&Vi(e.parentElement),r=s&&n.find(function(l){return l.id===s});r&&this._store.withTxn(function(){if(i._removeItem(r),i._triggerChange(r.value),i._isSelectOneElement&&!i._hasNonChoicePlaceholder){var l=(i.config.shouldSort?i._store.choices.reverse():i._store.choices).find(function(o){return o.placeholder});l&&(i._addItem(l),i.unhighlightAll(),l.value&&i._triggerChange(l.value))}})}},t.prototype._handleItemAction=function(e,i){var n=this;i===void 0&&(i=!1);var s=this._store.items;if(!(!s.length||!this.config.removeItems||this._isSelectOneElement)){var r=Vi(e);r&&(s.forEach(function(l){l.id===r&&!l.highlighted?n.highlightItem(l):!i&&l.highlighted&&n.unhighlightItem(l)}),this.input.focus())}},t.prototype._handleChoiceAction=function(e){var i=this,n=Vi(e),s=n&&this._store.getChoiceById(n);if(!s||s.disabled)return!1;var r=this.dropdown.isActive;if(!s.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){i._addItem(s,!0,!0),i.clearInput(),i.unhighlightAll()}),this._triggerChange(s.value)}return r&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},t.prototype._handleBackspace=function(e){var i=this.config;if(!(!i.removeItems||!e.length)){var n=e[e.length-1],s=e.some(function(r){return r.highlighted});i.editItems&&!s&&n?(this.input.value=n.value,this.input.setWidth(),this._removeItem(n),this._triggerChange(n.value)):(s||this.highlightItem(n,!1),this.removeHighlightedItems(!0))}},t.prototype._loadChoices=function(){var e,i=this,n=this.config;if(this._isTextElement){if(this._presetChoices=n.items.map(function(l){return et(l,!1)}),this.passedElement.value){var s=this.passedElement.value.split(n.delimiter).map(function(l){return et(l,!1,i.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(s)}this._presetChoices.forEach(function(l){l.selected=!0})}else if(this._isSelectElement){this._presetChoices=n.choices.map(function(l){return et(l,!0)});var r=this.passedElement.optionsAsChoices();r&&(e=this._presetChoices).push.apply(e,r)}},t.prototype._handleLoadingState=function(e){e===void 0&&(e=!0);var i=this.itemList.element;e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?i.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(i.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},t.prototype._handleSearch=function(e){if(this.input.isFocussed)if(e!==null&&typeof e<"u"&&e.length>=this.config.searchFloor){var i=this.config.searchChoices?this._searchChoices(e):0;i!==null&&this.passedElement.triggerEvent(Ue.search,{value:e,resultCount:i})}else this._store.choices.some(function(n){return!n.active})&&this._stopSearch()},t.prototype._canAddItems=function(){var e=this.config,i=e.maxItemCount,n=e.maxItemText;return!e.singleModeForMultiSelect&&i>0&&i<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof n=="function"?n(i):n,Le.addChoice),!1):(this._notice&&this._notice.type===Le.addChoice&&this._clearNotice(),!0)},t.prototype._canCreateItem=function(e){var i=this.config,n=!0,s="";if(n&&typeof i.addItemFilter=="function"&&!i.addItemFilter(e)&&(n=!1,s=Gt(i.customAddItemText,e)),n){var r=this._store.choices.find(function(l){return i.valueComparer(l.value,e)});if(r){if(this._isSelectElement)return this._displayNotice("",Le.addChoice),!1;i.duplicateItemsAllowed||(n=!1,s=Gt(i.uniqueItemText,e))}}return n&&(s=Gt(i.addItemText,e)),s&&this._displayNotice(s,Le.addChoice),n},t.prototype._searchChoices=function(e){var i=e.trim().replace(/\s{2,}/," ");if(!i.length||i===this._currentValue)return null;var n=this._searcher;n.isEmptyIndex()&&n.index(this._store.searchableChoices);var s=n.search(i);this._currentValue=i,this._highlightPosition=0,this._isSearching=!0;var r=this._notice,l=r&&r.type;return l!==Le.addChoice&&(s.length?this._clearNotice():this._displayNotice(ks(this.config.noResultsText),Le.noResults)),this._store.dispatch(Qc(s)),s.length},t.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(Zc(!0)),this.passedElement.triggerEvent(Ue.search,{value:"",resultCount:0}))},t.prototype._addEventListeners=function(){var e=this._docRoot,i=this.containerOuter.element,n=this.input.element;e.addEventListener("touchend",this._onTouchEnd,!0),i.addEventListener("keydown",this._onKeyDown,!0),i.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0})),n.addEventListener("keyup",this._onKeyUp,{passive:!0}),n.addEventListener("input",this._onInput,{passive:!0}),n.addEventListener("focus",this._onFocus,{passive:!0}),n.addEventListener("blur",this._onBlur,{passive:!0}),n.form&&n.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},t.prototype._removeEventListeners=function(){var e=this._docRoot,i=this.containerOuter.element,n=this.input.element;e.removeEventListener("touchend",this._onTouchEnd,!0),i.removeEventListener("keydown",this._onKeyDown,!0),i.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur)),n.removeEventListener("keyup",this._onKeyUp),n.removeEventListener("input",this._onInput),n.removeEventListener("focus",this._onFocus),n.removeEventListener("blur",this._onBlur),n.form&&n.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},t.prototype._onKeyDown=function(e){var i=e.keyCode,n=this.dropdown.isActive,s=e.key.length===1||e.key.length===2&&e.key.charCodeAt(0)>=55296||e.key==="Unidentified";switch(!this._isTextElement&&!n&&i!==De.ESC_KEY&&i!==De.TAB_KEY&&i!==De.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&s&&(this.input.value+=e.key,e.key===" "&&e.preventDefault())),i){case De.A_KEY:return this._onSelectKey(e,this.itemList.element.hasChildNodes());case De.ENTER_KEY:return this._onEnterKey(e,n);case De.ESC_KEY:return this._onEscapeKey(e,n);case De.UP_KEY:case De.PAGE_UP_KEY:case De.DOWN_KEY:case De.PAGE_DOWN_KEY:return this._onDirectionKey(e,n);case De.DELETE_KEY:case De.BACK_KEY:return this._onDeleteKey(e,this._store.items,this.input.isFocussed)}},t.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},t.prototype._onInput=function(){var e=this.input.value;if(!e){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(e),this._canAddUserChoices&&(this._canCreateItem(e),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},t.prototype._onSelectKey=function(e,i){if((e.ctrlKey||e.metaKey)&&i){this._canSearch=!1;var n=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;n&&this.highlightAll()}},t.prototype._onEnterKey=function(e,i){var n=this,s=this.input.value,r=e.target;if(e.preventDefault(),r&&r.hasAttribute("data-button")){this._handleButtonAction(r);return}if(!i){(this._isSelectElement||this._notice)&&this.showDropdown();return}var l=this.dropdown.element.querySelector(Kt(this.config.classNames.highlightedState));if(!(l&&this._handleChoiceAction(l))){if(!r||!s){this.hideDropdown(!0);return}if(this._canAddItems()){var o=!1;this._store.withTxn(function(){if(o=n._findAndSelectChoiceByValue(s,!0),!o){if(!n._canAddUserChoices||!n._canCreateItem(s))return;n._addChoice(et(s,!1,n.config.allowHtmlUserInput),!0,!0),o=!0}n.clearInput(),n.unhighlightAll()}),o&&(this._triggerChange(s),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},t.prototype._onEscapeKey=function(e,i){i&&(e.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},t.prototype._onDirectionKey=function(e,i){var n=e.keyCode;if(i||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var s=n===De.DOWN_KEY||n===De.PAGE_DOWN_KEY?1:-1,r=e.metaKey||n===De.PAGE_DOWN_KEY||n===De.PAGE_UP_KEY,l=void 0;if(r)s>0?l=this.dropdown.element.querySelector("".concat(xt,":last-of-type")):l=this.dropdown.element.querySelector(xt);else{var o=this.dropdown.element.querySelector(Kt(this.config.classNames.highlightedState));o?l=nu(o,xt,s):l=this.dropdown.element.querySelector(xt)}l&&(su(l,this.choiceList.element,s)||this.choiceList.scrollToChildElement(l,s),this._highlightChoice(l)),e.preventDefault()}},t.prototype._onDeleteKey=function(e,i,n){!this._isSelectOneElement&&!e.target.value&&n&&(this._handleBackspace(i),e.preventDefault())},t.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},t.prototype._onTouchEnd=function(e){var i=(e||e.touches[0]).target,n=this._wasTap&&this.containerOuter.element.contains(i);if(n){var s=i===this.containerOuter.element||i===this.containerInner.element;s&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()}this._wasTap=!0},t.prototype._onMouseDown=function(e){var i=e.target;if(i instanceof HTMLElement){if(bf&&this.choiceList.element.contains(i)){var n=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?e.offsetX>=n.offsetWidth:e.offsetX<n.offsetLeft}if(i!==this.input.element){var s=i.closest("[data-button],[data-item],[data-choice]");s instanceof HTMLElement&&("button"in s.dataset?this._handleButtonAction(s):"item"in s.dataset?this._handleItemAction(s,e.shiftKey):"choice"in s.dataset&&this._handleChoiceAction(s)),e.preventDefault()}}},t.prototype._onMouseOver=function(e){var i=e.target;i instanceof HTMLElement&&"choice"in i.dataset&&this._highlightChoice(i)},t.prototype._onClick=function(e){var i=e.target,n=this.containerOuter,s=n.element.contains(i);s?!this.dropdown.isActive&&!n.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),n.element.focus()):this._isSelectOneElement&&i!==this.input.element&&!this.dropdown.element.contains(i)&&this.hideDropdown():(n.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},t.prototype._onFocus=function(e){var i=e.target,n=this.containerOuter,s=i&&n.element.contains(i);if(s){var r=i===this.input.element;this._isTextElement?r&&n.addFocusState():this._isSelectMultipleElement?r&&(this.showDropdown(!0),n.addFocusState()):(n.addFocusState(),r&&this.showDropdown(!0))}},t.prototype._onBlur=function(e){var i=e.target,n=this.containerOuter,s=i&&n.element.contains(i);s&&!this._isScrollingOnIe?i===this.input.element?(n.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):i===this.containerOuter.element&&(n.removeFocusState(),this._canSearch||this.hideDropdown(!0)):(this._isScrollingOnIe=!1,this.input.element.focus())},t.prototype._onFormReset=function(){var e=this;this._store.withTxn(function(){e.clearInput(),e.hideDropdown(),e.refresh(!1,!1,!0),e._initialItems.length&&e.setChoiceByValue(e._initialItems)})},t.prototype._highlightChoice=function(e){e===void 0&&(e=null);var i=Array.from(this.dropdown.element.querySelectorAll(xt));if(i.length){var n=e,s=this.config.classNames.highlightedState,r=Array.from(this.dropdown.element.querySelectorAll(Kt(s)));r.forEach(function(l){tt(l,s),l.setAttribute("aria-selected","false")}),n?this._highlightPosition=i.indexOf(n):(i.length>this._highlightPosition?n=i[this._highlightPosition]:n=i[i.length-1],n||(n=i[0])),ae(n,s),n.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(Ue.highlightChoice,{el:n}),this.dropdown.isActive&&(this.input.setActiveDescendant(n.id),this.containerOuter.setActiveDescendant(n.id))}},t.prototype._addItem=function(e,i,n){if(i===void 0&&(i=!0),n===void 0&&(n=!1),!e.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e.id),this._store.dispatch(bs(e)),i&&(this.passedElement.triggerEvent(Ue.addItem,this._getChoiceForOutput(e)),n&&this.passedElement.triggerEvent(Ue.choice,this._getChoiceForOutput(e)))},t.prototype._removeItem=function(e){if(e.id){this._store.dispatch(ys(e));var i=this._notice;i&&i.type===Le.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(Ue.removeItem,this._getChoiceForOutput(e))}},t.prototype._addChoice=function(e,i,n){if(i===void 0&&(i=!0),n===void 0&&(n=!1),e.id)throw new TypeError("Can not re-add a choice which has already been added");var s=this.config;if(!(!s.duplicateItemsAllowed&&this._store.choices.find(function(o){return s.valueComparer(o.value,e.value)}))){this._lastAddedChoiceId++,e.id=this._lastAddedChoiceId,e.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(e.id);var r=s.prependValue,l=s.appendValue;r&&(e.value=r+e.value),l&&(e.value+=l.toString()),(r||l)&&e.element&&(e.element.value=e.value),this._clearNotice(),this._store.dispatch(vs(e)),e.selected&&this._addItem(e,i,n)}},t.prototype._addGroup=function(e,i){var n=this;if(i===void 0&&(i=!0),e.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(eu(e)),e.choices&&(this._lastAddedGroupId++,e.id=this._lastAddedGroupId,e.choices.forEach(function(s){s.group=e,e.disabled&&(s.disabled=!0),n._addChoice(s,i)}))},t.prototype._createTemplates=function(){var e=this,i=this.config.callbackOnCreateTemplates,n={};typeof i=="function"&&(n=i.call(this,ru,un,Ei));var s={};Object.keys(this._templates).forEach(function(r){r in n?s[r]=n[r].bind(e):s[r]=e._templates[r].bind(e)}),this._templates=s},t.prototype._createElements=function(){var e=this._templates,i=this,n=i.config,s=i._isSelectOneElement,r=n.position,l=n.classNames,o=this._elementType;this.containerOuter=new Ss({element:e.containerOuter(n,this._direction,this._isSelectElement,s,n.searchEnabled,o,n.labelId),classNames:l,type:o,position:r}),this.containerInner=new Ss({element:e.containerInner(n),classNames:l,type:o,position:r}),this.input=new hu({element:e.input(n,this._placeholderValue),classNames:l,type:o,preventPaste:!n.paste}),this.choiceList=new Es({element:e.choiceList(n,s)}),this.itemList=new Es({element:e.itemList(n,s)}),this.dropdown=new du({element:e.dropdown(n),classNames:l,type:o})},t.prototype._createStructure=function(){var e=this,i=e.containerInner,n=e.containerOuter,s=e.passedElement,r=this.dropdown.element;s.conceal(),i.wrap(s.element),n.wrap(i.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),n.element.appendChild(i.element),n.element.appendChild(r),i.element.appendChild(this.itemList.element),r.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&r.insertBefore(this.input.element,r.firstChild):i.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},t.prototype._initStore=function(){var e=this;this._store.subscribe(this._render).withTxn(function(){e._addPredefinedChoices(e._presetChoices,e._isSelectOneElement&&!e._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},t.prototype._addPredefinedChoices=function(e,i,n){var s=this;if(i===void 0&&(i=!1),n===void 0&&(n=!0),i){var r=e.findIndex(function(l){return l.selected})===-1;r&&e.some(function(l){return l.disabled||"choices"in l?!1:(l.selected=!0,!0)})}e.forEach(function(l){"choices"in l?s._isSelectElement&&s._addGroup(l,n):s._addChoice(l,n)})},t.prototype._findAndSelectChoiceByValue=function(e,i){var n=this;i===void 0&&(i=!1);var s=this._store.choices.find(function(r){return n.config.valueComparer(r.value,e)});return s&&!s.disabled&&!s.selected?(this._addItem(s,!0,i),!0):!1},t.prototype._generatePlaceholderValue=function(){var e=this.config;if(!e.placeholder)return null;if(this._hasNonChoicePlaceholder)return e.placeholderValue;if(this._isSelectElement){var i=this.passedElement.placeholderOption;return i?i.text:null}return null},t.prototype._warnChoicesInitFailed=function(e){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(e," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(e," called on a non-initialised instance of Choices"))},t.version="11.1.0",t}();function Ns(t){let e,i;return{c(){e=b("label"),i=W(t[2]),p(e,"for",t[4])},m(n,s){S(n,e,s),_(e,i)},p(n,s){s&4&&ce(i,n[2])},d(n){n&&k(e)}}}function kf(t){let e;return{c(){e=b("select"),p(e,"id",t[4]),p(e,"name",t[4]),p(e,"aria-label",t[2]),p(e,"class","m-1")},m(i,n){S(i,e,n)},p(i,n){n&4&&p(e,"aria-label",i[2])},i:j,o:j,d(i){i&&k(e)}}}function Sf(t){let e,i,n,s=t[3].length&&$s(t);return{c(){s&&s.c(),e=N(),i=b("select"),p(i,"id",t[4]),p(i,"name",t[4]),p(i,"aria-label",t[2]),p(i,"class","m-1"),i.multiple=!0},m(r,l){s&&s.m(r,l),S(r,e,l),S(r,i,l),n=!0},p(r,l){r[3].length?s?(s.p(r,l),l&8&&R(s,1)):(s=$s(r),s.c(),R(s,1),s.m(e.parentNode,e)):s&&(_e(),D(s,1,1,()=>{s=null}),ve()),(!n||l&4)&&p(i,"aria-label",r[2])},i(r){n||(R(s),n=!0)},o(r){D(s),n=!1},d(r){s&&s.d(r),r&&k(e),r&&k(i)}}}function $s(t){let e,i,n=t[3].length+"",s,r,l,o;return l=new ki({props:{targetHtmlId:t[5],tooltipText:`${t[3].length}
                                    ${V==="fr"&&t[3].length>1?"valeurs sélectionnées":V==="fr"&&t[3].length===1?"valeur sélectionnée":V==="en"&&t[3].length>1?"selected values":"selected value"}`}}),{c(){e=b("span"),i=b("span"),s=W(n),r=N(),Z(l.$$.fragment),p(i,"id",t[5]),p(i,"class","input-dropdown-count tag m-1 svelte-1epfuu8"),p(e,"class","is-relative")},m(a,c){S(a,e,c),_(e,i),_(i,s),_(e,r),X(l,e,null),o=!0},p(a,c){(!o||c&8)&&n!==(n=a[3].length+"")&&ce(s,n);const u={};c&8&&(u.tooltipText=`${a[3].length}
                                    ${V==="fr"&&a[3].length>1?"valeurs sélectionnées":V==="fr"&&a[3].length===1?"valeur sélectionnée":V==="en"&&a[3].length>1?"selected values":"selected value"}`),l.$set(u)},i(a){o||(R(l.$$.fragment,a),o=!0)},o(a){D(l.$$.fragment,a),o=!1},d(a){a&&k(e),Q(l)}}}function Ef(t){let e,i,n,s,r,l,o,a=t[2]!==void 0&&Ns(t);const c=[Sf,kf],u=[];function f(d,h){return d[0]?0:1}return s=f(t),r=u[s]=c[s](t),{c(){e=b("div"),a&&a.c(),i=N(),n=b("div"),r.c(),p(n,"class",l="input-dropdown-select "+(t[0]?"is-multiple":"is-single")+" "+(t[0]&&t[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(t[1]?"light-display":"")+" svelte-1epfuu8"),p(e,"class","input-dropdown-select-wrapper")},m(d,h){S(d,e,h),a&&a.m(e,null),_(e,i),_(e,n),u[s].m(n,null),o=!0},p(d,[h]){d[2]!==void 0?a?a.p(d,h):(a=Ns(d),a.c(),a.m(e,i)):a&&(a.d(1),a=null);let m=s;s=f(d),s===m?u[s].p(d,h):(_e(),D(u[m],1,1,()=>{u[m]=null}),ve(),r=u[s],r?r.p(d,h):(r=u[s]=c[s](d),r.c()),R(r,1),r.m(n,null)),(!o||h&11&&l!==(l="input-dropdown-select "+(d[0]?"is-multiple":"is-single")+" "+(d[0]&&d[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(d[1]?"light-display":"")+" svelte-1epfuu8"))&&p(n,"class",l)},i(d){o||(R(r),o=!0)},o(d){D(r),o=!1},d(d){d&&k(e),a&&a.d(),u[s].d()}}}const Cf=250;function If(t,e,i){let n,s,{choicesItems:r}=e,{start:l=[]}=e,{multiple:o}=e,{searchable:a=!0}=e,{lightDisplay:c=!1}=e,{placeholder:u=V==="fr"?"Sélectionner une valeur":"Select a value"}=e,{title:f=void 0}=e,{selectAll:d=!!o}=e;const h=`input-dropdown-select-${window.crypto.randomUUID()}`,m=`input-dropdown-counter-${window.crypto.randomUUID()}`,g=`select-all-${window.crypto.randomUUID()}`,v=`unselect-all-${window.crypto.randomUUID()}`,w=tn();let O;const L=mi();L.setCompareFn(ln);const C=Ae("resetTrigger")||void 0;C==null||C.subscribe(()=>M(O,r,l,d));const T=()=>{i(11,s=!0),setTimeout(()=>i(11,s=!1),Cf)},$=(U,se)=>{se||(L.set(U),L.same()||w("updateValues",n))},F=U=>`<span class="iconify" data-icon=${U}/>`,E=(U,se)=>U!=null&&se!=null&&U.length&&se.length?`<span class="dropdown-prefix-wrapper">${se==="iconify"?F(U):U}</span>`:"",P=(U,se)=>se?[{value:g,label:`<b>${V==="fr"?"Tout sélectionner":"Select all"}</b>`},{value:v,label:`<b>${V==="fr"?"Tout retirer":"Remove all"}</b>`},...U]:U,G=(U,se)=>P(U,se).map(Y=>(Y.id=`dropdown-choice-${window.crypto.randomUUID()}`,Y.label=`<span>
                ${E(Y.prefix||"",Y.prefixType||"")}
                <span class="dropdown-prefix-text">${Y.label}</span>
            </span>`,Y));function ee(U,se,Y){return U=structuredClone(U),se=structuredClone(se),U=G(U,Y).map(te=>se.includes(te.value)?{...te,selected:!0}:{...te,selected:!1}),i(3,n=se),U}function M(U,se,Y,te){U&&(se=ee(se,Y,te),U.clearStore().setChoices(se))}const H=(U,se,Y,te,ne,be)=>(te=structuredClone(te),Y=structuredClone(Y),U.detail.value===ne?(T(),Y=Y.map(ke=>[ne,be].includes(ke.value)?{...ke,selected:!1}:{...ke,selected:!0}),se.removeActiveItems().clearChoices(!0,!0).setValue(Y).hideDropdown(),te=[...new Set(Y.filter(ke=>ke.selected===!0).map(ke=>ke.value))]):U.detail.value===be?(se.removeActiveItems().hideDropdown(),te=[]):te=o===!0?[...te,U.detail.value]:[U.detail.value],[...new Set(te)]),z=(U,se)=>structuredClone(se).filter(Y=>Y!==U.detail.value);function q(U,se){const Y=document.getElementById(h);O=new wf(Y,{items:[],choices:U,addChoices:!1,addItems:!1,removeItems:!0,removeItemButton:!0,searchEnabled:a,allowHTML:!0,shouldSort:!se,sorter:(te,ne)=>te.label.localeCompare(ne.label),placeholderValue:u,classNames:{item:["choices__item","dropdown-item"]},loadingText:V==="fr"?"Chargement...":"Loading...",noResultsText:V==="fr"?"Pas de résultats":"No results found",noChoicesText:V==="fr"?"Pas de choix pour faire la sélection":"No choices to choose from",itemSelectText:V==="fr"?"Cliquer pour sélectionner":"Press to select",uniqueItemText:V==="fr"?"Seules des valeurs uniques peuvent être ajoutées":"Only unique values can be added",customAddItemText:V==="fr"?"Les valeurs ne répondent pas aux conditions attendues":"Only values matching specific conditions can be added",removeItemIconText:V==="fr"?"Retirer l'item":"Remove item",addItemText:te=>V==="fr"?`Cliquer sur Entrer pour ajouter <b>${te}</b>`:`Press Enter to add <b>"${te}"</b>`,removeItemLabelText:te=>V==="fr"?`Retirer l'item: ${te}`:`Remove item: ${te}`,maxItemText:te=>V==="fr"?`Seulement ${te} items peuvent être ajoutées`:`Only ${te} items can be added`}),Y.addEventListener("addItem",te=>{i(3,n=H(te,O,U,n,g,v))}),Y.addEventListener("removeItem",te=>{i(3,n=z(te,n))})}return vt(()=>{const U=ee(r,l,d);q(U,d)}),bi(()=>{O.destroy(),O=void 0}),t.$$set=U=>{"choicesItems"in U&&i(6,r=U.choicesItems),"start"in U&&i(7,l=U.start),"multiple"in U&&i(0,o=U.multiple),"searchable"in U&&i(8,a=U.searchable),"lightDisplay"in U&&i(1,c=U.lightDisplay),"placeholder"in U&&i(9,u=U.placeholder),"title"in U&&i(2,f=U.title),"selectAll"in U&&i(10,d=U.selectAll)},t.$$.update=()=>{t.$$.dirty&2056&&$(n,s)},i(3,n=[]),i(11,s=!1),[o,c,f,n,h,m,r,l,a,u,d,s]}class pl extends de{constructor(e){super(),fe(this,e,If,Ef,ue,{choicesItems:6,start:7,multiple:0,searchable:8,lightDisplay:1,placeholder:9,title:2,selectAll:10})}}function Of(t){let e,i,n,s,r,l;return r=new ki({props:{tooltipText:t[2]}}),{c(){e=b("div"),i=b("button"),n=b("span"),s=N(),Z(r.$$.fragment),p(n,"class","iconify"),p(n,"data-icon",t[0]),p(n,"title",t[1]),p(i,"class","svelte-11ixywk"),p(e,"class","is-inline-block icon-tooltip svelte-11ixywk")},m(o,a){S(o,e,a),_(e,i),_(i,n),_(i,s),X(r,i,null),l=!0},p(o,[a]){(!l||a&1)&&p(n,"data-icon",o[0]),(!l||a&2)&&p(n,"title",o[1]);const c={};a&4&&(c.tooltipText=o[2]),r.$set(c)},i(o){l||(R(r.$$.fragment,o),l=!0)},o(o){D(r.$$.fragment,o),l=!1},d(o){o&&k(e),Q(r)}}}function Af(t,e,i){let{iconifyIcon:n,altText:s,tooltipText:r}=e;return t.$$set=l=>{"iconifyIcon"in l&&i(0,n=l.iconifyIcon),"altText"in l&&i(1,s=l.altText),"tooltipText"in l&&i(2,r=l.tooltipText)},[n,s,r]}class Tf extends de{constructor(e){super(),fe(this,e,Af,Of,ue,{iconifyIcon:0,altText:1,tooltipText:2})}}const Pf=t=>({}),js=t=>({}),Lf=t=>({}),Fs=t=>({});function Us(t){let e,i,n,s,r,l,o,a,c,u,f,d=t[1]&&Vs(t);return a=new ki({props:{tooltipText:t[2][t[1]][V]}}),{c(){d&&d.c(),e=N(),i=b("div"),n=b("button"),s=Qe("svg"),r=Qe("path"),o=N(),Z(a.$$.fragment),p(r,"fill","none"),p(r,"stroke","currentColor"),p(r,"stroke-linecap","round"),p(r,"stroke-linejoin","round"),p(r,"stroke-width","1.5"),p(r,"d","M12 3v18m0 0l8.5-8.5M12 21l-8.5-8.5"),p(s,"style",l=`transform: rotate(${t[1]?"180":"0"}deg)`),p(s,"xmlns","http://www.w3.org/2000/svg"),p(s,"width","24"),p(s,"height","24"),p(s,"viewBox","0 0 24 24"),p(s,"class","svelte-jbs1sd"),p(n,"class","button is-link svelte-jbs1sd"),p(i,"class","ctrl-toggle svelte-jbs1sd")},m(h,m){d&&d.m(h,m),S(h,e,m),S(h,i,m),_(i,n),_(n,s),_(s,r),_(n,o),X(a,n,null),c=!0,u||(f=re(n,"click",Ct(t[3])),u=!0)},p(h,m){h[1]?d?(d.p(h,m),m&2&&R(d,1)):(d=Vs(h),d.c(),R(d,1),d.m(e.parentNode,e)):d&&(_e(),D(d,1,1,()=>{d=null}),ve()),(!c||m&2&&l!==(l=`transform: rotate(${h[1]?"180":"0"}deg)`))&&p(s,"style",l);const g={};m&2&&(g.tooltipText=h[2][h[1]][V]),a.$set(g)},i(h){c||(R(d),R(a.$$.fragment,h),c=!0)},o(h){D(d),D(a.$$.fragment,h),c=!1},d(h){d&&d.d(h),h&&k(e),h&&k(i),Q(a),u=!1,f()}}}function Vs(t){let e,i,n;const s=t[5]["toolbar-hidden"],r=Ge(s,t,t[4],js);return{c(){e=b("div"),r&&r.c(),p(e,"class","ctrl-extra")},m(l,o){S(l,e,o),r&&r.m(e,null),n=!0},p(l,o){r&&r.p&&(!n||o&16)&&Je(r,s,l,l[4],n?Ye(s,l[4],o,Pf):Xe(l[4]),js)},i(l){n||(R(r,l),Ze(()=>{n&&(i||(i=nt(e,An,{axis:"y"},!0)),i.run(1))}),n=!0)},o(l){D(r,l),i||(i=nt(e,An,{axis:"y"},!1)),i.run(0),n=!1},d(l){l&&k(e),r&&r.d(l),l&&i&&i.end()}}}function Mf(t){let e,i,n,s,r,l,o,a;const c=t[5]["toolbar-visible"],u=Ge(c,t,t[4],Fs);let f=t[0]&&Us(t);return{c(){e=b("div"),i=b("form"),n=b("div"),s=b("div"),r=b("div"),u&&u.c(),l=N(),f&&f.c(),p(r,"class","ctrl-block svelte-jbs1sd"),p(s,"class","ctrl-block-wrapper svelte-jbs1sd"),p(n,"class","ctrl-base"),p(i,"class","ctrl svelte-jbs1sd"),p(e,"id","toolbar"),p(e,"class",o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(t[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd")},m(d,h){S(d,e,h),_(e,i),_(i,n),_(n,s),_(s,r),u&&u.m(r,null),_(i,l),f&&f.m(i,null),a=!0},p(d,[h]){u&&u.p&&(!a||h&16)&&Je(u,c,d,d[4],a?Ye(c,d[4],h,Lf):Xe(d[4]),Fs),d[0]?f?(f.p(d,h),h&1&&R(f,1)):(f=Us(d),f.c(),R(f,1),f.m(i,null)):f&&(_e(),D(f,1,1,()=>{f=null}),ve()),(!a||h&2&&o!==(o="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(d[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd"))&&p(e,"class",o)},i(d){a||(R(u,d),R(f),a=!0)},o(d){D(u,d),D(f),a=!1},d(d){d&&k(e),u&&u.d(d),f&&f.d()}}}function Rf(t,e,i){let n,{$$slots:s={},$$scope:r}=e,{expandable:l=!0}=e;const o={true:{en:"Collapse the toolbar",fr:"Refermer le menu"},false:{en:"Expand the toolbar",fr:"Ouvrir le menu"}},a=()=>i(1,n=!n);return t.$$set=c=>{"expandable"in c&&i(0,l=c.expandable),"$$scope"in c&&i(4,r=c.$$scope)},i(1,n=!1),[l,n,o,a,r,s]}class Df extends de{constructor(e){super(),fe(this,e,Rf,Mf,ue,{expandable:0})}}function Hs(t){let e,i;return e=new pl({props:{choicesItems:t[4],multiple:!0,placeholder:"...",start:Object.keys(t[5][t[13]]||{}),lightDisplay:!0,title:V==="fr"?"Régions sélectionnées":"Selected regions",selectAll:!0}}),e.$on("updateValues",t[22]),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,s){const r={};s&16&&(r.choicesItems=n[4]),s&32&&(r.start=Object.keys(n[5][n[13]]||{})),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Nf(t){return{c:j,m:j,p:j,i:j,o:j,d:j}}function $f(t){let e,i,n=t[28].length&&jf(t);return{c(){n&&n.c(),e=he()},m(s,r){n&&n.m(s,r),S(s,e,r),i=!0},p(s,r){s[28].length&&n.p(s,r)},i(s){i||(R(n),i=!0)},o(s){D(n),i=!1},d(s){n&&n.d(s),s&&k(e)}}}function jf(t){let e,i;return e=new Zr({props:{title:V==="fr"?"Score minimal":"Minimal score",minVal:t[28][0],maxVal:t[28][1],start:t[0]||t[28][0],roundTo:3}}),e.$on("updateSlider",t[18]),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,s){const r={};s&1&&(r.start=n[0]||n[28][0]),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Ff(t){return{c:j,m:j,p:j,i:j,o:j,d:j}}function Uf(t){let e,i,n=Object.keys(t[4]).length,s,r,l,o=n&&Hs(t),a={ctx:t,current:null,token:null,hasCatch:!1,pending:Ff,then:$f,catch:Nf,value:28,blocks:[,,,]};return ct(t[17],a),{c(){e=b("div"),i=b("div"),o&&o.c(),s=N(),r=b("div"),a.block.c(),p(i,"class","ctrl-input svelte-8yfni4"),p(r,"class","ctrl-input svelte-8yfni4"),p(e,"slot","toolbar-visible"),p(e,"class","ctrl-block-inputs svelte-8yfni4")},m(c,u){S(c,e,u),_(e,i),o&&o.m(i,null),_(e,s),_(e,r),a.block.m(r,a.anchor=null),a.mount=()=>r,a.anchor=null,l=!0},p(c,u){t=c,u&16&&(n=Object.keys(t[4]).length),n?o?(o.p(t,u),u&16&&R(o,1)):(o=Hs(t),o.c(),R(o,1),o.m(i,null)):o&&(_e(),D(o,1,1,()=>{o=null}),ve()),Ft(a,t,u)},i(c){l||(R(o),R(a.block),l=!0)},o(c){D(o);for(let u=0;u<3;u+=1){const f=a.blocks[u];D(f)}l=!1},d(c){c&&k(e),o&&o.d(),a.block.d(),a.token=null,a=null}}}function Vf(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g,v,w,O,L,C,T,$,F;return a=new pl({props:{choicesItems:t[15],multiple:!0,placeholder:"...",start:t[1],lightDisplay:!0,title:V==="fr"?"Catégories masquées":"Hidden categories",selectAll:!0}}),a.$on("updateValues",t[19]),g=new Tf({props:{iconifyIcon:"material-symbols:help-outline",altText:V==="en"?"Display help":"Afficher une explication",tooltipText:t[14]}}),L=new Zr({props:{title:V==="fr"?"Profondeur de récursion":"Recursion depth",minVal:t[12][0],maxVal:t[12][1],start:t[2],step:1}}),L.$on("updateSlider",t[20]),$=new Gc({props:{toggleLabel:V==="en"?"Filter by region":"Filtrer par région",start:t[3],buttonDisplay:!0}}),$.$on("updateChecked",t[21]),{c(){e=b("div"),i=b("div"),n=b("div"),s=b("span"),s.textContent=`${V==="en"?"Similarity":"Similarité"}`,r=N(),l=b("div"),o=b("div"),Z(a.$$.fragment),c=N(),u=b("div"),f=b("div"),d=b("div"),h=b("span"),h.textContent="Propagation",m=N(),Z(g.$$.fragment),v=N(),w=b("div"),O=b("div"),Z(L.$$.fragment),C=N(),T=b("div"),Z($.$$.fragment),p(s,"class","tag is-medium is-link"),p(n,"class","ctrl-block-title svelte-8yfni4"),p(o,"class","ctrl-input svelte-8yfni4"),p(l,"class","ctrl-block-inputs svelte-8yfni4"),p(i,"class","ctrl-block svelte-8yfni4"),p(e,"class","ctrl-block-wrapper svelte-8yfni4"),p(h,"class","tag is-medium is-link mr-1"),p(d,"class","ctrl-block-title svelte-8yfni4"),p(O,"class","ctrl-input svelte-8yfni4"),p(T,"class","ctrl-input svelte-8yfni4"),p(w,"class","ctrl-block-inputs svelte-8yfni4"),p(f,"class","ctrl-block svelte-8yfni4"),p(u,"class","ctrl-block-wrapper svelte-8yfni4")},m(E,P){S(E,e,P),_(e,i),_(i,n),_(n,s),_(i,r),_(i,l),_(l,o),X(a,o,null),S(E,c,P),S(E,u,P),_(u,f),_(f,d),_(d,h),_(d,m),X(g,d,null),_(f,v),_(f,w),_(w,O),X(L,O,null),_(w,C),_(w,T),X($,T,null),F=!0},p(E,P){const G={};P&2&&(G.start=E[1]),a.$set(G);const ee={};P&4&&(ee.start=E[2]),L.$set(ee);const M={};P&8&&(M.start=E[3]),$.$set(M)},i(E){F||(R(a.$$.fragment,E),R(g.$$.fragment,E),R(L.$$.fragment,E),R($.$$.fragment,E),F=!0)},o(E){D(a.$$.fragment,E),D(g.$$.fragment,E),D(L.$$.fragment,E),D($.$$.fragment,E),F=!1},d(E){E&&k(e),Q(a),E&&k(c),E&&k(u),Q(g),Q(L),Q($)}}}function Hf(t){let e,i;return e=new Df({props:{$$slots:{"toolbar-hidden":[Vf],"toolbar-visible":[Uf]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,[s]){const r={};s&536870975&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Bs(){const t=document.getElementById("nav-actions");t&&document.documentElement.style.setProperty("--top-offset",`${t.offsetHeight}px`)}function Bf(t,e,i){let n,s,r,l,o,a,c,u;const{selectedRegions:f,comparedRegions:d,excludedCategories:h,similarityScoreCutoff:m,propagateRecursionDepth:g,propagateFilterByRegions:v,allowedPropagateDepthRange:w}=ze;oe(t,f,q=>i(5,u=q)),oe(t,d,q=>i(25,s=q)),oe(t,h,q=>i(1,l=q)),oe(t,m,q=>i(23,r=q)),oe(t,g,q=>i(2,o=q)),oe(t,v,q=>i(3,a=q));let O;vt(()=>{Bs(),O=new ResizeObserver(()=>{Bs()});const q=document.getElementById("nav-actions");return q&&O.observe(q),()=>{O&&q&&(O.unobserve(q),O.disconnect())}});const L=window.location.pathname.match(/\d+/g).join("-"),C=`${window.location.origin}${window.location.pathname}`,T=V==="en"?"Propagated matches are exact matches to images that have an exact match with the current image. There may be up to 6 exact matches connecting the current image and propagated images.":"Les correspondances propagées correspondent à des correspondances exactes à des images ayant une correspondance exacte avec l'image actuelle. Il peut y avoir jusqu'à 6 images reliant l'image actuelle à une correspondance propagée.",$=[{value:1,label:Vr,prefix:Nr,prefixType:"svg"},{value:2,label:Hr,prefix:$r,prefixType:"svg"},{value:3,label:Br,prefix:jr,prefixType:"svg"},{value:4,label:zr,prefix:Fr,prefixType:"svg"},{value:5,label:qr,prefix:Ur,prefixType:"svg"}],F=Be(d,q=>Object.entries(q).map(([U,se])=>({prefix:`#${se.id}`,prefixType:"text",value:U,label:Cr(se.title.replace(/^[^|]+/,""))})));oe(t,F,q=>i(4,c=q));const E=P();async function P(){let q=[];return await fetch(`${C}similarity-score-range`).then(U=>U.json()).then(U=>(q=[U.min,U.max],q.every(se=>typeof se=="number")?i(0,n=r&&q[0]<=r&&q[1]>=r?r:q[0]):(console.error(`fetchSimilarityScoreRange: expected '[number, number]', got '${q}'. Defaulting to '[]'`),q=[]),q)).catch(U=>(console.error("Error on fetchSimilarityScoreRange:",U),errorMsg.set(U.message),q))}const G=q=>m.set(q.detail),ee=q=>h.set(q.detail),M=q=>g.set(q.detail),H=q=>v.set(q.detail),z=q=>{const U=q.detail,se={[L]:{}};Object.keys(s).forEach(Y=>{U.includes(Y)&&(se[L][Y]=s[Y])}),f.set(se)};return t.$$.update=()=>{t.$$.dirty&8388608&&i(0,n=r||void 0)},[n,l,o,a,c,u,f,d,h,m,g,v,w,L,T,$,F,E,G,ee,M,H,z,r]}class zf extends de{constructor(e){super(),fe(this,e,Bf,Hf,ue,{})}}function qf(t){let e=Object.keys(t[0]).length,i,n,s,r,l,o=e&&zs();const a=[Wf,xf,Kf],c=[];function u(f,d){return f[1]?0:f[2]?1:2}return n=u(t),s=c[n]=a[n](t),{c(){o&&o.c(),i=N(),s.c(),r=he()},m(f,d){o&&o.m(f,d),S(f,i,d),c[n].m(f,d),S(f,r,d),l=!0},p(f,d){d&1&&(e=Object.keys(f[0]).length),e?o?d&1&&R(o,1):(o=zs(),o.c(),R(o,1),o.m(i.parentNode,i)):o&&(_e(),D(o,1,1,()=>{o=null}),ve());let h=n;n=u(f),n===h?c[n].p(f,d):(_e(),D(c[h],1,1,()=>{c[h]=null}),ve(),s=c[n],s?s.p(f,d):(s=c[n]=a[n](f),s.c()),R(s,1),s.m(r.parentNode,r))},i(f){l||(R(o),R(s),l=!0)},o(f){D(o),D(s),l=!1},d(f){o&&o.d(f),f&&k(i),c[n].d(f),f&&k(r)}}}function zs(t){let e,i;return e=new zf({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Kf(t){let e,i;return e=new ic({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function xf(t){let e,i;return e=new yi({props:{$$slots:{default:[Jf]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,s){const r={};s&36&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Wf(t){let e,i;return e=new yi({props:{$$slots:{default:[Xf]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,s){const r={};s&32&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Gf(t){let e,i;return{c(){e=W("Erreur lors de la récupération des similarités : "),i=W(t[2])},m(n,s){S(n,e,s),S(n,i,s)},p(n,s){s&4&&ce(i,n[2])},d(n){n&&k(e),n&&k(i)}}}function Yf(t){let e,i;return{c(){e=W("Error when retrieving similarities: "),i=W(t[2])},m(n,s){S(n,e,s),S(n,i,s)},p(n,s){s&4&&ce(i,n[2])},d(n){n&&k(e),n&&k(i)}}}function Jf(t){let e;function i(r,l){return V==="en"?Yf:Gf}let s=i()(t);return{c(){e=b("tr"),s.c(),p(e,"class","faded is-center")},m(r,l){S(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},d(r){r&&k(e),s.d()}}}function Xf(t){let e;return{c(){e=b("tr"),e.textContent=`${V==="en"?"Retrieving similarities...":"Récupération des similarités..."}`,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,d(i){i&&k(e)}}}function Qf(t){let e=Rt.includes("similarity"),i,n,s=e&&qf(t);return{c(){s&&s.c(),i=he()},m(r,l){s&&s.m(r,l),S(r,i,l),n=!0},p(r,[l]){e&&s.p(r,l)},i(r){n||(R(s),n=!0)},o(r){D(s),n=!1},d(r){s&&s.d(r),r&&k(i)}}}function Zf(t,e,i){let n,s,r;oe(t,Et,a=>i(1,s=a)),oe(t,Sr,a=>i(2,r=a));const{fetchSimilarity:l,comparedRegions:o}=ze;return oe(t,o,a=>i(0,n=a)),vt(()=>{Rt.includes("similarity")&&l()}),[n,s,r,o]}class ed extends de{constructor(e){super(),fe(this,e,Zf,Qf,ue,{})}}function qs(t,e,i){const n=t.slice();return n[10]=e[i][0],n[11]=e[i][1],n}function Ks(t,e,i){const n=t.slice();return n[14]=e[i],n}function td(t){let e,i=V==="en"?`Error when retrieving paginated regions: ${t[17]}`:`Erreur de récupération des pages : ${t[17]}`,n;return{c(){e=b("tr"),n=W(i),p(e,"class","faded is-center")},m(s,r){S(s,e,r),_(e,n)},p(s,r){r&1&&i!==(i=V==="en"?`Error when retrieving paginated regions: ${s[17]}`:`Erreur de récupération des pages : ${s[17]}`)&&ce(n,i)},i:j,o:j,d(s){s&&k(e)}}}function id(t){let e,i,n,s,r;const l=[sd,nd],o=[];function a(c,u){return u&2&&(e=null),e==null&&(e=Object.values(c[1]).length>0),e?0:1}return i=a(t,-1),n=o[i]=l[i](t),{c(){n.c(),s=he()},m(c,u){o[i].m(c,u),S(c,s,u),r=!0},p(c,u){let f=i;i=a(c,u),i===f?o[i].p(c,u):(_e(),D(o[f],1,1,()=>{o[f]=null}),ve(),n=o[i],n?n.p(c,u):(n=o[i]=l[i](c),n.c()),R(n,1),n.m(s.parentNode,s))},i(c){r||(R(n),r=!0)},o(c){D(n),r=!1},d(c){o[i].d(c),c&&k(s)}}}function nd(t){let e,i,n;return i=new Rr({}),{c(){e=b("tr"),Z(i.$$.fragment)},m(s,r){S(s,e,r),X(i,e,null),n=!0},p:j,i(s){n||(R(i.$$.fragment,s),n=!0)},o(s){D(i.$$.fragment,s),n=!1},d(s){s&&k(e),Q(i)}}}function sd(t){let e,i,n=Object.entries(t[1]),s=[];for(let l=0;l<n.length;l+=1)s[l]=Ws(qs(t,n,l));const r=l=>D(s[l],1,1,()=>{s[l]=null});return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=he()},m(l,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(l,o);S(l,e,o),i=!0},p(l,o){if(o&98){n=Object.entries(l[1]);let a;for(a=0;a<n.length;a+=1){const c=qs(l,n,a);s[a]?(s[a].p(c,o),R(s[a],1)):(s[a]=Ws(c),s[a].c(),R(s[a],1),s[a].m(e.parentNode,e))}for(_e(),a=n.length;a<s.length;a+=1)r(a);ve()}},i(l){if(!i){for(let o=0;o<n.length;o+=1)R(s[o]);i=!0}},o(l){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);i=!1},d(l){st(s,l),l&&k(e)}}}function rd(t){let e,i,n,s,r,l,o,a,c=t[10]+"",u,f,d;return{c(){e=b("img"),s=N(),r=b("div"),l=b("a"),o=b("i"),a=W(`
                                Page `),u=W(c),d=N(),We(e.src,i=gt(t[5](t[10]),"full","250,"))||p(e,"src",i),p(e,"alt",n="Canvas "+t[10]),p(e,"class","mb-3 card"),p(o,"class","fa-solid fa-pen-to-square"),p(l,"class","tag px-2 py-1 is-rounded is-hoverable"),p(l,"href",f=Nt(t[6],t[10])),p(l,"target","_blank"),p(r,"class","is-center mb-1")},m(h,m){S(h,e,m),S(h,s,m),S(h,r,m),_(r,l),_(l,o),_(l,a),_(l,u),S(h,d,m)},p(h,m){m&2&&!We(e.src,i=gt(h[5](h[10]),"full","250,"))&&p(e,"src",i),m&2&&n!==(n="Canvas "+h[10])&&p(e,"alt",n),m&2&&c!==(c=h[10]+"")&&ce(u,c),m&2&&f!==(f=Nt(h[6],h[10]))&&p(l,"href",f)},d(h){h&&k(e),h&&k(s),h&&k(r),h&&k(d)}}}function xs(t,e){let i,n,s;return n=new an({props:{item:e[14],isSquare:!0}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),X(n,r,l),s=!0},p(r,l){e=r;const o={};l&2&&(o.item=e[14]),n.$set(o)},i(r){s||(R(n.$$.fragment,r),s=!0)},o(r){D(n.$$.fragment,r),s=!1},d(r){r&&k(i),Q(n,r)}}}function ld(t){let e=[],i=new Map,n,s,r=Object.values(t[11]);const l=o=>o[14].id;for(let o=0;o<r.length;o+=1){let a=Ks(t,r,o),c=l(a);i.set(c,e[o]=xs(c,a))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();n=N()},m(o,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(o,a);S(o,n,a),s=!0},p(o,a){a&2&&(r=Object.values(o[11]),_e(),e=Ut(e,a,l,1,o,r,i,n.parentNode,Qt,xs,n,Ks),ve())},i(o){if(!s){for(let a=0;a<r.length;a+=1)R(e[a]);s=!0}},o(o){for(let a=0;a<e.length;a+=1)D(e[a]);s=!1},d(o){for(let a=0;a<e.length;a+=1)e[a].d(o);o&&k(n)}}}function Ws(t){let e,i;return e=new xr({props:{$$slots:{"row-body":[ld],"row-header":[rd]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,s){const r={};s&262146&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function od(t){let e;return{c(){e=b("tr"),e.textContent=`${V==="en"?"Retrieving paginated regions...":"Récupération des pages..."}`,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,i:j,o:j,d(i){i&&k(e)}}}function ad(t){let e,i,n,s={ctx:t,current:null,token:null,hasCatch:!0,pending:od,then:id,catch:td,value:9,error:17,blocks:[,,,]};return ct(i=t[0],s),{c(){e=he(),s.block.c()},m(r,l){S(r,e,l),s.block.m(r,s.anchor=l),s.mount=()=>e.parentNode,s.anchor=e,n=!0},p(r,l){t=r,s.ctx=t,l&1&&i!==(i=t[0])&&ct(i,s)||Ft(s,t,l)},i(r){n||(R(s.block),n=!0)},o(r){for(let l=0;l<3;l+=1){const o=s.blocks[l];D(o)}n=!1},d(r){r&&k(e),s.block.d(r),s.token=null,s=null}}}function cd(t){let e,i,n,s,r,l;return e=new $t({props:{store:_t,nbOfItems:t[4]}}),n=new yi({props:{$$slots:{default:[ad]},$$scope:{ctx:t}}}),r=new $t({props:{store:_t,nbOfItems:t[4]}}),{c(){Z(e.$$.fragment),i=N(),Z(n.$$.fragment),s=N(),Z(r.$$.fragment)},m(o,a){X(e,o,a),S(o,i,a),X(n,o,a),S(o,s,a),X(r,o,a),l=!0},p(o,[a]){const c={};a&262147&&(c.$$scope={dirty:a,ctx:o}),n.$set(c)},i(o){l||(R(e.$$.fragment,o),R(n.$$.fragment,o),R(r.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),D(n.$$.fragment,o),D(r.$$.fragment,o),l=!1},d(o){Q(e,o),o&&k(i),Q(n,o),o&&k(s),Q(r,o)}}}function ud(t,e,i){let n,s;const{pageRegions:r,fetchPages:l}=_t;oe(t,r,d=>i(1,s=d)),oe(t,l,d=>i(0,n=d));const o=Ae("nbOfPages"),a=Ae("trailingZeros"),c=(d,h)=>d.toString().padStart(h,"0");function u(d){return`${imgPrefix}_${c(d,a)}`}const f=Ae("manifest");return[n,s,r,l,o,u,f]}class fd extends de{constructor(e){super(),fe(this,e,ud,cd,ue,{})}}function dd(t){let e,i,n,s,r=V==="en"?"Save selection":"Sauvegarder la sélection",l,o,a;return{c(){e=b("button"),i=b("span"),n=b("i"),s=N(),l=W(r),p(n,"class","fa-solid fa-floppy-disk"),p(e,"class","button is-link")},m(c,u){S(c,e,u),_(e,i),_(i,n),_(i,s),_(i,l),o||(a=re(e,"click",t[7]),o=!0)},p:j,d(c){c&&k(e),o=!1,a()}}}function hd(t){let e,i,n,s,r=V==="en"?"Go to treatment":"Accéder au traitement",l,o;return{c(){var a;e=b("a"),i=b("span"),n=b("i"),s=N(),l=W(r),p(n,"class","fa-solid fa-gear"),p(e,"class","button is-link"),p(e,"href",o="/"+je+"/treatment/add/?document_set="+((a=t[3])==null?void 0:a.id))},m(a,c){S(a,e,c),_(e,i),_(i,n),_(i,s),_(i,l)},p(a,c){var u;c&8&&o!==(o="/"+je+"/treatment/add/?document_set="+((u=a[3])==null?void 0:u.id))&&p(e,"href",o)},d(a){a&&k(e)}}}function Gs(t){let e,i,n,s,r,l,o;return{c(){var a,c;e=b("a"),i=b("span"),i.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',s=N(),r=b("a"),l=b("span"),l.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',p(e,"class","button is-link is-dark"),p(e,"href",n="/"+je+"/document-set/"+((a=t[3])==null?void 0:a.id)+"/json"),p(e,"target","_blank"),p(r,"class","button is-link is-dark"),p(r,"href",o="/"+je+"/document-set/"+((c=t[3])==null?void 0:c.id)+"/zip"),p(r,"target","_blank")},m(a,c){S(a,e,c),_(e,i),S(a,s,c),S(a,r,c),_(r,l)},p(a,c){var u,f;c&8&&n!==(n="/"+je+"/document-set/"+((u=a[3])==null?void 0:u.id)+"/json")&&p(e,"href",n),c&8&&o!==(o="/"+je+"/document-set/"+((f=a[3])==null?void 0:f.id)+"/zip")&&p(r,"href",o)},d(a){a&&k(e),a&&k(s),a&&k(r)}}}function pd(t){let e,i,n,s,r,l,o;function a(d,h){return d[2]&&!d[1]?hd:dd}let c=a(t),u=c(t),f=!t[1]&&Gs(t);return{c(){e=b("footer"),i=b("div"),n=b("button"),n.textContent=`${V==="en"?"Clear selection":"Vider la sélection"}`,s=N(),u.c(),r=N(),f&&f.c(),p(n,"class","button button-close is-link is-light"),p(i,"class","buttons"),p(e,"class","modal-card-foot is-center")},m(d,h){S(d,e,h),_(e,i),_(i,n),_(i,s),u.m(i,null),_(i,r),f&&f.m(i,null),l||(o=re(n,"click",t[6]),l=!0)},p(d,[h]){c===(c=a(d))&&u?u.p(d,h):(u.d(1),u=c(d),u&&(u.c(),u.m(i,r))),d[1]?f&&(f.d(1),f=null):f?f.p(d,h):(f=Gs(d),f.c(),f.m(i,null))},i:j,o:j,d(d){d&&k(e),u.d(),f&&f.d(),l=!1,o()}}}function md(t,e,i){let n,s,{selectionStore:r}=e;const{isSaved:l,selection:o}=r;oe(t,l,f=>i(2,n=f)),oe(t,o,f=>i(3,s=f));let{isRegion:a=r.type!=="documentSet"}=e;const c=()=>r.empty(),u=()=>r.save();return t.$$set=f=>{"selectionStore"in f&&i(0,r=f.selectionStore),"isRegion"in f&&i(1,a=f.isRegion)},[r,a,n,s,l,o,c,u]}class gd extends de{constructor(e){super(),fe(this,e,md,pd,ue,{selectionStore:0,isRegion:1})}}function Ys(t,e,i){const n=t.slice();return n[31]=e[i],n}function Js(t,e,i){const n=t.slice();return n[31]=e[i],n}function _d(t){let e,i,n,s,r,l;return{c(){e=b("span"),i=W(t[10]),n=N(),s=b("span"),s.innerHTML='<i class="fas fa-edit"></i>',p(s,"class","pl-3 smaller has-text-link")},m(o,a){S(o,e,a),_(e,i),_(e,n),_(e,s),r||(l=[re(e,"click",t[14]),re(e,"keyup",null)],r=!0)},p(o,a){a[0]&1024&&ce(i,o[10])},d(o){o&&k(e),r=!1,Ie(l)}}}function vd(t){let e,i,n;return{c(){e=b("input"),p(e,"class","input selection-title svelte-fumu7c")},m(s,r){S(s,e,r),t[23](e),Mt(e,t[5]),i||(n=[re(e,"input",t[24]),re(e,"keydown",t[15]),re(e,"blur",t[16])],i=!0)},p(s,r){r[0]&32&&e.value!==s[5]&&Mt(e,s[5])},d(s){s&&k(e),t[23](null),i=!1,Ie(n)}}}function Xs(t){let e,i,n;function s(){return t[25](t[31])}return{c(){e=b("button"),p(e,"class","tag is-delete")},m(r,l){S(r,e,l),i||(n=re(e,"click",s),i=!0)},p(r,l){t=r},d(r){r&&k(e),i=!1,n()}}}function Qs(t,e){let i,n,s=e[31].username+"",r,l,o,a=e[9]&&Xs(e);return{key:t,first:null,c(){i=b("div"),n=b("span"),r=W(s),l=N(),a&&a.c(),o=N(),p(n,"class","tag"),p(i,"class","tags has-addons svelte-fumu7c"),this.first=i},m(c,u){S(c,i,u),_(i,n),_(n,r),_(i,l),a&&a.m(i,null),_(i,o)},p(c,u){e=c,u[0]&256&&s!==(s=e[31].username+"")&&ce(r,s),e[9]?a?a.p(e,u):(a=Xs(e),a.c(),a.m(i,o)):a&&(a.d(1),a=null)},d(c){c&&k(i),a&&a.d()}}}function Zs(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g=V==="en"?"Make public":"Rendre public",v,w,O,L=t[7].length>0&&er(t);return{c(){var C;e=b("div"),i=b("div"),n=b("div"),s=b("p"),r=b("input"),l=N(),o=b("span"),o.innerHTML='<i class="fas fa-search"></i>',a=N(),L&&L.c(),c=N(),u=b("div"),f=b("label"),d=b("input"),m=N(),v=W(g),p(r,"class","input svelte-fumu7c"),p(r,"placeholder","Search users…"),p(o,"class","icon is-small is-right"),p(s,"class","control is-expanded has-icons-right"),p(n,"class","field"),p(i,"class","dropdown-trigger"),p(e,"class","dropdown is-active"),p(d,"type","checkbox"),d.checked=h=(C=t[2])==null?void 0:C.is_public,p(f,"class","checkbox"),p(u,"class","field mt-3 is-right")},m(C,T){S(C,e,T),_(e,i),_(i,n),_(n,s),_(s,r),Mt(r,t[6]),_(s,l),_(s,o),_(e,a),L&&L.m(e,null),S(C,c,T),S(C,u,T),_(u,f),_(f,d),_(f,m),_(f,v),w||(O=[re(r,"input",t[26]),re(r,"input",t[17]),re(d,"change",t[28])],w=!0)},p(C,T){var $;T[0]&64&&r.value!==C[6]&&Mt(r,C[6]),C[7].length>0?L?L.p(C,T):(L=er(C),L.c(),L.m(e,null)):L&&(L.d(1),L=null),T[0]&4&&h!==(h=($=C[2])==null?void 0:$.is_public)&&(d.checked=h)},d(C){C&&k(e),L&&L.d(),C&&k(c),C&&k(u),w=!1,Ie(O)}}}function er(t){let e,i,n=t[7],s=[];for(let r=0;r<n.length;r+=1)s[r]=tr(Ys(t,n,r));return{c(){e=b("div"),i=b("div");for(let r=0;r<s.length;r+=1)s[r].c();p(i,"class","dropdown-content"),p(e,"class","dropdown-menu"),p(e,"id","dropdown-menu"),p(e,"role","menu")},m(r,l){S(r,e,l),_(e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,null)},p(r,l){if(l[0]&262272){n=r[7];let o;for(o=0;o<n.length;o+=1){const a=Ys(r,n,o);s[o]?s[o].p(a,l):(s[o]=tr(a),s[o].c(),s[o].m(i,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},d(r){r&&k(e),st(s,r)}}}function tr(t){let e,i=t[31].username+"",n,s,r,l;function o(){return t[27](t[31])}return{c(){e=b("div"),n=W(i),s=N(),p(e,"class","dropdown-item")},m(a,c){S(a,e,c),_(e,n),_(e,s),r||(l=[re(e,"click",o),re(e,"keydown",null)],r=!0)},p(a,c){t=a,c[0]&128&&i!==(i=t[31].username+"")&&ce(n,i)},d(a){a&&k(e),r=!1,Ie(l)}}}function bd(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g,v,w,O,L,C=[],T=new Map,$,F,E,P,G,ee;function M(ne,be){return ne[3]?vd:_d}let H=M(t),z=H(t);const q=t[22].default,U=Ge(q,t,t[21],null);let se=t[8];const Y=ne=>ne[31].id;for(let ne=0;ne<se.length;ne+=1){let be=Js(t,se,ne),ke=Y(be);T.set(ke,C[ne]=Qs(ke,be))}let te=t[9]&&Zs(t);return E=new gd({props:{selectionStore:t[0]}}),{c(){e=b("div"),i=b("div"),n=N(),s=b("div"),r=b("div"),l=b("div"),o=b("i"),a=N(),z.c(),c=W(`

                (`),u=W(t[1]),f=W(")"),d=N(),h=b("button"),m=N(),g=b("section"),U&&U.c(),v=N(),w=b("h4"),w.textContent=`${V==="en"?"Shared with":"Partagé avec"}`,O=N(),L=b("div");for(let ne=0;ne<C.length;ne+=1)C[ne].c();$=N(),te&&te.c(),F=N(),Z(E.$$.fragment),p(i,"class","modal-background"),p(o,"class","fa-solid fa-book-bookmark"),p(l,"class","title is-4 mb-0 media-content"),p(h,"class","delete media-left"),p(h,"aria-label","close"),p(r,"class","modal-card-head media mb-0 is-middle"),p(L,"class","field is-grouped is-grouped-multiline"),p(g,"class","modal-card-body"),p(s,"class","modal-content"),p(e,"id","selection-modal"),p(e,"class","modal fade"),p(e,"tabindex","-1"),p(e,"aria-labelledby","selection-modal-label"),p(e,"aria-hidden","true")},m(ne,be){S(ne,e,be),_(e,i),_(e,n),_(e,s),_(s,r),_(r,l),_(l,o),_(l,a),z.m(l,null),_(l,c),_(l,u),_(l,f),_(r,d),_(r,h),_(s,m),_(s,g),U&&U.m(g,null),_(g,v),_(g,w),_(g,O),_(g,L);for(let ke=0;ke<C.length;ke+=1)C[ke]&&C[ke].m(L,null);_(g,$),te&&te.m(g,null),_(s,F),X(E,s,null),P=!0,G||(ee=ui(Tr.call(null,e)),G=!0)},p(ne,be){H===(H=M(ne))&&z?z.p(ne,be):(z.d(1),z=H(ne),z&&(z.c(),z.m(l,c))),(!P||be[0]&2)&&ce(u,ne[1]),U&&U.p&&(!P||be[0]&2097152)&&Je(U,q,ne,ne[21],P?Ye(q,ne[21],be,null):Xe(ne[21]),null),be[0]&525056&&(se=ne[8],C=Ut(C,be,Y,1,ne,se,T,L,eo,Qs,null,Js)),ne[9]?te?te.p(ne,be):(te=Zs(ne),te.c(),te.m(g,null)):te&&(te.d(1),te=null);const ke={};be[0]&1&&(ke.selectionStore=ne[0]),E.$set(ke)},i(ne){P||(R(U,ne),R(E.$$.fragment,ne),P=!0)},o(ne){D(U,ne),D(E.$$.fragment,ne),P=!1},d(ne){ne&&k(e),z.d(),U&&U.d(ne);for(let be=0;be<C.length;be+=1)C[be].d();te&&te.d(),Q(E),G=!1,ee()}}}function yd(t,e,i){let n,s,r,l,o,{$$slots:a={},$$scope:c}=e;const{selected:u}=po;oe(t,u,Y=>i(2,l=Y));let{selectionStore:f}=e,{selectionLength:d=!1}=e;const{selectionTitle:h,updateTitle:m,updatePublic:g,save:v}=f;oe(t,h,Y=>i(10,o=Y));let w=!1,O,L;function C(){i(3,w=!0),i(5,L=o),setTimeout(()=>O==null?void 0:O.focus(),0)}function T(Y){Y.key==="Enter"&&$()}function $(){i(3,w=!1),m(L),v()}let F="",E=[];async function P(){if(F.trim().length<1){i(7,E=[]);return}const te=await(await fetch(`${window.location.origin}/search/user?q=${encodeURIComponent(F)}`)).json();i(7,E=te.users||[])}function G(Y){f.add({id:Y.id,class:"User",title:Y.username}),i(6,F=""),i(7,E=[])}function ee(Y){f.remove(Y,"User")}function M(Y){Hi[Y?"unshift":"push"](()=>{O=Y,i(4,O)})}function H(){L=this.value,i(5,L)}const z=Y=>ee(Y.id);function q(){F=this.value,i(6,F)}const U=Y=>G(Y),se=Y=>g(Y.target.checked);return t.$$set=Y=>{"selectionStore"in Y&&i(0,f=Y.selectionStore),"selectionLength"in Y&&i(1,d=Y.selectionLength),"$$scope"in Y&&i(21,c=Y.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&4&&i(20,n=l==null?void 0:l.owner_id),t.$$.dirty[0]&1048576&&i(9,s=so||n===ai),t.$$.dirty[0]&4&&i(8,r=Object.entries((l==null?void 0:l.User)||{}).map(([Y,te])=>({id:Number(Y),username:te.title})))},[f,d,l,w,O,L,F,E,r,s,o,u,h,g,C,T,$,P,G,ee,n,c,a,M,H,z,q,U,se]}class wd extends de{constructor(e){super(),fe(this,e,yd,bd,ue,{selectionStore:0,selectionLength:1},null,[-1,-1])}}function kd(){const t=`${window.location.origin}${window.location.pathname}`,e=49,i=Ee(1),n=Ee([]),s=Ee([]),r=(async()=>{const u=await fetch(`${t}vectorized-images`).then(f=>f.json()).then(f=>(n.set(f),f)).catch(f=>console.error("Error:",f));return c(l()),u})(),l=()=>sn(i,"vp"),o=Be(i,u=>(async()=>a(u))());function a(u){const f=(u-1)*e,d=f+e,h=Zi(n).slice(f,d);return s.set(h),h}function c(u){rn(u,i,"vp")}return{currentPage:i,pageLength:e,vectImgs:n,fetchVectorization:r,setPageVectImgs:o,pageVectImgs:s,handlePageUpdate:c}}const vi=kd();function ir(t){let e,i;return{c(){e=new zl(!1),i=he(),e.a=i},m(n,s){e.m(t[5],n,s),S(n,i,s)},p(n,s){s&32&&e.p(n[5])},d(n){n&&k(i),n&&e.d()}}}function nr(t){let e,i,n;var s=t[9];function r(l){return{props:{mainImgItem:l[15],compareImgItem:l[13],svgItem:l[1]}}}return s&&(e=fi(s,r(t))),{c(){e&&Z(e.$$.fragment),i=he()},m(l,o){e&&X(e,l,o),S(l,i,o),n=!0},p(l,o){const a={};if(o&2&&(a.svgItem=l[1]),o&512&&s!==(s=l[9])){if(e){_e();const c=e;D(c.$$.fragment,1,0,()=>{Q(c,1)}),ve()}s?(e=fi(s,r(l)),Z(e.$$.fragment),R(e.$$.fragment,1),X(e,i.parentNode,i)):e=null}else s&&e.$set(a)},i(l){n||(e&&R(e.$$.fragment,l),n=!0)},o(l){e&&D(e.$$.fragment,l),n=!1},d(l){l&&k(i),e&&Q(e,l)}}}function Sd(t){let e,i,n,s,r,l,o,a,c,u,f,d,h,m,g,v,w,O,L=!t[6]&&t[5]&&ir(t),C=t[9]&&nr(t);return{c(){e=b("div"),i=b("figure"),n=b("div"),L&&L.c(),s=N(),r=b("img"),o=N(),a=b("div"),c=b("a"),u=b("i"),f=N(),d=b("span"),d.textContent=`${V==="en"?"Download SVG":"Télécharger le SVG"}`,h=N(),C&&C.c(),p(n,"class","svg-container svelte-78b4ls"),p(r,"class","region-img svelte-78b4ls"),We(r.src,l=t[12])||p(r,"src",l),p(r,"alt","Extracted region"),p(i,"class","image card region-image svelte-78b4ls"),$e(i,"width",t[3]?"50%":`${t[2]}px`),$e(i,"aspect-ratio",t[7]?t[7].split(" ")[2]/t[7].split(" ")[3]:1),p(u,"class","fa-solid fa-download"),p(d,"class","tooltip svelte-78b4ls"),p(c,"class","button tag svelte-78b4ls"),p(c,"href",t[8]),p(c,"download",t[1]),p(a,"class","region-btn ml-1 svelte-78b4ls"),p(e,"class",m="region is-center "+(t[4]&&t[10](t[15])?"checked":"")+" svelte-78b4ls")},m(T,$){S(T,e,$),_(e,i),_(i,n),L&&L.m(n,null),_(i,s),_(i,r),_(e,o),_(e,a),_(a,c),_(c,u),_(c,f),_(c,d),_(a,h),C&&C.m(a,null),v=!0,w||(O=[re(i,"click",t[17]),re(i,"keyup",null),re(i,"mouseenter",t[18]),re(i,"mouseleave",t[19])],w=!0)},p(T,[$]){t=T,!t[6]&&t[5]?L?L.p(t,$):(L=ir(t),L.c(),L.m(n,null)):L&&(L.d(1),L=null),(!v||$&12)&&$e(i,"width",t[3]?"50%":`${t[2]}px`),(!v||$&128)&&$e(i,"aspect-ratio",t[7]?t[7].split(" ")[2]/t[7].split(" ")[3]:1),(!v||$&256)&&p(c,"href",t[8]),(!v||$&2)&&p(c,"download",t[1]),t[9]?C?(C.p(t,$),$&512&&R(C,1)):(C=nr(t),C.c(),R(C,1),C.m(a,null)):C&&(_e(),D(C,1,1,()=>{C=null}),ve()),(!v||$&1040&&m!==(m="region is-center "+(t[4]&&t[10](t[15])?"checked":"")+" svelte-78b4ls"))&&p(e,"class",m)},i(T){v||(R(C),Ze(()=>{v&&(g||(g=nt(e,mt,{duration:t[14]},!0)),g.run(1))}),v=!0)},o(T){D(C),g||(g=nt(e,mt,{duration:t[14]},!1)),g.run(0),v=!1},d(T){T&&k(e),L&&L.d(),C&&C.d(),T&&g&&g.end(),w=!1,Ie(O)}}}function Ed(t,e,i){let n,{selectionStore:s}=e;s||(s=ht);const{isSelected:r}=s;oe(t,r,M=>i(10,n=M));let{toggleSelection:l=s.toggle}=e,{svgPath:o}=e,{width:a=200}=e,{fullWidth:c=!1}=e,{selectable:u=!0}=e;const[f,d,h,m]=o.replace(".svg","").split("_"),g=gt(`${f}_${d}_${h}`,m,`${a},`);let v=!1,w="",O="",L="";const C=Ae("qImgMetadata")||void 0,T=Ae("isInModal")||!1,$=T?0:500;let F;T||Mr(()=>import("./ModalController-68284a21.js"),[]).then(M=>i(9,F=M.default));let E={ref:o,img:`${f}_${d}_${h}`,xywh:m};bi(()=>{L&&URL.revokeObjectURL(L)}),vt(async()=>{const H=await(await fetch(`${lo}svg/${o}`)).text(),q=new DOMParser().parseFromString(H,"image/svg+xml"),U=q.querySelector("svg");i(7,O=U.getAttribute("viewBox")||`0 0 ${U.getAttribute("width")} ${U.getAttribute("height")}`),q.querySelectorAll("image").forEach(se=>se.remove()),U.setAttribute("viewBox",O),U.removeAttribute("width"),U.removeAttribute("height"),i(5,w=new XMLSerializer().serializeToString(q.documentElement))});const P=()=>u?l(E):null,G=()=>i(6,v=!0),ee=()=>i(6,v=!1);return t.$$set=M=>{"selectionStore"in M&&i(16,s=M.selectionStore),"toggleSelection"in M&&i(0,l=M.toggleSelection),"svgPath"in M&&i(1,o=M.svgPath),"width"in M&&i(2,a=M.width),"fullWidth"in M&&i(3,c=M.fullWidth),"selectable"in M&&i(4,u=M.selectable)},t.$$.update=()=>{if(t.$$.dirty&32&&w){const M=new Blob([w],{type:"image/svg+xml"});i(8,L=URL.createObjectURL(M))}},[l,o,a,c,u,w,v,O,L,F,n,r,g,C,$,E,s,P,G,ee]}class Cd extends de{constructor(e){super(),fe(this,e,Ed,Sd,ue,{selectionStore:16,toggleSelection:0,svgPath:1,width:2,fullWidth:3,selectable:4})}}function Id(t){let e,i,n,s,r=V==="en"?"Download All":"Tout Télécharger",l,o,a;return{c(){e=b("div"),i=b("button"),n=b("i"),s=N(),l=W(r),p(n,"class","fa-solid fa-download"),p(i,"class","button is-link is-light"),p(e,"class","is-right mb-3")},m(c,u){S(c,e,u),_(e,i),_(i,n),_(i,s),_(i,l),o||(a=re(i,"click",t[0]),o=!0)},p:j,i:j,o:j,d(c){c&&k(e),o=!1,a()}}}function Od(t){const e=`${window.location.origin}${window.location.pathname}`,i=parseInt(e.split("witness/")[1].replace("/","")),n=parseInt(e.split("regions/")[1].replace("/",""));async function s(){if(!n&&!i){console.error("No Region or Witness");return}const r=n?`${window.location.origin}/${je}/export-regions-imgs-and-svgs/${n}`:`${window.location.origin}/${je}/export-all-imgs-and-svgs/${i}`;try{const l=await Dt(()=>fetch(r,{method:"GET",headers:{"X-CSRFToken":Ke,"Content-Type":"application/json"}}));if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const o=await l.blob();Or(o,"vectorizations.zip")}catch(l){console.error("Erreur lors du téléchargement des vectorisations:",l)}}return[s]}class Ad extends de{constructor(e){super(),fe(this,e,Od,Id,ue,{})}}function sr(t,e,i){const n=t.slice();return n[8]=e[i],n}function Td(t){let e;function i(r,l){return V==="en"?Ld:Pd}let s=i()(t);return{c(){e=b("div"),s.c(),p(e,"class","faded is-center")},m(r,l){S(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:j,o:j,d(r){r&&k(e),s.d()}}}function Pd(t){let e,i=t[11]+"",n;return{c(){e=W("Erreur lors de la récupération des régions vectorisées : "),n=W(i)},m(s,r){S(s,e,r),S(s,n,r)},p(s,r){r&2&&i!==(i=s[11]+"")&&ce(n,i)},d(s){s&&k(e),s&&k(n)}}}function Ld(t){let e,i=t[11]+"",n;return{c(){e=W("Error when retrieving vectorized regions: "),n=W(i)},m(s,r){S(s,e,r),S(s,n,r)},p(s,r){r&2&&i!==(i=s[11]+"")&&ce(n,i)},d(s){s&&k(e),s&&k(n)}}}function Md(t){let e=[],i=new Map,n,s,r=t[2];const l=a=>a[8].id;for(let a=0;a<r.length;a+=1){let c=sr(t,r,a),u=l(c);i.set(u,e[a]=lr(u,c))}let o=null;return r.length||(o=rr()),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);S(a,n,c),o&&o.m(a,c),s=!0},p(a,c){c&4&&(r=a[2],_e(),e=Ut(e,c,l,1,a,r,i,n.parentNode,Qt,lr,n,sr),ve(),!r.length&&o?o.p(a,c):r.length?o&&(o.d(1),o=null):(o=rr(),o.c(),o.m(n.parentNode,n)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)R(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)D(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),o&&o.d(a)}}}function rr(t){let e,i;return{c(){e=b("div"),e.textContent=`${V==="en"?"No vectorization":"Pas de vectorisation"}`,i=N(),p(e,"class","faded is-center")},m(n,s){S(n,e,s),S(n,i,s)},p:j,d(n){n&&k(e),n&&k(i)}}}function lr(t,e){let i,n,s;return n=new Cd({props:{svgPath:e[8]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),X(n,r,l),s=!0},p(r,l){e=r;const o={};l&4&&(o.svgPath=e[8]),n.$set(o)},i(r){s||(R(n.$$.fragment,r),s=!0)},o(r){D(n.$$.fragment,r),s=!1},d(r){r&&k(i),Q(n,r)}}}function Rd(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"Retrieving vectorization page...":"Récupération la page de vectorisation..."}`,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,i:j,o:j,d(i){i&&k(e)}}}function Dd(t){let e,i,n,s,r,l,o;e=new $t({props:{store:vi,nbOfItems:t[0].length,pageLength:t[6]}});let a={ctx:t,current:null,token:null,hasCatch:!0,pending:Rd,then:Md,catch:Td,value:7,error:11,blocks:[,,,]};return ct(s=t[1],a),l=new $t({props:{store:vi,nbOfItems:t[0].length,pageLength:t[6]}}),{c(){Z(e.$$.fragment),i=N(),n=b("div"),a.block.c(),r=N(),Z(l.$$.fragment),p(n,"class","grid is-gap-2 mx-5 svelte-1mje9rl")},m(c,u){X(e,c,u),S(c,i,u),S(c,n,u),a.block.m(n,a.anchor=null),a.mount=()=>n,a.anchor=null,S(c,r,u),X(l,c,u),o=!0},p(c,[u]){t=c;const f={};u&1&&(f.nbOfItems=t[0].length),e.$set(f),a.ctx=t,u&2&&s!==(s=t[1])&&ct(s,a)||Ft(a,t,u);const d={};u&1&&(d.nbOfItems=t[0].length),l.$set(d)},i(c){o||(R(e.$$.fragment,c),R(a.block),R(l.$$.fragment,c),o=!0)},o(c){D(e.$$.fragment,c);for(let u=0;u<3;u+=1){const f=a.blocks[u];D(f)}D(l.$$.fragment,c),o=!1},d(c){Q(e,c),c&&k(i),c&&k(n),a.block.d(),a.token=null,a=null,c&&k(r),Q(l,c)}}}function Nd(t,e,i){let n,s,r;const{vectImgs:l,pageVectImgs:o,setPageVectImgs:a,pageLength:c}=vi;return oe(t,l,u=>i(0,n=u)),oe(t,o,u=>i(2,r=u)),oe(t,a,u=>i(1,s=u)),[n,s,r,l,o,a,c]}class $d extends de{constructor(e){super(),fe(this,e,Nd,Dd,ue,{})}}function jd(t){let e,i,n={ctx:t,current:null,token:null,hasCatch:!0,pending:Bd,then:Hd,catch:Fd,value:1,error:2,blocks:[,,,]};return ct(t[0],n),{c(){e=he(),n.block.c()},m(s,r){S(s,e,r),n.block.m(s,n.anchor=r),n.mount=()=>e.parentNode,n.anchor=e,i=!0},p(s,r){t=s,Ft(n,t,r)},i(s){i||(R(n.block),i=!0)},o(s){for(let r=0;r<3;r+=1){const l=n.blocks[r];D(l)}i=!1},d(s){s&&k(e),n.block.d(s),n.token=null,n=null}}}function Fd(t){let e;function i(r,l){return V==="en"?Vd:Ud}let s=i()(t);return{c(){e=b("div"),s.c(),p(e,"class","container faded is-center")},m(r,l){S(r,e,l),s.m(e,null)},p(r,l){s.p(r,l)},i:j,o:j,d(r){r&&k(e),s.d()}}}function Ud(t){let e,i=t[2]+"",n;return{c(){e=W("Erreur lors de la récupération des régions vectorisées : "),n=W(i)},m(s,r){S(s,e,r),S(s,n,r)},p:j,d(s){s&&k(e),s&&k(n)}}}function Vd(t){let e,i=t[2]+"",n;return{c(){e=W("Error when retrieving vectorized regions: "),n=W(i)},m(s,r){S(s,e,r),S(s,n,r)},p:j,d(s){s&&k(e),s&&k(n)}}}function Hd(t){let e,i;return e=new $d({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function Bd(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"Retrieving vectorized regions...":"Récupération des régions vectorisées..."}`,p(e,"class","container faded is-center")},m(i,n){S(i,e,n)},p:j,i:j,o:j,d(i){i&&k(e)}}}function zd(t){let e=Rt.includes("vectorization"),i,n,s=e&&jd(t);return{c(){s&&s.c(),i=he()},m(r,l){s&&s.m(r,l),S(r,i,l),n=!0},p(r,[l]){e&&s.p(r,l)},i(r){n||(R(s),n=!0)},o(r){D(s),n=!1},d(r){s&&s.d(r),r&&k(i)}}}function qd(t){const{fetchVectorization:e}=vi;return[e]}class Kd extends de{constructor(e){super(),fe(this,e,qd,zd,ue,{})}}function xd(t){let e,i;return{c(){e=b("iframe"),We(e.src,i=t[0])||p(e,"src",i),$e(e,"width","100%"),$e(e,"height","75vh"),$e(e,"border","none"),p(e,"title","Mirador viewer"),e.allowFullscreen=!0},m(n,s){S(n,e,s)},p(n,[s]){s&1&&!We(e.src,i=n[0])&&p(e,"src",i)},i:j,o:j,d(n){n&&k(e)}}}function Wd(t,e,i){let n="";return vt(()=>{manifests.length>0&&i(0,n=Nt(manifests[0]));function s(r){i(0,n=Nt(r.detail.selectedManifest))}window.addEventListener("selectManifest",s)}),[n]}class Gd extends de{constructor(e){super(),fe(this,e,Wd,xd,ue,{})}}function or(t,e,i){const n=t.slice();return n[5]=e[i],n}function ar(t){let e,i=t[3](t[5])+"",n,s,r;return{c(){e=b("option"),n=W(i),s=N(),e.__value=r=t[5],e.value=e.__value},m(l,o){S(l,e,o),_(e,n),_(e,s)},p(l,o){o&1&&i!==(i=l[3](l[5])+"")&&ce(n,i),o&1&&r!==(r=l[5])&&(e.__value=r,e.value=e.__value)},d(l){l&&k(e)}}}function Yd(t){let e,i,n,s,r,l,o,a,c=t[0],u=[];for(let f=0;f<c.length;f+=1)u[f]=ar(or(t,c,f));return{c(){e=b("div"),i=b("label"),i.textContent=`${V==="en"?"Digitization:":"Numérisation :"}`,n=N(),s=b("div"),r=b("div"),l=b("select");for(let f=0;f<u.length;f+=1)u[f].c();p(i,"for","digit"),p(i,"class","label"),t[1]===void 0&&Ze(()=>t[4].call(l)),p(r,"class","select is-small"),p(s,"id","digit"),p(s,"class","control pl-3"),p(e,"class","field selector is-flex is-right mb-2")},m(f,d){S(f,e,d),_(e,i),_(e,n),_(e,s),_(s,r),_(r,l);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(l,null);Cn(l,t[1],!0),o||(a=[re(l,"change",t[4]),re(l,"change",t[2])],o=!0)},p(f,[d]){if(d&9){c=f[0];let h;for(h=0;h<c.length;h+=1){const m=or(f,c,h);u[h]?u[h].p(m,d):(u[h]=ar(m),u[h].c(),u[h].m(l,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=c.length}d&3&&Cn(l,f[1])},i:j,o:j,d(f){f&&k(e),st(u,f),o=!1,Ie(a)}}}function Jd(t,e,i){let{manifests:n}=e,s=(n==null?void 0:n[0])||"";function r(a){i(1,s=a.target.value),window.dispatchEvent(new CustomEvent("selectManifest",{detail:{selectedManifest:s}}))}function l(a){const c=a.match(/man(\d+)/),u=c?c[1]:"?",f=a.match(/anno(\d+)/),d=f?f[1]:null;let h="";return h+=`${V==="en"?"Manifest":"Manifeste"} #${u}`,d&&(h+=`, ${V==="en"?"Regions extraction":"Extraction de régions"} #${d}`),h}function o(){s=Bl(this),i(1,s),i(0,n)}return t.$$set=a=>{"manifests"in a&&i(0,n=a.manifests)},[n,s,r,l,o]}class Xd extends de{constructor(e){super(),fe(this,e,Jd,Yd,ue,{manifests:0})}}function cr(t,e,i){const n=t.slice();return n[25]=e[i][0],n[26]=e[i][1],n}function ur(t,e,i){const n=t.slice();return n[29]=e[i][0],n[30]=e[i][1],n}function fr(t,e,i){const n=t.slice();return n[35]=e[i],n}function Qd(t){let e,i,n;return i=new Do({props:{witness:t[1],editUrl:t[2],viewTitle:t[3]}}),{c(){e=b("div"),Z(i.$$.fragment),p(e,"slot","sidebar")},m(s,r){S(s,e,r),X(i,e,null),n=!0},p(s,r){const l={};r[0]&2&&(l.witness=s[1]),r[0]&4&&(l.editUrl=s[2]),r[0]&8&&(l.viewTitle=s[3]),i.$set(l)},i(s){n||(R(i.$$.fragment,s),n=!0)},o(s){D(i.$$.fragment,s),n=!1},d(s){s&&k(e),Q(i)}}}function Zd(t){let e,i,n,s,r,l,o,a,c,u,f,d,h;s=new ia({props:{baseUrl:t[15],currentRegionId:t[16],activeTab:t[33]}});const m=[nh,ih,th],g=[];function v(C,T){return C[33]==="all"||C[33]==="page"?0:C[33]==="viewer"?1:C[33]==="vectorization"?2:-1}~(o=v(t))&&(a=g[o]=m[o](t));const w=[ah,oh,lh,rh,sh],O=[];function L(C,T){return C[33]==="viewer"?0:C[33]==="all"?1:C[33]==="page"?2:C[33]==="similarity"?3:C[33]==="vectorization"?4:-1}return~(u=L(t))&&(f=O[u]=w[u](t)),{c(){e=b("div"),i=b("div"),n=b("div"),Z(s.$$.fragment),r=N(),l=b("div"),a&&a.c(),c=N(),f&&f.c(),d=he(),p(n,"class","cell is-left"),p(l,"class","cell"),p(i,"class","actions grid"),p(e,"id","nav-actions")},m(C,T){S(C,e,T),_(e,i),_(i,n),X(s,n,null),_(i,r),_(i,l),~o&&g[o].m(l,null),S(C,c,T),~u&&O[u].m(C,T),S(C,d,T),h=!0},p(C,T){const $={};T[1]&4&&($.activeTab=C[33]),s.$set($);let F=o;o=v(C),o===F?~o&&g[o].p(C,T):(a&&(_e(),D(g[F],1,1,()=>{g[F]=null}),ve()),~o?(a=g[o],a?a.p(C,T):(a=g[o]=m[o](C),a.c()),R(a,1),a.m(l,null)):a=null);let E=u;u=L(C),u===E?~u&&O[u].p(C,T):(f&&(_e(),D(O[E],1,1,()=>{O[E]=null}),ve()),~u?(f=O[u],f?f.p(C,T):(f=O[u]=w[u](C),f.c()),R(f,1),f.m(d.parentNode,d)):f=null)},i(C){h||(R(s.$$.fragment,C),R(a),R(f),h=!0)},o(C){D(s.$$.fragment,C),D(a),D(f),h=!1},d(C){C&&k(e),Q(s),~o&&g[o].d(),C&&k(c),~u&&O[u].d(C),C&&k(d)}}}function eh(t){let e,i;return{c(){e=b("article"),i=b("div"),i.textContent=`${V==="en"?"This witness has no digitization.":"Ce témoin n'a pas de numérisation."}`,p(i,"class","message-body"),p(e,"class","message is-warning")},m(n,s){S(n,e,s),_(e,i)},p:j,i:j,o:j,d(n){n&&k(e)}}}function th(t){let e,i;return e=new Ad({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function ih(t){let e,i;return e=new Xd({props:{manifests:t[0]}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p(n,s){const r={};s[0]&1&&(r.manifests=n[0]),e.$set(r)},i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function nh(t){let e,i;return e=new ua({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function sh(t){let e,i;return e=new Kd({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function rh(t){let e,i;return e=new ed({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function lh(t){let e,i;return e=new fd({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function oh(t){let e,i,n={ctx:t,current:null,token:null,hasCatch:!0,pending:fh,then:uh,catch:ch,value:34,error:38,blocks:[,,,]};return ct(t[14],n),{c(){e=b("div"),n.block.c(),p(e,"class","grid is-gap-2 mt-5")},m(s,r){S(s,e,r),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,i=!0},p(s,r){t=s,Ft(n,t,r)},i(s){i||(R(n.block),i=!0)},o(s){for(let r=0;r<3;r+=1){const l=n.blocks[r];D(l)}i=!1},d(s){s&&k(e),n.block.d(),n.token=null,n=null}}}function ah(t){let e,i;return e=new Gd({}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function ch(t){let e,i,n=t[38]+"",s;return{c(){e=b("div"),i=W("Error when retrieving regions: "),s=W(n)},m(r,l){S(r,e,l),_(e,i),_(e,s)},p:j,i:j,o:j,d(r){r&&k(e)}}}function uh(t){let e=[],i=new Map,n,s,r=Object.values(t[9]);const l=a=>a[35].id;for(let a=0;a<r.length;a+=1){let c=fr(t,r,a),u=l(c);i.set(u,e[a]=hr(u,c))}let o=null;return r.length||(o=dr(t)),{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he(),o&&o.c()},m(a,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,c);S(a,n,c),o&&o.m(a,c),s=!0},p(a,c){c[0]&98816&&(r=Object.values(a[9]),_e(),e=Ut(e,c,l,1,a,r,i,n.parentNode,Qt,hr,n,fr),ve(),!r.length&&o?o.p(a,c):r.length?o&&(_e(),D(o,1,1,()=>{o=null}),ve()):(o=dr(a),o.c(),R(o,1),o.m(n.parentNode,n)))},i(a){if(!s){for(let c=0;c<r.length;c+=1)R(e[c]);s=!0}},o(a){for(let c=0;c<e.length;c+=1)D(e[c]);s=!1},d(a){for(let c=0;c<e.length;c+=1)e[c].d(a);a&&k(n),o&&o.d(a)}}}function dr(t){let e,i;return e=new Rr({props:{currentRegionId:t[16],baseUrl:t[15]}}),{c(){Z(e.$$.fragment)},m(n,s){X(e,n,s),i=!0},p:j,i(n){i||(R(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Q(e,n)}}}function hr(t,e){let i,n,s;return n=new an({props:{item:e[35]}}),{key:t,first:null,c(){i=he(),Z(n.$$.fragment),this.first=i},m(r,l){S(r,i,l),X(n,r,l),s=!0},p(r,l){e=r;const o={};l[0]&512&&(o.item=e[35]),n.$set(o)},i(r){s||(R(n.$$.fragment,r),s=!0)},o(r){D(n.$$.fragment,r),s=!1},d(r){r&&k(i),Q(n,r)}}}function fh(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"Retrieving regions...":"Récupération des régions..."}`,p(e,"class","faded is-center")},m(i,n){S(i,e,n)},p:j,i:j,o:j,d(i){i&&k(e)}}}function dh(t){let e,i,n,s;const r=[eh,Zd],l=[];function o(a,c){return a[0].length===0?0:1}return i=o(t),n=l[i]=r[i](t),{c(){e=b("div"),n.c(),p(e,"slot","content")},m(a,c){S(a,e,c),l[i].m(e,null),s=!0},p(a,c){let u=i;i=o(a),i===u?l[i].p(a,c):(_e(),D(l[u],1,1,()=>{l[u]=null}),ve(),n=l[i],n?n.p(a,c):(n=l[i]=r[i](a),n.c()),R(n,1),n.m(e,null))},i(a){s||(R(n),s=!0)},o(a){D(n),s=!1},d(a){a&&k(e),l[i].d()}}}function hh(t){let e;return{c(){e=b("div"),e.textContent=`${V==="en"?"No regions in selection":"Aucune région sélectionnée"}`},m(i,n){S(i,e,n)},p:j,d(i){i&&k(e)}}}function ph(t){let e,i,n=Object.entries(t[7]),s=[];for(let r=0;r<n.length;r+=1)s[r]=mr(cr(t,n,r));return{c(){e=b("div"),i=b("div");for(let r=0;r<s.length;r+=1)s[r].c();p(i,"class","grid is-gap-2"),p(e,"class","fixed-grid has-6-cols")},m(r,l){S(r,e,l),_(e,i);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(i,null)},p(r,l){if(l[0]&4224){n=Object.entries(r[7]);let o;for(o=0;o<n.length;o+=1){const a=cr(r,n,o);s[o]?s[o].p(a,l):(s[o]=mr(a),s[o].c(),s[o].m(i,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=n.length}},d(r){r&&k(e),st(s,r)}}}function pr(t){let e,i,n,s,r,l,o,a=t[30].title+"",c,u,f,d,h,m;function g(){return t[24](t[29])}return{c(){e=b("div"),i=b("figure"),n=b("img"),r=N(),l=b("div"),o=b("span"),c=W(a),u=N(),f=b("button"),d=N(),We(n.src,s=gt(t[30].img,t[30].xywh,"96,"))||p(n,"src",s),p(n,"alt",""),p(o,"class","overlay-desc"),p(l,"class","overlay is-center svelte-qn8evk"),p(i,"class","image is-64x64 card"),p(f,"class","delete region-btn"),p(e,"class","selection cell svelte-qn8evk")},m(v,w){S(v,e,w),_(e,i),_(i,n),_(i,r),_(i,l),_(l,o),_(o,c),_(e,u),_(e,f),_(e,d),h||(m=re(f,"click",g),h=!0)},p(v,w){t=v,w[0]&128&&!We(n.src,s=gt(t[30].img,t[30].xywh,"96,"))&&p(n,"src",s),w[0]&128&&a!==(a=t[30].title+"")&&ce(c,a)},d(v){v&&k(e),h=!1,m()}}}function mr(t){let e,i=Object.entries(t[26]),n=[];for(let s=0;s<i.length;s+=1)n[s]=pr(ur(t,i,s));return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=he()},m(s,r){for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(s,r);S(s,e,r)},p(s,r){if(r[0]&4224){i=Object.entries(s[26]);let l;for(l=0;l<i.length;l+=1){const o=ur(s,i,l);n[l]?n[l].p(o,r):(n[l]=pr(o),n[l].c(),n[l].m(e.parentNode,e))}for(;l<n.length;l+=1)n[l].d(1);n.length=i.length}},d(s){st(n,s),s&&k(e)}}}function mh(t){let e;function i(r,l){return r[6]?ph:hh}let n=i(t),s=n(t);return{c(){s.c(),e=he()},m(r,l){s.m(r,l),S(r,e,l)},p(r,l){n===(n=i(r))&&s?s.p(r,l):(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},d(r){s.d(r),r&&k(e)}}}function gh(t){let e,i,n,s,r,l,o,a,c,u;return e=new Lr({props:{visible:t[8]}}),n=new ko({}),r=new xo({props:{selectionLength:t[4]}}),o=new Lo({props:{tabList:t[5],$$slots:{content:[dh,({activeTab:f})=>({33:f}),({activeTab:f})=>[0,f?4:0]],sidebar:[Qd,({activeTab:f})=>({33:f}),({activeTab:f})=>[0,f?4:0]]},$$scope:{ctx:t}}}),c=new wd({props:{selectionLength:t[4],selectionStore:ht,$$slots:{default:[mh]},$$scope:{ctx:t}}}),{c(){Z(e.$$.fragment),i=N(),Z(n.$$.fragment),s=N(),Z(r.$$.fragment),l=N(),Z(o.$$.fragment),a=N(),Z(c.$$.fragment)},m(f,d){X(e,f,d),S(f,i,d),X(n,f,d),S(f,s,d),X(r,f,d),S(f,l,d),X(o,f,d),S(f,a,d),X(c,f,d),u=!0},p(f,d){const h={};d[0]&256&&(h.visible=f[8]),e.$set(h);const m={};d[0]&16&&(m.selectionLength=f[4]),r.$set(m);const g={};d[0]&32&&(g.tabList=f[5]),d[0]&527|d[1]&260&&(g.$$scope={dirty:d,ctx:f}),o.$set(g);const v={};d[0]&16&&(v.selectionLength=f[4]),d[0]&192|d[1]&256&&(v.$$scope={dirty:d,ctx:f}),c.$set(v)},i(f){u||(R(e.$$.fragment,f),R(n.$$.fragment,f),R(r.$$.fragment,f),R(o.$$.fragment,f),R(c.$$.fragment,f),u=!0)},o(f){D(e.$$.fragment,f),D(n.$$.fragment,f),D(r.$$.fragment,f),D(o.$$.fragment,f),D(c.$$.fragment,f),u=!1},d(f){Q(e,f),f&&k(i),Q(n,f),f&&k(s),Q(r,f),f&&k(l),Q(o,f),f&&k(a),Q(c,f)}}}function _h(t,e,i){let n,s,r,l,o,a,c;oe(t,Et,M=>i(8,a=M));const{selected:u,nbSelected:f,remove:d}=ht;oe(t,u,M=>i(23,o=M)),oe(t,f,M=>i(22,l=M));const{allRegions:h,fetchAll:m}=_t;oe(t,h,M=>i(9,c=M));let{manifest:g=""}=e,{manifests:v=[]}=e,{isValidated:w=!1}=e,{imgPrefix:O=""}=e,{nbOfPages:L=1}=e,{trailingZeros:C=1}=e,{witness:T={}}=e,{editUrl:$=""}=e,{viewTitle:F=""}=e;lt("witness",T),lt("nbOfPages",L),lt("trailingZeros",C),lt("imgPrefix",O),lt("manifest",g),lt("isValidated",w);const E=`${window.location.origin}${window.location.pathname}`,P=parseInt(E.split("regions/")[1].replace("/","")),G={viewer:V==="en"?"Viewer":"Visionneuse",all:V==="en"?"All regions":"Toutes les régions",page:V==="en"?"Per page":"Par page"};Rt.includes("similarity")&&(G.similarity=V==="en"?"Similarity":"Similarité"),Rt.includes("vectorization")&&(G.vectorization=V==="en"?"Vectorization":"Vectorisation");const ee=M=>d(M,pi);return t.$$set=M=>{"manifest"in M&&i(17,g=M.manifest),"manifests"in M&&i(0,v=M.manifests),"isValidated"in M&&i(18,w=M.isValidated),"imgPrefix"in M&&i(19,O=M.imgPrefix),"nbOfPages"in M&&i(20,L=M.nbOfPages),"trailingZeros"in M&&i(21,C=M.trailingZeros),"witness"in M&&i(1,T=M.witness),"editUrl"in M&&i(2,$=M.editUrl),"viewTitle"in M&&i(3,F=M.viewTitle)},t.$$.update=()=>{t.$$.dirty[0]&8388608&&i(7,n=o),t.$$.dirty[0]&4194304&&i(4,s=l),t.$$.dirty[0]&16&&i(6,r=s>0)},[v,T,$,F,s,G,r,n,a,c,u,f,d,h,m,E,P,g,w,O,L,C,l,o,ee]}class vh extends de{constructor(e){super(),fe(this,e,_h,gh,ue,{manifest:17,manifests:0,isValidated:18,imgPrefix:19,nbOfPages:20,trailingZeros:21,witness:1,editUrl:2,viewTitle:3},null,[-1,-1])}}new vh({target:document.getElementById("witness-view"),props:{viewTitle,editUrl,witness,manifest,manifests,isValidated,imgPrefix,nbOfPages,trailingZeros}});export{_e as A,ve as B,st as C,Ie as D,tn as E,vt as F,bi as G,W as H,Ct as I,Rl as J,Qe as K,lt as L,Zr as M,pl as N,Ee as O,ze as P,Ae as Q,an as R,de as S,ki as T,Gc as U,Cd as V,Ya as W,Mr as _,p as a,S as b,Z as c,D as d,b as e,k as f,Q as g,ct as h,fe as i,N as j,We as k,V as l,X as m,_ as n,j as o,wh as p,$e as q,gt as r,ue as s,R as t,Ft as u,fi as v,qe as w,re as x,bh as y,yh as z};
//# sourceMappingURL=witness.js.map
