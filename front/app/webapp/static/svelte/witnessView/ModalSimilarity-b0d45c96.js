import{S as e,i as t,s as a,M as i,l as r,N as n,e as s,j as l,c as m,a as o,k as c,w as g,q as p,b as u,n as f,m as $,x as d,t as y,d as v,f as I,g as h,O as w,L as x,P as z,A as b,B as q,C as D,Q as V,R as S,H as U,U as O,r as j,o as C}from"./witness-488d31e3.js";function _(e){let t,a,w,x,z,b,q,D,V,S,U,O,j,C,_,R,T,B,P,k,F,M,L,N,Q,H,A,E,G,J,K,W,X,Y,Z,ee,te,ae,ie;return V=new i({props:{minVal:0,maxVal:1,start:e[5],emitOnUpdate:!0,title:"fr"===r?"Opacité":"Opacity"}}),V.$on("updateSlider",e[9]),O=new i({props:{minVal:0,maxVal:360,start:e[6],step:1,emitOnUpdate:!0,title:"Rotation"}}),O.$on("updateSlider",e[10]),_=new i({props:{minVal:0,maxVal:200,step:1,start:e[7],emitOnUpdate:!0,title:"fr"===r?"Redimensionner":"Scale"}}),_.$on("updateSlider",e[11]),B=new i({props:{minVal:-100,maxVal:100,step:1,start:e[8][0],emitOnUpdate:!0,title:"fr"===r?"Translation horizontale":"Horizontal translate"}}),B.$on("updateSlider",e[12]),F=new i({props:{minVal:-100,maxVal:100,step:1,start:e[8][1],emitOnUpdate:!0,title:"fr"===r?"Translation verticale":"Vertical translate"}}),F.$on("updateSlider",e[13]),N=new n({props:{choicesItems:e[4],start:[],lightDisplay:!0,placeholder:"fr"===r?"Sélectionner":"Select",title:"fr"===r?"Basculer":"Flip"}}),N.$on("updateValues",e[14]),{c(){t=s("div"),a=s("div"),w=s("div"),x=s("div"),z=s("strong"),z.textContent=""+("en"===r?"Query image transformation":"Modification de l'image requête"),b=l(),q=s("div"),D=s("div"),m(V.$$.fragment),S=l(),U=s("div"),m(O.$$.fragment),j=l(),C=s("div"),m(_.$$.fragment),R=l(),T=s("div"),m(B.$$.fragment),P=l(),k=s("div"),m(F.$$.fragment),M=l(),L=s("div"),m(N.$$.fragment),Q=l(),H=s("div"),A=s("button"),A.textContent=""+("fr"===r?"Réinitialiser":"Reset"),E=l(),G=s("div"),J=s("img"),X=l(),Y=s("img"),o(x,"class","toolbar-title mt-0 mb-2 svelte-nzei31"),o(D,"class"," svelte-nzei31"),o(U,"class"," svelte-nzei31"),o(C,"class"," svelte-nzei31"),o(T,"class"," svelte-nzei31"),o(k,"class"," svelte-nzei31"),o(L,"class"," svelte-nzei31"),o(A,"class","button is-link"),o(H,"class","mt-2 is-flex is-flex-direction-column is-justify-content-center is-align-items-flex-end svelte-nzei31"),o(q,"class","toolbar-controls is-flex is-flex-direction-column is-align-items-start is-justify-content-center svelte-nzei31"),o(w,"class","toolbar svelte-nzei31"),o(a,"class","toolbar-wrapper is-flex is-flex-direction-column is-justify-content-center is-align-items-center svelte-nzei31"),o(J,"class","compare-img svelte-nzei31"),c(J.src,K=e[0].queryImage.href)||o(J,"src",K),o(J,"alt",W=e[0].queryImage.title),o(Y,"class","main-img svelte-nzei31"),c(Y.src,Z=e[0].similarityImage.href)||o(Y,"src",Z),o(Y,"alt",ee=e[0].similarityImage.title),g(Y,"overlay-reset",e[2]),p(Y,"opacity",e[1]),p(Y,"transform",e[3]),o(G,"class","overlay-wrapper svelte-nzei31"),o(t,"class","similarity-overlay-wrapper svelte-nzei31")},m(i,r){u(i,t,r),f(t,a),f(a,w),f(w,x),f(x,z),f(w,b),f(w,q),f(q,D),$(V,D,null),f(q,S),f(q,U),$(O,U,null),f(q,j),f(q,C),$(_,C,null),f(q,R),f(q,T),$(B,T,null),f(q,P),f(q,k),$(F,k,null),f(q,M),f(q,L),$(N,L,null),f(q,Q),f(q,H),f(H,A),f(t,E),f(t,G),f(G,J),f(G,X),f(G,Y),te=!0,ae||(ie=d(A,"click",e[15]),ae=!0)},p(e,[t]){(!te||1&t&&!c(J.src,K=e[0].queryImage.href))&&o(J,"src",K),(!te||1&t&&W!==(W=e[0].queryImage.title))&&o(J,"alt",W),(!te||1&t&&!c(Y.src,Z=e[0].similarityImage.href))&&o(Y,"src",Z),(!te||1&t&&ee!==(ee=e[0].similarityImage.title))&&o(Y,"alt",ee),(!te||4&t)&&g(Y,"overlay-reset",e[2]),2&t&&p(Y,"opacity",e[1]),8&t&&p(Y,"transform",e[3])},i(e){te||(y(V.$$.fragment,e),y(O.$$.fragment,e),y(_.$$.fragment,e),y(B.$$.fragment,e),y(F.$$.fragment,e),y(N.$$.fragment,e),te=!0)},o(e){v(V.$$.fragment,e),v(O.$$.fragment,e),v(_.$$.fragment,e),v(B.$$.fragment,e),v(F.$$.fragment,e),v(N.$$.fragment,e),te=!1},d(e){e&&I(t),h(V),h(O),h(_),h(B),h(F),h(N),ae=!1,ie()}}}function R(e,t,a){let i,{imgData:n}=t;const s=[{value:"h",label:"fr"===r?"Basculer horizontalement":"Flip horizontally"},{value:"v",label:"fr"===r?"Basculer verticalement":"Flip vertically"},{value:"hv",label:"fr"===r?"Basculer horizontalement et verticalement":"Flip horizontally and vertically"}];let l=.5;const m=l;let o=0;const c=o;let g=100;const p=g;let u=[1,1];const f=structuredClone(u);let $=[0,0];const d=structuredClone($);let y=!1;const v=w(window.crypto.randomUUID());x("resetTrigger",v);return e.$$set=e=>{"imgData"in e&&a(0,n=e.imgData)},e.$$.update=()=>{983040&e.$$.dirty&&a(3,i=`translate(${$[0]-50}%, ${$[1]}%)\n                        rotate(${o}deg)\n                        scale(${u.map((e=>e*(g/100))).join()})`)},[n,l,y,i,s,m,c,p,d,e=>a(1,l=e.detail),e=>a(16,o=e.detail),e=>a(17,g=e.detail),e=>a(19,$=[e.detail,$[1]]),e=>a(19,$=[$[0],e.detail]),e=>{let t=e.detail[0];a(18,u="hv"===t?[-1,-1]:"h"===t?[-1,1]:"v"===t?[1,-1]:[1,1])},()=>{a(1,l=m),a(16,o=c),a(17,g=p),a(18,u=f),a(19,$=d),v.set(window.crypto.randomUUID()),a(2,y=!0),setTimeout((()=>a(2,y=!1)),1e3)},o,g,u,$]}class T extends e{constructor(e){super(),t(this,e,R,_,a,{imgData:0})}}const{getRegionsInfo:B}=z;async function P(e,t,a,i,n,s,l=!1,m=!0){const o=e=>`${e}<br>\n        Page ${parseInt(i)}<br>\n        ${m?`<b>${isNaN(parseFloat(a))||1!==t?2===t&&"en"===r?"Manual similarity":2===t&&"fr"===r?"Correspondance manuelle":3===t&&"en"===r?"Propagated match":"Correspondance propagée":`Score: ${a}`}</b>`:""}`;return!0===l?fetch(`${n}${s}get_regions_title/${e}`).then((e=>e.json())).then((e=>o(e.title))).catch((e=>(console.error("similarity.utils.getDesc()",e),o("fr"===r?"Titre inconnu":"Unknown title")))):Promise.resolve(o(B(e).title))}function k(e,t,a){const i=e.slice();return i[16]=t[a],i}function F(e){let t,a,i,n,c,g,p,d="queryImage"===e[16]&&"fr"===r?"Image requête":"similarityImage"===e[16]&&"fr"===r?"Similarité":"queryImage"===e[16]&&"en"===r?"Query image":"Similarity";return c=new S({props:{item:e[0][e[16]],descPromise:e[1][e[16]],height:"full"}}),{c(){t=s("div"),a=s("span"),i=U(d),n=l(),m(c.$$.fragment),g=l(),o(t,"class","img-legend-wrapper column is-flex is-flex-direction-column is-justify-content-center is-align-items-center")},m(e,r){u(e,t,r),f(t,a),f(a,i),f(t,n),$(c,t,null),f(t,g),p=!0},p(e,t){const a={};1&t&&(a.item=e[0][e[16]]),c.$set(a)},i(e){p||(y(c.$$.fragment,e),p=!0)},o(e){v(c.$$.fragment,e),p=!1},d(e){e&&I(t),h(c)}}}function M(e){let t,a,i=["queryImage","similarityImage"],r=[];for(let t=0;t<2;t+=1)r[t]=F(k(e,i,t));const n=e=>v(r[e],1,1,(()=>{r[e]=null}));return{c(){t=s("div");for(let e=0;e<2;e+=1)r[e].c();o(t,"class","side-by-side columns")},m(e,i){u(e,t,i);for(let e=0;e<2;e+=1)r[e]&&r[e].m(t,null);a=!0},p(e,[a]){if(3&a){let s;for(i=["queryImage","similarityImage"],s=0;s<2;s+=1){const n=k(e,i,s);r[s]?(r[s].p(n,a),y(r[s],1)):(r[s]=F(n),r[s].c(),y(r[s],1),r[s].m(t,null))}for(b(),s=2;s<2;s+=1)n(s);q()}},i(e){if(!a){for(let e=0;e<2;e+=1)y(r[e]);a=!0}},o(e){r=r.filter(Boolean);for(let e=0;e<2;e+=1)v(r[e]);a=!1},d(e){e&&I(t),D(r,e)}}}function L(e,t,a){let{imgData:i}=t;const r=V("similarityPair"),n=new URL(window.location.href),s=n.origin,l=n.pathname,[m,o,c,g]=r.qImg.split(".")[0].split("_"),[p,u,f,$]=r.sImg.split(".")[0].split("_"),d=`${p}_${u}`,y={queryImage:P(`${m}_${o}`,r.similarityType,r.score,c,s,l,!0,!1),similarityImage:P(d,r.similarityType,r.score,f,s,l,!0,!0)};return e.$$set=e=>{"imgData"in e&&a(0,i=e.imgData)},[i,y]}class N extends e{constructor(e){super(),t(this,e,L,M,a,{imgData:0})}}function Q(e){let t,a;return t=new N({props:{imgData:e[2]}}),{c(){m(t.$$.fragment)},m(e,i){$(t,e,i),a=!0},p:C,i(e){a||(y(t.$$.fragment,e),a=!0)},o(e){v(t.$$.fragment,e),a=!1},d(e){h(t,e)}}}function H(e){let t,a;return t=new T({props:{imgData:e[1]}}),{c(){m(t.$$.fragment)},m(e,i){$(t,e,i),a=!0},p:C,i(e){a||(y(t.$$.fragment,e),a=!0)},o(e){v(t.$$.fragment,e),a=!1},d(e){h(t,e)}}}function A(e){let t,a,i,n,c,g,p,d,w;const x=[H,Q],z=[];function D(e,t){return e[0]?0:1}return i=D(e),n=z[i]=x[i](e),d=new O({props:{start:!1,buttonDisplay:!0,toggleLabel:"en"===r?"Overlay view":"Vue superposée"}}),d.$on("updateChecked",e[3]),{c(){t=s("div"),a=s("div"),n.c(),g=l(),p=s("div"),m(d.$$.fragment),o(a,"class",c="modal-similarity-images "+(e[0]?"overlay-wrapper":"side-by-side-wrapper")+" svelte-1qvtan5"),o(t,"class","modal-similarity svelte-1qvtan5")},m(e,r){u(e,t,r),f(t,a),z[i].m(a,null),f(t,g),f(t,p),$(d,p,null),w=!0},p(e,[t]){let r=i;i=D(e),i===r?z[i].p(e,t):(b(),v(z[r],1,1,(()=>{z[r]=null})),q(),n=z[i],n?n.p(e,t):(n=z[i]=x[i](e),n.c()),y(n,1),n.m(a,null)),(!w||1&t&&c!==(c="modal-similarity-images "+(e[0]?"overlay-wrapper":"side-by-side-wrapper")+" svelte-1qvtan5"))&&o(a,"class",c)},i(e){w||(y(n),y(d.$$.fragment,e),w=!0)},o(e){v(n),v(d.$$.fragment,e),w=!1},d(e){e&&I(t),z[i].d(),h(d)}}}function E(e,t,a){let{mainImgItem:i}=t,{compareImgItem:n}=t;const s={similarityImage:{href:j(i.img,i.img.split("_").pop()),title:o(i.title)},queryImage:{href:j(n.img,n.img.split("_").pop()),title:o(n.title)}},l={similarityImage:i,queryImage:n};let m=!1;function o(e){return"fr"===r?`Vue principale de la région ${e}`:`Main view of region ${e}`}return e.$$set=e=>{"mainImgItem"in e&&a(4,i=e.mainImgItem),"compareImgItem"in e&&a(5,n=e.compareImgItem)},[m,s,l,()=>a(0,m=!m),i,n]}class G extends e{constructor(e){super(),t(this,e,E,A,a,{mainImgItem:4,compareImgItem:5})}}export{G as default};
//# sourceMappingURL=ModalSimilarity-b0d45c96.js.map
