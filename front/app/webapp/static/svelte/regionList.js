var regionList=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(n)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let c;function l(e,t){return c||(c=document.createElement("a")),c.href=t,e===c.href}function a(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e){let t;return a(e,(e=>t=e))(),t}function d(e,t,n){e.$$.on_destroy.push(a(t,n))}function g(e,t,n,r){if(e){const s=f(e,t,n,r);return e[0](s)}}function f(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}function m(e,t,n,r){if(e[2]&&r){const s=e[2](r(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|s[r];return e}return t.dirty|s}return t.dirty}function p(e,t,n,r,s,o){if(s){const i=f(t,n,r,o);e.p(i,s)}}function h(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function $(e){const t="string"==typeof e&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}const w="undefined"!=typeof window;let v=w?()=>window.performance.now():()=>Date.now(),b=w?e=>requestAnimationFrame(e):e;const y=new Set;function k(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&b(k)}function x(e,t){e.appendChild(t)}function C(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function I(e){const t=L("style");return function(e,t){x(e.head||e,t),t.sheet}(C(e),t),t.sheet}function E(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function P(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function L(e){return document.createElement(e)}function R(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function O(e){return document.createTextNode(e)}function T(){return O(" ")}function _(){return O("")}function N(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function j(e){return function(t){return t.preventDefault(),e.call(this,t)}}function M(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function q(e,t){t=""+t,e.data!==t&&(e.data=t)}function A(e,t){e.value=null==t?"":t}function z(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function V(e,t,n){e.classList[n?"add":"remove"](t)}class H{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.is_svg?this.e=R(t.nodeName):this.e=L(11===t.nodeType?"TEMPLATE":t.nodeName),this.t="TEMPLATE"!==t.tagName?t:t.content,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)E(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(S)}}const U=new Map;let F,B=0;function D(e,t,n,r,s,o,i,c=0){const l=16.666/r;let a="{\n";for(let e=0;e<=1;e+=l){const r=t+(n-t)*o(e);a+=100*e+`%{${i(r,1-r)}}\n`}const u=a+`100% {${i(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${c}`,g=C(e),{stylesheet:f,rules:m}=U.get(g)||function(e,t){const n={stylesheet:I(t),rules:{}};return U.set(e,n),n}(g,e);m[d]||(m[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${d} ${r}ms linear ${s}ms 1 both`,B+=1,d}function J(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),s=n.length-r.length;s&&(e.style.animation=r.join(", "),B-=s,B||b((()=>{B||(U.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&S(t)})),U.clear())})))}function X(e){F=e}function Z(){if(!F)throw new Error("Function called outside component initialization");return F}function G(e){Z().$$.on_mount.push(e)}function Q(e,t){return Z().$$.context.set(e,t),t}function W(e){return Z().$$.context.get(e)}const K=[],Y=[];let ee=[];const te=[],ne=Promise.resolve();let re=!1;function se(e){ee.push(e)}const oe=new Set;let ie,ce=0;function le(){if(0!==ce)return;const e=F;do{try{for(;ce<K.length;){const e=K[ce];ce++,X(e),ae(e.$$)}}catch(e){throw K.length=0,ce=0,e}for(X(null),K.length=0,ce=0;Y.length;)Y.pop()();for(let e=0;e<ee.length;e+=1){const t=ee[e];oe.has(t)||(oe.add(t),t())}ee.length=0}while(K.length);for(;te.length;)te.pop()();re=!1,oe.clear(),X(e)}function ae(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(se)}}function ue(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,r,t),s}(`${t?"intro":"outro"}${n}`))}const de=new Set;let ge;function fe(){ge={r:0,c:[],p:ge}}function me(){ge.r||s(ge.c),ge=ge.p}function pe(e,t){e&&e.i&&(de.delete(e),e.i(t))}function he(e,t,n,r){if(e&&e.o){if(de.has(e))return;de.add(e),ge.c.push((()=>{de.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const $e={duration:0};function we(n,r,i,c){const l={direction:"both"};let a=r(n,i,l),u=c?0:1,d=null,g=null,f=null;function m(){f&&J(n,f)}function p(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function h(r){const{delay:o=0,duration:i=300,easing:c=t,tick:l=e,css:h}=a||$e,$={start:v()+o,b:r};r||($.group=ge,ge.r+=1),d||g?g=$:(h&&(m(),f=D(n,u,r,i,o,c,h)),r&&l(0,1),d=p($,i),se((()=>ue(n,r,"start"))),function(e){let t;0===y.size&&b(k),new Promise((n=>{y.add(t={c:e,f:n})}))}((e=>{if(g&&e>g.start&&(d=p(g,i),g=null,ue(n,d.b,"start"),h&&(m(),f=D(n,u,d.b,d.duration,0,c,a.css))),d)if(e>=d.end)l(u=d.b,1-u),ue(n,d.b,"end"),g||(d.b?m():--d.group.r||s(d.group.c)),d=null;else if(e>=d.start){const t=e-d.start;u=d.a+d.d*c(t/d.duration),l(u,1-u)}return!(!d&&!g)})))}return{run(e){o(a)?(ie||(ie=Promise.resolve(),ie.then((()=>{ie=null}))),ie).then((()=>{a=a(l),h(e)})):h(e)},end(){m(),d=g=null}}}function ve(e,t){const n=t.token={};function r(e,r,s,o){if(t.token!==n)return;t.resolved=o;let i=t.ctx;void 0!==s&&(i=i.slice(),i[s]=o);const c=e&&(t.current=e)(i);let l=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==r&&e&&(fe(),he(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),me())})):t.block.d(1),c.c(),pe(c,1),c.m(t.mount(),t.anchor),l=!0),t.block=c,t.blocks&&(t.blocks[r]=c),l&&le()}if(!(s=e)||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof s.then){if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}else{const n=Z();if(e.then((e=>{X(n),r(t.then,1,t.value,e),X(null)}),(e=>{if(X(n),r(t.catch,2,t.error,e),X(null),!t.hasCatch)throw e})),t.current!==t.pending)return r(t.pending,0),!0}var s}function be(e,t,n){const r=t.slice(),{resolved:s}=e;e.current===e.then&&(r[e.value]=s),e.current===e.catch&&(r[e.error]=s),e.block.p(r,n)}function ye(e,t){he(e,1,1,(()=>{t.delete(e.key)}))}function ke(e,t,n,r,o,i,c,l,a,u,d,g){let f=e.length,m=i.length,p=f;const h={};for(;p--;)h[e[p].key]=p;const $=[],w=new Map,v=new Map,b=[];for(p=m;p--;){const e=g(o,i,p),s=n(e);let l=c.get(s);l?r&&b.push((()=>l.p(e,t))):(l=u(s,e),l.c()),w.set(s,$[p]=l),s in h&&v.set(s,Math.abs(p-h[s]))}const y=new Set,k=new Set;function x(e){pe(e,1),e.m(l,d),c.set(e.key,e),d=e.first,m--}for(;f&&m;){const t=$[m-1],n=e[f-1],r=t.key,s=n.key;t===n?(d=t.first,f--,m--):w.has(s)?!c.has(r)||y.has(r)?x(t):k.has(s)?f--:v.get(r)>v.get(s)?(k.add(r),x(t)):(y.add(s),f--):(a(n,c),f--)}for(;f--;){const t=e[f];w.has(t.key)||a(t,c)}for(;m;)x($[m-1]);return s(b),$}function xe(e){e&&e.c()}function Ce(e,t,r,i){const{fragment:c,after_update:l}=e.$$;c&&c.m(t,r),i||se((()=>{const t=e.$$.on_mount.map(n).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),l.forEach(se)}function Ie(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];ee.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),ee=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ee(e,t){-1===e.$$.dirty[0]&&(K.push(e),re||(re=!0,ne.then(le)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Se(t,n,o,i,c,l,a,u=[-1]){const d=F;X(t);const g=t.$$={fragment:null,ctx:[],props:l,update:e,not_equal:c,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(g.root);let f=!1;if(g.ctx=o?o(t,n.props||{},((e,n,...r)=>{const s=r.length?r[0]:n;return g.ctx&&c(g.ctx[e],g.ctx[e]=s)&&(!g.skip_bound&&g.bound[e]&&g.bound[e](s),f&&Ee(t,e)),n})):[],g.update(),f=!0,s(g.before_update),g.fragment=!!i&&i(g.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);g.fragment&&g.fragment.l(e),e.forEach(S)}else g.fragment&&g.fragment.c();n.intro&&pe(t.$$.fragment),Ce(t,n.target,n.anchor,n.customElement),le()}X(d)}class Pe{$destroy(){Ie(this,1),this.$destroy=e}$on(t,n){if(!o(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Le(e){const t=e-1;return t*t*t+1}function Re(e,{delay:n=0,duration:r=400,easing:s=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:s,css:e=>"opacity: "+e*o}}function Oe(e,{delay:t=0,duration:n=400,easing:r=Le,x:s=0,y:o=0,opacity:i=0}={}){const c=getComputedStyle(e),l=+c.opacity,a="none"===c.transform?"":c.transform,u=l*(1-i),[d,g]=$(s),[f,m]=$(o);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${a} translate(${(1-e)*d}${g}, ${(1-e)*f}${m});\n\t\t\topacity: ${l-u*t}`}}const Te=[];function _e(t,n=e){let r;const s=new Set;function o(e){if(i(t,e)&&(t=e,r)){const e=!Te.length;for(const e of s)e[1](),Te.push(e,t);if(e){for(let e=0;e<Te.length;e+=2)Te[e][0](Te[e+1]);Te.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(i,c=e){const l=[i,c];return s.add(l),1===s.size&&(r=n(o)||e),i(t),()=>{s.delete(l),0===s.size&&r&&(r(),r=null)}}}}function Ne(t,n,r){const i=!Array.isArray(t),c=i?[t]:t,l=n.length<2;return u=t=>{let r=!1;const u=[];let d=0,g=e;const f=()=>{if(d)return;g();const r=n(i?u[0]:u,t);l?t(r):g=o(r)?r:e},m=c.map(((e,t)=>a(e,(e=>{u[t]=e,d&=~(1<<t),r&&f()}),(()=>{d|=1<<t}))));return r=!0,f(),function(){s(m),g(),r=!1}},{subscribe:_e(r,u).subscribe};var u}const je=APP_LANG,Me=APP_NAME;WEBAPP_NAME;const qe=USER_ID;IS_SUPERUSER,ADD_PERMISSION;const Ae=CSRF_TOKEN,ze=ADDITIONAL_MODULES,Ve="Region",He=SAS_APP_URL,Ue=CANTALOUPE_APP_URL,Fe=MEDIA_PATH,Be=PAGE_LEN,De=_e(!1),Je=_e("");async function Xe(e){De.set(!0);try{return await e()}finally{De.set(!1)}}function Ze(e,t=100){const n=Math.floor(.75*t);return e.length>t?e.slice(0,n)+"..."+e.slice(-t+n):e}function Ge(e,t){if("undefined"!=typeof window){const n=parseInt(new URLSearchParams(window.location.search).get(t));if(!isNaN(n))return e.set(n),n}return e.set(1),1}function Qe(e,t,n){if(t.set(e),"undefined"!=typeof window){const t=new URL(window.location.href);t.searchParams.set(n,e),window.history.pushState({},"",t)}}function We(e=null,t="full",n="full"){if(!e)return"https://placehold.co/96x96/png?text=No+image";if((e=e.split("_")).length<3)return"https://placehold.co/96x96/png?text=No+image";const r=e[e.length-1].includes(",")?e.pop().replace(".jpg",""):t,s=e.join("_").replace(".jpg","");return`${Ue??"http://localhost:8182"}/iiif/2/${s}.jpg/${r}/${n}/0/default.jpg`}function Ke(e=null,t=1){return`${He??"http://localhost:3000"}/index.html?iiif-content=${e}&canvas=${t}`}function Ye(e,t=null,n=!1){return new Promise((r=>{if(document.getElementById("msg-modal")){n?document.getElementById("modal-footer").hidden=!1:r(void 0),t&&(document.getElementById("modal-title").innerHTML=t),document.getElementById("modal-body").innerHTML=e,document.getElementById("hidden-msg-btn").click();const s=document.getElementById("cancel-btn"),o=document.getElementById("ok-btn"),i=document.getElementById("modal-bkg"),c=()=>{s.removeEventListener("click",l),i.removeEventListener("click",l),o.removeEventListener("click",a),document.getElementById("modal-footer").hidden=!0},l=()=>{c(),r(!1)},a=()=>{c(),r(!0)};s.addEventListener("click",l),o.addEventListener("click",a)}else n?r(window.confirm(e)):(window.alert(e),r(void 0))}))}function et(e,t){const n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`${t}`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),document.body.removeChild(r)}const tt=function(){const e={id:null,type:"documentSet",title:"en"===je?"Document set":"Set de document",selected:{}},t={id:null,type:"regionsSet",title:"en"===je?"Regions set":"Set de régions",selected:{}},n=_e({records:JSON.parse(localStorage.getItem("documentSet"))||e,regions:JSON.parse(localStorage.getItem("regionsSet"))||t}),{subscribe:r,update:s,get:o}=n,i=_e(!1);function c(e,t=!1){i.set(t),localStorage.setItem(e.type,JSON.stringify(e))}function l(e,t){return e[t?"regions":"records"]?.selected||{}}function a(e,t=!0){const n=l(e,t);return t?n[Ve]??{}:Object.entries(n)}function u(e,t,n){const r=n===Ve?"regions":"records",s=e[r],{[t]:o,...i}=s.selected[n];return e[r]={...s,selected:{...s.selected,[n]:i}},c(e[r]),e}function d(e,t,n=!0){const r=t.class===Ve?"regions":"records",s=e[r],o=s.selected,i=t.class===Ve?t:{title:t.title,url:t.url};return e[r]={...s,selected:{...o,[t.class]:{...o[t.class]||{},[t.id]:i}}},n&&c(e[r]),e}function g(e,t){return e[t.class.toLowerCase().includes("regions")?"regions":"records"].id===t.id}return{subscribe:r,save:e=>s((t=>function(e,t){const n=t?"regions-set":"document-set";if(t)return window.alert("Region set management is not yet implemented"),e;let r=e[t?"regions":"records"],o={};Object.entries(r.selected).forEach((([e,t])=>{o[e]=Object.keys(t)}));const c=null!==r.id?`${r.id}/change`:"add";return fetch(`${window.location.origin}/${Me}/${n}/${c}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ae},body:JSON.stringify({title:r.title,selection:r,...o})}).then((e=>e.json())).then((e=>{if(!e?.document_set_id)throw new Error("Failed to save selection");s((n=>{const r=n[t?"regions":"records"];return r.id=e.document_set_id,r.title=e.document_set_title,i.set(!0),n}))})).catch((e=>console.error("Error:",e))),e}(t,e))),empty:n=>s((r=>(r[n?"regions":"records"]=n?t:e,c(r[n?"regions":"records"]),r))),removeAll:(e,t)=>s((n=>function(e,t,n){const r=n===Ve?"regions":"records",s=e[r];let o=s.selected[n];return o&&Object.keys(o).length?(t.forEach((e=>{delete o[e]})),e[r]={...s,selected:{...s.selected,[n]:o}},c(e[r]),e):e}(n,e,t))),remove:(e,t)=>s((n=>u(n,e,t))),addAll:e=>s((t=>function(e,t){const n=t[0].type===Ve;return t.forEach((t=>{e=d(e,t,!1)})),c(e[n?"regions":"records"]),e}(t,e))),add:e=>s((t=>d(t,e))),toggle:e=>s((t=>{const n=l(t,e.class===Ve);return n[e.class]?.[e.id]?u(t,e.id,e.class):d(t,e)})),updateTitle:(e,t)=>s((n=>{const r=t?"regions":"records";return n[r]={...n[r],title:e},c(n[r],!0),n})),isSaved:i,isSelected:Ne(n,(e=>t=>l(e,t.class===Ve)[t.class]?.hasOwnProperty(t.id)||!1)),isSetSelected:Ne(n,(e=>t=>g(e,t))),selected:Ne(n,(e=>t=>a(e,t))),nbSelected:Ne(n,(e=>t=>{const n=a(e,t);return t?Object.keys(n).length:n.reduce(((e,[t,n])=>e+Object.keys(n).length),0)})),selectionTitle:Ne(n,(e=>t=>e[t?"regions":"records"].title)),selection:Ne(n,(e=>t=>e[t?"regions":"records"])),toggleSet:n=>s((r=>g(r,n)?function(n,r){const s=r.class.toLowerCase().includes("regions");return n[s?"regions":"records"]=s?t:e,c(n[s?"regions":"records"]),n}(r,n):function(e,t){const n=t.class.toLowerCase().includes("regions")?"regions":"records";return null===t.selection.id&&(t.selection.id=t.id),e[n]=t.selection,c(e[n]),e}(r,n)))}}();const nt=function(){const e=`${window.location.origin}${window.location.pathname}`,t=_e(1),n=_e({}),r=_e({}),s=_e("");Ge(t,"p");const o=(async()=>{const t=await fetch(`${e}canvas`),r=await t.json();let s={};return Object.values(r).forEach((e=>{Object.entries(e).forEach((([e,t])=>{s[e]=t}))})),n.set(s),r})(),i=Ne(t,(t=>(async()=>{const n=await fetch(`${e}canvas?p=${t}`),s=await n.json();return r.set(s),s})()));return{currentPage:t,pageRegions:r,allRegions:n,fetchPages:i,fetchAll:o,handlePageUpdate:function(e){Qe(e,t,"p")},remove:function(e){n.update((t=>(delete t[e],{...t}))),r.update((t=>{for(const n in t)if(t[n][e]){const{[e]:r,...s}=t[n];return t[n]=s,t}return t}))},clipBoard:s,copyRef:function(e){s.update((t=>{const n=t===e?"":e;return navigator.clipboard.writeText(n).then((e=>"")),n}))}}}();function rt(e){let t,n,r;return{c(){t=L("div"),t.innerHTML='<div class="loader svelte-vizlcg"></div>',M(t,"class","bkg-shade svelte-vizlcg")},m(e,n){E(e,t,n),r=!0},i(e){r||(se((()=>{r&&(n||(n=we(t,Re,{duration:150},!0)),n.run(1))})),r=!0)},o(e){n||(n=we(t,Re,{duration:150},!1)),n.run(0),r=!1},d(e){e&&S(t),e&&n&&n.end()}}}function st(e){let t,n,r=e[0]&&rt();return{c(){r&&r.c(),t=_()},m(e,s){r&&r.m(e,s),E(e,t,s),n=!0},p(e,[n]){e[0]?r?1&n&&pe(r,1):(r=rt(),r.c(),pe(r,1),r.m(t.parentNode,t)):r&&(fe(),he(r,1,1,(()=>{r=null})),me())},i(e){n||(pe(r),n=!0)},o(e){he(r),n=!1},d(e){r&&r.d(e),e&&S(t)}}}function ot(e,t,n){let{visible:r=!1}=t;return e.$$set=e=>{"visible"in e&&n(0,r=e.visible)},[r]}class it extends Pe{constructor(e){super(),Se(this,e,ot,st,i,{visible:0})}}function ct(e){let t;return{c(){t=R("path"),M(t,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),M(t,"class","svelte-rtaaid")},m(e,n){E(e,t,n)},d(e){e&&S(t)}}}function lt(e){let t;return{c(){t=R("path"),M(t,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),M(t,"class","svelte-rtaaid")},m(e,n){E(e,t,n)},d(e){e&&S(t)}}}function at(t){let n,r="en"===je?"Copy ID":"Copier l'ID";return{c(){n=O(r)},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function ut(t){let n,r="en"===je?"Copied!":"Copié !";return{c(){n=O(r)},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function dt(e){let t,n,r,o,i,c,a,u,d,g,f,m,p,h,$,w,v,b;function y(e,t){return e[4]?lt:ct}let k=y(e),C=k(e);function I(e,t){return e[4]?ut:at}let P=I(e),O=P(e);return{c(){t=L("div"),n=L("figure"),r=L("img"),i=T(),c=L("div"),a=L("span"),d=T(),g=L("button"),f=R("svg"),C.c(),m=T(),p=L("span"),O.c(),M(r,"class","region-img svelte-rtaaid"),l(r.src,o=We(e[0].img,e[0].xyhw,e[1]?"96,":`,${e[2]}`))||M(r,"src",o),M(r,"alt","Extracted region"),M(a,"class","overlay-desc"),M(c,"class","overlay is-center svelte-rtaaid"),M(n,"class",u="image card region-image "+(e[1]?"is-96x96":"")+" svelte-rtaaid"),M(n,"tabindex","-1"),z(n,"height",e[2]+"px"),z(n,"min-width",e[2]+"px"),M(f,"xmlns","http://www.w3.org/2000/svg"),M(f,"viewBox","0 0 384 512"),M(f,"class","svelte-rtaaid"),M(p,"class","tooltip svelte-rtaaid"),M(g,"class","button region-btn tag svelte-rtaaid"),M(t,"class",h="region is-center "+(e[5](e[0])?"checked":"")+" svelte-rtaaid")},m(s,o){E(s,t,o),x(t,n),x(n,r),x(n,i),x(n,c),x(c,a),a.innerHTML=e[3],x(t,d),x(t,g),x(g,f),C.m(f,null),x(g,m),x(g,p),O.m(p,null),w=!0,v||(b=[N(n,"click",e[9]),N(n,"keyup",gt),N(g,"click",e[10])],v=!0)},p(e,[s]){(!w||7&s&&!l(r.src,o=We(e[0].img,e[0].xyhw,e[1]?"96,":`,${e[2]}`)))&&M(r,"src",o),(!w||8&s)&&(a.innerHTML=e[3]),(!w||2&s&&u!==(u="image card region-image "+(e[1]?"is-96x96":"")+" svelte-rtaaid"))&&M(n,"class",u),(!w||4&s)&&z(n,"height",e[2]+"px"),(!w||4&s)&&z(n,"min-width",e[2]+"px"),k!==(k=y(e))&&(C.d(1),C=k(e),C&&(C.c(),C.m(f,null))),P===(P=I(e))&&O?O.p(e,s):(O.d(1),O=P(e),O&&(O.c(),O.m(p,null))),(!w||33&s&&h!==(h="region is-center "+(e[5](e[0])?"checked":"")+" svelte-rtaaid"))&&M(t,"class",h)},i(e){w||(se((()=>{w&&($||($=we(t,Re,{duration:500},!0)),$.run(1))})),w=!0)},o(e){$||($=we(t,Re,{duration:500},!1)),$.run(0),w=!1},d(e){e&&S(t),C.d(),O.d(),e&&$&&$.end(),v=!1,s(b)}}}const gt=()=>null;function ft(e,t,n){let r,s,o;const{isSelected:i}=tt;d(e,i,(e=>n(5,o=e)));const{clipBoard:c}=nt;d(e,c,(e=>n(8,s=e)));let{item:l}=t,{isSquare:a=!0}=t,{height:u=(a?96:140)}=t,{desc:g=l.title}=t;return e.$$set=e=>{"item"in e&&n(0,l=e.item),"isSquare"in e&&n(1,a=e.isSquare),"height"in e&&n(2,u=e.height),"desc"in e&&n(3,g=e.desc)},e.$$.update=()=>{257&e.$$.dirty&&n(4,r=l.ref===s)},[l,a,u,g,r,o,i,c,s,()=>tt.toggle(l),()=>nt.copyRef(l.ref)]}class mt extends Pe{constructor(e){super(),Se(this,e,ft,dt,i,{item:0,isSquare:1,height:2,desc:3})}}function pt(t){let n,r,s,o,i,c,l,a,u,d="en"===je?"Selection":"Sélection";return{c(){n=L("div"),r=L("button"),s=L("span"),o=L("i"),i=T(),c=O(d),l=O("\n            ("),a=O(t[0]),u=O(")"),M(o,"class","fa-solid fa-book-bookmark"),M(s,"id","btn-content"),M(r,"id","set-btn"),M(r,"class","button px-5 py-4 is-link js-modal-trigger svelte-hs48f9"),M(r,"data-target","selection-modal"),M(n,"class","set-container svelte-hs48f9")},m(e,t){E(e,n,t),x(n,r),x(r,s),x(s,o),x(s,i),x(s,c),x(s,l),x(s,a),x(s,u)},p(e,[t]){1&t&&q(a,e[0])},i:e,o:e,d(e){e&&S(n)}}}function ht(e,t,n){let{selectionLength:r=0}=t,s=r;return e.$$set=e=>{"selectionLength"in e&&n(0,r=e.selectionLength)},e.$$.update=()=>{if(3&e.$$.dirty&&r!==s){const e=r>s;n(1,s=r);const t=document.getElementById("btn-content");t&&t.animate([{transform:e?"translateY(-7px)":"translateX(-5px)"},{transform:e?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[r,s]}class $t extends Pe{constructor(e){super(),Se(this,e,ht,pt,i,{selectionLength:0})}}function wt(t){let n,r,s,o,i,c,l,a,u,d,g,f,m,p,h;return{c(){n=L("button"),r=T(),s=L("div"),o=L("div"),i=T(),c=L("div"),l=L("div"),l.innerHTML='<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div> \n            <button class="delete media-left" aria-label="close"></button>',a=T(),u=L("section"),d=T(),g=L("footer"),f=L("div"),m=L("button"),m.textContent=""+("en"===je?"Abort":"Retour"),p=T(),h=L("button"),h.textContent="OK",M(n,"id","hidden-msg-btn"),M(n,"class","js-modal-trigger"),M(n,"data-target","msg-modal"),n.hidden=!0,M(o,"id","modal-bkg"),M(o,"class","modal-background"),M(l,"class","modal-card-head media mb-0"),M(u,"id","modal-body"),M(u,"class","modal-card-body"),M(m,"id","cancel-btn"),M(m,"class","button is-link is-light button-close"),M(h,"id","ok-btn"),M(h,"class","button is-link button-close"),M(f,"class","buttons"),M(g,"id","modal-footer"),M(g,"class","modal-card-foot is-center pt-3"),g.hidden=!0,M(c,"class","modal-content"),M(s,"id","msg-modal"),M(s,"class","modal fade"),M(s,"tabindex","-1"),M(s,"aria-labelledby","selection-modal-label"),M(s,"aria-hidden","true")},m(e,t){E(e,n,t),E(e,r,t),E(e,s,t),x(s,o),x(s,i),x(s,c),x(c,l),x(c,a),x(c,u),x(c,d),x(c,g),x(g,f),x(f,m),x(f,p),x(f,h)},p:e,i:e,o:e,d(e){e&&S(n),e&&S(r),e&&S(s)}}}class vt extends Pe{constructor(e){super(),Se(this,e,null,wt,i,{})}}function bt(t){let n,r,s,o,i,c=ze.includes("regions"),l=c&&function(t){let n,r,s;return{c(){n=L("button"),n.textContent="en"===je?"Automatic region extraction":"Extraction automatique des régions",M(n,"class","button is-link is-inverted")},m(e,o){E(e,n,o),r||(s=N(n,"click",t[1]),r=!0)},p:e,d(e){e&&S(n),r=!1,s()}}}(t);return{c(){n=L("div"),r=L("button"),r.textContent=""+("en"===je?"Manually annotate":"Annoter manuellement"),s=T(),l&&l.c(),M(r,"class","button is-link"),M(n,"class","is-center buttons is-centered pt-5")},m(e,c){E(e,n,c),x(n,r),x(n,s),l&&l.m(n,null),o||(i=N(r,"click",t[0]),o=!0)},p(e,[t]){c&&l.p(e,t)},i:e,o:e,d(e){e&&S(n),l&&l.d(),o=!1,i()}}}function yt(e,t,n){const r=W("witness");let{currentRegionId:s}=t,{baseUrl:o}=t;return e.$$set=e=>{"currentRegionId"in e&&n(2,s=e.currentRegionId),"baseUrl"in e&&n(3,o=e.baseUrl)},[async function(){const e=`${window.location.origin}/${Me}`;let t=`${e}/witness/${r.id}/regions/add`;if(1===r.regions.length||s){const n=s||r.regions[0];t=`${e}/witness/${r.id}/regions/${n}/add`}const n=await Xe((()=>fetch(t,{method:"POST",headers:{"X-CSRFToken":Ae}})));if(!n.ok)throw await Ye(`Failed to create regions: '${n.statusText}'`,"Error"),new Error(`Failed to create regions: '${n.statusText}'`);let i;try{i=await n.json()}catch(e){throw await Ye(`Failed to parse JSON response: '${e}'`,"Error"),new Error(`Failed to parse JSON response: '${e}'`)}i.hasOwnProperty("mirador_url")&&window.open(i.mirador_url),i.hasOwnProperty("regions_id")&&(window.location.href=`${o.split("regions/")[0]}regions/${i.regions_id}`)},async function(){const e=`${window.location.origin}/${Me}/witness/${r.id}/regions/extract`,t=await Xe((()=>fetch(e,{method:"POST",headers:{"X-CSRFToken":Ae}})));let n;if(!t.ok){try{n=await t.json()}catch(e){throw await Ye(`Failed to parse JSON response: '${e}'`,"Error"),new Error(`Failed to parse JSON response: '${e}'`)}throw await Ye(`Failed to launch regions extraction: '${n.message}'`,"Error"),new Error(`Failed to launch regions extraction: '${n.message}'`)}const s=n.doc_set_id;if(!s)throw await Ye("Failed to launch regions extraction: 'No document set id'","Error"),new Error("Failed to launch regions extraction: 'No document set id'");window.location.href=`${window.location.origin}/${Me}/treatment/add/?document_set=${s}&task_type=regions`},s,o]}class kt extends Pe{constructor(e){super(),Se(this,e,yt,bt,i,{currentRegionId:2,baseUrl:3})}}function xt(e,t,n){const r=e.slice();return r[6]=t[n],r}function Ct(e){let t,n=e[3].regions,r=[];for(let t=0;t<n.length;t+=1)r[t]=Et(xt(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=_()},m(e,n){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,n);E(e,t,n)},p(e,s){if(9&s){let o;for(n=e[3].regions,o=0;o<n.length;o+=1){const i=xt(e,n,o);r[o]?r[o].p(i,s):(r[o]=Et(i),r[o].c(),r[o].m(t.parentNode,t))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){P(r,e),e&&S(t)}}}function It(e){let t,n;function r(e,n){return 4&n&&(t=null),null==t&&(t=!!["all","page"].includes(e[2])),t?Pt:"similarity"===e[2]?St:void 0}let s=r(e,-1),o=s&&s(e);return{c(){o&&o.c(),n=_()},m(e,t){o&&o.m(e,t),E(e,n,t)},p(e,t){s===(s=r(e,t))&&o?o.p(e,t):(o&&o.d(1),o=s&&s(e),o&&(o.c(),o.m(n.parentNode,n)))},d(e){o&&o.d(e),e&&S(n)}}}function Et(e){let t,n,r,s,o=e[6]+"";return{c(){t=L("a"),n=O("Regions #"),r=O(o),M(t,"href",s=""+(e[0]+e[6])),M(t,"class","tag is-dark mr-3 is-rounded")},m(e,s){E(e,t,s),x(t,n),x(t,r)},p(e,n){1&n&&s!==(s=""+(e[0]+e[6]))&&M(t,"href",s)},d(e){e&&S(t)}}}function St(t){let n,r,s;return{c(){n=L("button"),n.textContent=""+("en"===je?"Delete all regions similarity":"Supprimer toutes les similarités du document"),M(n,"class","tag is-danger")},m(e,o){E(e,n,o),r||(s=N(n,"click",t[5]),r=!0)},p:e,d(e){e&&S(n),r=!1,s()}}}function Pt(t){let n,r,s;return{c(){n=L("button"),n.textContent=""+("en"===je?"Delete regions record":"Supprimer l'intégralité des régions"),M(n,"class","tag is-danger")},m(e,o){E(e,n,o),r||(s=N(n,"click",t[4]),r=!0)},p:e,d(e){e&&S(n),r=!1,s()}}}function Lt(t){let n;function r(e,t){return e[1]?It:Ct}let s=r(t),o=s(t);return{c(){n=L("div"),o.c()},m(e,t){E(e,n,t),o.m(n,null)},p(e,[t]){s===(s=r(e))&&o?o.p(e,t):(o.d(1),o=s(e),o&&(o.c(),o.m(n,null)))},i:e,o:e,d(e){e&&S(n),o.d()}}}function Rt(e,t,n){const r=W("witness");let{baseUrl:s=`${window.location.origin}${window.location.pathname}`}=t,{currentRegionId:o}=t,{currentLayout:i}=t;return e.$$set=e=>{"baseUrl"in e&&n(0,s=e.baseUrl),"currentRegionId"in e&&n(1,o=e.currentRegionId),"currentLayout"in e&&n(2,i=e.currentLayout)},[s,o,i,r,async function(){if(!await Ye("en"===je?"Are you sure you want to delete this record?":"Voulez-vous vraiment supprimer cet enregistrement ?","en"===je?"Confirm deletion":"Confirmer la suppression",!0))return;if("number"!=typeof o)throw new Error("Invalid region ID");const e=`${window.location.origin}/${Me}/regions/${o}/delete`;try{const t=await Xe((()=>fetch(e,{method:"DELETE",headers:{"X-CSRFToken":Ae}})));if(204!==t.status)throw new Error(`Failed to delete regions: '${t.statusText}'`);window.location.href=`${s.split("regions/")[0]}regions/`}catch(e){console.error(e)}},async function(){if(!await Ye("en"===je?"Are you sure you want to delete all similarity scores for this document?":"Voulez-vous vraiment supprimer l'intégralité des scores de similarité pour ce document ?","en"===je?"Confirm deletion":"Confirmer la suppression",!0))return;if("number"!=typeof o)throw new Error("Invalid region ID");const e=`${window.location.origin}/${Me}/similarity/reset/${o}`;try{const t=await Xe((()=>fetch(e,{method:"DELETE",headers:{"X-CSRFToken":Ae}})));if(204!==t.status&&200!==t.status)throw new Error(`Failed to delete similarity: '${t.statusText}'`);window.location.href=`${s.split("regions/")[0]}regions/`}catch(e){console.error(e),await Ye(e.message,"Error")}}]}class Ot extends Pe{constructor(e){super(),Se(this,e,Rt,Lt,i,{baseUrl:0,currentRegionId:1,currentLayout:2})}}function Tt(e){let t;return{c(){t=R("path"),M(t,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),M(t,"class","svelte-h0t5l9")},m(e,n){E(e,t,n)},d(e){e&&S(t)}}}function _t(e){let t;return{c(){t=R("path"),M(t,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),M(t,"class","svelte-h0t5l9")},m(e,n){E(e,t,n)},d(e){e&&S(t)}}}function Nt(t){let n,r="en"===je?"Edit":"Modifier";return{c(){n=O(r)},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function jt(t){let n,r="en"===je?"Validate":"Valider";return{c(){n=O(r)},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function Mt(t){let n,r,o,i,c,l,a,u,d,g,f,m,p,h,$,w,v="en"===je?"Reload":"Recharger",b="en"===je?"Go to editor":"Aller à l'éditeur",y="en"===je?"Delete selected regions":"Supprimer les régions sélectionnées";return{c(){n=L("button"),r=L("i"),o=T(),i=O(v),c=T(),l=L("a"),a=L("i"),u=T(),d=O(b),g=T(),f=L("button"),m=L("i"),p=T(),h=O(y),M(r,"class","fa-solid fa-rotate-right"),M(n,"class","tag is-link is-light is-rounded mr-3"),M(a,"class","fa-solid fa-edit"),M(l,"class","tag is-link is-rounded mr-3"),M(l,"href",Ke(t[4])),M(l,"target","_blank"),M(m,"class","fa-solid fa-trash"),M(f,"class","tag is-danger is-rounded")},m(e,s){E(e,n,s),x(n,r),x(n,o),x(n,i),E(e,c,s),E(e,l,s),x(l,a),x(l,u),x(l,d),E(e,g,s),E(e,f,s),x(f,m),x(f,p),x(f,h),$||(w=[N(n,"click",t[14]),N(f,"click",t[6])],$=!0)},p:e,d(e){e&&S(n),e&&S(c),e&&S(l),e&&S(g),e&&S(f),$=!1,s(w)}}}function qt(t){let n,r,o,i,c,l,a,u,d,g,f,m,p,h,$,w,v,b,y,k="en"===je?"Download":"Télécharger";function C(e,t){return e[0]?_t:Tt}let I=C(t),P=I(t);function _(e,t){return e[0]?jt:Nt}let j=_(t),q=j(t),A=t[0]&&Mt(t);return{c(){n=L("div"),r=L("button"),o=R("svg"),P.c(),i=T(),q.c(),l=T(),a=L("button"),u=L("i"),d=T(),g=L("span"),g.textContent=""+("en"===je?"Select all":"Tout sélectionner"),f=T(),m=L("button"),p=L("i"),h=T(),$=O(k),w=T(),v=L("div"),A&&A.c(),M(o,"xmlns","http://www.w3.org/2000/svg"),M(o,"viewBox","0 0 384 512"),M(o,"class","pr-3 svelte-h0t5l9"),M(r,"class",c="button "+(t[0]?"is-success":"is-link")+" mr-3"),M(u,"class","fa-solid fa-square-check"),M(g,"id","all-selection"),M(a,"class","button is-link is-light mr-3"),M(p,"class","fa-solid fa-download"),M(m,"class","button is-link is-light"),M(n,"class","is-right mb-3"),M(v,"class","edit-action is-right svelte-h0t5l9")},m(e,s){E(e,n,s),x(n,r),x(r,o),P.m(o,null),x(r,i),q.m(r,null),x(n,l),x(n,a),x(a,u),x(a,d),x(a,g),x(n,f),x(n,m),x(m,p),x(m,h),x(m,$),E(e,w,s),E(e,v,s),A&&A.m(v,null),b||(y=[N(r,"click",t[13]),N(a,"click",t[7]),N(m,"click",t[8])],b=!0)},p(e,[t]){I!==(I=C(e))&&(P.d(1),P=I(e),P&&(P.c(),P.m(o,null))),j===(j=_(e))&&q?q.p(e,t):(q.d(1),q=j(e),q&&(q.c(),q.m(r,null))),1&t&&c!==(c="button "+(e[0]?"is-success":"is-link")+" mr-3")&&M(r,"class",c),e[0]?A?A.p(e,t):(A=Mt(e),A.c(),A.m(v,null)):A&&(A.d(1),A=null)},i:e,o:e,d(e){e&&S(n),P.d(),q.d(),e&&S(w),e&&S(v),A&&A.d(),b=!1,s(y)}}}async function At(e){const t=SAS_APP_URL.replace("https","http"),n=`${SAS_APP_URL}/annotation/destroy?uri=${t}/annotation/${e}`,r=await fetch(n,{method:"DELETE"});if(204!==r.status)throw new Error(`Failed to delete ${n} due to ${r.status}: '${r.statusText}'`)}function zt(e,t,n){let r,s,o,i,c,l,a;const{selected:u,nbSelected:g}=tt;d(e,u,(e=>n(10,c=e))),d(e,g,(e=>n(12,a=e)));const{allRegions:f}=nt;d(e,f,(e=>n(11,l=e)));const m=W("manifest"),p=W("isValidated");function h(){n(0,s=!s)}return e.$$.update=()=>{4096&e.$$.dirty&&n(9,r=a(!0)),1024&e.$$.dirty&&(o=c(!0)),2560&e.$$.dirty&&(i=r>=Object.keys(l).length)},n(0,s=!p),[s,u,g,f,m,h,async function(){if(await Ye("en"===je?"Are you sure you want to delete these regions?":"Voulez-vous vraiment supprimer ces régions ?","en"===je?"Confirm deletion":"Confirmer la suppression",!0))for(const e of Object.keys(o))try{if(!l.hasOwnProperty(e))continue;await At(e),nt.remove(e),tt.remove(e,Ve)}catch(t){await Ye(`Failed to delete region ${e}: ${t.message}`,"Error")}},function(){i?tt.removeAll(Object.keys(l),Ve):tt.addAll(Object.values(l))},async function(){const e=Object.values(c(!0)).map((e=>e.ref)),t=await Xe((()=>fetch(`${window.location.origin}/${Me}/regions/export`,{method:"POST",headers:{"X-CSRFToken":Ae},body:JSON.stringify({regionsRef:e})})));et(await t.blob(),"regions.zip")},r,c,l,a,()=>h(),()=>location.reload()]}class Vt extends Pe{constructor(e){super(),Se(this,e,zt,qt,i,{})}}const Ht=function(){const e=`${window.location.origin}${window.location.pathname}`,t=window.location.pathname.match(/\d+/g).join("-"),n={[t]:{}},r=_e(1),s=_e({});let o=JSON.parse(localStorage.getItem("selectedRegions"));o&&!o.hasOwnProperty(t)&&(o=n);const i=_e(o||n),c=_e(JSON.parse(localStorage.getItem("excludedCategories"))||[]),l=_e([]),a=_e([]),d=()=>Ge(r,"sp"),g=Ne(r,(e=>(async()=>function(e){const t=25*(e-1),n=t+25,r=u(l).slice(t,n);return a.set(r),r}(e))()));function f(e){Qe(e,r,"sp")}function m(e){localStorage.setItem("selectedRegions",JSON.stringify(e))}const p=Ne(i,(e=>n=>e[t]?.hasOwnProperty(n)));return{currentPage:r,comparedRegions:s,excludedCategories:c,qImgs:l,pageQImgs:a,selectedRegions:i,fetchSimilarity:async function(){De.set(!0);try{const t=await fetch(`${e}compared-regions`),n=await t.json();s.set(n);const r=await fetch(`${e}query-images`),o=await r.json();o.length>0&&(l.set(o),f(d()))}catch(e){console.error("Error:",e),Je.set(e.message)}finally{De.set(!1)}},setPageQImgs:g,getRegionsInfo:function(e){const t=u(s),n=Object.keys(t).filter((t=>t.startsWith(e)));return 1!==n.length?{title:"Error"}:t[n[0]]},handlePageUpdate:f,unselect:function(e){i.update((n=>{const r={...n};return delete r[t][e],m(r),r}))},select:function(e){i.update((n=>{const r={...n,[t]:{...n[t]||{},[e.ref]:e}};return m(r),r}))},addComparedRegions:function(e){s.update((t=>({...t,[e.ref]:e})))},isSelected:p,pageLength:25}}();function Ut(e){let t,n,r;const s=e[1].default,o=g(s,e,e[0],null);return{c(){t=L("table"),n=L("tbody"),o&&o.c(),M(t,"class","table is-fullwidth")},m(e,s){E(e,t,s),x(t,n),o&&o.m(n,null),r=!0},p(e,[t]){o&&o.p&&(!r||1&t)&&p(o,s,e,e[0],r?m(s,e[0],t,null):h(e[0]),null)},i(e){r||(pe(o,e),r=!0)},o(e){he(o,e),r=!1},d(e){e&&S(t),o&&o.d(e)}}}function Ft(e,t,n){let{$$slots:r={},$$scope:s}=t;return e.$$set=e=>{"$$scope"in e&&n(0,s=e.$$scope)},[s,r]}class Bt extends Pe{constructor(e){super(),Se(this,e,Ft,Ut,i,{})}}function Dt(e){let t,n,r,s,o,i,c,l,a,u=e[4]>1&&Jt(e),d=e[4]<e[3]&&Gt(e);return{c(){t=L("nav"),n=L("ul"),u&&u.c(),r=T(),s=L("li"),o=L("a"),i=O(e[4]),c=T(),d&&d.c(),M(o,"class","pagination-link is-current"),M(o,"href",null),M(n,"class","pagination-list ml-0"),M(t,"class","pagination is-centered mb-2"),M(t,"aria-label","pagination")},m(g,f){E(g,t,f),x(t,n),u&&u.m(n,null),x(n,r),x(n,s),x(s,o),x(o,i),x(n,c),d&&d.m(n,null),l||(a=N(o,"click",j(e[8])),l=!0)},p(e,t){e[4]>1?u?u.p(e,t):(u=Jt(e),u.c(),u.m(n,r)):u&&(u.d(1),u=null),16&t&&q(i,e[4]),e[4]<e[3]?d?d.p(e,t):(d=Gt(e),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d(e){e&&S(t),u&&u.d(),d&&d.d(),l=!1,a()}}}function Jt(e){let t,n,r,s,o,i,c=e[4]-1>1&&Xt(e);return{c(){t=L("li"),n=L("a"),n.textContent="1",r=T(),c&&c.c(),s=_(),M(n,"class","pagination-link"),M(n,"href",null)},m(l,a){E(l,t,a),x(t,n),E(l,r,a),c&&c.m(l,a),E(l,s,a),o||(i=N(n,"click",j(e[6])),o=!0)},p(e,t){e[4]-1>1?c?c.p(e,t):(c=Xt(e),c.c(),c.m(s.parentNode,s)):c&&(c.d(1),c=null)},d(e){e&&S(t),e&&S(r),c&&c.d(e),e&&S(s),o=!1,i()}}}function Xt(e){let t,n,r,s,o,i,c=e[4]-1+"",l=e[4]-1>2&&Zt();return{c(){l&&l.c(),t=T(),n=L("li"),r=L("a"),s=O(c),M(r,"class","pagination-link"),M(r,"href",null)},m(c,a){l&&l.m(c,a),E(c,t,a),E(c,n,a),x(n,r),x(r,s),o||(i=N(r,"click",j(e[7])),o=!0)},p(e,n){e[4]-1>2?l||(l=Zt(),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null),16&n&&c!==(c=e[4]-1+"")&&q(s,c)},d(e){l&&l.d(e),e&&S(t),e&&S(n),o=!1,i()}}}function Zt(e){let t;return{c(){t=L("li"),t.innerHTML='<span class="pagination-ellipsis">…</span>'},m(e,n){E(e,t,n)},d(e){e&&S(t)}}}function Gt(e){let t,n,r,s,o,i,c=e[4]+1<e[3]&&Qt(e);return{c(){c&&c.c(),t=T(),n=L("li"),r=L("a"),s=O(e[3]),M(r,"class","pagination-link"),M(r,"href",null)},m(l,a){c&&c.m(l,a),E(l,t,a),E(l,n,a),x(n,r),x(r,s),o||(i=N(r,"click",j(e[10])),o=!0)},p(e,n){e[4]+1<e[3]?c?c.p(e,n):(c=Qt(e),c.c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),8&n&&q(s,e[3])},d(e){c&&c.d(e),e&&S(t),e&&S(n),o=!1,i()}}}function Qt(e){let t,n,r,s,o,i,c,l=e[4]+1+"",a=e[4]+2<e[3]&&Wt();return{c(){t=L("li"),n=L("a"),r=O(l),s=T(),a&&a.c(),o=_(),M(n,"class","pagination-link"),M(n,"href",null)},m(l,u){E(l,t,u),x(t,n),x(n,r),E(l,s,u),a&&a.m(l,u),E(l,o,u),i||(c=N(n,"click",j(e[9])),i=!0)},p(e,t){16&t&&l!==(l=e[4]+1+"")&&q(r,l),e[4]+2<e[3]?a||(a=Wt(),a.c(),a.m(o.parentNode,o)):a&&(a.d(1),a=null)},d(e){e&&S(t),e&&S(s),a&&a.d(e),e&&S(o),i=!1,c()}}}function Wt(e){let t;return{c(){t=L("li"),t.innerHTML='<span class="pagination-ellipsis">…</span>'},m(e,n){E(e,t,n)},d(e){e&&S(t)}}}function Kt(t){let n,r,s,o,i,c,l,a=t[4]*t[2]-t[2]+1+"",u=Math.min(t[4]*t[2],t[1])+"",d=(t[3]>1||t[1]>t[2])&&Dt(t);return{c(){d&&d.c(),n=T(),r=L("div"),s=O(a),o=O(" - "),i=O(u),c=O(" / "),l=O(t[1]),M(r,"class","is-size-7 is-center mb-4")},m(e,t){d&&d.m(e,t),E(e,n,t),E(e,r,t),x(r,s),x(r,o),x(r,i),x(r,c),x(r,l)},p(e,[t]){e[3]>1||e[1]>e[2]?d?d.p(e,t):(d=Dt(e),d.c(),d.m(n.parentNode,n)):d&&(d.d(1),d=null),20&t&&a!==(a=e[4]*e[2]-e[2]+1+"")&&q(s,a),22&t&&u!==(u=Math.min(e[4]*e[2],e[1])+"")&&q(i,u),2&t&&q(l,e[1])},i:e,o:e,d(e){d&&d.d(e),e&&S(n),e&&S(r)}}}function Yt(e,t,n){let r,s,{store:o}=t;const{currentPage:i}=o;d(e,i,(e=>n(4,s=e)));let{nbOfItems:c}=t,{pageLength:l=Be}=t;return e.$$set=e=>{"store"in e&&n(0,o=e.store),"nbOfItems"in e&&n(1,c=e.nbOfItems),"pageLength"in e&&n(2,l=e.pageLength)},e.$$.update=()=>{6&e.$$.dirty&&n(3,r=l<Be?1:Math.ceil(c/l))},[o,c,l,r,s,i,()=>o.handlePageUpdate(1),()=>o.handlePageUpdate(s-1),()=>o.handlePageUpdate(s),()=>o.handlePageUpdate(s+1),()=>o.handlePageUpdate(r)]}class en extends Pe{constructor(e){super(),Se(this,e,Yt,Kt,i,{store:0,nbOfItems:1,pageLength:2})}}const tn='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">\n        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>\n    </svg>',nn='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">\n        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n    </svg>',rn='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">\n        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>\n        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n    </svg>',sn='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">\n        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>\n    </svg>',on='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">\n        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>\n        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>\n    </svg>',cn='<svg class="svg-icon" width="60" height="67" viewBox="0 0 60 67" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M52.7 9H7.01001C4.24306 9 2 11.2431 2 14.01V59.7C2 62.4669 4.24306 64.71 7.01001 64.71H52.7C55.467 64.71 57.71 62.4669 57.71 59.7V14.01C57.71 11.2431 55.467 9 52.7 9Z" stroke="currentColor" stroke-width="3"/>\n        <line x1="2.32933" y1="35.9793" x2="24.1517" y2="57.8017" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>\n        <line x1="24.1516" y1="57.8016" x2="57.2284" y2="24.7248" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>\n    </svg>',ln="en"===je?"overall visual matches":"correspondances visuelles globales",an="en"===je?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",un="en"===je?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",dn="en"===je?"regions without match":"régions sans correspondance",gn="en"===je?"user specific category":"correspondances spécifiques à l'utilisateur";function fn(e){let t,n,r,o,i,c,l,a,u,d,g,f,m,p,h,$,w;n=new mt({props:{item:e[4],size:256,desc:e[5],isSquare:!1}});let v=e[3]&&function(e){let t,n,r;return{c(){t=L("span"),M(t,"class","tag is-hoverable pl-4 pr-3 py-4"),M(t,"title","en"===je?"Validate match":"Valider la correspondance"),V(t,"is-selected",e[0])},m(s,o){E(s,t,o),t.innerHTML=cn,n||(r=[N(t,"click",e[6]),N(t,"keyup",null)],n=!0)},p(e,n){1&n&&V(t,"is-selected",e[0])},d(e){e&&S(t),n=!1,s(r)}}}(e);return{c(){t=L("div"),xe(n.$$.fragment),r=T(),o=L("div"),v&&v.c(),i=T(),c=L("span"),l=T(),a=L("span"),u=T(),d=L("span"),g=T(),f=L("span"),m=T(),p=L("span"),M(c,"class","tag is-hoverable pl-4 pr-3 py-4"),M(c,"title","en"===je?"Exact match":"Correspondance exacte"),V(c,"is-selected",1===e[1]),M(a,"class","tag is-hoverable py-4 px-3"),M(a,"title","en"===je?"Partial match":"Correspondance partielle"),V(a,"is-selected",2===e[1]),M(d,"class","tag is-hoverable py-4 px-3"),M(d,"title","en"===je?"Semantic match":"Correspondance sémantique"),V(d,"is-selected",3===e[1]),M(f,"class","tag is-hoverable py-4 px-3"),M(f,"title","en"===je?"No match":"Aucune correspondance"),V(f,"is-selected",4===e[1]),M(p,"class","tag is-hoverable pl-3 pr-4 py-4"),M(p,"title","en"===je?"User match":"Correspondance utilisateur"),V(p,"is-selected",e[2]),M(o,"class","tags has-addons is-dark is-center")},m(s,b){E(s,t,b),Ce(n,t,null),x(t,r),x(t,o),v&&v.m(o,null),x(o,i),x(o,c),c.innerHTML=tn,x(o,l),x(o,a),a.innerHTML=nn,x(o,u),x(o,d),d.innerHTML=rn,x(o,g),x(o,f),f.innerHTML=sn,x(o,m),x(o,p),p.innerHTML=on,h=!0,$||(w=[N(c,"click",e[16]),N(c,"keyup",null),N(a,"click",e[17]),N(a,"keyup",null),N(d,"click",e[18]),N(d,"keyup",null),N(f,"click",e[19]),N(f,"keyup",null),N(p,"click",e[20]),N(p,"keyup",null)],$=!0)},p(e,[t]){e[3]&&v.p(e,t),(!h||2&t)&&V(c,"is-selected",1===e[1]),(!h||2&t)&&V(a,"is-selected",2===e[1]),(!h||2&t)&&V(d,"is-selected",3===e[1]),(!h||2&t)&&V(f,"is-selected",4===e[1]),(!h||4&t)&&V(p,"is-selected",e[2])},i(e){h||(pe(n.$$.fragment,e),h=!0)},o(e){he(n.$$.fragment,e),h=!1},d(e){e&&S(t),Ie(n),v&&v.d(),$=!1,s(w)}}}function mn(e,t,n){let r,s,o;const i=window.location.origin;let{qImg:c}=t,{sImg:l}=t,{qRegions:a}=t,{sRegions:u}=t,{score:d=0}=t,{category:g=null}=t,{users:f=[]}=t,{isManual:m}=t;const p=W("similaritySuggestionContext")||!1,[h,$,w,v]=l.split(".")[0].split("_"),b={id:l,img:l,title:`Canvas ${w} - ${v} - ${"en"===je?"Witness":"Témoin"} #${y=h,y.match(/\d+/g).toString()}`,xywh:v,canvas:w,ref:l.replace(".jpg",""),type:Ve};var y;const k=`${h}_${$}`,x=`${Ht.getRegionsInfo(k).title}<br>\n        Page ${parseInt(w)}<br>\n        <b>${d?`Score: ${d}`:"en"===je?"Manual similarity":"Correspondance manuelle"}</b>`;function C(e){let t=(e=e.slice()).indexOf(Number(qe));return s&&-1===t?e.push(Number(qe)):s||-1===t||e.splice(t,1),console.log(">>>>>>>>>>>>",e),e}const I=()=>({img_1:c,img_2:l,q_regions:a,s_regions:u,score:d,category:r,category_x:C(f),is_manual:m});function E(e){5===e?n(2,s=!s):n(1,r=r===e?null:e)}async function S(){n(0,o=!0),console.log(i,`${i}/${Me}`)}async function P(e){E(e);try{(await fetch(`${i}/${Me}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ae},body:JSON.stringify(I())})).ok||(console.error("Error: Network response was not ok"),E(e))}catch(t){console.error("Error:",t),E(e)}}async function L(e){return p?S().then((()=>P(e))):P(e)}return e.$$set=e=>{"qImg"in e&&n(8,c=e.qImg),"sImg"in e&&n(9,l=e.sImg),"qRegions"in e&&n(10,a=e.qRegions),"sRegions"in e&&n(11,u=e.sRegions),"score"in e&&n(12,d=e.score),"category"in e&&n(13,g=e.category),"users"in e&&n(14,f=e.users),"isManual"in e&&n(15,m=e.isManual)},e.$$.update=()=>{8192&e.$$.dirty&&n(1,r=g),16384&e.$$.dirty&&n(2,s=f.includes(Number(qe))||!1)},n(0,o=!1),[o,r,s,p,b,x,S,L,c,l,a,u,d,g,f,m,()=>L(1),()=>L(2),()=>L(3),()=>L(4),()=>L(5)]}class pn extends Pe{constructor(e){super(),Se(this,e,mn,fn,i,{qImg:8,sImg:9,qRegions:10,sRegions:11,score:12,category:13,users:14,isManual:15})}}function hn(e,t,n){const r=e.slice();return r[6]=t[n][0],r[7]=t[n][1],r[8]=t[n][2],r[9]=t[n][3],r[10]=t[n][4],r[11]=t[n][5],r[12]=t[n][6],r[13]=t[n][7],r}function $n(t){let n,r,s="en"===je?`Error when retrieving similar regions: ${t[16]}`:`Erreur de recupération des régions similaires: ${t[16]}`;return{c(){n=L("div"),r=O(s),M(n,"class","faded is-center")},m(e,t){E(e,n,t),x(n,r)},p(e,t){2&t&&s!==(s="en"===je?`Error when retrieving similar regions: ${e[16]}`:`Erreur de recupération des régions similaires: ${e[16]}`)&&q(r,s)},i:e,o:e,d(e){e&&S(n)}}}function wn(e){let t,n,r=e[5],s=[];for(let t=0;t<r.length;t+=1)s[t]=kn(hn(e,r,t));const o=e=>he(s[e],1,1,(()=>{s[e]=null}));let i=null;return r.length||(i=vn(e)),{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=_(),i&&i.c()},m(e,r){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,r);E(e,t,r),i&&i.m(e,r),n=!0},p(e,n){if(7&n){let c;for(r=e[5],c=0;c<r.length;c+=1){const o=hn(e,r,c);s[c]?(s[c].p(o,n),pe(s[c],1)):(s[c]=kn(o),s[c].c(),pe(s[c],1),s[c].m(t.parentNode,t))}for(fe(),c=r.length;c<s.length;c+=1)o(c);me(),!r.length&&i?i.p(e,n):r.length?i&&(i.d(1),i=null):(i=vn(e),i.c(),i.m(t.parentNode,t))}},i(e){if(!n){for(let e=0;e<r.length;e+=1)pe(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)he(s[e]);n=!1},d(e){P(s,e),e&&S(t),i&&i.d(e)}}}function vn(e){let t,n;function r(e,n){return 4&n&&(t=null),null==t&&(t=!(0!==Object.values(e[2]).length)),t?yn:bn}let s=r(e,-1),o=s(e);return{c(){o.c(),n=_()},m(e,t){o.m(e,t),E(e,n,t)},p(e,t){s===(s=r(e,t))&&o?o.p(e,t):(o.d(1),o=s(e),o&&(o.c(),o.m(n.parentNode,n)))},d(e){o.d(e),e&&S(n)}}}function bn(t){let n;return{c(){n=L("div"),n.textContent=("en"===je?"No similar regions":"Pas de régions similaires")+" \n            ",M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function yn(t){let n;return{c(){n=L("div"),n.textContent=("en"===je?"No document selected":"Aucun document sélectionné")+" \n            ",M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function kn(e){let t,n;return t=new pn({props:{qImg:e[0],sImg:e[8],score:e[6],qRegions:e[9],sRegions:e[10],category:e[11],users:e[12],isManual:e[13]}}),{c(){xe(t.$$.fragment)},m(e,r){Ce(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.qImg=e[0]),2&n&&(r.sImg=e[8]),2&n&&(r.score=e[6]),2&n&&(r.qRegions=e[9]),2&n&&(r.sRegions=e[10]),2&n&&(r.category=e[11]),2&n&&(r.users=e[12]),2&n&&(r.isManual=e[13]),t.$set(r)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){Ie(t,e)}}}function xn(t){let n;return{c(){n=L("div"),n.textContent=""+("en"!==je||t[4]?"fr"!==je||t[4]?"en"===je&&t[4]?"Retrieving suggested regions...":"Récupération de suggestions de similarités...":"Récupération des régions similaires...":"Retrieving similar regions..."),M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function Cn(e){let t,n,r,s={ctx:e,current:null,token:null,hasCatch:!0,pending:xn,then:wn,catch:$n,value:5,error:16,blocks:[,,,]};return ve(n=e[1],s),{c(){t=_(),s.block.c()},m(e,n){E(e,t,n),s.block.m(e,s.anchor=n),s.mount=()=>t.parentNode,s.anchor=t,r=!0},p(t,[r]){e=t,s.ctx=e,2&r&&n!==(n=e[1])&&ve(n,s)||be(s,e,r)},i(e){r||(pe(s.block),r=!0)},o(e){for(let e=0;e<3;e+=1){he(s.blocks[e])}r=!1},d(e){e&&S(t),s.block.d(e),s.token=null,s=null}}}function In(e,t,n){let r;const{selectedRegions:s}=Ht;d(e,s,(e=>n(2,r=e)));let{qImg:o}=t,{sImgsPromise:i}=t;const c=W("similaritySuggestionContext")||!1;return e.$$set=e=>{"qImg"in e&&n(0,o=e.qImg),"sImgsPromise"in e&&n(1,i=e.sImgsPromise)},[o,i,r,s,c]}class En extends Pe{constructor(e){super(),Se(this,e,In,Cn,i,{qImg:0,sImgsPromise:1})}}function Sn(e){let t,n,r;return n=new En({props:{qImg:e[0],sImgsPromise:e[1],displayType:"similarityMatches"}}),{c(){t=L("div"),xe(n.$$.fragment),M(t,"class","grid is-gap-2")},m(e,s){E(e,t,s),Ce(n,t,null),r=!0},p(e,[t]){const r={};1&t&&(r.qImg=e[0]),2&t&&(r.sImgsPromise=e[1]),n.$set(r)},i(e){r||(pe(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){e&&S(t),Ie(n)}}}function Pn(e,t,n){let r,s,o;const{selectedRegions:i,excludedCategories:c}=Ht;d(e,i,(e=>n(5,o=e))),d(e,c,(e=>n(4,s=e)));const l=`${window.location.origin}${window.location.pathname}`,a=window.location.pathname.match(/\d+/g).join("-");let{qImg:u}=t;return e.$$set=e=>{"qImg"in e&&n(0,u=e.qImg)},e.$$.update=()=>{49&e.$$.dirty&&n(1,r=async function(e,t,n){if(0===Object.values(t).map((e=>e.id)).length)return{};const r=await fetch(`${l}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:Object.values(t[a]).map((e=>e.id)),qImg:e,topk:10,excludedCategories:n}),headers:{"Content-Type":"application/json","X-CSRFToken":Ae}});return await r.json()}(u,o,s))},[u,r,i,c,s,o]}class Ln extends Pe{constructor(e){super(),Se(this,e,Pn,Sn,i,{qImg:0})}}function Rn(t){let n,r,s,o,i,c;return{c(){n=L("div"),r=L("button"),s=L("span"),o=T(),i=L("span"),c=O(t[2]),M(s,"class","iconify"),M(s,"data-icon",t[0]),M(s,"title",t[1]),M(i,"class","tooltip "+t[3]+" svelte-4qzyt4"),M(r,"class","svelte-4qzyt4"),M(n,"class","is-inline-block tooltip-generic svelte-4qzyt4")},m(e,t){E(e,n,t),x(n,r),x(r,s),x(r,o),x(r,i),x(i,c)},p(e,[t]){1&t&&M(s,"data-icon",e[0]),2&t&&M(s,"title",e[1]),4&t&&q(c,e[2])},i:e,o:e,d(e){e&&S(n)}}}function On(e,t,n){let{iconifyIcon:r,altText:s,tooltipText:o}=t;const i=o.length<20?"tooltip-thin":o.length<100?"tooltip-mid":"tooltip-wide";return e.$$set=e=>{"iconifyIcon"in e&&n(0,r=e.iconifyIcon),"altText"in e&&n(1,s=e.altText),"tooltipText"in e&&n(2,o=e.tooltipText)},[r,s,o,i]}class Tn extends Pe{constructor(e){super(),Se(this,e,On,Rn,i,{iconifyIcon:0,altText:1,tooltipText:2})}}function _n(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Nn(e){let t,n,r,s,o=e[5].length+"";return r=new Tn({props:{iconifyIcon:"material-symbols:help-outline",altText:"en"===je?"Display help":"Afficher une explication",tooltipText:e[2]}}),{c(){t=O(o),n=O(" suggested regions\n                "),xe(r.$$.fragment)},m(e,o){E(e,t,o),E(e,n,o),Ce(r,e,o),s=!0},p(e,n){(!s||2&n)&&o!==(o=e[5].length+"")&&q(t,o)},i(e){s||(pe(r.$$.fragment,e),s=!0)},o(e){he(r.$$.fragment,e),s=!1},d(e){e&&S(t),e&&S(n),Ie(r,e)}}}function jn(t){return{c:e,m:e,p:e,i:e,o:e,d:e}}function Mn(e){let t,n,r,s,o,i,c,l,a={ctx:e,current:null,token:null,hasCatch:!1,pending:jn,then:Nn,catch:_n,value:5,blocks:[,,,]};return ve(s=e[1],a),c=new En({props:{qImg:e[0],sImgsPromise:e[1],displayType:"suggestionMatches"}}),{c(){t=L("div"),n=L("div"),r=L("div"),a.block.c(),o=T(),i=L("div"),xe(c.$$.fragment),M(r,"class","block"),M(i,"class","grid is-gap-2"),M(n,"class","matches-suggestion svelte-1li2qm8"),M(t,"class","block matches-suggestion-wrapper svelte-1li2qm8")},m(e,s){E(e,t,s),x(t,n),x(n,r),a.block.m(r,a.anchor=null),a.mount=()=>r,a.anchor=null,x(n,o),x(n,i),Ce(c,i,null),l=!0},p(t,[n]){e=t,a.ctx=e,2&n&&s!==(s=e[1])&&ve(s,a)||be(a,e,n);const r={};1&n&&(r.qImg=e[0]),2&n&&(r.sImgsPromise=e[1]),c.$set(r)},i(e){l||(pe(a.block),pe(c.$$.fragment,e),l=!0)},o(e){for(let e=0;e<3;e+=1){he(a.blocks[e])}he(c.$$.fragment,e),l=!1},d(e){e&&S(t),a.block.d(),a.token=null,a=null,Ie(c)}}}function qn(e,t,n){let r,{qImg:s}=t;Q("similaritySuggestionContext",!0);const o=`${window.location.origin}${window.location.pathname}`,i="en"===je?"Suggested matches are exact matches to images that have an exact match with the current image. There may be up to 5 exact matches connecting the current image and suggested images.":"Les correspondances suggerées correspondent à des correspondances exactes à des images ayant une correspondance exacte avec l'image actuelle. Il peut y avoir jusqu'à 5 images reliant l'image actuelle à une correspondance suggerée.";return e.$$set=e=>{"qImg"in e&&n(0,s=e.qImg)},n(1,r=(async()=>fetch(`${o}suggested-regions/${s}`).then((e=>e.json())))()),[s,r,i]}class An extends Pe{constructor(e){super(),Se(this,e,qn,Mn,i,{qImg:0})}}function zn(e){let t,n,r,o,i,c,a,u,d,g,f,m,p,h,$,w,v,b,y,k,C,I,P,_,j,q,V,H,U,F,B,D,J=parseInt(e[4])+"";return q=new Ln({props:{qImg:e[0]}}),U=new An({props:{qImg:e[0]}}),{c(){t=L("tr"),n=L("th"),r=L("div"),o=L("a"),i=L("i"),c=O("\n                Page "),a=O(J),u=T(),d=L("img"),f=T(),m=L("div"),p=L("div"),h=L("input"),$=T(),w=L("button"),w.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',v=T(),b=L("button"),y=R("svg"),k=R("path"),P=T(),_=L("td"),j=L("div"),xe(q.$$.fragment),V=T(),H=L("div"),xe(U.$$.fragment),M(i,"class","fa-solid fa-pen-to-square"),M(o,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),M(o,"href",Ke(e[5],parseInt(e[4]))),M(o,"target","_blank"),l(d.src,g=We(e[0],"full","250,"))||M(d,"src",g),M(d,"alt","Query region"),M(d,"class","mb-3 card"),M(h,"class","input is-small tag"),M(h,"type","text"),M(h,"placeholder","en"===je?"Add new match":"Ajouter une correspondance"),M(w,"class","button is-small tag is-link is-center"),M(p,"class","tags has-addons"),z(p,"flex-wrap","nowrap"),M(k,"fill","white"),M(k,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),M(y,"xmlns","http://www.w3.org/2000/svg"),M(y,"viewBox","0 0 384 512"),M(b,"id","no-match"),M(b,"class",C="button is-small tag is-danger is-center m-0 "+(1===e[2]?"visible":"")+" svelte-f4c92p"),M(b,"title","en"===je?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),M(m,"class","new-similarity control pt-2 is-center svelte-f4c92p"),M(r,"class","content-wrapper py-5"),M(n,"class","is-3 center-flex is-narrow"),z(n,"width","260px"),M(j,"class","fixed-grid has-5-cols"),M(H,"class","fixed-grid has-5-cols"),M(_,"class","p-5 is-fullwidth")},m(s,l){E(s,t,l),x(t,n),x(n,r),x(r,o),x(o,i),x(o,c),x(o,a),x(r,u),x(r,d),x(r,f),x(r,m),x(m,p),x(p,h),A(h,e[1]),x(p,$),x(p,w),x(m,v),x(m,b),x(b,y),x(y,k),x(t,P),x(t,_),x(_,j),Ce(q,j,null),x(_,V),x(_,H),Ce(U,H,null),F=!0,B||(D=[N(h,"input",e[9]),N(w,"click",e[6]),N(b,"click",e[7])],B=!0)},p(e,[t]){(!F||1&t&&!l(d.src,g=We(e[0],"full","250,")))&&M(d,"src",g),2&t&&h.value!==e[1]&&A(h,e[1]),(!F||4&t&&C!==(C="button is-small tag is-danger is-center m-0 "+(1===e[2]?"visible":"")+" svelte-f4c92p"))&&M(b,"class",C);const n={};1&t&&(n.qImg=e[0]),q.$set(n);const r={};1&t&&(r.qImg=e[0]),U.$set(r)},i(e){F||(se((()=>{F&&(I||(I=we(b,Re,{duration:500},!0)),I.run(1))})),pe(q.$$.fragment,e),pe(U.$$.fragment,e),F=!0)},o(e){I||(I=we(b,Re,{duration:500},!1)),I.run(0),he(q.$$.fragment,e),he(U.$$.fragment,e),F=!1},d(e){e&&S(t),e&&I&&I.end(),Ie(q),Ie(U),B=!1,s(D)}}}function Vn(e,t,n){let r,s;const{selectedRegions:o}=Ht;d(e,o,(e=>n(8,s=e)));let{qImg:i}=t,c="";const[l,a,u,g]=i.split(".")[0].split("_"),f=W("manifest"),m=`${window.location.origin}${window.location.pathname}`,p=window.location.pathname.match(/\d+/g).join("-"),h="en"===je?"Error":"Erreur";return e.$$set=e=>{"qImg"in e&&n(0,i=e.qImg)},e.$$.update=()=>{256&e.$$.dirty&&n(2,r=s.hasOwnProperty(p)?Object.values(s[p]).length:0)},[i,c,r,o,u,f,async function(){var e;if(c&&(e=(e=c).replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(e)))try{const e=await fetch(`${m}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ae},body:JSON.stringify({q_img:i.replace(".jpg",""),s_img:c})});e.ok||(console.error("Error: Network response was not ok"),await Ye("en"===je?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",h));const t=await e.json();if(t.hasOwnProperty("error")||!t.hasOwnProperty("s_regions"))return void await Ye("en"===je?`Request was unsuccessful, match was not added:<br>${t.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${t.error}`,h);const n=t.s_regions;Ht.addComparedRegions(n),Ht.select(n)}catch(e){console.error("Error:",e),await Ye("en"===je?`An error has occurred, match was not added:<br>${e}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${e}`,h)}else await Ye("en"===je?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error")},async function(){const e=Object.values(s[p])[0];if(await Ye("en"===je?`Do you confirm this region does not have any match in ${e.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${e.title} ?`,"en"===je?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${m}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":Ae},body:JSON.stringify({q_img:i,s_regions:e.id})})).ok||(console.error("Error: Network response was not ok"),await Ye("en"===je?"Problem with network":"Problème de réseau",h)),Ht.select(e)}catch(e){console.error("Error:",e),await Ye("en"===je?`An error has occurred, request was unsuccessful:<br>${e}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${e}`,h)}},s,function(){c=this.value,n(1,c)}]}class Hn extends Pe{constructor(e){super(),Se(this,e,Vn,zn,i,{qImg:0})}}function Un(e,t,n){const r=e.slice();return r[8]=t[n],r}function Fn(t){let n,r,s,o=t[11]+"";return{c(){n=L("tr"),r=O("Error when retrieving similar regions: "),s=O(o)},m(e,t){E(e,n,t),x(n,r),x(n,s)},p(e,t){2&t&&o!==(o=e[11]+"")&&q(s,o)},i:e,o:e,d(e){e&&S(n)}}}function Bn(e){let t,n,r=[],s=new Map,o=e[2];const i=e=>e[8].id;for(let t=0;t<o.length;t+=1){let n=Un(e,o,t),c=i(n);s.set(c,r[t]=Jn(c,n))}let c=null;return o.length||(c=Dn()),{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=_(),c&&c.c()},m(e,s){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,s);E(e,t,s),c&&c.m(e,s),n=!0},p(e,n){4&n&&(o=e[2],fe(),r=ke(r,n,i,1,e,o,s,t.parentNode,ye,Jn,t,Un),me(),!o.length&&c?c.p(e,n):o.length?c&&(c.d(1),c=null):(c=Dn(),c.c(),c.m(t.parentNode,t)))},i(e){if(!n){for(let e=0;e<o.length;e+=1)pe(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)he(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t),c&&c.d(e)}}}function Dn(t){let n,r;return{c(){n=L("tr"),n.textContent=""+("en"===je?"No similarity":"Pas de similarités"),r=T(),M(n,"class","faded is-center")},m(e,t){E(e,n,t),E(e,r,t)},p:e,d(e){e&&S(n),e&&S(r)}}}function Jn(e,t){let n,r,s;return r=new Hn({props:{qImg:t[8]}}),{key:e,first:null,c(){n=_(),xe(r.$$.fragment),this.first=n},m(e,t){E(e,n,t),Ce(r,e,t),s=!0},p(e,n){t=e;const s={};4&n&&(s.qImg=t[8]),r.$set(s)},i(e){s||(pe(r.$$.fragment,e),s=!0)},o(e){he(r.$$.fragment,e),s=!1},d(e){e&&S(n),Ie(r,e)}}}function Xn(t){let n;return{c(){n=L("tr"),n.textContent=""+("en"===je?"Retrieving similarity page...":"Récupération la page de similarité..."),M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function Zn(e){let t,n,r,s={ctx:e,current:null,token:null,hasCatch:!0,pending:Xn,then:Bn,catch:Fn,value:7,error:11,blocks:[,,,]};return ve(n=e[1],s),{c(){t=_(),s.block.c()},m(e,n){E(e,t,n),s.block.m(e,s.anchor=n),s.mount=()=>t.parentNode,s.anchor=t,r=!0},p(t,r){e=t,s.ctx=e,2&r&&n!==(n=e[1])&&ve(n,s)||be(s,e,r)},i(e){r||(pe(s.block),r=!0)},o(e){for(let e=0;e<3;e+=1){he(s.blocks[e])}r=!1},d(e){e&&S(t),s.block.d(e),s.token=null,s=null}}}function Gn(e){let t,n,r,s,o,i;return t=new en({props:{store:Ht,nbOfItems:e[0].length,pageLength:e[6]}}),r=new Bt({props:{$$slots:{default:[Zn]},$$scope:{ctx:e}}}),o=new en({props:{store:Ht,nbOfItems:e[0].length,pageLength:e[6]}}),{c(){xe(t.$$.fragment),n=T(),xe(r.$$.fragment),s=T(),xe(o.$$.fragment)},m(e,c){Ce(t,e,c),E(e,n,c),Ce(r,e,c),E(e,s,c),Ce(o,e,c),i=!0},p(e,[n]){const s={};1&n&&(s.nbOfItems=e[0].length),t.$set(s);const i={};4102&n&&(i.$$scope={dirty:n,ctx:e}),r.$set(i);const c={};1&n&&(c.nbOfItems=e[0].length),o.$set(c)},i(e){i||(pe(t.$$.fragment,e),pe(r.$$.fragment,e),pe(o.$$.fragment,e),i=!0)},o(e){he(t.$$.fragment,e),he(r.$$.fragment,e),he(o.$$.fragment,e),i=!1},d(e){Ie(t,e),e&&S(n),Ie(r,e),e&&S(s),Ie(o,e)}}}function Qn(e,t,n){let r,s,o;const{qImgs:i,pageQImgs:c,setPageQImgs:l,pageLength:a}=Ht;return d(e,i,(e=>n(0,r=e))),d(e,c,(e=>n(2,o=e))),d(e,l,(e=>n(1,s=e))),[r,s,o,i,c,l,a]}class Wn extends Pe{constructor(e){super(),Se(this,e,Qn,Gn,i,{})}}function Kn(e,t,n){const r=e.slice();return r[8]=t[n][0],r[9]=t[n][1],r}function Yn(t){let n;return{c(){n=L("span"),n.textContent=""+("en"===je?"current":"courant"),M(n,"class","tag is-dark svelte-503e8j")},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function er(e){let t,n,r,o,i,c,l,a,u=e[5](e[8]),d=Ze(e[9].title)+"",g=u&&Yn();function f(){return e[6](e[9])}return{c(){t=L("div"),g&&g.c(),n=T(),r=L("span"),o=O(d),c=T(),M(r,"class",i="tag is-small "+(e[0](e[8])?"is-selected":"is-contrasted")+" svelte-503e8j"),M(t,"class","tags has-addons mb-0 is-hoverable")},m(e,s){E(e,t,s),g&&g.m(t,null),x(t,n),x(t,r),x(r,o),x(t,c),l||(a=[N(t,"click",f),N(t,"keyup",null)],l=!0)},p(s,c){e=s,2&c&&(u=e[5](e[8])),u?g?g.p(e,c):(g=Yn(),g.c(),g.m(t,n)):g&&(g.d(1),g=null),2&c&&d!==(d=Ze(e[9].title)+"")&&q(o,d),3&c&&i!==(i="tag is-small "+(e[0](e[8])?"is-selected":"is-contrasted")+" svelte-503e8j")&&M(r,"class",i)},d(e){e&&S(t),g&&g.d(),l=!1,s(a)}}}function tr(t){let n,r=Object.entries(t[1]),s=[];for(let e=0;e<r.length;e+=1)s[e]=er(Kn(t,r,e));return{c(){n=L("div");for(let e=0;e<s.length;e+=1)s[e].c();M(n,"class","field is-grouped is-grouped-multiline")},m(e,t){E(e,n,t);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null)},p(e,[t]){if(51&t){let o;for(r=Object.entries(e[1]),o=0;o<r.length;o+=1){const i=Kn(e,r,o);s[o]?s[o].p(i,t):(s[o]=er(i),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=r.length}},i:e,o:e,d(e){e&&S(n),P(s,e)}}}function nr(e,t,n){let r,s;const{comparedRegions:o,isSelected:i}=Ht;d(e,o,(e=>n(1,s=e))),d(e,i,(e=>n(0,r=e)));const c=W("imgPrefix");function l(e){r(e.ref)?Ht.unselect(e.ref):Ht.select(e)}return[r,s,o,i,l,function(e){return e.startsWith(c)},e=>l(e)]}class rr extends Pe{constructor(e){super(),Se(this,e,nr,tr,i,{})}}function sr(e,t,n){const r=e.slice();return r[8]=t[n],r}function or(e){let t,n,r,s,o,i,c,l=e[8].title+"";function a(e,t){return 6&t&&(r=null),null==r&&(r=!!e[2].includes(e[8].id)),r?cr:ir}let u=a(e,-1),d=u(e);return{c(){t=L("div"),n=L("span"),d.c(),s=T(),o=O(l),M(n,"class","label svelte-1a5w65y"),M(t,"class","label-container px-2 py-1 svelte-1a5w65y")},m(e,r){E(e,t,r),x(t,n),d.m(n,null),x(n,s),x(n,o),c=!0},p(e,t){u===(u=a(e,t))&&d?d.p(e,t):(d.d(1),d=u(e),d&&(d.c(),d.m(n,s))),(!c||2&t)&&l!==(l=e[8].title+"")&&q(o,l)},i(e){c||(se((()=>{c&&(i||(i=we(t,Oe,{x:40,duration:300},!0)),i.run(1))})),c=!0)},o(e){i||(i=we(t,Oe,{x:40,duration:300},!1)),i.run(0),c=!1},d(e){e&&S(t),d.d(),e&&i&&i.end()}}}function ir(t){let n,r="en"===je?"Hide ":"Masquer les ";return{c(){n=O(r)},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function cr(t){let n,r="en"===je?"Show ":"Afficher les ";return{c(){n=O(r)},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function lr(e){let t,n,r,o,i,c,l,a,u=e[8].svg+"",d=e[0]===e[8].id&&or(e);function g(){return e[5](e[8])}function f(){return e[7](e[8])}return{c(){t=L("div"),n=L("span"),r=T(),d&&d.c(),o=T(),M(n,"class","tool-icon p-1 svelte-1a5w65y"),M(t,"class",i="toolbar-item "+(e[2].includes(e[8].id)?"":"selected")+" svelte-1a5w65y")},m(s,i){E(s,t,i),x(t,n),n.innerHTML=u,x(t,r),d&&d.m(t,null),x(t,o),c=!0,l||(a=[N(t,"mouseenter",g),N(t,"mouseleave",e[6]),N(t,"click",f),N(t,"keyup",null)],l=!0)},p(r,s){e=r,(!c||2&s)&&u!==(u=e[8].svg+"")&&(n.innerHTML=u),e[0]===e[8].id?d?(d.p(e,s),3&s&&pe(d,1)):(d=or(e),d.c(),pe(d,1),d.m(t,o)):d&&(fe(),he(d,1,1,(()=>{d=null})),me()),(!c||6&s&&i!==(i="toolbar-item "+(e[2].includes(e[8].id)?"":"selected")+" svelte-1a5w65y"))&&M(t,"class",i)},i(e){c||(pe(d),c=!0)},o(e){he(d),c=!1},d(e){e&&S(t),d&&d.d(),l=!1,s(a)}}}function ar(e){let t,n,r,s=e[1],o=[];for(let t=0;t<s.length;t+=1)o[t]=lr(sr(e,s,t));const i=e=>he(o[e],1,1,(()=>{o[e]=null}));return{c(){t=L("div");for(let e=0;e<o.length;e+=1)o[e].c();M(t,"class","toolbar svelte-1a5w65y")},m(e,n){E(e,t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);r=!0},p(e,[n]){if(23&n){let r;for(s=e[1],r=0;r<s.length;r+=1){const i=sr(e,s,r);o[r]?(o[r].p(i,n),pe(o[r],1)):(o[r]=lr(i),o[r].c(),pe(o[r],1),o[r].m(t,null))}for(fe(),r=s.length;r<o.length;r+=1)i(r);me()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)pe(o[e]);se((()=>{r&&(n||(n=we(t,Re,{duration:500},!0)),n.run(1))})),r=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)he(o[e]);n||(n=we(t,Re,{duration:500},!1)),n.run(0),r=!1},d(e){e&&S(t),P(o,e),e&&n&&n.end()}}}function ur(e,t,n){let r,s;const{excludedCategories:o}=Ht;d(e,o,(e=>n(2,s=e)));let i=null;function c(e){o.update((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e])),localStorage.setItem("excludedCategories",JSON.stringify(s))}return n(1,r=[{id:1,title:ln,svg:tn},{id:2,title:an,svg:nn},{id:3,title:un,svg:rn},{id:4,title:dn,svg:sn},{id:5,title:gn,svg:on}]),[i,r,s,o,c,e=>n(0,i=e.id),()=>n(0,i=null),e=>c(e.id)]}class dr extends Pe{constructor(e){super(),Se(this,e,ur,ar,i,{})}}function gr(t){let n,r,s,o;return n=new rr({}),s=new Wn({}),{c(){xe(n.$$.fragment),r=T(),xe(s.$$.fragment)},m(e,t){Ce(n,e,t),E(e,r,t),Ce(s,e,t),o=!0},p:e,i(e){o||(pe(n.$$.fragment,e),pe(s.$$.fragment,e),o=!0)},o(e){he(n.$$.fragment,e),he(s.$$.fragment,e),o=!1},d(e){Ie(n,e),e&&S(r),Ie(s,e)}}}function fr(e){let t,n;return t=new Bt({props:{$$slots:{default:[$r]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,r){Ce(t,e,r),n=!0},p(e,n){const r={};10&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){Ie(t,e)}}}function mr(e){let t,n;return t=new Bt({props:{$$slots:{default:[wr]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,r){Ce(t,e,r),n=!0},p(e,n){const r={};8&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){Ie(t,e)}}}function pr(e){let t,n;return{c(){t=O("Erreur lors de la récupération des similarités : "),n=O(e[1])},m(e,r){E(e,t,r),E(e,n,r)},p(e,t){2&t&&q(n,e[1])},d(e){e&&S(t),e&&S(n)}}}function hr(e){let t,n;return{c(){t=O("Error when retrieving similarities: "),n=O(e[1])},m(e,r){E(e,t,r),E(e,n,r)},p(e,t){2&t&&q(n,e[1])},d(e){e&&S(t),e&&S(n)}}}function $r(e){let t;let n=("en"===je?hr:pr)(e);return{c(){t=L("tr"),n.c(),M(t,"class","faded is-center")},m(e,r){E(e,t,r),n.m(t,null)},p(e,t){n.p(e,t)},d(e){e&&S(t),n.d()}}}function wr(t){let n;return{c(){n=L("tr"),n.textContent=""+("en"===je?"Retrieving similarities...":"Récupération des similarités..."),M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function vr(e){let t,n,r=ze.includes("similarity"),s=r&&function(e){let t,n,r,s,o,i;t=new dr({});const c=[mr,fr,gr],l=[];function a(e,t){return e[0]?0:e[1]?1:2}return r=a(e),s=l[r]=c[r](e),{c(){xe(t.$$.fragment),n=T(),s.c(),o=_()},m(e,s){Ce(t,e,s),E(e,n,s),l[r].m(e,s),E(e,o,s),i=!0},p(e,t){let n=r;r=a(e),r===n?l[r].p(e,t):(fe(),he(l[n],1,1,(()=>{l[n]=null})),me(),s=l[r],s?s.p(e,t):(s=l[r]=c[r](e),s.c()),pe(s,1),s.m(o.parentNode,o))},i(e){i||(pe(t.$$.fragment,e),pe(s),i=!0)},o(e){he(t.$$.fragment,e),he(s),i=!1},d(e){Ie(t,e),e&&S(n),l[r].d(e),e&&S(o)}}}(e);return{c(){s&&s.c(),t=_()},m(e,r){s&&s.m(e,r),E(e,t,r),n=!0},p(e,[t]){r&&s.p(e,t)},i(e){n||(pe(s),n=!0)},o(e){he(s),n=!1},d(e){s&&s.d(e),e&&S(t)}}}function br(e,t,n){let r,s;d(e,De,(e=>n(0,r=e))),d(e,Je,(e=>n(1,s=e)));const{fetchSimilarity:o}=Ht;return G((()=>{ze.includes("similarity")&&o()})),[r,s]}class yr extends Pe{constructor(e){super(),Se(this,e,br,vr,i,{})}}function kr(e){let t,n,r,s,o,i,c,a,u,d,f,$,w,v,b,y,k,C;const I=e[4].default,P=g(I,e,e[3],null);return{c(){t=L("tr"),n=L("th"),r=L("div"),s=L("img"),c=T(),a=L("div"),u=L("a"),d=L("i"),f=O("\n                    Page "),$=O(e[0]),v=T(),b=L("td"),y=L("div"),k=L("div"),P&&P.c(),l(s.src,o=We(e[1],"full","250,"))||M(s,"src",o),M(s,"alt",i="Canvas "+e[0]),M(s,"class","mb-3 card"),M(d,"class","fa-solid fa-pen-to-square"),M(u,"class","tag px-2 py-1 is-rounded is-hoverable"),M(u,"href",w=Ke(e[2],e[0])),M(u,"target","_blank"),M(a,"class","is-center mb-1"),M(r,"class","content-wrapper py-5"),M(n,"class","is-3 center-flex is-narrow"),z(n,"width","260px"),M(k,"class","grid is-gap-2"),M(y,"class","fixed-grid has-6-cols"),M(b,"class","p-5 is-fullwidth")},m(e,o){E(e,t,o),x(t,n),x(n,r),x(r,s),x(r,c),x(r,a),x(a,u),x(u,d),x(u,f),x(u,$),x(t,v),x(t,b),x(b,y),x(y,k),P&&P.m(k,null),C=!0},p(e,[t]){(!C||2&t&&!l(s.src,o=We(e[1],"full","250,")))&&M(s,"src",o),(!C||1&t&&i!==(i="Canvas "+e[0]))&&M(s,"alt",i),(!C||1&t)&&q($,e[0]),(!C||1&t&&w!==(w=Ke(e[2],e[0])))&&M(u,"href",w),P&&P.p&&(!C||8&t)&&p(P,I,e,e[3],C?m(I,e[3],t,null):h(e[3]),null)},i(e){C||(pe(P,e),C=!0)},o(e){he(P,e),C=!1},d(e){e&&S(t),P&&P.d(e)}}}function xr(e,t,n){let{$$slots:r={},$$scope:s}=t,{canvasNb:o}=t,{canvasImg:i}=t;const c=W("manifest");return e.$$set=e=>{"canvasNb"in e&&n(0,o=e.canvasNb),"canvasImg"in e&&n(1,i=e.canvasImg),"$$scope"in e&&n(3,s=e.$$scope)},[o,i,c,s,r]}class Cr extends Pe{constructor(e){super(),Se(this,e,xr,kr,i,{canvasNb:0,canvasImg:1})}}function Ir(e,t,n){const r=e.slice();return r[9]=t[n][0],r[10]=t[n][1],r}function Er(e,t,n){const r=e.slice();return r[13]=t[n],r}function Sr(t){let n,r,s="en"===je?`Error when retrieving paginated regions: ${t[16]}`:`Erreur de récupération des pages : ${t[16]}`;return{c(){n=L("tr"),r=O(s),M(n,"class","faded is-center")},m(e,t){E(e,n,t),x(n,r)},p(e,t){1&t&&s!==(s="en"===je?`Error when retrieving paginated regions: ${e[16]}`:`Erreur de récupération des pages : ${e[16]}`)&&q(r,s)},i:e,o:e,d(e){e&&S(n)}}}function Pr(e){let t,n,r,s,o;const i=[Rr,Lr],c=[];function l(e,n){return 2&n&&(t=null),null==t&&(t=!!(Object.values(e[1]).length>0)),t?0:1}return n=l(e,-1),r=c[n]=i[n](e),{c(){r.c(),s=_()},m(e,t){c[n].m(e,t),E(e,s,t),o=!0},p(e,t){let o=n;n=l(e,t),n===o?c[n].p(e,t):(fe(),he(c[o],1,1,(()=>{c[o]=null})),me(),r=c[n],r?r.p(e,t):(r=c[n]=i[n](e),r.c()),pe(r,1),r.m(s.parentNode,s))},i(e){o||(pe(r),o=!0)},o(e){he(r),o=!1},d(e){c[n].d(e),e&&S(s)}}}function Lr(t){let n,r,s;return r=new kt({}),{c(){n=L("tr"),xe(r.$$.fragment)},m(e,t){E(e,n,t),Ce(r,n,null),s=!0},p:e,i(e){s||(pe(r.$$.fragment,e),s=!0)},o(e){he(r.$$.fragment,e),s=!1},d(e){e&&S(n),Ie(r)}}}function Rr(e){let t,n,r=Object.entries(e[1]),s=[];for(let t=0;t<r.length;t+=1)s[t]=_r(Ir(e,r,t));const o=e=>he(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=_()},m(e,r){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(e,r);E(e,t,r),n=!0},p(e,n){if(34&n){let i;for(r=Object.entries(e[1]),i=0;i<r.length;i+=1){const o=Ir(e,r,i);s[i]?(s[i].p(o,n),pe(s[i],1)):(s[i]=_r(o),s[i].c(),pe(s[i],1),s[i].m(t.parentNode,t))}for(fe(),i=r.length;i<s.length;i+=1)o(i);me()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)pe(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)he(s[e]);n=!1},d(e){P(s,e),e&&S(t)}}}function Or(e,t){let n,r,s;return r=new mt({props:{item:t[13],isSquare:!1}}),{key:e,first:null,c(){n=_(),xe(r.$$.fragment),this.first=n},m(e,t){E(e,n,t),Ce(r,e,t),s=!0},p(e,n){t=e;const s={};2&n&&(s.item=t[13]),r.$set(s)},i(e){s||(pe(r.$$.fragment,e),s=!0)},o(e){he(r.$$.fragment,e),s=!1},d(e){e&&S(n),Ie(r,e)}}}function Tr(e){let t,n,r=[],s=new Map,o=Object.values(e[10]);const i=e=>e[13].id;for(let t=0;t<o.length;t+=1){let n=Er(e,o,t),c=i(n);s.set(c,r[t]=Or(c,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=T()},m(e,s){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,s);E(e,t,s),n=!0},p(e,n){2&n&&(o=Object.values(e[10]),fe(),r=ke(r,n,i,1,e,o,s,t.parentNode,ye,Or,t,Er),me())},i(e){if(!n){for(let e=0;e<o.length;e+=1)pe(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)he(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t)}}}function _r(e){let t,n;return t=new Cr({props:{canvasImg:e[5](e[9]),canvasNb:e[9],$$slots:{default:[Tr]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment)},m(e,r){Ce(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.canvasImg=e[5](e[9])),2&n&&(r.canvasNb=e[9]),131074&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){he(t.$$.fragment,e),n=!1},d(e){Ie(t,e)}}}function Nr(t){let n;return{c(){n=L("tr"),n.textContent=""+("en"===je?"Retrieving paginated regions...":"Récupération des pages..."),M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function jr(e){let t,n,r,s={ctx:e,current:null,token:null,hasCatch:!0,pending:Nr,then:Pr,catch:Sr,value:8,error:16,blocks:[,,,]};return ve(n=e[0],s),{c(){t=_(),s.block.c()},m(e,n){E(e,t,n),s.block.m(e,s.anchor=n),s.mount=()=>t.parentNode,s.anchor=t,r=!0},p(t,r){e=t,s.ctx=e,1&r&&n!==(n=e[0])&&ve(n,s)||be(s,e,r)},i(e){r||(pe(s.block),r=!0)},o(e){for(let e=0;e<3;e+=1){he(s.blocks[e])}r=!1},d(e){e&&S(t),s.block.d(e),s.token=null,s=null}}}function Mr(e){let t,n,r,s,o,i;return t=new en({props:{store:nt,nbOfItems:e[4]}}),r=new Bt({props:{$$slots:{default:[jr]},$$scope:{ctx:e}}}),o=new en({props:{store:nt,nbOfItems:e[4]}}),{c(){xe(t.$$.fragment),n=T(),xe(r.$$.fragment),s=T(),xe(o.$$.fragment)},m(e,c){Ce(t,e,c),E(e,n,c),Ce(r,e,c),E(e,s,c),Ce(o,e,c),i=!0},p(e,[t]){const n={};131075&t&&(n.$$scope={dirty:t,ctx:e}),r.$set(n)},i(e){i||(pe(t.$$.fragment,e),pe(r.$$.fragment,e),pe(o.$$.fragment,e),i=!0)},o(e){he(t.$$.fragment,e),he(r.$$.fragment,e),he(o.$$.fragment,e),i=!1},d(e){Ie(t,e),e&&S(n),Ie(r,e),e&&S(s),Ie(o,e)}}}function qr(e,t,n){let r,s;const{pageRegions:o,fetchPages:i}=nt;d(e,o,(e=>n(1,s=e))),d(e,i,(e=>n(0,r=e)));const c=W("nbOfPages"),l=W("trailingZeros");return[r,s,o,i,c,function(e){return`${imgPrefix}_${t=e,n=l,t.toString().padStart(n,"0")}`;var t,n}]}class Ar extends Pe{constructor(e){super(),Se(this,e,qr,Mr,i,{})}}function zr(t){let n,r,s,o,i,c,l,a="en"===je?"Save selection":"Sauvegarder la sélection";return{c(){n=L("button"),r=L("span"),s=L("i"),o=T(),i=O(a),M(s,"class","fa-solid fa-floppy-disk"),M(n,"class","button is-link")},m(e,a){E(e,n,a),x(n,r),x(r,s),x(r,o),x(r,i),c||(l=N(n,"click",t[6]),c=!0)},p:e,d(e){e&&S(n),c=!1,l()}}}function Vr(e){let t,n,r,s,o,i,c="en"===je?"Go to treatment":"Accéder au traitement";return{c(){t=L("a"),n=L("span"),r=L("i"),s=T(),o=O(c),M(r,"class","fa-solid fa-gear"),M(t,"class","button is-link"),M(t,"href",i="/"+Me+"/treatment/add/?document_set="+e[2](e[0]).id)},m(e,i){E(e,t,i),x(t,n),x(n,r),x(n,s),x(n,o)},p(e,n){5&n&&i!==(i="/"+Me+"/treatment/add/?document_set="+e[2](e[0]).id)&&M(t,"href",i)},d(e){e&&S(t)}}}function Hr(t){let n,r,s,o,i,c;function l(e,t){return e[1]?Vr:zr}let a=l(t),u=a(t);return{c(){n=L("footer"),r=L("div"),s=L("button"),s.textContent=""+("en"===je?"Clear selection":"Vider la sélection"),o=T(),u.c(),M(s,"class","button button-close is-link is-light"),M(r,"class","buttons"),M(n,"class","modal-card-foot is-center")},m(e,l){E(e,n,l),x(n,r),x(r,s),x(r,o),u.m(r,null),i||(c=N(s,"click",t[5]),i=!0)},p(e,[t]){a===(a=l(e))&&u?u.p(e,t):(u.d(1),u=a(e),u&&(u.c(),u.m(r,null)))},i:e,o:e,d(e){e&&S(n),u.d(),i=!1,c()}}}function Ur(e,t,n){let r,s;const{isSaved:o,selection:i}=tt;d(e,o,(e=>n(1,r=e))),d(e,i,(e=>n(2,s=e)));let{isRegion:c=!0}=t;return e.$$set=e=>{"isRegion"in e&&n(0,c=e.isRegion)},[c,r,s,o,i,()=>tt.empty(c),()=>tt.save(c)]}class Fr extends Pe{constructor(e){super(),Se(this,e,Ur,Hr,i,{isRegion:0})}}function Br(e){let t,n,r,o,i,c,l=e[5](e[0])+"";return{c(){t=L("span"),n=O(l),r=T(),o=L("span"),o.innerHTML='<i class="fas fa-edit"></i>',M(o,"class","pl-3 smaller has-text-link")},m(s,l){E(s,t,l),x(t,n),x(t,r),x(t,o),i||(c=[N(t,"click",e[7]),N(t,"keyup",null)],i=!0)},p(e,t){33&t&&l!==(l=e[5](e[0])+"")&&q(n,l)},d(e){e&&S(t),i=!1,s(c)}}}function Dr(e){let t,n,r;return{c(){t=L("input"),M(t,"class","input selection-title svelte-sgypdx")},m(s,o){E(s,t,o),e[12](t),A(t,e[4]),n||(r=[N(t,"input",e[13]),N(t,"keydown",e[8]),N(t,"blur",e[9])],n=!0)},p(e,n){16&n&&t.value!==e[4]&&A(t,e[4])},d(o){o&&S(t),e[12](null),n=!1,s(r)}}}function Jr(e){let t,n,r,s,o,i,c,l,a,u,d,f,$,w,v,b,y,k;function C(e,t){return e[2]?Dr:Br}let I=C(e),P=I(e);const R=e[11].default,_=g(R,e,e[10],null);return y=new Fr({props:{isRegion:e[0]}}),{c(){t=L("div"),n=L("div"),r=T(),s=L("div"),o=L("div"),i=L("div"),c=L("i"),l=T(),P.c(),a=O("\n                ("),u=O(e[1]),d=O(")"),f=T(),$=L("button"),w=T(),v=L("section"),_&&_.c(),b=T(),xe(y.$$.fragment),M(n,"class","modal-background"),M(c,"class","fa-solid fa-book-bookmark"),M(i,"class","title is-4 mb-0 media-content"),M($,"class","delete media-left"),M($,"aria-label","close"),M(o,"class","modal-card-head media mb-0 is-middle"),M(v,"class","modal-card-body"),M(s,"class","modal-content"),M(t,"id","selection-modal"),M(t,"class","modal fade"),M(t,"tabindex","-1"),M(t,"aria-labelledby","selection-modal-label"),M(t,"aria-hidden","true")},m(e,g){E(e,t,g),x(t,n),x(t,r),x(t,s),x(s,o),x(o,i),x(i,c),x(i,l),P.m(i,null),x(i,a),x(i,u),x(i,d),x(o,f),x(o,$),x(s,w),x(s,v),_&&_.m(v,null),x(s,b),Ce(y,s,null),k=!0},p(e,[t]){I===(I=C(e))&&P?P.p(e,t):(P.d(1),P=I(e),P&&(P.c(),P.m(i,a))),(!k||2&t)&&q(u,e[1]),_&&_.p&&(!k||1024&t)&&p(_,R,e,e[10],k?m(R,e[10],t,null):h(e[10]),null);const n={};1&t&&(n.isRegion=e[0]),y.$set(n)},i(e){k||(pe(_,e),pe(y.$$.fragment,e),k=!0)},o(e){he(_,e),he(y.$$.fragment,e),k=!1},d(e){e&&S(t),P.d(),_&&_.d(e),Ie(y)}}}function Xr(e,t,n){let r,{$$slots:s={},$$scope:o}=t;const{selectionTitle:i,updateTitle:c,save:l}=tt;d(e,i,(e=>n(5,r=e)));let a,u,{isRegion:g=!1}=t,{selectionLength:f=!1}=t,m=!1;function p(){n(2,m=!1),c(u,g),l(g)}return e.$$set=e=>{"isRegion"in e&&n(0,g=e.isRegion),"selectionLength"in e&&n(1,f=e.selectionLength),"$$scope"in e&&n(10,o=e.$$scope)},[g,f,m,a,u,r,i,function(){n(2,m=!0),n(4,u=r(g)),setTimeout((()=>a&&a.focus()),0)},function(e){"Enter"===e.key&&p()},p,o,s,function(e){Y[e?"unshift":"push"]((()=>{a=e,n(3,a)}))},function(){u=this.value,n(4,u)}]}class Zr extends Pe{constructor(e){super(),Se(this,e,Xr,Jr,i,{isRegion:0,selectionLength:1})}}const Gr=function(){const e=`${window.location.origin}${window.location.pathname}`,t=_e(1),n=_e([]),r=_e([]),s=(async()=>{const t=await fetch(`${e}vectorized-images`).then((e=>e.json())).then((e=>(n.set(e),e))).catch((e=>console.error("Error:",e)));return c(o()),t})(),o=()=>Ge(t,"vp"),i=Ne(t,(e=>(async()=>function(e){const t=49*(e-1),s=t+49,o=u(n).slice(t,s);return r.set(o),o}(e))()));function c(e){Qe(e,t,"vp")}return{currentPage:t,pageLength:49,vectImgs:n,fetchVectorization:s,setPageVectImgs:i,pageVectImgs:r,handlePageUpdate:c}}();function Qr(e){let t,n;return{c(){t=new H(!1),n=_(),t.a=n},m(r,s){t.m(e[2],r,s),E(r,n,s)},p(e,n){4&n&&t.p(e[2])},d(e){e&&S(n),e&&t.d()}}}function Wr(e){let t,n,r,o,i,c,a,u,d,g,f=!e[1]&&e[2]&&Qr(e);return{c(){t=L("div"),n=L("figure"),r=L("div"),f&&f.c(),o=T(),i=L("img"),M(r,"class","svg-container svelte-1egync3"),l(i.src,c=e[4])||M(i,"src",c),M(i,"alt","Extracted region"),M(i,"class","svelte-1egync3"),M(n,"class","image card region-image svelte-1egync3"),z(n,"width",e[0]+"px"),z(n,"aspect-ratio",e[3]?e[3].split(" ")[2]/e[3].split(" ")[3]:1),M(t,"class","svg-regions is-center svelte-1egync3")},m(s,c){E(s,t,c),x(t,n),x(n,r),f&&f.m(r,null),x(n,o),x(n,i),u=!0,d||(g=[N(t,"mouseenter",e[6]),N(t,"mouseleave",e[7])],d=!0)},p(e,[t]){!e[1]&&e[2]?f?f.p(e,t):(f=Qr(e),f.c(),f.m(r,null)):f&&(f.d(1),f=null),(!u||1&t)&&z(n,"width",e[0]+"px"),(!u||8&t)&&z(n,"aspect-ratio",e[3]?e[3].split(" ")[2]/e[3].split(" ")[3]:1)},i(e){u||(se((()=>{u&&(a||(a=we(t,Re,{duration:500},!0)),a.run(1))})),u=!0)},o(e){a||(a=we(t,Re,{duration:500},!1)),a.run(0),u=!1},d(e){e&&S(t),f&&f.d(),e&&a&&a.end(),d=!1,s(g)}}}function Kr(e,t,n){let{svgPath:r}=t,{width:s=200}=t;const[o,i,c,l]=r.replace(".svg","").split("_"),a=We(`${o}_${i}_${c}`,l,`${s},`);let u=!1,d="",g="";G((async()=>{const e=await fetch(`${Fe}svg/${r}`),t=await e.text(),s=(new DOMParser).parseFromString(t,"image/svg+xml"),o=s.querySelector("svg");n(3,g=o.getAttribute("viewBox")||`0 0 ${o.getAttribute("width")} ${o.getAttribute("height")}`),s.querySelectorAll("image").forEach((e=>e.remove())),o.setAttribute("viewBox",g),o.removeAttribute("width"),o.removeAttribute("height"),n(2,d=(new XMLSerializer).serializeToString(s.documentElement))}));return e.$$set=e=>{"svgPath"in e&&n(5,r=e.svgPath),"width"in e&&n(0,s=e.width)},[s,u,d,g,a,r,()=>n(1,u=!0),()=>n(1,u=!1)]}class Yr extends Pe{constructor(e){super(),Se(this,e,Kr,Wr,i,{svgPath:5,width:0})}}function es(t){let n,r,s,o,i,c,l,a="en"===je?"Download All":"Tout Télécharger";return{c(){n=L("div"),r=L("button"),s=L("i"),o=T(),i=O(a),M(s,"class","fa-solid fa-download"),M(r,"class","button is-link is-light"),M(n,"class","is-right mb-3")},m(e,a){E(e,n,a),x(n,r),x(r,s),x(r,o),x(r,i),c||(l=N(r,"click",t[0]),c=!0)},p:e,i:e,o:e,d(e){e&&S(n),c=!1,l()}}}function ts(e){const t=`${window.location.origin}${window.location.pathname}`,n=parseInt(t.split("witness/")[1].replace("/","")),r=parseInt(t.split("regions/")[1].replace("/",""));return[async function(){if(!r&&!n)return void console.error("No Region or Witness");const e=r?`${window.location.origin}/${Me}/export-regions-imgs-and-svgs/${r}`:`${window.location.origin}/${Me}/export-all-imgs-and-svgs/${n}`;try{const t=await Xe((()=>fetch(e,{method:"GET",headers:{"X-CSRFToken":Ae,"Content-Type":"application/json"}})));if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);et(await t.blob(),"vectorizations.zip")}catch(e){console.error("Erreur lors du téléchargement des vectorisations:",e)}}]}class ns extends Pe{constructor(e){super(),Se(this,e,ts,es,i,{})}}function rs(e,t,n){const r=e.slice();return r[8]=t[n],r}function ss(t){let n;let r=("en"===je?is:os)(t);return{c(){n=L("div"),r.c(),M(n,"class","faded is-center")},m(e,t){E(e,n,t),r.m(n,null)},p(e,t){r.p(e,t)},i:e,o:e,d(e){e&&S(n),r.d()}}}function os(e){let t,n,r=e[11]+"";return{c(){t=O("Erreur lors de la récupération des régions vectorisées : "),n=O(r)},m(e,r){E(e,t,r),E(e,n,r)},p(e,t){2&t&&r!==(r=e[11]+"")&&q(n,r)},d(e){e&&S(t),e&&S(n)}}}function is(e){let t,n,r=e[11]+"";return{c(){t=O("Error when retrieving vectorized regions: "),n=O(r)},m(e,r){E(e,t,r),E(e,n,r)},p(e,t){2&t&&r!==(r=e[11]+"")&&q(n,r)},d(e){e&&S(t),e&&S(n)}}}function cs(e){let t,n,r=[],s=new Map,o=e[2];const i=e=>e[8].id;for(let t=0;t<o.length;t+=1){let n=rs(e,o,t),c=i(n);s.set(c,r[t]=as(c,n))}let c=null;return o.length||(c=ls()),{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=_(),c&&c.c()},m(e,s){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,s);E(e,t,s),c&&c.m(e,s),n=!0},p(e,n){4&n&&(o=e[2],fe(),r=ke(r,n,i,1,e,o,s,t.parentNode,ye,as,t,rs),me(),!o.length&&c?c.p(e,n):o.length?c&&(c.d(1),c=null):(c=ls(),c.c(),c.m(t.parentNode,t)))},i(e){if(!n){for(let e=0;e<o.length;e+=1)pe(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)he(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t),c&&c.d(e)}}}function ls(t){let n,r;return{c(){n=L("div"),n.textContent=""+("en"===je?"No vectorization":"Pas de vectorisation"),r=T(),M(n,"class","faded is-center")},m(e,t){E(e,n,t),E(e,r,t)},p:e,d(e){e&&S(n),e&&S(r)}}}function as(e,t){let n,r,s;return r=new Yr({props:{svgPath:t[8]}}),{key:e,first:null,c(){n=_(),xe(r.$$.fragment),this.first=n},m(e,t){E(e,n,t),Ce(r,e,t),s=!0},p(e,n){t=e;const s={};4&n&&(s.svgPath=t[8]),r.$set(s)},i(e){s||(pe(r.$$.fragment,e),s=!0)},o(e){he(r.$$.fragment,e),s=!1},d(e){e&&S(n),Ie(r,e)}}}function us(t){let n;return{c(){n=L("div"),n.textContent=""+("en"===je?"Retrieving vectorization page...":"Récupération la page de vectorisation..."),M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function ds(e){let t,n,r,s,o,i,c,l,a;t=new ns({}),r=new en({props:{store:Gr,nbOfItems:e[0].length,pageLength:e[6]}});let u={ctx:e,current:null,token:null,hasCatch:!0,pending:us,then:cs,catch:ss,value:7,error:11,blocks:[,,,]};return ve(i=e[1],u),l=new en({props:{store:Gr,nbOfItems:e[0].length,pageLength:e[6]}}),{c(){xe(t.$$.fragment),n=T(),xe(r.$$.fragment),s=T(),o=L("div"),u.block.c(),c=T(),xe(l.$$.fragment),M(o,"class","grid is-gap-2 mx-5 svelte-1mje9rl")},m(e,i){Ce(t,e,i),E(e,n,i),Ce(r,e,i),E(e,s,i),E(e,o,i),u.block.m(o,u.anchor=null),u.mount=()=>o,u.anchor=null,E(e,c,i),Ce(l,e,i),a=!0},p(t,[n]){e=t;const s={};1&n&&(s.nbOfItems=e[0].length),r.$set(s),u.ctx=e,2&n&&i!==(i=e[1])&&ve(i,u)||be(u,e,n);const o={};1&n&&(o.nbOfItems=e[0].length),l.$set(o)},i(e){a||(pe(t.$$.fragment,e),pe(r.$$.fragment,e),pe(u.block),pe(l.$$.fragment,e),a=!0)},o(e){he(t.$$.fragment,e),he(r.$$.fragment,e);for(let e=0;e<3;e+=1){he(u.blocks[e])}he(l.$$.fragment,e),a=!1},d(e){Ie(t,e),e&&S(n),Ie(r,e),e&&S(s),e&&S(o),u.block.d(),u.token=null,u=null,e&&S(c),Ie(l,e)}}}function gs(e,t,n){let r,s,o;const{vectImgs:i,pageVectImgs:c,setPageVectImgs:l,pageLength:a}=Gr;return d(e,i,(e=>n(0,r=e))),d(e,c,(e=>n(2,o=e))),d(e,l,(e=>n(1,s=e))),[r,s,o,i,c,l,a]}class fs extends Pe{constructor(e){super(),Se(this,e,gs,ds,i,{})}}function ms(t){let n;let r=("en"===je?hs:ps)(t);return{c(){n=L("div"),r.c(),M(n,"class","container faded is-center")},m(e,t){E(e,n,t),r.m(n,null)},p(e,t){r.p(e,t)},i:e,o:e,d(e){e&&S(n),r.d()}}}function ps(t){let n,r,s=t[2]+"";return{c(){n=O("Erreur lors de la récupération des régions vectorisées : "),r=O(s)},m(e,t){E(e,n,t),E(e,r,t)},p:e,d(e){e&&S(n),e&&S(r)}}}function hs(t){let n,r,s=t[2]+"";return{c(){n=O("Error when retrieving vectorized regions: "),r=O(s)},m(e,t){E(e,n,t),E(e,r,t)},p:e,d(e){e&&S(n),e&&S(r)}}}function $s(t){let n,r;return n=new fs({}),{c(){xe(n.$$.fragment)},m(e,t){Ce(n,e,t),r=!0},p:e,i(e){r||(pe(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){Ie(n,e)}}}function ws(t){let n;return{c(){n=L("div"),n.textContent=""+("en"===je?"Retrieving vectorized regions...":"Récupération des régions vectorisées..."),M(n,"class","container faded is-center")},m(e,t){E(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function vs(e){let t,n,r=ze.includes("vectorization"),s=r&&function(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:ws,then:$s,catch:ms,value:1,error:2,blocks:[,,,]};return ve(e[0],r),{c(){t=_(),r.block.c()},m(e,s){E(e,t,s),r.block.m(e,r.anchor=s),r.mount=()=>t.parentNode,r.anchor=t,n=!0},p(t,n){be(r,e=t,n)},i(e){n||(pe(r.block),n=!0)},o(e){for(let e=0;e<3;e+=1)he(r.blocks[e]);n=!1},d(e){e&&S(t),r.block.d(e),r.token=null,r=null}}}(e);return{c(){s&&s.c(),t=_()},m(e,r){s&&s.m(e,r),E(e,t,r),n=!0},p(e,[t]){r&&s.p(e,t)},i(e){n||(pe(s),n=!0)},o(e){he(s),n=!1},d(e){s&&s.d(e),e&&S(t)}}}function bs(e){const{fetchVectorization:t}=Gr;return[t]}class ys extends Pe{constructor(e){super(),Se(this,e,bs,vs,i,{})}}function ks(e,t,n){const r=e.slice();return r[22]=t[n][0],r[23]=t[n][1],r}function xs(e,t,n){const r=e.slice();return r[27]=t[n],r}function Cs(e,t,n){const r=e.slice();return r[31]=t[n][0],r[23]=t[n][1],r}function Is(e){let t,n,r,s;return n=new Vt({}),{c(){t=L("div"),xe(n.$$.fragment),M(t,"class","cell")},m(e,r){E(e,t,r),Ce(n,t,null),s=!0},i(e){s||(pe(n.$$.fragment,e),se((()=>{s&&(r||(r=we(t,Re,{duration:500},!0)),r.run(1))})),s=!0)},o(e){he(n.$$.fragment,e),r||(r=we(t,Re,{duration:500},!1)),r.run(0),s=!1},d(e){e&&S(t),Ie(n),e&&r&&r.end()}}}function Es(e){let t,n,r,o,i,c,l=e[23].text+"";function a(){return e[20](e[31])}return{c(){t=L("li"),n=L("a"),r=O(l),o=T(),M(n,"href",null),V(t,"is-active",e[31]===e[3])},m(e,s){E(e,t,s),x(t,n),x(n,r),x(t,o),i||(c=[N(t,"click",a),N(t,"keyup",Hs)],i=!0)},p(n,s){e=n,4&s[0]&&l!==(l=e[23].text+"")&&q(r,l),12&s[0]&&V(t,"is-active",e[31]===e[3])},d(e){e&&S(t),i=!1,s(c)}}}function Ss(t){let n,r;return n=new ys({}),{c(){xe(n.$$.fragment)},m(e,t){Ce(n,e,t),r=!0},p:e,i(e){r||(pe(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){Ie(n,e)}}}function Ps(t){let n,r;return n=new yr({}),{c(){xe(n.$$.fragment)},m(e,t){Ce(n,e,t),r=!0},p:e,i(e){r||(pe(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){Ie(n,e)}}}function Ls(t){let n,r;return n=new Ar({}),{c(){xe(n.$$.fragment)},m(e,t){Ce(n,e,t),r=!0},p:e,i(e){r||(pe(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){Ie(n,e)}}}function Rs(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:js,then:Ts,catch:Os,value:26,error:30,blocks:[,,,]};return ve(e[9],r),{c(){t=L("div"),r.block.c(),M(t,"class","grid is-gap-2")},m(e,s){E(e,t,s),r.block.m(t,r.anchor=null),r.mount=()=>t,r.anchor=null,n=!0},p(t,n){be(r,e=t,n)},i(e){n||(pe(r.block),n=!0)},o(e){for(let e=0;e<3;e+=1){he(r.blocks[e])}n=!1},d(e){e&&S(t),r.block.d(),r.token=null,r=null}}}function Os(t){let n,r,s,o=t[30]+"";return{c(){n=L("div"),r=O("Error when retrieving regions: "),s=O(o)},m(e,t){E(e,n,t),x(n,r),x(n,s)},p:e,i:e,o:e,d(e){e&&S(n)}}}function Ts(e){let t,n,r=[],s=new Map,o=Object.values(e[6]);const i=e=>e[27].id;for(let t=0;t<o.length;t+=1){let n=xs(e,o,t),c=i(n);s.set(c,r[t]=Ns(c,n))}let c=null;return o.length||(c=_s(e)),{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=_(),c&&c.c()},m(e,s){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,s);E(e,t,s),c&&c.m(e,s),n=!0},p(e,n){3136&n[0]&&(o=Object.values(e[6]),fe(),r=ke(r,n,i,1,e,o,s,t.parentNode,ye,Ns,t,xs),me(),!o.length&&c?c.p(e,n):o.length?c&&(fe(),he(c,1,1,(()=>{c=null})),me()):(c=_s(e),c.c(),pe(c,1),c.m(t.parentNode,t)))},i(e){if(!n){for(let e=0;e<o.length;e+=1)pe(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)he(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t),c&&c.d(e)}}}function _s(t){let n,r;return n=new kt({props:{currentRegionId:t[11],baseUrl:t[10]}}),{c(){xe(n.$$.fragment)},m(e,t){Ce(n,e,t),r=!0},p:e,i(e){r||(pe(n.$$.fragment,e),r=!0)},o(e){he(n.$$.fragment,e),r=!1},d(e){Ie(n,e)}}}function Ns(e,t){let n,r,s;return r=new mt({props:{item:t[27]}}),{key:e,first:null,c(){n=_(),xe(r.$$.fragment),this.first=n},m(e,t){E(e,n,t),Ce(r,e,t),s=!0},p(e,n){t=e;const s={};64&n[0]&&(s.item=t[27]),r.$set(s)},i(e){s||(pe(r.$$.fragment,e),s=!0)},o(e){he(r.$$.fragment,e),s=!1},d(e){e&&S(n),Ie(r,e)}}}function js(t){let n;return{c(){n=L("div"),n.textContent=""+("en"===je?"Retrieving regions...":"Récupération des régions..."),M(n,"class","faded is-center")},m(e,t){E(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function Ms(t){let n;return{c(){n=L("div"),n.textContent=""+("en"===je?"No regions in selection":"Aucune région sélectionnée")},m(e,t){E(e,n,t)},p:e,d(e){e&&S(n)}}}function qs(e){let t,n,r=Object.entries(e[1]),s=[];for(let t=0;t<r.length;t+=1)s[t]=As(ks(e,r,t));return{c(){t=L("div"),n=L("div");for(let e=0;e<s.length;e+=1)s[e].c();M(n,"class","grid is-gap-2"),M(t,"class","fixed-grid has-6-cols")},m(e,r){E(e,t,r),x(t,n);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null)},p(e,t){if(2&t[0]){let o;for(r=Object.entries(e[1]),o=0;o<r.length;o+=1){const i=ks(e,r,o);s[o]?s[o].p(i,t):(s[o]=As(i),s[o].c(),s[o].m(n,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=r.length}},d(e){e&&S(t),P(s,e)}}}function As(e){let t,n,r,s,o,i,c,a,u,d,g,f,m,p=e[23].title+"";function h(){return e[21](e[22])}return{c(){t=L("div"),n=L("figure"),r=L("img"),o=T(),i=L("div"),c=L("span"),a=O(p),u=T(),d=L("button"),g=T(),l(r.src,s=We(e[23].img,e[23].xyhw,"96,"))||M(r,"src",s),M(r,"alt","Extracted region"),M(c,"class","overlay-desc"),M(i,"class","overlay is-center svelte-403wty"),M(n,"class","image is-64x64 card"),M(d,"class","delete region-btn"),M(d,"aria-label","remove from selection"),M(t,"class","selection cell svelte-403wty")},m(e,s){E(e,t,s),x(t,n),x(n,r),x(n,o),x(n,i),x(i,c),x(c,a),x(t,u),x(t,d),x(t,g),f||(m=N(d,"click",h),f=!0)},p(t,n){e=t,2&n[0]&&!l(r.src,s=We(e[23].img,e[23].xyhw,"96,"))&&M(r,"src",s),2&n[0]&&p!==(p=e[23].title+"")&&q(a,p)},d(e){e&&S(t),f=!1,m()}}}function zs(e){let t;function n(e,t){return e[4]?qs:Ms}let r=n(e),s=r(e);return{c(){s.c(),t=_()},m(e,n){s.m(e,n),E(e,t,n)},p(e,o){r===(r=n(e))&&s?s.p(e,o):(s.d(1),s=r(e),s&&(s.c(),s.m(t.parentNode,t)))},d(e){s.d(e),e&&S(t)}}}function Vs(e){let t,n,r,s,o,i,c,l,a,u,d,g,f,m,p,h,$,w,v,b,y=["all","page"].includes(e[3]);t=new it({props:{visible:e[5]}}),r=new vt({}),o=new $t({props:{selectionLength:e[0]}}),u=new Ot({props:{baseUrl:e[10],currentRegionId:e[11],currentLayout:e[3]}});let k=y&&Is(),C=Object.entries(e[2]),I=[];for(let t=0;t<C.length;t+=1)I[t]=Es(Cs(e,C,t));const R=[Rs,Ls,Ps,Ss],O=[];function _(e,t){return"all"===e[3]?0:"page"===e[3]?1:"similarity"===e[3]?2:"vectorization"===e[3]?3:-1}return~(h=_(e))&&($=O[h]=R[h](e)),v=new Zr({props:{isRegion:!0,selectionLength:e[0],$$slots:{default:[zs]},$$scope:{ctx:e}}}),{c(){xe(t.$$.fragment),n=T(),xe(r.$$.fragment),s=T(),xe(o.$$.fragment),i=T(),c=L("div"),l=L("div"),a=L("div"),xe(u.$$.fragment),d=T(),k&&k.c(),g=T(),f=L("div"),m=L("ul");for(let e=0;e<I.length;e+=1)I[e].c();p=T(),$&&$.c(),w=T(),xe(v.$$.fragment),M(a,"class","cell is-left is-middle"),M(l,"class","actions grid"),M(m,"class","panel-tabs"),M(f,"class","tabs is-centered"),M(c,"id","nav-actions"),M(c,"class","mb-5 svelte-403wty")},m(e,$){Ce(t,e,$),E(e,n,$),Ce(r,e,$),E(e,s,$),Ce(o,e,$),E(e,i,$),E(e,c,$),x(c,l),x(l,a),Ce(u,a,null),x(l,d),k&&k.m(l,null),x(c,g),x(c,f),x(f,m);for(let e=0;e<I.length;e+=1)I[e]&&I[e].m(m,null);E(e,p,$),~h&&O[h].m(e,$),E(e,w,$),Ce(v,e,$),b=!0},p(e,n){const r={};32&n[0]&&(r.visible=e[5]),t.$set(r);const s={};1&n[0]&&(s.selectionLength=e[0]),o.$set(s);const i={};if(8&n[0]&&(i.currentLayout=e[3]),u.$set(i),8&n[0]&&(y=["all","page"].includes(e[3])),y?k?8&n[0]&&pe(k,1):(k=Is(),k.c(),pe(k,1),k.m(l,null)):k&&(fe(),he(k,1,1,(()=>{k=null})),me()),4108&n[0]){let t;for(C=Object.entries(e[2]),t=0;t<C.length;t+=1){const r=Cs(e,C,t);I[t]?I[t].p(r,n):(I[t]=Es(r),I[t].c(),I[t].m(m,null))}for(;t<I.length;t+=1)I[t].d(1);I.length=C.length}let c=h;h=_(e),h===c?~h&&O[h].p(e,n):($&&(fe(),he(O[c],1,1,(()=>{O[c]=null})),me()),~h?($=O[h],$?$.p(e,n):($=O[h]=R[h](e),$.c()),pe($,1),$.m(w.parentNode,w)):$=null);const a={};1&n[0]&&(a.selectionLength=e[0]),18&n[0]|8&n[1]&&(a.$$scope={dirty:n,ctx:e}),v.$set(a)},i(e){b||(pe(t.$$.fragment,e),pe(r.$$.fragment,e),pe(o.$$.fragment,e),pe(u.$$.fragment,e),pe(k),pe($),pe(v.$$.fragment,e),b=!0)},o(e){he(t.$$.fragment,e),he(r.$$.fragment,e),he(o.$$.fragment,e),he(u.$$.fragment,e),he(k),he($),he(v.$$.fragment,e),b=!1},d(e){Ie(t,e),e&&S(n),Ie(r,e),e&&S(s),Ie(o,e),e&&S(i),e&&S(c),Ie(u),k&&k.d(),P(I,e),e&&S(p),~h&&O[h].d(e),e&&S(w),Ie(v,e)}}}const Hs=()=>null;function Us(e,t,n){let r,s,o,i,c,l,a;d(e,De,(e=>n(5,l=e)));const{selected:u}=tt;d(e,u,(e=>n(19,c=e)));const{allRegions:g,fetchAll:f}=nt;d(e,g,(e=>n(6,a=e)));let{manifest:m=""}=t,{isValidated:p=!1}=t,{imgPrefix:h=""}=t,{nbOfPages:$=1}=t,{trailingZeros:w=1}=t,{witness:v={}}=t;Q("witness",v),Q("nbOfPages",$),Q("trailingZeros",w),Q("imgPrefix",h),Q("manifest",m),Q("isValidated",p);const b=`${window.location.origin}${window.location.pathname}`,y=parseInt(b.split("regions/")[1].replace("/","")),k={all:{text:"en"===je?"All regions":"Toutes les régions"},page:{text:"en"===je?"Per page":"Par page"}};function x(e){n(3,i=e);const t=new URL(window.location);t.searchParams.set("tab",e),window.history.pushState({},"",t)}ze.includes("similarity")&&(k.similarity={text:"en"===je?"Similarity":"Similarité"}),ze.includes("vectorization")&&(k.vectorization={text:"en"===je?"Vectorization":"Vectorisation"});return e.$$set=e=>{"manifest"in e&&n(13,m=e.manifest),"isValidated"in e&&n(14,p=e.isValidated),"imgPrefix"in e&&n(15,h=e.imgPrefix),"nbOfPages"in e&&n(16,$=e.nbOfPages),"trailingZeros"in e&&n(17,w=e.trailingZeros),"witness"in e&&n(18,v=e.witness)},e.$$.update=()=>{524288&e.$$.dirty[0]&&n(1,r=c(!0)),2&e.$$.dirty[0]&&n(0,s=Object.keys(r).length),1&e.$$.dirty[0]&&n(4,o=s>0)},n(3,i=new URLSearchParams(window.location.search).get("tab")??"all"),[s,r,k,i,o,l,a,u,g,f,b,y,x,m,p,h,$,w,v,c,e=>x(e),e=>tt.remove(e,Ve)]}return new class extends Pe{constructor(e){super(),Se(this,e,Us,Vs,i,{manifest:13,isValidated:14,imgPrefix:15,nbOfPages:16,trailingZeros:17,witness:18},null,[-1,-1])}}({target:document.getElementById("region-list"),props:{witness:witness,manifest:manifest,isValidated:isValidated,imgPrefix:imgPrefix,nbOfPages:nbOfPages,trailingZeros:trailingZeros}})}();
//# sourceMappingURL=regionList.js.map
