(function(){"use strict";function ee(){}const Es=t=>t;function Cs(t,e){for(const n in e)t[n]=e[n];return t}function zc(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function Is(t){return t()}function Ms(){return Object.create(null)}function ot(t){t.forEach(Is)}function xn(t){return typeof t=="function"}function Me(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let yi;function vt(t,e){return yi||(yi=document.createElement("a")),yi.href=e,t===yi.href}function jc(t){return Object.keys(t).length===0}function bi(t,...e){if(t==null)return ee;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function lt(t){let e;return bi(t,n=>e=n)(),e}function we(t,e,n){t.$$.on_destroy.push(bi(e,n))}function Lt(t,e,n,i){if(t){const r=xs(t,e,n,i);return t[0](r)}}function xs(t,e,n,i){return t[1]&&i?Cs(n.ctx.slice(),t[1](i(e))):n.ctx}function Rt(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function Dt(t,e,n,i,r,s){if(r){const o=xs(e,n,i,s);t.p(o,r)}}function $t(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let i=0;i<n;i++)e[i]=-1;return e}return-1}function Fc(t){const e={};for(const n in t)e[n]=!0;return e}function wi(t){return t??""}function Jn(t){return t&&xn(t.destroy)?t.destroy:ee}const As=typeof window<"u";let Vc=As?()=>window.performance.now():()=>Date.now(),dr=As?t=>requestAnimationFrame(t):ee;const An=new Set;function Ts(t){An.forEach(e=>{e.c(t)||(An.delete(e),e.f())}),An.size!==0&&dr(Ts)}function Hc(t){let e;return An.size===0&&dr(Ts),{promise:new Promise(n=>{An.add(e={c:t,f:n})}),abort(){An.delete(e)}}}const Uc=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function y(t,e){t.appendChild(e)}function Ns(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Bc(t){const e=b("style");return qc(Ns(t),e),e.sheet}function qc(t,e){return y(t.head||t,e),e.sheet}function z(t,e,n){t.insertBefore(e,n||null)}function D(t){t.parentNode&&t.parentNode.removeChild(t)}function at(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function jt(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function re(t){return document.createTextNode(t)}function F(){return re(" ")}function ht(){return re("")}function Se(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function en(t){return function(e){return e.preventDefault(),t.call(this,e)}}function v(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Kc(t){return Array.from(t.childNodes)}function Ee(t,e){e=""+e,t.data!==e&&(t.data=e)}function Si(t,e){t.value=e??""}function De(t,e,n,i){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,i?"important":"")}function Os(t,e,n){for(let i=0;i<t.options.length;i+=1){const r=t.options[i];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Wc(t){const e=t.querySelector(":checked");return e&&e.__value}function Pe(t,e,n){t.classList[n?"add":"remove"](e)}function Ps(t,e,{bubbles:n=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,n,i,e),r}function ki(t,e){return new t(e)}const Ei=new Map;let Ci=0;function Yc(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Gc(t,e){const n={stylesheet:Bc(e),rules:{}};return Ei.set(t,n),n}function Ls(t,e,n,i,r,s,o,l=0){const a=16.666/i;let c=`{
`;for(let g=0;g<=1;g+=a){const _=e+(n-e)*s(g);c+=g*100+`%{${o(_,1-_)}}
`}const u=c+`100% {${o(n,1-n)}}
}`,d=`__svelte_${Yc(u)}_${l}`,f=Ns(t),{stylesheet:h,rules:m}=Ei.get(f)||Gc(f,t);m[d]||(m[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const p=t.style.animation||"";return t.style.animation=`${p?`${p}, `:""}${d} ${i}ms linear ${r}ms 1 both`,Ci+=1,d}function Xc(t,e){const n=(t.style.animation||"").split(", "),i=n.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),r=n.length-i.length;r&&(t.style.animation=i.join(", "),Ci-=r,Ci||Jc())}function Jc(){dr(()=>{Ci||(Ei.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&D(e)}),Ei.clear())})}let Qn;function tn(t){Qn=t}function Tn(){if(!Qn)throw new Error("Function called outside component initialization");return Qn}function Nn(t){Tn().$$.on_mount.push(t)}function On(t){Tn().$$.on_destroy.push(t)}function Ii(){const t=Tn();return(e,n,{cancelable:i=!1}={})=>{const r=t.$$.callbacks[e];if(r){const s=Ps(e,n,{cancelable:i});return r.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function Pn(t,e){return Tn().$$.context.set(t,e),e}function Nt(t){return Tn().$$.context.get(t)}const Ln=[],un=[];let Rn=[];const Rs=[],Qc=Promise.resolve();let hr=!1;function Zc(){hr||(hr=!0,Qc.then(pr))}function Wt(t){Rn.push(t)}const mr=new Set;let Dn=0;function pr(){if(Dn!==0)return;const t=Qn;do{try{for(;Dn<Ln.length;){const e=Ln[Dn];Dn++,tn(e),eu(e.$$)}}catch(e){throw Ln.length=0,Dn=0,e}for(tn(null),Ln.length=0,Dn=0;un.length;)un.pop()();for(let e=0;e<Rn.length;e+=1){const n=Rn[e];mr.has(n)||(mr.add(n),n())}Rn.length=0}while(Ln.length);for(;Rs.length;)Rs.pop()();hr=!1,mr.clear(),tn(t)}function eu(t){if(t.fragment!==null){t.update(),ot(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Wt)}}function tu(t){const e=[],n=[];Rn.forEach(i=>t.indexOf(i)===-1?e.push(i):n.push(i)),n.forEach(i=>i()),Rn=e}let Zn;function nu(){return Zn||(Zn=Promise.resolve(),Zn.then(()=>{Zn=null})),Zn}function gr(t,e,n){t.dispatchEvent(Ps(`${e?"intro":"outro"}${n}`))}const Mi=new Set;let nn;function ze(){nn={r:0,c:[],p:nn}}function je(){nn.r||ot(nn.c),nn=nn.p}function U(t,e){t&&t.i&&(Mi.delete(t),t.i(e))}function K(t,e,n,i){if(t&&t.o){if(Mi.has(t))return;Mi.add(t),nn.c.push(()=>{Mi.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}else i&&i()}const iu={duration:0};function fn(t,e,n,i){const r={direction:"both"};let s=e(t,n,r),o=i?0:1,l=null,a=null,c=null;function u(){c&&Xc(t,c)}function d(h,m){const p=h.b-o;return m*=Math.abs(p),{a:o,b:h.b,d:p,duration:m,start:h.start,end:h.start+m,group:h.group}}function f(h){const{delay:m=0,duration:p=300,easing:g=Es,tick:_=ee,css:S}=s||iu,E={start:Vc()+m,b:h};h||(E.group=nn,nn.r+=1),l||a?a=E:(S&&(u(),c=Ls(t,o,h,p,m,g,S)),h&&_(0,1),l=d(E,p),Wt(()=>gr(t,h,"start")),Hc(w=>{if(a&&w>a.start&&(l=d(a,p),a=null,gr(t,l.b,"start"),S&&(u(),c=Ls(t,o,l.b,l.duration,0,g,s.css))),l){if(w>=l.end)_(o=l.b,1-o),gr(t,l.b,"end"),a||(l.b?u():--l.group.r||ot(l.group.c)),l=null;else if(w>=l.start){const k=w-l.start;o=l.a+l.d*g(k/l.duration),_(o,1-o)}}return!!(l||a)}))}return{run(h){xn(s)?nu().then(()=>{s=s(r),f(h)}):f(h)},end(){u(),l=a=null}}}function _r(t,e){const n=e.token={};function i(r,s,o,l){if(e.token!==n)return;e.resolved=l;let a=e.ctx;o!==void 0&&(a=a.slice(),a[o]=l);const c=r&&(e.current=r)(a);let u=!1;e.block&&(e.blocks?e.blocks.forEach((d,f)=>{f!==s&&d&&(ze(),K(d,1,1,()=>{e.blocks[f]===d&&(e.blocks[f]=null)}),je())}):e.block.d(1),c.c(),U(c,1),c.m(e.mount(),e.anchor),u=!0),e.block=c,e.blocks&&(e.blocks[s]=c),u&&pr()}if(zc(t)){const r=Tn();if(t.then(s=>{tn(r),i(e.then,1,e.value,s),tn(null)},s=>{if(tn(r),i(e.catch,2,e.error,s),tn(null),!e.hasCatch)throw s}),e.current!==e.pending)return i(e.pending,0),!0}else{if(e.current!==e.then)return i(e.then,1,e.value,t),!0;e.resolved=t}}function Ds(t,e,n){const i=e.slice(),{resolved:r}=t;t.current===t.then&&(i[t.value]=r),t.current===t.catch&&(i[t.error]=r),t.block.p(i,n)}function $s(t,e){t.d(1),e.delete(t.key)}function vr(t,e){K(t,1,1,()=>{e.delete(t.key)})}function ei(t,e,n,i,r,s,o,l,a,c,u,d){let f=t.length,h=s.length,m=f;const p={};for(;m--;)p[t[m].key]=m;const g=[],_=new Map,S=new Map,E=[];for(m=h;m--;){const M=d(r,s,m),C=n(M);let x=o.get(C);x?i&&E.push(()=>x.p(M,e)):(x=c(C,M),x.c()),_.set(C,g[m]=x),C in p&&S.set(C,Math.abs(m-p[C]))}const w=new Set,k=new Set;function T(M){U(M,1),M.m(l,u),o.set(M.key,M),u=M.first,h--}for(;f&&h;){const M=g[h-1],C=t[f-1],x=M.key,P=C.key;M===C?(u=M.first,f--,h--):_.has(P)?!o.has(x)||w.has(x)?T(M):k.has(P)?f--:S.get(x)>S.get(P)?(k.add(x),T(M)):(w.add(P),f--):(a(C,o),f--)}for(;f--;){const M=t[f];_.has(M.key)||a(M,o)}for(;h;)T(g[h-1]);return ot(E),g}function ru(t,e){const n={},i={},r={$$scope:1};let s=t.length;for(;s--;){const o=t[s],l=e[s];if(l){for(const a in o)a in l||(i[a]=1);for(const a in l)r[a]||(n[a]=l[a],r[a]=1);t[s]=l}else for(const a in o)r[a]=1}for(const o in i)o in n||(n[o]=void 0);return n}function su(t){return typeof t=="object"&&t!==null?t:{}}function me(t){t&&t.c()}function de(t,e,n,i){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,n),i||Wt(()=>{const o=t.$$.on_mount.map(Is).filter(xn);t.$$.on_destroy?t.$$.on_destroy.push(...o):ot(o),t.$$.on_mount=[]}),s.forEach(Wt)}function he(t,e){const n=t.$$;n.fragment!==null&&(tu(n.after_update),ot(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ou(t,e){t.$$.dirty[0]===-1&&(Ln.push(t),Zc(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function xe(t,e,n,i,r,s,o,l=[-1]){const a=Qn;tn(t);const c=t.$$={fragment:null,ctx:[],props:s,update:ee,not_equal:r,bound:Ms(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Ms(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(d,f,...h)=>{const m=h.length?h[0]:f;return c.ctx&&r(c.ctx[d],c.ctx[d]=m)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](m),u&&ou(t,d)),f}):[],c.update(),u=!0,ot(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const d=Kc(e.target);c.fragment&&c.fragment.l(d),d.forEach(D)}else c.fragment&&c.fragment.c();e.intro&&U(t.$$.fragment),de(t,e.target,e.anchor,e.customElement),pr()}tn(a)}class Ae{$destroy(){he(this,1),this.$destroy=ee}$on(e,n){if(!xn(n))return ee;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(n),()=>{const r=i.indexOf(n);r!==-1&&i.splice(r,1)}}$set(e){this.$$set&&!jc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const $n=[];function lu(t,e){return{subscribe:Te(t,e).subscribe}}function Te(t,e=ee){let n;const i=new Set;function r(l){if(Me(t,l)&&(t=l,n)){const a=!$n.length;for(const c of i)c[1](),$n.push(c,t);if(a){for(let c=0;c<$n.length;c+=2)$n[c][0]($n[c+1]);$n.length=0}}}function s(l){r(l(t))}function o(l,a=ee){const c=[l,a];return i.add(c),i.size===1&&(n=e(r)||ee),l(t),()=>{i.delete(c),i.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}function nt(t,e,n){const i=!Array.isArray(t),r=i?[t]:t,s=e.length<2;return lu(n,o=>{let l=!1;const a=[];let c=0,u=ee;const d=()=>{if(c)return;u();const h=e(i?a[0]:a,o);s?o(h):u=xn(h)?h:ee},f=r.map((h,m)=>bi(h,p=>{a[m]=p,c&=~(1<<m),l&&d()},()=>{c|=1<<m}));return l=!0,d(),function(){ot(f),u(),l=!1}})}const W=APP_LANG,Ft=APP_NAME;WEBAPP_NAME;const yr=USER_ID;IS_SUPERUSER,ADD_PERMISSION;const dn=CSRF_TOKEN;ADDITIONAL_MODULES;const au="Region",zs=APP_URL,cu=SAS_APP_URL;CANTALOUPE_APP_URL,MEDIA_PATH;const uu=PAGE_LEN,fu={Witness:W==="en"?"Witness":"Témoin",Work:W==="en"?"Work":"Œuvre",Series:W==="en"?"Series":"Série d'imprimés",Regions:W==="en"?"Region Extraction":"Extraction d'illustrations"},ti=Te(!1),du=Te(""),hu=t=>typeof t=="string"||t instanceof String;async function js(t){ti.set(!0);try{return await t()}finally{ti.set(!1)}}function br(t){return t.match(/\d+/g).toString()}function mu(t){return parseInt(br(t),10)}function pu(t,e=100){const n=Math.floor(e*.75);return t.length>e?t.slice(0,n)+"..."+t.slice(-e+n):t}function gu(){return"https://vhs.huma-num.fr"}function _u(){return cu??"http://localhost:8888"}function wr(t,e){if(typeof window<"u"){const n=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(n))return t.set(n),n}return t.set(1),1}function Sr(t,e,n){if(e.set(t),typeof window<"u"){const i=new URL(window.location.href);i.searchParams.set(n,t),window.history.pushState({},"",i)}}function vu(t=null){return t=t.split("_"),t.length<3?void 0:`${t.slice(0,3).join("_").replace(".jpg","")}.jpg`}function Fs(t=null){const e=vu(t);return e===void 0?void 0:`${gu()}/iiif/2/${e}`}function Vt(t=null,e=null,n="full"){if(e=hu(e)?e.replace(".jpg",""):e,!t)return"https://placehold.co/96x96/png?text=No+image";const i=Fs(t);if(i===void 0)return"https://placehold.co/96x96/png?text=No+image";const r=t.split("_");return e||(e=r[r.length-1].includes(",")?r.pop().replace(".jpg",""):"full"),`${i}/${e}/${n}/0/default.jpg`}function yu(t=null){return`${Fs(t)}/info.json`}function bu(t=null,e=1){return`${_u()}/index.html?iiif-content=${t}&canvas=${e}`}function Ct(t,e=null,n=!1){return new Promise(i=>{if(document.getElementById("msg-modal")){n?document.getElementById("modal-footer").hidden=!1:i(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=t,document.getElementById("hidden-msg-btn").click();const s=document.getElementById("cancel-btn"),o=document.getElementById("ok-btn"),l=document.getElementById("modal-bkg"),a=()=>{s.removeEventListener("click",c),l.removeEventListener("click",c),o.removeEventListener("click",u),document.getElementById("modal-footer").hidden=!0},c=()=>{a(),i(!1)},u=()=>{a(),i(!0)};s.addEventListener("click",c),o.addEventListener("click",u)}else n?i(window.confirm(t)):(window.alert(t),i(void 0))})}function xi(){let t,e,n=(i,r)=>i===r;return{set:i=>{e=t,t=i},setCompareFn:i=>n=i,get:()=>t,getNewAndOld:()=>[t,e],same:()=>n(t,e)}}const kr=(t,e)=>Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every((n,i)=>n===e[i]||void 0);function wu(t){const n=[85,70,60],i=[50,65,40],r=t*137.5%360,s=n[t%n.length],o=i[Math.floor(t/n.length)%i.length];return`hsl(${Math.floor(r)}, ${s}%, ${o}%)`}function Vs(t=null){return t<600?1:t<800?2:t<1e3?3:t<1200?4:t<1400?5:t>=1400?6:4}function Er(t){const e=t.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),n=()=>t.classList.remove("is-active");e.forEach(r=>r.addEventListener("click",n));const i=r=>{r.key==="Escape"&&t.classList.contains("is-active")&&n()};return document.addEventListener("keydown",i),{destroy(){e.forEach(r=>r.removeEventListener("click",n)),document.removeEventListener("keydown",i)}}}function Hs(t){const e=()=>{const n=document.getElementById(t.dataset.target);n==null||n.classList.add("is-active")};return t.addEventListener("click",e),{destroy(){t.removeEventListener("click",e)}}}function zn(t,e,n="string"){const i={string:s=>{const o=s.get(e);return o!==null?o:null},array:s=>{const o=s.get(e);return o?o.split(",").map(Number).filter(l=>!isNaN(l)):null},set:s=>{const o=s.get(e);return o?new Set(o.split(",").map(Number).filter(l=>!isNaN(l))):null},number:s=>{const o=s.get(e);return o!==null?Number(o):null},boolean:s=>{const o=s.get(e);return o!==null?o==="true":null}},r={string:(s,o)=>o?s.searchParams.set(e,o):s.searchParams.delete(e),array:(s,o)=>{o!=null&&o.length?s.searchParams.set(e,o.join(",")):s.searchParams.delete(e)},set:(s,o)=>{o!=null&&o.size?s.searchParams.set(e,Array.from(o).join(",")):s.searchParams.delete(e)},number:(s,o)=>{o!=null?s.searchParams.set(e,String(o)):s.searchParams.delete(e)},boolean:(s,o)=>o?s.searchParams.set(e,"true"):s.searchParams.delete(e)};if(typeof window<"u"){const s=new URLSearchParams(window.location.search),o=i[n](s);return o!==null&&t.set(o),l=>{const a=new URL(window.location);r[n](a,l),window.history.pushState({},"",a)}}return()=>{}}function Su(t){const e=t-1;return e*e*e+1}function jn(t,{delay:e=0,duration:n=400,easing:i=Es}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:s=>`opacity: ${s*r}`}}function Us(t,{delay:e=0,duration:n=400,easing:i=Su,axis:r="y"}={}){const s=getComputedStyle(t),o=+s.opacity,l=r==="y"?"height":"width",a=parseFloat(s[l]),c=r==="y"?["top","bottom"]:["left","right"],u=c.map(_=>`${_[0].toUpperCase()}${_.slice(1)}`),d=parseFloat(s[`padding${u[0]}`]),f=parseFloat(s[`padding${u[1]}`]),h=parseFloat(s[`margin${u[0]}`]),m=parseFloat(s[`margin${u[1]}`]),p=parseFloat(s[`border${u[0]}Width`]),g=parseFloat(s[`border${u[1]}Width`]);return{delay:e,duration:n,easing:i,css:_=>`overflow: hidden;opacity: ${Math.min(_*20,1)*o};${l}: ${_*a}px;padding-${c[0]}: ${_*d}px;padding-${c[1]}: ${_*f}px;margin-${c[0]}: ${_*h}px;margin-${c[1]}: ${_*m}px;border-${c[0]}-width: ${_*p}px;border-${c[1]}-width: ${_*g}px;`}}const Ay="";function Bs(t){let e,n,i;return{c(){e=b("div"),e.innerHTML='<div class="loader svelte-vizlcg"></div>',v(e,"class","bkg-shade svelte-vizlcg")},m(r,s){z(r,e,s),i=!0},i(r){i||(Wt(()=>{i&&(n||(n=fn(e,jn,{duration:150},!0)),n.run(1))}),i=!0)},o(r){n||(n=fn(e,jn,{duration:150},!1)),n.run(0),i=!1},d(r){r&&D(e),r&&n&&n.end()}}}function ku(t){let e,n,i=t[0]&&Bs();return{c(){i&&i.c(),e=ht()},m(r,s){i&&i.m(r,s),z(r,e,s),n=!0},p(r,[s]){r[0]?i?s&1&&U(i,1):(i=Bs(),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(ze(),K(i,1,1,()=>{i=null}),je())},i(r){n||(U(i),n=!0)},o(r){K(i),n=!1},d(r){i&&i.d(r),r&&D(e)}}}function Eu(t,e,n){let i;return we(t,ti,r=>n(0,i=r)),[i]}class Cu extends Ae{constructor(e){super(),xe(this,e,Eu,ku,Me,{})}}const Iu=t=>({}),qs=t=>({});function Mu(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g,_,S,E,w,k;const T=t[1].content,M=Lt(T,t,t[0],qs);return{c(){e=b("button"),n=F(),i=b("div"),r=b("div"),s=F(),o=b("div"),l=b("div"),l.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,a=F(),c=b("section"),u=b("div"),d=F(),f=b("div"),M&&M.c(),h=F(),m=b("footer"),p=b("div"),g=b("button"),g.textContent=`${W==="en"?"Abort":"Retour"}`,_=F(),S=b("button"),S.textContent="OK",v(e,"id","hidden-msg-btn"),v(e,"data-target","msg-modal"),e.hidden=!0,v(r,"id","modal-bkg"),v(r,"class","modal-background"),v(l,"class","modal-card-head media mb-0"),v(u,"id","modal-msg"),v(f,"class","py-3"),v(c,"id","modal-body"),v(c,"class","modal-card-body"),v(g,"id","cancel-btn"),v(g,"class","button is-link is-light button-close"),v(S,"id","ok-btn"),v(S,"class","button is-link button-close"),v(p,"class","buttons"),v(m,"id","modal-footer"),v(m,"class","modal-card-foot is-center pt-3"),m.hidden=!0,v(o,"class","modal-content"),v(i,"id","msg-modal"),v(i,"class","modal fade"),v(i,"tabindex","-1"),v(i,"aria-labelledby","selection-modal-label"),v(i,"aria-hidden","true")},m(C,x){z(C,e,x),z(C,n,x),z(C,i,x),y(i,r),y(i,s),y(i,o),y(o,l),y(o,a),y(o,c),y(c,u),y(c,d),y(c,f),M&&M.m(f,null),y(o,h),y(o,m),y(m,p),y(p,g),y(p,_),y(p,S),E=!0,w||(k=[Jn(Hs.call(null,e)),Jn(Er.call(null,i))],w=!0)},p(C,[x]){M&&M.p&&(!E||x&1)&&Dt(M,T,C,C[0],E?Rt(T,C[0],x,Iu):$t(C[0]),qs)},i(C){E||(U(M,C),E=!0)},o(C){K(M,C),E=!1},d(C){C&&D(e),C&&D(n),C&&D(i),M&&M.d(C),w=!1,ot(k)}}}function xu(t,e,n){let{$$slots:i={},$$scope:r}=e;return t.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,i]}class Au extends Ae{constructor(e){super(),xe(this,e,xu,Mu,Me,{})}}const Ty="",Tu=t=>({activeTab:t&8}),Ks=t=>({activeTab:t[3]});function Ws(t,e,n){const i=t.slice();return i[11]=e[n][0],i[12]=e[n][1],i}const Nu=t=>({activeTab:t&8}),Ys=t=>({activeTab:t[3]}),Ou=t=>({}),Gs=t=>({});function Pu(t){let e,n,i=Object.entries(t[2]),r=[];for(let s=0;s<i.length;s+=1)r[s]=Xs(Ws(t,i,s));return{c(){e=b("div"),n=b("ul");for(let s=0;s<r.length;s+=1)r[s].c();v(e,"class","tabs")},m(s,o){z(s,e,o),y(e,n);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(n,null)},p(s,o){if(o&28){i=Object.entries(s[2]);let l;for(l=0;l<i.length;l+=1){const a=Ws(s,i,l);r[l]?r[l].p(a,o):(r[l]=Xs(a),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=i.length}},i:ee,o:ee,d(s){s&&D(e),at(r,s)}}}function Lu(t){let e;const n=t[8].tabs,i=Lt(n,t,t[7],Ys);return{c(){i&&i.c()},m(r,s){i&&i.m(r,s),e=!0},p(r,s){i&&i.p&&(!e||s&136)&&Dt(i,n,r,r[7],e?Rt(n,r[7],s,Nu):$t(r[7]),Ys)},i(r){e||(U(i,r),e=!0)},o(r){K(i,r),e=!1},d(r){i&&i.d(r)}}}function Xs(t){let e,n,i=t[12]+"",r,s,o,l;function a(){return t[9](t[11])}return{c(){e=b("li"),n=b("a"),r=re(i),s=F(),v(n,"href",null),Pe(e,"is-active",t[3]===t[11])},m(c,u){z(c,e,u),y(e,n),y(n,r),y(e,s),o||(l=Se(n,"click",a),o=!0)},p(c,u){t=c,u&4&&i!==(i=t[12]+"")&&Ee(r,i),u&12&&Pe(e,"is-active",t[3]===t[11])},d(c){c&&D(e),o=!1,l()}}}function Ru(t){let e,n,i,r,s,o,l,a,c,u,d,f,h;e=new Cu({});const m=t[8].sidebar,p=Lt(m,t,t[7],Gs),g=[Lu,Pu],_=[];function S(k,T){return T&4&&(a=null),k[5].tabs?0:(a==null&&(a=!!Object.keys(k[2]).length),a?1:-1)}~(c=S(t,-1))&&(u=_[c]=g[c](t));const E=t[8].content,w=Lt(E,t,t[7],Ks);return{c(){me(e.$$.fragment),n=F(),i=b("div"),r=b("aside"),p&&p.c(),s=F(),o=b("main"),l=b("nav"),u&&u.c(),d=F(),f=b("div"),w&&w.c(),v(r,"class","sidebar svelte-jexg"),De(r,"width",t[0]+"%"),De(r,"min-height",t[1]),v(l,"id","tabs"),v(l,"class","tabs-bar svelte-jexg"),v(f,"class","content-area pl-5 svelte-jexg"),v(o,"class","main-content svelte-jexg"),De(o,"width",100-t[0]+"%"),De(o,"min-height",t[1]),v(i,"class","layout svelte-jexg"),De(i,"min-height",t[1])},m(k,T){de(e,k,T),z(k,n,T),z(k,i,T),y(i,r),p&&p.m(r,null),y(i,s),y(i,o),y(o,l),~c&&_[c].m(l,null),y(o,d),y(o,f),w&&w.m(f,null),h=!0},p(k,[T]){p&&p.p&&(!h||T&128)&&Dt(p,m,k,k[7],h?Rt(m,k[7],T,Ou):$t(k[7]),Gs),(!h||T&1)&&De(r,"width",k[0]+"%");let M=c;c=S(k,T),c===M?~c&&_[c].p(k,T):(u&&(ze(),K(_[M],1,1,()=>{_[M]=null}),je()),~c?(u=_[c],u?u.p(k,T):(u=_[c]=g[c](k),u.c()),U(u,1),u.m(l,null)):u=null),w&&w.p&&(!h||T&136)&&Dt(w,E,k,k[7],h?Rt(E,k[7],T,Tu):$t(k[7]),Ks),(!h||T&1)&&De(o,"width",100-k[0]+"%")},i(k){h||(U(e.$$.fragment,k),U(p,k),U(u),U(w,k),h=!0)},o(k){K(e.$$.fragment,k),K(p,k),K(u),K(w,k),h=!1},d(k){he(e,k),k&&D(n),k&&D(i),p&&p.d(k),~c&&_[c].d(),w&&w.d(k)}}}function Du(t=null){t||(t=document.getElementById("navbar")),document.documentElement.style.setProperty("--top-offset",`${t.offsetHeight}px`)}function $u(t,e,n){let i,{$$slots:r={},$$scope:s}=e;const o=Fc(r);let{sidebarWidth:l="25"}=e;const a="90vh";let{tabList:c={}}=e,u=Object.keys(c),{topOffsetElement:d=null}=e;Du(d);function f(m){if(!u.includes(m)){console.warn(`Tab "${m}" is not available.`);return}n(3,i=m);const p=new URL(window.location);p.searchParams.set("tab",m),window.history.pushState({},"",p)}const h=m=>f(m);return t.$$set=m=>{"sidebarWidth"in m&&n(0,l=m.sidebarWidth),"tabList"in m&&n(2,c=m.tabList),"topOffsetElement"in m&&n(6,d=m.topOffsetElement),"$$scope"in m&&n(7,s=m.$$scope)},n(3,i=new URLSearchParams(window.location.search).get("tab")??u[0]??null),[l,a,c,i,f,o,d,s,r,h]}class zu extends Ae{constructor(e){super(),xe(this,e,$u,Ru,Me,{sidebarWidth:0,layoutHeight:1,tabList:2,topOffsetElement:6})}get layoutHeight(){return this.$$.ctx[1]}}const Ai={0:{title:W==="en"?"no categorization":"aucune catégorisation",svg:`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`},1:{title:W==="en"?"overall visual matches":"correspondances visuelles globales",svg:`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 69">
        <rect x="10" y="10.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="1" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="10" y="10.62" width="46" height="45.71" rx="4.11" ry="4.11" fill="currentColor" stroke="none"/>
    </svg>`},2:{title:W==="en"?"visual matches on part of the image":"correspondances visuelles sur une partie de l'image",svg:`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71">
        <rect x="12" y="12.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 12 21.43 L 21 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 30 L 30 12.43" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 40 56 L 57 38" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 48.3 56.29 L 57 47" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 39 L 39 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 12 48 L 48 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 13 56 L 57 12" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 31 56 L 57 29" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 21 57 L 57 21" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`},3:{title:W==="en"?"semantic and non-visual matches":"correspondances sémantiques et non-visuelle",svg:`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 73">
        <rect x="14" y="14.43" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3" stroke-dasharray="9 9"/>
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
    </svg>`},4:{title:W==="en"?"regions without match":"régions sans correspondance",svg:`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.62" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 2.67 54.55 L 55 2" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
        <path d="M 54.37 54.05 L 2.72 2.24" fill="none" stroke="currentColor" stroke-width="3" stroke-miterlimit="10"/>
    </svg>`},5:{title:W==="en"?"user specific category":"correspondances spécifiques à l'utilisateur",svg:`<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 59 59">
        <rect x="1" y="0.81" width="55.71" height="55.71" rx="5.01" ry="5.01" fill="none" stroke="currentColor" stroke-width="3"/>
        <path d="M 8.69 55.28 C 9.25 44.15 18.08 35.28 28.86 35.28 C 32.5 35.28 36.07 36.3 39.18 38.25 C 44.96 41.85 48.66 48.3 49.02 55.28 Z M 17.85 21.48 C 17.85 15.37 22.79 10.39 28.86 10.39 C 34.92 10.39 39.86 15.37 39.86 21.48 C 39.86 27.59 34.92 32.56 28.86 32.56 C 22.79 32.56 17.85 27.59 17.85 21.48 Z M 40.37 36.34 C 38.43 35.13 36.32 34.25 34.13 33.7 C 38.82 31.64 42.1 26.94 42.1 21.48 C 42.1 14.13 36.16 8.15 28.86 8.15 C 21.55 8.15 15.61 14.13 15.61 21.48 C 15.61 26.95 18.9 31.66 23.6 33.71 C 13.76 36.18 6.41 45.4 6.41 56.4 C 6.41 57.02 6.92 57.52 7.54 57.52 L 50.17 57.52 C 50.79 57.52 51.3 57.02 51.3 56.4 C 51.3 48.23 47.11 40.54 40.37 36.34 Z" fill="currentColor" stroke="none"/>
    </svg>`}};function ju(t){let e,n=Ai[t[2]].svg+"",i,r,s,o;return{c(){e=b("span"),v(e,"class",i="tag py-4 "+t[4]+" "+(t[0]?"is-hoverable":"")),v(e,"title",r=Ai[t[2]].title),Pe(e,"is-selected",t[1])},m(l,a){z(l,e,a),e.innerHTML=n,s||(o=[Se(e,"click",t[5]),Se(e,"keyup",null)],s=!0)},p(l,[a]){a&4&&n!==(n=Ai[l[2]].svg+"")&&(e.innerHTML=n),a&17&&i!==(i="tag py-4 "+l[4]+" "+(l[0]?"is-hoverable":""))&&v(e,"class",i),a&4&&r!==(r=Ai[l[2]].title)&&v(e,"title",r),a&19&&Pe(e,"is-selected",l[1])},i:ee,o:ee,d(l){l&&D(e),s=!1,ot(o)}}}function Fu(t,e,n){let{selectable:i=!0}=e,{isSelected:r=!1}=e,{category:s}=e,{toggle:o=()=>{}}=e,{padding:l="px-2"}=e;const a=()=>o(s);return t.$$set=c=>{"selectable"in c&&n(0,i=c.selectable),"isSelected"in c&&n(1,r=c.isSelected),"category"in c&&n(2,s=c.category),"toggle"in c&&n(3,o=c.toggle),"padding"in c&&n(4,l=c.padding)},[i,r,s,o,l,a]}class Fn extends Ae{constructor(e){super(),xe(this,e,Fu,ju,Me,{selectable:0,isSelected:1,category:2,toggle:3,padding:4})}}const Uy="";function Js(t){let e,n,i=t[3].title+"",r,s;return{c(){e=b("span"),n=b("a"),r=re(i),v(n,"href",s=`${zs}/${Ft}/witness/${t[3].witnessId}/regions/${t[1]}`),v(n,"target","_blank"),v(e,"class","legend-label svelte-w1sf17")},m(o,l){z(o,e,l),y(e,n),y(n,r)},p(o,l){l&8&&i!==(i=o[3].title+"")&&Ee(r,i),l&10&&s!==(s=`${zs}/${Ft}/witness/${o[3].witnessId}/regions/${o[1]}`)&&v(n,"href",s)},d(o){o&&D(e)}}}function Vu(t){let e,n,i,r,s,o,l,a,c,u=!t[5]&&Js(t);return{c(){e=b("div"),n=b("span"),i=F(),r=b("span"),l=F(),u&&u.c(),v(n,"class","legend-nb svelte-w1sf17"),v(r,"class","legend-color svelte-w1sf17"),v(r,"aria-label",s=t[3].title),v(r,"title",o=t[3].title),De(r,"background-color",t[0]?t[3].color:"#999"),v(r,"role","button"),v(r,"tabindex","0"),Pe(r,"inactive",!t[0]),Pe(r,"clickable",t[4]),v(e,"class","legend-item svelte-w1sf17"),Pe(e,"inactive",!t[0])},m(d,f){z(d,e,f),y(e,n),y(e,i),y(e,r),y(e,l),u&&u.m(e,null),a||(c=[Se(r,"click",function(){xn(t[2])&&t[2].apply(this,arguments)}),Se(r,"keydown",null)],a=!0)},p(d,[f]){t=d,f&8&&s!==(s=t[3].title)&&v(r,"aria-label",s),f&8&&o!==(o=t[3].title)&&v(r,"title",o),f&9&&De(r,"background-color",t[0]?t[3].color:"#999"),f&1&&Pe(r,"inactive",!t[0]),f&16&&Pe(r,"clickable",t[4]),t[5]?u&&(u.d(1),u=null):u?u.p(t,f):(u=Js(t),u.c(),u.m(e,null)),f&1&&Pe(e,"inactive",!t[0])},i:ee,o:ee,d(d){d&&D(e),u&&u.d(),a=!1,ot(c)}}}function Hu(t,e,n){let{isActive:i=!0}=e,{id:r}=e,{toggle:s=()=>{}}=e,{meta:o={title:"Region",color:"#999",witnessId:1}}=e,{clickable:l=!0}=e,{onlyColor:a=!1}=e;return t.$$set=c=>{"isActive"in c&&n(0,i=c.isActive),"id"in c&&n(1,r=c.id),"toggle"in c&&n(2,s=c.toggle),"meta"in c&&n(3,o=c.meta),"clickable"in c&&n(4,l=c.clickable),"onlyColor"in c&&n(5,a=c.onlyColor)},[i,r,s,o,l,a]}class Qs extends Ae{constructor(e){super(),xe(this,e,Hu,Vu,Me,{isActive:0,id:1,toggle:2,meta:3,clickable:4,onlyColor:5})}}const By="";function Zs(t,e,n){const i=t.slice();return i[6]=e[n][0],i[7]=e[n][1],i}function Uu(t){let e;return{c(){e=b("span"),e.innerHTML='<i class="fas fa-chevron-down"></i>',v(e,"class","icon is-small")},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function Bu(t){let e;return{c(){e=b("span"),e.innerHTML='<i class="fas fa-chevron-up"></i>',v(e,"class","icon is-small")},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function eo(t){let e,n;function i(){return t[5](t[6])}return e=new Qs({props:{id:t[6],meta:t[7],isActive:t[1].has(parseInt(t[6])),toggle:i,onlyColor:!t[3]}}),{c(){me(e.$$.fragment)},m(r,s){de(e,r,s),n=!0},p(r,s){t=r;const o={};s&1&&(o.id=t[6]),s&1&&(o.meta=t[7]),s&3&&(o.isActive=t[1].has(parseInt(t[6]))),s&5&&(o.toggle=i),s&8&&(o.onlyColor=!t[3]),e.$set(o)},i(r){n||(U(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){he(e,r)}}}function qu(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g;function _(M,C){return M[3]?Bu:Uu}let S=_(t),E=S(t),w=Array.from(t[0]||new Map),k=[];for(let M=0;M<w.length;M+=1)k[M]=eo(Zs(t,w,M));const T=M=>K(k[M],1,1,()=>{k[M]=null});return{c(){e=b("div"),n=b("div"),i=b("div"),r=b("div"),s=b("h3"),s.textContent=`${W==="en"?"Visible documents":"Documents visibles"}`,o=F(),l=b("div"),a=b("div"),c=b("button"),E.c(),f=F(),h=b("div");for(let M=0;M<k.length;M+=1)k[M].c();v(s,"class","title mb-0"),v(r,"class","level-item"),v(i,"class","level-left"),v(c,"class","button is-small is-ghost"),v(c,"aria-label",u=t[3]?"Minify legend":"Expand legend"),v(a,"class","level-item"),v(a,"title",d=t[3]?"Minify legend":"Expand legend"),v(l,"class","level-right"),v(n,"class","level is-mobile mb-3"),v(h,"class","svelte-13ym7ov"),Pe(h,"is-condensed",!t[3]),Pe(h,"is-expanded",t[3])},m(M,C){z(M,e,C),y(e,n),y(n,i),y(i,r),y(r,s),y(n,o),y(n,l),y(l,a),y(a,c),E.m(c,null),y(e,f),y(e,h);for(let x=0;x<k.length;x+=1)k[x]&&k[x].m(h,null);m=!0,p||(g=Se(c,"click",t[4]),p=!0)},p(M,[C]){if(S!==(S=_(M))&&(E.d(1),E=S(M),E&&(E.c(),E.m(c,null))),(!m||C&8&&u!==(u=M[3]?"Minify legend":"Expand legend"))&&v(c,"aria-label",u),(!m||C&8&&d!==(d=M[3]?"Minify legend":"Expand legend"))&&v(a,"title",d),C&15){w=Array.from(M[0]||new Map);let x;for(x=0;x<w.length;x+=1){const P=Zs(M,w,x);k[x]?(k[x].p(P,C),U(k[x],1)):(k[x]=eo(P),k[x].c(),U(k[x],1),k[x].m(h,null))}for(ze(),x=w.length;x<k.length;x+=1)T(x);je()}(!m||C&8)&&Pe(h,"is-condensed",!M[3]),(!m||C&8)&&Pe(h,"is-expanded",M[3])},i(M){if(!m){for(let C=0;C<w.length;C+=1)U(k[C]);m=!0}},o(M){k=k.filter(Boolean);for(let C=0;C<k.length;C+=1)K(k[C]);m=!1},d(M){M&&D(e),E.d(),at(k,M),p=!1,g()}}}function Ku(t,e,n){let{documentNodes:i}=e,{selectedRegions:r}=e,{toggleRegion:s}=e,o=!0;const l=()=>n(3,o=!o),a=c=>s(parseInt(c));return t.$$set=c=>{"documentNodes"in c&&n(0,i=c.documentNodes),"selectedRegions"in c&&n(1,r=c.selectedRegions),"toggleRegion"in c&&n(2,s=c.toggleRegion)},[i,r,s,o,l,a]}class Wu extends Ae{constructor(e){super(),xe(this,e,Ku,qu,Me,{documentNodes:0,selectedRegions:1,toggleRegion:2})}}var hn;(function(t){t.Range="range",t.Steps="steps",t.Positions="positions",t.Count="count",t.Values="values"})(hn||(hn={}));var yt;(function(t){t[t.None=-1]="None",t[t.NoValue=0]="NoValue",t[t.LargeValue=1]="LargeValue",t[t.SmallValue=2]="SmallValue"})(yt||(yt={}));function Yu(t){return Ti(t)&&typeof t.from=="function"}function Ti(t){return typeof t=="object"&&typeof t.to=="function"}function to(t){t.parentElement.removeChild(t)}function Cr(t){return t!=null}function no(t){t.preventDefault()}function Gu(t){return t.filter(function(e){return this[e]?!1:this[e]=!0},{})}function Xu(t,e){return Math.round(t/e)*e}function Ju(t,e){var n=t.getBoundingClientRect(),i=t.ownerDocument,r=i.documentElement,s=so(i);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(s.x=0),e?n.top+s.y-r.clientTop:n.left+s.x-r.clientLeft}function Ht(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function io(t,e,n){n>0&&(mt(t,e),setTimeout(function(){Oi(t,e)},n))}function ro(t){return Math.max(Math.min(t,100),0)}function Ni(t){return Array.isArray(t)?t:[t]}function Qu(t){t=String(t);var e=t.split(".");return e.length>1?e[1].length:0}function mt(t,e){t.classList&&!/\s/.test(e)?t.classList.add(e):t.className+=" "+e}function Oi(t,e){t.classList&&!/\s/.test(e)?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function Zu(t,e){return t.classList?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)}function so(t){var e=window.pageXOffset!==void 0,n=(t.compatMode||"")==="CSS1Compat",i=e?window.pageXOffset:n?t.documentElement.scrollLeft:t.body.scrollLeft,r=e?window.pageYOffset:n?t.documentElement.scrollTop:t.body.scrollTop;return{x:i,y:r}}function ef(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function tf(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch{}return t}function nf(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function Ir(t,e){return 100/(e-t)}function Mr(t,e,n){return e*100/(t[n+1]-t[n])}function rf(t,e){return Mr(t,t[0]<0?e+Math.abs(t[0]):e-t[0],0)}function sf(t,e){return e*(t[1]-t[0])/100+t[0]}function ni(t,e){for(var n=1;t>=e[n];)n+=1;return n}function of(t,e,n){if(n>=t.slice(-1)[0])return 100;var i=ni(n,t),r=t[i-1],s=t[i],o=e[i-1],l=e[i];return o+rf([r,s],n)/Ir(o,l)}function lf(t,e,n){if(n>=100)return t.slice(-1)[0];var i=ni(n,e),r=t[i-1],s=t[i],o=e[i-1],l=e[i];return sf([r,s],(n-o)*Ir(o,l))}function af(t,e,n,i){if(i===100)return i;var r=ni(i,t),s=t[r-1],o=t[r];return n?i-s>(o-s)/2?o:s:e[r-1]?t[r-1]+Xu(i-t[r-1],e[r-1]):i}var oo=function(){function t(e,n,i){this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[i||!1],this.xNumSteps=[!1],this.snap=n;var r,s=[];for(Object.keys(e).forEach(function(o){s.push([Ni(e[o]),o])}),s.sort(function(o,l){return o[0][0]-l[0][0]}),r=0;r<s.length;r++)this.handleEntryPoint(s[r][1],s[r][0]);for(this.xNumSteps=this.xSteps.slice(0),r=0;r<this.xNumSteps.length;r++)this.handleStepPoint(r,this.xNumSteps[r])}return t.prototype.getDistance=function(e){for(var n=[],i=0;i<this.xNumSteps.length-1;i++)n[i]=Mr(this.xVal,e,i);return n},t.prototype.getAbsoluteDistance=function(e,n,i){var r=0;if(e<this.xPct[this.xPct.length-1])for(;e>this.xPct[r+1];)r++;else e===this.xPct[this.xPct.length-1]&&(r=this.xPct.length-2);!i&&e===this.xPct[r+1]&&r++,n===null&&(n=[]);var s,o=1,l=n[r],a=0,c=0,u=0,d=0;for(i?s=(e-this.xPct[r])/(this.xPct[r+1]-this.xPct[r]):s=(this.xPct[r+1]-e)/(this.xPct[r+1]-this.xPct[r]);l>0;)a=this.xPct[r+1+d]-this.xPct[r+d],n[r+d]*o+100-s*100>100?(c=a*s,o=(l-100*s)/n[r+d],s=1):(c=n[r+d]*a/100*o,o=0),i?(u=u-c,this.xPct.length+d>=1&&d--):(u=u+c,this.xPct.length-d>=1&&d++),l=n[r+d]*o;return e+u},t.prototype.toStepping=function(e){return e=of(this.xVal,this.xPct,e),e},t.prototype.fromStepping=function(e){return lf(this.xVal,this.xPct,e)},t.prototype.getStep=function(e){return e=af(this.xPct,this.xSteps,this.snap,e),e},t.prototype.getDefaultStep=function(e,n,i){var r=ni(e,this.xPct);return(e===100||n&&e===this.xPct[r-1])&&(r=Math.max(r-1,1)),(this.xVal[r]-this.xVal[r-1])/i},t.prototype.getNearbySteps=function(e){var n=ni(e,this.xPct);return{stepBefore:{startValue:this.xVal[n-2],step:this.xNumSteps[n-2],highestStep:this.xHighestCompleteStep[n-2]},thisStep:{startValue:this.xVal[n-1],step:this.xNumSteps[n-1],highestStep:this.xHighestCompleteStep[n-1]},stepAfter:{startValue:this.xVal[n],step:this.xNumSteps[n],highestStep:this.xHighestCompleteStep[n]}}},t.prototype.countStepDecimals=function(){var e=this.xNumSteps.map(Qu);return Math.max.apply(null,e)},t.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},t.prototype.convert=function(e){return this.getStep(this.toStepping(e))},t.prototype.handleEntryPoint=function(e,n){var i;if(e==="min"?i=0:e==="max"?i=100:i=parseFloat(e),!Ht(i)||!Ht(n[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(i),this.xVal.push(n[0]);var r=Number(n[1]);i?this.xSteps.push(isNaN(r)?!1:r):isNaN(r)||(this.xSteps[0]=r),this.xHighestCompleteStep.push(0)},t.prototype.handleStepPoint=function(e,n){if(n){if(this.xVal[e]===this.xVal[e+1]){this.xSteps[e]=this.xHighestCompleteStep[e]=this.xVal[e];return}this.xSteps[e]=Mr([this.xVal[e],this.xVal[e+1]],n,0)/Ir(this.xPct[e],this.xPct[e+1]);var i=(this.xVal[e+1]-this.xVal[e])/this.xNumSteps[e],r=Math.ceil(Number(i.toFixed(3))-1),s=this.xVal[e]+this.xNumSteps[e]*r;this.xHighestCompleteStep[e]=s}},t}(),lo={to:function(t){return t===void 0?"":t.toFixed(2)},from:Number},ao={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},mn={tooltips:".__tooltips",aria:".__aria"};function cf(t,e){if(!Ht(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function uf(t,e){if(!Ht(e))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");t.keyboardPageMultiplier=e}function ff(t,e){if(!Ht(e))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");t.keyboardMultiplier=e}function df(t,e){if(!Ht(e))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");t.keyboardDefaultStep=e}function hf(t,e){if(typeof e!="object"||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(e.min===void 0||e.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");t.spectrum=new oo(e,t.snap||!1,t.singleStep)}function mf(t,e){if(e=Ni(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=e.length,t.start=e}function pf(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");t.snap=e}function gf(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");t.animate=e}function _f(t,e){if(typeof e!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");t.animationDuration=e}function co(t,e){var n=[!1],i;if(e==="lower"?e=[!0,!1]:e==="upper"&&(e=[!1,!0]),e===!0||e===!1){for(i=1;i<t.handles;i++)n.push(e);n.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");n=e}t.connect=n}function vf(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function uo(t,e){if(!Ht(e))throw new Error("noUiSlider: 'margin' option must be numeric.");e!==0&&(t.margin=t.spectrum.getDistance(e))}function yf(t,e){if(!Ht(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getDistance(e),!t.limit||t.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function bf(t,e){var n;if(!Ht(e)&&!Array.isArray(e))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&!(e.length===2||Ht(e[0])||Ht(e[1])))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(e!==0){for(Array.isArray(e)||(e=[e,e]),t.padding=[t.spectrum.getDistance(e[0]),t.spectrum.getDistance(e[1])],n=0;n<t.spectrum.xNumSteps.length-1;n++)if(t.padding[0][n]<0||t.padding[1][n]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var i=e[0]+e[1],r=t.spectrum.xVal[0],s=t.spectrum.xVal[t.spectrum.xVal.length-1];if(i/(s-r)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function wf(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function Sf(t,e){if(typeof e!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var n=e.indexOf("tap")>=0,i=e.indexOf("drag")>=0,r=e.indexOf("fixed")>=0,s=e.indexOf("snap")>=0,o=e.indexOf("hover")>=0,l=e.indexOf("unconstrained")>=0,a=e.indexOf("invert-connects")>=0,c=e.indexOf("drag-all")>=0,u=e.indexOf("smooth-steps")>=0;if(r){if(t.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");uo(t,t.start[1]-t.start[0])}if(a&&t.handles!==2)throw new Error("noUiSlider: 'invert-connects' behaviour must be used with 2 handles");if(l&&(t.margin||t.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:n||s,drag:i,dragAll:c,smoothSteps:u,fixed:r,snap:s,hover:o,unconstrained:l,invertConnects:a}}function kf(t,e){if(e!==!1)if(e===!0||Ti(e)){t.tooltips=[];for(var n=0;n<t.handles;n++)t.tooltips.push(e)}else{if(e=Ni(e),e.length!==t.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");e.forEach(function(i){if(typeof i!="boolean"&&!Ti(i))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),t.tooltips=e}}function Ef(t,e){if(e.length!==t.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");t.handleAttributes=e}function Cf(t,e){if(!Ti(e))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");t.ariaFormat=e}function If(t,e){if(!Yu(e))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");t.format=e}function Mf(t,e){if(typeof e!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");t.keyboardSupport=e}function xf(t,e){t.documentElement=e}function Af(t,e){if(typeof e!="string"&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function Tf(t,e){if(typeof e!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof t.cssPrefix=="string"?(t.cssClasses={},Object.keys(e).forEach(function(n){t.cssClasses[n]=t.cssPrefix+e[n]})):t.cssClasses=e}function fo(t){var e={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:lo,format:lo},n={step:{r:!1,t:cf},keyboardPageMultiplier:{r:!1,t:uf},keyboardMultiplier:{r:!1,t:ff},keyboardDefaultStep:{r:!1,t:df},start:{r:!0,t:mf},connect:{r:!0,t:co},direction:{r:!0,t:wf},snap:{r:!1,t:pf},animate:{r:!1,t:gf},animationDuration:{r:!1,t:_f},range:{r:!0,t:hf},orientation:{r:!1,t:vf},margin:{r:!1,t:uo},limit:{r:!1,t:yf},padding:{r:!1,t:bf},behaviour:{r:!0,t:Sf},ariaFormat:{r:!1,t:Cf},format:{r:!1,t:If},tooltips:{r:!1,t:kf},keyboardSupport:{r:!0,t:Mf},documentElement:{r:!1,t:xf},cssPrefix:{r:!0,t:Af},cssClasses:{r:!0,t:Tf},handleAttributes:{r:!1,t:Ef}},i={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:ao,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};t.format&&!t.ariaFormat&&(t.ariaFormat=t.format),Object.keys(n).forEach(function(a){if(!Cr(t[a])&&i[a]===void 0){if(n[a].r)throw new Error("noUiSlider: '"+a+"' is required.");return}n[a].t(e,Cr(t[a])?t[a]:i[a])}),e.pips=t.pips;var r=document.createElement("div"),s=r.style.msTransform!==void 0,o=r.style.transform!==void 0;e.transformRule=o?"transform":s?"msTransform":"webkitTransform";var l=[["left","top"],["right","bottom"]];return e.style=l[e.dir][e.ort],e}function Nf(t,e,n){var i=ef(),r=nf(),s=r&&tf(),o=t,l,a,c,u,d,f,h=e.spectrum,m=[],p=[],g=[],_=0,S={},E=!1,w=t.ownerDocument,k=e.documentElement||w.documentElement,T=w.body,M=w.dir==="rtl"||e.ort===1?0:100;function C(A,N){var j=w.createElement("div");return N&&mt(j,N),A.appendChild(j),j}function x(A,N){var j=C(A,e.cssClasses.origin),G=C(j,e.cssClasses.handle);if(C(G,e.cssClasses.touchArea),G.setAttribute("data-handle",String(N)),e.keyboardSupport&&(G.setAttribute("tabindex","0"),G.addEventListener("keydown",function(ie){return Ve(ie,N)})),e.handleAttributes!==void 0){var ne=e.handleAttributes[N];Object.keys(ne).forEach(function(ie){G.setAttribute(ie,ne[ie])})}return G.setAttribute("role","slider"),G.setAttribute("aria-orientation",e.ort?"vertical":"horizontal"),N===0?mt(G,e.cssClasses.handleLower):N===e.handles-1&&mt(G,e.cssClasses.handleUpper),j.handle=G,j}function P(A,N){return N?C(A,e.cssClasses.connect):!1}function L(A,N){a=C(N,e.cssClasses.connects),c=[],u=[],u.push(P(a,A[0]));for(var j=0;j<e.handles;j++)c.push(x(N,j)),g[j]=j,u.push(P(a,A[j+1]))}function H(A){mt(A,e.cssClasses.target),e.dir===0?mt(A,e.cssClasses.ltr):mt(A,e.cssClasses.rtl),e.ort===0?mt(A,e.cssClasses.horizontal):mt(A,e.cssClasses.vertical);var N=getComputedStyle(A).direction;return N==="rtl"?mt(A,e.cssClasses.textDirectionRtl):mt(A,e.cssClasses.textDirectionLtr),C(A,e.cssClasses.base)}function $(A,N){return!e.tooltips||!e.tooltips[N]?!1:C(A.firstChild,e.cssClasses.tooltip)}function I(){return o.hasAttribute("disabled")}function R(A){var N=c[A];return N.hasAttribute("disabled")}function O(A){A!=null?(c[A].setAttribute("disabled",""),c[A].handle.removeAttribute("tabindex")):(o.setAttribute("disabled",""),c.forEach(function(N){N.handle.removeAttribute("tabindex")}))}function V(A){A!=null?(c[A].removeAttribute("disabled"),c[A].handle.setAttribute("tabindex","0")):(o.removeAttribute("disabled"),c.forEach(function(N){N.removeAttribute("disabled"),N.handle.setAttribute("tabindex","0")}))}function q(){f&&(Re("update"+mn.tooltips),f.forEach(function(A){A&&to(A)}),f=null)}function B(){q(),f=c.map($),fe("update"+mn.tooltips,function(A,N,j){if(!(!f||!e.tooltips)&&f[N]!==!1){var G=A[N];e.tooltips[N]!==!0&&(G=e.tooltips[N].to(j[N])),f[N].innerHTML=G}})}function Y(){Re("update"+mn.aria),fe("update"+mn.aria,function(A,N,j,G,ne){g.forEach(function(ie){var ve=c[ie],ce=zt(p,ie,0,!0,!0,!0),Ke=zt(p,ie,100,!0,!0,!0),We=ne[ie],Je=String(e.ariaFormat.to(j[ie]));ce=h.fromStepping(ce).toFixed(1),Ke=h.fromStepping(Ke).toFixed(1),We=h.fromStepping(We).toFixed(1),ve.children[0].setAttribute("aria-valuemin",ce),ve.children[0].setAttribute("aria-valuemax",Ke),ve.children[0].setAttribute("aria-valuenow",We),ve.children[0].setAttribute("aria-valuetext",Je)})})}function oe(A){if(A.mode===hn.Range||A.mode===hn.Steps)return h.xVal;if(A.mode===hn.Count){if(A.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var N=A.values-1,j=100/N,G=[];N--;)G[N]=N*j;return G.push(100),se(G,A.stepped)}return A.mode===hn.Positions?se(A.values,A.stepped):A.mode===hn.Values?A.stepped?A.values.map(function(ne){return h.fromStepping(h.getStep(h.toStepping(ne)))}):A.values:[]}function se(A,N){return A.map(function(j){return h.fromStepping(N?h.getStep(j):j)})}function ae(A){function N(We,Je){return Number((We+Je).toFixed(7))}var j=oe(A),G={},ne=h.xVal[0],ie=h.xVal[h.xVal.length-1],ve=!1,ce=!1,Ke=0;return j=Gu(j.slice().sort(function(We,Je){return We-Je})),j[0]!==ne&&(j.unshift(ne),ve=!0),j[j.length-1]!==ie&&(j.push(ie),ce=!0),j.forEach(function(We,Je){var Qe,Be,tt,_t=We,st=j[Je+1],dt,bs,ws,Ss,Rc,ks,Dc,$c=A.mode===hn.Steps;for($c&&(Qe=h.xNumSteps[Je]),Qe||(Qe=st-_t),st===void 0&&(st=_t),Qe=Math.max(Qe,1e-7),Be=_t;Be<=st;Be=N(Be,Qe)){for(dt=h.toStepping(Be),bs=dt-Ke,Rc=bs/(A.density||1),ks=Math.round(Rc),Dc=bs/ks,tt=1;tt<=ks;tt+=1)ws=Ke+tt*Dc,G[ws.toFixed(5)]=[h.fromStepping(ws),0];Ss=j.indexOf(Be)>-1?yt.LargeValue:$c?yt.SmallValue:yt.NoValue,!Je&&ve&&Be!==st&&(Ss=0),Be===st&&ce||(G[dt.toFixed(5)]=[Be,Ss]),Ke=dt}}),G}function Q(A,N,j){var G,ne,ie=w.createElement("div"),ve=(G={},G[yt.None]="",G[yt.NoValue]=e.cssClasses.valueNormal,G[yt.LargeValue]=e.cssClasses.valueLarge,G[yt.SmallValue]=e.cssClasses.valueSub,G),ce=(ne={},ne[yt.None]="",ne[yt.NoValue]=e.cssClasses.markerNormal,ne[yt.LargeValue]=e.cssClasses.markerLarge,ne[yt.SmallValue]=e.cssClasses.markerSub,ne),Ke=[e.cssClasses.valueHorizontal,e.cssClasses.valueVertical],We=[e.cssClasses.markerHorizontal,e.cssClasses.markerVertical];mt(ie,e.cssClasses.pips),mt(ie,e.ort===0?e.cssClasses.pipsHorizontal:e.cssClasses.pipsVertical);function Je(Be,tt){var _t=tt===e.cssClasses.value,st=_t?Ke:We,dt=_t?ve:ce;return tt+" "+st[e.ort]+" "+dt[Be]}function Qe(Be,tt,_t){if(_t=N?N(tt,_t):_t,_t!==yt.None){var st=C(ie,!1);st.className=Je(_t,e.cssClasses.marker),st.style[e.style]=Be+"%",_t>yt.NoValue&&(st=C(ie,!1),st.className=Je(_t,e.cssClasses.value),st.setAttribute("data-value",String(tt)),st.style[e.style]=Be+"%",st.innerHTML=String(j.to(tt)))}}return Object.keys(A).forEach(function(Be){Qe(Be,A[Be][0],A[Be][1])}),ie}function ue(){d&&(to(d),d=null)}function ge(A){ue();var N=ae(A),j=A.filter,G=A.format||{to:function(ne){return String(Math.round(ne))}};return d=o.appendChild(Q(N,j,G)),d}function te(){var A=l.getBoundingClientRect(),N="offset"+["Width","Height"][e.ort];return e.ort===0?A.width||l[N]:A.height||l[N]}function le(A,N,j,G){var ne=function(ve){var ce=Z(ve,G.pageOffset,G.target||N);if(!ce||I()&&!G.doNotReject||Zu(o,e.cssClasses.tap)&&!G.doNotReject||A===i.start&&ce.buttons!==void 0&&ce.buttons>1||G.hover&&ce.buttons)return!1;s||ce.preventDefault(),ce.calcPoint=ce.points[e.ort],j(ce,G)},ie=[];return A.split(" ").forEach(function(ve){N.addEventListener(ve,ne,s?{passive:!0}:!1),ie.push([ve,ne])}),ie}function Z(A,N,j){var G=A.type.indexOf("touch")===0,ne=A.type.indexOf("mouse")===0,ie=A.type.indexOf("pointer")===0,ve=0,ce=0;if(A.type.indexOf("MSPointer")===0&&(ie=!0),A.type==="mousedown"&&!A.buttons&&!A.touches)return!1;if(G){var Ke=function(Qe){var Be=Qe.target;return Be===j||j.contains(Be)||A.composed&&A.composedPath().shift()===j};if(A.type==="touchstart"){var We=Array.prototype.filter.call(A.touches,Ke);if(We.length>1)return!1;ve=We[0].pageX,ce=We[0].pageY}else{var Je=Array.prototype.find.call(A.changedTouches,Ke);if(!Je)return!1;ve=Je.pageX,ce=Je.pageY}}return N=N||so(w),(ne||ie)&&(ve=A.clientX+N.x,ce=A.clientY+N.y),A.pageOffset=N,A.points=[ve,ce],A.cursor=ne||ie,A}function J(A){var N=A-Ju(l,e.ort),j=N*100/te();return j=ro(j),e.dir?100-j:j}function Le(A){var N=100,j=!1;return c.forEach(function(G,ne){if(!R(ne)){var ie=p[ne],ve=Math.abs(ie-A),ce=ve===100&&N===100,Ke=ve<N,We=ve<=N&&A>ie;(Ke||We||ce)&&(j=ne,N=ve)}}),j}function _e(A,N){A.type==="mouseout"&&A.target.nodeName==="HTML"&&A.relatedTarget===null&&He(A,N)}function Ne(A,N){if(navigator.appVersion.indexOf("MSIE 9")===-1&&A.buttons===0&&N.buttonsProperty!==0)return He(A,N);var j=(e.dir?-1:1)*(A.calcPoint-N.startCalcPoint),G=j*100/N.baseSize;vn(j>0,G,N.locations,N.handleNumbers,N.connect)}function He(A,N){N.handle&&(Oi(N.handle,e.cssClasses.active),_-=1),N.listeners.forEach(function(j){k.removeEventListener(j[0],j[1])}),_===0&&(Oi(o,e.cssClasses.drag),it(),A.cursor&&(T.style.cursor="",T.removeEventListener("selectstart",no))),e.events.smoothSteps&&(N.handleNumbers.forEach(function(j){rt(j,p[j],!0,!0,!1,!1)}),N.handleNumbers.forEach(function(j){Oe("update",j)})),N.handleNumbers.forEach(function(j){Oe("change",j),Oe("set",j),Oe("end",j)})}function pe(A,N){if(!N.handleNumbers.some(R)){var j;if(N.handleNumbers.length===1){var G=c[N.handleNumbers[0]];j=G.children[0],_+=1,mt(j,e.cssClasses.active)}A.stopPropagation();var ne=[],ie=le(i.move,k,Ne,{target:A.target,handle:j,connect:N.connect,listeners:ne,startCalcPoint:A.calcPoint,baseSize:te(),pageOffset:A.pageOffset,handleNumbers:N.handleNumbers,buttonsProperty:A.buttons,locations:p.slice()}),ve=le(i.end,k,He,{target:A.target,handle:j,listeners:ne,doNotReject:!0,handleNumbers:N.handleNumbers}),ce=le("mouseout",k,_e,{target:A.target,handle:j,listeners:ne,doNotReject:!0,handleNumbers:N.handleNumbers});ne.push.apply(ne,ie.concat(ve,ce)),A.cursor&&(T.style.cursor=getComputedStyle(A.target).cursor,c.length>1&&mt(o,e.cssClasses.drag),T.addEventListener("selectstart",no,!1)),N.handleNumbers.forEach(function(Ke){Oe("start",Ke)})}}function Fe(A){A.stopPropagation();var N=J(A.calcPoint),j=Le(N);j!==!1&&(e.events.snap||io(o,e.cssClasses.tap,e.animationDuration),rt(j,N,!0,!0),it(),Oe("slide",j,!0),Oe("update",j,!0),e.events.snap?pe(A,{handleNumbers:[j]}):(Oe("change",j,!0),Oe("set",j,!0)))}function $e(A){var N=J(A.calcPoint),j=h.getStep(N),G=h.fromStepping(j);Object.keys(S).forEach(function(ne){ne.split(".")[0]==="hover"&&S[ne].forEach(function(ie){ie.call(Kt,G)})})}function Ve(A,N){if(I()||R(N))return!1;var j=["Left","Right"],G=["Down","Up"],ne=["PageDown","PageUp"],ie=["Home","End"];e.dir&&!e.ort?j.reverse():e.ort&&!e.dir&&(G.reverse(),ne.reverse());var ve=A.key.replace("Arrow",""),ce=ve===ne[0],Ke=ve===ne[1],We=ve===G[0]||ve===j[0]||ce,Je=ve===G[1]||ve===j[1]||Ke,Qe=ve===ie[0],Be=ve===ie[1];if(!We&&!Je&&!Qe&&!Be)return!0;A.preventDefault();var tt;if(Je||We){var _t=We?0:1,st=ke(N),dt=st[_t];if(dt===null)return!1;dt===!1&&(dt=h.getDefaultStep(p[N],We,e.keyboardDefaultStep)),Ke||ce?dt*=e.keyboardPageMultiplier:dt*=e.keyboardMultiplier,dt=Math.max(dt,1e-7),dt=(We?-1:1)*dt,tt=m[N]+dt}else Be?tt=e.spectrum.xVal[e.spectrum.xVal.length-1]:tt=e.spectrum.xVal[0];return rt(N,h.toStepping(tt),!0,!0),Oe("slide",N),Oe("update",N),Oe("change",N),Oe("set",N),!1}function ye(A){A.fixed||c.forEach(function(N,j){le(i.start,N.children[0],pe,{handleNumbers:[j]})}),A.tap&&le(i.start,l,Fe,{}),A.hover&&le(i.move,l,$e,{hover:!0}),A.drag&&u.forEach(function(N,j){if(!(N===!1||j===0||j===u.length-1)){var G=c[j-1],ne=c[j],ie=[N],ve=[G,ne],ce=[j-1,j];mt(N,e.cssClasses.draggable),A.fixed&&(ie.push(G.children[0]),ie.push(ne.children[0])),A.dragAll&&(ve=c,ce=g),ie.forEach(function(Ke){le(i.start,Ke,pe,{handles:ve,handleNumbers:ce,connect:N})})}})}function fe(A,N){S[A]=S[A]||[],S[A].push(N),A.split(".")[0]==="update"&&c.forEach(function(j,G){Oe("update",G)})}function Ge(A){return A===mn.aria||A===mn.tooltips}function Re(A){var N=A&&A.split(".")[0],j=N?A.substring(N.length):A;Object.keys(S).forEach(function(G){var ne=G.split(".")[0],ie=G.substring(ne.length);(!N||N===ne)&&(!j||j===ie)&&(!Ge(ie)||j===ie)&&delete S[G]})}function Oe(A,N,j){Object.keys(S).forEach(function(G){var ne=G.split(".")[0];A===ne&&S[G].forEach(function(ie){ie.call(Kt,m.map(e.format.to),N,m.slice(),j||!1,p.slice(),Kt)})})}function zt(A,N,j,G,ne,ie,ve){var ce;return c.length>1&&!e.events.unconstrained&&(G&&N>0&&(ce=h.getAbsoluteDistance(A[N-1],e.margin,!1),j=Math.max(j,ce)),ne&&N<c.length-1&&(ce=h.getAbsoluteDistance(A[N+1],e.margin,!0),j=Math.min(j,ce))),c.length>1&&e.limit&&(G&&N>0&&(ce=h.getAbsoluteDistance(A[N-1],e.limit,!1),j=Math.min(j,ce)),ne&&N<c.length-1&&(ce=h.getAbsoluteDistance(A[N+1],e.limit,!0),j=Math.max(j,ce))),e.padding&&(N===0&&(ce=h.getAbsoluteDistance(0,e.padding[0],!1),j=Math.max(j,ce)),N===c.length-1&&(ce=h.getAbsoluteDistance(100,e.padding[1],!0),j=Math.min(j,ce))),ve||(j=h.getStep(j)),j=ro(j),j===A[N]&&!ie?!1:j}function Ye(A,N){var j=e.ort;return(j?N:A)+", "+(j?A:N)}function vn(A,N,j,G,ne){var ie=j.slice(),ve=G[0],ce=e.events.smoothSteps,Ke=[!A,A],We=[A,!A];G=G.slice(),A&&G.reverse(),G.length>1?G.forEach(function(Qe,Be){var tt=zt(ie,Qe,ie[Qe]+N,Ke[Be],We[Be],!1,ce);tt===!1?N=0:(N=tt-ie[Qe],ie[Qe]=tt)}):Ke=We=[!0];var Je=!1;G.forEach(function(Qe,Be){Je=rt(Qe,j[Qe]+N,Ke[Be],We[Be],!1,ce)||Je}),Je&&(G.forEach(function(Qe){Oe("update",Qe),Oe("slide",Qe)}),ne!=null&&Oe("drag",ve))}function gt(A,N){return e.dir?100-A-N:A}function kt(A,N){p[A]=N,m[A]=h.fromStepping(N);var j=gt(N,0)-M,G="translate("+Ye(j+"%","0")+")";if(c[A].style[e.transformRule]=G,e.events.invertConnects&&p.length>1){var ne=p.every(function(ie,ve,ce){return ve===0||ie>=ce[ve-1]});if(E!==!ne){Ie();return}}Ue(A),Ue(A+1),E&&(Ue(A-1),Ue(A+2))}function it(){g.forEach(function(A){var N=p[A]>50?-1:1,j=3+(c.length+N*A);c[A].style.zIndex=String(j)})}function rt(A,N,j,G,ne,ie){return ne||(N=zt(p,A,N,j,G,!1,ie)),N===!1?!1:(kt(A,N),!0)}function Ue(A){if(u[A]){var N=p.slice();E&&N.sort(function(ce,Ke){return ce-Ke});var j=0,G=100;A!==0&&(j=N[A-1]),A!==u.length-1&&(G=N[A]);var ne=G-j,ie="translate("+Ye(gt(j,ne)+"%","0")+")",ve="scale("+Ye(ne/100,"1")+")";u[A].style[e.transformRule]=ie+" "+ve}}function Xn(A,N){return A===null||A===!1||A===void 0||(typeof A=="number"&&(A=String(A)),A=e.format.from(A),A!==!1&&(A=h.toStepping(A)),A===!1||isNaN(A))?p[N]:A}function Zt(A,N,j){var G=Ni(A),ne=p[0]===void 0;N=N===void 0?!0:N,e.animate&&!ne&&io(o,e.cssClasses.tap,e.animationDuration),g.forEach(function(ce){rt(ce,Xn(G[ce],ce),!0,!1,j)});var ie=g.length===1?0:1;if(ne&&h.hasNoSize()&&(j=!0,p[0]=0,g.length>1)){var ve=100/(g.length-1);g.forEach(function(ce){p[ce]=ce*ve})}for(;ie<g.length;++ie)g.forEach(function(ce){rt(ce,p[ce],!0,!0,j)});it(),g.forEach(function(ce){Oe("update",ce),G[ce]!==null&&N&&Oe("set",ce)})}function Et(A){Zt(e.start,A)}function In(A,N,j,G){if(A=Number(A),!(A>=0&&A<g.length))throw new Error("noUiSlider: invalid handle number, got: "+A);rt(A,Xn(N,A),!0,!0,G),Oe("update",A),j&&Oe("set",A)}function Tt(A){if(A===void 0&&(A=!1),A)return m.length===1?m[0]:m.slice(0);var N=m.map(e.format.to);return N.length===1?N[0]:N}function Mn(){for(Re(mn.aria),Re(mn.tooltips),Object.keys(e.cssClasses).forEach(function(A){Oi(o,e.cssClasses[A])});o.firstChild;)o.removeChild(o.firstChild);delete o.noUiSlider}function ke(A){var N=p[A],j=h.getNearbySteps(N),G=m[A],ne=j.thisStep.step,ie=null;if(e.snap)return[G-j.stepBefore.startValue||null,j.stepAfter.startValue-G||null];ne!==!1&&G+ne>j.stepAfter.startValue&&(ne=j.stepAfter.startValue-G),G>j.thisStep.startValue?ie=j.thisStep.step:j.stepBefore.step===!1?ie=!1:ie=G-j.stepBefore.highestStep,N===100?ne=null:N===0&&(ie=null);var ve=h.countStepDecimals();return ne!==null&&ne!==!1&&(ne=Number(ne.toFixed(ve))),ie!==null&&ie!==!1&&(ie=Number(ie.toFixed(ve))),[ie,ne]}function Xe(){return g.map(ke)}function ft(A,N){var j=Tt(),G=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips","connect"];G.forEach(function(ie){A[ie]!==void 0&&(n[ie]=A[ie])});var ne=fo(n);G.forEach(function(ie){A[ie]!==void 0&&(e[ie]=ne[ie])}),h=ne.spectrum,e.margin=ne.margin,e.limit=ne.limit,e.padding=ne.padding,e.pips?ge(e.pips):ue(),e.tooltips?B():q(),p=[],Zt(Cr(A.start)?A.start:j,N),A.connect&&X()}function X(){for(;a.firstChild;)a.removeChild(a.firstChild);for(var A=0;A<=e.handles;A++)u[A]=P(a,e.connect[A]),Ue(A);ye({drag:e.events.drag,fixed:!0})}function Ie(){E=!E,co(e,e.connect.map(function(A){return!A})),X()}function qe(){l=H(o),L(e.connect,l),ye(e.events),Zt(e.start),e.pips&&ge(e.pips),e.tooltips&&B(),Y()}qe();var Kt={destroy:Mn,steps:Xe,on:fe,off:Re,get:Tt,set:Zt,setHandle:In,reset:Et,disable:O,enable:V,__moveHandles:function(A,N,j){vn(A,N,p,j)},options:n,updateOptions:ft,target:o,removePips:ue,removeTooltips:q,getPositions:function(){return p.slice()},getTooltips:function(){return f},getOrigins:function(){return c},pips:ge};return Kt}function Of(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var n=fo(e),i=Nf(t,n,e);return t.noUiSlider=i,i}const Pf={__spectrum:oo,cssClasses:ao,create:Of},qy="",Ky="";function Lf(t){let e,n,i;return{c(){e=b("span"),n=re(t[0]),v(e,"id",t[3]),v(e,"class",i="tooltip "+t[2]+" "+(t[1]?"display":"")+" svelte-1am23me")},m(r,s){z(r,e,s),y(e,n)},p(r,[s]){s&1&&Ee(n,r[0]),s&6&&i!==(i="tooltip "+r[2]+" "+(r[1]?"display":"")+" svelte-1am23me")&&v(e,"class",i)},i:ee,o:ee,d(r){r&&D(e)}}}function Rf(t,e,n){let i,r,s,o,{tooltipText:l}=e,{targetHtmlId:a}=e;const c=`tooltip-generic-${window.crypto.randomUUID()}`,u=()=>n(1,o=!0),d=()=>n(1,o=!1),f=()=>n(1,o=!o);return Nn(()=>{s=a?document.getElementById(a):document.getElementById(c).parentElement,a&&!s&&(console.error(`TooltipGeneric: element with ID ${a} not found, defaulting to the parent element`),s=document.getElementById(c).targetElement),s.addEventListener("mouseover",u),s.addEventListener("mouseout",d),s.addEventListener("click",f)}),On(()=>{s.removeEventListener("mouseover",u),s.removeEventListener("mouseout",d),s.removeEventListener("click",f)}),t.$$set=h=>{"tooltipText"in h&&n(0,l=h.tooltipText),"targetHtmlId"in h&&n(4,a=h.targetHtmlId)},t.$$.update=()=>{t.$$.dirty&33&&n(2,i=r(l))},n(5,r=h=>n(2,i=h.length>100?"tooltip-wide":h.length>20?"tooltip-mid":"tooltip-thin")),s=void 0,n(1,o=!1),[l,o,i,c,a,r]}class Pi extends Ae{constructor(e){super(),xe(this,e,Rf,Lf,Me,{tooltipText:0,targetHtmlId:4})}}const Wy="";function Df(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g;return{c(){e=b("div"),n=b("span"),i=re(t[2]),r=re(" ("),s=re(t[3]),o=re(")"),l=F(),a=b("div"),c=b("span"),u=re(t[0]),d=F(),f=b("div"),h=b("div"),m=F(),p=b("span"),g=re(t[1]),v(c,"class","range-marker svelte-216mtn"),v(h,"class","slider"),v(h,"id",t[4]),v(f,"class","slider-wrapper svelte-216mtn"),v(p,"class","range-marker svelte-216mtn"),v(a,"class","slider-outer-wrapper is-flex flex-direction-row svelte-216mtn")},m(_,S){z(_,e,S),y(e,n),y(n,i),y(n,r),y(n,s),y(n,o),y(e,l),y(e,a),y(a,c),y(c,u),y(a,d),y(a,f),y(f,h),y(a,m),y(a,p),y(p,g)},p(_,[S]){S&4&&Ee(i,_[2]),S&8&&Ee(s,_[3]),S&1&&Ee(u,_[0]),S&2&&Ee(g,_[1])},i:ee,o:ee,d(_){_&&D(e)}}}function $f(t,e,n){let i,{minVal:r}=e,{maxVal:s}=e,{start:o}=e,{step:l=void 0}=e,{roundTo:a=2}=e,{title:c=""}=e,{emitOnUpdate:u=!1}=e;const d=Ii(),f=`slider-${window.crypto.randomUUID()}`,h=Array.isArray(o)&&o.length===2&&o.every(C=>!isNaN(parseFloat(C))),m=[],p=h?[`noUi-handle-${window.crypto.randomUUID()}`,`noUi-handle-${window.crypto.randomUUID()}`]:[`noUi-handle-${window.crypto.randomUUID()}`],g=xi();g.setCompareFn(h?kr:(C,x)=>S(C)===S(x)),g.set(o);const _=Nt("resetTrigger")||void 0;_==null||_.subscribe(k);const S=C=>Number(C.toFixed(a)),E=(C,x)=>{C=Array.isArray(C)?C.map(S):S(C),n(3,i=C),(x==="set"||x==="update"&&u)&&(g.set(C),g.same()||d("updateSlider",g.get()))};function w(C){m.length&&m.map((x,P)=>x.$set({tooltipText:h?C[P]:C}))}function k(){const C=document.getElementById(f);C!=null&&C.noUiSlider&&C.noUiSlider.reset()}function T(){const C=document.getElementById(f);let x;Pf.create(C,{start:o,step:l,connect:h?!0:"lower",range:{min:r,max:s},handleAttributes:p.map(P=>({id:P}))}),C.noUiSlider.on("update",()=>{x=C.noUiSlider.get(!0),E(x,"update")}),C.noUiSlider.on("set",()=>{x=C.noUiSlider.get(!0),E(x,"set")})}function M(){p.map((C,x)=>{m.push(new Pi({target:document.getElementById(C),props:h?{tooltipText:i[x]}:{tooltipText:i}}))})}return Nn(()=>{T(),M()}),On(()=>{document.getElementById(f)&&(document.getElementById(f).innerHTML="")}),t.$$set=C=>{"minVal"in C&&n(0,r=C.minVal),"maxVal"in C&&n(1,s=C.maxVal),"start"in C&&n(5,o=C.start),"step"in C&&n(6,l=C.step),"roundTo"in C&&n(7,a=C.roundTo),"title"in C&&n(2,c=C.title),"emitOnUpdate"in C&&n(8,u=C.emitOnUpdate)},t.$$.update=()=>{t.$$.dirty&32&&n(3,i=o),t.$$.dirty&8&&w(i)},[r,s,c,i,f,o,l,a,u]}class yn extends Ae{constructor(e){super(),xe(this,e,$f,Df,Me,{minVal:0,maxVal:1,start:5,step:6,roundTo:7,title:2,emitOnUpdate:8})}}const zf=t=>({}),ho=t=>({});function mo(t,e,n){const i=t.slice();return i[42]=e[n],i}function po(t,e,n){const i=t.slice();return i[45]=e[n],i}function go(t,e,n){const i=t.slice();return i[42]=e[n],i}function _o(t,e,n){const i=t.slice();i[50]=e[n];const r=Object.keys(i[27][i[50]]||{});return i[51]=r,i}function vo(t){var ft;let e,n,i,r=((ft=t[0])==null?void 0:ft.title)+"",s,o,l,a,c,u,d,f,h,m=(t[3].pairs||0)+"",p,g,_,S,E,w,k,T=(t[3].images||0)+"",M,C,x,P,L,H,$,I=(t[4]||0)+"",R,O,V,q,B,Y,oe,se,ae,Q,ue,ge,te,le,Z,J,Le,_e,Ne,He,pe,Fe,$e,Ve,ye,fe,Ge,Re,Oe,zt,Ye,vn=["Series","Witness","Work"],gt=[];for(let X=0;X<3;X+=1)gt[X]=yo(_o(t,vn,X));B=new Wu({props:{documentNodes:t[5],selectedRegions:t[6],toggleRegion:t[17]}});let kt=["all","filtered"],it=[];for(let X=0;X<2;X+=1)it[X]=bo(go(t,kt,X));let rt=t[28],Ue=[];for(let X=0;X<rt.length;X+=1)Ue[X]=wo(po(t,rt,X));const Xn=X=>K(Ue[X],1,1,()=>{Ue[X]=null});let Zt=["threshold","topk"],Et=[];for(let X=0;X<2;X+=1)Et[X]=So(mo(t,Zt,X));const In=[Vf,Ff],Tt=[];function Mn(X,Ie){return X[7]==="threshold"?0:1}$e=Mn(t),Ve=Tt[$e]=In[$e](t);const ke=t[34].datavizInfo,Xe=Lt(ke,t,t[33],ho);return{c(){e=b("div"),n=b("div"),i=b("h1"),s=re(r),o=F(),l=b("div");for(let X=0;X<3;X+=1)gt[X].c();a=F(),c=b("div"),u=b("div"),d=b("p"),d.textContent=`${W==="en"?"Pairs":"Paires"}`,f=F(),h=b("p"),p=re(m),g=F(),_=b("div"),S=b("div"),E=b("p"),E.textContent="Images",w=F(),k=b("p"),M=re(T),C=F(),x=b("div"),P=b("div"),L=b("p"),L.textContent="Clusters",H=F(),$=b("p"),R=re(I),O=F(),V=b("hr"),q=F(),me(B.$$.fragment),Y=F(),oe=b("hr"),se=F(),ae=b("div"),Q=b("h3"),Q.textContent=`${W==="en"?"Similarity categories":"Catégories de similarité"}`,ue=F(),ge=b("div");for(let X=0;X<2;X+=1)it[X].c();te=F(),le=b("div");for(let X=0;X<Ue.length;X+=1)Ue[X].c();Z=F(),J=b("hr"),Le=F(),_e=b("div"),Ne=b("h3"),Ne.textContent=`${W==="en"?"Similarity score":"Score de similarité"}`,He=F(),pe=b("div");for(let X=0;X<2;X+=1)Et[X].c();Fe=F(),Ve.c(),ye=F(),fe=b("hr"),Ge=F(),Re=b("div"),Oe=b("h3"),Oe.textContent=`${W==="en"?"Visualisation information":"Informations sur la visualisation"}`,zt=F(),Xe&&Xe.c(),v(i,"class","title"),v(d,"class","heading"),v(h,"class","title is-5"),v(c,"class","level-item has-text-centered"),v(E,"class","heading"),v(k,"class","title is-5"),v(_,"class","level-item has-text-centered"),v(L,"class","heading"),v($,"class","title is-5"),v(x,"class","level-item has-text-centered"),v(l,"class","level"),v(n,"class","pb-2"),v(Q,"class","title"),v(ge,"class","buttons mb-3"),v(le,"class","level"),Pe(le,"is-disabled",t[1]==="all"),v(ae,"class","pt-2"),v(Ne,"class","title"),v(pe,"class","buttons mb-3"),v(_e,"class","pt-2"),v(Oe,"class","title"),v(Re,"class","py-2"),v(e,"class","content is-small mt-4")},m(X,Ie){z(X,e,Ie),y(e,n),y(n,i),y(i,s),y(n,o),y(n,l);for(let qe=0;qe<3;qe+=1)gt[qe]&&gt[qe].m(l,null);y(l,a),y(l,c),y(c,u),y(u,d),y(u,f),y(u,h),y(h,p),y(l,g),y(l,_),y(_,S),y(S,E),y(S,w),y(S,k),y(k,M),y(l,C),y(l,x),y(x,P),y(P,L),y(P,H),y(P,$),y($,R),y(e,O),y(e,V),y(e,q),de(B,e,null),y(e,Y),y(e,oe),y(e,se),y(e,ae),y(ae,Q),y(ae,ue),y(ae,ge);for(let qe=0;qe<2;qe+=1)it[qe]&&it[qe].m(ge,null);y(ae,te),y(ae,le);for(let qe=0;qe<Ue.length;qe+=1)Ue[qe]&&Ue[qe].m(le,null);y(e,Z),y(e,J),y(e,Le),y(e,_e),y(_e,Ne),y(_e,He),y(_e,pe);for(let qe=0;qe<2;qe+=1)Et[qe]&&Et[qe].m(pe,null);y(_e,Fe),Tt[$e].m(_e,null),y(e,ye),y(e,fe),y(e,Ge),y(e,Re),y(Re,Oe),y(Re,zt),Xe&&Xe.m(Re,null),Ye=!0},p(X,Ie){var A;if((!Ye||Ie[0]&1)&&r!==(r=((A=X[0])==null?void 0:A.title)+"")&&Ee(s,r),Ie[0]&134217728){vn=["Series","Witness","Work"];let N;for(N=0;N<3;N+=1){const j=_o(X,vn,N);gt[N]?gt[N].p(j,Ie):(gt[N]=yo(j),gt[N].c(),gt[N].m(l,a))}for(;N<3;N+=1)gt[N].d(1)}(!Ye||Ie[0]&8)&&m!==(m=(X[3].pairs||0)+"")&&Ee(p,m),(!Ye||Ie[0]&8)&&T!==(T=(X[3].images||0)+"")&&Ee(M,T),(!Ye||Ie[0]&16)&&I!==(I=(X[4]||0)+"")&&Ee(R,I);const qe={};if(Ie[0]&32&&(qe.documentNodes=X[5]),Ie[0]&64&&(qe.selectedRegions=X[6]),B.$set(qe),Ie[0]&536870914){kt=["all","filtered"];let N;for(N=0;N<2;N+=1){const j=go(X,kt,N);it[N]?it[N].p(j,Ie):(it[N]=bo(j),it[N].c(),it[N].m(ge,null))}for(;N<2;N+=1)it[N].d(1)}if(Ie[0]&268468238){rt=X[28];let N;for(N=0;N<rt.length;N+=1){const j=po(X,rt,N);Ue[N]?(Ue[N].p(j,Ie),U(Ue[N],1)):(Ue[N]=wo(j),Ue[N].c(),U(Ue[N],1),Ue[N].m(le,null))}for(ze(),N=rt.length;N<Ue.length;N+=1)Xn(N);je()}if((!Ye||Ie[0]&2)&&Pe(le,"is-disabled",X[1]==="all"),Ie[0]&1073741952){Zt=["threshold","topk"];let N;for(N=0;N<2;N+=1){const j=mo(X,Zt,N);Et[N]?Et[N].p(j,Ie):(Et[N]=So(j),Et[N].c(),Et[N].m(pe,null))}for(;N<2;N+=1)Et[N].d(1)}let Kt=$e;$e=Mn(X),$e===Kt?Tt[$e].p(X,Ie):(ze(),K(Tt[Kt],1,1,()=>{Tt[Kt]=null}),je(),Ve=Tt[$e],Ve?Ve.p(X,Ie):(Ve=Tt[$e]=In[$e](X),Ve.c()),U(Ve,1),Ve.m(_e,null)),Xe&&Xe.p&&(!Ye||Ie[1]&4)&&Dt(Xe,ke,X,X[33],Ye?Rt(ke,X[33],Ie,zf):$t(X[33]),ho)},i(X){if(!Ye){U(B.$$.fragment,X);for(let Ie=0;Ie<rt.length;Ie+=1)U(Ue[Ie]);U(Ve),U(Xe,X),Ye=!0}},o(X){K(B.$$.fragment,X),Ue=Ue.filter(Boolean);for(let Ie=0;Ie<Ue.length;Ie+=1)K(Ue[Ie]);K(Ve),K(Xe,X),Ye=!1},d(X){X&&D(e),at(gt,X),he(B),at(it,X),at(Ue,X),at(Et,X),Tt[$e].d(),Xe&&Xe.d(X)}}}function jf(t){let e,n,i,r=fu[t[50]]+"",s,o,l,a=(t[51].length||0)+"",c;return{c(){e=b("div"),n=b("div"),i=b("p"),s=re(r),o=F(),l=b("p"),c=re(a),v(i,"class","heading"),v(l,"class","title is-5"),v(e,"class","level-item has-text-centered")},m(u,d){z(u,e,d),y(e,n),y(n,i),y(i,s),y(n,o),y(n,l),y(l,c)},p:ee,d(u){u&&D(e)}}}function yo(t){let e,n=t[51].length>0&&jf(t);return{c(){n&&n.c(),e=ht()},m(i,r){n&&n.m(i,r),z(i,e,r)},p(i,r){i[51].length>0&&n.p(i,r)},d(i){n&&n.d(i),i&&D(e)}}}function bo(t){let e,n=t[42]==="all"?W==="en"?"All pairs":"Toutes les paires":W==="en"?"Filter by category":"Filtrer par catégorie",i,r,s,o;function l(){return t[35](t[42])}return{c(){e=b("button"),i=re(n),r=F(),v(e,"class","button is-small is-flex-grow-1"),Pe(e,"is-link",t[1]===t[42]),Pe(e,"is-contrasted",t[1]!==t[42])},m(a,c){z(a,e,c),y(e,i),y(e,r),s||(o=Se(e,"click",l),s=!0)},p(a,c){t=a,c[0]&2&&Pe(e,"is-link",t[1]===t[42]),c[0]&2&&Pe(e,"is-contrasted",t[1]!==t[42])},d(a){a&&D(e),s=!1,o()}}}function wo(t){let e,n,i,r,s,o=(t[3].categories[t[45]]||0)+"",l,a,c;return i=new Fn({props:{category:t[45],isSelected:t[2].includes(t[45]),toggle:t[36],selectable:t[1]==="filtered"}}),{c(){e=b("div"),n=b("div"),me(i.$$.fragment),r=F(),s=b("p"),l=re(o),a=F(),v(s,"class","is-size-7 mt-1"),v(e,"class","level-item has-text-centered")},m(u,d){z(u,e,d),y(e,n),de(i,n,null),y(n,r),y(n,s),y(s,l),y(e,a),c=!0},p(u,d){const f={};d[0]&4&&(f.isSelected=u[2].includes(u[45])),d[0]&2&&(f.toggle=u[36]),d[0]&2&&(f.selectable=u[1]==="filtered"),i.$set(f),(!c||d[0]&8)&&o!==(o=(u[3].categories[u[45]]||0)+"")&&Ee(l,o)},i(u){c||(U(i.$$.fragment,u),c=!0)},o(u){K(i.$$.fragment,u),c=!1},d(u){u&&D(e),he(i)}}}function So(t){let e,n=t[42]==="threshold"?W==="en"?"Score threshold":"Seuil de score":W==="en"?"Top K pairs":"Top K paires",i,r,s,o;function l(){return t[37](t[42])}return{c(){e=b("button"),i=re(n),r=F(),v(e,"class","button is-small is-flex-grow-1"),Pe(e,"is-link",t[7]===t[42]),Pe(e,"is-contrasted",t[7]!==t[42])},m(a,c){z(a,e,c),y(e,i),y(e,r),s||(o=Se(e,"click",l),s=!0)},p(a,c){t=a,c[0]&128&&Pe(e,"is-link",t[7]===t[42]),c[0]&128&&Pe(e,"is-contrasted",t[7]!==t[42])},d(a){a&&D(e),s=!1,o()}}}function Ff(t){let e,n,i,r,s,o,l,a,c,u,d,f;return i=new yn({props:{minVal:1,maxVal:5,start:t[10]||3,step:1,roundTo:0,title:"K"}}),i.$on("updateSlider",t[39]),{c(){e=b("div"),n=b("div"),me(i.$$.fragment),r=F(),s=b("div"),o=b("label"),l=b("input"),a=F(),c=b("span"),c.textContent=`${W==="en"?"Mutual top K":"Top K mutuel"}`,v(n,"class","column is-two-thirds pl-4"),l.checked=t[11],v(l,"type","checkbox"),v(l,"class","mr-2"),v(c,"class","is-size-7"),v(o,"class","checkbox mt-3 is-flex is-align-items-center"),v(s,"class","column mt-2"),v(e,"class","columns mt-2")},m(h,m){z(h,e,m),y(e,n),de(i,n,null),y(e,r),y(e,s),y(s,o),y(o,l),y(o,a),y(o,c),u=!0,d||(f=Se(l,"change",t[40]),d=!0)},p(h,m){const p={};m[0]&1024&&(p.start=h[10]||3),i.$set(p),(!u||m[0]&2048)&&(l.checked=h[11])},i(h){u||(U(i.$$.fragment,h),u=!0)},o(h){K(i.$$.fragment,h),u=!1},d(h){h&&D(e),he(i),d=!1,f()}}}function Vf(t){var i,r;let e,n;return e=new yn({props:{minVal:((i=t[8].scoreRange)==null?void 0:i.min)||0,maxVal:((r=t[8].scoreRange)==null?void 0:r.max)||1,start:t[9],step:.01,roundTo:2,title:W==="en"?"Minimum score":"Score minimum"}}),e.$on("updateSlider",t[38]),{c(){me(e.$$.fragment)},m(s,o){de(e,s,o),n=!0},p(s,o){var a,c;const l={};o[0]&256&&(l.minVal=((a=s[8].scoreRange)==null?void 0:a.min)||0),o[0]&256&&(l.maxVal=((c=s[8].scoreRange)==null?void 0:c.max)||1),o[0]&512&&(l.start=s[9]),e.$set(l)},i(s){n||(U(e.$$.fragment,s),n=!0)},o(s){K(e.$$.fragment,s),n=!1},d(s){he(e,s)}}}function Hf(t){let e,n,i=t[3]&&vo(t);return{c(){e=b("div"),i&&i.c(),v(e,"class","m-4 py-5 px-4")},m(r,s){z(r,e,s),i&&i.m(e,null),n=!0},p(r,s){r[3]?i?(i.p(r,s),s[0]&8&&U(i,1)):(i=vo(r),i.c(),U(i,1),i.m(e,null)):i&&(ze(),K(i,1,1,()=>{i=null}),je())},i(r){n||(U(i),n=!0)},o(r){K(i),n=!1},d(r){r&&D(e),i&&i.d()}}}function Uf(t,e,n){let i,r,s,o,l,a,c,u,d,f,{$$slots:h={},$$scope:m}=e,{docSet:p=null}=e,{documentSetStore:g}=e,{clusterStore:_}=e;const{docSetNumber:S,documentNodes:E,selectedCategories:w,toggleCategory:k,selectedRegions:T,toggleRegion:M,threshold:C,setThreshold:x,topK:P,setTopK:L,mutualTopK:H,setMutualTopK:$,scoreMode:I,setScoreMode:R,pairStats:O}=g;we(t,S,Z=>n(3,r=Z)),we(t,E,Z=>n(5,o=Z)),we(t,w,Z=>n(2,i=Z)),we(t,T,Z=>n(6,l=Z)),we(t,C,Z=>n(9,u=Z)),we(t,P,Z=>n(10,d=Z)),we(t,H,Z=>n(11,f=Z)),we(t,I,Z=>n(7,a=Z)),we(t,O,Z=>n(8,c=Z));const{clusterNb:V}=_;we(t,V,Z=>n(4,s=Z));const q=Nt("selectedDocuments"),B=[0,1,2,3,5];let Y="all";function oe(Z){n(1,Y=Z),Z==="all"&&i.length!==B.length&&w.set(B)}function se(Z){R(Z)}const ae=Z=>oe(Z),Q=Z=>Y==="filtered"?k(Z):null,ue=Z=>se(Z),ge=Z=>x(Z.detail),te=Z=>L(Z.detail),le=()=>$(!f);return t.$$set=Z=>{"docSet"in Z&&n(0,p=Z.docSet),"documentSetStore"in Z&&n(31,g=Z.documentSetStore),"clusterStore"in Z&&n(32,_=Z.clusterStore),"$$scope"in Z&&n(33,m=Z.$$scope)},[p,Y,i,r,s,o,l,a,c,u,d,f,S,E,w,k,T,M,C,x,P,L,H,$,I,O,V,q,B,oe,se,g,_,m,h,ae,Q,ue,ge,te,le]}class Bf extends Ae{constructor(e){super(),xe(this,e,Uf,Hf,Me,{docSet:0,documentSetStore:31,clusterStore:32},null,[-1,-1])}}function Li(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qf(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ko(t){let e,n,i;t.length!==2?(e=Li,n=(l,a)=>Li(t(l),a),i=(l,a)=>t(l)-a):(e=t===Li||t===qf?t:Kf,n=t,i=t);function r(l,a,c=0,u=l.length){if(c<u){if(e(a,a)!==0)return u;do{const d=c+u>>>1;n(l[d],a)<0?c=d+1:u=d}while(c<u)}return c}function s(l,a,c=0,u=l.length){if(c<u){if(e(a,a)!==0)return u;do{const d=c+u>>>1;n(l[d],a)<=0?c=d+1:u=d}while(c<u)}return c}function o(l,a,c=0,u=l.length){const d=r(l,a,c,u-1);return d>c&&i(l[d-1],a)>-i(l[d],a)?d-1:d}return{left:r,center:o,right:s}}function Kf(){return 0}function Wf(t){return t===null?NaN:+t}const Yf=ko(Li).right;ko(Wf).center;const Gf=Yf;class Eo extends Map{constructor(e,n=Qf){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,r]of e)this.set(i,r)}get(e){return super.get(Co(this,e))}has(e){return super.has(Co(this,e))}set(e,n){return super.set(Xf(this,e),n)}delete(e){return super.delete(Jf(this,e))}}function Co({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function Xf({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function Jf({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function Qf(t){return t!==null&&typeof t=="object"?t.valueOf():t}const Zf=Math.sqrt(50),ed=Math.sqrt(10),td=Math.sqrt(2);function Ri(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=Zf?10:s>=ed?5:s>=td?2:1;let l,a,c;return r<0?(c=Math.pow(10,-r)/o,l=Math.round(t*c),a=Math.round(e*c),l/c<t&&++l,a/c>e&&--a,c=-c):(c=Math.pow(10,r)*o,l=Math.round(t/c),a=Math.round(e/c),l*c<t&&++l,a*c>e&&--a),a<l&&.5<=n&&n<2?Ri(t,e,n*2):[l,a,c]}function nd(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[r,s,o]=i?Ri(e,t,n):Ri(t,e,n);if(!(s>=r))return[];const l=s-r+1,a=new Array(l);if(i)if(o<0)for(let c=0;c<l;++c)a[c]=(s-c)/-o;else for(let c=0;c<l;++c)a[c]=(s-c)*o;else if(o<0)for(let c=0;c<l;++c)a[c]=(r+c)/-o;else for(let c=0;c<l;++c)a[c]=(r+c)*o;return a}function xr(t,e,n){return e=+e,t=+t,n=+n,Ri(t,e,n)[2]}function id(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?xr(e,t,n):xr(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}function Di(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(r);++i<r;)s[i]=t+i*n;return s}function rd(t){return t}var $i=1,Ar=2,Io=3,ii=4,Mo=1e-6;function sd(t){return"translate("+t+",0)"}function od(t){return"translate(0,"+t+")"}function ld(t){return e=>+t(e)}function ad(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function cd(){return!this.__axis}function xo(t,e){var n=[],i=null,r=null,s=6,o=6,l=3,a=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=t===$i||t===ii?-1:1,u=t===ii||t===Ar?"x":"y",d=t===$i||t===Io?sd:od;function f(h){var m=i??(e.ticks?e.ticks.apply(e,n):e.domain()),p=r??(e.tickFormat?e.tickFormat.apply(e,n):rd),g=Math.max(s,0)+l,_=e.range(),S=+_[0]+a,E=+_[_.length-1]+a,w=(e.bandwidth?ad:ld)(e.copy(),a),k=h.selection?h.selection():h,T=k.selectAll(".domain").data([null]),M=k.selectAll(".tick").data(m,e).order(),C=M.exit(),x=M.enter().append("g").attr("class","tick"),P=M.select("line"),L=M.select("text");T=T.merge(T.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),M=M.merge(x),P=P.merge(x.append("line").attr("stroke","currentColor").attr(u+"2",c*s)),L=L.merge(x.append("text").attr("fill","currentColor").attr(u,c*g).attr("dy",t===$i?"0em":t===Io?"0.71em":"0.32em")),h!==k&&(T=T.transition(h),M=M.transition(h),P=P.transition(h),L=L.transition(h),C=C.transition(h).attr("opacity",Mo).attr("transform",function(H){return isFinite(H=w(H))?d(H+a):this.getAttribute("transform")}),x.attr("opacity",Mo).attr("transform",function(H){var $=this.parentNode.__axis;return d(($&&isFinite($=$(H))?$:w(H))+a)})),C.remove(),T.attr("d",t===ii||t===Ar?o?"M"+c*o+","+S+"H"+a+"V"+E+"H"+c*o:"M"+a+","+S+"V"+E:o?"M"+S+","+c*o+"V"+a+"H"+E+"V"+c*o:"M"+S+","+a+"H"+E),M.attr("opacity",1).attr("transform",function(H){return d(w(H)+a)}),P.attr(u+"2",c*s),L.attr(u,c*g).text(p),k.filter(cd).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ar?"start":t===ii?"end":"middle"),k.each(function(){this.__axis=w})}return f.scale=function(h){return arguments.length?(e=h,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),f):n.slice()},f.tickValues=function(h){return arguments.length?(i=h==null?null:Array.from(h),f):i&&i.slice()},f.tickFormat=function(h){return arguments.length?(r=h,f):r},f.tickSize=function(h){return arguments.length?(s=o=+h,f):s},f.tickSizeInner=function(h){return arguments.length?(s=+h,f):s},f.tickSizeOuter=function(h){return arguments.length?(o=+h,f):o},f.tickPadding=function(h){return arguments.length?(l=+h,f):l},f.offset=function(h){return arguments.length?(a=+h,f):a},f}function ud(t){return xo($i,t)}function fd(t){return xo(ii,t)}var dd={value:()=>{}};function ri(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new zi(n)}function zi(t){this._=t}function hd(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}zi.prototype=ri.prototype={constructor:zi,on:function(t,e){var n=this._,i=hd(t+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(t=i[s]).type)&&(r=md(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(r=(t=i[s]).type)n[r]=Ao(n[r],t.name,e);else if(e==null)for(r in n)n[r]=Ao(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new zi(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function md(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function Ao(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=dd,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var Tr="http://www.w3.org/1999/xhtml";const To={svg:"http://www.w3.org/2000/svg",xhtml:Tr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ji(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),To.hasOwnProperty(e)?{space:To[e],local:t}:t}function pd(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Tr&&e.documentElement.namespaceURI===Tr?e.createElement(t):e.createElementNS(n,t)}}function gd(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function No(t){var e=ji(t);return(e.local?gd:pd)(e)}function _d(){}function Nr(t){return t==null?_d:function(){return this.querySelector(t)}}function vd(t){typeof t!="function"&&(t=Nr(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],o=s.length,l=i[r]=new Array(o),a,c,u=0;u<o;++u)(a=s[u])&&(c=t.call(a,a.__data__,u,s))&&("__data__"in a&&(c.__data__=a.__data__),l[u]=c);return new Ot(i,this._parents)}function yd(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function bd(){return[]}function Oo(t){return t==null?bd:function(){return this.querySelectorAll(t)}}function wd(t){return function(){return yd(t.apply(this,arguments))}}function Sd(t){typeof t=="function"?t=wd(t):t=Oo(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o=e[s],l=o.length,a,c=0;c<l;++c)(a=o[c])&&(i.push(t.call(a,a.__data__,c,o)),r.push(a));return new Ot(i,r)}function Po(t){return function(){return this.matches(t)}}function Lo(t){return function(e){return e.matches(t)}}var kd=Array.prototype.find;function Ed(t){return function(){return kd.call(this.children,t)}}function Cd(){return this.firstElementChild}function Id(t){return this.select(t==null?Cd:Ed(typeof t=="function"?t:Lo(t)))}var Md=Array.prototype.filter;function xd(){return Array.from(this.children)}function Ad(t){return function(){return Md.call(this.children,t)}}function Td(t){return this.selectAll(t==null?xd:Ad(typeof t=="function"?t:Lo(t)))}function Nd(t){typeof t!="function"&&(t=Po(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],o=s.length,l=i[r]=[],a,c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new Ot(i,this._parents)}function Ro(t){return new Array(t.length)}function Od(){return new Ot(this._enter||this._groups.map(Ro),this._parents)}function Fi(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Fi.prototype={constructor:Fi,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Pd(t){return function(){return t}}function Ld(t,e,n,i,r,s){for(var o=0,l,a=e.length,c=s.length;o<c;++o)(l=e[o])?(l.__data__=s[o],i[o]=l):n[o]=new Fi(t,s[o]);for(;o<a;++o)(l=e[o])&&(r[o]=l)}function Rd(t,e,n,i,r,s,o){var l,a,c=new Map,u=e.length,d=s.length,f=new Array(u),h;for(l=0;l<u;++l)(a=e[l])&&(f[l]=h=o.call(a,a.__data__,l,e)+"",c.has(h)?r[l]=a:c.set(h,a));for(l=0;l<d;++l)h=o.call(t,s[l],l,s)+"",(a=c.get(h))?(i[l]=a,a.__data__=s[l],c.delete(h)):n[l]=new Fi(t,s[l]);for(l=0;l<u;++l)(a=e[l])&&c.get(f[l])===a&&(r[l]=a)}function Dd(t){return t.__data__}function $d(t,e){if(!arguments.length)return Array.from(this,Dd);var n=e?Rd:Ld,i=this._parents,r=this._groups;typeof t!="function"&&(t=Pd(t));for(var s=r.length,o=new Array(s),l=new Array(s),a=new Array(s),c=0;c<s;++c){var u=i[c],d=r[c],f=d.length,h=zd(t.call(u,u&&u.__data__,c,i)),m=h.length,p=l[c]=new Array(m),g=o[c]=new Array(m),_=a[c]=new Array(f);n(u,d,p,g,_,h,e);for(var S=0,E=0,w,k;S<m;++S)if(w=p[S]){for(S>=E&&(E=S+1);!(k=g[E])&&++E<m;);w._next=k||null}}return o=new Ot(o,i),o._enter=l,o._exit=a,o}function zd(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function jd(){return new Ot(this._exit||this._groups.map(Ro),this._parents)}function Fd(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function Vd(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),l=new Array(r),a=0;a<o;++a)for(var c=n[a],u=i[a],d=c.length,f=l[a]=new Array(d),h,m=0;m<d;++m)(h=c[m]||u[m])&&(f[m]=h);for(;a<r;++a)l[a]=n[a];return new Ot(l,this._parents)}function Hd(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],o;--r>=0;)(o=i[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function Ud(t){t||(t=Bd);function e(d,f){return d&&f?t(d.__data__,f.__data__):!d-!f}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o=n[s],l=o.length,a=r[s]=new Array(l),c,u=0;u<l;++u)(c=o[u])&&(a[u]=c);a.sort(e)}return new Ot(r,this._parents).order()}function Bd(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function qd(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Kd(){return Array.from(this)}function Wd(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null}function Yd(){let t=0;for(const e of this)++t;return t}function Gd(){return!this.node()}function Xd(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,o=r.length,l;s<o;++s)(l=r[s])&&t.call(l,l.__data__,s,r);return this}function Jd(t){return function(){this.removeAttribute(t)}}function Qd(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Zd(t,e){return function(){this.setAttribute(t,e)}}function eh(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function th(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function nh(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ih(t,e){var n=ji(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?Qd:Jd:typeof e=="function"?n.local?nh:th:n.local?eh:Zd)(n,e))}function Do(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function rh(t){return function(){this.style.removeProperty(t)}}function sh(t,e,n){return function(){this.style.setProperty(t,e,n)}}function oh(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function lh(t,e,n){return arguments.length>1?this.each((e==null?rh:typeof e=="function"?oh:sh)(t,e,n??"")):Vn(this.node(),t)}function Vn(t,e){return t.style.getPropertyValue(e)||Do(t).getComputedStyle(t,null).getPropertyValue(e)}function ah(t){return function(){delete this[t]}}function ch(t,e){return function(){this[t]=e}}function uh(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function fh(t,e){return arguments.length>1?this.each((e==null?ah:typeof e=="function"?uh:ch)(t,e)):this.node()[t]}function $o(t){return t.trim().split(/^|\s+/)}function Or(t){return t.classList||new zo(t)}function zo(t){this._node=t,this._names=$o(t.getAttribute("class")||"")}zo.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function jo(t,e){for(var n=Or(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Fo(t,e){for(var n=Or(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function dh(t){return function(){jo(this,t)}}function hh(t){return function(){Fo(this,t)}}function mh(t,e){return function(){(e.apply(this,arguments)?jo:Fo)(this,t)}}function ph(t,e){var n=$o(t+"");if(arguments.length<2){for(var i=Or(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?mh:e?dh:hh)(n,e))}function gh(){this.textContent=""}function _h(t){return function(){this.textContent=t}}function vh(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function yh(t){return arguments.length?this.each(t==null?gh:(typeof t=="function"?vh:_h)(t)):this.node().textContent}function bh(){this.innerHTML=""}function wh(t){return function(){this.innerHTML=t}}function Sh(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function kh(t){return arguments.length?this.each(t==null?bh:(typeof t=="function"?Sh:wh)(t)):this.node().innerHTML}function Eh(){this.nextSibling&&this.parentNode.appendChild(this)}function Ch(){return this.each(Eh)}function Ih(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Mh(){return this.each(Ih)}function xh(t){var e=typeof t=="function"?t:No(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ah(){return null}function Th(t,e){var n=typeof t=="function"?t:No(t),i=e==null?Ah:typeof e=="function"?e:Nr(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Nh(){var t=this.parentNode;t&&t.removeChild(this)}function Oh(){return this.each(Nh)}function Ph(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Lh(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rh(t){return this.select(t?Lh:Ph)}function Dh(t){return arguments.length?this.property("__data__",t):this.node().__data__}function $h(t){return function(e){t.call(this,e,this.__data__)}}function zh(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function jh(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function Fh(t,e,n){return function(){var i=this.__on,r,s=$h(e);if(i){for(var o=0,l=i.length;o<l;++o)if((r=i[o]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function Vh(t,e,n){var i=zh(t+""),r,s=i.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,c=l.length,u;a<c;++a)for(r=0,u=l[a];r<s;++r)if((o=i[r]).type===u.type&&o.name===u.name)return u.value}return}for(l=e?Fh:jh,r=0;r<s;++r)this.each(l(i[r],e,n));return this}function Vo(t,e,n){var i=Do(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Hh(t,e){return function(){return Vo(this,t,e)}}function Uh(t,e){return function(){return Vo(this,t,e.apply(this,arguments))}}function Bh(t,e){return this.each((typeof e=="function"?Uh:Hh)(t,e))}function*qh(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,o;r<s;++r)(o=i[r])&&(yield o)}var Ho=[null];function Ot(t,e){this._groups=t,this._parents=e}function si(){return new Ot([[document.documentElement]],Ho)}function Kh(){return this}Ot.prototype=si.prototype={constructor:Ot,select:vd,selectAll:Sd,selectChild:Id,selectChildren:Td,filter:Nd,data:$d,enter:Od,exit:jd,join:Fd,merge:Vd,selection:Kh,order:Hd,sort:Ud,call:qd,nodes:Kd,node:Wd,size:Yd,empty:Gd,each:Xd,attr:ih,style:lh,property:fh,classed:ph,text:yh,html:kh,raise:Ch,lower:Mh,append:xh,insert:Th,remove:Oh,clone:Rh,datum:Dh,on:Vh,dispatch:Bh,[Symbol.iterator]:qh};function Ze(t){return typeof t=="string"?new Ot([[document.querySelector(t)]],[document.documentElement]):new Ot([[t]],Ho)}function Wh(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ct(t,e){if(t=Wh(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const Yh={passive:!1},oi={capture:!0,passive:!1};function Pr(t){t.stopImmediatePropagation()}function Hn(t){t.preventDefault(),t.stopImmediatePropagation()}function Uo(t){var e=t.document.documentElement,n=Ze(t).on("dragstart.drag",Hn,oi);"onselectstart"in e?n.on("selectstart.drag",Hn,oi):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Bo(t,e){var n=t.document.documentElement,i=Ze(t).on("dragstart.drag",null);e&&(i.on("click.drag",Hn,oi),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Vi=t=>()=>t;function Lr(t,{sourceEvent:e,subject:n,target:i,identifier:r,active:s,x:o,y:l,dx:a,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}Lr.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Gh(t){return!t.ctrlKey&&!t.button}function Xh(){return this.parentNode}function Jh(t,e){return e??{x:t.x,y:t.y}}function Qh(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zh(){var t=Gh,e=Xh,n=Jh,i=Qh,r={},s=ri("start","drag","end"),o=0,l,a,c,u,d=0;function f(w){w.on("mousedown.drag",h).filter(i).on("touchstart.drag",g).on("touchmove.drag",_,Yh).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(w,k){if(!(u||!t.call(this,w,k))){var T=E(this,e.call(this,w,k),w,k,"mouse");T&&(Ze(w.view).on("mousemove.drag",m,oi).on("mouseup.drag",p,oi),Uo(w.view),Pr(w),c=!1,l=w.clientX,a=w.clientY,T("start",w))}}function m(w){if(Hn(w),!c){var k=w.clientX-l,T=w.clientY-a;c=k*k+T*T>d}r.mouse("drag",w)}function p(w){Ze(w.view).on("mousemove.drag mouseup.drag",null),Bo(w.view,c),Hn(w),r.mouse("end",w)}function g(w,k){if(t.call(this,w,k)){var T=w.changedTouches,M=e.call(this,w,k),C=T.length,x,P;for(x=0;x<C;++x)(P=E(this,M,w,k,T[x].identifier,T[x]))&&(Pr(w),P("start",w,T[x]))}}function _(w){var k=w.changedTouches,T=k.length,M,C;for(M=0;M<T;++M)(C=r[k[M].identifier])&&(Hn(w),C("drag",w,k[M]))}function S(w){var k=w.changedTouches,T=k.length,M,C;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),M=0;M<T;++M)(C=r[k[M].identifier])&&(Pr(w),C("end",w,k[M]))}function E(w,k,T,M,C,x){var P=s.copy(),L=ct(x||T,k),H,$,I;if((I=n.call(w,new Lr("beforestart",{sourceEvent:T,target:f,identifier:C,active:o,x:L[0],y:L[1],dx:0,dy:0,dispatch:P}),M))!=null)return H=I.x-L[0]||0,$=I.y-L[1]||0,function R(O,V,q){var B=L,Y;switch(O){case"start":r[C]=R,Y=o++;break;case"end":delete r[C],--o;case"drag":L=ct(q||V,k),Y=o;break}P.call(O,w,new Lr(O,{sourceEvent:V,subject:I,target:f,identifier:C,active:Y,x:L[0]+H,y:L[1]+$,dx:L[0]-B[0],dy:L[1]-B[1],dispatch:P}),M)}}return f.filter=function(w){return arguments.length?(t=typeof w=="function"?w:Vi(!!w),f):t},f.container=function(w){return arguments.length?(e=typeof w=="function"?w:Vi(w),f):e},f.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Vi(w),f):n},f.touchable=function(w){return arguments.length?(i=typeof w=="function"?w:Vi(!!w),f):i},f.on=function(){var w=s.on.apply(s,arguments);return w===s?f:w},f.clickDistance=function(w){return arguments.length?(d=(w=+w)*w,f):Math.sqrt(d)},f}function Rr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function qo(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function li(){}var ai=.7,Hi=1/ai,Un="\\s*([+-]?\\d+)\\s*",ci="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",em=/^#([0-9a-f]{3,8})$/,tm=new RegExp(`^rgb\\(${Un},${Un},${Un}\\)$`),nm=new RegExp(`^rgb\\(${Yt},${Yt},${Yt}\\)$`),im=new RegExp(`^rgba\\(${Un},${Un},${Un},${ci}\\)$`),rm=new RegExp(`^rgba\\(${Yt},${Yt},${Yt},${ci}\\)$`),sm=new RegExp(`^hsl\\(${ci},${Yt},${Yt}\\)$`),om=new RegExp(`^hsla\\(${ci},${Yt},${Yt},${ci}\\)$`),Ko={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Rr(li,bn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Wo,formatHex:Wo,formatHex8:lm,formatHsl:am,formatRgb:Yo,toString:Yo});function Wo(){return this.rgb().formatHex()}function lm(){return this.rgb().formatHex8()}function am(){return Zo(this).formatHsl()}function Yo(){return this.rgb().formatRgb()}function bn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=em.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Go(e):n===3?new It(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ui(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ui(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=tm.exec(t))?new It(e[1],e[2],e[3],1):(e=nm.exec(t))?new It(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=im.exec(t))?Ui(e[1],e[2],e[3],e[4]):(e=rm.exec(t))?Ui(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=sm.exec(t))?Qo(e[1],e[2]/100,e[3]/100,1):(e=om.exec(t))?Qo(e[1],e[2]/100,e[3]/100,e[4]):Ko.hasOwnProperty(t)?Go(Ko[t]):t==="transparent"?new It(NaN,NaN,NaN,0):null}function Go(t){return new It(t>>16&255,t>>8&255,t&255,1)}function Ui(t,e,n,i){return i<=0&&(t=e=n=NaN),new It(t,e,n,i)}function cm(t){return t instanceof li||(t=bn(t)),t?(t=t.rgb(),new It(t.r,t.g,t.b,t.opacity)):new It}function Dr(t,e,n,i){return arguments.length===1?cm(t):new It(t,e,n,i??1)}function It(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Rr(It,Dr,qo(li,{brighter(t){return t=t==null?Hi:Math.pow(Hi,t),new It(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ai:Math.pow(ai,t),new It(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new It(wn(this.r),wn(this.g),wn(this.b),Bi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xo,formatHex:Xo,formatHex8:um,formatRgb:Jo,toString:Jo}));function Xo(){return`#${Sn(this.r)}${Sn(this.g)}${Sn(this.b)}`}function um(){return`#${Sn(this.r)}${Sn(this.g)}${Sn(this.b)}${Sn((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jo(){const t=Bi(this.opacity);return`${t===1?"rgb(":"rgba("}${wn(this.r)}, ${wn(this.g)}, ${wn(this.b)}${t===1?")":`, ${t})`}`}function Bi(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Sn(t){return t=wn(t),(t<16?"0":"")+t.toString(16)}function Qo(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ut(t,e,n,i)}function Zo(t){if(t instanceof Ut)return new Ut(t.h,t.s,t.l,t.opacity);if(t instanceof li||(t=bn(t)),!t)return new Ut;if(t instanceof Ut)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,l=s-r,a=(s+r)/2;return l?(e===s?o=(n-i)/l+(n<i)*6:n===s?o=(i-e)/l+2:o=(e-n)/l+4,l/=a<.5?s+r:2-s-r,o*=60):l=a>0&&a<1?0:o,new Ut(o,l,a,t.opacity)}function $r(t,e,n,i){return arguments.length===1?Zo(t):new Ut(t,e,n,i??1)}function Ut(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Rr(Ut,$r,qo(li,{brighter(t){return t=t==null?Hi:Math.pow(Hi,t),new Ut(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ai:Math.pow(ai,t),new Ut(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new It(zr(t>=240?t-240:t+120,r,i),zr(t,r,i),zr(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Ut(el(this.h),qi(this.s),qi(this.l),Bi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Bi(this.opacity);return`${t===1?"hsl(":"hsla("}${el(this.h)}, ${qi(this.s)*100}%, ${qi(this.l)*100}%${t===1?")":`, ${t})`}`}}));function el(t){return t=(t||0)%360,t<0?t+360:t}function qi(t){return Math.max(0,Math.min(1,t||0))}function zr(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const jr=t=>()=>t;function fm(t,e){return function(n){return t+n*e}}function dm(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function hm(t){return(t=+t)==1?tl:function(e,n){return n-e?dm(e,n,t):jr(isNaN(e)?n:e)}}function tl(t,e){var n=e-t;return n?fm(t,n):jr(isNaN(t)?e:t)}const Ki=function t(e){var n=hm(e);function i(r,s){var o=n((r=Dr(r)).r,(s=Dr(s)).r),l=n(r.g,s.g),a=n(r.b,s.b),c=tl(r.opacity,s.opacity);return function(u){return r.r=o(u),r.g=l(u),r.b=a(u),r.opacity=c(u),r+""}}return i.gamma=t,i}(1);function mm(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(s){for(r=0;r<n;++r)i[r]=t[r]*(1-s)+e[r]*s;return i}}function pm(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function gm(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)r[o]=Hr(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(l){for(o=0;o<i;++o)s[o]=r[o](l);return s}}function _m(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Bt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function vm(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=Hr(t[r],e[r]):i[r]=e[r];return function(s){for(r in n)i[r]=n[r](s);return i}}var Fr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Vr=new RegExp(Fr.source,"g");function ym(t){return function(){return t}}function bm(t){return function(e){return t(e)+""}}function nl(t,e){var n=Fr.lastIndex=Vr.lastIndex=0,i,r,s,o=-1,l=[],a=[];for(t=t+"",e=e+"";(i=Fr.exec(t))&&(r=Vr.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(i=i[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,a.push({i:o,x:Bt(i,r)})),n=Vr.lastIndex;return n<e.length&&(s=e.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?a[0]?bm(a[0].x):ym(e):(e=a.length,function(c){for(var u=0,d;u<e;++u)l[(d=a[u]).i]=d.x(c);return l.join("")})}function Hr(t,e){var n=typeof e,i;return e==null||n==="boolean"?jr(e):(n==="number"?Bt:n==="string"?(i=bn(e))?(e=i,Ki):nl:e instanceof bn?Ki:e instanceof Date?_m:pm(e)?mm:Array.isArray(e)?gm:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?vm:Bt)(t,e)}function wm(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var il=180/Math.PI,Ur={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function rl(t,e,n,i,r,s){var o,l,a;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(a=t*n+e*i)&&(n-=t*a,i-=e*a),(l=Math.sqrt(n*n+i*i))&&(n/=l,i/=l,a/=l),t*i<e*n&&(t=-t,e=-e,a=-a,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*il,skewX:Math.atan(a)*il,scaleX:o,scaleY:l}}var Wi;function Sm(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ur:rl(e.a,e.b,e.c,e.d,e.e,e.f)}function km(t){return t==null||(Wi||(Wi=document.createElementNS("http://www.w3.org/2000/svg","g")),Wi.setAttribute("transform",t),!(t=Wi.transform.baseVal.consolidate()))?Ur:(t=t.matrix,rl(t.a,t.b,t.c,t.d,t.e,t.f))}function sl(t,e,n,i){function r(c){return c.length?c.pop()+" ":""}function s(c,u,d,f,h,m){if(c!==d||u!==f){var p=h.push("translate(",null,e,null,n);m.push({i:p-4,x:Bt(c,d)},{i:p-2,x:Bt(u,f)})}else(d||f)&&h.push("translate("+d+e+f+n)}function o(c,u,d,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:d.push(r(d)+"rotate(",null,i)-2,x:Bt(c,u)})):u&&d.push(r(d)+"rotate("+u+i)}function l(c,u,d,f){c!==u?f.push({i:d.push(r(d)+"skewX(",null,i)-2,x:Bt(c,u)}):u&&d.push(r(d)+"skewX("+u+i)}function a(c,u,d,f,h,m){if(c!==d||u!==f){var p=h.push(r(h)+"scale(",null,",",null,")");m.push({i:p-4,x:Bt(c,d)},{i:p-2,x:Bt(u,f)})}else(d!==1||f!==1)&&h.push(r(h)+"scale("+d+","+f+")")}return function(c,u){var d=[],f=[];return c=t(c),u=t(u),s(c.translateX,c.translateY,u.translateX,u.translateY,d,f),o(c.rotate,u.rotate,d,f),l(c.skewX,u.skewX,d,f),a(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,f),c=u=null,function(h){for(var m=-1,p=f.length,g;++m<p;)d[(g=f[m]).i]=g.x(h);return d.join("")}}}var Em=sl(Sm,"px, ","px)","deg)"),Cm=sl(km,", ",")",")"),Im=1e-12;function ol(t){return((t=Math.exp(t))+1/t)/2}function Mm(t){return((t=Math.exp(t))-1/t)/2}function xm(t){return((t=Math.exp(2*t))-1)/(t+1)}const Am=function t(e,n,i){function r(s,o){var l=s[0],a=s[1],c=s[2],u=o[0],d=o[1],f=o[2],h=u-l,m=d-a,p=h*h+m*m,g,_;if(p<Im)_=Math.log(f/c)/e,g=function(M){return[l+M*h,a+M*m,c*Math.exp(e*M*_)]};else{var S=Math.sqrt(p),E=(f*f-c*c+i*p)/(2*c*n*S),w=(f*f-c*c-i*p)/(2*f*n*S),k=Math.log(Math.sqrt(E*E+1)-E),T=Math.log(Math.sqrt(w*w+1)-w);_=(T-k)/e,g=function(M){var C=M*_,x=ol(k),P=c/(n*S)*(x*xm(e*C+k)-Mm(k));return[l+P*h,a+P*m,c*x/ol(e*C+k)]}}return g.duration=_*1e3*e/Math.SQRT2,g}return r.rho=function(s){var o=Math.max(.001,+s),l=o*o,a=l*l;return t(o,l,a)},r}(Math.SQRT2,2,4);var Bn=0,ui=0,fi=0,ll=1e3,Yi,di,Gi=0,kn=0,Xi=0,hi=typeof performance=="object"&&performance.now?performance:Date,al=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Br(){return kn||(al(Tm),kn=hi.now()+Xi)}function Tm(){kn=0}function Ji(){this._call=this._time=this._next=null}Ji.prototype=qr.prototype={constructor:Ji,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Br():+n)+(e==null?0:+e),!this._next&&di!==this&&(di?di._next=this:Yi=this,di=this),this._call=t,this._time=n,Kr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Kr())}};function qr(t,e,n){var i=new Ji;return i.restart(t,e,n),i}function Nm(){Br(),++Bn;for(var t=Yi,e;t;)(e=kn-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Bn}function cl(){kn=(Gi=hi.now())+Xi,Bn=ui=0;try{Nm()}finally{Bn=0,Pm(),kn=0}}function Om(){var t=hi.now(),e=t-Gi;e>ll&&(Xi-=e,Gi=t)}function Pm(){for(var t,e=Yi,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Yi=n);di=t,Kr(i)}function Kr(t){if(!Bn){ui&&(ui=clearTimeout(ui));var e=t-kn;e>24?(t<1/0&&(ui=setTimeout(cl,t-hi.now()-Xi)),fi&&(fi=clearInterval(fi))):(fi||(Gi=hi.now(),fi=setInterval(Om,ll)),Bn=1,al(cl))}}function ul(t,e,n){var i=new Ji;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var Lm=ri("start","end","cancel","interrupt"),Rm=[],fl=0,dl=1,Wr=2,Qi=3,hl=4,Yr=5,Zi=6;function er(t,e,n,i,r,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;Dm(t,n,{name:e,index:i,group:r,on:Lm,tween:Rm,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:fl})}function Gr(t,e){var n=qt(t,e);if(n.state>fl)throw new Error("too late; already scheduled");return n}function Gt(t,e){var n=qt(t,e);if(n.state>Qi)throw new Error("too late; already running");return n}function qt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Dm(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=qr(s,0,n.time);function s(c){n.state=dl,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var u,d,f,h;if(n.state!==dl)return a();for(u in i)if(h=i[u],h.name===n.name){if(h.state===Qi)return ul(o);h.state===hl?(h.state=Zi,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[u]):+u<e&&(h.state=Zi,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[u])}if(ul(function(){n.state===Qi&&(n.state=hl,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=Wr,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Wr){for(n.state=Qi,r=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++d]=h);r.length=d+1}}function l(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(a),n.state=Yr,1),d=-1,f=r.length;++d<f;)r[d].call(t,u);n.state===Yr&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=Zi,n.timer.stop(),delete i[e];for(var c in i)return;delete t.__transition}}function tr(t,e){var n=t.__transition,i,r,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((i=n[o]).name!==e){s=!1;continue}r=i.state>Wr&&i.state<Yr,i.state=Zi,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[o]}s&&delete t.__transition}}function $m(t){return this.each(function(){tr(this,t)})}function zm(t,e){var n,i;return function(){var r=Gt(this,t),s=r.tween;if(s!==n){i=n=s;for(var o=0,l=i.length;o<l;++o)if(i[o].name===e){i=i.slice(),i.splice(o,1);break}}r.tween=i}}function jm(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=Gt(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var l={name:e,value:n},a=0,c=r.length;a<c;++a)if(r[a].name===e){r[a]=l;break}a===c&&r.push(l)}s.tween=r}}function Fm(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=qt(this.node(),n).tween,r=0,s=i.length,o;r<s;++r)if((o=i[r]).name===t)return o.value;return null}return this.each((e==null?zm:jm)(n,t,e))}function Xr(t,e,n){var i=t._id;return t.each(function(){var r=Gt(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return qt(r,i).value[e]}}function ml(t,e){var n;return(typeof e=="number"?Bt:e instanceof bn?Ki:(n=bn(e))?(e=n,Ki):nl)(t,e)}function Vm(t){return function(){this.removeAttribute(t)}}function Hm(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Um(t,e,n){var i,r=n+"",s;return function(){var o=this.getAttribute(t);return o===r?null:o===i?s:s=e(i=o,n)}}function Bm(t,e,n){var i,r=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===r?null:o===i?s:s=e(i=o,n)}}function qm(t,e,n){var i,r,s;return function(){var o,l=n(this),a;return l==null?void this.removeAttribute(t):(o=this.getAttribute(t),a=l+"",o===a?null:o===i&&a===r?s:(r=a,s=e(i=o,l)))}}function Km(t,e,n){var i,r,s;return function(){var o,l=n(this),a;return l==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),a=l+"",o===a?null:o===i&&a===r?s:(r=a,s=e(i=o,l)))}}function Wm(t,e){var n=ji(t),i=n==="transform"?Cm:ml;return this.attrTween(t,typeof e=="function"?(n.local?Km:qm)(n,i,Xr(this,"attr."+t,e)):e==null?(n.local?Hm:Vm)(n):(n.local?Bm:Um)(n,i,e))}function Ym(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Gm(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Xm(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Gm(t,s)),n}return r._value=e,r}function Jm(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Ym(t,s)),n}return r._value=e,r}function Qm(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=ji(t);return this.tween(n,(i.local?Xm:Jm)(i,e))}function Zm(t,e){return function(){Gr(this,t).delay=+e.apply(this,arguments)}}function ep(t,e){return e=+e,function(){Gr(this,t).delay=e}}function tp(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Zm:ep)(e,t)):qt(this.node(),e).delay}function np(t,e){return function(){Gt(this,t).duration=+e.apply(this,arguments)}}function ip(t,e){return e=+e,function(){Gt(this,t).duration=e}}function rp(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?np:ip)(e,t)):qt(this.node(),e).duration}function sp(t,e){if(typeof e!="function")throw new Error;return function(){Gt(this,t).ease=e}}function op(t){var e=this._id;return arguments.length?this.each(sp(e,t)):qt(this.node(),e).ease}function lp(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Gt(this,t).ease=n}}function ap(t){if(typeof t!="function")throw new Error;return this.each(lp(this._id,t))}function cp(t){typeof t!="function"&&(t=Po(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],o=s.length,l=i[r]=[],a,c=0;c<o;++c)(a=s[c])&&t.call(a,a.__data__,c,s)&&l.push(a);return new rn(i,this._parents,this._name,this._id)}function up(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),l=0;l<s;++l)for(var a=e[l],c=n[l],u=a.length,d=o[l]=new Array(u),f,h=0;h<u;++h)(f=a[h]||c[h])&&(d[h]=f);for(;l<i;++l)o[l]=e[l];return new rn(o,this._parents,this._name,this._id)}function fp(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function dp(t,e,n){var i,r,s=fp(e)?Gr:Gt;return function(){var o=s(this,t),l=o.on;l!==i&&(r=(i=l).copy()).on(e,n),o.on=r}}function hp(t,e){var n=this._id;return arguments.length<2?qt(this.node(),n).on.on(t):this.each(dp(n,t,e))}function mp(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function pp(){return this.on("end.remove",mp(this._id))}function gp(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Nr(t));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var l=i[o],a=l.length,c=s[o]=new Array(a),u,d,f=0;f<a;++f)(u=l[f])&&(d=t.call(u,u.__data__,f,l))&&("__data__"in u&&(d.__data__=u.__data__),c[f]=d,er(c[f],e,n,f,c,qt(u,n)));return new rn(s,this._parents,e,n)}function _p(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Oo(t));for(var i=this._groups,r=i.length,s=[],o=[],l=0;l<r;++l)for(var a=i[l],c=a.length,u,d=0;d<c;++d)if(u=a[d]){for(var f=t.call(u,u.__data__,d,a),h,m=qt(u,n),p=0,g=f.length;p<g;++p)(h=f[p])&&er(h,e,n,p,f,m);s.push(f),o.push(u)}return new rn(s,o,e,n)}var vp=si.prototype.constructor;function yp(){return new vp(this._groups,this._parents)}function bp(t,e){var n,i,r;return function(){var s=Vn(this,t),o=(this.style.removeProperty(t),Vn(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}function pl(t){return function(){this.style.removeProperty(t)}}function wp(t,e,n){var i,r=n+"",s;return function(){var o=Vn(this,t);return o===r?null:o===i?s:s=e(i=o,n)}}function Sp(t,e,n){var i,r,s;return function(){var o=Vn(this,t),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(t),Vn(this,t))),o===a?null:o===i&&a===r?s:(r=a,s=e(i=o,l))}}function kp(t,e){var n,i,r,s="style."+e,o="end."+s,l;return function(){var a=Gt(this,t),c=a.on,u=a.value[s]==null?l||(l=pl(e)):void 0;(c!==n||r!==u)&&(i=(n=c).copy()).on(o,r=u),a.on=i}}function Ep(t,e,n){var i=(t+="")=="transform"?Em:ml;return e==null?this.styleTween(t,bp(t,i)).on("end.style."+t,pl(t)):typeof e=="function"?this.styleTween(t,Sp(t,i,Xr(this,"style."+t,e))).each(kp(this._id,t)):this.styleTween(t,wp(t,i,e),n).on("end.style."+t,null)}function Cp(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Ip(t,e,n){var i,r;function s(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&Cp(t,o,n)),i}return s._value=e,s}function Mp(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,Ip(t,e,n??""))}function xp(t){return function(){this.textContent=t}}function Ap(t){return function(){var e=t(this);this.textContent=e??""}}function Tp(t){return this.tween("text",typeof t=="function"?Ap(Xr(this,"text",t)):xp(t==null?"":t+""))}function Np(t){return function(e){this.textContent=t.call(this,e)}}function Op(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Np(r)),e}return i._value=t,i}function Pp(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Op(t))}function Lp(){for(var t=this._name,e=this._id,n=gl(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],l=o.length,a,c=0;c<l;++c)if(a=o[c]){var u=qt(a,e);er(a,t,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new rn(i,this._parents,t,n)}function Rp(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,o){var l={value:o},a={value:function(){--r===0&&s()}};n.each(function(){var c=Gt(this,i),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(a)),c.on=e}),r===0&&s()})}var Dp=0;function rn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function gl(){return++Dp}var sn=si.prototype;rn.prototype={constructor:rn,select:gp,selectAll:_p,selectChild:sn.selectChild,selectChildren:sn.selectChildren,filter:cp,merge:up,selection:yp,transition:Lp,call:sn.call,nodes:sn.nodes,node:sn.node,size:sn.size,empty:sn.empty,each:sn.each,on:hp,attr:Wm,attrTween:Qm,style:Ep,styleTween:Mp,text:Tp,textTween:Pp,remove:pp,tween:Fm,delay:tp,duration:rp,ease:op,easeVarying:ap,end:Rp,[Symbol.iterator]:sn[Symbol.iterator]};function $p(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var zp={time:null,delay:0,duration:250,ease:$p};function jp(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Fp(t){var e,n;t instanceof rn?(e=t._id,t=t._name):(e=gl(),(n=zp).time=Br(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],l=o.length,a,c=0;c<l;++c)(a=o[c])&&er(a,t,e,c,o,n||jp(a,e));return new rn(i,this._parents,t,e)}si.prototype.interrupt=$m,si.prototype.transition=Fp;function _l(t,e){var n,i=1;t==null&&(t=0),e==null&&(e=0);function r(){var s,o=n.length,l,a=0,c=0;for(s=0;s<o;++s)l=n[s],a+=l.x,c+=l.y;for(a=(a/o-t)*i,c=(c/o-e)*i,s=0;s<o;++s)l=n[s],l.x-=a,l.y-=c}return r.initialize=function(s){n=s},r.x=function(s){return arguments.length?(t=+s,r):t},r.y=function(s){return arguments.length?(e=+s,r):e},r.strength=function(s){return arguments.length?(i=+s,r):i},r}function Vp(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return vl(this.cover(e,n),e,n,t)}function vl(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,s=t._root,o={data:i},l=t._x0,a=t._y0,c=t._x1,u=t._y1,d,f,h,m,p,g,_,S;if(!s)return t._root=o,t;for(;s.length;)if((p=e>=(d=(l+c)/2))?l=d:c=d,(g=n>=(f=(a+u)/2))?a=f:u=f,r=s,!(s=s[_=g<<1|p]))return r[_]=o,t;if(h=+t._x.call(null,s.data),m=+t._y.call(null,s.data),e===h&&n===m)return o.next=s,r?r[_]=o:t._root=o,t;do r=r?r[_]=new Array(4):t._root=new Array(4),(p=e>=(d=(l+c)/2))?l=d:c=d,(g=n>=(f=(a+u)/2))?a=f:u=f;while((_=g<<1|p)===(S=(m>=f)<<1|h>=d));return r[S]=s,r[_]=o,t}function Hp(t){var e,n,i=t.length,r,s,o=new Array(i),l=new Array(i),a=1/0,c=1/0,u=-1/0,d=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(o[n]=r,l[n]=s,r<a&&(a=r),r>u&&(u=r),s<c&&(c=s),s>d&&(d=s));if(a>u||c>d)return this;for(this.cover(a,c).cover(u,d),n=0;n<i;++n)vl(this,o[n],l[n],t[n]);return this}function Up(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,s=this._y1;if(isNaN(n))r=(n=Math.floor(t))+1,s=(i=Math.floor(e))+1;else{for(var o=r-n||1,l=this._root,a,c;n>t||t>=r||i>e||e>=s;)switch(c=(e<i)<<1|t<n,a=new Array(4),a[c]=l,l=a,o*=2,c){case 0:r=n+o,s=i+o;break;case 1:n=r-o,s=i+o;break;case 2:r=n+o,i=s-o;break;case 3:n=r-o,i=s-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=i,this._x1=r,this._y1=s,this}function Bp(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function qp(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function bt(t,e,n,i,r){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=r}function Kp(t,e,n){var i,r=this._x0,s=this._y0,o,l,a,c,u=this._x1,d=this._y1,f=[],h=this._root,m,p;for(h&&f.push(new bt(h,r,s,u,d)),n==null?n=1/0:(r=t-n,s=e-n,u=t+n,d=e+n,n*=n);m=f.pop();)if(!(!(h=m.node)||(o=m.x0)>u||(l=m.y0)>d||(a=m.x1)<r||(c=m.y1)<s))if(h.length){var g=(o+a)/2,_=(l+c)/2;f.push(new bt(h[3],g,_,a,c),new bt(h[2],o,_,g,c),new bt(h[1],g,l,a,_),new bt(h[0],o,l,g,_)),(p=(e>=_)<<1|t>=g)&&(m=f[f.length-1],f[f.length-1]=f[f.length-1-p],f[f.length-1-p]=m)}else{var S=t-+this._x.call(null,h.data),E=e-+this._y.call(null,h.data),w=S*S+E*E;if(w<n){var k=Math.sqrt(n=w);r=t-k,s=e-k,u=t+k,d=e+k,i=h.data}}return i}function Wp(t){if(isNaN(u=+this._x.call(null,t))||isNaN(d=+this._y.call(null,t)))return this;var e,n=this._root,i,r,s,o=this._x0,l=this._y0,a=this._x1,c=this._y1,u,d,f,h,m,p,g,_;if(!n)return this;if(n.length)for(;;){if((m=u>=(f=(o+a)/2))?o=f:a=f,(p=d>=(h=(l+c)/2))?l=h:c=h,e=n,!(n=n[g=p<<1|m]))return this;if(!n.length)break;(e[g+1&3]||e[g+2&3]||e[g+3&3])&&(i=e,_=g)}for(;n.data!==t;)if(r=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,r?(s?r.next=s:delete r.next,this):e?(s?e[g]=s:delete e[g],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(i?i[_]=n:this._root=n),this):(this._root=s,this)}function Yp(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function Gp(){return this._root}function Xp(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function Jp(t){var e=[],n,i=this._root,r,s,o,l,a;for(i&&e.push(new bt(i,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(i=n.node,s=n.x0,o=n.y0,l=n.x1,a=n.y1)&&i.length){var c=(s+l)/2,u=(o+a)/2;(r=i[3])&&e.push(new bt(r,c,u,l,a)),(r=i[2])&&e.push(new bt(r,s,u,c,a)),(r=i[1])&&e.push(new bt(r,c,o,l,u)),(r=i[0])&&e.push(new bt(r,s,o,c,u))}return this}function Qp(t){var e=[],n=[],i;for(this._root&&e.push(new bt(this._root,this._x0,this._y0,this._x1,this._y1));i=e.pop();){var r=i.node;if(r.length){var s,o=i.x0,l=i.y0,a=i.x1,c=i.y1,u=(o+a)/2,d=(l+c)/2;(s=r[0])&&e.push(new bt(s,o,l,u,d)),(s=r[1])&&e.push(new bt(s,u,l,a,d)),(s=r[2])&&e.push(new bt(s,o,d,u,c)),(s=r[3])&&e.push(new bt(s,u,d,a,c))}n.push(i)}for(;i=n.pop();)t(i.node,i.x0,i.y0,i.x1,i.y1);return this}function Zp(t){return t[0]}function eg(t){return arguments.length?(this._x=t,this):this._x}function tg(t){return t[1]}function ng(t){return arguments.length?(this._y=t,this):this._y}function Jr(t,e,n){var i=new Qr(e??Zp,n??tg,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function Qr(t,e,n,i,r,s){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=r,this._y1=s,this._root=void 0}function yl(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var wt=Jr.prototype=Qr.prototype;wt.copy=function(){var t=new Qr(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=yl(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var r=0;r<4;++r)(i=e.source[r])&&(i.length?n.push({source:i,target:e.target[r]=new Array(4)}):e.target[r]=yl(i));return t},wt.add=Vp,wt.addAll=Hp,wt.cover=Up,wt.data=Bp,wt.extent=qp,wt.find=Kp,wt.remove=Wp,wt.removeAll=Yp,wt.root=Gp,wt.size=Xp,wt.visit=Jp,wt.visitAfter=Qp,wt.x=eg,wt.y=ng;function St(t){return function(){return t}}function pn(t){return(t()-.5)*1e-6}function ig(t){return t.x+t.vx}function rg(t){return t.y+t.vy}function bl(t){var e,n,i,r=1,s=1;typeof t!="function"&&(t=St(t==null?1:+t));function o(){for(var c,u=e.length,d,f,h,m,p,g,_=0;_<s;++_)for(d=Jr(e,ig,rg).visitAfter(l),c=0;c<u;++c)f=e[c],p=n[f.index],g=p*p,h=f.x+f.vx,m=f.y+f.vy,d.visit(S);function S(E,w,k,T,M){var C=E.data,x=E.r,P=p+x;if(C){if(C.index>f.index){var L=h-C.x-C.vx,H=m-C.y-C.vy,$=L*L+H*H;$<P*P&&(L===0&&(L=pn(i),$+=L*L),H===0&&(H=pn(i),$+=H*H),$=(P-($=Math.sqrt($)))/$*r,f.vx+=(L*=$)*(P=(x*=x)/(g+x)),f.vy+=(H*=$)*P,C.vx-=L*(P=1-P),C.vy-=H*P)}return}return w>h+P||T<h-P||k>m+P||M<m-P}}function l(c){if(c.data)return c.r=n[c.data.index];for(var u=c.r=0;u<4;++u)c[u]&&c[u].r>c.r&&(c.r=c[u].r)}function a(){if(e){var c,u=e.length,d;for(n=new Array(u),c=0;c<u;++c)d=e[c],n[d.index]=+t(d,c,e)}}return o.initialize=function(c,u){e=c,i=u,a()},o.iterations=function(c){return arguments.length?(s=+c,o):s},o.strength=function(c){return arguments.length?(r=+c,o):r},o.radius=function(c){return arguments.length?(t=typeof c=="function"?c:St(+c),a(),o):t},o}function sg(t){return t.index}function wl(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function Sl(t){var e=sg,n=d,i,r=St(30),s,o,l,a,c,u=1;t==null&&(t=[]);function d(g){return 1/Math.min(l[g.source.index],l[g.target.index])}function f(g){for(var _=0,S=t.length;_<u;++_)for(var E=0,w,k,T,M,C,x,P;E<S;++E)w=t[E],k=w.source,T=w.target,M=T.x+T.vx-k.x-k.vx||pn(c),C=T.y+T.vy-k.y-k.vy||pn(c),x=Math.sqrt(M*M+C*C),x=(x-s[E])/x*g*i[E],M*=x,C*=x,T.vx-=M*(P=a[E]),T.vy-=C*P,k.vx+=M*(P=1-P),k.vy+=C*P}function h(){if(o){var g,_=o.length,S=t.length,E=new Map(o.map((k,T)=>[e(k,T,o),k])),w;for(g=0,l=new Array(_);g<S;++g)w=t[g],w.index=g,typeof w.source!="object"&&(w.source=wl(E,w.source)),typeof w.target!="object"&&(w.target=wl(E,w.target)),l[w.source.index]=(l[w.source.index]||0)+1,l[w.target.index]=(l[w.target.index]||0)+1;for(g=0,a=new Array(S);g<S;++g)w=t[g],a[g]=l[w.source.index]/(l[w.source.index]+l[w.target.index]);i=new Array(S),m(),s=new Array(S),p()}}function m(){if(o)for(var g=0,_=t.length;g<_;++g)i[g]=+n(t[g],g,t)}function p(){if(o)for(var g=0,_=t.length;g<_;++g)s[g]=+r(t[g],g,t)}return f.initialize=function(g,_){o=g,c=_,h()},f.links=function(g){return arguments.length?(t=g,h(),f):t},f.id=function(g){return arguments.length?(e=g,f):e},f.iterations=function(g){return arguments.length?(u=+g,f):u},f.strength=function(g){return arguments.length?(n=typeof g=="function"?g:St(+g),m(),f):n},f.distance=function(g){return arguments.length?(r=typeof g=="function"?g:St(+g),p(),f):r},f}const og=1664525,lg=1013904223,kl=4294967296;function ag(){let t=1;return()=>(t=(og*t+lg)%kl)/kl}function cg(t){return t.x}function ug(t){return t.y}var fg=10,dg=Math.PI*(3-Math.sqrt(5));function El(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,l=new Map,a=qr(d),c=ri("tick","end"),u=ag();t==null&&(t=[]);function d(){f(),c.call("tick",e),n<i&&(a.stop(),c.call("end",e))}function f(p){var g,_=t.length,S;p===void 0&&(p=1);for(var E=0;E<p;++E)for(n+=(s-n)*r,l.forEach(function(w){w(n)}),g=0;g<_;++g)S=t[g],S.fx==null?S.x+=S.vx*=o:(S.x=S.fx,S.vx=0),S.fy==null?S.y+=S.vy*=o:(S.y=S.fy,S.vy=0);return e}function h(){for(var p=0,g=t.length,_;p<g;++p){if(_=t[p],_.index=p,_.fx!=null&&(_.x=_.fx),_.fy!=null&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var S=fg*Math.sqrt(.5+p),E=p*dg;_.x=S*Math.cos(E),_.y=S*Math.sin(E)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function m(p){return p.initialize&&p.initialize(t,u),p}return h(),e={tick:f,restart:function(){return a.restart(d),e},stop:function(){return a.stop(),e},nodes:function(p){return arguments.length?(t=p,h(),l.forEach(m),e):t},alpha:function(p){return arguments.length?(n=+p,e):n},alphaMin:function(p){return arguments.length?(i=+p,e):i},alphaDecay:function(p){return arguments.length?(r=+p,e):+r},alphaTarget:function(p){return arguments.length?(s=+p,e):s},velocityDecay:function(p){return arguments.length?(o=1-p,e):1-o},randomSource:function(p){return arguments.length?(u=p,l.forEach(m),e):u},force:function(p,g){return arguments.length>1?(g==null?l.delete(p):l.set(p,m(g)),e):l.get(p)},find:function(p,g,_){var S=0,E=t.length,w,k,T,M,C;for(_==null?_=1/0:_*=_,S=0;S<E;++S)M=t[S],w=p-M.x,k=g-M.y,T=w*w+k*k,T<_&&(C=M,_=T);return C},on:function(p,g){return arguments.length>1?(c.on(p,g),e):c.on(p)}}}function Cl(){var t,e,n,i,r=St(-30),s,o=1,l=1/0,a=.81;function c(h){var m,p=t.length,g=Jr(t,cg,ug).visitAfter(d);for(i=h,m=0;m<p;++m)e=t[m],g.visit(f)}function u(){if(t){var h,m=t.length,p;for(s=new Array(m),h=0;h<m;++h)p=t[h],s[p.index]=+r(p,h,t)}}function d(h){var m=0,p,g,_=0,S,E,w;if(h.length){for(S=E=w=0;w<4;++w)(p=h[w])&&(g=Math.abs(p.value))&&(m+=p.value,_+=g,S+=g*p.x,E+=g*p.y);h.x=S/_,h.y=E/_}else{p=h,p.x=p.data.x,p.y=p.data.y;do m+=s[p.data.index];while(p=p.next)}h.value=m}function f(h,m,p,g){if(!h.value)return!0;var _=h.x-e.x,S=h.y-e.y,E=g-m,w=_*_+S*S;if(E*E/a<w)return w<l&&(_===0&&(_=pn(n),w+=_*_),S===0&&(S=pn(n),w+=S*S),w<o&&(w=Math.sqrt(o*w)),e.vx+=_*h.value*i/w,e.vy+=S*h.value*i/w),!0;if(h.length||w>=l)return;(h.data!==e||h.next)&&(_===0&&(_=pn(n),w+=_*_),S===0&&(S=pn(n),w+=S*S),w<o&&(w=Math.sqrt(o*w)));do h.data!==e&&(E=s[h.data.index]*i/w,e.vx+=_*E,e.vy+=S*E);while(h=h.next)}return c.initialize=function(h,m){t=h,n=m,u()},c.strength=function(h){return arguments.length?(r=typeof h=="function"?h:St(+h),u(),c):r},c.distanceMin=function(h){return arguments.length?(o=h*h,c):Math.sqrt(o)},c.distanceMax=function(h){return arguments.length?(l=h*h,c):Math.sqrt(l)},c.theta=function(h){return arguments.length?(a=h*h,c):Math.sqrt(a)},c}function Il(t){var e=St(.1),n,i,r;typeof t!="function"&&(t=St(t==null?0:+t));function s(l){for(var a=0,c=n.length,u;a<c;++a)u=n[a],u.vx+=(r[a]-u.x)*i[a]*l}function o(){if(n){var l,a=n.length;for(i=new Array(a),r=new Array(a),l=0;l<a;++l)i[l]=isNaN(r[l]=+t(n[l],l,n))?0:+e(n[l],l,n)}}return s.initialize=function(l){n=l,o()},s.strength=function(l){return arguments.length?(e=typeof l=="function"?l:St(+l),o(),s):e},s.x=function(l){return arguments.length?(t=typeof l=="function"?l:St(+l),o(),s):t},s}function Ml(t){var e=St(.1),n,i,r;typeof t!="function"&&(t=St(t==null?0:+t));function s(l){for(var a=0,c=n.length,u;a<c;++a)u=n[a],u.vy+=(r[a]-u.y)*i[a]*l}function o(){if(n){var l,a=n.length;for(i=new Array(a),r=new Array(a),l=0;l<a;++l)i[l]=isNaN(r[l]=+t(n[l],l,n))?0:+e(n[l],l,n)}}return s.initialize=function(l){n=l,o()},s.strength=function(l){return arguments.length?(e=typeof l=="function"?l:St(+l),o(),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:St(+l),o(),s):t},s}function hg(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function nr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function qn(t){return t=nr(Math.abs(t)),t?t[1]:NaN}function mg(t,e){return function(n,i){for(var r=n.length,s=[],o=0,l=t[0],a=0;r>0&&l>0&&(a+l+1>i&&(l=Math.max(1,i-a)),s.push(n.substring(r-=l,r+l)),!((a+=l+1)>i));)l=t[o=(o+1)%t.length];return s.reverse().join(e)}}function pg(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var gg=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ir(t){if(!(e=gg.exec(t)))throw new Error("invalid format: "+t);var e;return new Zr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ir.prototype=Zr.prototype;function Zr(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Zr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _g(t){e:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var xl;function vg(t,e){var n=nr(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(xl=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+nr(t,Math.max(0,e+s-1))[0]}function Al(t,e){var n=nr(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const Tl={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:hg,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Al(t*100,e),r:Al,s:vg,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Nl(t){return t}var Ol=Array.prototype.map,Pl=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function yg(t){var e=t.grouping===void 0||t.thousands===void 0?Nl:mg(Ol.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Nl:pg(Ol.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"−":t.minus+"",a=t.nan===void 0?"NaN":t.nan+"";function c(d){d=ir(d);var f=d.fill,h=d.align,m=d.sign,p=d.symbol,g=d.zero,_=d.width,S=d.comma,E=d.precision,w=d.trim,k=d.type;k==="n"?(S=!0,k="g"):Tl[k]||(E===void 0&&(E=12),w=!0,k="g"),(g||f==="0"&&h==="=")&&(g=!0,f="0",h="=");var T=p==="$"?n:p==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",M=p==="$"?i:/[%p]/.test(k)?o:"",C=Tl[k],x=/[defgprs%]/.test(k);E=E===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function P(L){var H=T,$=M,I,R,O;if(k==="c")$=C(L)+$,L="";else{L=+L;var V=L<0||1/L<0;if(L=isNaN(L)?a:C(Math.abs(L),E),w&&(L=_g(L)),V&&+L==0&&m!=="+"&&(V=!1),H=(V?m==="("?m:l:m==="-"||m==="("?"":m)+H,$=(k==="s"?Pl[8+xl/3]:"")+$+(V&&m==="("?")":""),x){for(I=-1,R=L.length;++I<R;)if(O=L.charCodeAt(I),48>O||O>57){$=(O===46?r+L.slice(I+1):L.slice(I))+$,L=L.slice(0,I);break}}}S&&!g&&(L=e(L,1/0));var q=H.length+L.length+$.length,B=q<_?new Array(_-q+1).join(f):"";switch(S&&g&&(L=e(B+L,B.length?_-$.length:1/0),B=""),h){case"<":L=H+L+$+B;break;case"=":L=H+B+L+$;break;case"^":L=B.slice(0,q=B.length>>1)+H+L+$+B.slice(q);break;default:L=B+H+L+$;break}return s(L)}return P.toString=function(){return d+""},P}function u(d,f){var h=c((d=ir(d),d.type="f",d)),m=Math.max(-8,Math.min(8,Math.floor(qn(f)/3)))*3,p=Math.pow(10,-m),g=Pl[8+m/3];return function(_){return h(p*_)+g}}return{format:c,formatPrefix:u}}var rr,Ll,Rl;bg({thousands:",",grouping:[3],currency:["$",""]});function bg(t){return rr=yg(t),Ll=rr.format,Rl=rr.formatPrefix,rr}function wg(t){return Math.max(0,-qn(Math.abs(t)))}function Sg(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(qn(e)/3)))*3-qn(Math.abs(t)))}function kg(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,qn(e)-qn(t))+1}function es(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}const Dl=Symbol("implicit");function $l(){var t=new Eo,e=[],n=[],i=Dl;function r(s){let o=t.get(s);if(o===void 0){if(i!==Dl)return i;t.set(s,o=e.push(s)-1)}return n[o%n.length]}return r.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new Eo;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return r},r.range=function(s){return arguments.length?(n=Array.from(s),r):n.slice()},r.unknown=function(s){return arguments.length?(i=s,r):i},r.copy=function(){return $l(e,n).unknown(i)},es.apply(r,arguments),r}function zl(){var t=$l().unknown(void 0),e=t.domain,n=t.range,i=0,r=1,s,o,l=!1,a=0,c=0,u=.5;delete t.unknown;function d(){var f=e().length,h=r<i,m=h?r:i,p=h?i:r;s=(p-m)/Math.max(1,f-a+c*2),l&&(s=Math.floor(s)),m+=(p-m-s*(f-a))*u,o=s*(1-a),l&&(m=Math.round(m),o=Math.round(o));var g=Di(f).map(function(_){return m+s*_});return n(h?g.reverse():g)}return t.domain=function(f){return arguments.length?(e(f),d()):e()},t.range=function(f){return arguments.length?([i,r]=f,i=+i,r=+r,d()):[i,r]},t.rangeRound=function(f){return[i,r]=f,i=+i,r=+r,l=!0,d()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(f){return arguments.length?(l=!!f,d()):l},t.padding=function(f){return arguments.length?(a=Math.min(1,c=+f),d()):a},t.paddingInner=function(f){return arguments.length?(a=Math.min(1,f),d()):a},t.paddingOuter=function(f){return arguments.length?(c=+f,d()):c},t.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),d()):u},t.copy=function(){return zl(e(),[i,r]).round(l).paddingInner(a).paddingOuter(c).align(u)},es.apply(d(),arguments)}function Eg(t){return function(){return t}}function Cg(t){return+t}var jl=[0,1];function Kn(t){return t}function ts(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Eg(isNaN(e)?NaN:.5)}function Ig(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function Mg(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=ts(r,i),s=n(o,s)):(i=ts(i,r),s=n(s,o)),function(l){return s(i(l))}}function xg(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=ts(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(l){var a=Gf(t,l,1,i)-1;return s[a](r[a](l))}}function Ag(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Tg(){var t=jl,e=jl,n=Hr,i,r,s,o=Kn,l,a,c;function u(){var f=Math.min(t.length,e.length);return o!==Kn&&(o=Ig(t[0],t[f-1])),l=f>2?xg:Mg,a=c=null,d}function d(f){return f==null||isNaN(f=+f)?s:(a||(a=l(t.map(i),e,n)))(i(o(f)))}return d.invert=function(f){return o(r((c||(c=l(e,t.map(i),Bt)))(f)))},d.domain=function(f){return arguments.length?(t=Array.from(f,Cg),u()):t.slice()},d.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},d.rangeRound=function(f){return e=Array.from(f),n=wm,u()},d.clamp=function(f){return arguments.length?(o=f?!0:Kn,u()):o!==Kn},d.interpolate=function(f){return arguments.length?(n=f,u()):n},d.unknown=function(f){return arguments.length?(s=f,d):s},function(f,h){return i=f,r=h,u()}}function Ng(){return Tg()(Kn,Kn)}function Og(t,e,n,i){var r=id(t,e,n),s;switch(i=ir(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(s=Sg(r,o))&&(i.precision=s),Rl(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=kg(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=wg(r))&&(i.precision=s-(i.type==="%")*2);break}}return Ll(i)}function Pg(t){var e=t.domain;return t.ticks=function(n){var i=e();return nd(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var r=e();return Og(r[0],r[r.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,s=i.length-1,o=i[r],l=i[s],a,c,u=10;for(l<o&&(c=o,o=l,l=c,c=r,r=s,s=c);u-- >0;){if(c=xr(o,l,n),c===a)return i[r]=o,i[s]=l,e(i);if(c>0)o=Math.floor(o/c)*c,l=Math.ceil(l/c)*c;else if(c<0)o=Math.ceil(o*c)/c,l=Math.floor(l*c)/c;else break;a=c}return t},t}function ns(){var t=Ng();return t.copy=function(){return Ag(t,ns())},es.apply(t,arguments),Pg(t)}const sr=t=>()=>t;function Lg(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function on(t,e,n){this.k=t,this.x=e,this.y=n}on.prototype={constructor:on,scale:function(t){return t===1?this:new on(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new on(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var is=new on(1,0,0);on.prototype;function rs(t){t.stopImmediatePropagation()}function mi(t){t.preventDefault(),t.stopImmediatePropagation()}function Rg(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Dg(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Fl(){return this.__zoom||is}function $g(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function zg(){return navigator.maxTouchPoints||"ontouchstart"in this}function jg(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function Vl(){var t=Rg,e=Dg,n=jg,i=$g,r=zg,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,a=Am,c=ri("start","zoom","end"),u,d,f,h=500,m=150,p=0,g=10;function _(I){I.property("__zoom",Fl).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",x).on("dblclick.zoom",P).filter(r).on("touchstart.zoom",L).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",$).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(I,R,O,V){var q=I.selection?I.selection():I;q.property("__zoom",Fl),I!==q?k(I,R,O,V):q.interrupt().each(function(){T(this,arguments).event(V).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},_.scaleBy=function(I,R,O,V){_.scaleTo(I,function(){var q=this.__zoom.k,B=typeof R=="function"?R.apply(this,arguments):R;return q*B},O,V)},_.scaleTo=function(I,R,O,V){_.transform(I,function(){var q=e.apply(this,arguments),B=this.__zoom,Y=O==null?w(q):typeof O=="function"?O.apply(this,arguments):O,oe=B.invert(Y),se=typeof R=="function"?R.apply(this,arguments):R;return n(E(S(B,se),Y,oe),q,o)},O,V)},_.translateBy=function(I,R,O,V){_.transform(I,function(){return n(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof O=="function"?O.apply(this,arguments):O),e.apply(this,arguments),o)},null,V)},_.translateTo=function(I,R,O,V,q){_.transform(I,function(){var B=e.apply(this,arguments),Y=this.__zoom,oe=V==null?w(B):typeof V=="function"?V.apply(this,arguments):V;return n(is.translate(oe[0],oe[1]).scale(Y.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof O=="function"?-O.apply(this,arguments):-O),B,o)},V,q)};function S(I,R){return R=Math.max(s[0],Math.min(s[1],R)),R===I.k?I:new on(R,I.x,I.y)}function E(I,R,O){var V=R[0]-O[0]*I.k,q=R[1]-O[1]*I.k;return V===I.x&&q===I.y?I:new on(I.k,V,q)}function w(I){return[(+I[0][0]+ +I[1][0])/2,(+I[0][1]+ +I[1][1])/2]}function k(I,R,O,V){I.on("start.zoom",function(){T(this,arguments).event(V).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(V).end()}).tween("zoom",function(){var q=this,B=arguments,Y=T(q,B).event(V),oe=e.apply(q,B),se=O==null?w(oe):typeof O=="function"?O.apply(q,B):O,ae=Math.max(oe[1][0]-oe[0][0],oe[1][1]-oe[0][1]),Q=q.__zoom,ue=typeof R=="function"?R.apply(q,B):R,ge=a(Q.invert(se).concat(ae/Q.k),ue.invert(se).concat(ae/ue.k));return function(te){if(te===1)te=ue;else{var le=ge(te),Z=ae/le[2];te=new on(Z,se[0]-le[0]*Z,se[1]-le[1]*Z)}Y.zoom(null,te)}})}function T(I,R,O){return!O&&I.__zooming||new M(I,R)}function M(I,R){this.that=I,this.args=R,this.active=0,this.sourceEvent=null,this.extent=e.apply(I,R),this.taps=0}M.prototype={event:function(I){return I&&(this.sourceEvent=I),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(I,R){return this.mouse&&I!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&I!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&I!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(I){var R=Ze(this.that).datum();c.call(I,this.that,new Lg(I,{sourceEvent:this.sourceEvent,target:_,type:I,transform:this.that.__zoom,dispatch:c}),R)}};function C(I,...R){if(!t.apply(this,arguments))return;var O=T(this,R).event(I),V=this.__zoom,q=Math.max(s[0],Math.min(s[1],V.k*Math.pow(2,i.apply(this,arguments)))),B=ct(I);if(O.wheel)(O.mouse[0][0]!==B[0]||O.mouse[0][1]!==B[1])&&(O.mouse[1]=V.invert(O.mouse[0]=B)),clearTimeout(O.wheel);else{if(V.k===q)return;O.mouse=[B,V.invert(B)],tr(this),O.start()}mi(I),O.wheel=setTimeout(Y,m),O.zoom("mouse",n(E(S(V,q),O.mouse[0],O.mouse[1]),O.extent,o));function Y(){O.wheel=null,O.end()}}function x(I,...R){if(f||!t.apply(this,arguments))return;var O=I.currentTarget,V=T(this,R,!0).event(I),q=Ze(I.view).on("mousemove.zoom",se,!0).on("mouseup.zoom",ae,!0),B=ct(I,O),Y=I.clientX,oe=I.clientY;Uo(I.view),rs(I),V.mouse=[B,this.__zoom.invert(B)],tr(this),V.start();function se(Q){if(mi(Q),!V.moved){var ue=Q.clientX-Y,ge=Q.clientY-oe;V.moved=ue*ue+ge*ge>p}V.event(Q).zoom("mouse",n(E(V.that.__zoom,V.mouse[0]=ct(Q,O),V.mouse[1]),V.extent,o))}function ae(Q){q.on("mousemove.zoom mouseup.zoom",null),Bo(Q.view,V.moved),mi(Q),V.event(Q).end()}}function P(I,...R){if(t.apply(this,arguments)){var O=this.__zoom,V=ct(I.changedTouches?I.changedTouches[0]:I,this),q=O.invert(V),B=O.k*(I.shiftKey?.5:2),Y=n(E(S(O,B),V,q),e.apply(this,R),o);mi(I),l>0?Ze(this).transition().duration(l).call(k,Y,V,I):Ze(this).call(_.transform,Y,V,I)}}function L(I,...R){if(t.apply(this,arguments)){var O=I.touches,V=O.length,q=T(this,R,I.changedTouches.length===V).event(I),B,Y,oe,se;for(rs(I),Y=0;Y<V;++Y)oe=O[Y],se=ct(oe,this),se=[se,this.__zoom.invert(se),oe.identifier],q.touch0?!q.touch1&&q.touch0[2]!==se[2]&&(q.touch1=se,q.taps=0):(q.touch0=se,B=!0,q.taps=1+!!u);u&&(u=clearTimeout(u)),B&&(q.taps<2&&(d=se[0],u=setTimeout(function(){u=null},h)),tr(this),q.start())}}function H(I,...R){if(this.__zooming){var O=T(this,R).event(I),V=I.changedTouches,q=V.length,B,Y,oe,se;for(mi(I),B=0;B<q;++B)Y=V[B],oe=ct(Y,this),O.touch0&&O.touch0[2]===Y.identifier?O.touch0[0]=oe:O.touch1&&O.touch1[2]===Y.identifier&&(O.touch1[0]=oe);if(Y=O.that.__zoom,O.touch1){var ae=O.touch0[0],Q=O.touch0[1],ue=O.touch1[0],ge=O.touch1[1],te=(te=ue[0]-ae[0])*te+(te=ue[1]-ae[1])*te,le=(le=ge[0]-Q[0])*le+(le=ge[1]-Q[1])*le;Y=S(Y,Math.sqrt(te/le)),oe=[(ae[0]+ue[0])/2,(ae[1]+ue[1])/2],se=[(Q[0]+ge[0])/2,(Q[1]+ge[1])/2]}else if(O.touch0)oe=O.touch0[0],se=O.touch0[1];else return;O.zoom("touch",n(E(Y,oe,se),O.extent,o))}}function $(I,...R){if(this.__zooming){var O=T(this,R).event(I),V=I.changedTouches,q=V.length,B,Y;for(rs(I),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),B=0;B<q;++B)Y=V[B],O.touch0&&O.touch0[2]===Y.identifier?delete O.touch0:O.touch1&&O.touch1[2]===Y.identifier&&delete O.touch1;if(O.touch1&&!O.touch0&&(O.touch0=O.touch1,delete O.touch1),O.touch0)O.touch0[1]=this.__zoom.invert(O.touch0[0]);else if(O.end(),O.taps===2&&(Y=ct(Y,this),Math.hypot(d[0]-Y[0],d[1]-Y[1])<g)){var oe=Ze(this).on("dblclick.zoom");oe&&oe.apply(this,arguments)}}}return _.wheelDelta=function(I){return arguments.length?(i=typeof I=="function"?I:sr(+I),_):i},_.filter=function(I){return arguments.length?(t=typeof I=="function"?I:sr(!!I),_):t},_.touchable=function(I){return arguments.length?(r=typeof I=="function"?I:sr(!!I),_):r},_.extent=function(I){return arguments.length?(e=typeof I=="function"?I:sr([[+I[0][0],+I[0][1]],[+I[1][0],+I[1][1]]]),_):e},_.scaleExtent=function(I){return arguments.length?(s[0]=+I[0],s[1]=+I[1],_):[s[0],s[1]]},_.translateExtent=function(I){return arguments.length?(o[0][0]=+I[0][0],o[1][0]=+I[1][0],o[0][1]=+I[0][1],o[1][1]=+I[1][1],_):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},_.constrain=function(I){return arguments.length?(n=I,_):n},_.duration=function(I){return arguments.length?(l=+I,_):l},_.interpolate=function(I){return arguments.length?(a=I,_):a},_.on=function(){var I=c.on.apply(c,arguments);return I===c?_:I},_.clickDistance=function(I){return arguments.length?(p=(I=+I)*I,_):Math.sqrt(p)},_.tapDistance=function(I){return arguments.length?(g=+I,_):g},_}function Fg(t,e,n=null,i,r=null){const s=Ze(t);s.selectAll("*").remove();const o=s.node(),l=o.getBoundingClientRect();let a=l.width||800,c=l.height||600;const u=a/2,d=c/2,f=s.append("canvas").attr("class","network-canvas").attr("width",a).attr("height",c).style("width",a+"px").style("height",c+"px").style("cursor","default"),h=f.node().getContext("2d",{alpha:!1});let m=is;const p=new Set,g={current:null};function _(){const L=o.getBoundingClientRect(),H=L.width||800,$=L.height||600;(H!==a||$!==c)&&(a=H,c=$,f.attr("width",a).attr("height",c).style("width",a+"px").style("height",c+"px"),P())}const S=new ResizeObserver(_);S.observe(o);const E=El(e).force("link",Sl(n).id(L=>L.id).distance(L=>L.distance)).force("charge",Cl().strength(-250)).force("center",_l(u,d).strength(.7)).force("collide",bl(L=>L.radius+10).strength(.5)).force("x",Il(u).strength(.025)).force("y",Ml(d).strength(.025)).alphaDecay(.05).velocityDecay(.6);let w=null;E.on("tick",()=>{w||(w=requestAnimationFrame(()=>{P(),w=null}))}),E.tick(100);for(let L=0;L<100;L++)E.tick();E.alphaTarget(0);const k=Vg({canvas:f,nodes:e,transform:()=>m,hoveredNode:g,onSelectionChange:(L,H)=>{p.clear(),L.forEach(I=>p.add(I));const $=Ug(e,L,H);i($),P()},render:()=>P()}),T=Vl().scaleExtent([.1,10]).filter(L=>!k.isSelectionMode()||L.type==="wheel").on("zoom",({transform:L})=>{m=L,P()});f.call(T);const{dragstarted:M,dragged:C,dragended:x}=Hg(f,e,E,()=>m,g,()=>!k.isSelectionMode(),P);k.setupInteractions(f,{start:M,drag:C,end:x});function P(){h.save(),h.fillRect(0,0,a,c),h.translate(m.x,m.y),h.scale(m.k,m.k),h.strokeStyle="#8a8a8a",h.lineWidth=1/m.k,n.forEach(H=>{const $=H.source.x,I=H.source.y,R=H.target.x,O=H.target.y;h.globalAlpha=Math.max(.2,H.strength),h.lineWidth=H.width/m.k,h.beginPath(),h.moveTo($,I),h.lineTo(R,O),h.stroke()}),h.globalAlpha=1,e.forEach(H=>{const $=p.has(H.id);h.fillStyle=H.color,h.beginPath(),h.arc(H.x,H.y,H.radius,0,2*Math.PI),h.fill(),$&&(h.strokeStyle="#0f2bff",h.lineWidth=3/m.k,h.stroke())});const L=k.getSelectionRect();if(L){h.strokeStyle="#0f2bff",h.fillStyle="rgba(15, 43, 255, 0.2)",h.lineWidth=2/m.k;const H=Math.min(L.x1,L.x2),$=Math.min(L.y1,L.y2),I=Math.abs(L.x2-L.x1),R=Math.abs(L.y2-L.y1);h.fillRect(H,$,I,R),h.strokeRect(H,$,I,R)}h.restore()}return P(),{destroy:()=>{w&&cancelAnimationFrame(w),E.stop(),S.disconnect(),f.remove()},toggleSelectionMode:()=>{const L=k.toggleSelectionMode();return r&&r(L),P(),L}}}function Vg(t){const{canvas:e,nodes:n,transform:i,hoveredNode:r,onSelectionChange:s,render:o}=t,l=new Set,a=[];let c=!1,u=null;function d(){return c=!c,e.style("cursor",c?"crosshair":"default"),c}function f(p){if(l.has(p)){l.delete(p);const g=a.indexOf(p);g>-1&&a.splice(g,1)}else l.add(p),a.push(p);s(l,a)}function h(p,g){const _=i(),S=(p-_.x)/_.k,E=(g-_.y)/_.k;for(let w=n.length-1;w>=0;w--){const k=n[w],T=S-k.x,M=E-k.y;if(Math.sqrt(T*T+M*M)<k.radius)return k}return null}function m(p,g){let _=null;p.on("mousedown",function(S){const[E,w]=ct(S),k=h(E,w);if(c){const T=i(),M=(E-T.x)/T.k,C=(w-T.y)/T.k;u={x1:M,y1:C,x2:M,y2:C},o()}else k&&(_=k,g.start(S,k))}),p.on("mousemove",function(S){const[E,w]=ct(S);if(c){if(u){const k=i(),T=(E-k.x)/k.k,M=(w-k.y)/k.k;u.x2=T,u.y2=M,o()}}else if(_)g.drag(S,_,E,w);else{const k=h(E,w);r.current!==k&&(r.current=k,p.style("cursor",k?"pointer":"default"),o())}}),p.on("mouseup",function(S){if(c){if(u){const E=Math.min(u.x1,u.x2),w=Math.min(u.y1,u.y2),k=Math.max(u.x1,u.x2),T=Math.max(u.y1,u.y2);l.clear(),a.length=0;const M=[];n.forEach(C=>{C.x>=E&&C.x<=k&&C.y>=w&&C.y<=T&&M.push({id:C.id,y:C.y})}),M.sort((C,x)=>C.y-x.y),M.forEach(({id:C})=>{l.add(C),a.push(C)}),s(l,a),u=null,o()}}else if(_)g.end(S,_),_=null;else{const[E,w]=ct(S),k=h(E,w);k&&f(k.id)}})}return{toggleSelectionMode:d,isSelectionMode:()=>c,setupInteractions:m,getSelectionRect:()=>u}}function Hg(t,e,n,i,r,s,o){let l=null;function a(d,f){s()&&(d.active||n.alphaTarget(.3).restart(),l=f,f.fx=f.x,f.fy=f.y)}function c(d,f,h,m){if(!l||!s())return;const p=i();f.fx=(h-p.x)/p.k,f.fy=(m-p.y)/p.k,o()}function u(d,f){!l||!s()||(d.active||n.alphaTarget(0),f.fx=null,f.fy=null,l=null)}return{dragstarted:a,dragged:c,dragended:u}}function Ug(t,e,n){const i=new Map(t.map(r=>[r.id,r]));return n.map(r=>i.get(r)).filter(Boolean)}const Hl=8,Bg=1.5,qg=50,Ul=.5,Kg=800,Wg=600;function Yg(t,e,n=null,i=null,r=null){const s=Kg/2,o=Wg/2,a=Ze(t).append("svg").attr("class","network-svg"),c=a.append("g"),u=c.append("g").selectAll("line").data(n).join("line").attr("class","link").attr("stroke-width",m=>m.width||Bg).attr("stroke-opacity",m=>Math.max(.2,m.strength||Ul)),d=c.append("g").selectAll("circle").data(e).join("circle").attr("class","node").attr("r",m=>m.radius||Hl).attr("fill",m=>m.color);d.append("title").text(m=>m.label);const f=El(e).force("link",Sl(n).id(m=>m.id).distance(m=>m.distance||qg)).force("charge",Cl().strength(-250)).force("center",_l(s,o).strength(.7)).force("collide",bl(m=>(m.radius||Hl)+10).strength(Ul)).force("x",Il(s).strength(.025)).force("y",Ml(o).strength(.025));let h=null;if(i){h=Gg({svg:a,g:c,nodes:e,onSelectionChange:(_,S)=>{d.classed("selected",w=>_.has(w.id));const E=Jg(e,_,S);i(E)}}),a.call(Vl().scaleExtent([.1,10]).filter(_=>!h.isSelectionMode()||_.type==="wheel").on("zoom",({transform:_})=>c.attr("transform",_)));const{dragstarted:m,dragged:p,dragended:g}=Xg(f,u,d);h.setupNodeClick(d),h.setupDrag(d,{start:m,drag:p,end:g})}return{destroy:()=>{f.stop(),a.remove()},toggleSelectionMode:()=>{if(h){const m=h.toggleSelectionMode();return r&&r(m),m}}}}function Gg(t){const{svg:e,g:n,nodes:i,onSelectionChange:r,getNodePosition:s=p=>({x:p.x,y:p.y}),getNodeId:o=p=>p.id}=t,l=new Set,a=[];let c=!1;function u(){return c=!c,e.style("cursor",c?"crosshair":"default"),c}function d(p){if(l.has(p)){l.delete(p);const g=a.indexOf(p);g>-1&&a.splice(g,1)}else l.add(p),a.push(p);r(l,a)}function f(){l.clear(),a.length=0,r(l,a)}let h=null,m=null;return e.on("mousedown",function(p){if(!c)return;p.preventDefault();const[g,_]=ct(p,n.node());h={x:g,y:_},m=n.append("rect").attr("class","selection-rect").attr("x",g).attr("y",_).attr("width",0).attr("height",0)}).on("mousemove",function(p){if(!c||!m)return;const[g,_]=ct(p,n.node()),S=g-h.x,E=_-h.y;m.attr("x",S<0?g:h.x).attr("y",E<0?_:h.y).attr("width",Math.abs(S)).attr("height",Math.abs(E))}).on("mouseup",function(p){if(!c||!m)return;const[g,_]=ct(p,n.node()),S=Math.min(h.x,g),E=Math.min(h.y,_),w=Math.max(h.x,g),k=Math.max(h.y,_);l.clear(),a.length=0;const T=[];i.forEach(M=>{const C=s(M);C.x>=S&&C.x<=w&&C.y>=E&&C.y<=k&&T.push({id:o(M),y:C.y})}),T.sort((M,C)=>M.y-C.y),T.forEach(({id:M})=>{l.add(M),a.push(M)}),r(l,a),m.remove(),m=null,h=null}),{toggleSelectionMode:u,toggleNode:d,clearSelection:f,isSelectionMode:()=>c,getSelectedNodes:()=>l,getSelectionOrder:()=>a,setupNodeClick:p=>{p.on("click",function(g,_){g.stopPropagation(),d(o(_))})},setupDrag:(p,g)=>{p.call(Zh().filter(()=>!c).on("start",g.start).on("drag",g.drag).on("end",g.end))}}}function Xg(t,e,n){t.on("tick",()=>{e.attr("x1",o=>o.source.x).attr("y1",o=>o.source.y).attr("x2",o=>o.target.x).attr("y2",o=>o.target.y),n.attr("cx",o=>o.x).attr("cy",o=>o.y)});function i(o){o.active||t.alphaTarget(.3).restart(),o.subject.fx=o.subject.x,o.subject.fy=o.subject.y}function r(o){o.subject.fx=o.x,o.subject.fy=o.y}function s(o){o.active||t.alphaTarget(0),o.subject.fx=null,o.subject.fy=null}return{dragstarted:i,dragged:r,dragended:s}}function Jg(t,e,n){const i=new Map(t.map(r=>[r.id,r]));return n.map(r=>i.get(r)).filter(Boolean)}const Qg="modulepreload",Zg=function(t){return"/"+t},Bl={},ss=function(e,n,i){return e()};function os(t){const{type:e,modelName:n,title:i,extractMeta:r=h=>h}=t,s={id:null,type:e,title:i,selected:{}},o=JSON.parse(localStorage.getItem(e))||s,l=Te(o),a=Te(!1);function c(h,m=!1){a.set(m),localStorage.setItem(e,JSON.stringify(h))}function u(){l.update(h=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),h;const m=Object.fromEntries(Object.entries(h.selected).map(([g,_])=>[g,Object.keys(_)])),p=h.id?`${h.id}/edit`:"new";return fetch(`${window.location.origin}/${n}/${p}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":dn},body:JSON.stringify({title:h.title,selection:h,...m})}).then(g=>g.json()).then(g=>{if(!(g!=null&&g.document_set_id))throw new Error("Failed to save");l.update(_=>(_.id=g.document_set_id,_.title=g.document_set_title,c(_,!0),_))}).catch(g=>console.error("Error:",g)),h})}const d=h=>l.update(()=>{const m=h.selection.id?h.selection:{...h.selection,id:h.id};return c(m),m}),f=()=>l.update(()=>{const h={...s,selected:{}};return c(h),h});return{type:e,subscribe:l.subscribe,add:h=>l.update(m=>(m.selected[h.class]={...m.selected[h.class]||{},[h.id]:r(h)},c(m),m)),addAll:h=>l.update(m=>(h.forEach(p=>{m.selected[p.class]={...m.selected[p.class]||{},[p.id]:r(p)}}),c(m),m)),remove:(h,m)=>l.update(p=>{const{[h]:g,..._}=p.selected[m];return p.selected[m]=_,c(p),p}),removeAll:(h,m)=>l.update(p=>(h.forEach(g=>{var _;return(_=p.selected[m])==null?!0:delete _[g]}),c(p),p)),toggle:h=>l.update(m=>{var p;if((p=m.selected[h.class])!=null&&p[h.id]){const{[h.id]:g,..._}=m.selected[h.class];m.selected[h.class]=_}else m.selected[h.class]={...m.selected[h.class]||{},[h.id]:r(h)};return c(m),m}),toggleSet:h=>{lt(l).id===h.id?f():d(h)},empty:()=>l.update(h=>(h.id=null,h.title=i,h.selected={},c(h,!0),h)),updateTitle:h=>l.update(m=>(m.title=h,c(m,!0),m)),save:u,isSaved:a,selection:l,selectionTitle:nt(l,h=>h.title),isSelected:nt(l,h=>m=>{var p;return((p=h.selected[m.class])==null?void 0:p[m.id])||!1}),selected:nt(l,h=>h.selected),nbSelected:nt(l,h=>Object.values(h.selected).reduce((m,p)=>m+Object.keys(p).length,0)),isSetSelected:nt(l,h=>m=>h.id===m.id)}}os({type:"documentSet",modelName:"document-set",title:W==="en"?"Document set":"Set de documents",extractMeta:t=>({title:t.title,url:t.url})});const e_=os({type:"regionsSet",modelName:"regions-set",title:W==="en"?"Regions set":"Set de régions",extractMeta:t=>t});function t_(t){const[e,...n]=t.split("_");return n.join("_")}const or=os({type:"clusterSet",modelName:"cluster-set",title:W==="en"?"Selected regions":"Régions sélectionnées",extractMeta:t=>({imgRef:t.id,clusterId:t.clusterId,title:t.title,xywh:t.xywh,img:t_(t.id)})});function n_(){const t=`${window.location.origin}${window.location.pathname}`,e=Te(1),n=Te({}),i=Te({}),r=Te("");wr(e,"p");function s(u){r.update(d=>{const f=d===u?"":u;return navigator.clipboard.writeText(f).then(h=>""),f})}const o=(async()=>{try{const u=await fetch(`${t}canvas`);if(!u.ok)return{};const d=await u.json();let f={};return Object.values(d).forEach(h=>{Object.entries(h).forEach(([m,p])=>{f[m]=p})}),n.set(f),d}catch{return{}}})(),l=nt(e,u=>(async()=>{const f=await(await fetch(`${t}canvas?p=${u}`)).json();return i.set(f),f})());function a(u){Sr(u,e,"p")}function c(u){n.update(d=>(delete d[u],{...d})),i.update(d=>{for(const f in d)if(d[f][u]){const{[u]:h,...m}=d[f];return d[f]=m,d}return d})}return{currentPage:e,pageRegions:i,allRegions:n,fetchPages:l,fetchAll:o,handlePageUpdate:a,remove:c,clipBoard:r,copyRef:s}}const ql=n_(),Gy="";function i_(t){let e;return{c(){e=jt("path"),v(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),v(e,"class","svelte-1829hp2")},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function r_(t){let e;return{c(){e=jt("path"),v(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),v(e,"class","svelte-1829hp2")},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function s_(t){let e=W==="en"?"Copy ID":"Copier l'ID",n;return{c(){n=re(e)},m(i,r){z(i,n,r)},p:ee,d(i){i&&D(n)}}}function o_(t){let e=W==="en"?"Copied!":"Copié !",n;return{c(){n=re(e)},m(i,r){z(i,n,r)},p:ee,d(i){i&&D(n)}}}function Kl(t){let e,n,i;var r=t[7];function s(o){return{props:{mainImgItem:o[1],compareImgItem:o[14]}}}return r&&(e=ki(r,s(t))),{c(){e&&me(e.$$.fragment),n=ht()},m(o,l){e&&de(e,o,l),z(o,n,l),i=!0},p(o,l){const a={};if(l&2&&(a.mainImgItem=o[1]),l&128&&r!==(r=o[7])){if(e){ze();const c=e;K(c.$$.fragment,1,0,()=>{he(c,1)}),je()}r?(e=ki(r,s(o)),me(e.$$.fragment),U(e.$$.fragment,1),de(e,n.parentNode,n)):e=null}else r&&e.$set(a)},i(o){i||(e&&U(e.$$.fragment,o),i=!0)},o(o){e&&K(e.$$.fragment,o),i=!1},d(o){o&&D(n),e&&he(e,o)}}}function l_(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g,_,S,E,w,k,T,M;function C(R,O){return R[8]?r_:i_}let x=C(t),P=x(t);function L(R,O){return R[8]?o_:s_}let H=L(t),$=H(t),I=t[7]&&Kl(t);return{c(){e=b("div"),n=b("figure"),i=b("img"),s=F(),o=b("div"),l=b("span"),u=F(),d=b("div"),f=b("button"),h=jt("svg"),P.c(),m=F(),p=b("span"),$.c(),_=F(),I&&I.c(),v(i,"class","region-img svelte-1829hp2"),vt(i.src,r=t[9])||v(i,"src",r),v(i,"alt","Extracted region"),v(l,"class","overlay-desc"),v(o,"class","overlay is-center svelte-1829hp2"),v(n,"class",a="image card region-image "+(t[0]?"is-96x96":"")+" svelte-1829hp2"),v(n,"tabindex","-1"),v(n,"style",c=(t[2]==="full"?"height: 100%":`height: ${t[2]}px; min-width: ${t[2]}px`)+"; "+(t[3]?`border: 5px solid ${t[3]};`:"")),v(h,"xmlns","http://www.w3.org/2000/svg"),v(h,"viewBox","0 0 384 512"),v(h,"class","svelte-1829hp2"),v(p,"class","tooltip svelte-1829hp2"),v(f,"class","button tag svelte-1829hp2"),v(f,"style",g=t[6]?"":"display: none;"),v(d,"class","region-btn ml-1 svelte-1829hp2"),v(e,"class",S="region is-center "+(t[5]&&t[11](t[1])?"checked":"")+" svelte-1829hp2"),v(e,"style",E=t[2]==="full"?"height: 100%":"")},m(R,O){z(R,e,O),y(e,n),y(n,i),y(n,s),y(n,o),y(o,l),l.innerHTML=t[10],y(e,u),y(e,d),y(d,f),y(f,h),P.m(h,null),y(f,m),y(f,p),$.m(p,null),y(d,_),I&&I.m(d,null),k=!0,T||(M=[Se(n,"click",t[19]),Se(n,"keyup",a_),Se(f,"click",t[20])],T=!0)},p(R,[O]){t=R,(!k||O&512&&!vt(i.src,r=t[9]))&&v(i,"src",r),(!k||O&1024)&&(l.innerHTML=t[10]),(!k||O&1&&a!==(a="image card region-image "+(t[0]?"is-96x96":"")+" svelte-1829hp2"))&&v(n,"class",a),(!k||O&12&&c!==(c=(t[2]==="full"?"height: 100%":`height: ${t[2]}px; min-width: ${t[2]}px`)+"; "+(t[3]?`border: 5px solid ${t[3]};`:"")))&&v(n,"style",c),x!==(x=C(t))&&(P.d(1),P=x(t),P&&(P.c(),P.m(h,null))),H===(H=L(t))&&$?$.p(t,O):($.d(1),$=H(t),$&&($.c(),$.m(p,null))),(!k||O&64&&g!==(g=t[6]?"":"display: none;"))&&v(f,"style",g),t[7]?I?(I.p(t,O),O&128&&U(I,1)):(I=Kl(t),I.c(),U(I,1),I.m(d,null)):I&&(ze(),K(I,1,1,()=>{I=null}),je()),(!k||O&2082&&S!==(S="region is-center "+(t[5]&&t[11](t[1])?"checked":"")+" svelte-1829hp2"))&&v(e,"class",S),(!k||O&4&&E!==(E=t[2]==="full"?"height: 100%":""))&&v(e,"style",E)},i(R){k||(U(I),Wt(()=>{k&&(w||(w=fn(e,jn,{duration:t[15]},!0)),w.run(1))}),k=!0)},o(R){K(I),w||(w=fn(e,jn,{duration:t[15]},!1)),w.run(0),k=!1},d(R){R&&D(e),P.d(),$.d(),I&&I.d(),R&&w&&w.end(),T=!1,ot(M)}}}const a_=()=>null;function c_(t,e,n){let i,r,s,o,l,{selectionStore:a}=e;a||(a=e_);const{isSelected:c}=a;we(t,c,x=>n(11,l=x));const{clipBoard:u}=ql;we(t,u,x=>n(18,o=x));let{item:d}=e,{descPromise:f=void 0}=e,{isSquare:h=!0}=e,{height:m=h?96:140}=e;m==="full"&&(h=!1);let{borderColor:p=null}=e,{toggleSelection:g=a.toggle}=e;const _=Nt("qImgMetadata")||void 0,S=Nt("isInModal")||!1,E=S?0:500;let w;S||ss(()=>Promise.resolve().then(()=>o1),void 0).then(x=>n(7,w=x.default));let{selectable:k=!S}=e,{copyable:T=!0}=e;const M=()=>k?g(d):null,C=()=>T?ql.copyRef(d.ref):null;return t.$$set=x=>{"selectionStore"in x&&n(16,a=x.selectionStore),"item"in x&&n(1,d=x.item),"descPromise"in x&&n(17,f=x.descPromise),"isSquare"in x&&n(0,h=x.isSquare),"height"in x&&n(2,m=x.height),"borderColor"in x&&n(3,p=x.borderColor),"toggleSelection"in x&&n(4,g=x.toggleSelection),"selectable"in x&&n(5,k=x.selectable),"copyable"in x&&n(6,T=x.copyable)},t.$$.update=()=>{t.$$.dirty&2&&n(10,i=d.title),t.$$.dirty&131072&&f&&f.then(x=>n(10,i=x)),t.$$.dirty&7&&n(9,r=Vt(d.img??d.ref,d.xywh,m==="full"?m:h?`${m},`:`,${m}`)),t.$$.dirty&262146&&n(8,s=d.ref===o)},[h,d,m,p,g,k,T,w,s,r,i,l,c,u,_,E,a,f,o,M,C]}class Wn extends Ae{constructor(e){super(),xe(this,e,c_,l_,Me,{selectionStore:16,item:1,descPromise:17,isSquare:0,height:2,borderColor:3,toggleSelection:4,selectable:5,copyable:6})}}const Xy="";function Wl(t,e,n){const i=t.slice();return i[11]=e[n],i}function Yl(t,e,n){const i=t.slice();return i[14]=e[n],i}function ls(t){const e=t.slice(),n=e[2].get(e[11][e[14]].id);return e[17]=n,e}function Gl(t,e,n){const i=t.slice();return i[14]=e[n],i}function Xl(t){let e,n,i,r,s,o,l,a,c,u,d=t[0].regions,f=[];for(let _=0;_<d.length;_+=1)f[_]=Jl(Gl(t,d,_));const h=_=>K(f[_],1,1,()=>{f[_]=null});let m=t[0].rows,p=[];for(let _=0;_<m.length;_+=1)p[_]=ea(Wl(t,m,_));const g=_=>K(p[_],1,1,()=>{p[_]=null});return{c(){e=b("div"),n=b("h3"),n.textContent="Aligned Documents",i=F(),r=b("div"),s=b("table"),o=b("thead"),l=b("tr");for(let _=0;_<f.length;_+=1)f[_].c();a=F(),c=b("tbody");for(let _=0;_<p.length;_+=1)p[_].c();v(n,"class","title is-5"),v(o,"class","region-header svelte-1hxxzoa"),v(s,"class","table is-fullwidth svelte-1hxxzoa"),v(r,"class","table-container svelte-1hxxzoa"),v(e,"class","box mt-4")},m(_,S){z(_,e,S),y(e,n),y(e,i),y(e,r),y(r,s),y(s,o),y(o,l);for(let E=0;E<f.length;E+=1)f[E]&&f[E].m(l,null);y(s,a),y(s,c);for(let E=0;E<p.length;E+=1)p[E]&&p[E].m(c,null);u=!0},p(_,S){if(S&3){d=_[0].regions;let E;for(E=0;E<d.length;E+=1){const w=Gl(_,d,E);f[E]?(f[E].p(w,S),U(f[E],1)):(f[E]=Jl(w),f[E].c(),U(f[E],1),f[E].m(l,null))}for(ze(),E=d.length;E<f.length;E+=1)h(E);je()}if(S&77){m=_[0].rows;let E;for(E=0;E<m.length;E+=1){const w=Wl(_,m,E);p[E]?(p[E].p(w,S),U(p[E],1)):(p[E]=ea(w),p[E].c(),U(p[E],1),p[E].m(c,null))}for(ze(),E=m.length;E<p.length;E+=1)g(E);je()}},i(_){if(!u){for(let S=0;S<d.length;S+=1)U(f[S]);for(let S=0;S<m.length;S+=1)U(p[S]);u=!0}},o(_){f=f.filter(Boolean);for(let S=0;S<f.length;S+=1)K(f[S]);p=p.filter(Boolean);for(let S=0;S<p.length;S+=1)K(p[S]);u=!1},d(_){_&&D(e),at(f,_),at(p,_)}}}function Jl(t){let e,n,i,r;return n=new Qs({props:{id:t[14],meta:t[1].get(t[14])||{},clickable:!1}}),{c(){e=b("th"),me(n.$$.fragment),i=F(),v(e,"class","is-vcentered")},m(s,o){z(s,e,o),de(n,e,null),y(e,i),r=!0},p(s,o){const l={};o&1&&(l.id=s[14]),o&3&&(l.meta=s[1].get(s[14])||{}),n.$set(l)},i(s){r||(U(n.$$.fragment,s),r=!0)},o(s){K(n.$$.fragment,s),r=!1},d(s){s&&D(e),he(n)}}}function Ql(t){let e,n,i,r,s=t[11][t[14]].page+"",o,l;return e=new Wn({props:{item:t[17],selectable:!1,copyable:!1,borderColor:t[6](t[11][t[14]],t[3]),isSquare:!1}}),{c(){me(e.$$.fragment),n=F(),i=b("div"),r=re("Page "),o=re(s),v(i,"class","has-text-grey-dark mt-2")},m(a,c){de(e,a,c),z(a,n,c),z(a,i,c),y(i,r),y(i,o),l=!0},p(a,c){const u={};c&5&&(u.item=a[17]),c&9&&(u.borderColor=a[6](a[11][a[14]],a[3])),e.$set(u),(!l||c&1)&&s!==(s=a[11][a[14]].page+"")&&Ee(o,s)},i(a){l||(U(e.$$.fragment,a),l=!0)},o(a){K(e.$$.fragment,a),l=!1},d(a){he(e,a),a&&D(n),a&&D(i)}}}function Zl(t){let e,n,i=t[11][t[14]]&&Ql(ls(t));return{c(){e=b("td"),i&&i.c(),v(e,"class","has-text-centered"),De(e,"vertical-align","top")},m(r,s){z(r,e,s),i&&i.m(e,null),n=!0},p(r,s){r[11][r[14]]?i?(i.p(ls(r),s),s&1&&U(i,1)):(i=Ql(ls(r)),i.c(),U(i,1),i.m(e,null)):i&&(ze(),K(i,1,1,()=>{i=null}),je())},i(r){n||(U(i),n=!0)},o(r){K(i),n=!1},d(r){r&&D(e),i&&i.d()}}}function ea(t){let e,n,i,r=t[0].regions,s=[];for(let l=0;l<r.length;l+=1)s[l]=Zl(Yl(t,r,l));const o=l=>K(s[l],1,1,()=>{s[l]=null});return{c(){e=b("tr");for(let l=0;l<s.length;l+=1)s[l].c();n=F()},m(l,a){z(l,e,a);for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(e,null);y(e,n),i=!0},p(l,a){if(a&77){r=l[0].regions;let c;for(c=0;c<r.length;c+=1){const u=Yl(l,r,c);s[c]?(s[c].p(u,a),U(s[c],1)):(s[c]=Zl(u),s[c].c(),U(s[c],1),s[c].m(e,n))}for(ze(),c=r.length;c<s.length;c+=1)o(c);je()}},i(l){if(!i){for(let a=0;a<r.length;a+=1)U(s[a]);i=!0}},o(l){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)K(s[a]);i=!1},d(l){l&&D(e),at(s,l)}}}function u_(t){let e,n,i=t[0]&&Xl(t);return{c(){i&&i.c(),e=ht()},m(r,s){i&&i.m(r,s),z(r,e,s),n=!0},p(r,[s]){r[0]?i?(i.p(r,s),s&1&&U(i,1)):(i=Xl(r),i.c(),U(i,1),i.m(e.parentNode,e)):i&&(ze(),K(i,1,1,()=>{i=null}),je())},i(r){n||(U(i),n=!0)},o(r){K(i),n=!1},d(r){i&&i.d(r),r&&D(e)}}}function f_(t){let e=0;for(let o=0;o<t.length;o++)e=t.charCodeAt(o)+((e<<5)-e),e=e&e;const i=e*.618033988749895%1*360,r=65+e%20,s=80+e%10;return`hsl(${Math.floor(i)}, ${r}%, ${s}%)`}function d_(t,e,n){let i,r,s,{selectedDocuments:o=[]}=e,{documentSetStore:l}=e;const{buildAlignedImageMatrix:a,documentNodes:c,imageNodes:u}=l;we(t,c,m=>n(1,r=m)),we(t,u,m=>n(2,s=m));let d=null;function f(m,p){if(!m)return;const g=m.id;if(p.get(g)!==1)return h.has(g)||h.set(g,f_(g)),h.get(g)}const h=new Map;return t.$$set=m=>{"selectedDocuments"in m&&n(7,o=m.selectedDocuments),"documentSetStore"in m&&n(8,l=m.documentSetStore)},t.$$.update=()=>{if(t.$$.dirty&134)if(o.length>0&&s&&r){const m=o.map(p=>p.id);n(0,d=a(m))}else n(0,d=null);t.$$.dirty&1&&n(3,i=d?(()=>{const m=new Map;return d.rows.forEach(p=>{Object.values(p).forEach(g=>{m.set(g.id,(m.get(g.id)||0)+1)})}),m})():new Map)},[d,r,s,i,c,u,f,o,l]}class h_ extends Ae{constructor(e){super(),xe(this,e,d_,u_,Me,{selectedDocuments:7,documentSetStore:8})}}const Jy="";function ta(t,e,n){const i=t.slice();return i[15]=e[n],i}function m_(t){let e;return{c(){e=b("span"),e.innerHTML='<i class="fas fa-crop-alt"></i>',v(e,"class","icon px-4")},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function p_(t){let e;return{c(){e=b("span"),e.innerHTML='<i class="fas fa-hand-pointer"></i>',v(e,"class","icon px-4")},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function na(t){let e,n,i,r;const s=[__,g_],o=[];function l(a,c){return a[0]==="img"?0:a[0]==="doc"?1:-1}return~(e=l(t))&&(n=o[e]=s[e](t)),{c(){n&&n.c(),i=ht()},m(a,c){~e&&o[e].m(a,c),z(a,i,c),r=!0},p(a,c){let u=e;e=l(a),e===u?~e&&o[e].p(a,c):(n&&(ze(),K(o[u],1,1,()=>{o[u]=null}),je()),~e?(n=o[e],n?n.p(a,c):(n=o[e]=s[e](a),n.c()),U(n,1),n.m(i.parentNode,i)):n=null)},i(a){r||(U(n),r=!0)},o(a){K(n),r=!1},d(a){~e&&o[e].d(a),a&&D(i)}}}function g_(t){let e,n;return e=new h_({props:{selectedDocuments:t[5],documentSetStore:t[1]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p(i,r){const s={};r&32&&(s.selectedDocuments=i[5]),r&2&&(s.documentSetStore=i[1]),e.$set(s)},i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function __(t){let e,n,i=W==="en"?"Selected regions":"Régions sélectionnées",r,s,o=t[5].length+"",l,a,c,u,d=[],f=new Map,h,m=t[5];const p=g=>g[15].id;for(let g=0;g<m.length;g+=1){let _=ta(t,m,g),S=p(_);f.set(S,d[g]=ia(S,_))}return{c(){e=b("div"),n=b("h3"),r=re(i),s=re(" ("),l=re(o),a=re(")"),c=F(),u=b("div");for(let g=0;g<d.length;g+=1)d[g].c();v(n,"class","title is-5"),v(u,"class","selected-nodes grid is-gap-2 mt-5 svelte-1a3kdxu"),v(e,"class","selected-panel box mt-4 svelte-1a3kdxu")},m(g,_){z(g,e,_),y(e,n),y(n,r),y(n,s),y(n,l),y(n,a),y(e,c),y(e,u);for(let S=0;S<d.length;S+=1)d[S]&&d[S].m(u,null);h=!0},p(g,_){(!h||_&32)&&o!==(o=g[5].length+"")&&Ee(l,o),_&32&&(m=g[5],ze(),d=ei(d,_,p,1,g,m,f,u,vr,ia,null,ta),je())},i(g){if(!h){for(let _=0;_<m.length;_+=1)U(d[_]);h=!0}},o(g){for(let _=0;_<d.length;_+=1)K(d[_]);h=!1},d(g){g&&D(e);for(let _=0;_<d.length;_+=1)d[_].d()}}}function ia(t,e){let n,i,r;return i=new Wn({props:{item:e[15],selectable:!1,copyable:!1}}),{key:t,first:null,c(){n=ht(),me(i.$$.fragment),this.first=n},m(s,o){z(s,n,o),de(i,s,o),r=!0},p(s,o){e=s;const l={};o&32&&(l.item=e[15]),i.$set(l)},i(s){r||(U(i.$$.fragment,s),r=!0)},o(s){K(i.$$.fragment,s),r=!1},d(s){s&&D(n),he(i,s)}}}function v_(t){let e,n,i,r=t[3]?"click":"selection",s,o,l,a,c,u,d,f;function h(_,S){return _[3]?p_:m_}let m=h(t),p=m(t),g=t[5].length>0&&na(t);return{c(){e=b("div"),n=b("button"),p.c(),i=re(`
        Switch to `),s=re(r),o=re(" mode"),l=F(),a=b("div"),c=F(),g&&g.c(),v(n,"class","toggle-button button is-small is-link mb-3"),v(a,"class","visualization-container")},m(_,S){z(_,e,S),y(e,n),p.m(n,null),y(n,i),y(n,s),y(n,o),y(e,l),y(e,a),t[9](a),y(e,c),g&&g.m(e,null),u=!0,d||(f=Se(n,"click",t[7]),d=!0)},p(_,[S]){m!==(m=h(_))&&(p.d(1),p=m(_),p&&(p.c(),p.m(n,i))),(!u||S&8)&&r!==(r=_[3]?"click":"selection")&&Ee(s,r),_[5].length>0?g?(g.p(_,S),S&32&&U(g,1)):(g=na(_),g.c(),U(g,1),g.m(e,null)):g&&(ze(),K(g,1,1,()=>{g=null}),je())},i(_){u||(U(g),u=!0)},o(_){K(g),u=!1},d(_){_&&D(e),p.d(),t[9](null),g&&g.d(),d=!1,f()}}}const y_=1e3;function b_(t,e,n){let i,r,s=ee,o=()=>(s(),s=bi(i,w=>n(8,r=w)),i),l;t.$$.on_destroy.push(()=>s());let{type:a="img"}=e,{documentSetStore:c}=e;const{imageNetwork:u,documentNetwork:d,selectedNodes:f,updateSelectedNodes:h}=c;we(t,f,w=>n(5,l=w));let m,p,g=!1;function _(){m&&(m.destroy(),h([]));function w(T){h(T)}m=(r.nodes.length<y_?Yg:Fg)(p,r.nodes,r.links,w,T=>{n(3,g=T)}),n(3,g=a==="img"),g&&m.toggleSelectionMode()}function S(){m&&n(3,g=m.toggleSelectionMode())}On(()=>{m==null||m.destroy()});function E(w){un[w?"unshift":"push"](()=>{p=w,n(2,p)})}return t.$$set=w=>{"type"in w&&n(0,a=w.type),"documentSetStore"in w&&n(1,c=w.documentSetStore)},t.$$.update=()=>{t.$$.dirty&1&&o(n(4,i=a==="img"?u:d)),t.$$.dirty&260&&r&&p&&_()},[a,c,p,g,i,l,f,S,r,E]}class w_ extends Ae{constructor(e){super(),xe(this,e,b_,v_,Me,{type:0,documentSetStore:1})}}const Qy="",{Map:ra}=Uc;function sa(t,e,n){const i=t.slice();return i[43]=e[n],i}function oa(t,e,n){const i=t.slice();return i[43]=e[n],i}function la(t,e,n){const i=t.slice();return i[48]=e[n],i}function aa(t,e,n){const i=t.slice();return i[48]=e[n],i}function S_(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g,_,S=[],E=new ra,w,k,T=[],M=new ra,C,x,P,L,H,$,I,R,O,V,q,B,Y=t[4].docs;const oe=te=>te[48].id;for(let te=0;te<Y.length;te+=1){let le=aa(t,Y,te),Z=oe(le);E.set(Z,S[te]=ca(Z,le))}let se=t[4].docs;const ae=te=>te[48].id;for(let te=0;te<se.length;te+=1){let le=la(t,se,te),Z=ae(le);M.set(Z,T[te]=ua(Z,le))}function Q(te,le){return te[2]?C_:E_}let ue=Q(t),ge=ue(t);return{c(){e=b("div"),n=b("div"),i=b("div"),r=b("h4"),r.textContent=`${t[15]("title")}`,s=F(),o=b("div"),l=b("div"),a=b("div"),c=b("select"),u=b("option"),u.textContent=`${t[15]("byName")}`,d=b("option"),d.textContent=`${t[15]("byScore")}`,f=F(),h=b("div"),m=b("div"),p=b("div"),g=F(),_=b("div");for(let te=0;te<S.length;te+=1)S[te].c();w=F(),k=b("div");for(let te=0;te<T.length;te+=1)T[te].c();C=F(),x=b("div"),P=F(),L=b("div"),H=F(),$=b("div"),I=b("div"),R=b("h4"),R.textContent=`${t[15]("pageByPage")}`,O=F(),V=b("div"),ge.c(),v(r,"class","title is-6 mb-0"),u.__value="name",u.value=u.__value,d.__value="score",d.value=d.__value,t[3]===void 0&&Wt(()=>t[25].call(c)),v(a,"class","select is-small"),v(l,"class","control"),v(o,"class","field mb-0"),v(i,"class","is-flex is-justify-content-space-between is-align-items-center mb-3"),v(p,"class","matrix-corner svelte-24wn30"),v(_,"class","col-headers svelte-24wn30"),v(k,"class","row-headers svelte-24wn30"),v(x,"class","matrix-canvas svelte-24wn30"),v(m,"class","matrix-grid svelte-24wn30"),De(m,"--cell-size",pa+"px"),v(h,"class","scroll-area svelte-24wn30"),v(n,"class","box panel-box svelte-24wn30"),v(e,"class","split-panel svelte-24wn30"),De(e,"width",t[10]+"px"),v(L,"class","split-divider svelte-24wn30"),v(L,"role","separator"),v(L,"tabindex","0"),v(R,"class","title is-6 mb-3"),v(V,"class","scroll-area svelte-24wn30"),v(I,"class","box panel-box svelte-24wn30"),v($,"class","split-panel svelte-24wn30"),De($,"width",t[9]+"px")},m(te,le){z(te,e,le),y(e,n),y(n,i),y(i,r),y(i,s),y(i,o),y(o,l),y(l,a),y(a,c),y(c,u),y(c,d),Os(c,t[3],!0),y(n,f),y(n,h),y(h,m),y(m,p),y(m,g),y(m,_);for(let Z=0;Z<S.length;Z+=1)S[Z]&&S[Z].m(_,null);y(m,w),y(m,k);for(let Z=0;Z<T.length;Z+=1)T[Z]&&T[Z].m(k,null);y(m,C),y(m,x),t[26](x),z(te,P,le),z(te,L,le),z(te,H,le),z(te,$,le),y($,I),y(I,R),y(I,O),y(I,V),ge.m(V,null),q||(B=[Se(c,"change",t[25]),Se(L,"mousedown",t[16]),Se(L,"touchstart",t[16])],q=!0)},p(te,le){le[0]&8&&Os(c,te[3]),le[0]&16&&(Y=te[4].docs,S=ei(S,le,oe,1,te,Y,E,_,$s,ca,null,aa)),le[0]&16&&(se=te[4].docs,T=ei(T,le,ae,1,te,se,M,k,$s,ua,null,la)),le[0]&1024&&De(e,"width",te[10]+"px"),ue===(ue=Q(te))&&ge?ge.p(te,le):(ge.d(1),ge=ue(te),ge&&(ge.c(),ge.m(V,null))),le[0]&512&&De($,"width",te[9]+"px")},d(te){te&&D(e);for(let le=0;le<S.length;le+=1)S[le].d();for(let le=0;le<T.length;le+=1)T[le].d();t[26](null),te&&D(P),te&&D(L),te&&D(H),te&&D($),ge.d(),q=!1,ot(B)}}}function k_(t){let e;return{c(){e=b("div"),e.textContent=`${t[15]("noDocuments")}`,v(e,"class","notification is-info"),De(e,"width","100%")},m(n,i){z(n,e,i)},p:ee,d(n){n&&D(e)}}}function ca(t,e){let n,i,r,s;return{key:t,first:null,c(){n=b("div"),i=b("span"),s=F(),v(i,"class","color-dot svelte-24wn30"),De(i,"background-color",e[48].color),v(i,"title",r=e[48].title),v(n,"class","header-cell svelte-24wn30"),this.first=n},m(o,l){z(o,n,l),y(n,i),y(n,s)},p(o,l){e=o,l[0]&16&&De(i,"background-color",e[48].color),l[0]&16&&r!==(r=e[48].title)&&v(i,"title",r)},d(o){o&&D(n)}}}function ua(t,e){let n,i,r,s;return{key:t,first:null,c(){n=b("div"),i=b("span"),s=F(),v(i,"class","color-dot svelte-24wn30"),De(i,"background-color",e[48].color),v(i,"title",r=e[48].title),v(n,"class","header-cell svelte-24wn30"),this.first=n},m(o,l){z(o,n,l),y(n,i),y(n,s)},p(o,l){e=o,l[0]&16&&De(i,"background-color",e[48].color),l[0]&16&&r!==(r=e[48].title)&&v(i,"title",r)},d(o){o&&D(n)}}}function E_(t){let e;return{c(){e=b("p"),e.textContent=`${t[15]("selectCell")}`,v(e,"class","has-text-grey is-size-7")},m(n,i){z(n,e,i)},p:ee,d(n){n&&D(e)}}}function C_(t){let e;return{c(){e=b("div"),v(e,"class","scatter-container svelte-24wn30")},m(n,i){z(n,e,i),t[27](e)},p:ee,d(n){n&&D(e),t[27](null)}}}function fa(t){let e,n,i,r,s,o,l=[1,2],a=[];for(let d=0;d<2;d+=1)a[d]=da(oa(t,l,d));let c=[1,2],u=[];for(let d=0;d<2;d+=1)u[d]=ha(sa(t,c,d));return{c(){e=b("table"),n=b("thead"),i=b("tr");for(let d=0;d<2;d+=1)a[d].c();r=F(),s=b("tbody"),o=b("tr");for(let d=0;d<2;d+=1)u[d].c();v(e,"class","table is-fullwidth p-3 has-text-centered")},m(d,f){z(d,e,f),y(e,n),y(n,i);for(let h=0;h<2;h+=1)a[h]&&a[h].m(i,null);y(e,r),y(e,s),y(s,o);for(let h=0;h<2;h+=1)u[h]&&u[h].m(o,null)},p(d,f){if(f[0]&256){l=[1,2];let h;for(h=0;h<2;h+=1){const m=oa(d,l,h);a[h]?a[h].p(m,f):(a[h]=da(m),a[h].c(),a[h].m(i,null))}for(;h<2;h+=1)a[h].d(1)}if(f[0]&164096){c=[1,2];let h;for(h=0;h<2;h+=1){const m=sa(d,c,h);u[h]?u[h].p(m,f):(u[h]=ha(m),u[h].c(),u[h].m(o,null))}for(;h<2;h+=1)u[h].d(1)}},d(d){d&&D(e),at(a,d),at(u,d)}}}function da(t){let e,n,i,r,s,o=t[8][`doc${t[43]}`].title+"",l,a;return{c(){e=b("th"),n=b("span"),i=re("●"),r=F(),s=b("strong"),l=re(o),a=F(),De(n,"color",t[8][`doc${t[43]}`].color),v(e,"class","doc-title svelte-24wn30")},m(c,u){z(c,e,u),y(e,n),y(n,i),y(e,r),y(e,s),y(s,l),y(e,a)},p(c,u){u[0]&256&&De(n,"color",c[8][`doc${c[43]}`].color),u[0]&256&&o!==(o=c[8][`doc${c[43]}`].title+"")&&Ee(l,o)},d(c){c&&D(e)}}}function ha(t){let e,n,i=t[15]("page")+"",r,s,o=t[8][`page${t[43]}`]+"",l,a,c,u,d,f,h;return{c(){e=b("td"),n=b("p"),r=re(i),s=F(),l=re(o),a=F(),c=b("figure"),u=b("img"),h=F(),v(n,"class","is-size-7 has-text-grey mb-3"),vt(u.src,d=t[17](t[8][`doc${t[43]}`],t[8][`page${t[43]}`]))||v(u,"src",d),v(u,"alt",f="Page "+t[8][`page${t[43]}`]),v(c,"class","image")},m(m,p){z(m,e,p),y(e,n),y(n,r),y(n,s),y(n,l),y(e,a),y(e,c),y(c,u),y(e,h)},p(m,p){p[0]&256&&o!==(o=m[8][`page${m[43]}`]+"")&&Ee(l,o),p[0]&256&&!vt(u.src,d=m[17](m[8][`doc${m[43]}`],m[8][`page${m[43]}`]))&&v(u,"src",d),p[0]&256&&f!==(f="Page "+m[8][`page${m[43]}`])&&v(u,"alt",f)},d(m){m&&D(e)}}}function I_(t){let e,n,i,r,s,o,l,a,c,u,d;function f(g,_){return g[5].length?S_:k_}let h=f(t),m=h(t),p=t[8]&&fa(t);return{c(){e=b("div"),m.c(),n=F(),i=b("div"),r=b("div"),s=F(),o=b("div"),l=b("div"),p&&p.c(),a=F(),c=b("button"),v(e,"class","split-container svelte-24wn30"),v(r,"class","modal-background"),v(l,"class","box p-5"),v(o,"class","modal-content"),De(o,"width","auto"),De(o,"max-width","70vw"),v(c,"class","modal-close is-large"),v(c,"aria-label","close"),v(i,"id","matrix-page-modal"),v(i,"class","modal")},m(g,_){z(g,e,_),m.m(e,null),t[28](e),z(g,n,_),z(g,i,_),y(i,r),y(i,s),y(i,o),y(o,l),p&&p.m(l,null),y(i,a),y(i,c),t[29](i),u||(d=Jn(Er.call(null,i)),u=!0)},p(g,_){h===(h=f(g))&&m?m.p(g,_):(m.d(1),m=h(g),m&&(m.c(),m.m(e,null))),g[8]?p?p.p(g,_):(p=fa(g),p.c(),p.m(l,null)):p&&(p.d(1),p=null)},i:ee,o:ee,d(g){g&&D(e),m.d(),t[28](null),g&&D(n),g&&D(i),p&&p.d(),t[29](null),u=!1,d()}}}const ma=300,pa=30,Mt=5;function M_(t,e,n){let i,r,s,o,l,a,c,u,d,{documentSetStore:f}=e;const{documentNodes:h,docPairStats:m,pairIndex:p,documentStats:g}=f;we(t,h,J=>n(24,d=J)),we(t,m,J=>n(23,u=J)),we(t,p,J=>n(32,a=J)),we(t,g,J=>n(22,c=J));const _={title:{en:"Document Matrix",fr:"Matrice de documents"},order:{en:"Order",fr:"Ordre"},byName:{en:"By name",fr:"Par nom"},byScore:{en:"By score",fr:"Par score"},noDocuments:{en:"No documents available",fr:"Aucun document disponible"},pageByPage:{en:"Page-by-page similarity",fr:"Similarité page par page"},page:{en:"page",fr:"page"},score:{en:"Score",fr:"Score"},noPairs:{en:"No pairs",fr:"Aucune paire"},selectCell:{en:"Click a cell to view page-by-page similarity",fr:"Cliquez sur une cellule pour voir la similarité page par page"}},S=J=>{var Le,_e;return((Le=_[J])==null?void 0:Le[W])||((_e=_[J])==null?void 0:_e.en)||J};let E,w,k,T,M=null,C="name",x=.5,P=!1,L=0,H,$=null;function I(J,Le,_e,Ne){var ye;if(!J.length)return{docs:[],matrix:[],maxScore:0};J.forEach((fe,Ge)=>{var Re;fe.index=Ge,fe.count=((Re=_e==null?void 0:_e.get(fe.id))==null?void 0:Re.count)||0});const pe={name:Di(J.length).sort((fe,Ge)=>J[fe].title.localeCompare(J[Ge].title)),score:Di(J.length).sort((fe,Ge)=>J[Ge].count-J[fe].count)}[Ne].map(fe=>J[fe]),Fe=pe.length,$e=[];let Ve=0;for(let fe=0;fe<Fe;fe++){const Ge=[];for(let Re=0;Re<Fe;Re++)if(fe!==Re){const Oe=pe[fe].id<pe[Re].id?`${pe[fe].id}-${pe[Re].id}`:`${pe[Re].id}-${pe[fe].id}`,zt=((ye=Le==null?void 0:Le.get(Oe))==null?void 0:ye.score)||0;zt>Ve&&(Ve=zt),Ge.push({x:Re,y:fe,z:zt,doc1:pe[fe],doc2:pe[Re]})}else Ge.push({x:Re,y:fe,z:0,diagonal:!0});$e.push(Ge)}return{docs:pe,matrix:$e,maxScore:Ve}}function R(J){const{doc1:Le,doc2:_e}=J,Ne=Le.id<_e.id?`${Le.id}-${_e.id}`:`${_e.id}-${Le.id}`,He=a.byDocPair.get(Ne)||[];if(!He.length)return null;const pe=new Map;let Fe=1/0,$e=-1/0;return He.forEach(ye=>{const[fe,Ge,Re]=ye.regions_id_1===Le.id?[ye.page_1,ye.page_2,ye.weightedScore||0]:[ye.page_2,ye.page_1,ye.weightedScore||0],Oe=`${fe}-${Ge}`;pe.has(Oe)||pe.set(Oe,{page1:fe,page2:Ge,scores:[]}),pe.get(Oe).scores.push(Re),Re<Fe&&(Fe=Re),Re>$e&&($e=Re)}),{points:Array.from(pe.values()).map(({page1:ye,page2:fe,scores:Ge})=>({page1:ye,page2:fe,score:Ge.reduce((Re,Oe)=>Re+Oe,0)/Ge.length,count:Ge.length})),minScore:Fe,maxScore:$e,doc1:Le,doc2:_e}}function O(){if(!w||!r.docs.length)return;const{docs:J,matrix:Le,maxScore:_e}=r,Ne=J.length*pa;Ze(w).selectAll("*").remove();const He=Ze(w).append("svg").attr("width",Ne).attr("height",Ne),pe=zl().range([0,Ne]).domain(Di(J.length)).padding(.02),Fe=Ze("body").selectAll(".matrix-tooltip").data([0]).join("div").attr("class","matrix-tooltip").style("position","fixed").style("background","var(--bulma-scheme-main)").style("border","1px solid var(--bulma-border)").style("border-radius","4px").style("padding","8px").style("pointer-events","none").style("opacity",0).style("font-size","12px").style("box-shadow","0 2px 4px rgba(0,0,0,0.15)").style("z-index","9999").style("color","var(--bulma-text)");He.selectAll(".row").data(Le).join("g").attr("class","row").attr("transform",(Ve,ye)=>`translate(0,${pe(ye)})`).each(function(Ve){Ze(this).selectAll(".cell").data(Ve.filter(ye=>!ye.diagonal)).join("rect").attr("class","cell").attr("x",ye=>pe(ye.x)).attr("width",pe.bandwidth()).attr("height",pe.bandwidth()).attr("fill",ye=>{if(ye.z===0)return"var(--bulma-text)";const fe=$r(233,.951,.52);return fe.opacity=_e>0?.2+.8*(ye.z/_e):.2,fe}).attr("stroke",ye=>V(ye)?"var(--bulma-text)":"var(--bulma-scheme-main)").attr("stroke-width",ye=>V(ye)?2:.5).style("cursor","pointer").on("mouseover",function(ye,fe){V(fe)||Ze(this).attr("stroke","var(--bulma-text)").attr("stroke-width",2),Fe.style("opacity",1)}).on("mousemove",function(ye,fe){const Ge=fe.z===0?`<span style="color:${fe.doc1.color}">●</span> ${fe.doc1.title}<br/>↔<br/><span style="color:${fe.doc2.color}">●</span> ${fe.doc2.title}<br/><br/><em>${S("noPairs")}</em>`:`<span style="color:${fe.doc1.color}">●</span> ${fe.doc1.title}<br/>↔<br/><span style="color:${fe.doc2.color}">●</span> ${fe.doc2.title}<br/><br/>${S("score")}: ${fe.z.toFixed(2)}`;Fe.html(Ge).style("left",ye.clientX+15+"px").style("top",ye.clientY+15+"px")}).on("mouseleave",function(ye,fe){V(fe)||Ze(this).attr("stroke","var(--bulma-scheme-main)").attr("stroke-width",.5),Fe.style("opacity",0)}).on("click",(ye,fe)=>{n(2,M={row:fe.y,col:fe.x,doc1:fe.doc1,doc2:fe.doc2}),q()})}),He.selectAll(".row").selectAll(".cell-diagonal").data(Ve=>Ve.filter(ye=>ye.diagonal)).join("rect").attr("class","cell-diagonal").attr("x",Ve=>pe(Ve.x)).attr("width",pe.bandwidth()).attr("height",pe.bandwidth()).attr("fill","var(--contrasted)")}function V(J){return M&&M.doc1.id===J.doc1.id&&M.doc2.id===J.doc2.id}function q(){w&&Ze(w).selectAll(".cell").attr("stroke",J=>V(J)?"var(--bulma-text)":"var(--bulma-scheme-main)").attr("stroke-width",J=>V(J)?2:.5)}function B(J,Le,_e,Ne){n(8,$={page1:J,page2:Le,doc1:_e,doc2:Ne}),T==null||T.classList.add("is-active")}function Y(){if(!k||!(s!=null&&s.points.length))return;Ze(k).selectAll("*").remove();const{points:J,minScore:Le,maxScore:_e,doc1:Ne,doc2:He}=s,pe={top:65,right:40,bottom:20,left:80},Fe=10,$e=Math.max(...J.map(ke=>ke.page1)),Ve=Math.max(...J.map(ke=>ke.page2)),ye=$e*Mt,fe=Ve*Mt,Ge=new Map(J.map(ke=>[`${ke.page1}-${ke.page2}`,ke])),Re=ye+pe.left+pe.right,Oe=fe+pe.top+pe.bottom,Ye=Ze(k).append("svg").attr("width",Re).attr("height",Oe).append("g").attr("transform",`translate(${pe.left},${pe.top})`),vn=ns().domain([0,$e]).range([0,ye]),gt=ns().domain([0,Ve]).range([0,fe]),kt=Ze("body").selectAll(".scatter-tooltip").data([0]).join("div").attr("class","scatter-tooltip").style("position","fixed").style("background","var(--bulma-scheme-main)").style("border","1px solid var(--bulma-border)").style("border-radius","4px").style("padding","6px 10px").style("pointer-events","none").style("opacity",0).style("font-size","11px").style("box-shadow","0 2px 4px rgba(0,0,0,0.15)").style("z-index","9999").style("color","var(--bulma-text)"),it=new Array($e).fill(0),rt=new Array(Ve).fill(0);J.forEach(ke=>{it[ke.page1-1]++,rt[ke.page2-1]++});const Ue=Math.max(...it),Xn=Math.max(...rt),Zt=Ye.append("g").attr("transform",`translate(0,${-22-Fe})`);it.forEach((ke,Xe)=>{ke!==0&&Zt.append("rect").attr("x",Xe*Mt).attr("width",Mt).attr("height",Fe).attr("fill",Ne.color).attr("opacity",.15+.85*(ke/Ue)).style("cursor","default").on("mouseover",()=>kt.style("opacity",1)).on("mousemove",ft=>{kt.html(`<strong>${ke}</strong> image${ke>1?"s":""}<br/>${S("page")} ${Xe+1}`).style("left",ft.clientX+10+"px").style("top",ft.clientY-30+"px")}).on("mouseleave",()=>kt.style("opacity",0))});const Et=Ye.append("g").attr("transform","translate(-55,0)");rt.forEach((ke,Xe)=>{ke!==0&&Et.append("rect").attr("x",0).attr("y",Xe*Mt).attr("width",Fe).attr("height",Mt).attr("fill",He.color).attr("opacity",.15+.85*(ke/Xn)).style("cursor","default").on("mouseover",()=>kt.style("opacity",1)).on("mousemove",ft=>{kt.html(`<strong>${ke}</strong> image${ke>1?"s":""}<br/>${S("page")} ${Xe+1}`).style("left",ft.clientX+10+"px").style("top",ft.clientY-30+"px")}).on("mouseleave",()=>kt.style("opacity",0))}),Ye.append("g").call(ud(vn).ticks(Math.min($e,10))),Ye.append("g").call(fd(gt).ticks(Math.min(Ve,10)));const In=(ke,Xe)=>{const ft=Math.floor(Xe/6);return ke.length>ft?ke.slice(0,ft-1)+"…":ke},Tt=Ye.append("g").attr("transform",`translate(${ye/2},-50)`);Tt.append("circle").attr("r",4).attr("cx",-ye/2+4).attr("fill",Ne.color),Tt.append("text").attr("x",-ye/2+14).attr("text-anchor","start").attr("dominant-baseline","middle").attr("font-size","11px").attr("fill","var(--bulma-text)").text(In(`${Ne.title} (${S("page")})`,ye-20));const Mn=Ye.append("g").attr("transform",`translate(-68,${fe/2}) rotate(-90)`);Mn.append("circle").attr("r",4).attr("cx",-fe/2+4).attr("fill",He.color),Mn.append("text").attr("x",-fe/2+14).attr("text-anchor","start").attr("dominant-baseline","middle").attr("font-size","11px").attr("fill","var(--bulma-text)").text(In(`${He.title} (${S("page")})`,fe-20)),Ye.append("rect").attr("class","hover-overlay").attr("width",ye).attr("height",fe).attr("fill","transparent").style("cursor","pointer").on("mousemove",ke=>{const[Xe,ft]=ct(ke,Ye.node()),X=Math.floor(Xe/Mt)+1,Ie=Math.floor(ft/Mt)+1;if(X<1||X>$e||Ie<1||Ie>Ve){kt.style("opacity",0);return}const qe=Ge.get(`${X}-${Ie}`),Kt=`<span style="color:${Ne.color}">●</span> ${S("page")} ${X}<br/><span style="color:${He.color}">●</span> ${S("page")} ${Ie}`,A=qe?`${Kt}<br/>${S("score")}: ${qe.score.toFixed(2)}`:Kt;kt.style("opacity",1).html(A).style("left",ke.clientX+10+"px").style("top",ke.clientY-40+"px")}).on("mouseleave",()=>kt.style("opacity",0)).on("click",ke=>{const[Xe,ft]=ct(ke,Ye.node()),X=Math.floor(Xe/Mt)+1,Ie=Math.floor(ft/Mt)+1;X>=1&&X<=$e&&Ie>=1&&Ie<=Ve&&B(X,Ie,Ne,He)}),Ye.selectAll(".cell").data(J).join("rect").attr("class","cell").attr("x",ke=>(ke.page1-1)*Mt).attr("y",ke=>(ke.page2-1)*Mt).attr("width",Mt).attr("height",Mt).attr("fill",$r(233,.951,.52)).attr("opacity",ke=>_e>Le?.2+.8*(ke.score-Le)/(_e-Le):.5).attr("pointer-events","none"),n(1,k.style.width=Re+"px",k),n(1,k.style.height=Oe+"px",k)}function oe(J){P=!0,J.preventDefault()}function se(J){var Ne,He;if(!P||!E)return;const Le=E.getBoundingClientRect(),_e=(J.clientX||((He=(Ne=J.touches)==null?void 0:Ne[0])==null?void 0:He.clientX))-Le.left;n(19,x=Math.max(.2,Math.min(.8,_e/Le.width)))}function ae(){P=!1}function Q(J,Le){const _e="full";return Vt(`wit${J.witnessId}_${J.digitizationRef}_${String(Le).padStart(J.zeros,"0")}`,"full",_e)}Nn(()=>{E&&(n(20,L=E.offsetWidth),H=new ResizeObserver(J=>{n(20,L=J[0].contentRect.width)}),H.observe(E)),window.addEventListener("mousemove",se),window.addEventListener("mouseup",ae),window.addEventListener("touchmove",se),window.addEventListener("touchend",ae)}),On(()=>{H==null||H.disconnect(),window.removeEventListener("mousemove",se),window.removeEventListener("mouseup",ae),window.removeEventListener("touchmove",se),window.removeEventListener("touchend",ae)});function ue(){C=Wc(this),n(3,C)}function ge(J){un[J?"unshift":"push"](()=>{w=J,n(0,w)})}function te(J){un[J?"unshift":"push"](()=>{k=J,n(1,k)})}function le(J){un[J?"unshift":"push"](()=>{E=J,n(6,E)})}function Z(J){un[J?"unshift":"push"](()=>{T=J,n(7,T)})}return t.$$set=J=>{"documentSetStore"in J&&n(18,f=J.documentSetStore)},t.$$.update=()=>{t.$$.dirty[0]&16777216&&n(5,i=Array.from((d==null?void 0:d.values())||[])),t.$$.dirty[0]&12582952&&n(4,r=I(i,u.scoreCount,c.scoreCount,C)),t.$$.dirty[0]&4&&n(21,s=M?R(M):null),t.$$.dirty[0]&1572864&&n(10,o=Math.max(ma,L*x-4)),t.$$.dirty[0]&1572864&&n(9,l=Math.max(ma,L*(1-x)-4)),t.$$.dirty[0]&17&&w&&r.docs.length&&O(),t.$$.dirty[0]&2097154&&k&&s&&Y()},[w,k,M,C,r,i,E,T,$,l,o,h,m,p,g,S,oe,Q,f,x,L,s,c,u,d,ue,ge,te,le,Z]}class x_ extends Ae{constructor(e){super(),xe(this,e,M_,I_,Me,{documentSetStore:18},null,[-1,-1])}}const ga="https://vhs.huma-num.fr",A_=()=>new Worker("/static/js/pairWorker.js",{type:"module"});function T_(t){const e=Te(null),n=Te([]),i=Te(new Set),r=Te([]),s=Te(0),o=Te(3),l=Te(!1),a=Te("threshold"),c=Te([]),u=Te(new Map);let d;const f=Te({byImage:new Map,byDocPair:new Map,byDoc:new Map}),h=Te(new Map),m=Te(new Map),p=Te({}),g=Te({}),_=Te({}),S=Te({}),E=Te({documents:0,pairs:null,images:0,categories:{}}),w=nt(n,(R,O)=>{if(R.length===0){O(Promise.resolve(0));return}d&&d.terminate();const V=413,q=new Promise((B,Y)=>{(async()=>{try{const se=await fetch(`${ga}/document-set/${V}/pairs?category=${R.join(",")}`);if(!se.ok)throw new Error(`HTTP ${se.status}`);const ae=await se.json();d=A_(),d.postMessage({rawPairs:ae,selectedCategories:R}),d.onmessage=async Q=>{const{allPairs:ue,imageNodes:ge,pairIndex:te,categories:le,stats:Z}=Q.data;f.set(te),p.set(Z.pairStats),g.set(Z.documentStats),_.set(Z.imageStats),S.set(Z.docPairStats);const J=Array.from(Z.documentStats.scoreCount.keys());lt(i).size===0&&i.set(new Set(J));const _e=await Promise.all(J.map(pe=>k(pe).then(Fe=>({id:pe,info:Fe})))),Ne=new Map;_e.forEach(({id:pe,info:Fe})=>Ne.set(pe,Fe)),u.set(Ne);const He=new Map;J.forEach((pe,Fe)=>{const $e=Ne.get(pe)||{};He.set(pe,{id:pe,title:$e.title||`Region Extraction ${pe}`,color:$e.color||wu(Fe),images:[],...$e})}),ge.forEach(pe=>{const Fe=He.get(pe.regionId);Fe&&(pe.color=Fe.color,pe.title=`${Fe.title} | Page ${pe.canvas}`,Fe.images.push(pe))}),He.forEach(pe=>pe.images.sort((Fe,$e)=>Fe.canvas-$e.canvas)),h.set(ge),m.set(He),E.set({documents:J.length,pairs:ue.length,images:ge.size,categories:le}),c.set(ue),d.terminate(),d=null,B(ue.length)},d.onerror=Q=>{console.error("Worker error",Q);const ue=`Error processing pairs: ${Q.message}`;e.set(ue),Y(new Error(ue))}}catch(se){const ae=`Fetch error: ${se.message}`;e.set(ae),Y(new Error(ae))}})()});O(q)});async function k(R){try{const O=await fetch(`${ga}/search/regions/?id=${R}`);if(!O.ok)throw new Error(`HTTP ${O.status}`);const{results:V}=await O.json();if(!(V!=null&&V.length))return{title:`Region Extraction ${R}`};const q=V[0],[,...B]=q.title.split(" | "),[Y,oe]=(q.ref||"_").split("_");return{title:B.join(" | "),ref:q.ref,witnessId:br(Y),digitizationRef:oe,zeros:q.zeros,img_nb:q.img_nb,url:q.url}}catch(O){return e.set(`Error fetching region #${R}: ${O.message}`),{title:`Region Extraction ${R}`}}}const T=nt([c,s,o,l,i],([R,O,V,q,B])=>{if(!R)return[];const Y=[],oe=lt(a);for(let se=0;se<R.length;se++){const ae=R[se];if(oe==="threshold"&&ae.weightedScore<O)break;if(!(!B.has(ae.regions_id_1)||!B.has(ae.regions_id_2))){if(oe==="topk"&&V!==null){const Q=ae.rank_1??1/0,ue=ae.rank_2??1/0;if(q){if(Q>V||ue>V)continue}else if(Q>V&&ue>V)continue}Y.push(ae)}}return Y}),M=nt([T,m],([R,O])=>{if(!R.length||O.size===0)return[];const V=new Set;for(const B of R)V.add(B.regions_id_1),V.add(B.regions_id_2);const q=[];return V.forEach(B=>{const Y=O.get(B);Y&&q.push(Y)}),q.sort((B,Y)=>Y.id-B.id)});function C(R,O,V=10,q=200,B=2,Y=25){if(!O)return{strength:.5,distance:100,width:2};const{min:oe,_:se,range:ae}=O,Q=ae===0?.5:(R-oe)/ae,ue=q-Q*(q-V),ge=B+Q*(Y-B);return{strength:Q,distance:ue,width:ge}}function x(R,O,V=10,q=60){if(!O)return V;const{min:B,_:Y,range:oe}=O;return oe===0?(V+q)/2:V+(R-B)/oe*(q-V)}const P=nt([T],([R])=>{var se;const O=lt(h),V=lt(_),q=lt(p),B=new Set,Y=[];for(const ae of R){const{strength:Q,distance:ue,width:ge}=C(ae.weightedScore,q.scoreRange);Y.push({source:ae.id_1,target:ae.id_2,strength:Q,distance:ue,width:ge}),B.has(ae.id_1)||B.add(ae.id_1),B.has(ae.id_2)||B.add(ae.id_2)}const oe=[];for(const ae of B){const Q=O.get(ae);if(Q){const ue=(se=V.scoreCount)==null?void 0:se.get(ae),{count:ge,score:te}=ue;oe.push({...Q,radius:x(te,V.scoreRange),label:`Region: ${Q.regionId}
Page: ${Q.canvas}
Connections: ${ge}
Total score: ${te.toFixed(2)}`})}}return{nodes:oe,links:Y}}),L=nt(M,R=>{const O=lt(S),V=lt(g);if(R.size===0)return{nodes:[],links:[]};const q=Array.from(R.values()).map(Y=>{var Q;const oe=(Q=V.scoreCount)==null?void 0:Q.get(Y.id),{count:se,score:ae}=oe;return{...Y,radius:x(se,V.countRange),label:`${Y.title}
Images: ${se}
Total score: ${ae.toFixed(2)}`}}),B=Array.from(O.scoreCount.entries()).map(([Y,oe])=>{const[se,ae]=Y.split("-").map(Number),{strength:Q,distance:ue,width:ge}=C(oe.score,O.scoreRange);return{source:se,target:ae,strength:Q,distance:ue,width:ge}});return{nodes:q,links:B}});function H(R){if(!R.length)return{regions:[],rows:[]};const O=lt(m),V=lt(f),q=R[0],B=O.get(q);if(!(B!=null&&B.images))return{regions:R,rows:[]};const Y=B.images,oe=(ue,ge,te)=>{const{r1:le,r2:Z}={r1:ge,r2:te},J=le<Z?`${le}-${Z}`:`${Z}-${le}`;return(V.byDocPair.get(J)||[]).map(_e=>_e.id_1===ue&&_e.regions_id_1===ge?{id:_e.id_2,page:_e.page_2}:_e.id_2===ue&&_e.regions_id_2===ge?{id:_e.id_1,page:_e.page_1}:null).filter(Boolean)},se=[];for(const ue of Y){let ge=[{[q]:{id:ue.id,page:ue.canvas}}];for(let te=1;te<R.length;te++){const le=R[te],Z=[];for(const J of ge){const Le=[];for(let _e=0;_e<te;_e++){const Ne=R[_e];if(J[Ne]){const He=oe(J[Ne].id,Ne,le);Le.push(...He)}}if(Le.length===0)Z.push(J);else{const _e=new Map;Le.forEach(Ne=>{_e.has(Ne.id)||_e.set(Ne.id,Ne)});for(const Ne of _e.values()){const He={...J,[le]:Ne};Z.push(He)}}}ge=Z}se.push(...ge)}const ae=[],Q=new Set;for(const ue of se){const ge=R.map(te=>{var le;return((le=ue[te])==null?void 0:le.id)||""}).join("|");Q.has(ge)||(Q.add(ge),ae.push(ue))}return{regions:R,rows:ae}}function $(R){n.update(O=>O.indexOf(R)>-1?O.filter(q=>q!==R):[...O,R].sort((q,B)=>q-B))}function I(R){i.update(O=>{const V=new Set(O);return V.has(R)?V.delete(R):V.add(R),V})}return{error:e,allPairs:c,visiblePairs:T,pairIndex:f,documentNodes:m,imageNodes:h,fetchPairs:w,imageNetwork:P,documentNetwork:L,selectedCategories:n,pairStats:p,documentStats:g,imageStats:_,docPairStats:S,docSetNumber:E,selectedNodes:r,selectedRegions:i,updateSelectedNodes:R=>r.set(R),toggleCategory:$,toggleRegion:I,buildAlignedImageMatrix:H,threshold:s,setThreshold:R=>s.set(R),topK:o,setTopK:R=>o.set(R),mutualTopK:l,setMutualTopK:R=>l.set(R),scoreMode:a,setScoreMode:R=>a.set(R)}}function _a(t){let e,n,i,r,s,o=(t[0].clusters||0)+"",l;return{c(){e=b("div"),n=b("div"),i=b("p"),i.textContent="Clusters",r=F(),s=b("p"),l=re(o),v(i,"class","heading"),v(s,"class","title is-5"),v(e,"class","level-item")},m(a,c){z(a,e,c),y(e,n),y(n,i),y(n,r),y(n,s),y(s,l)},p(a,c){c&1&&o!==(o=(a[0].clusters||0)+"")&&Ee(l,o)},d(a){a&&D(e)}}}function N_(t){var L,H,$;let e,n,i,r,s,o,l=(t[0].count||0)+"",a,c,u,d,f,h,m,p=(t[0].links||0)+"",g,_,S,E,w,k,T,M,C=(((H=(L=t[0])==null?void 0:L.density)==null?void 0:H.toFixed(3))||0)+"",x,P=(($=t[0])==null?void 0:$.clusters)&&_a(t);return{c(){e=b("div"),n=b("div"),i=b("div"),r=b("p"),r.textContent=`${W==="en"?"Nodes":"Nœuds"}`,s=F(),o=b("p"),a=re(l),c=F(),u=b("div"),d=b("div"),f=b("p"),f.textContent=`${W==="en"?"Edges":"Liens"}`,h=F(),m=b("p"),g=re(p),_=F(),P&&P.c(),S=F(),E=b("div"),w=b("div"),k=b("p"),k.textContent=`${W==="en"?"Density":"Densité"}`,T=F(),M=b("p"),x=re(C),v(r,"class","heading"),v(o,"class","title is-5"),v(n,"class","level-item"),v(f,"class","heading"),v(m,"class","title is-5"),v(u,"class","level-item"),v(k,"class","heading"),v(M,"class","title is-5"),v(E,"class","level-item"),v(e,"class","level has-text-centered")},m(I,R){z(I,e,R),y(e,n),y(n,i),y(i,r),y(i,s),y(i,o),y(o,a),y(e,c),y(e,u),y(u,d),y(d,f),y(d,h),y(d,m),y(m,g),y(e,_),P&&P.m(e,null),y(e,S),y(e,E),y(E,w),y(w,k),y(w,T),y(w,M),y(M,x)},p(I,[R]){var O,V,q;R&1&&l!==(l=(I[0].count||0)+"")&&Ee(a,l),R&1&&p!==(p=(I[0].links||0)+"")&&Ee(g,p),(O=I[0])!=null&&O.clusters?P?P.p(I,R):(P=_a(I),P.c(),P.m(e,S)):P&&(P.d(1),P=null),R&1&&C!==(C=(((q=(V=I[0])==null?void 0:V.density)==null?void 0:q.toFixed(3))||0)+"")&&Ee(x,C)},i:ee,o:ee,d(I){I&&D(e),P&&P.d()}}}function O_(t,e,n){let i,r,s,o,{activeTab:l="img"}=e,{documentSetStore:a}=e;const{imageStats:c,documentStats:u,docPairStats:d}=a;return we(t,c,f=>n(8,o=f)),we(t,u,f=>n(7,s=f)),we(t,d,f=>n(6,r=f)),t.$$set=f=>{"activeTab"in f&&n(4,l=f.activeTab),"documentSetStore"in f&&n(5,a=f.documentSetStore)},t.$$.update=()=>{t.$$.dirty&464&&n(0,i=l==="img"?o:l==="doc"?s:r)},[i,c,u,d,l,a,r,s,o]}class P_ extends Ae{constructor(e){super(),xe(this,e,O_,N_,Me,{activeTab:4,documentSetStore:5})}}function L_(t){let e,n,i;const r=t[1].default,s=Lt(r,t,t[0],null);return{c(){e=b("table"),n=b("tbody"),s&&s.c(),v(e,"class","table is-fullwidth")},m(o,l){z(o,e,l),y(e,n),s&&s.m(n,null),i=!0},p(o,[l]){s&&s.p&&(!i||l&1)&&Dt(s,r,o,o[0],i?Rt(r,o[0],l,null):$t(o[0]),null)},i(o){i||(U(s,o),i=!0)},o(o){K(s,o),i=!1},d(o){o&&D(e),s&&s.d(o)}}}function R_(t,e,n){let{$$slots:i={},$$scope:r}=e;return t.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,i]}class D_ extends Ae{constructor(e){super(),xe(this,e,R_,L_,Me,{})}}const $_=t=>({}),va=t=>({}),z_=t=>({}),ya=t=>({}),j_=t=>({}),ba=t=>({});function F_(t){let e;const n=t[4]["row-body"],i=Lt(n,t,t[3],va);return{c(){i&&i.c()},m(r,s){i&&i.m(r,s),e=!0},p(r,s){i&&i.p&&(!e||s&8)&&Dt(i,n,r,r[3],e?Rt(n,r[3],s,$_):$t(r[3]),va)},i(r){e||(U(i,r),e=!0)},o(r){K(i,r),e=!1},d(r){i&&i.d(r)}}}function V_(t){let e,n,i,r;const s=t[4]["row-body"],o=Lt(s,t,t[3],ya);return{c(){e=b("div"),n=b("div"),o&&o.c(),v(n,"class","grid is-gap-2"),v(e,"class",i="fixed-grid has-"+t[2]+"-cols")},m(l,a){z(l,e,a),y(e,n),o&&o.m(n,null),r=!0},p(l,a){o&&o.p&&(!r||a&8)&&Dt(o,s,l,l[3],r?Rt(s,l[3],a,z_):$t(l[3]),ya),(!r||a&4&&i!==(i="fixed-grid has-"+l[2]+"-cols"))&&v(e,"class",i)},i(l){r||(U(o,l),r=!0)},o(l){K(o,l),r=!1},d(l){l&&D(e),o&&o.d(l)}}}function H_(t){let e,n,i,r,s,o,l,a,c,u;Wt(t[5]);const d=t[4]["row-header"],f=Lt(d,t,t[3],ba),h=[V_,F_],m=[];function p(g,_){return g[0]?0:1}return o=p(t),l=m[o]=h[o](t),{c(){e=b("tr"),n=b("th"),i=b("div"),f&&f.c(),r=F(),s=b("td"),l.c(),v(i,"class","content-wrapper py-5"),v(n,"class","is-3 center-flex is-narrow"),De(n,"width","15vw"),v(s,"class","p-5 is-fullwidth")},m(g,_){z(g,e,_),y(e,n),y(n,i),f&&f.m(i,null),y(e,r),y(e,s),m[o].m(s,null),a=!0,c||(u=Se(window,"resize",t[5]),c=!0)},p(g,[_]){f&&f.p&&(!a||_&8)&&Dt(f,d,g,g[3],a?Rt(d,g[3],_,j_):$t(g[3]),ba);let S=o;o=p(g),o===S?m[o].p(g,_):(ze(),K(m[S],1,1,()=>{m[S]=null}),je(),l=m[o],l?l.p(g,_):(l=m[o]=h[o](g),l.c()),U(l,1),l.m(s,null))},i(g){a||(U(f,g),U(l),a=!0)},o(g){K(f,g),K(l),a=!1},d(g){g&&D(e),f&&f.d(g),m[o].d(),c=!1,u()}}}function U_(t,e,n){let i,{$$slots:r={},$$scope:s}=e,{useGrid:o=!0}=e,l=0;function a(){n(1,l=window.innerWidth)}return t.$$set=c=>{"useGrid"in c&&n(0,o=c.useGrid),"$$scope"in c&&n(3,s=c.$$scope)},t.$$.update=()=>{t.$$.dirty&2&&n(2,i=Vs(l))},[o,l,i,s,r,a]}class wa extends Ae{constructor(e){super(),xe(this,e,U_,H_,Me,{useGrid:0})}}const Zy="",B_=t=>({}),Sa=t=>({}),q_=t=>({}),ka=t=>({});function Ea(t){let e,n,i,r,s,o,l,a,c,u,d,f=t[1]&&Ca(t);return a=new Pi({props:{tooltipText:t[2][t[1]][W]}}),{c(){f&&f.c(),e=F(),n=b("div"),i=b("button"),r=jt("svg"),s=jt("path"),l=F(),me(a.$$.fragment),v(s,"fill","none"),v(s,"stroke","currentColor"),v(s,"stroke-linecap","round"),v(s,"stroke-linejoin","round"),v(s,"stroke-width","1.5"),v(s,"d","M12 3v18m0 0l8.5-8.5M12 21l-8.5-8.5"),v(r,"style",o=`transform: rotate(${t[1]?"180":"0"}deg)`),v(r,"xmlns","http://www.w3.org/2000/svg"),v(r,"width","24"),v(r,"height","24"),v(r,"viewBox","0 0 24 24"),v(r,"class","svelte-jbs1sd"),v(i,"class","button is-link svelte-jbs1sd"),v(n,"class","ctrl-toggle svelte-jbs1sd")},m(h,m){f&&f.m(h,m),z(h,e,m),z(h,n,m),y(n,i),y(i,r),y(r,s),y(i,l),de(a,i,null),c=!0,u||(d=Se(i,"click",en(t[3])),u=!0)},p(h,m){h[1]?f?(f.p(h,m),m&2&&U(f,1)):(f=Ca(h),f.c(),U(f,1),f.m(e.parentNode,e)):f&&(ze(),K(f,1,1,()=>{f=null}),je()),(!c||m&2&&o!==(o=`transform: rotate(${h[1]?"180":"0"}deg)`))&&v(r,"style",o);const p={};m&2&&(p.tooltipText=h[2][h[1]][W]),a.$set(p)},i(h){c||(U(f),U(a.$$.fragment,h),c=!0)},o(h){K(f),K(a.$$.fragment,h),c=!1},d(h){f&&f.d(h),h&&D(e),h&&D(n),he(a),u=!1,d()}}}function Ca(t){let e,n,i;const r=t[5]["toolbar-hidden"],s=Lt(r,t,t[4],Sa);return{c(){e=b("div"),s&&s.c(),v(e,"class","ctrl-extra")},m(o,l){z(o,e,l),s&&s.m(e,null),i=!0},p(o,l){s&&s.p&&(!i||l&16)&&Dt(s,r,o,o[4],i?Rt(r,o[4],l,B_):$t(o[4]),Sa)},i(o){i||(U(s,o),Wt(()=>{i&&(n||(n=fn(e,Us,{axis:"y"},!0)),n.run(1))}),i=!0)},o(o){K(s,o),n||(n=fn(e,Us,{axis:"y"},!1)),n.run(0),i=!1},d(o){o&&D(e),s&&s.d(o),o&&n&&n.end()}}}function K_(t){let e,n,i,r,s,o,l,a;const c=t[5]["toolbar-visible"],u=Lt(c,t,t[4],ka);let d=t[0]&&Ea(t);return{c(){e=b("div"),n=b("form"),i=b("div"),r=b("div"),s=b("div"),u&&u.c(),o=F(),d&&d.c(),v(s,"class","ctrl-block svelte-jbs1sd"),v(r,"class","ctrl-block-wrapper svelte-jbs1sd"),v(i,"class","ctrl-base"),v(n,"class","ctrl svelte-jbs1sd"),v(e,"id","toolbar"),v(e,"class",l="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(t[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd")},m(f,h){z(f,e,h),y(e,n),y(n,i),y(i,r),y(r,s),u&&u.m(s,null),y(n,o),d&&d.m(n,null),a=!0},p(f,[h]){u&&u.p&&(!a||h&16)&&Dt(u,c,f,f[4],a?Rt(c,f[4],h,q_):$t(f[4]),ka),f[0]?d?(d.p(f,h),h&1&&U(d,1)):(d=Ea(f),d.c(),U(d,1),d.m(n,null)):d&&(ze(),K(d,1,1,()=>{d=null}),je()),(!a||h&2&&l!==(l="ctrl-wrapper is-flex is-justify-content-center is-align-items-center "+(f[1]?"toolbar-expanded":"toolbar-collapsed")+" svelte-jbs1sd"))&&v(e,"class",l)},i(f){a||(U(u,f),U(d),a=!0)},o(f){K(u,f),K(d),a=!1},d(f){f&&D(e),u&&u.d(f),d&&d.d()}}}function W_(t,e,n){let i,{$$slots:r={},$$scope:s}=e,{expandable:o=!0}=e;const l={true:{en:"Collapse the toolbar",fr:"Refermer le menu"},false:{en:"Expand the toolbar",fr:"Ouvrir le menu"}},a=()=>n(1,i=!i);return t.$$set=c=>{"expandable"in c&&n(0,o=c.expandable),"$$scope"in c&&n(4,s=c.$$scope)},n(1,i=!1),[o,i,l,a,s,r]}class Y_ extends Ae{constructor(e){super(),xe(this,e,W_,K_,Me,{expandable:0})}}function Ia(t){let e,n,i,r,s,o,l,a,c,u=t[5]>1&&Ma(t),d=t[5]<t[3]&&Ta(t);return{c(){e=b("nav"),n=b("ul"),u&&u.c(),i=F(),r=b("li"),s=b("a"),o=re(t[5]),l=F(),d&&d.c(),v(s,"class","pagination-link is-current"),v(s,"href",null),v(n,"class","pagination-list ml-0"),v(e,"class","pagination is-centered mb-2"),v(e,"aria-label","pagination")},m(f,h){z(f,e,h),y(e,n),u&&u.m(n,null),y(n,i),y(n,r),y(r,s),y(s,o),y(n,l),d&&d.m(n,null),a||(c=Se(s,"click",en(t[9])),a=!0)},p(f,h){f[5]>1?u?u.p(f,h):(u=Ma(f),u.c(),u.m(n,i)):u&&(u.d(1),u=null),h&32&&Ee(o,f[5]),f[5]<f[3]?d?d.p(f,h):(d=Ta(f),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d(f){f&&D(e),u&&u.d(),d&&d.d(),a=!1,c()}}}function Ma(t){let e,n,i,r,s,o,l=t[5]-1>1&&xa(t);return{c(){e=b("li"),n=b("a"),n.textContent="1",i=F(),l&&l.c(),r=ht(),v(n,"class","pagination-link"),v(n,"href",null)},m(a,c){z(a,e,c),y(e,n),z(a,i,c),l&&l.m(a,c),z(a,r,c),s||(o=Se(n,"click",en(t[7])),s=!0)},p(a,c){a[5]-1>1?l?l.p(a,c):(l=xa(a),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},d(a){a&&D(e),a&&D(i),l&&l.d(a),a&&D(r),s=!1,o()}}}function xa(t){let e,n,i,r=t[5]-1+"",s,o,l,a=t[5]-1>2&&Aa();return{c(){a&&a.c(),e=F(),n=b("li"),i=b("a"),s=re(r),v(i,"class","pagination-link"),v(i,"href",null)},m(c,u){a&&a.m(c,u),z(c,e,u),z(c,n,u),y(n,i),y(i,s),o||(l=Se(i,"click",en(t[8])),o=!0)},p(c,u){c[5]-1>2?a||(a=Aa(),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),u&32&&r!==(r=c[5]-1+"")&&Ee(s,r)},d(c){a&&a.d(c),c&&D(e),c&&D(n),o=!1,l()}}}function Aa(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function Ta(t){let e,n,i,r,s,o,l=t[5]+1<t[3]&&Na(t);return{c(){l&&l.c(),e=F(),n=b("li"),i=b("a"),r=re(t[3]),v(i,"class","pagination-link"),v(i,"href",null)},m(a,c){l&&l.m(a,c),z(a,e,c),z(a,n,c),y(n,i),y(i,r),s||(o=Se(i,"click",en(t[11])),s=!0)},p(a,c){a[5]+1<a[3]?l?l.p(a,c):(l=Na(a),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),c&8&&Ee(r,a[3])},d(a){l&&l.d(a),a&&D(e),a&&D(n),s=!1,o()}}}function Na(t){let e,n,i=t[5]+1+"",r,s,o,l,a,c=t[5]+2<t[3]&&Oa();return{c(){e=b("li"),n=b("a"),r=re(i),s=F(),c&&c.c(),o=ht(),v(n,"class","pagination-link"),v(n,"href",null)},m(u,d){z(u,e,d),y(e,n),y(n,r),z(u,s,d),c&&c.m(u,d),z(u,o,d),l||(a=Se(n,"click",en(t[10])),l=!0)},p(u,d){d&32&&i!==(i=u[5]+1+"")&&Ee(r,i),u[5]+2<u[3]?c||(c=Oa(),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(u){u&&D(e),u&&D(s),c&&c.d(u),u&&D(o),l=!1,a()}}}function Oa(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(n,i){z(n,e,i)},d(n){n&&D(e)}}}function G_(t){let e,n,i=t[5]*t[2]-t[2]+1+"",r,s,o=Math.min(t[5]*t[2],t[1])+"",l,a,c,u,d=t[4]&&Ia(t);return{c(){d&&d.c(),e=F(),n=b("div"),r=re(i),s=re(" - "),l=re(o),a=re(" / "),c=re(t[1]),v(n,"class",u="is-size-7 is-center mb-4 "+(t[4]?"":"mt-4"))},m(f,h){d&&d.m(f,h),z(f,e,h),z(f,n,h),y(n,r),y(n,s),y(n,l),y(n,a),y(n,c)},p(f,[h]){f[4]?d?d.p(f,h):(d=Ia(f),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null),h&36&&i!==(i=f[5]*f[2]-f[2]+1+"")&&Ee(r,i),h&38&&o!==(o=Math.min(f[5]*f[2],f[1])+"")&&Ee(l,o),h&2&&Ee(c,f[1]),h&16&&u!==(u="is-size-7 is-center mb-4 "+(f[4]?"":"mt-4"))&&v(n,"class",u)},i:ee,o:ee,d(f){d&&d.d(f),f&&D(e),f&&D(n)}}}function X_(t,e,n){let i,r,s,{store:o}=e;const{currentPage:l}=o;we(t,l,p=>n(5,s=p));let{nbOfItems:a}=e,{pageLength:c=uu}=e;const u=()=>o.handlePageUpdate(1),d=()=>o.handlePageUpdate(s-1),f=()=>o.handlePageUpdate(s),h=()=>o.handlePageUpdate(s+1),m=()=>o.handlePageUpdate(i);return t.$$set=p=>{"store"in p&&n(0,o=p.store),"nbOfItems"in p&&n(1,a=p.nbOfItems),"pageLength"in p&&n(2,c=p.pageLength)},t.$$.update=()=>{t.$$.dirty&6&&n(3,i=c>0?Math.ceil(a/c):1),t.$$.dirty&14&&n(4,r=i>1||a>c)},[o,a,c,i,r,s,l,u,d,f,h,m]}class Pa extends Ae{constructor(e){super(),xe(this,e,X_,G_,Me,{store:0,nbOfItems:1,pageLength:2})}}function J_(t){let e,n,i,r,s=W==="en"?"Save selection":"Sauvegarder la sélection",o,l,a;return{c(){e=b("button"),n=b("span"),i=b("i"),r=F(),o=re(s),v(i,"class","fa-solid fa-floppy-disk"),v(e,"class","button is-link")},m(c,u){z(c,e,u),y(e,n),y(n,i),y(n,r),y(n,o),l||(a=Se(e,"click",t[7]),l=!0)},p:ee,d(c){c&&D(e),l=!1,a()}}}function Q_(t){let e,n,i,r,s=W==="en"?"Go to treatment":"Accéder au traitement",o,l;return{c(){var a;e=b("a"),n=b("span"),i=b("i"),r=F(),o=re(s),v(i,"class","fa-solid fa-gear"),v(e,"class","button is-link"),v(e,"href",l="/"+Ft+"/treatment/add/?document_set="+((a=t[3])==null?void 0:a.id))},m(a,c){z(a,e,c),y(e,n),y(n,i),y(n,r),y(n,o)},p(a,c){var u;c&8&&l!==(l="/"+Ft+"/treatment/add/?document_set="+((u=a[3])==null?void 0:u.id))&&v(e,"href",l)},d(a){a&&D(e)}}}function La(t){let e,n,i,r,s,o,l;return{c(){var a,c;e=b("a"),n=b("span"),n.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',r=F(),s=b("a"),o=b("span"),o.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',v(e,"class","button is-link is-dark"),v(e,"href",i="/"+Ft+"/document-set/"+((a=t[3])==null?void 0:a.id)+"/json"),v(e,"target","_blank"),v(s,"class","button is-link is-dark"),v(s,"href",l="/"+Ft+"/document-set/"+((c=t[3])==null?void 0:c.id)+"/zip"),v(s,"target","_blank")},m(a,c){z(a,e,c),y(e,n),z(a,r,c),z(a,s,c),y(s,o)},p(a,c){var u,d;c&8&&i!==(i="/"+Ft+"/document-set/"+((u=a[3])==null?void 0:u.id)+"/json")&&v(e,"href",i),c&8&&l!==(l="/"+Ft+"/document-set/"+((d=a[3])==null?void 0:d.id)+"/zip")&&v(s,"href",l)},d(a){a&&D(e),a&&D(r),a&&D(s)}}}function Z_(t){let e,n,i,r,s,o,l;function a(f,h){return f[2]&&!f[1]?Q_:J_}let c=a(t),u=c(t),d=!t[1]&&La(t);return{c(){e=b("footer"),n=b("div"),i=b("button"),i.textContent=`${W==="en"?"Clear selection":"Vider la sélection"}`,r=F(),u.c(),s=F(),d&&d.c(),v(i,"class","button button-close is-link is-light"),v(n,"class","buttons"),v(e,"class","modal-card-foot is-center")},m(f,h){z(f,e,h),y(e,n),y(n,i),y(n,r),u.m(n,null),y(n,s),d&&d.m(n,null),o||(l=Se(i,"click",t[6]),o=!0)},p(f,[h]){c===(c=a(f))&&u?u.p(f,h):(u.d(1),u=c(f),u&&(u.c(),u.m(n,s))),f[1]?d&&(d.d(1),d=null):d?d.p(f,h):(d=La(f),d.c(),d.m(n,null))},i:ee,o:ee,d(f){f&&D(e),u.d(),d&&d.d(),o=!1,l()}}}function e0(t,e,n){let i,r,{selectionStore:s}=e;const{isSaved:o,selection:l}=s;we(t,o,d=>n(2,i=d)),we(t,l,d=>n(3,r=d));let{isRegion:a=s.type!=="documentSet"}=e;const c=()=>s.empty(),u=()=>s.save();return t.$$set=d=>{"selectionStore"in d&&n(0,s=d.selectionStore),"isRegion"in d&&n(1,a=d.isRegion)},[s,a,i,r,o,l,c,u]}class t0 extends Ae{constructor(e){super(),xe(this,e,e0,Z_,Me,{selectionStore:0,isRegion:1})}}const eb="";function n0(t){let e,n,i,r,s,o;return{c(){e=b("span"),n=re(t[5]),i=F(),r=b("span"),r.innerHTML='<i class="fas fa-edit"></i>',v(r,"class","pl-3 smaller has-text-link")},m(l,a){z(l,e,a),y(e,n),y(e,i),y(e,r),s||(o=[Se(e,"click",t[7]),Se(e,"keyup",null)],s=!0)},p(l,a){a&32&&Ee(n,l[5])},d(l){l&&D(e),s=!1,ot(o)}}}function i0(t){let e,n,i;return{c(){e=b("input"),v(e,"class","input selection-title svelte-sgypdx")},m(r,s){z(r,e,s),t[12](e),Si(e,t[4]),n||(i=[Se(e,"input",t[13]),Se(e,"keydown",t[8]),Se(e,"blur",t[9])],n=!0)},p(r,s){s&16&&e.value!==r[4]&&Si(e,r[4])},d(r){r&&D(e),t[12](null),n=!1,ot(i)}}}function r0(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g,_,S,E,w;function k(P,L){return P[2]?i0:n0}let T=k(t),M=T(t);const C=t[11].default,x=Lt(C,t,t[10],null);return _=new t0({props:{selectionStore:t[0]}}),{c(){e=b("div"),n=b("div"),i=F(),r=b("div"),s=b("div"),o=b("div"),l=b("i"),a=F(),M.c(),c=re(`
                (`),u=re(t[1]),d=re(")"),f=F(),h=b("button"),m=F(),p=b("section"),x&&x.c(),g=F(),me(_.$$.fragment),v(n,"class","modal-background"),v(l,"class","fa-solid fa-book-bookmark"),v(o,"class","title is-4 mb-0 media-content"),v(h,"class","delete media-left"),v(h,"aria-label","close"),v(s,"class","modal-card-head media mb-0 is-middle"),v(p,"class","modal-card-body"),v(r,"class","modal-content"),v(e,"id","selection-modal"),v(e,"class","modal fade"),v(e,"tabindex","-1"),v(e,"aria-labelledby","selection-modal-label"),v(e,"aria-hidden","true")},m(P,L){z(P,e,L),y(e,n),y(e,i),y(e,r),y(r,s),y(s,o),y(o,l),y(o,a),M.m(o,null),y(o,c),y(o,u),y(o,d),y(s,f),y(s,h),y(r,m),y(r,p),x&&x.m(p,null),y(r,g),de(_,r,null),S=!0,E||(w=Jn(Er.call(null,e)),E=!0)},p(P,[L]){T===(T=k(P))&&M?M.p(P,L):(M.d(1),M=T(P),M&&(M.c(),M.m(o,c))),(!S||L&2)&&Ee(u,P[1]),x&&x.p&&(!S||L&1024)&&Dt(x,C,P,P[10],S?Rt(C,P[10],L,null):$t(P[10]),null);const H={};L&1&&(H.selectionStore=P[0]),_.$set(H)},i(P){S||(U(x,P),U(_.$$.fragment,P),S=!0)},o(P){K(x,P),K(_.$$.fragment,P),S=!1},d(P){P&&D(e),M.d(),x&&x.d(P),he(_),E=!1,w()}}}function s0(t,e,n){let i,{$$slots:r={},$$scope:s}=e,{selectionStore:o}=e;const{selectionTitle:l,updateTitle:a,save:c}=o;we(t,l,E=>n(5,i=E));let{selectionLength:u=!1}=e,d=!1,f,h;function m(){n(2,d=!0),n(4,h=i),setTimeout(()=>f&&f.focus(),0)}function p(E){E.key==="Enter"&&g()}function g(){n(2,d=!1),a(h),c()}function _(E){un[E?"unshift":"push"](()=>{f=E,n(3,f)})}function S(){h=this.value,n(4,h)}return t.$$set=E=>{"selectionStore"in E&&n(0,o=E.selectionStore),"selectionLength"in E&&n(1,u=E.selectionLength),"$$scope"in E&&n(10,s=E.$$scope)},[o,u,d,f,h,i,l,m,p,g,s,r,_,S]}class o0 extends Ae{constructor(e){super(),xe(this,e,s0,r0,Me,{selectionStore:0,selectionLength:1})}}const tb="";function l0(t){let e,n,i,r,s,o=W==="en"?"Selection":"Sélection",l,a,c,u,d,f;return{c(){e=b("div"),n=b("button"),i=b("span"),r=b("i"),s=F(),l=re(o),a=re(`
            (`),c=re(t[0]),u=re(")"),v(r,"class","fa-solid fa-book-bookmark"),v(i,"id","btn-content"),v(n,"id","set-btn"),v(n,"class","button px-5 py-4 is-link svelte-gmt9z5"),v(n,"data-target","selection-modal"),v(e,"class","set-container svelte-gmt9z5")},m(h,m){z(h,e,m),y(e,n),y(n,i),y(i,r),y(i,s),y(i,l),y(i,a),y(i,c),y(i,u),d||(f=Jn(Hs.call(null,n)),d=!0)},p(h,[m]){m&1&&Ee(c,h[0])},i:ee,o:ee,d(h){h&&D(e),d=!1,f()}}}function a0(t,e,n){let{selectionLength:i=0}=e,r=i;return t.$$set=s=>{"selectionLength"in s&&n(0,i=s.selectionLength)},t.$$.update=()=>{if(t.$$.dirty&3&&i!==r){const s=i>r;n(1,r=i);const o=document.getElementById("btn-content");o&&o.animate([{transform:s?"translateY(-7px)":"translateX(-5px)"},{transform:s?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[i,r]}class c0 extends Ae{constructor(e){super(),xe(this,e,a0,l0,Me,{selectionLength:0})}}const nb="";function Ra(t,e,n){const i=t.slice();return i[7]=e[n][0],i[8]=e[n][1],i}function u0(t){let e;return{c(){e=b("div"),e.textContent=`${W==="en"?"No regions in selection":"Aucune région sélectionnée"}`},m(n,i){z(n,e,i)},p:ee,d(n){n&&D(e)}}}function f0(t){let e,n,i=Object.entries(t[2]),r=[];for(let s=0;s<i.length;s+=1)r[s]=Da(Ra(t,i,s));return{c(){e=b("div"),n=b("div");for(let s=0;s<r.length;s+=1)r[s].c();v(n,"class","grid is-gap-2"),v(e,"class","fixed-grid has-6-cols")},m(s,o){z(s,e,o),y(e,n);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(n,null)},p(s,o){if(o&13){i=Object.entries(s[2]);let l;for(l=0;l<i.length;l+=1){const a=Ra(s,i,l);r[l]?r[l].p(a,o):(r[l]=Da(a),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=i.length}},d(s){s&&D(e),at(r,s)}}}function Da(t){let e,n,i,r,s,o,l,a=t[8].title+"",c,u,d,f,h,m;function p(){return t[6](t[7])}return{c(){e=b("div"),n=b("figure"),i=b("img"),s=F(),o=b("div"),l=b("span"),c=re(a),u=F(),d=b("button"),f=F(),vt(i.src,r=Vt(t[8].img,t[8].xywh,"96,"))||v(i,"src",r),v(i,"alt","Extracted region"),v(l,"class","overlay-desc"),v(o,"class","overlay is-center svelte-g8ij5d"),v(n,"class","image is-64x64 card"),v(d,"class","delete region-btn svelte-g8ij5d"),v(d,"aria-label","remove from selection"),v(e,"class","selection cell svelte-g8ij5d")},m(g,_){z(g,e,_),y(e,n),y(n,i),y(n,s),y(n,o),y(o,l),y(l,c),y(e,u),y(e,d),y(e,f),h||(m=Se(d,"click",p),h=!0)},p(g,_){t=g,_&4&&!vt(i.src,r=Vt(t[8].img,t[8].xywh,"96,"))&&v(i,"src",r),_&4&&a!==(a=t[8].title+"")&&Ee(c,a)},d(g){g&&D(e),h=!1,m()}}}function d0(t){let e;function n(s,o){return s[4]?f0:u0}let i=n(t),r=i(t);return{c(){r.c(),e=ht()},m(s,o){r.m(s,o),z(s,e,o)},p(s,o){i===(i=n(s))&&r?r.p(s,o):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&D(e)}}}function h0(t){let e,n,i,r;return e=new c0({props:{selectionLength:t[1]}}),i=new o0({props:{selectionLength:t[1],selectionStore:t[0],$$slots:{default:[d0]},$$scope:{ctx:t}}}),{c(){me(e.$$.fragment),n=F(),me(i.$$.fragment)},m(s,o){de(e,s,o),z(s,n,o),de(i,s,o),r=!0},p(s,[o]){const l={};o&2&&(l.selectionLength=s[1]),e.$set(l);const a={};o&2&&(a.selectionLength=s[1]),o&1&&(a.selectionStore=s[0]),o&2077&&(a.$$scope={dirty:o,ctx:s}),i.$set(a)},i(s){r||(U(e.$$.fragment,s),U(i.$$.fragment,s),r=!0)},o(s){K(e.$$.fragment,s),K(i.$$.fragment,s),r=!1},d(s){he(e,s),s&&D(n),he(i,s)}}}function m0(t,e,n){let i,r,s,o,{selectionStore:l}=e;const{selected:a}=l;we(t,a,u=>n(3,o=u));const c=u=>l.remove(u,Object.keys(o)[0]);return t.$$set=u=>{"selectionStore"in u&&n(0,l=u.selectionStore)},t.$$.update=()=>{t.$$.dirty&8&&n(2,i=Object.values(o)[0]||{}),t.$$.dirty&4&&n(1,r=Object.keys(i).length),t.$$.dirty&2&&n(4,s=r>0)},[l,r,i,o,s,a,c]}class p0 extends Ae{constructor(e){super(),xe(this,e,m0,h0,Me,{selectionStore:0})}}const ib="";function $a(t,e,n){const i=t.slice();return i[17]=e[n],i}function za(t,e,n){const i=t.slice();return i[20]=e[n],i}function ja(t,e,n){const i=t.slice();return i[23]=e[n],i}function Fa(t){let e,n,i,r,s,o=t[23].title+"",l,a,c,u=t[23].shortcut+"",d,f,h,m;return{c(){e=b("p"),n=b("button"),i=b("span"),r=b("i"),s=F(),l=re(o),a=F(),c=b("span"),d=re(u),f=F(),v(r,"class","fas "+t[23].icon+" svelte-7vjt6f"),v(i,"class","icon is-small"),v(c,"class","shortcut svelte-7vjt6f"),v(n,"class","button pl-5"),v(n,"title",t[23].desc),v(e,"class","control")},m(p,g){z(p,e,g),y(e,n),y(n,i),y(i,r),y(n,s),y(n,l),y(n,a),y(n,c),y(c,d),y(e,f),h||(m=Se(n,"click",en(t[23].fct)),h=!0)},p(p,g){t=p},d(p){p&&D(e),h=!1,m()}}}function g0(t){let e,n,i,r,s,o,l,a=Object.values(t[10]),c=[];for(let u=0;u<a.length;u+=1)c[u]=Fa(ja(t,a,u));return{c(){e=b("div"),n=b("div"),i=b("div"),r=b("span"),r.textContent=`${W==="en"?"Process selection":"Agir sur la sélection"}`,s=F(),o=b("div"),l=b("div");for(let u=0;u<c.length;u+=1)c[u].c();v(r,"class","tag is-medium is-link mr-5"),v(i,"class","column is-narrow mr-5"),v(l,"class","field has-addons"),v(o,"class","column"),v(n,"class","columns is-vcentered is-mobile py-4"),v(e,"slot","toolbar-visible")},m(u,d){z(u,e,d),y(e,n),y(n,i),y(i,r),y(n,s),y(n,o),y(o,l);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(l,null)},p(u,d){if(d&1024){a=Object.values(u[10]);let f;for(f=0;f<a.length;f+=1){const h=ja(u,a,f);c[f]?c[f].p(h,d):(c[f]=Fa(h),c[f].c(),c[f].m(l,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=a.length}},d(u){u&&D(e),at(c,u)}}}function _0(t){let e,n=t[9].title+"",i;return{c(){e=b("span"),i=re(n),v(e,"class","button is-small is-success"),v(e,"title",t[9].desc)},m(r,s){z(r,e,s),y(e,i)},p:ee,d(r){r&&D(e)}}}function v0(t){let e,n=t[8].title+"",i,r,s;function o(){return t[12](t[17])}return{c(){e=b("button"),i=re(n),v(e,"class","button is-small is-warning"),v(e,"title",t[8].desc)},m(l,a){z(l,e,a),y(e,i),r||(s=Se(e,"click",o),r=!0)},p(l,a){t=l},d(l){l&&D(e),r=!1,s()}}}function y0(t){let e,n,i=t[17].size+"",r,s,o,l,a,c;function u(h,m){return h[17].fullyConnected?_0:v0}let d=u(t),f=d(t);return{c(){e=b("div"),n=b("span"),r=re(i),s=re(" images"),o=F(),l=b("hr"),a=F(),f.c(),c=F(),v(n,"class","cluster-size"),v(e,"class","cluster-info is-center is-fullwidth")},m(h,m){z(h,e,m),y(e,n),y(n,r),y(n,s),y(e,o),y(e,l),y(e,a),f.m(e,null),z(h,c,m)},p(h,m){m&4&&i!==(i=h[17].size+"")&&Ee(r,i),d===(d=u(h))&&f?f.p(h,m):(f.d(1),f=d(h),f&&(f.c(),f.m(e,null)))},d(h){h&&D(e),f.d(),h&&D(c)}}}function Va(t){let e,n;return e=new Wn({props:{item:{...t[3].get(t[20]),clusterId:t[17].id},copyable:!1,selectionStore:or}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p(i,r){const s={};r&12&&(s.item={...i[3].get(i[20]),clusterId:i[17].id}),e.$set(s)},i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function b0(t){let e,n,i=t[17].members,r=[];for(let o=0;o<i.length;o+=1)r[o]=Va(za(t,i,o));const s=o=>K(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=F()},m(o,l){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(o,l);z(o,e,l),n=!0},p(o,l){if(l&12){i=o[17].members;let a;for(a=0;a<i.length;a+=1){const c=za(o,i,a);r[a]?(r[a].p(c,l),U(r[a],1)):(r[a]=Va(c),r[a].c(),U(r[a],1),r[a].m(e.parentNode,e))}for(ze(),a=i.length;a<r.length;a+=1)s(a);je()}},i(o){if(!n){for(let l=0;l<i.length;l+=1)U(r[l]);n=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)K(r[l]);n=!1},d(o){at(r,o),o&&D(e)}}}function Ha(t,e){let n,i,r;return i=new wa({props:{$$slots:{"row-body":[b0],"row-header":[y0]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=ht(),me(i.$$.fragment),this.first=n},m(s,o){z(s,n,o),de(i,s,o),r=!0},p(s,o){e=s;const l={};o&67108876&&(l.$$scope={dirty:o,ctx:e}),i.$set(l)},i(s){r||(U(i.$$.fragment,s),r=!0)},o(s){K(i.$$.fragment,s),r=!1},d(s){s&&D(n),he(i,s)}}}function w0(t){let e=[],n=new Map,i,r,s=t[2];const o=l=>l[17].id;for(let l=0;l<s.length;l+=1){let a=$a(t,s,l),c=o(a);n.set(c,e[l]=Ha(c,a))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();i=ht()},m(l,a){for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(l,a);z(l,i,a),r=!0},p(l,a){a&780&&(s=l[2],ze(),e=ei(e,a,o,1,l,s,n,i.parentNode,vr,Ha,i,$a),je())},i(l){if(!r){for(let a=0;a<s.length;a+=1)U(e[a]);r=!0}},o(l){for(let a=0;a<e.length;a+=1)K(e[a]);r=!1},d(l){for(let a=0;a<e.length;a+=1)e[a].d(l);l&&D(i)}}}function S0(t){let e,n,i,r,s,o,l,a,c,u;return e=new Y_({props:{expandable:!1,$$slots:{"toolbar-visible":[g0]},$$scope:{ctx:t}}}),i=new Pa({props:{store:t[0],nbOfItems:t[1],pageLength:t[7]}}),s=new p0({props:{selectionStore:or}}),l=new D_({props:{$$slots:{default:[w0]},$$scope:{ctx:t}}}),c=new Pa({props:{store:t[0],nbOfItems:t[1],pageLength:t[7]}}),{c(){me(e.$$.fragment),n=F(),me(i.$$.fragment),r=F(),me(s.$$.fragment),o=F(),me(l.$$.fragment),a=F(),me(c.$$.fragment)},m(d,f){de(e,d,f),z(d,n,f),de(i,d,f),z(d,r,f),de(s,d,f),z(d,o,f),de(l,d,f),z(d,a,f),de(c,d,f),u=!0},p(d,[f]){const h={};f&67108864&&(h.$$scope={dirty:f,ctx:d}),e.$set(h);const m={};f&1&&(m.store=d[0]),f&2&&(m.nbOfItems=d[1]),i.$set(m);const p={};f&67108876&&(p.$$scope={dirty:f,ctx:d}),l.$set(p);const g={};f&1&&(g.store=d[0]),f&2&&(g.nbOfItems=d[1]),c.$set(g)},i(d){u||(U(e.$$.fragment,d),U(i.$$.fragment,d),U(s.$$.fragment,d),U(l.$$.fragment,d),U(c.$$.fragment,d),u=!0)},o(d){K(e.$$.fragment,d),K(i.$$.fragment,d),K(s.$$.fragment,d),K(l.$$.fragment,d),K(c.$$.fragment,d),u=!1},d(d){he(e,d),d&&D(n),he(i,d),d&&D(r),he(s,d),d&&D(o),he(l,d),d&&D(a),he(c,d)}}}function k0(t,e,n){let i,r,s,{documentSetStore:o}=e;const{imageNodes:l}=o;we(t,l,w=>n(3,s=w));let{clusterStore:a}=e;const{clusterNb:c,paginatedClusters:u,pageLength:d,validateCluster:f,newCluster:h,removeFromClusters:m}=a;we(t,c,w=>n(1,i=w)),we(t,u,w=>n(2,r=w));const p={create:{title:W==="en"?"New cluster":"Nouveau cluster",desc:W==="en"?"Create a new validated cluster from the selected regions":"Créer un nouveau cluster valide à partir des régions sélectionnées",icon:"fa-object-group",shortcut:"Shift + C",fct:h},remove:{title:W==="en"?"Remove from cluster":"Retirer du cluster",desc:W==="en"?"Remove the selected regions from their cluster":"Retirer les régions sélectionnées de leur cluster",icon:"fa-chain-broken",shortcut:"Shift + D",fct:m},validate:{title:W==="en"?"Validate cluster":"Valider le cluster",desc:W==="en"?"Set as exact match all the pairs of regions in the cluster":"Définir comme correspondance exacte toutes les paires de régions dans le cluster",icon:"fa-check",fct:f},validated:{title:W==="en"?"Validated cluster":"Cluster valide",desc:W==="en"?"All pairs of regions have be categorized as exact matches":"Toutes les paires de régions ont été catégorisées comme des correspondances exactes",icon:"fa-check"}},{validate:g,validated:_,...S}=p,E=w=>g.fct(w);return t.$$set=w=>{"documentSetStore"in w&&n(11,o=w.documentSetStore),"clusterStore"in w&&n(0,a=w.clusterStore)},[a,i,r,s,l,c,u,d,g,_,S,o,E]}class E0 extends Ae{constructor(e){super(),xe(this,e,k0,S0,Me,{documentSetStore:11,clusterStore:0})}}function C0(t,e){const i=Te(1),{visiblePairs:r,imageNodes:s}=t;wr(i,"p");function o(w){Sr(w,i,"p")}function l(w){if(w.length===0)return[];const k=new Map,T=P=>k.has(P)?(k.get(P)!==P&&k.set(P,T(k.get(P))),k.get(P)):(k.set(P,P),P),M=(P,L)=>{const H=T(P),$=T(L);H!==$&&k.set($,H)},C=new Set;w.forEach(P=>{M(P.id_1,P.id_2),C.add(P.id_1),C.add(P.id_2)});const x=new Map;return C.forEach(P=>{const L=T(P);x.has(L)||x.set(L,[]),x.get(L).push(P)}),Array.from(x.values()).map(P=>{const L=P.length,H=L*(L-1)/2,$=new Set(P),I=w.filter(R=>$.has(R.id_1)&&$.has(R.id_2)).length;return{id:crypto.randomUUID(),members:P,size:L,fullyConnected:I===H}}).filter(P=>P.size>1).sort((P,L)=>L.size-P.size)}const a=nt(r,w=>w.length?l(w):[]),c=Te([]);a.subscribe(w=>{c.set(w)});const u=nt([c,i],([w,k])=>{const T=(k-1)*10,M=T+10;return w.slice(T,M)}),d=(w,k)=>{const T=lt(s).get(w),M=lt(s).get(k);return{img_1:w,img_2:k,regions_id_1:T==null?void 0:T.regionId,regions_id_2:M==null?void 0:M.regionId}},f=(w,k)=>(c.update(T=>T.map(M=>{if(!k[M.id])return M;const C=M.members.filter(x=>!w.has(x));return{...M,members:C,size:C.length}}).filter(M=>M.size>0)),!0),h=async w=>{const k=Array.isArray(w)?w:Object.keys(w),T=new Set(k),M={};lt(c).forEach(x=>{const P=x.members.filter(L=>T.has(L));P.length>0&&(M[x.id]=P)});const C=Object.entries(M).flatMap(([x,P])=>{const L=lt(c).find($=>$.id===x);if(!L)return[];const H=L.members.filter($=>!T.has($));return P.flatMap($=>H.map(I=>d($,I)))});if(C.length===0)return f(T,M),!0;try{const x=await js(()=>fetch(`${window.location.origin}/${Ft}/uncategorize-pair-batch`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":dn},body:JSON.stringify({pairs:C})}));return x.ok?(f(T,M),!0):(console.log(x),await Ct(W==="en"?"Batch un-categorization failed":"La dé-catégorisation par lot a échoué",W==="en"?"Error":"Erreur"),!1)}catch(x){return await Ct(x,W==="en"?"Error":"Erreur"),!1}},m=async w=>{const k=w.flatMap((T,M)=>w.slice(M+1).map(C=>d(T,C)));try{const T=await js(()=>fetch(`${window.location.origin}/${Ft}/exact-match-batch`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":dn},body:JSON.stringify({pairs:k})}));return T.ok?!0:(console.log(T),await Ct(W==="en"?"Batch validation failed":"La validation par lot a échoué",W==="en"?"Error":"Erreur"),!1)}catch(T){return await Ct(T,W==="en"?"Error":"Erreur"),console.error("Error:",T),!1}},p=async w=>{const k=await m(w.members);return k&&c.update(T=>T.map(M=>M.id===w.id?{...M,fullyConnected:!0}:M)),k},g=async w=>{if(w.length<2)return!1;const k=await m(w);return k&&c.update(T=>[{id:crypto.randomUUID(),members:w,size:w.length,fullyConnected:!0},...T].sort((C,x)=>x.size-C.size)),k},_=()=>Object.values(lt(e).selected)[0]||{},S=async()=>{if(!await Ct(W==="en"?"Do you want to create a cluster out of these images?":"Voulez-vous créer un cluster à partir de ces images ?",W==="en"?"Confirm creation":"Confirmer la création",!0))return;const k=_(),T=Object.keys(k);return T.length<2?(await Ct(W==="en"?"Cluster creation requires at least 2 images":"La création d'un nouveau cluster nécessite a minima 2 images",W==="en"?"Impossible creation":"Création impossible"),!1):!await h(T)||!await g(T)?!1:(e.empty(),!0)},E=async()=>{if(!await Ct(W==="en"?"Do you want to remove these images from their clusters?":"Voulez-vous supprimer ces images de leurs clusters ?",W==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;const k=_();return await h(Object.keys(k))?(e.empty(),!0):!1};return{imageClusters:a,interfaceClusters:c,clusterNb:nt(c,w=>w.length),validateCluster:p,removeFromClusters:E,newCluster:S,paginatedClusters:u,handlePageUpdate:o,pageLength:10,currentPage:i}}function Ua(t,e,n){const i=t.slice();return i[25]=e[n],i}function I0(t){let e,n,i;return{c(){e=b("p"),e.textContent=`La matrice de documents visualise les scores de similarité globaux entre tous les documents du
                        corpus.
                        Cliquez sur une cellule pour voir les détails des similarités entre pages.`,n=F(),i=b("ul"),i.innerHTML=`<li>Matrice : Scores normalisés entre documents (0-100).</li>
                        <li>Scatter plot : Similarités détaillées par page.</li>`},m(r,s){z(r,e,s),z(r,n,s),z(r,i,s)},d(r){r&&D(e),r&&D(n),r&&D(i)}}}function M0(t){let e,n,i;return{c(){e=b("p"),e.textContent=`The Documents Network illustrates the connections between different witnesses in the document
                        set.
                        Each node represents a witness, and edges denote relationships based on shared content or other
                        relevant factors.`,n=F(),i=b("ul"),i.innerHTML=`<li>Nodes: Witnesses in the document set.</li>
                        <li>Edges: Relationships based on shared content.</li>`},m(r,s){z(r,e,s),z(r,n,s),z(r,i,s)},d(r){r&&D(e),r&&D(n),r&&D(i)}}}function x0(t){let e,n,i;return{c(){e=b("p"),e.textContent=`The Regions Network visualizes the relationships between image regions across different witnesses
                        in the document set.
                        Each node represents an image region, and edges indicate similarity or connections based on
                        predefined criteria.`,n=F(),i=b("ul"),i.innerHTML=`<li>Nodes: Image regions from various witnesses.</li>
                        <li>Edges: Similarity links between regions.</li>`},m(r,s){z(r,e,s),z(r,n,s),z(r,i,s)},d(r){r&&D(e),r&&D(n),r&&D(i)}}}function A0(t){let e,n,i,r;function s(a,c){return a[23]==="img"?x0:a[23]==="doc"?M0:I0}let o=s(t),l=o(t);return i=new P_({props:{activeTab:t[23],documentSetStore:t[4]}}),{c(){e=b("div"),l.c(),n=F(),me(i.$$.fragment),v(e,"slot","datavizInfo")},m(a,c){z(a,e,c),l.m(e,null),y(e,n),de(i,e,null),r=!0},p(a,c){o!==(o=s(a))&&(l.d(1),l=o(a),l&&(l.c(),l.m(e,n)));const u={};c&8388608&&(u.activeTab=a[23]),i.$set(u)},i(a){r||(U(i.$$.fragment,a),r=!0)},o(a){K(i.$$.fragment,a),r=!1},d(a){a&&D(e),l.d(),he(i)}}}function T0(t){let e,n,i;return n=new Bf({props:{docSet:t[0],documentSetStore:t[4],clusterStore:t[8],$$slots:{datavizInfo:[A0]},$$scope:{ctx:t}}}),{c(){e=b("div"),me(n.$$.fragment),v(e,"slot","sidebar")},m(r,s){z(r,e,s),de(n,e,null),i=!0},p(r,s){const o={};s&1&&(o.docSet=r[0]),s&276824064&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){i||(U(n.$$.fragment,r),i=!0)},o(r){K(n.$$.fragment,r),i=!1},d(r){r&&D(e),he(n)}}}function Ba(t){let e,n,i,r,s,o,l,a=t[25].title+"",c,u;return{c(){e=b("div"),n=b("figure"),i=b("img"),s=F(),o=b("div"),l=b("span"),c=re(a),u=F(),vt(i.src,r=Vt(t[25].img,t[25].xywh,"96,"))||v(i,"src",r),v(i,"alt","Extracted region"),v(l,"class","overlay-desc"),v(o,"class","overlay is-center"),v(n,"class","image is-64x64 card"),v(e,"class","selection cell")},m(d,f){z(d,e,f),y(e,n),y(n,i),y(n,s),y(n,o),y(o,l),y(l,c),y(e,u)},p(d,f){f&2&&!vt(i.src,r=Vt(d[25].img,d[25].xywh,"96,"))&&v(i,"src",r),f&2&&a!==(a=d[25].title+"")&&Ee(c,a)},d(d){d&&D(e)}}}function N0(t){let e,n,i=Object.values(Object.values(t[1])[0]||{}),r=[];for(let s=0;s<i.length;s+=1)r[s]=Ba(Ua(t,i,s));return{c(){e=b("div"),n=b("div");for(let s=0;s<r.length;s+=1)r[s].c();v(n,"class","grid is-gap-2"),v(e,"slot","content"),v(e,"class","fixed-grid has-6-cols")},m(s,o){z(s,e,o),y(e,n);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(n,null)},p(s,o){if(o&2){i=Object.values(Object.values(s[1])[0]||{});let l;for(l=0;l<i.length;l+=1){const a=Ua(s,i,l);r[l]?r[l].p(a,o):(r[l]=Ba(a),r[l].c(),r[l].m(n,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=i.length}},d(s){s&&D(e),at(r,s)}}}function O0(t){let e,n,i,r={ctx:t,current:null,token:null,hasCatch:!1,pending:V0,then:R0,catch:L0,value:24,blocks:[,,,]};return _r(n=t[3],r),{c(){e=ht(),r.block.c()},m(s,o){z(s,e,o),r.block.m(s,r.anchor=o),r.mount=()=>e.parentNode,r.anchor=e,i=!0},p(s,o){t=s,r.ctx=t,o&8&&n!==(n=t[3])&&_r(n,r)||Ds(r,t,o)},i(s){i||(U(r.block),i=!0)},o(s){for(let o=0;o<3;o+=1){const l=r.blocks[o];K(l)}i=!1},d(s){s&&D(e),r.block.d(s),r.token=null,r=null}}}function P0(t){let e,n,i;return{c(){e=b("article"),n=b("div"),i=re(t[2]),v(n,"class","message-body"),v(e,"class","message is-danger")},m(r,s){z(r,e,s),y(e,n),y(n,i)},p(r,s){s&4&&Ee(i,r[2])},i:ee,o:ee,d(r){r&&D(e)}}}function L0(t){return{c:ee,m:ee,p:ee,i:ee,o:ee,d:ee}}function R0(t){let e,n,i,r;const s=[$0,D0],o=[];function l(a,c){return a[24]===0?0:1}return e=l(t),n=o[e]=s[e](t),{c(){n.c(),i=ht()},m(a,c){o[e].m(a,c),z(a,i,c),r=!0},p(a,c){let u=e;e=l(a),e===u?o[e].p(a,c):(ze(),K(o[u],1,1,()=>{o[u]=null}),je(),n=o[e],n?n.p(a,c):(n=o[e]=s[e](a),n.c()),U(n,1),n.m(i.parentNode,i))},i(a){r||(U(n),r=!0)},o(a){K(n),r=!1},d(a){o[e].d(a),a&&D(i)}}}function D0(t){let e,n,i=t[9][t[23]]+"",r,s,o,l,a;const c=[F0,j0,z0],u=[];function d(f,h){return f[23]==="img"||f[23]==="doc"?0:f[23]==="sim"?1:f[23]==="mat"?2:-1}return~(o=d(t))&&(l=u[o]=c[o](t)),{c(){e=b("div"),n=b("h2"),r=re(i),s=F(),l&&l.c(),v(n,"class","title is-3 has-text-link")},m(f,h){z(f,e,h),y(e,n),y(n,r),y(e,s),~o&&u[o].m(e,null),a=!0},p(f,h){(!a||h&8388608)&&i!==(i=f[9][f[23]]+"")&&Ee(r,i);let m=o;o=d(f),o===m?~o&&u[o].p(f,h):(l&&(ze(),K(u[m],1,1,()=>{u[m]=null}),je()),~o?(l=u[o],l?l.p(f,h):(l=u[o]=c[o](f),l.c()),U(l,1),l.m(e,null)):l=null)},i(f){a||(U(l),a=!0)},o(f){K(l),a=!1},d(f){f&&D(e),~o&&u[o].d()}}}function $0(t){let e;return{c(){e=b("article"),e.innerHTML=`<div class="message-body">No document pairs found for this configuration.
                            Please adjust your selection criteria in the sidebar to include more documents or
                            categories.</div>`,v(e,"class","message is-warning")},m(n,i){z(n,e,i)},p:ee,i:ee,o:ee,d(n){n&&D(e)}}}function z0(t){let e,n;return e=new x_({props:{documentSetStore:t[4]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p:ee,i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function j0(t){let e,n;return e=new E0({props:{documentSetStore:t[4],clusterStore:t[8]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p:ee,i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function F0(t){let e,n;return e=new w_({props:{documentSetStore:t[4],type:t[23]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p(i,r){const s={};r&8388608&&(s.type=i[23]),e.$set(s)},i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function V0(t){let e;return{c(){e=b("progress"),e.textContent="Loading...",v(e,"class","progress is-link"),v(e,"max","100")},m(n,i){z(n,e,i)},p:ee,i:ee,o:ee,d(n){n&&D(e)}}}function H0(t){let e,n,i,r,s,o;n=new Au({props:{$$slots:{content:[N0]},$$scope:{ctx:t}}});const l=[P0,O0],a=[];function c(u,d){return u[2]?0:1}return r=c(t),s=a[r]=l[r](t),{c(){e=b("div"),me(n.$$.fragment),i=F(),s.c(),v(e,"slot","content")},m(u,d){z(u,e,d),de(n,e,null),y(e,i),a[r].m(e,null),o=!0},p(u,d){const f={};d&268435458&&(f.$$scope={dirty:d,ctx:u}),n.$set(f);let h=r;r=c(u),r===h?a[r].p(u,d):(ze(),K(a[h],1,1,()=>{a[h]=null}),je(),s=a[r],s?s.p(u,d):(s=a[r]=l[r](u),s.c()),U(s,1),s.m(e,null))},i(u){o||(U(n.$$.fragment,u),U(s),o=!0)},o(u){K(n.$$.fragment,u),K(s),o=!1},d(u){u&&D(e),he(n),a[r].d()}}}function U0(t){let e,n;return e=new zu({props:{tabList:t[9],$$slots:{content:[H0,({activeTab:i})=>({23:i}),({activeTab:i})=>i?8388608:0],sidebar:[T0,({activeTab:i})=>({23:i}),({activeTab:i})=>i?8388608:0]},$$scope:{ctx:t}}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p(i,[r]){const s={};r&276824079&&(s.$$scope={dirty:r,ctx:i}),e.$set(s)},i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function B0(t,e,n){var P;let i,r,s,{docSet:o}=e;const l=T_(o.id),{error:a,fetchPairs:c,selectedRegions:u,selectedCategories:d,threshold:f,topK:h,mutualTopK:m,scoreMode:p}=l;we(t,a,L=>n(2,r=L)),we(t,c,L=>n(3,s=L));let g,_,S,E,w,k;Nn(()=>{g=zn(u,"regions","set"),_=zn(d,"categories","array"),S=zn(f,"threshold","number"),E=zn(h,"topk","number"),w=zn(m,"mutual","boolean"),k=zn(p,"mode","string"),lt(d)||d.set([1]);const L=u.subscribe(g),H=d.subscribe(_),$=f.subscribe(S),I=h.subscribe(E),R=m.subscribe(w),O=p.subscribe(k);return()=>{L(),H(),$(),I(),R(),O()}});const{selected:T}=or;we(t,T,L=>n(1,i=L));const M=C0(l,or),C={img:W==="en"?"Image Network":"Réseau d'images",doc:W==="en"?"Document Network":"Réseau de documents",sim:W==="en"?"Copy Clusters":"Groupe de copies",mat:W==="en"?"Document Matrix":"Matrice de documents"},x=((P=o==null?void 0:o.selection)==null?void 0:P.selected)||{Witness:{},Series:{},Work:{}};return Pn("selectedDocuments",x),t.$$set=L=>{"docSet"in L&&n(0,o=L.docSet)},[o,i,r,s,l,a,c,T,M,C]}class q0 extends Ae{constructor(e){super(),xe(this,e,B0,U0,Me,{docSet:0})}}new q0({target:document.getElementById("document-set"),props:{docSet}});const rb="";function K0(t){let e,n,i;return n=new Wn({props:{item:t[0],height:"full"}}),{c(){e=b("div"),me(n.$$.fragment),v(e,"class","img-wrapper svelte-1duc3w1")},m(r,s){z(r,e,s),de(n,e,null),i=!0},p(r,[s]){const o={};s&1&&(o.item=r[0]),n.$set(o)},i(r){i||(U(n.$$.fragment,r),i=!0)},o(r){K(n.$$.fragment,r),i=!1},d(r){r&&D(e),he(n)}}}function W0(t,e,n){let{mainImgItem:i}=e;return t.$$set=r=>{"mainImgItem"in r&&n(0,i=r.mainImgItem)},[i]}class qa extends Ae{constructor(e){super(),xe(this,e,W0,K0,Me,{mainImgItem:0})}}const sb="";function Y0(t){return{c:ee,m:ee,p:ee,d:ee}}function G0(t){let e,n=`${t[5][0]}%`,i=`${t[5][1]}%`,r=`${t[5][2]}%`,s=`${t[5][3]}%`;return{c(){e=b("div"),v(e,"class","modal-context-bbox svelte-zgr10j"),v(e,"aria-description",W==="fr"?"Position de la région extraite sur la page":"Position of the extracted region on the page"),De(e,"left",n),De(e,"top",i),De(e,"width",r),De(e,"height",s)},m(o,l){z(o,e,l)},p:ee,d(o){o&&D(e)}}}function X0(t){return{c:ee,m:ee,p:ee,d:ee}}function J0(t){let e,n,i,r,s,o={ctx:t,current:null,token:null,hasCatch:!1,pending:X0,then:G0,catch:Y0,value:5};return _r(t[1],o),{c(){e=b("div"),n=b("div"),i=b("img"),s=F(),o.block.c(),v(i,"class","card modal-context-full-page svelte-zgr10j"),vt(i.src,r=t[0])||v(i,"src",r),v(i,"alt",W==="fr"?"Vue de la page d'où la région est extraite":"View of the page the region is extracted from"),v(n,"class","modal-context-wrapper svelte-zgr10j"),v(e,"class","modal-context-outer pb-4 svelte-zgr10j")},m(l,a){z(l,e,a),y(e,n),y(n,i),y(n,s),o.block.m(n,o.anchor=null),o.mount=()=>n,o.anchor=null},p(l,[a]){t=l,Ds(o,t,a)},i:ee,o:ee,d(l){l&&D(e),o.block.d(),o.token=null,o=null}}}function Q0(t,e,n){let{mainImgItem:i}=e;const r=Vt(i.img,"full","full"),s=yu(i.img),o=i.xywh.map(Number),l=fetch(s).then(a=>a.json()).then(a=>[o[0]/a.width,o[1]/a.height,o[2]/a.width,o[3]/a.height].map(c=>c*100));return t.$$set=a=>{"mainImgItem"in a&&n(2,i=a.mainImgItem)},[r,l,i]}class Z0 extends Ae{constructor(e){super(),xe(this,e,Q0,J0,Me,{mainImgItem:2})}}const ob="";function Ka(t,e,n){const i=t.slice();return i[13]=e[n].id,i[14]=e[n].label,i}function Wa(t){let e,n,i=t[14]+"",r,s,o,l,a;function c(){return t[9](t[13])}return{c(){e=b("li"),n=b("a"),r=re(i),s=F(),v(n,"href",""),v(e,"class",o=t[13]===t[2]?"is-active":"")},m(u,d){z(u,e,d),y(e,n),y(n,r),y(e,s),l||(a=Se(n,"click",en(c)),l=!0)},p(u,d){t=u,d&4&&o!==(o=t[13]===t[2]?"is-active":"")&&v(e,"class",o)},d(u){u&&D(e),l=!1,a()}}}function e1(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g=t[3],_=[];for(let k=0;k<g.length;k+=1)_[k]=Wa(Ka(t,g,k));const S=[t[1][t[2]]||{}];var E=t[0][t[2]]||null;function w(k){let T={};for(let M=0;M<S.length;M+=1)T=Cs(T,S[M]);return{props:T}}return E&&(u=ki(E,w())),{c(){e=b("div"),n=b("div"),i=F(),r=b("div"),s=b("div"),o=b("div"),l=b("ul");for(let k=0;k<_.length;k+=1)_[k].c();a=F(),c=b("div"),u&&me(u.$$.fragment),d=F(),f=b("button"),v(n,"class","modal-background"),v(o,"class","tabs is-centered"),De(o,"height","fit-content"),v(c,"class","ml-4 mr-4 modal-main-wrapper svelte-1uakzh2"),Pe(c,"pb-4",t[2]==="main"),v(s,"class","modal-inner svelte-1uakzh2"),v(r,"class","modal-content svelte-1uakzh2"),v(f,"class","modal-close is-large"),v(f,"aria-label","close"),v(e,"id","region-modal-wrapper"),v(e,"class","modal is-active")},m(k,T){z(k,e,T),y(e,n),y(e,i),y(e,r),y(r,s),y(s,o),y(o,l);for(let M=0;M<_.length;M+=1)_[M]&&_[M].m(l,null);y(s,a),y(s,c),u&&de(u,c,null),y(e,d),y(e,f),h=!0,m||(p=[Se(n,"click",t[6]),Se(n,"keyup",t[5]),Se(f,"click",t[6])],m=!0)},p(k,[T]){if(T&28){g=k[3];let C;for(C=0;C<g.length;C+=1){const x=Ka(k,g,C);_[C]?_[C].p(x,T):(_[C]=Wa(x),_[C].c(),_[C].m(l,null))}for(;C<_.length;C+=1)_[C].d(1);_.length=g.length}const M=T&6?ru(S,[su(k[1][k[2]]||{})]):{};if(T&5&&E!==(E=k[0][k[2]]||null)){if(u){ze();const C=u;K(C.$$.fragment,1,0,()=>{he(C,1)}),je()}E?(u=ki(E,w()),me(u.$$.fragment),U(u.$$.fragment,1),de(u,c,null)):u=null}else E&&u.$set(M);(!h||T&4)&&Pe(c,"pb-4",k[2]==="main")},i(k){h||(u&&U(u.$$.fragment,k),h=!0)},o(k){u&&K(u.$$.fragment,k),h=!1},d(k){k&&D(e),at(_,k),u&&he(u),m=!1,ot(p)}}}function t1(t,e,n){let i,{mainImgItem:r}=e,{compareImgItem:s}=e;const o=Ii(),l=s?["main","page","similarity","expansion"]:["main","page"],a={expansion:{fr:"Expansion de requête",en:"Query expansion"},similarity:{fr:"Comparaison",en:"Comparison"},page:{fr:"Vue de la page",en:"Page view"},main:{fr:"Vue principale",en:"Main view"}},c=l.map(g=>{var _;return{id:g,label:((_=a[g])==null?void 0:_[W])??"Main view"}}),u={main:qa,page:Z0};s&&Promise.all([ss(()=>Promise.resolve().then(()=>ty),void 0).then(g=>g.default),ss(()=>Promise.resolve().then(()=>xy),void 0).then(g=>g.default)]).then(([g,_])=>{const S=Object.keys(u);l.filter(E=>!S.includes(E)).map(E=>n(0,u[E]=E==="expansion"?_:E==="similarity"?g:qa,u))});const d={};l.map(g=>n(1,d[g]=g==="similarity"?{compareImgItem:s,mainImgItem:r}:{mainImgItem:r},d));const f=g=>n(2,i=g),h=g=>{g.key==="Escape"&&o("closeModal")},m=()=>o("closeModal");Nn(()=>{document.addEventListener("keyup",h)}),On(()=>{document.removeEventListener("keydown",h)});const p=g=>f(g);return t.$$set=g=>{"mainImgItem"in g&&n(7,r=g.mainImgItem),"compareImgItem"in g&&n(8,s=g.compareImgItem)},n(2,i=l[0]),[u,d,i,c,f,h,m,r,s,p]}class n1 extends Ae{constructor(e){super(),xe(this,e,t1,e1,Me,{mainImgItem:7,compareImgItem:8})}}const lb="";function i1(t){let e,n,i,r,s,o,l,a,c,u,d;return n=new Pi({props:{targetHtmlId:t[0],tooltipText:t[1]}}),{c(){e=b("div"),me(n.$$.fragment),i=F(),r=b("button"),s=jt("svg"),o=jt("path"),l=jt("path"),a=jt("path"),v(o,"d","M53.6443 14.25C47.7042 5.33 37.7293 0 26.9801 0C16.2206 0 6.24576 5.33 0.305653 14.25L0 14.71L0.305653 15.17C6.24576 24.09 16.2206 29.42 26.9801 29.42C37.7293 29.42 47.7042 24.09 53.6443 15.16L53.95 14.71L53.6443 14.25ZM3.25025 14.71C7.63146 8.69001 14.0606 4.65 21.2641 3.22C20.0619 3.83 18.9411 4.62 17.963 5.59C15.5176 8.02 14.1625 11.25 14.1625 14.67C14.1625 18.11 15.5176 21.34 17.963 23.76C19.0124 24.79 20.1943 25.61 21.4781 26.23C14.1829 24.85 7.6824 20.78 3.25025 14.71ZM27.1125 22.64C22.7008 22.64 19.1041 19.08 19.1041 14.7C19.1041 12.59 19.9396 10.6 21.4475 9.10001C22.9555 7.60001 24.9729 6.77 27.1125 6.77C29.2522 6.77 31.2594 7.60001 32.7775 9.10001C34.2855 10.6 35.121 12.59 35.121 14.7C35.121 16.82 34.2855 18.82 32.7775 20.32C31.2594 21.81 29.242 22.64 27.1125 22.64ZM32.9915 26.14C34.204 25.53 35.3146 24.74 36.3029 23.77C38.7482 21.34 40.0932 18.11 40.0932 14.68C40.0932 9.75 37.281 5.47001 33.1647 3.32001C40.1747 4.81001 46.4102 8.83001 50.6896 14.71C46.3797 20.64 40.0728 24.67 32.9915 26.14Z"),v(o,"fill","black"),v(o,"class","svelte-19wutme"),v(l,"d","M26.9804 25.98C33.3222 25.98 38.4633 20.9343 38.4633 14.71C38.4633 8.48576 33.3222 3.44 26.9804 3.44C20.6386 3.44 15.4976 8.48576 15.4976 14.71C15.4976 20.9343 20.6386 25.98 26.9804 25.98Z"),v(l,"fill","black"),v(l,"class","svelte-19wutme"),v(a,"d","M17.9529 23.85L36.2928 5.85001"),v(a,"stroke","black"),v(a,"stroke-width","3"),v(a,"stroke-miterlimit","10"),v(a,"class","svelte-19wutme"),v(s,"width","54"),v(s,"height","30"),v(s,"viewBox","0 0 54 30"),v(s,"fill","none"),v(s,"xmlns","http://www.w3.org/2000/svg"),v(s,"class","svelte-19wutme"),v(r,"class","button tag svelte-19wutme"),v(r,"title",t[1]),v(e,"id",t[0])},m(f,h){z(f,e,h),de(n,e,null),y(e,i),y(e,r),y(r,s),y(s,o),y(s,l),y(s,a),c=!0,u||(d=Se(r,"click",t[2]),u=!0)},p:ee,i(f){c||(U(n.$$.fragment,f),c=!0)},o(f){K(n.$$.fragment,f),c=!1},d(f){f&&D(e),he(n),u=!1,d()}}}function r1(t,e,n){let i,r,{mainImgItem:s}=e,{compareImgItem:o=void 0}=e;Pn("isInModal",!0);const l=`modal-opener-${window.crypto.randomUUID()}`,a=W==="fr"?"Vue détaillée":"Detailed view",c=(f,h)=>(f?(h=new n1({target:document.querySelector("body"),props:{mainImgItem:s,compareImgItem:o}}),h.$on("closeModal",d)):!f&&r!=null&&h.$destroy(),h),u=()=>n(5,i=!i),d=()=>n(5,i=!1);return t.$$set=f=>{"mainImgItem"in f&&n(3,s=f.mainImgItem),"compareImgItem"in f&&n(4,o=f.compareImgItem)},t.$$.update=()=>{t.$$.dirty&96&&n(6,r=c(i,r))},n(5,i=!1),[l,a,u,s,o,i,r]}class s1 extends Ae{constructor(e){super(),xe(this,e,r1,i1,Me,{mainImgItem:3,compareImgItem:4})}}const o1=Object.freeze(Object.defineProperty({__proto__:null,default:s1},Symbol.toStringTag,{value:"Module"})),ab="";function l1(t){let e,n,i,r,s,o,l;return{c(){e=b("button"),n=b("span"),n.innerHTML='<span class="switch-control svelte-g5g8im"><span class="switch-spot"></span></span>',i=F(),r=b("span"),s=re(t[0]),v(n,"class","switch mr-2 svelte-g5g8im"),v(r,"class","label svelte-g5g8im"),v(e,"id",t[3]),v(e,"name",t[3]),v(e,"class","input-checkbox-wrapper is-flex is-align-items-center-is-justify-content-center p-2 pl-3 pr-3 svelte-g5g8im"),v(e,"aria-label",t[0]),Pe(e,"is-checked",t[2]),Pe(e,"is-clickable",t[1]),Pe(e,"button",t[1])},m(a,c){z(a,e,c),y(e,n),y(e,i),y(e,r),y(r,s),o||(l=Se(e,"click",en(t[4])),o=!0)},p(a,[c]){c&1&&Ee(s,a[0]),c&1&&v(e,"aria-label",a[0]),c&4&&Pe(e,"is-checked",a[2]),c&2&&Pe(e,"is-clickable",a[1]),c&2&&Pe(e,"button",a[1])},i:ee,o:ee,d(a){a&&D(e),o=!1,l()}}}function a1(t,e,n){let i,{toggleLabel:r}=e,{start:s=!1}=e,{buttonDisplay:o=!1}=e;const l=`input-toggle-${window.crypto.randomUUID()}`,a=Ii(),c=Nt("resetTrigger")||void 0;c==null||c.subscribe(d);const u=()=>n(2,i=!i);function d(){n(2,i=s)}return t.$$set=f=>{"toggleLabel"in f&&n(0,r=f.toggleLabel),"start"in f&&n(5,s=f.start),"buttonDisplay"in f&&n(1,o=f.buttonDisplay)},t.$$.update=()=>{t.$$.dirty&32&&n(2,i=s),t.$$.dirty&4&&a("updateChecked",i)},[r,o,i,l,u,s]}class c1 extends Ae{constructor(e){super(),xe(this,e,a1,l1,Me,{toggleLabel:0,start:5,buttonDisplay:1})}}/*! choices.js v11.1.0 | © 2025 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var as=function(t,e){return as=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},as(t,e)};function Ya(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");as(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var xt=function(){return xt=Object.assign||function(e){for(var n,i=1,r=arguments.length;i<r;i++){n=arguments[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},xt.apply(this,arguments)};function u1(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var et={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},At={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},pt={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},f1=["fuseOptions","classNames"],gn={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},Ga=function(t){return{type:et.ADD_CHOICE,choice:t}},d1=function(t){return{type:et.REMOVE_CHOICE,choice:t}},h1=function(t){return{type:et.FILTER_CHOICES,results:t}},m1=function(t){return{type:et.ACTIVATE_CHOICES,active:t}},p1=function(t){return{type:et.ADD_GROUP,group:t}},Xa=function(t){return{type:et.ADD_ITEM,item:t}},Ja=function(t){return{type:et.REMOVE_ITEM,item:t}},lr=function(t,e){return{type:et.HIGHLIGHT_ITEM,item:t,highlighted:e}},g1=function(t,e){return Math.floor(Math.random()*(e-t)+t)},Qa=function(t){return Array.from({length:t},function(){return g1(0,36).toString(36)}).join("")},_1=function(t,e){var n=t.id||t.name&&"".concat(t.name,"-").concat(Qa(2))||Qa(4);return n=n.replace(/(:|\.|\[|\]|,)/g,""),n="".concat(e,"-").concat(n),n},v1=function(t,e,n){n===void 0&&(n=1);for(var i="".concat(n>0?"next":"previous","ElementSibling"),r=t[i];r;){if(r.matches(e))return r;r=r[i]}return null},y1=function(t,e,n){n===void 0&&(n=1);var i;return n>0?i=e.scrollTop+e.offsetHeight>=t.offsetTop+t.offsetHeight:i=t.offsetTop>=e.scrollTop,i},ar=function(t){if(typeof t!="string"){if(t==null)return"";if(typeof t=="object"){if("raw"in t)return ar(t.raw);if("trusted"in t)return t.trusted}return t}return t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},b1=function(){var t=document.createElement("div");return function(e){t.innerHTML=e.trim();for(var n=t.children[0];t.firstChild;)t.removeChild(t.firstChild);return n}}(),pi=function(t,e){return typeof t=="function"?t(ar(e),e):t},Za=function(t){return typeof t=="function"?t():t},En=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("trusted"in t)return t.trusted;if("raw"in t)return t.raw}return""},ec=function(t){if(typeof t=="string")return t;if(typeof t=="object"){if("escaped"in t)return t.escaped;if("trusted"in t)return t.trusted}return""},cs=function(t,e){return t?ec(e):ar(e)},ln=function(t,e,n){t.innerHTML=cs(e,n)},w1=function(t,e){var n=t.value,i=t.label,r=i===void 0?n:i,s=e.value,o=e.label,l=o===void 0?s:o;return En(r).localeCompare(En(l),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},S1=function(t,e){return t.rank-e.rank},k1=function(t,e,n){n===void 0&&(n=null);var i=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0});return t.dispatchEvent(i)},E1=function(t,e){var n=Object.keys(t).sort(),i=Object.keys(e).sort();return n.filter(function(r){return i.indexOf(r)<0})},cr=function(t){return Array.isArray(t)?t:[t]},gi=function(t){return t&&Array.isArray(t)?t.map(function(e){return".".concat(e)}).join(""):".".concat(t)},Ce=function(t,e){var n;(n=t.classList).add.apply(n,cr(e))},Xt=function(t,e){var n;(n=t.classList).remove.apply(n,cr(e))},C1=function(t){if(typeof t<"u")try{return JSON.parse(t)}catch{return t}return{}},I1=function(t,e,n){var i=t.itemEl;i&&(Xt(i,n),Ce(i,e))},M1=function(){function t(e){var n=e.element,i=e.type,r=e.classNames;this.element=n,this.classNames=r,this.type=i,this.isActive=!1}return t.prototype.show=function(){return Ce(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},t.prototype.hide=function(){return Xt(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},t}(),tc=function(){function t(e){var n=e.element,i=e.type,r=e.classNames,s=e.position;this.element=n,this.classNames=r,this.type=i,this.position=s,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return t.prototype.shouldFlip=function(e,n){var i=!1;return this.position==="auto"?i=this.element.getBoundingClientRect().top-n>=0&&!window.matchMedia("(min-height: ".concat(e+1,"px)")).matches:this.position==="top"&&(i=!0),i},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype.open=function(e,n){Ce(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(e,n)&&(Ce(this.element,this.classNames.flippedState),this.isFlipped=!0)},t.prototype.close=function(){Xt(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(Xt(this.element,this.classNames.flippedState),this.isFlipped=!1)},t.prototype.addFocusState=function(){Ce(this.element,this.classNames.focusState)},t.prototype.removeFocusState=function(){Xt(this.element,this.classNames.focusState)},t.prototype.enable=function(){Xt(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===gn.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},t.prototype.disable=function(){Ce(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===gn.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},t.prototype.wrap=function(e){var n=this.element,i=e.parentNode;i&&(e.nextSibling?i.insertBefore(n,e.nextSibling):i.appendChild(n)),n.appendChild(e)},t.prototype.unwrap=function(e){var n=this.element,i=n.parentNode;i&&(i.insertBefore(e,n),i.removeChild(n))},t.prototype.addLoadingState=function(){Ce(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},t.prototype.removeLoadingState=function(){Xt(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},t}(),x1=function(){function t(e){var n=e.element,i=e.type,r=e.classNames,s=e.preventPaste;this.element=n,this.type=i,this.classNames=r,this.preventPaste=s,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=n.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(t.prototype,"placeholder",{set:function(e){this.element.placeholder=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.addEventListeners=function(){var e=this.element;e.addEventListener("paste",this._onPaste),e.addEventListener("input",this._onInput,{passive:!0}),e.addEventListener("focus",this._onFocus,{passive:!0}),e.addEventListener("blur",this._onBlur,{passive:!0})},t.prototype.removeEventListeners=function(){var e=this.element;e.removeEventListener("input",this._onInput),e.removeEventListener("paste",this._onPaste),e.removeEventListener("focus",this._onFocus),e.removeEventListener("blur",this._onBlur)},t.prototype.enable=function(){var e=this.element;e.removeAttribute("disabled"),this.isDisabled=!1},t.prototype.disable=function(){var e=this.element;e.setAttribute("disabled",""),this.isDisabled=!0},t.prototype.focus=function(){this.isFocussed||this.element.focus()},t.prototype.blur=function(){this.isFocussed&&this.element.blur()},t.prototype.clear=function(e){return e===void 0&&(e=!0),this.element.value="",e&&this.setWidth(),this},t.prototype.setWidth=function(){var e=this.element;e.style.minWidth="".concat(e.placeholder.length+1,"ch"),e.style.width="".concat(e.value.length+1,"ch")},t.prototype.setActiveDescendant=function(e){this.element.setAttribute("aria-activedescendant",e)},t.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},t.prototype._onInput=function(){this.type!==gn.SelectOne&&this.setWidth()},t.prototype._onPaste=function(e){this.preventPaste&&e.preventDefault()},t.prototype._onFocus=function(){this.isFocussed=!0},t.prototype._onBlur=function(){this.isFocussed=!1},t}(),A1=4,nc=function(){function t(e){var n=e.element;this.element=n,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return t.prototype.prepend=function(e){var n=this.element.firstElementChild;n?this.element.insertBefore(e,n):this.element.append(e)},t.prototype.scrollToTop=function(){this.element.scrollTop=0},t.prototype.scrollToChildElement=function(e,n){var i=this;if(e){var r=this.element.offsetHeight,s=this.element.scrollTop+r,o=e.offsetHeight,l=e.offsetTop+o,a=n>0?this.element.scrollTop+l-s:e.offsetTop;requestAnimationFrame(function(){i._animateScroll(a,n)})}},t.prototype._scrollDown=function(e,n,i){var r=(i-e)/n,s=r>1?r:1;this.element.scrollTop=e+s},t.prototype._scrollUp=function(e,n,i){var r=(e-i)/n,s=r>1?r:1;this.element.scrollTop=e-s},t.prototype._animateScroll=function(e,n){var i=this,r=A1,s=this.element.scrollTop,o=!1;n>0?(this._scrollDown(s,r,e),s<e&&(o=!0)):(this._scrollUp(s,r,e),s>e&&(o=!0)),o&&requestAnimationFrame(function(){i._animateScroll(e,n)})},t}(),ic=function(){function t(e){var n=e.element,i=e.classNames;this.element=n,this.classNames=i,this.isDisabled=!1}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.element.value},set:function(e){this.element.setAttribute("value",e),this.element.value=e},enumerable:!1,configurable:!0}),t.prototype.conceal=function(){var e=this.element;Ce(e,this.classNames.input),e.hidden=!0,e.tabIndex=-1;var n=e.getAttribute("style");n&&e.setAttribute("data-choice-orig-style",n),e.setAttribute("data-choice","active")},t.prototype.reveal=function(){var e=this.element;Xt(e,this.classNames.input),e.hidden=!1,e.removeAttribute("tabindex");var n=e.getAttribute("data-choice-orig-style");n?(e.removeAttribute("data-choice-orig-style"),e.setAttribute("style",n)):e.removeAttribute("style"),e.removeAttribute("data-choice")},t.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},t.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},t.prototype.triggerEvent=function(e,n){k1(this.element,e,n||{})},t}(),T1=function(t){Ya(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(ic),_i=function(t,e){return e===void 0&&(e=!0),typeof t>"u"?e:!!t},rc=function(t){if(typeof t=="string"&&(t=t.split(" ").filter(function(e){return e.length})),Array.isArray(t)&&t.length)return t},Jt=function(t,e,n){if(n===void 0&&(n=!0),typeof t=="string"){var i=ar(t),r=n||i===t?t:{escaped:i,raw:t},s=Jt({value:t,label:r,selected:!0},!1);return s}var o=t;if("choices"in o){if(!e)throw new TypeError("optGroup is not allowed");var l=o,a=l.choices.map(function(f){return Jt(f,!1)}),c={id:0,label:En(l.label)||l.value,active:!!a.length,disabled:!!l.disabled,choices:a};return c}var u=o,d={id:0,group:null,score:0,rank:0,value:u.value,label:u.label||u.value,active:_i(u.active),selected:_i(u.selected,!1),disabled:_i(u.disabled,!1),placeholder:_i(u.placeholder,!1),highlighted:!1,labelClass:rc(u.labelClass),labelDescription:u.labelDescription,customProperties:u.customProperties};return d},N1=function(t){return t.tagName==="INPUT"},sc=function(t){return t.tagName==="SELECT"},O1=function(t){return t.tagName==="OPTION"},P1=function(t){return t.tagName==="OPTGROUP"},L1=function(t){Ya(e,t);function e(n){var i=n.element,r=n.classNames,s=n.template,o=n.extractPlaceholder,l=t.call(this,{element:i,classNames:r})||this;return l.template=s,l.extractPlaceholder=o,l}return Object.defineProperty(e.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),e.prototype.addOptions=function(n){var i=this,r=document.createDocumentFragment();n.forEach(function(s){var o=s;if(!o.element){var l=i.template(o);r.appendChild(l),o.element=l}}),this.element.appendChild(r)},e.prototype.optionsAsChoices=function(){var n=this,i=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(r){O1(r)?i.push(n._optionToChoice(r)):P1(r)&&i.push(n._optgroupToChoice(r))}),i},e.prototype._optionToChoice=function(n){return!n.hasAttribute("value")&&n.hasAttribute("placeholder")&&(n.setAttribute("value",""),n.value=""),{id:0,group:null,score:0,rank:0,value:n.value,label:n.label,element:n,active:!0,selected:this.extractPlaceholder?n.selected:n.hasAttribute("selected"),disabled:n.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!n.value||n.hasAttribute("placeholder")),labelClass:typeof n.dataset.labelClass<"u"?rc(n.dataset.labelClass):void 0,labelDescription:typeof n.dataset.labelDescription<"u"?n.dataset.labelDescription:void 0,customProperties:C1(n.dataset.customProperties)}},e.prototype._optgroupToChoice=function(n){var i=this,r=n.querySelectorAll("option"),s=Array.from(r).map(function(o){return i._optionToChoice(o)});return{id:0,label:n.label||"",element:n,active:!!s.length,disabled:n.disabled,choices:s}},e}(ic),R1={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},oc={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(t){return!!t&&t!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:w1,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(t){return'Press Enter to add <b>"'.concat(t,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(t){return"Remove item: ".concat(t)},maxItemText:function(t){return"Only ".concat(t," values can be added")},valueComparer:function(t,e){return t===e},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:R1,appendGroupInSearch:!1},lc=function(t){var e=t.itemEl;e&&(e.remove(),t.itemEl=void 0)};function D1(t,e,n){var i=t,r=!0;switch(e.type){case et.ADD_ITEM:{e.item.selected=!0;var s=e.item.element;s&&(s.selected=!0,s.setAttribute("selected","")),i.push(e.item);break}case et.REMOVE_ITEM:{e.item.selected=!1;var s=e.item.element;if(s){s.selected=!1,s.removeAttribute("selected");var o=s.parentElement;o&&sc(o)&&o.type===gn.SelectOne&&(o.value="")}lc(e.item),i=i.filter(function(u){return u.id!==e.item.id});break}case et.REMOVE_CHOICE:{lc(e.choice),i=i.filter(function(c){return c.id!==e.choice.id});break}case et.HIGHLIGHT_ITEM:{var l=e.highlighted,a=i.find(function(c){return c.id===e.item.id});a&&a.highlighted!==l&&(a.highlighted=l,n&&I1(a,l?n.classNames.highlightedState:n.classNames.selectedState,l?n.classNames.selectedState:n.classNames.highlightedState));break}default:{r=!1;break}}return{state:i,update:r}}function $1(t,e){var n=t,i=!0;switch(e.type){case et.ADD_GROUP:{n.push(e.group);break}case et.CLEAR_CHOICES:{n=[];break}default:{i=!1;break}}return{state:n,update:i}}function z1(t,e,n){var i=t,r=!0;switch(e.type){case et.ADD_CHOICE:{i.push(e.choice);break}case et.REMOVE_CHOICE:{e.choice.choiceEl=void 0,e.choice.group&&(e.choice.group.choices=e.choice.group.choices.filter(function(o){return o.id!==e.choice.id})),i=i.filter(function(o){return o.id!==e.choice.id});break}case et.ADD_ITEM:case et.REMOVE_ITEM:{e.item.choiceEl=void 0;break}case et.FILTER_CHOICES:{var s=[];e.results.forEach(function(o){s[o.item.id]=o}),i.forEach(function(o){var l=s[o.id];l!==void 0?(o.score=l.score,o.rank=l.rank,o.active=!0):(o.score=0,o.rank=0,o.active=!1),n&&n.appendGroupInSearch&&(o.choiceEl=void 0)});break}case et.ACTIVATE_CHOICES:{i.forEach(function(o){o.active=e.active,n&&n.appendGroupInSearch&&(o.choiceEl=void 0)});break}case et.CLEAR_CHOICES:{i=[];break}default:{r=!1;break}}return{state:i,update:r}}var ac={groups:$1,items:D1,choices:z1},j1=function(){function t(e){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=e}return Object.defineProperty(t.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),t.prototype.changeSet=function(e){return{groups:e,items:e,choices:e}},t.prototype.reset=function(){this._state=this.defaultState;var e=this.changeSet(!0);this._txn?this._changeSet=e:this._listeners.forEach(function(n){return n(e)})},t.prototype.subscribe=function(e){return this._listeners.push(e),this},t.prototype.dispatch=function(e){var n=this,i=this._state,r=!1,s=this._changeSet||this.changeSet(!1);Object.keys(ac).forEach(function(o){var l=ac[o](i[o],e,n._context);l.update&&(r=!0,s[o]=!0,i[o]=l.state)}),r&&(this._txn?this._changeSet=s:this._listeners.forEach(function(o){return o(s)}))},t.prototype.withTxn=function(e){this._txn++;try{e()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var n=this._changeSet;n&&(this._changeSet=void 0,this._listeners.forEach(function(i){return i(n)}))}}},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(e){return e.active&&e.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeChoices",{get:function(){return this.choices.filter(function(e){return e.active})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(e){return!e.disabled&&!e.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeGroups",{get:function(){var e=this;return this.state.groups.filter(function(n){var i=n.active&&!n.disabled,r=e.state.choices.some(function(s){return s.active&&!s.disabled});return i&&r},[])},enumerable:!1,configurable:!0}),t.prototype.inTxn=function(){return this._txn>0},t.prototype.getChoiceById=function(e){return this.activeChoices.find(function(n){return n.id===e})},t.prototype.getGroupById=function(e){return this.groups.find(function(n){return n.id===e})},t}(),ut={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function F1(t,e,n){return(e=H1(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Yn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cc(Object(n),!0).forEach(function(i){F1(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function V1(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H1(t){var e=V1(t,"string");return typeof e=="symbol"?e:e+""}function an(t){return Array.isArray?Array.isArray(t):dc(t)==="[object Array]"}const U1=1/0;function B1(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-U1?"-0":e}function q1(t){return t==null?"":B1(t)}function Qt(t){return typeof t=="string"}function uc(t){return typeof t=="number"}function K1(t){return t===!0||t===!1||W1(t)&&dc(t)=="[object Boolean]"}function fc(t){return typeof t=="object"}function W1(t){return fc(t)&&t!==null}function Pt(t){return t!=null}function us(t){return!t.trim().length}function dc(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const cb="Extended search is not available",Y1="Incorrect 'index' type",G1=t=>`Invalid value for key ${t}`,X1=t=>`Pattern length exceeds max of ${t}.`,J1=t=>`Missing ${t} property in key`,Q1=t=>`Property 'weight' in key '${t}' must be a positive integer`,hc=Object.prototype.hasOwnProperty;class Z1{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(i=>{let r=mc(i);this._keys.push(r),this._keyMap[r.id]=r,n+=r.weight}),this._keys.forEach(i=>{i.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function mc(t){let e=null,n=null,i=null,r=1,s=null;if(Qt(t)||an(t))i=t,e=pc(t),n=fs(t);else{if(!hc.call(t,"name"))throw new Error(J1("name"));const o=t.name;if(i=o,hc.call(t,"weight")&&(r=t.weight,r<=0))throw new Error(Q1(o));e=pc(o),n=fs(o),s=t.getFn}return{path:e,id:n,weight:r,src:i,getFn:s}}function pc(t){return an(t)?t:t.split(".")}function fs(t){return an(t)?t.join("."):t}function ev(t,e){let n=[],i=!1;const r=(s,o,l)=>{if(Pt(s))if(!o[l])n.push(s);else{let a=o[l];const c=s[a];if(!Pt(c))return;if(l===o.length-1&&(Qt(c)||uc(c)||K1(c)))n.push(q1(c));else if(an(c)){i=!0;for(let u=0,d=c.length;u<d;u+=1)r(c[u],o,l+1)}else o.length&&r(c,o,l+1)}};return r(t,Qt(e)?e.split("."):e,0),i?n:n[0]}const tv={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},nv={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},iv={location:0,threshold:.6,distance:100},rv={useExtendedSearch:!1,getFn:ev,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var be=Yn(Yn(Yn(Yn({},nv),tv),iv),rv);const sv=/[^ ]+/g;function ov(t=1,e=3){const n=new Map,i=Math.pow(10,e);return{get(r){const s=r.match(sv).length;if(n.has(s))return n.get(s);const o=1/Math.pow(s,.5*t),l=parseFloat(Math.round(o*i)/i);return n.set(s,l),l},clear(){n.clear()}}}class ds{constructor({getFn:e=be.getFn,fieldNormWeight:n=be.fieldNormWeight}={}){this.norm=ov(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,i)=>{this._keysMap[n.id]=i})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Qt(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){const n=this.size();Qt(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,i=this.size();n<i;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!Pt(e)||us(e))return;let i={v:e,i:n,n:this.norm.get(e)};this.records.push(i)}_addObject(e,n){let i={i:n,$:{}};this.keys.forEach((r,s)=>{let o=r.getFn?r.getFn(e):this.getFn(e,r.path);if(Pt(o)){if(an(o)){let l=[];const a=[{nestedArrIndex:-1,value:o}];for(;a.length;){const{nestedArrIndex:c,value:u}=a.pop();if(Pt(u))if(Qt(u)&&!us(u)){let d={v:u,i:c,n:this.norm.get(u)};l.push(d)}else an(u)&&u.forEach((d,f)=>{a.push({nestedArrIndex:f,value:d})})}i.$[s]=l}else if(Qt(o)&&!us(o)){let l={v:o,n:this.norm.get(o)};i.$[s]=l}}}),this.records.push(i)}toJSON(){return{keys:this.keys,records:this.records}}}function gc(t,e,{getFn:n=be.getFn,fieldNormWeight:i=be.fieldNormWeight}={}){const r=new ds({getFn:n,fieldNormWeight:i});return r.setKeys(t.map(mc)),r.setSources(e),r.create(),r}function lv(t,{getFn:e=be.getFn,fieldNormWeight:n=be.fieldNormWeight}={}){const{keys:i,records:r}=t,s=new ds({getFn:e,fieldNormWeight:n});return s.setKeys(i),s.setIndexRecords(r),s}function ur(t,{errors:e=0,currentLocation:n=0,expectedLocation:i=0,distance:r=be.distance,ignoreLocation:s=be.ignoreLocation}={}){const o=e/t.length;if(s)return o;const l=Math.abs(i-n);return r?o+l/r:l?1:o}function av(t=[],e=be.minMatchCharLength){let n=[],i=-1,r=-1,s=0;for(let o=t.length;s<o;s+=1){let l=t[s];l&&i===-1?i=s:!l&&i!==-1&&(r=s-1,r-i+1>=e&&n.push([i,r]),i=-1)}return t[s-1]&&s-i>=e&&n.push([i,s-1]),n}const Cn=32;function cv(t,e,n,{location:i=be.location,distance:r=be.distance,threshold:s=be.threshold,findAllMatches:o=be.findAllMatches,minMatchCharLength:l=be.minMatchCharLength,includeMatches:a=be.includeMatches,ignoreLocation:c=be.ignoreLocation}={}){if(e.length>Cn)throw new Error(X1(Cn));const u=e.length,d=t.length,f=Math.max(0,Math.min(i,d));let h=s,m=f;const p=l>1||a,g=p?Array(d):[];let _;for(;(_=t.indexOf(e,m))>-1;){let M=ur(e,{currentLocation:_,expectedLocation:f,distance:r,ignoreLocation:c});if(h=Math.min(M,h),m=_+u,p){let C=0;for(;C<u;)g[_+C]=1,C+=1}}m=-1;let S=[],E=1,w=u+d;const k=1<<u-1;for(let M=0;M<u;M+=1){let C=0,x=w;for(;C<x;)ur(e,{errors:M,currentLocation:f+x,expectedLocation:f,distance:r,ignoreLocation:c})<=h?C=x:w=x,x=Math.floor((w-C)/2+C);w=x;let P=Math.max(1,f-x+1),L=o?d:Math.min(f+x,d)+u,H=Array(L+2);H[L+1]=(1<<M)-1;for(let I=L;I>=P;I-=1){let R=I-1,O=n[t.charAt(R)];if(p&&(g[R]=+!!O),H[I]=(H[I+1]<<1|1)&O,M&&(H[I]|=(S[I+1]|S[I])<<1|1|S[I+1]),H[I]&k&&(E=ur(e,{errors:M,currentLocation:R,expectedLocation:f,distance:r,ignoreLocation:c}),E<=h)){if(h=E,m=R,m<=f)break;P=Math.max(1,2*f-m)}}if(ur(e,{errors:M+1,currentLocation:f,expectedLocation:f,distance:r,ignoreLocation:c})>h)break;S=H}const T={isMatch:m>=0,score:Math.max(.001,E)};if(p){const M=av(g,l);M.length?a&&(T.indices=M):T.isMatch=!1}return T}function uv(t){let e={};for(let n=0,i=t.length;n<i;n+=1){const r=t.charAt(n);e[r]=(e[r]||0)|1<<i-n-1}return e}class _c{constructor(e,{location:n=be.location,threshold:i=be.threshold,distance:r=be.distance,includeMatches:s=be.includeMatches,findAllMatches:o=be.findAllMatches,minMatchCharLength:l=be.minMatchCharLength,isCaseSensitive:a=be.isCaseSensitive,ignoreLocation:c=be.ignoreLocation}={}){if(this.options={location:n,threshold:i,distance:r,includeMatches:s,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:a,ignoreLocation:c},this.pattern=a?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(f,h)=>{this.chunks.push({pattern:f,alphabet:uv(f),startIndex:h})},d=this.pattern.length;if(d>Cn){let f=0;const h=d%Cn,m=d-h;for(;f<m;)u(this.pattern.substr(f,Cn),f),f+=Cn;if(h){const p=d-Cn;u(this.pattern.substr(p),p)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:n,includeMatches:i}=this.options;if(n||(e=e.toLowerCase()),this.pattern===e){let m={isMatch:!0,score:0};return i&&(m.indices=[[0,e.length-1]]),m}const{location:r,distance:s,threshold:o,findAllMatches:l,minMatchCharLength:a,ignoreLocation:c}=this.options;let u=[],d=0,f=!1;this.chunks.forEach(({pattern:m,alphabet:p,startIndex:g})=>{const{isMatch:_,score:S,indices:E}=cv(e,m,p,{location:r+g,distance:s,threshold:o,findAllMatches:l,minMatchCharLength:a,includeMatches:i,ignoreLocation:c});_&&(f=!0),d+=S,_&&E&&(u=[...u,...E])});let h={isMatch:f,score:f?d/this.chunks.length:1};return f&&i&&(h.indices=u),h}}class _n{constructor(e){this.pattern=e}static isMultiMatch(e){return vc(e,this.multiRegex)}static isSingleMatch(e){return vc(e,this.singleRegex)}search(){}}function vc(t,e){const n=t.match(e);return n?n[1]:null}class fv extends _n{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class dv extends _n{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const i=e.indexOf(this.pattern)===-1;return{isMatch:i,score:i?0:1,indices:[0,e.length-1]}}}class hv extends _n{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class mv extends _n{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class pv extends _n{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class gv extends _n{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class yc extends _n{constructor(e,{location:n=be.location,threshold:i=be.threshold,distance:r=be.distance,includeMatches:s=be.includeMatches,findAllMatches:o=be.findAllMatches,minMatchCharLength:l=be.minMatchCharLength,isCaseSensitive:a=be.isCaseSensitive,ignoreLocation:c=be.ignoreLocation}={}){super(e),this._bitapSearch=new _c(e,{location:n,threshold:i,distance:r,includeMatches:s,findAllMatches:o,minMatchCharLength:l,isCaseSensitive:a,ignoreLocation:c})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class bc extends _n{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,i;const r=[],s=this.pattern.length;for(;(i=e.indexOf(this.pattern,n))>-1;)n=i+s,r.push([i,n-1]);const o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}const hs=[fv,bc,hv,mv,gv,pv,dv,yc],wc=hs.length,_v=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,vv="|";function yv(t,e={}){return t.split(vv).map(n=>{let i=n.trim().split(_v).filter(s=>s&&!!s.trim()),r=[];for(let s=0,o=i.length;s<o;s+=1){const l=i[s];let a=!1,c=-1;for(;!a&&++c<wc;){const u=hs[c];let d=u.isMultiMatch(l);d&&(r.push(new u(d,e)),a=!0)}if(!a)for(c=-1;++c<wc;){const u=hs[c];let d=u.isSingleMatch(l);if(d){r.push(new u(d,e));break}}}return r})}const bv=new Set([yc.type,bc.type]);class wv{constructor(e,{isCaseSensitive:n=be.isCaseSensitive,includeMatches:i=be.includeMatches,minMatchCharLength:r=be.minMatchCharLength,ignoreLocation:s=be.ignoreLocation,findAllMatches:o=be.findAllMatches,location:l=be.location,threshold:a=be.threshold,distance:c=be.distance}={}){this.query=null,this.options={isCaseSensitive:n,includeMatches:i,minMatchCharLength:r,findAllMatches:o,ignoreLocation:s,location:l,threshold:a,distance:c},this.pattern=n?e:e.toLowerCase(),this.query=yv(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:i,isCaseSensitive:r}=this.options;e=r?e:e.toLowerCase();let s=0,o=[],l=0;for(let a=0,c=n.length;a<c;a+=1){const u=n[a];o.length=0,s=0;for(let d=0,f=u.length;d<f;d+=1){const h=u[d],{isMatch:m,indices:p,score:g}=h.search(e);if(m){if(s+=1,l+=g,i){const _=h.constructor.type;bv.has(_)?o=[...o,...p]:o.push(p)}}else{l=0,s=0,o.length=0;break}}if(s){let d={isMatch:!0,score:l/s};return i&&(d.indices=o),d}}return{isMatch:!1,score:1}}}const ms=[];function Sv(...t){ms.push(...t)}function ps(t,e){for(let n=0,i=ms.length;n<i;n+=1){let r=ms[n];if(r.condition(t,e))return new r(t,e)}return new _c(t,e)}const fr={AND:"$and",OR:"$or"},gs={PATH:"$path",PATTERN:"$val"},_s=t=>!!(t[fr.AND]||t[fr.OR]),kv=t=>!!t[gs.PATH],Ev=t=>!an(t)&&fc(t)&&!_s(t),Sc=t=>({[fr.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function kc(t,e,{auto:n=!0}={}){const i=r=>{let s=Object.keys(r);const o=kv(r);if(!o&&s.length>1&&!_s(r))return i(Sc(r));if(Ev(r)){const a=o?r[gs.PATH]:s[0],c=o?r[gs.PATTERN]:r[a];if(!Qt(c))throw new Error(G1(a));const u={keyId:fs(a),pattern:c};return n&&(u.searcher=ps(c,e)),u}let l={children:[],operator:s[0]};return s.forEach(a=>{const c=r[a];an(c)&&c.forEach(u=>{l.children.push(i(u))})}),l};return _s(t)||(t=Sc(t)),i(t)}function Cv(t,{ignoreFieldNorm:e=be.ignoreFieldNorm}){t.forEach(n=>{let i=1;n.matches.forEach(({key:r,norm:s,score:o})=>{const l=r?r.weight:null;i*=Math.pow(o===0&&l?Number.EPSILON:o,(l||1)*(e?1:s))}),n.score=i})}function Iv(t,e){const n=t.matches;e.matches=[],Pt(n)&&n.forEach(i=>{if(!Pt(i.indices)||!i.indices.length)return;const{indices:r,value:s}=i;let o={indices:r,value:s};i.key&&(o.key=i.key.src),i.idx>-1&&(o.refIndex=i.idx),e.matches.push(o)})}function Mv(t,e){e.score=t.score}function xv(t,e,{includeMatches:n=be.includeMatches,includeScore:i=be.includeScore}={}){const r=[];return n&&r.push(Iv),i&&r.push(Mv),t.map(s=>{const{idx:o}=s,l={item:e[o],refIndex:o};return r.length&&r.forEach(a=>{a(s,l)}),l})}class Gn{constructor(e,n={},i){this.options=Yn(Yn({},be),n),this.options.useExtendedSearch,this._keyStore=new Z1(this.options.keys),this.setCollection(e,i)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof ds))throw new Error(Y1);this._myIndex=n||gc(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Pt(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const n=[];for(let i=0,r=this._docs.length;i<r;i+=1){const s=this._docs[i];e(s,i)&&(this.removeAt(i),i-=1,r-=1,n.push(s))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){const{includeMatches:i,includeScore:r,shouldSort:s,sortFn:o,ignoreFieldNorm:l}=this.options;let a=Qt(e)?Qt(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Cv(a,{ignoreFieldNorm:l}),s&&a.sort(o),uc(n)&&n>-1&&(a=a.slice(0,n)),xv(a,this._docs,{includeMatches:i,includeScore:r})}_searchStringList(e){const n=ps(e,this.options),{records:i}=this._myIndex,r=[];return i.forEach(({v:s,i:o,n:l})=>{if(!Pt(s))return;const{isMatch:a,score:c,indices:u}=n.searchIn(s);a&&r.push({item:s,idx:o,matches:[{score:c,value:s,norm:l,indices:u}]})}),r}_searchLogical(e){const n=kc(e,this.options),i=(l,a,c)=>{if(!l.children){const{keyId:d,searcher:f}=l,h=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(a,d),searcher:f});return h&&h.length?[{idx:c,item:a,matches:h}]:[]}const u=[];for(let d=0,f=l.children.length;d<f;d+=1){const h=l.children[d],m=i(h,a,c);if(m.length)u.push(...m);else if(l.operator===fr.AND)return[]}return u},r=this._myIndex.records,s={},o=[];return r.forEach(({$:l,i:a})=>{if(Pt(l)){let c=i(n,l,a);c.length&&(s[a]||(s[a]={idx:a,item:l,matches:[]},o.push(s[a])),c.forEach(({matches:u})=>{s[a].matches.push(...u)}))}}),o}_searchObjectList(e){const n=ps(e,this.options),{keys:i,records:r}=this._myIndex,s=[];return r.forEach(({$:o,i:l})=>{if(!Pt(o))return;let a=[];i.forEach((c,u)=>{a.push(...this._findMatches({key:c,value:o[u],searcher:n}))}),a.length&&s.push({idx:l,item:o,matches:a})}),s}_findMatches({key:e,value:n,searcher:i}){if(!Pt(n))return[];let r=[];if(an(n))n.forEach(({v:s,i:o,n:l})=>{if(!Pt(s))return;const{isMatch:a,score:c,indices:u}=i.searchIn(s);a&&r.push({score:c,key:e,value:s,idx:o,norm:l,indices:u})});else{const{v:s,n:o}=n,{isMatch:l,score:a,indices:c}=i.searchIn(s);l&&r.push({score:a,key:e,value:s,norm:o,indices:c})}return r}}Gn.version="7.0.0",Gn.createIndex=gc,Gn.parseIndex=lv,Gn.config=be,Gn.parseQuery=kc,Sv(wv);var Av=function(){function t(e){this._haystack=[],this._fuseOptions=xt(xt({},e.fuseOptions),{keys:u1([],e.searchFields,!0),includeMatches:!0})}return t.prototype.index=function(e){this._haystack=e,this._fuse&&this._fuse.setCollection(e)},t.prototype.reset=function(){this._haystack=[],this._fuse=void 0},t.prototype.isEmptyIndex=function(){return!this._haystack.length},t.prototype.search=function(e){this._fuse||(this._fuse=new Gn(this._haystack,this._fuseOptions));var n=this._fuse.search(e);return n.map(function(i,r){return{item:i.item,score:i.score||0,rank:r+1}})},t}();function Tv(t){return new Av(t)}var Nv=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},vs=function(t,e,n){var i=t.dataset,r=e.customProperties,s=e.labelClass,o=e.labelDescription;s&&(i.labelClass=cr(s).join(" ")),o&&(i.labelDescription=o),n&&r&&(typeof r=="string"?i.customProperties=r:typeof r=="object"&&!Nv(r)&&(i.customProperties=JSON.stringify(r)))},Ec=function(t,e,n){var i=e&&t.querySelector("label[for='".concat(e,"']")),r=i&&i.innerText;r&&n.setAttribute("aria-label",r)},Ov={containerOuter:function(t,e,n,i,r,s,o){var l=t.classNames.containerOuter,a=document.createElement("div");return Ce(a,l),a.dataset.type=s,e&&(a.dir=e),i&&(a.tabIndex=0),n&&(a.setAttribute("role",r?"combobox":"listbox"),r?a.setAttribute("aria-autocomplete","list"):o||Ec(this._docRoot,this.passedElement.element.id,a),a.setAttribute("aria-haspopup","true"),a.setAttribute("aria-expanded","false")),o&&a.setAttribute("aria-labelledby",o),a},containerInner:function(t){var e=t.classNames.containerInner,n=document.createElement("div");return Ce(n,e),n},itemList:function(t,e){var n=t.searchEnabled,i=t.classNames,r=i.list,s=i.listSingle,o=i.listItems,l=document.createElement("div");return Ce(l,r),Ce(l,e?s:o),this._isSelectElement&&n&&l.setAttribute("role","listbox"),l},placeholder:function(t,e){var n=t.allowHTML,i=t.classNames.placeholder,r=document.createElement("div");return Ce(r,i),ln(r,n,e),r},item:function(t,e,n){var i=t.allowHTML,r=t.removeItemButtonAlignLeft,s=t.removeItemIconText,o=t.removeItemLabelText,l=t.classNames,a=l.item,c=l.button,u=l.highlightedState,d=l.itemSelectable,f=l.placeholder,h=En(e.value),m=document.createElement("div");if(Ce(m,a),e.labelClass){var p=document.createElement("span");ln(p,i,e.label),Ce(p,e.labelClass),m.appendChild(p)}else ln(m,i,e.label);if(m.dataset.item="",m.dataset.id=e.id,m.dataset.value=h,vs(m,e,!0),(e.disabled||this.containerOuter.isDisabled)&&m.setAttribute("aria-disabled","true"),this._isSelectElement&&(m.setAttribute("aria-selected","true"),m.setAttribute("role","option")),e.placeholder&&(Ce(m,f),m.dataset.placeholder=""),Ce(m,e.highlighted?u:d),n){e.disabled&&Xt(m,d),m.dataset.deletable="";var g=document.createElement("button");g.type="button",Ce(g,c),ln(g,!0,pi(s,e.value));var _=pi(o,e.value);_&&g.setAttribute("aria-label",_),g.dataset.button="",r?m.insertAdjacentElement("afterbegin",g):m.appendChild(g)}return m},choiceList:function(t,e){var n=t.classNames.list,i=document.createElement("div");return Ce(i,n),e||i.setAttribute("aria-multiselectable","true"),i.setAttribute("role","listbox"),i},choiceGroup:function(t,e){var n=t.allowHTML,i=t.classNames,r=i.group,s=i.groupHeading,o=i.itemDisabled,l=e.id,a=e.label,c=e.disabled,u=En(a),d=document.createElement("div");Ce(d,r),c&&Ce(d,o),d.setAttribute("role","group"),d.dataset.group="",d.dataset.id=l,d.dataset.value=u,c&&d.setAttribute("aria-disabled","true");var f=document.createElement("div");return Ce(f,s),ln(f,n,a||""),d.appendChild(f),d},choice:function(t,e,n,i){var r=t.allowHTML,s=t.classNames,o=s.item,l=s.itemChoice,a=s.itemSelectable,c=s.selectedState,u=s.itemDisabled,d=s.description,f=s.placeholder,h=e.label,m=En(e.value),p=document.createElement("div");p.id=e.elementId,Ce(p,o),Ce(p,l),i&&typeof h=="string"&&(h=cs(r,h),h+=" (".concat(i,")"),h={trusted:h});var g=p;if(e.labelClass){var _=document.createElement("span");ln(_,r,h),Ce(_,e.labelClass),g=_,p.appendChild(_)}else ln(p,r,h);if(e.labelDescription){var S="".concat(e.elementId,"-description");g.setAttribute("aria-describedby",S);var E=document.createElement("span");ln(E,r,e.labelDescription),E.id=S,Ce(E,d),p.appendChild(E)}return e.selected&&Ce(p,c),e.placeholder&&Ce(p,f),p.setAttribute("role",e.group?"treeitem":"option"),p.dataset.choice="",p.dataset.id=e.id,p.dataset.value=m,n&&(p.dataset.selectText=n),e.group&&(p.dataset.groupId="".concat(e.group.id)),vs(p,e,!1),e.disabled?(Ce(p,u),p.dataset.choiceDisabled="",p.setAttribute("aria-disabled","true")):(Ce(p,a),p.dataset.choiceSelectable=""),p},input:function(t,e){var n=t.classNames,i=n.input,r=n.inputCloned,s=t.labelId,o=document.createElement("input");return o.type="search",Ce(o,i),Ce(o,r),o.autocomplete="off",o.autocapitalize="off",o.spellcheck=!1,o.setAttribute("aria-autocomplete","list"),e?o.setAttribute("aria-label",e):s||Ec(this._docRoot,this.passedElement.element.id,o),o},dropdown:function(t){var e=t.classNames,n=e.list,i=e.listDropdown,r=document.createElement("div");return Ce(r,n),Ce(r,i),r.setAttribute("aria-expanded","false"),r},notice:function(t,e,n){var i=t.classNames,r=i.item,s=i.itemChoice,o=i.addChoice,l=i.noResults,a=i.noChoices,c=i.notice;n===void 0&&(n=ut.generic);var u=document.createElement("div");switch(ln(u,!0,e),Ce(u,r),Ce(u,s),Ce(u,c),n){case ut.addChoice:Ce(u,o);break;case ut.noResults:Ce(u,l);break;case ut.noChoices:Ce(u,a);break}return n===ut.addChoice&&(u.dataset.choiceSelectable="",u.dataset.choice=""),u},option:function(t){var e=En(t.label),n=new Option(e,t.value,!1,t.selected);return vs(n,t,!0),n.disabled=t.disabled,t.selected&&n.setAttribute("selected",""),n}},Pv="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,Lv={},ys=function(t){if(t)return t.dataset.id?parseInt(t.dataset.id,10):void 0},vi="[data-choice-selectable]",Rv=function(){function t(e,n){e===void 0&&(e="[data-choice]"),n===void 0&&(n={});var i=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var r=t.defaults;this.config=xt(xt(xt({},r.allOptions),r.options),n),f1.forEach(function(_){i.config[_]=xt(xt(xt({},r.allOptions[_]),r.options[_]),n[_])});var s=this.config;s.silent||this._validateConfig();var o=s.shadowRoot||document.documentElement;this._docRoot=o;var l=typeof e=="string"?o.querySelector(e):e;if(!l||typeof l!="object"||!(N1(l)||sc(l)))throw TypeError(!l&&typeof e=="string"?"Selector ".concat(e," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var a=l.type,c=a===gn.Text;(c||s.maxItemCount!==1)&&(s.singleModeForMultiSelect=!1),s.singleModeForMultiSelect&&(a=gn.SelectMultiple);var u=a===gn.SelectOne,d=a===gn.SelectMultiple,f=u||d;if(this._elementType=a,this._isTextElement=c,this._isSelectOneElement=u,this._isSelectMultipleElement=d,this._isSelectElement=u||d,this._canAddUserChoices=c&&s.addItems||f&&s.addChoices,typeof s.renderSelectedChoices!="boolean"&&(s.renderSelectedChoices=s.renderSelectedChoices==="always"||u),s.closeDropdownOnSelect==="auto"?s.closeDropdownOnSelect=c||u||s.singleModeForMultiSelect:s.closeDropdownOnSelect=_i(s.closeDropdownOnSelect),s.placeholder&&(s.placeholderValue?this._hasNonChoicePlaceholder=!0:l.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,s.placeholderValue=l.dataset.placeholder)),n.addItemFilter&&typeof n.addItemFilter!="function"){var h=n.addItemFilter instanceof RegExp?n.addItemFilter:new RegExp(n.addItemFilter);s.addItemFilter=h.test.bind(h)}if(this._isTextElement)this.passedElement=new T1({element:l,classNames:s.classNames});else{var m=l;this.passedElement=new L1({element:m,classNames:s.classNames,template:function(_){return i._templates.option(_)},extractPlaceholder:s.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new j1(s),this._currentValue="",s.searchEnabled=!c&&s.searchEnabled||d,this._canSearch=s.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=_1(l,"choices-"),this._direction=l.dir,!this._direction){var p=window.getComputedStyle(l).direction,g=window.getComputedStyle(document.documentElement).direction;p!==g&&(this._direction=p)}if(this._idNames={itemChoice:"item-choice"},this._templates=r.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){s.silent||console.warn("Trying to initialise Choices on element already initialised",{element:e}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(_){return _.value})}return Object.defineProperty(t,"defaults",{get:function(){return Object.preventExtensions({get options(){return Lv},get allOptions(){return oc},get templates(){return Ov}})},enumerable:!1,configurable:!0}),t.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=Tv(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var e=this.config.callbackOnInit;typeof e=="function"&&e.call(this)}},t.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=t.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},t.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},t.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},t.prototype.highlightItem=function(e,n){if(n===void 0&&(n=!0),!e||!e.id)return this;var i=this._store.items.find(function(r){return r.id===e.id});return!i||i.highlighted?this:(this._store.dispatch(lr(i,!0)),n&&this.passedElement.triggerEvent(At.highlightItem,this._getChoiceForOutput(i)),this)},t.prototype.unhighlightItem=function(e,n){if(n===void 0&&(n=!0),!e||!e.id)return this;var i=this._store.items.find(function(r){return r.id===e.id});return!i||!i.highlighted?this:(this._store.dispatch(lr(i,!1)),n&&this.passedElement.triggerEvent(At.unhighlightItem,this._getChoiceForOutput(i)),this)},t.prototype.highlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(n){n.highlighted||(e._store.dispatch(lr(n,!0)),e.passedElement.triggerEvent(At.highlightItem,e._getChoiceForOutput(n)))})}),this},t.prototype.unhighlightAll=function(){var e=this;return this._store.withTxn(function(){e._store.items.forEach(function(n){n.highlighted&&(e._store.dispatch(lr(n,!1)),e.passedElement.triggerEvent(At.highlightItem,e._getChoiceForOutput(n)))})}),this},t.prototype.removeActiveItemsByValue=function(e){var n=this;return this._store.withTxn(function(){n._store.items.filter(function(i){return i.value===e}).forEach(function(i){return n._removeItem(i)})}),this},t.prototype.removeActiveItems=function(e){var n=this;return this._store.withTxn(function(){n._store.items.filter(function(i){var r=i.id;return r!==e}).forEach(function(i){return n._removeItem(i)})}),this},t.prototype.removeHighlightedItems=function(e){var n=this;return e===void 0&&(e=!1),this._store.withTxn(function(){n._store.highlightedActiveItems.forEach(function(i){n._removeItem(i),e&&n._triggerChange(i.value)})}),this},t.prototype.showDropdown=function(e){var n=this;return this.dropdown.isActive?this:(e===void 0&&(e=!this._canSearch),requestAnimationFrame(function(){n.dropdown.show();var i=n.dropdown.element.getBoundingClientRect();n.containerOuter.open(i.bottom,i.height),e||n.input.focus(),n.passedElement.triggerEvent(At.showDropdown)}),this)},t.prototype.hideDropdown=function(e){var n=this;return this.dropdown.isActive?(requestAnimationFrame(function(){n.dropdown.hide(),n.containerOuter.close(),!e&&n._canSearch&&(n.input.removeActiveDescendant(),n.input.blur()),n.passedElement.triggerEvent(At.hideDropdown)}),this):this},t.prototype.getValue=function(e){var n=this,i=this._store.items.map(function(r){return e?r.value:n._getChoiceForOutput(r)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?i[0]:i},t.prototype.setValue=function(e){var n=this;return this.initialisedOK?(this._store.withTxn(function(){e.forEach(function(i){i&&n._addChoice(Jt(i,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},t.prototype.setChoiceByValue=function(e){var n=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var i=Array.isArray(e)?e:[e];i.forEach(function(r){return n._findAndSelectChoiceByValue(r)}),n.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},t.prototype.setChoices=function(e,n,i,r,s,o){var l=this;if(e===void 0&&(e=[]),n===void 0&&(n="value"),i===void 0&&(i="label"),r===void 0&&(r=!1),s===void 0&&(s=!0),o===void 0&&(o=!1),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof n!="string"||!n)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(typeof e=="function"){var a=e(this);if(typeof Promise=="function"&&a instanceof Promise)return new Promise(function(c){return requestAnimationFrame(c)}).then(function(){return l._handleLoadingState(!0)}).then(function(){return a}).then(function(c){return l.setChoices(c,n,i,r,s,o)}).catch(function(c){l.config.silent||console.error(c)}).then(function(){return l._handleLoadingState(!1)}).then(function(){return l});if(!Array.isArray(a))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof a));return this.setChoices(a,n,i,!1)}if(!Array.isArray(e))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){s&&(l._isSearching=!1),r&&l.clearChoices(!0,o);var c=n==="value",u=i==="label";e.forEach(function(d){if("choices"in d){var f=d;u||(f=xt(xt({},f),{label:f[i]})),l._addGroup(Jt(f,!0))}else{var h=d;(!u||!c)&&(h=xt(xt({},h),{value:h[n],label:h[i]}));var m=Jt(h,!1);l._addChoice(m),m.placeholder&&!l._hasNonChoicePlaceholder&&(l._placeholderValue=ec(m.label))}}),l.unhighlightAll()}),this._searcher.reset(),this},t.prototype.refresh=function(e,n,i){var r=this;return e===void 0&&(e=!1),n===void 0&&(n=!1),i===void 0&&(i=!1),this._isSelectElement?(this._store.withTxn(function(){var s=r.passedElement.optionsAsChoices(),o={};i||r._store.items.forEach(function(a){a.id&&a.active&&a.selected&&(o[a.value]=!0)}),r.clearStore(!1);var l=function(a){i?r._store.dispatch(Ja(a)):o[a.value]&&(a.selected=!0)};s.forEach(function(a){if("choices"in a){a.choices.forEach(l);return}l(a)}),r._addPredefinedChoices(s,n,e),r._isSearching&&r._searchChoices(r.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},t.prototype.removeChoice=function(e){var n=this._store.choices.find(function(i){return i.value===e});return n?(this._clearNotice(),this._store.dispatch(d1(n)),this._searcher.reset(),n.selected&&this.passedElement.triggerEvent(At.removeItem,this._getChoiceForOutput(n)),this):this},t.prototype.clearChoices=function(e,n){var i=this;return e===void 0&&(e=!0),n===void 0&&(n=!1),e&&(n?this.passedElement.element.replaceChildren(""):this.passedElement.element.querySelectorAll(":not([selected])").forEach(function(r){r.remove()})),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.withTxn(function(){var r=n?[]:i._store.items;i._store.reset(),r.forEach(function(s){i._store.dispatch(Ga(s)),i._store.dispatch(Xa(s))})}),this._searcher.reset(),this},t.prototype.clearStore=function(e){return e===void 0&&(e=!0),this.clearChoices(e,!0),this._stopSearch(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this},t.prototype.clearInput=function(){var e=!this._isSelectOneElement;return this.input.clear(e),this._stopSearch(),this},t.prototype._validateConfig=function(){var e=this.config,n=E1(e,oc);n.length&&console.warn("Unknown config option(s) passed",n.join(", ")),e.allowHTML&&e.allowHtmlUserInput&&(e.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),e.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},t.prototype._render=function(e){e===void 0&&(e={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(e.choices||e.groups)&&this._renderChoices(),e.items&&this._renderItems())},t.prototype._renderChoices=function(){var e=this;if(this._canAddItems()){var n=this,i=n.config,r=n._isSearching,s=this._store,o=s.activeGroups,l=s.activeChoices,a=0;if(r&&i.searchResultLimit>0?a=i.searchResultLimit:i.renderChoiceLimit>0&&(a=i.renderChoiceLimit),this._isSelectElement){var c=l.filter(function(m){return!m.element});c.length&&this.passedElement.addOptions(c)}var u=document.createDocumentFragment(),d=function(m){return m.filter(function(p){return!p.placeholder&&(r?!!p.rank:i.renderSelectedChoices||!p.selected)})},f=!1,h=function(m,p,g){r?m.sort(S1):i.shouldSort&&m.sort(i.sorter);var _=m.length;_=!p&&a&&_>a?a:_,_--,m.every(function(S,E){var w=S.choiceEl||e._templates.choice(i,S,i.itemSelectText,g);return S.choiceEl=w,u.appendChild(w),(r||!S.selected)&&(f=!0),E<_})};l.length&&(i.resetScrollPosition&&requestAnimationFrame(function(){return e.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!r&&this._isSelectOneElement&&h(l.filter(function(m){return m.placeholder&&!m.group}),!1,void 0),o.length&&!r?(i.shouldSort&&o.sort(i.sorter),h(l.filter(function(m){return!m.placeholder&&!m.group}),!1,void 0),o.forEach(function(m){var p=d(m.choices);if(p.length){if(m.label){var g=m.groupEl||e._templates.choiceGroup(e.config,m);m.groupEl=g,g.remove(),u.appendChild(g)}h(p,!0,i.appendGroupInSearch&&r?m.label:void 0)}})):h(d(l),!1,void 0)),!f&&(r||!u.children.length||!i.renderSelectedChoices)&&(this._notice||(this._notice={text:Za(r?i.noResultsText:i.noChoicesText),type:r?ut.noResults:ut.noChoices}),u.replaceChildren("")),this._renderNotice(u),this.choiceList.element.replaceChildren(u),f&&this._highlightChoice()}},t.prototype._renderItems=function(){var e=this,n=this._store.items||[],i=this.itemList.element,r=this.config,s=document.createDocumentFragment(),o=function(d){return i.querySelector('[data-item][data-id="'.concat(d.id,'"]'))},l=function(d){var f=d.itemEl;f&&f.parentElement||(f=o(d)||e._templates.item(r,d,r.removeItemButton),d.itemEl=f,s.appendChild(f))};n.forEach(l);var a=!!s.childNodes.length;if(this._isSelectOneElement){var c=i.children.length;if(a||c>1){var u=i.querySelector(gi(r.classNames.placeholder));u&&u.remove()}else!a&&!c&&this._placeholderValue&&(a=!0,l(Jt({selected:!0,value:"",label:this._placeholderValue,placeholder:!0},!1)))}a&&(i.append(s),r.shouldSortItems&&!this._isSelectOneElement&&(n.sort(r.sorter),n.forEach(function(d){var f=o(d);f&&(f.remove(),s.append(f))}),i.append(s))),this._isTextElement&&(this.passedElement.value=n.map(function(d){var f=d.value;return f}).join(r.delimiter))},t.prototype._displayNotice=function(e,n,i){i===void 0&&(i=!0);var r=this._notice;if(r&&(r.type===n&&r.text===e||r.type===ut.addChoice&&(n===ut.noResults||n===ut.noChoices))){i&&this.showDropdown(!0);return}this._clearNotice(),this._notice=e?{text:e,type:n}:void 0,this._renderNotice(),i&&e&&this.showDropdown(!0)},t.prototype._clearNotice=function(){if(this._notice){var e=this.choiceList.element.querySelector(gi(this.config.classNames.notice));e&&e.remove(),this._notice=void 0}},t.prototype._renderNotice=function(e){var n=this._notice;if(n){var i=this._templates.notice(this.config,n.text,n.type);e?e.append(i):this.choiceList.prepend(i)}},t.prototype._getChoiceForOutput=function(e,n){return{id:e.id,highlighted:e.highlighted,labelClass:e.labelClass,labelDescription:e.labelDescription,customProperties:e.customProperties,disabled:e.disabled,active:e.active,label:e.label,placeholder:e.placeholder,value:e.value,groupValue:e.group?e.group.label:void 0,element:e.element,keyCode:n}},t.prototype._triggerChange=function(e){e!=null&&this.passedElement.triggerEvent(At.change,{value:e})},t.prototype._handleButtonAction=function(e){var n=this,i=this._store.items;if(!(!i.length||!this.config.removeItems||!this.config.removeItemButton)){var r=e&&ys(e.parentElement),s=r&&i.find(function(o){return o.id===r});s&&this._store.withTxn(function(){if(n._removeItem(s),n._triggerChange(s.value),n._isSelectOneElement&&!n._hasNonChoicePlaceholder){var o=(n.config.shouldSort?n._store.choices.reverse():n._store.choices).find(function(l){return l.placeholder});o&&(n._addItem(o),n.unhighlightAll(),o.value&&n._triggerChange(o.value))}})}},t.prototype._handleItemAction=function(e,n){var i=this;n===void 0&&(n=!1);var r=this._store.items;if(!(!r.length||!this.config.removeItems||this._isSelectOneElement)){var s=ys(e);s&&(r.forEach(function(o){o.id===s&&!o.highlighted?i.highlightItem(o):!n&&o.highlighted&&i.unhighlightItem(o)}),this.input.focus())}},t.prototype._handleChoiceAction=function(e){var n=this,i=ys(e),r=i&&this._store.getChoiceById(i);if(!r||r.disabled)return!1;var s=this.dropdown.isActive;if(!r.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){n._addItem(r,!0,!0),n.clearInput(),n.unhighlightAll()}),this._triggerChange(r.value)}return s&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},t.prototype._handleBackspace=function(e){var n=this.config;if(!(!n.removeItems||!e.length)){var i=e[e.length-1],r=e.some(function(s){return s.highlighted});n.editItems&&!r&&i?(this.input.value=i.value,this.input.setWidth(),this._removeItem(i),this._triggerChange(i.value)):(r||this.highlightItem(i,!1),this.removeHighlightedItems(!0))}},t.prototype._loadChoices=function(){var e,n=this,i=this.config;if(this._isTextElement){if(this._presetChoices=i.items.map(function(o){return Jt(o,!1)}),this.passedElement.value){var r=this.passedElement.value.split(i.delimiter).map(function(o){return Jt(o,!1,n.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(r)}this._presetChoices.forEach(function(o){o.selected=!0})}else if(this._isSelectElement){this._presetChoices=i.choices.map(function(o){return Jt(o,!0)});var s=this.passedElement.optionsAsChoices();s&&(e=this._presetChoices).push.apply(e,s)}},t.prototype._handleLoadingState=function(e){e===void 0&&(e=!0);var n=this.itemList.element;e?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?n.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(n.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},t.prototype._handleSearch=function(e){if(this.input.isFocussed)if(e!==null&&typeof e<"u"&&e.length>=this.config.searchFloor){var n=this.config.searchChoices?this._searchChoices(e):0;n!==null&&this.passedElement.triggerEvent(At.search,{value:e,resultCount:n})}else this._store.choices.some(function(i){return!i.active})&&this._stopSearch()},t.prototype._canAddItems=function(){var e=this.config,n=e.maxItemCount,i=e.maxItemText;return!e.singleModeForMultiSelect&&n>0&&n<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof i=="function"?i(n):i,ut.addChoice),!1):(this._notice&&this._notice.type===ut.addChoice&&this._clearNotice(),!0)},t.prototype._canCreateItem=function(e){var n=this.config,i=!0,r="";if(i&&typeof n.addItemFilter=="function"&&!n.addItemFilter(e)&&(i=!1,r=pi(n.customAddItemText,e)),i){var s=this._store.choices.find(function(o){return n.valueComparer(o.value,e)});if(s){if(this._isSelectElement)return this._displayNotice("",ut.addChoice),!1;n.duplicateItemsAllowed||(i=!1,r=pi(n.uniqueItemText,e))}}return i&&(r=pi(n.addItemText,e)),r&&this._displayNotice(r,ut.addChoice),i},t.prototype._searchChoices=function(e){var n=e.trim().replace(/\s{2,}/," ");if(!n.length||n===this._currentValue)return null;var i=this._searcher;i.isEmptyIndex()&&i.index(this._store.searchableChoices);var r=i.search(n);this._currentValue=n,this._highlightPosition=0,this._isSearching=!0;var s=this._notice,o=s&&s.type;return o!==ut.addChoice&&(r.length?this._clearNotice():this._displayNotice(Za(this.config.noResultsText),ut.noResults)),this._store.dispatch(h1(r)),r.length},t.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(m1(!0)),this.passedElement.triggerEvent(At.search,{value:"",resultCount:0}))},t.prototype._addEventListeners=function(){var e=this._docRoot,n=this.containerOuter.element,i=this.input.element;e.addEventListener("touchend",this._onTouchEnd,!0),n.addEventListener("keydown",this._onKeyDown,!0),n.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("click",this._onClick,{passive:!0}),e.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(n.addEventListener("focus",this._onFocus,{passive:!0}),n.addEventListener("blur",this._onBlur,{passive:!0})),i.addEventListener("keyup",this._onKeyUp,{passive:!0}),i.addEventListener("input",this._onInput,{passive:!0}),i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0}),i.form&&i.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},t.prototype._removeEventListeners=function(){var e=this._docRoot,n=this.containerOuter.element,i=this.input.element;e.removeEventListener("touchend",this._onTouchEnd,!0),n.removeEventListener("keydown",this._onKeyDown,!0),n.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("click",this._onClick),e.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(n.removeEventListener("focus",this._onFocus),n.removeEventListener("blur",this._onBlur)),i.removeEventListener("keyup",this._onKeyUp),i.removeEventListener("input",this._onInput),i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur),i.form&&i.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},t.prototype._onKeyDown=function(e){var n=e.keyCode,i=this.dropdown.isActive,r=e.key.length===1||e.key.length===2&&e.key.charCodeAt(0)>=55296||e.key==="Unidentified";switch(!this._isTextElement&&!i&&n!==pt.ESC_KEY&&n!==pt.TAB_KEY&&n!==pt.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&r&&(this.input.value+=e.key,e.key===" "&&e.preventDefault())),n){case pt.A_KEY:return this._onSelectKey(e,this.itemList.element.hasChildNodes());case pt.ENTER_KEY:return this._onEnterKey(e,i);case pt.ESC_KEY:return this._onEscapeKey(e,i);case pt.UP_KEY:case pt.PAGE_UP_KEY:case pt.DOWN_KEY:case pt.PAGE_DOWN_KEY:return this._onDirectionKey(e,i);case pt.DELETE_KEY:case pt.BACK_KEY:return this._onDeleteKey(e,this._store.items,this.input.isFocussed)}},t.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},t.prototype._onInput=function(){var e=this.input.value;if(!e){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(e),this._canAddUserChoices&&(this._canCreateItem(e),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},t.prototype._onSelectKey=function(e,n){if((e.ctrlKey||e.metaKey)&&n){this._canSearch=!1;var i=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;i&&this.highlightAll()}},t.prototype._onEnterKey=function(e,n){var i=this,r=this.input.value,s=e.target;if(e.preventDefault(),s&&s.hasAttribute("data-button")){this._handleButtonAction(s);return}if(!n){(this._isSelectElement||this._notice)&&this.showDropdown();return}var o=this.dropdown.element.querySelector(gi(this.config.classNames.highlightedState));if(!(o&&this._handleChoiceAction(o))){if(!s||!r){this.hideDropdown(!0);return}if(this._canAddItems()){var l=!1;this._store.withTxn(function(){if(l=i._findAndSelectChoiceByValue(r,!0),!l){if(!i._canAddUserChoices||!i._canCreateItem(r))return;i._addChoice(Jt(r,!1,i.config.allowHtmlUserInput),!0,!0),l=!0}i.clearInput(),i.unhighlightAll()}),l&&(this._triggerChange(r),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},t.prototype._onEscapeKey=function(e,n){n&&(e.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},t.prototype._onDirectionKey=function(e,n){var i=e.keyCode;if(n||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var r=i===pt.DOWN_KEY||i===pt.PAGE_DOWN_KEY?1:-1,s=e.metaKey||i===pt.PAGE_DOWN_KEY||i===pt.PAGE_UP_KEY,o=void 0;if(s)r>0?o=this.dropdown.element.querySelector("".concat(vi,":last-of-type")):o=this.dropdown.element.querySelector(vi);else{var l=this.dropdown.element.querySelector(gi(this.config.classNames.highlightedState));l?o=v1(l,vi,r):o=this.dropdown.element.querySelector(vi)}o&&(y1(o,this.choiceList.element,r)||this.choiceList.scrollToChildElement(o,r),this._highlightChoice(o)),e.preventDefault()}},t.prototype._onDeleteKey=function(e,n,i){!this._isSelectOneElement&&!e.target.value&&i&&(this._handleBackspace(n),e.preventDefault())},t.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},t.prototype._onTouchEnd=function(e){var n=(e||e.touches[0]).target,i=this._wasTap&&this.containerOuter.element.contains(n);if(i){var r=n===this.containerOuter.element||n===this.containerInner.element;r&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),e.stopPropagation()}this._wasTap=!0},t.prototype._onMouseDown=function(e){var n=e.target;if(n instanceof HTMLElement){if(Pv&&this.choiceList.element.contains(n)){var i=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?e.offsetX>=i.offsetWidth:e.offsetX<i.offsetLeft}if(n!==this.input.element){var r=n.closest("[data-button],[data-item],[data-choice]");r instanceof HTMLElement&&("button"in r.dataset?this._handleButtonAction(r):"item"in r.dataset?this._handleItemAction(r,e.shiftKey):"choice"in r.dataset&&this._handleChoiceAction(r)),e.preventDefault()}}},t.prototype._onMouseOver=function(e){var n=e.target;n instanceof HTMLElement&&"choice"in n.dataset&&this._highlightChoice(n)},t.prototype._onClick=function(e){var n=e.target,i=this.containerOuter,r=i.element.contains(n);r?!this.dropdown.isActive&&!i.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),i.element.focus()):this._isSelectOneElement&&n!==this.input.element&&!this.dropdown.element.contains(n)&&this.hideDropdown():(i.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},t.prototype._onFocus=function(e){var n=e.target,i=this.containerOuter,r=n&&i.element.contains(n);if(r){var s=n===this.input.element;this._isTextElement?s&&i.addFocusState():this._isSelectMultipleElement?s&&(this.showDropdown(!0),i.addFocusState()):(i.addFocusState(),s&&this.showDropdown(!0))}},t.prototype._onBlur=function(e){var n=e.target,i=this.containerOuter,r=n&&i.element.contains(n);r&&!this._isScrollingOnIe?n===this.input.element?(i.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):n===this.containerOuter.element&&(i.removeFocusState(),this._canSearch||this.hideDropdown(!0)):(this._isScrollingOnIe=!1,this.input.element.focus())},t.prototype._onFormReset=function(){var e=this;this._store.withTxn(function(){e.clearInput(),e.hideDropdown(),e.refresh(!1,!1,!0),e._initialItems.length&&e.setChoiceByValue(e._initialItems)})},t.prototype._highlightChoice=function(e){e===void 0&&(e=null);var n=Array.from(this.dropdown.element.querySelectorAll(vi));if(n.length){var i=e,r=this.config.classNames.highlightedState,s=Array.from(this.dropdown.element.querySelectorAll(gi(r)));s.forEach(function(o){Xt(o,r),o.setAttribute("aria-selected","false")}),i?this._highlightPosition=n.indexOf(i):(n.length>this._highlightPosition?i=n[this._highlightPosition]:i=n[n.length-1],i||(i=n[0])),Ce(i,r),i.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(At.highlightChoice,{el:i}),this.dropdown.isActive&&(this.input.setActiveDescendant(i.id),this.containerOuter.setActiveDescendant(i.id))}},t.prototype._addItem=function(e,n,i){if(n===void 0&&(n=!0),i===void 0&&(i=!1),!e.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(e.id),this._store.dispatch(Xa(e)),n&&(this.passedElement.triggerEvent(At.addItem,this._getChoiceForOutput(e)),i&&this.passedElement.triggerEvent(At.choice,this._getChoiceForOutput(e)))},t.prototype._removeItem=function(e){if(e.id){this._store.dispatch(Ja(e));var n=this._notice;n&&n.type===ut.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(At.removeItem,this._getChoiceForOutput(e))}},t.prototype._addChoice=function(e,n,i){if(n===void 0&&(n=!0),i===void 0&&(i=!1),e.id)throw new TypeError("Can not re-add a choice which has already been added");var r=this.config;if(!(!r.duplicateItemsAllowed&&this._store.choices.find(function(l){return r.valueComparer(l.value,e.value)}))){this._lastAddedChoiceId++,e.id=this._lastAddedChoiceId,e.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(e.id);var s=r.prependValue,o=r.appendValue;s&&(e.value=s+e.value),o&&(e.value+=o.toString()),(s||o)&&e.element&&(e.element.value=e.value),this._clearNotice(),this._store.dispatch(Ga(e)),e.selected&&this._addItem(e,n,i)}},t.prototype._addGroup=function(e,n){var i=this;if(n===void 0&&(n=!0),e.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(p1(e)),e.choices&&(this._lastAddedGroupId++,e.id=this._lastAddedGroupId,e.choices.forEach(function(r){r.group=e,e.disabled&&(r.disabled=!0),i._addChoice(r,n)}))},t.prototype._createTemplates=function(){var e=this,n=this.config.callbackOnCreateTemplates,i={};typeof n=="function"&&(i=n.call(this,b1,cs,cr));var r={};Object.keys(this._templates).forEach(function(s){s in i?r[s]=i[s].bind(e):r[s]=e._templates[s].bind(e)}),this._templates=r},t.prototype._createElements=function(){var e=this._templates,n=this,i=n.config,r=n._isSelectOneElement,s=i.position,o=i.classNames,l=this._elementType;this.containerOuter=new tc({element:e.containerOuter(i,this._direction,this._isSelectElement,r,i.searchEnabled,l,i.labelId),classNames:o,type:l,position:s}),this.containerInner=new tc({element:e.containerInner(i),classNames:o,type:l,position:s}),this.input=new x1({element:e.input(i,this._placeholderValue),classNames:o,type:l,preventPaste:!i.paste}),this.choiceList=new nc({element:e.choiceList(i,r)}),this.itemList=new nc({element:e.itemList(i,r)}),this.dropdown=new M1({element:e.dropdown(i),classNames:o,type:l})},t.prototype._createStructure=function(){var e=this,n=e.containerInner,i=e.containerOuter,r=e.passedElement,s=this.dropdown.element;r.conceal(),n.wrap(r.element),i.wrap(n.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),i.element.appendChild(n.element),i.element.appendChild(s),n.element.appendChild(this.itemList.element),s.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&s.insertBefore(this.input.element,s.firstChild):n.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},t.prototype._initStore=function(){var e=this;this._store.subscribe(this._render).withTxn(function(){e._addPredefinedChoices(e._presetChoices,e._isSelectOneElement&&!e._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},t.prototype._addPredefinedChoices=function(e,n,i){var r=this;if(n===void 0&&(n=!1),i===void 0&&(i=!0),n){var s=e.findIndex(function(o){return o.selected})===-1;s&&e.some(function(o){return o.disabled||"choices"in o?!1:(o.selected=!0,!0)})}e.forEach(function(o){"choices"in o?r._isSelectElement&&r._addGroup(o,i):r._addChoice(o,i)})},t.prototype._findAndSelectChoiceByValue=function(e,n){var i=this;n===void 0&&(n=!1);var r=this._store.choices.find(function(s){return i.config.valueComparer(s.value,e)});return r&&!r.disabled&&!r.selected?(this._addItem(r,!0,n),!0):!1},t.prototype._generatePlaceholderValue=function(){var e=this.config;if(!e.placeholder)return null;if(this._hasNonChoicePlaceholder)return e.placeholderValue;if(this._isSelectElement){var n=this.passedElement.placeholderOption;return n?n.text:null}return null},t.prototype._warnChoicesInitFailed=function(e){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(e," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(e," called on a non-initialised instance of Choices"))},t.version="11.1.0",t}();const ub="",fb="";function Cc(t){let e,n;return{c(){e=b("label"),n=re(t[2]),v(e,"for",t[4])},m(i,r){z(i,e,r),y(e,n)},p(i,r){r&4&&Ee(n,i[2])},d(i){i&&D(e)}}}function Dv(t){let e;return{c(){e=b("select"),v(e,"id",t[4]),v(e,"name",t[4]),v(e,"aria-label",t[2]),v(e,"class","m-1")},m(n,i){z(n,e,i)},p(n,i){i&4&&v(e,"aria-label",n[2])},i:ee,o:ee,d(n){n&&D(e)}}}function $v(t){let e,n,i,r=t[3].length&&Ic(t);return{c(){r&&r.c(),e=F(),n=b("select"),v(n,"id",t[4]),v(n,"name",t[4]),v(n,"aria-label",t[2]),v(n,"class","m-1"),n.multiple=!0},m(s,o){r&&r.m(s,o),z(s,e,o),z(s,n,o),i=!0},p(s,o){s[3].length?r?(r.p(s,o),o&8&&U(r,1)):(r=Ic(s),r.c(),U(r,1),r.m(e.parentNode,e)):r&&(ze(),K(r,1,1,()=>{r=null}),je()),(!i||o&4)&&v(n,"aria-label",s[2])},i(s){i||(U(r),i=!0)},o(s){K(r),i=!1},d(s){r&&r.d(s),s&&D(e),s&&D(n)}}}function Ic(t){let e,n,i=t[3].length+"",r,s,o,l;return o=new Pi({props:{targetHtmlId:t[5],tooltipText:`${t[3].length}
                                    ${W==="fr"&&t[3].length>1?"valeurs sélectionnées":W==="fr"&&t[3].length===1?"valeur sélectionnée":W==="en"&&t[3].length>1?"selected values":"selected value"}`}}),{c(){e=b("span"),n=b("span"),r=re(i),s=F(),me(o.$$.fragment),v(n,"id",t[5]),v(n,"class","input-dropdown-count tag m-1 svelte-1epfuu8"),v(e,"class","is-relative")},m(a,c){z(a,e,c),y(e,n),y(n,r),y(e,s),de(o,e,null),l=!0},p(a,c){(!l||c&8)&&i!==(i=a[3].length+"")&&Ee(r,i);const u={};c&8&&(u.tooltipText=`${a[3].length}
                                    ${W==="fr"&&a[3].length>1?"valeurs sélectionnées":W==="fr"&&a[3].length===1?"valeur sélectionnée":W==="en"&&a[3].length>1?"selected values":"selected value"}`),o.$set(u)},i(a){l||(U(o.$$.fragment,a),l=!0)},o(a){K(o.$$.fragment,a),l=!1},d(a){a&&D(e),he(o)}}}function zv(t){let e,n,i,r,s,o,l,a=t[2]!==void 0&&Cc(t);const c=[$v,Dv],u=[];function d(f,h){return f[0]?0:1}return r=d(t),s=u[r]=c[r](t),{c(){e=b("div"),a&&a.c(),n=F(),i=b("div"),s.c(),v(i,"class",o="input-dropdown-select "+(t[0]?"is-multiple":"is-single")+" "+(t[0]&&t[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(t[1]?"light-display":"")+" svelte-1epfuu8"),v(e,"class","input-dropdown-select-wrapper")},m(f,h){z(f,e,h),a&&a.m(e,null),y(e,n),y(e,i),u[r].m(i,null),l=!0},p(f,[h]){f[2]!==void 0?a?a.p(f,h):(a=Cc(f),a.c(),a.m(e,n)):a&&(a.d(1),a=null);let m=r;r=d(f),r===m?u[r].p(f,h):(ze(),K(u[m],1,1,()=>{u[m]=null}),je(),s=u[r],s?s.p(f,h):(s=u[r]=c[r](f),s.c()),U(s,1),s.m(i,null)),(!l||h&11&&o!==(o="input-dropdown-select "+(f[0]?"is-multiple":"is-single")+" "+(f[0]&&f[3].length?"is-flex is-justify-content-flex-start is-align-items-center":"")+" "+(f[1]?"light-display":"")+" svelte-1epfuu8"))&&v(i,"class",o)},i(f){l||(U(s),l=!0)},o(f){K(s),l=!1},d(f){f&&D(e),a&&a.d(),u[r].d()}}}const jv=250;function Fv(t,e,n){let i,r,{choicesItems:s}=e,{start:o=[]}=e,{multiple:l}=e,{searchable:a=!0}=e,{lightDisplay:c=!1}=e,{placeholder:u=W==="fr"?"Sélectionner une valeur":"Select a value"}=e,{title:d=void 0}=e,{selectAll:f=!!l}=e;const h=`input-dropdown-select-${window.crypto.randomUUID()}`,m=`input-dropdown-counter-${window.crypto.randomUUID()}`,p=`select-all-${window.crypto.randomUUID()}`,g=`unselect-all-${window.crypto.randomUUID()}`,_=Ii();let S;const E=xi();E.setCompareFn(kr);const w=Nt("resetTrigger")||void 0;w==null||w.subscribe(()=>H(S,s,o,f));const k=()=>{n(11,r=!0),setTimeout(()=>n(11,r=!1),jv)},T=(O,V)=>{V||(E.set(O),E.same()||_("updateValues",i))},M=O=>`<span class="iconify" data-icon=${O}/>`,C=(O,V)=>O!=null&&V!=null&&O.length&&V.length?`<span class="dropdown-prefix-wrapper">${V==="iconify"?M(O):O}</span>`:"",x=(O,V)=>V?[{value:p,label:`<b>${W==="fr"?"Tout sélectionner":"Select all"}</b>`},{value:g,label:`<b>${W==="fr"?"Tout retirer":"Remove all"}</b>`},...O]:O,P=(O,V)=>x(O,V).map(q=>(q.id=`dropdown-choice-${window.crypto.randomUUID()}`,q.label=`<span>
                ${C(q.prefix||"",q.prefixType||"")}
                <span class="dropdown-prefix-text">${q.label}</span>
            </span>`,q));function L(O,V,q){return O=structuredClone(O),V=structuredClone(V),O=P(O,q).map(B=>V.includes(B.value)?{...B,selected:!0}:{...B,selected:!1}),n(3,i=V),O}function H(O,V,q,B){O&&(V=L(V,q,B),O.clearStore().setChoices(V))}const $=(O,V,q,B,Y,oe)=>(B=structuredClone(B),q=structuredClone(q),O.detail.value===Y?(k(),q=q.map(se=>[Y,oe].includes(se.value)?{...se,selected:!1}:{...se,selected:!0}),V.removeActiveItems().clearChoices(!0,!0).setValue(q).hideDropdown(),B=[...new Set(q.filter(se=>se.selected===!0).map(se=>se.value))]):O.detail.value===oe?(V.removeActiveItems().hideDropdown(),B=[]):B=l===!0?[...B,O.detail.value]:[O.detail.value],[...new Set(B)]),I=(O,V)=>structuredClone(V).filter(q=>q!==O.detail.value);function R(O,V){const q=document.getElementById(h);S=new Rv(q,{items:[],choices:O,addChoices:!1,addItems:!1,removeItems:!0,removeItemButton:!0,searchEnabled:a,allowHTML:!0,shouldSort:!V,sorter:(B,Y)=>B.label.localeCompare(Y.label),placeholderValue:u,classNames:{item:["choices__item","dropdown-item"]},loadingText:W==="fr"?"Chargement...":"Loading...",noResultsText:W==="fr"?"Pas de résultats":"No results found",noChoicesText:W==="fr"?"Pas de choix pour faire la sélection":"No choices to choose from",itemSelectText:W==="fr"?"Cliquer pour sélectionner":"Press to select",uniqueItemText:W==="fr"?"Seules des valeurs uniques peuvent être ajoutées":"Only unique values can be added",customAddItemText:W==="fr"?"Les valeurs ne répondent pas aux conditions attendues":"Only values matching specific conditions can be added",removeItemIconText:W==="fr"?"Retirer l'item":"Remove item",addItemText:B=>W==="fr"?`Cliquer sur Entrer pour ajouter <b>${B}</b>`:`Press Enter to add <b>"${B}"</b>`,removeItemLabelText:B=>W==="fr"?`Retirer l'item: ${B}`:`Remove item: ${B}`,maxItemText:B=>W==="fr"?`Seulement ${B} items peuvent être ajoutées`:`Only ${B} items can be added`}),q.addEventListener("addItem",B=>{n(3,i=$(B,S,O,i,p,g))}),q.addEventListener("removeItem",B=>{n(3,i=I(B,i))})}return Nn(()=>{const O=L(s,o,f);R(O,f)}),On(()=>{S.destroy(),S=void 0}),t.$$set=O=>{"choicesItems"in O&&n(6,s=O.choicesItems),"start"in O&&n(7,o=O.start),"multiple"in O&&n(0,l=O.multiple),"searchable"in O&&n(8,a=O.searchable),"lightDisplay"in O&&n(1,c=O.lightDisplay),"placeholder"in O&&n(9,u=O.placeholder),"title"in O&&n(2,d=O.title),"selectAll"in O&&n(10,f=O.selectAll)},t.$$.update=()=>{t.$$.dirty&2056&&T(i,r)},n(3,i=[]),n(11,r=!1),[l,c,d,i,h,m,s,o,a,u,f,r]}class Vv extends Ae{constructor(e){super(),xe(this,e,Fv,zv,Me,{choicesItems:6,start:7,multiple:0,searchable:8,lightDisplay:1,placeholder:9,title:2,selectAll:10})}}const db="";function Hv(t){let e,n,i,r,s,o,l,a,c,u,d,f,h,m,p,g,_,S,E,w,k,T,M,C,x,P,L,H,$,I,R,O,V,q,B,Y,oe,se,ae;return c=new yn({props:{minVal:0,maxVal:1,start:t[5],emitOnUpdate:!0,title:W==="fr"?"Opacité":"Opacity"}}),c.$on("updateSlider",t[9]),f=new yn({props:{minVal:0,maxVal:360,start:t[6],step:1,emitOnUpdate:!0,title:"Rotation"}}),f.$on("updateSlider",t[10]),p=new yn({props:{minVal:0,maxVal:200,step:1,start:t[7],emitOnUpdate:!0,title:W==="fr"?"Redimensionner":"Scale"}}),p.$on("updateSlider",t[11]),S=new yn({props:{minVal:-100,maxVal:100,step:1,start:t[8][0],emitOnUpdate:!0,title:W==="fr"?"Translation horizontale":"Horizontal translate"}}),S.$on("updateSlider",t[12]),k=new yn({props:{minVal:-100,maxVal:100,step:1,start:t[8][1],emitOnUpdate:!0,title:W==="fr"?"Translation verticale":"Vertical translate"}}),k.$on("updateSlider",t[13]),C=new Vv({props:{choicesItems:t[4],start:[],lightDisplay:!0,placeholder:W==="fr"?"Sélectionner":"Select",title:W==="fr"?"Basculer":"Flip"}}),C.$on("updateValues",t[14]),{c(){e=b("div"),n=b("div"),i=b("div"),r=b("div"),s=b("strong"),s.textContent=`${W==="en"?"Query image transformation":"Modification de l'image requête"}`,o=F(),l=b("div"),a=b("div"),me(c.$$.fragment),u=F(),d=b("div"),me(f.$$.fragment),h=F(),m=b("div"),me(p.$$.fragment),g=F(),_=b("div"),me(S.$$.fragment),E=F(),w=b("div"),me(k.$$.fragment),T=F(),M=b("div"),me(C.$$.fragment),x=F(),P=b("div"),L=b("button"),L.textContent=`${W==="fr"?"Réinitialiser":"Reset"}`,H=F(),$=b("div"),I=b("img"),V=F(),q=b("img"),v(r,"class","toolbar-title mt-0 mb-2 svelte-nzei31"),v(a,"class"," svelte-nzei31"),v(d,"class"," svelte-nzei31"),v(m,"class"," svelte-nzei31"),v(_,"class"," svelte-nzei31"),v(w,"class"," svelte-nzei31"),v(M,"class"," svelte-nzei31"),v(L,"class","button is-link"),v(P,"class","mt-2 is-flex is-flex-direction-column is-justify-content-center is-align-items-flex-end svelte-nzei31"),v(l,"class","toolbar-controls is-flex is-flex-direction-column is-align-items-start is-justify-content-center svelte-nzei31"),v(i,"class","toolbar svelte-nzei31"),v(n,"class","toolbar-wrapper is-flex is-flex-direction-column is-justify-content-center is-align-items-center svelte-nzei31"),v(I,"class","compare-img svelte-nzei31"),vt(I.src,R=t[0].queryImage.href)||v(I,"src",R),v(I,"alt",O=t[0].queryImage.title),v(q,"class","main-img svelte-nzei31"),vt(q.src,B=t[0].similarityImage.href)||v(q,"src",B),v(q,"alt",Y=t[0].similarityImage.title),Pe(q,"overlay-reset",t[2]),De(q,"opacity",t[1]),De(q,"transform",t[3]),v($,"class","overlay-wrapper svelte-nzei31"),v(e,"class","similarity-overlay-wrapper svelte-nzei31")},m(Q,ue){z(Q,e,ue),y(e,n),y(n,i),y(i,r),y(r,s),y(i,o),y(i,l),y(l,a),de(c,a,null),y(l,u),y(l,d),de(f,d,null),y(l,h),y(l,m),de(p,m,null),y(l,g),y(l,_),de(S,_,null),y(l,E),y(l,w),de(k,w,null),y(l,T),y(l,M),de(C,M,null),y(l,x),y(l,P),y(P,L),y(e,H),y(e,$),y($,I),y($,V),y($,q),oe=!0,se||(ae=Se(L,"click",t[15]),se=!0)},p(Q,[ue]){(!oe||ue&1&&!vt(I.src,R=Q[0].queryImage.href))&&v(I,"src",R),(!oe||ue&1&&O!==(O=Q[0].queryImage.title))&&v(I,"alt",O),(!oe||ue&1&&!vt(q.src,B=Q[0].similarityImage.href))&&v(q,"src",B),(!oe||ue&1&&Y!==(Y=Q[0].similarityImage.title))&&v(q,"alt",Y),(!oe||ue&4)&&Pe(q,"overlay-reset",Q[2]),ue&2&&De(q,"opacity",Q[1]),ue&8&&De(q,"transform",Q[3])},i(Q){oe||(U(c.$$.fragment,Q),U(f.$$.fragment,Q),U(p.$$.fragment,Q),U(S.$$.fragment,Q),U(k.$$.fragment,Q),U(C.$$.fragment,Q),oe=!0)},o(Q){K(c.$$.fragment,Q),K(f.$$.fragment,Q),K(p.$$.fragment,Q),K(S.$$.fragment,Q),K(k.$$.fragment,Q),K(C.$$.fragment,Q),oe=!1},d(Q){Q&&D(e),he(c),he(f),he(p),he(S),he(k),he(C),se=!1,ae()}}}function Uv(t,e,n){let i,{imgData:r}=e;const s=[{value:"h",label:W==="fr"?"Basculer horizontalement":"Flip horizontally"},{value:"v",label:W==="fr"?"Basculer verticalement":"Flip vertically"},{value:"hv",label:W==="fr"?"Basculer horizontalement et verticalement":"Flip horizontally and vertically"}];let o=.5;const l=o;let a=0;const c=a;let u=100;const d=u;let f=[1,1];const h=structuredClone(f);let m=[0,0];const p=structuredClone(m);let g=!1;const _=Te(window.crypto.randomUUID());Pn("resetTrigger",_);const S=x=>n(1,o=x.detail),E=x=>n(16,a=x.detail),w=x=>n(17,u=x.detail),k=x=>n(19,m=[x.detail,m[1]]),T=x=>n(19,m=[m[0],x.detail]),M=x=>{let P=x.detail[0];n(18,f=P==="hv"?[-1,-1]:P==="h"?[-1,1]:P==="v"?[1,-1]:[1,1])},C=()=>{n(1,o=l),n(16,a=c),n(17,u=d),n(18,f=h),n(19,m=p),_.set(window.crypto.randomUUID()),n(2,g=!0),setTimeout(()=>n(2,g=!1),1e3)};return t.$$set=x=>{"imgData"in x&&n(0,r=x.imgData)},t.$$.update=()=>{t.$$.dirty&983040&&n(3,i=`translate(${m[0]-50}%, ${m[1]}%)
                        rotate(${a}deg)
                        scale(${f.map(x=>x*(u/100)).join()})`)},[r,o,g,i,s,l,c,d,p,S,E,w,k,T,M,C,a,u,f,m]}class Bv extends Ae{constructor(e){super(),xe(this,e,Uv,Hv,Me,{imgData:0})}}function qv(){const t=`${window.location.origin}${window.location.pathname}`,e=25,n=window.location.pathname.match(/\d+/g).join("-"),i={[n]:{}},r=[2,6],s=Te(1),o=Te({}),l=Te(JSON.parse(localStorage.getItem("selectedRegions"))||i);l.subscribe(H=>localStorage.setItem("selectedRegions",JSON.stringify(H)));const a=Te(JSON.parse(localStorage.getItem("excludedCategories"))||[]);a.subscribe(H=>localStorage.setItem("excludedCategories",JSON.stringify(H)));const c=Te(JSON.parse(localStorage.getItem("similarityScoreCutoff"))||void 0);c.subscribe(H=>{H!=null&&localStorage.setItem("similarityScoreCutoff",JSON.stringify(H))});const u=Te(JSON.parse(localStorage.getItem("propagateRecursionDepth"))||r[1]);u.subscribe(H=>localStorage.setItem("propagateRecursionDepth",JSON.stringify(H)));const d=Te(JSON.parse(localStorage.getItem("propagateFilterByRegions"))||!1);d.subscribe(H=>localStorage.setItem("propagateFilterByRegions",JSON.stringify(H)));const f=nt([u,d],([H,$])=>({propagateRecursionDepth:H,propagateFilterByRegions:$})),h=nt([a,l,c],([H,$,I])=>({excludedCategories:H,regions:$,similarityScoreCutoff:I})),m=nt([f,h],([H,$])=>({propagate:H,similarity:$})),p=Te([]),g=Te([]);async function _(){const H=async()=>{const R=await(await fetch(`${t}compared-regions`)).json();o.set(R),l.update(O=>{let V=O[n]||{};if(Object.keys(V).length){let q=Object.keys(V).filter(B=>Object.keys(R).includes(B)).reduce((B,Y)=>(B[Y]=V[Y],B),{});O[n]=q}return O})},$=async()=>{const R=await(await fetch(`${t}query-images`)).json();R.length>0&&(p.set(R),P(M()))};ti.set(!0);try{await Promise.all([H(),$()])}catch(I){console.error("Error:",I),du.set(I.message)}finally{ti.set(!1)}}function S(H){localStorage.setItem("selectedRegions",JSON.stringify(H))}function E(H){l.update($=>{const I={...$};return delete I[n][H],S(I),I})}function w(H){l.update($=>{const I={...$,[n]:{...$[n]||{},[H.ref]:H}};return S(I),I})}const k=nt(l,H=>$=>{var I;return(I=H[n])==null?void 0:I.hasOwnProperty($)});function T(H){const $=lt(o),I=Object.keys($).filter(R=>R.startsWith(H));return I.length!==1?{title:"Error"}:$[I[0]]}const M=()=>wr(s,"sp"),C=nt([s,p],([H,$])=>(async()=>x(H,$))());function x(H,$){const I=(H-1)*e,R=I+e,O=$.slice(I,R);return g.set(O),O}function P(H){Sr(H,s,"sp")}function L(H){o.update($=>({...$,[H.ref]:H}))}return{currentPage:s,comparedRegions:o,excludedCategories:a,qImgs:p,pageQImgs:g,selectedRegions:l,propagateRecursionDepth:u,propagateFilterByRegions:d,similarityToolbarParams:m,propagateParams:f,similarityScoreCutoff:c,allowedPropagateDepthRange:r,fetchSimilarity:_,setPageQImgs:C,getRegionsInfo:T,handlePageUpdate:P,unselect:E,select:w,addComparedRegions:L,isSelected:k,pageLength:e}}const cn=qv(),{getRegionsInfo:Kv}=cn;async function Mc(t,e,n,i,r,s,o=!1,l=!0){const a=()=>l?`<b>${!isNaN(parseFloat(n))&&e===1?`Score: ${n}`:e===2&&W==="en"?"Manual similarity":e===2&&W==="fr"?"Correspondance manuelle":e===3&&W==="en"?"Propagated match":"Correspondance propagée"}</b>`:"",c=u=>`${u}<br>
        Page ${parseInt(i)}<br>
        ${a()}`;return o===!0?fetch(`${r}${s}get_regions_title/${t}`).then(u=>u.json()).then(u=>c(u.title)).catch(u=>(console.error("similarity.utils.getDesc()",u),c(W==="fr"?"Titre inconnu":"Unknown title"))):Promise.resolve(c(Kv(t).title))}function xc(t,e,n){const i=t.slice();return i[16]=e[n],i}function Ac(t){let e,n,i=t[16]==="queryImage"&&W==="fr"?"Image requête":t[16]==="similarityImage"&&W==="fr"?"Similarité":t[16]==="queryImage"&&W==="en"?"Query image":"Similarity",r,s,o,l,a;return o=new Wn({props:{item:t[0][t[16]],descPromise:t[1][t[16]],height:"full"}}),{c(){e=b("div"),n=b("span"),r=re(i),s=F(),me(o.$$.fragment),l=F(),v(e,"class","img-legend-wrapper column is-flex is-flex-direction-column is-justify-content-center is-align-items-center")},m(c,u){z(c,e,u),y(e,n),y(n,r),y(e,s),de(o,e,null),y(e,l),a=!0},p(c,u){const d={};u&1&&(d.item=c[0][c[16]]),o.$set(d)},i(c){a||(U(o.$$.fragment,c),a=!0)},o(c){K(o.$$.fragment,c),a=!1},d(c){c&&D(e),he(o)}}}function Wv(t){let e,n,i=["queryImage","similarityImage"],r=[];for(let o=0;o<2;o+=1)r[o]=Ac(xc(t,i,o));const s=o=>K(r[o],1,1,()=>{r[o]=null});return{c(){e=b("div");for(let o=0;o<2;o+=1)r[o].c();v(e,"class","side-by-side columns")},m(o,l){z(o,e,l);for(let a=0;a<2;a+=1)r[a]&&r[a].m(e,null);n=!0},p(o,[l]){if(l&3){i=["queryImage","similarityImage"];let a;for(a=0;a<2;a+=1){const c=xc(o,i,a);r[a]?(r[a].p(c,l),U(r[a],1)):(r[a]=Ac(c),r[a].c(),U(r[a],1),r[a].m(e,null))}for(ze(),a=2;a<2;a+=1)s(a);je()}},i(o){if(!n){for(let l=0;l<2;l+=1)U(r[l]);n=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<2;l+=1)K(r[l]);n=!1},d(o){o&&D(e),at(r,o)}}}function Yv(t,e,n){let{imgData:i}=e;const r=Nt("similarityPair"),s=new URL(window.location.href),o=s.origin,l=s.pathname,[a,c,u,d]=r.qImg.split(".")[0].split("_"),[f,h,m,p]=r.sImg.split(".")[0].split("_"),g=`${a}_${c}`,_=`${f}_${h}`,S={queryImage:Mc(g,r.similarityType,r.score,u,o,l,!0,!1),similarityImage:Mc(_,r.similarityType,r.score,m,o,l,!0,!0)};return t.$$set=E=>{"imgData"in E&&n(0,i=E.imgData)},[i,S]}class Gv extends Ae{constructor(e){super(),xe(this,e,Yv,Wv,Me,{imgData:0})}}const hb="";function Xv(t){let e,n;return e=new Gv({props:{imgData:t[2]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p:ee,i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function Jv(t){let e,n;return e=new Bv({props:{imgData:t[1]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p:ee,i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function Qv(t){let e,n,i,r,s,o,l,a,c;const u=[Jv,Xv],d=[];function f(h,m){return h[0]?0:1}return i=f(t),r=d[i]=u[i](t),a=new c1({props:{start:!1,buttonDisplay:!0,toggleLabel:W==="en"?"Overlay view":"Vue superposée"}}),a.$on("updateChecked",t[3]),{c(){e=b("div"),n=b("div"),r.c(),o=F(),l=b("div"),me(a.$$.fragment),v(n,"class",s="modal-similarity-images "+(t[0]?"overlay-wrapper":"side-by-side-wrapper")+" svelte-1qvtan5"),v(e,"class","modal-similarity svelte-1qvtan5")},m(h,m){z(h,e,m),y(e,n),d[i].m(n,null),y(e,o),y(e,l),de(a,l,null),c=!0},p(h,[m]){let p=i;i=f(h),i===p?d[i].p(h,m):(ze(),K(d[p],1,1,()=>{d[p]=null}),je(),r=d[i],r?r.p(h,m):(r=d[i]=u[i](h),r.c()),U(r,1),r.m(n,null)),(!c||m&1&&s!==(s="modal-similarity-images "+(h[0]?"overlay-wrapper":"side-by-side-wrapper")+" svelte-1qvtan5"))&&v(n,"class",s)},i(h){c||(U(r),U(a.$$.fragment,h),c=!0)},o(h){K(r),K(a.$$.fragment,h),c=!1},d(h){h&&D(e),d[i].d(),he(a)}}}function Zv(t,e,n){let{mainImgItem:i}=e,{compareImgItem:r}=e;const s={similarityImage:{href:Vt(i.img,i.img.split("_").pop()),title:a(i.title)},queryImage:{href:Vt(r.img,r.img.split("_").pop()),title:a(r.title)}},o={similarityImage:i,queryImage:r};let l=!1;function a(u){return W==="fr"?`Vue principale de la région ${u}`:`Main view of region ${u}`}const c=()=>n(0,l=!l);return t.$$set=u=>{"mainImgItem"in u&&n(4,i=u.mainImgItem),"compareImgItem"in u&&n(5,r=u.compareImgItem)},[l,s,o,c,i,r]}class ey extends Ae{constructor(e){super(),xe(this,e,Zv,Qv,Me,{mainImgItem:4,compareImgItem:5})}}const ty=Object.freeze(Object.defineProperty({__proto__:null,default:ey},Symbol.toStringTag,{value:"Module"})),Tc=(t,e,n,i)=>({id:t,img:t,title:`Canvas ${i} - ${n} - ${W==="en"?"Witness":"Témoin"} #${br(e)}`,xywh:n.split(",").map(Number),canvas:i,ref:t.replace(".jpg",""),type:au});function ny(t){let e,n,i,r,s,o,l,a,c,u,d;return n=new Fn({props:{category:1,isSelected:t[0]===1,toggle:t[4],padding:"pl-3 pr-2"}}),r=new Fn({props:{category:2,isSelected:t[0]===2,toggle:t[4]}}),o=new Fn({props:{category:3,isSelected:t[0]===3,toggle:t[4]}}),a=new Fn({props:{category:4,isSelected:t[0]===4,toggle:t[4]}}),u=new Fn({props:{category:5,isSelected:t[0]===5,toggle:t[4],padding:"pl-2 pr-3"}}),{c(){e=b("div"),me(n.$$.fragment),i=F(),me(r.$$.fragment),s=F(),me(o.$$.fragment),l=F(),me(a.$$.fragment),c=F(),me(u.$$.fragment),v(e,"class","tags has-addons is-dark is-center")},m(f,h){z(f,e,h),de(n,e,null),y(e,i),de(r,e,null),y(e,s),de(o,e,null),y(e,l),de(a,e,null),y(e,c),de(u,e,null),d=!0},p(f,h){const m={};h&1&&(m.isSelected=f[0]===1),n.$set(m);const p={};h&1&&(p.isSelected=f[0]===2),r.$set(p);const g={};h&1&&(g.isSelected=f[0]===3),o.$set(g);const _={};h&1&&(_.isSelected=f[0]===4),a.$set(_);const S={};h&1&&(S.isSelected=f[0]===5),u.$set(S)},i(f){d||(U(n.$$.fragment,f),U(r.$$.fragment,f),U(o.$$.fragment,f),U(a.$$.fragment,f),U(u.$$.fragment,f),d=!0)},o(f){K(n.$$.fragment,f),K(r.$$.fragment,f),K(o.$$.fragment,f),K(a.$$.fragment,f),K(u.$$.fragment,f),d=!1},d(f){f&&D(e),he(n),he(r),he(o),he(a),he(u)}}}function iy(t){let e,n,i,r;n=new Wn({props:{item:t[3],size:256,selectable:!1,isSquare:!1}});let s=!t[2]&&ny(t);return{c(){e=b("div"),me(n.$$.fragment),i=F(),s&&s.c()},m(o,l){z(o,e,l),de(n,e,null),y(e,i),s&&s.m(e,null),r=!0},p(o,[l]){o[2]||s.p(o,l)},i(o){r||(U(n.$$.fragment,o),U(s),r=!0)},o(o){K(n.$$.fragment,o),K(s),r=!1},d(o){o&&D(e),he(n),s&&s.d()}}}function ry(t,e,n){let i,r,s;const{comparedRegions:o}=cn;we(t,o,$=>n(15,s=$));const l=new URL(window.location.href),a=l.origin;l.pathname;let{qImg:c}=e,{sImg:u}=e,{qRegions:d}=e,{sRegions:f}=e,{score:h=0}=e,{category:m=null}=e,{users:p=[]}=e,{isManual:g}=e,{similarityType:_}=e;const S=Nt("isInModal")||!1,[E,w,k,T]=u.split(".")[0].split("_"),C=(()=>{let $=Tc(u,E,T,k);const I=s[`${E}_${w}_anno${f}`]||{title:$.title};return $.title=`${pu(I.title.replace(/^[^|]+/,""))}<br/>Page ${mu(k)}<br/><b>Score: ${h}</b>`,$})();Pn("similarityPair",{qImg:c,sImg:u,qRegions:d,sRegions:f,score:h,category:m,users:p,isManual:g,similarityType:_});function x($){$=$.slice();let I=$.indexOf(Number(yr));return r&&I===-1?$.push(Number(yr)):!r&&I!==-1&&$.splice(I,1),$}const P=()=>({img_1:c,img_2:u,regions_id_1:d,regions_id_2:f,score:h,category:i,category_x:x(p),similarity_type:_});function L($){$===5?r=!r:n(0,i=i===$?null:$)}async function H($){L($);try{(await fetch(`${a}/${Ft}/save-category`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":dn},body:JSON.stringify(P())})).ok||(console.error("Error: Network response was not ok"),L($))}catch(I){console.error("Error:",I),L($)}}return t.$$set=$=>{"qImg"in $&&n(5,c=$.qImg),"sImg"in $&&n(6,u=$.sImg),"qRegions"in $&&n(7,d=$.qRegions),"sRegions"in $&&n(8,f=$.sRegions),"score"in $&&n(9,h=$.score),"category"in $&&n(10,m=$.category),"users"in $&&n(11,p=$.users),"isManual"in $&&n(12,g=$.isManual),"similarityType"in $&&n(13,_=$.similarityType)},t.$$.update=()=>{t.$$.dirty&1024&&n(0,i=m),t.$$.dirty&2048&&(r=p.includes(Number(yr))||!1)},[i,o,S,C,H,c,u,d,f,h,m,p,g,_]}class sy extends Ae{constructor(e){super(),xe(this,e,ry,iy,Me,{qImg:5,sImg:6,qRegions:7,sRegions:8,score:9,category:10,users:11,isManual:12,similarityType:13})}}function Nc(t,e,n){const i=t.slice();return i[22]=e[n].uuid,i[23]=e[n].data[0],i[24]=e[n].data[1],i[25]=e[n].data[2],i[26]=e[n].data[3],i[27]=e[n].data[4],i[28]=e[n].data[5],i[29]=e[n].data[6],i[30]=e[n].data[7],i[31]=e[n].data[8],i}function oy(t){let e,n=W==="en"?`Error when retrieving similar regions: ${t[2]}`:`Erreur de recupération des régions similaires: ${t[2]}`,i;return{c(){e=b("div"),i=re(n),v(e,"class","faded is-center")},m(r,s){z(r,e,s),y(e,i)},p(r,s){s[0]&4&&n!==(n=W==="en"?`Error when retrieving similar regions: ${r[2]}`:`Erreur de recupération des régions similaires: ${r[2]}`)&&Ee(i,n)},i:ee,o:ee,d(r){r&&D(e)}}}function ly(t){let e,n,i=t[4].length+"",r,s,o=t[11](t[10],t[4].length)+"",l,a,c,u=[],d=new Map,f,h=t[4];const m=g=>g[22];for(let g=0;g<h.length;g+=1){let _=Nc(t,h,g),S=m(_);d.set(S,u[g]=Pc(S,_))}let p=null;return h.length||(p=Oc(t)),{c(){e=b("div"),n=b("span"),r=re(i),s=F(),l=re(o),a=F(),c=b("div");for(let g=0;g<u.length;g+=1)u[g].c();p&&p.c(),v(n,"class","m-2"),v(c,"class","m-2 is-gap-2"),Pe(c,"grid",t[4].length>0)},m(g,_){z(g,e,_),y(e,n),y(n,r),y(n,s),y(n,l),y(e,a),y(e,c);for(let S=0;S<u.length;S+=1)u[S]&&u[S].m(c,null);p&&p.m(c,null),f=!0},p(g,_){(!f||_[0]&16)&&i!==(i=g[4].length+"")&&Ee(r,i),(!f||_[0]&16)&&o!==(o=g[11](g[10],g[4].length)+"")&&Ee(l,o),_[0]&49&&(h=g[4],ze(),u=ei(u,_,m,1,g,h,d,c,vr,Pc,null,Nc),je(),!h.length&&p?p.p(g,_):h.length?p&&(p.d(1),p=null):(p=Oc(g),p.c(),p.m(c,null))),(!f||_[0]&16)&&Pe(c,"grid",g[4].length>0)},i(g){if(!f){for(let _=0;_<h.length;_+=1)U(u[_]);f=!0}},o(g){for(let _=0;_<u.length;_+=1)K(u[_]);f=!1},d(g){g&&D(e);for(let _=0;_<u.length;_+=1)u[_].d();p&&p.d()}}}function ay(t){let e;return{c(){e=b("div"),e.textContent=`${W==="en"&&!t[10]?"Retrieving similar regions...":W==="fr"&&!t[10]?"Récupération des régions similaires...":W==="en"&&t[10]?"Retrieving propagated regions...":"Récupération de similarités propagées..."}`,v(e,"class","faded is-center")},m(n,i){z(n,e,i)},p:ee,i:ee,o:ee,d(n){n&&D(e)}}}function Oc(t){let e;function n(s,o){return s[5]?uy:cy}let i=n(t),r=i(t);return{c(){r.c(),e=ht()},m(s,o){r.m(s,o),z(s,e,o)},p(s,o){i===(i=n(s))&&r?r.p(s,o):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&D(e)}}}function cy(t){let e;return{c(){e=b("div"),e.textContent=`${W==="en"?"No similar regions":"Pas de régions similaires"}
                    `,v(e,"class","faded is-center")},m(n,i){z(n,e,i)},p:ee,d(n){n&&D(e)}}}function uy(t){let e;return{c(){e=b("div"),e.textContent=`${W==="en"?"No document selected. Select one to display results.":"Aucun document sélectionné. Sélectionnez-en un pour afficher les résultats."}
                    `,v(e,"class","faded is-center")},m(n,i){z(n,e,i)},p:ee,d(n){n&&D(e)}}}function Pc(t,e){let n,i,r;return i=new sy({props:{qImg:e[0],sImg:e[25],score:e[23],qRegions:e[26],sRegions:e[27],category:e[28],users:e[29],isManual:e[30],similarityType:e[31]}}),{key:t,first:null,c(){n=ht(),me(i.$$.fragment),this.first=n},m(s,o){z(s,n,o),de(i,s,o),r=!0},p(s,o){e=s;const l={};o[0]&1&&(l.qImg=e[0]),o[0]&16&&(l.sImg=e[25]),o[0]&16&&(l.score=e[23]),o[0]&16&&(l.qRegions=e[26]),o[0]&16&&(l.sRegions=e[27]),o[0]&16&&(l.category=e[28]),o[0]&16&&(l.users=e[29]),o[0]&16&&(l.isManual=e[30]),o[0]&16&&(l.similarityType=e[31]),i.$set(l)},i(s){r||(U(i.$$.fragment,s),r=!0)},o(s){K(i.$$.fragment,s),r=!1},d(s){s&&D(n),he(i,s)}}}function fy(t){let e,n,i,r;const s=[ay,ly,oy],o=[];function l(a,c){return a[1]&&a[3]==="loading"?0:a[3]==="loaded"?1:a[3]==="error"?2:-1}return~(e=l(t))&&(n=o[e]=s[e](t)),{c(){n&&n.c(),i=ht()},m(a,c){~e&&o[e].m(a,c),z(a,i,c),r=!0},p(a,c){let u=e;e=l(a),e===u?~e&&o[e].p(a,c):(n&&(ze(),K(o[u],1,1,()=>{o[u]=null}),je()),~e?(n=o[e],n?n.p(a,c):(n=o[e]=s[e](a),n.c()),U(n,1),n.m(i.parentNode,i)):n=null)},i(a){r||(U(n),r=!0)},o(a){K(n),r=!1},d(a){~e&&o[e].d(a),a&&D(i)}}}function dy(t,e,n){let i,r,s,o,l,a,c,u,{qImg:d}=e,{sImgsPromise:f}=e;const{selectedRegions:h,excludedCategories:m,similarityScoreCutoff:p,propagateFilterByRegions:g}=cn;we(t,h,x=>n(16,u=x)),we(t,m,x=>n(15,c=x)),we(t,p,x=>n(14,a=x)),we(t,g,x=>n(13,l=x));const _=Nt("similarityPropagatedContext")||!1,S=window.location.pathname.match(/\d+/g).join("-");let E;const w=(x,P)=>x===null||P===void 0||Number(x)>=P,k=(x,P,L)=>!L.includes(x),T=(x,P,L,H,$,I)=>_?!0:w(x,$)&&k(P,L,H),M=(x,P,L,H)=>x.filter(({uuid:$,data:[I,R,O,V,q,B,Y,oe,se]})=>T(I,B,Y,P,L)),C=(x,P)=>{const L=P>1;return x?W==="fr"?L?"similarités propagées":"similarité propagée":L?"propagated matches":"propagated match":W==="fr"?L?"images similaires":"image similaire":L?"similar images":"similar image"};return t.$$set=x=>{"qImg"in x&&n(0,d=x.qImg),"sImgsPromise"in x&&n(1,f=x.sImgsPromise)},t.$$.update=()=>{t.$$.dirty[0]&65536&&n(5,i=Object.values(u).length===0||u[S]===void 0||!Object.keys(u[S]).length),t.$$.dirty[0]&2&&(x=>{n(3,r="loading"),n(4,o=[]),n(12,s=[])})(),t.$$.dirty[0]&2&&f.then(x=>{n(12,s=x.map(P=>({uuid:window.crypto.randomUUID(),data:P}))),n(3,r="loaded")}).catch(x=>{n(2,E=x),n(3,r="error")}),t.$$.dirty[0]&61440&&n(4,o=M(s,c,a))},n(3,r="loading"),n(12,s=[]),[d,f,E,r,o,i,h,m,p,g,_,C,s,l,a,c,u]}class Lc extends Ae{constructor(e){super(),xe(this,e,dy,fy,Me,{qImg:0,sImgsPromise:1},null,[-1,-1])}}function hy(t){let e,n;return e=new Lc({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p(i,[r]){const s={};r&1&&(s.qImg=i[0]),r&2&&(s.sImgsPromise=i[1]),e.$set(s)},i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function my(t,e,n){let i,r,{qImg:s}=e,o;const l=Nt("isInModal")||!1,{selectedRegions:a,comparedRegions:c}=cn;we(t,a,m=>n(4,i=m)),we(t,c,m=>n(5,r=m));const u=`${window.location.origin}${window.location.pathname}`,d=window.location.pathname.match(/\d+/g).join("-"),f=(m,p)=>p?Object.keys(r).map(g=>r[g].id):Object.values(m[d]||{}).map(g=>g.id);async function h(m,p,g){const _=f(p,g);return _.length===0?[]:await(await fetch(`${u}similar-images`,{method:"POST",body:JSON.stringify({regionsIds:_,qImg:m,topk:12}),headers:{"Content-Type":"application/json","X-CSRFToken":dn}})).json()}return l?o=h(s,i,l):a.subscribe(m=>{n(1,o=h(s,m,l))}),t.$$set=m=>{"qImg"in m&&n(0,s=m.qImg)},[s,o,a,c]}class py extends Ae{constructor(e){super(),xe(this,e,my,hy,Me,{qImg:0})}}const mb="";function gy(t){let e,n,i,r;return i=new Lc({props:{qImg:t[0],sImgsPromise:t[1]}}),{c(){e=b("div"),n=b("div"),me(i.$$.fragment),v(n,"class","matches-suggestion svelte-1cb4wg0"),v(e,"class","block matches-suggestion-wrapper svelte-1cb4wg0")},m(s,o){z(s,e,o),y(e,n),de(i,n,null),r=!0},p(s,[o]){const l={};o&1&&(l.qImg=s[0]),o&2&&(l.sImgsPromise=s[1]),i.$set(l)},i(s){r||(U(i.$$.fragment,s),r=!0)},o(s){K(i.$$.fragment,s),r=!1},d(s){s&&D(e),he(i)}}}function _y(t,e,n){let i,r,{qImg:s}=e;const{propagateParams:o,selectedRegions:l}=cn;we(t,o,g=>n(4,i=g)),we(t,l,g=>n(5,r=g));const a=`${window.location.origin}${window.location.pathname}`,c=window.location.pathname.match(/\d+/g).join("-"),u=Nt("isInModal")||!1;let d;const f=xi();f.setCompareFn((g,_)=>[g,_].every(S=>S&&S.hasOwnProperty("propagateRecursionDepth")&&S.hasOwnProperty("propagateFilterByRegions"))?g.propagateRecursionDepth===_.propagateRecursionDepth&&g.propagateFilterByRegions===_.propagateFilterByRegions:!1);const h=xi();h.setCompareFn(kr),Pn("similarityPropagatedContext",!0);const m=g=>Object.keys(g).includes(c)?Object.values(g[c]).map(_=>_.id):[],p=async(g,_,S)=>fetch(`${a}propagated-matches/${s}`,{method:"POST",body:JSON.stringify({regionsIds:S?[]:_,filterByRegions:S?!1:g.propagateFilterByRegions,recursionDepth:g.propagateRecursionDepth}),headers:{"Content-Type":"application/json","X-CSRFToken":dn}}).then(E=>E.json()).catch(E=>(console.error("PropagatedMatches.getPropagatedMatches:",E),[]));return o.subscribe(g=>{f.set(g),f.same()||n(1,d=p(f.get(),m(r),u))}),l.subscribe(g=>{h.set(m(g)),i.propagateFilterByRegions===!0&&!h.same()&&n(1,d=p(i,h.get(),u))}),t.$$set=g=>{"qImg"in g&&n(0,s=g.qImg)},[s,d,o,l]}class vy extends Ae{constructor(e){super(),xe(this,e,_y,gy,Me,{qImg:0})}}const pb="";function yy(t){let e,n,i,r=parseInt(t[5])+"",s,o,l,a,c,u,d,f,h,m,p,g,_,S,E,w,k,T,M;return{c(){e=b("a"),n=b("i"),i=re(`
            Page `),s=re(r),o=F(),l=b("img"),c=F(),u=b("div"),d=b("div"),f=b("input"),h=F(),m=b("button"),m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path></svg>',p=F(),g=b("button"),_=jt("svg"),S=jt("path"),v(n,"class","fa-solid fa-pen-to-square"),v(e,"class","tag px-2 py-1 mb-2 is-rounded is-hoverable"),v(e,"href",bu(t[6],parseInt(t[5]))),v(e,"target","_blank"),vt(l.src,a=Vt(t[0],t[0].split("_").pop(),"250,"))||v(l,"src",a),v(l,"alt","Query region"),v(l,"class","mb-3 card query-image svelte-f4ylwc"),v(f,"class","input is-small tag"),v(f,"type","text"),v(f,"placeholder",W==="en"?"Add new match":"Ajouter une correspondance"),v(m,"class","button is-small tag is-link is-center"),v(d,"class","tags has-addons"),De(d,"flex-wrap","nowrap"),v(S,"fill","white"),v(S,"d","M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"),v(_,"xmlns","http://www.w3.org/2000/svg"),v(_,"viewBox","0 0 384 512"),v(g,"id","no-match"),v(g,"class",E="button is-small tag is-danger is-center m-0 "+(t[3]===1?"visible":"")+" svelte-f4ylwc"),v(g,"title",W==="en"?"No match for this region in this witness":"Aucune correspondance de cette région pour ce témoin"),v(u,"class","new-similarity control pt-2 is-center svelte-f4ylwc")},m(C,x){z(C,e,x),y(e,n),y(e,i),y(e,s),z(C,o,x),z(C,l,x),z(C,c,x),z(C,u,x),y(u,d),y(d,f),Si(f,t[1]),y(d,h),y(d,m),y(u,p),y(u,g),y(g,_),y(_,S),k=!0,T||(M=[Se(f,"input",t[12]),Se(m,"click",t[8]),Se(g,"click",t[9])],T=!0)},p(C,x){(!k||x&1&&!vt(l.src,a=Vt(C[0],C[0].split("_").pop(),"250,")))&&v(l,"src",a),x&2&&f.value!==C[1]&&Si(f,C[1]),(!k||x&8&&E!==(E="button is-small tag is-danger is-center m-0 "+(C[3]===1?"visible":"")+" svelte-f4ylwc"))&&v(g,"class",E)},i(C){k||(Wt(()=>{k&&(w||(w=fn(g,jn,{duration:500},!0)),w.run(1))}),k=!0)},o(C){w||(w=fn(g,jn,{duration:500},!1)),w.run(0),k=!1},d(C){C&&D(e),C&&D(o),C&&D(l),C&&D(c),C&&D(u),C&&w&&w.end(),T=!1,ot(M)}}}function by(t){let e,n,i,r,s,o,l,a;return n=new py({props:{qImg:t[0]}}),o=new vy({props:{qImg:t[0]}}),{c(){e=b("div"),me(n.$$.fragment),r=F(),s=b("div"),me(o.$$.fragment),v(e,"class",i=wi(t[7]?"":t[2])+" svelte-f4ylwc"),v(s,"class",l=wi(t[7]?"":t[2])+" svelte-f4ylwc")},m(c,u){z(c,e,u),de(n,e,null),z(c,r,u),z(c,s,u),de(o,s,null),a=!0},p(c,u){const d={};u&1&&(d.qImg=c[0]),n.$set(d),(!a||u&4&&i!==(i=wi(c[7]?"":c[2])+" svelte-f4ylwc"))&&v(e,"class",i);const f={};u&1&&(f.qImg=c[0]),o.$set(f),(!a||u&4&&l!==(l=wi(c[7]?"":c[2])+" svelte-f4ylwc"))&&v(s,"class",l)},i(c){a||(U(n.$$.fragment,c),U(o.$$.fragment,c),a=!0)},o(c){K(n.$$.fragment,c),K(o.$$.fragment,c),a=!1},d(c){c&&D(e),he(n),c&&D(r),c&&D(s),he(o)}}}function wy(t){let e,n;return e=new wa({props:{useGrid:!1,$$slots:{"row-body":[by],"row-header":[yy]},$$scope:{ctx:t}}}),{c(){me(e.$$.fragment)},m(i,r){de(e,i,r),n=!0},p(i,[r]){const s={};r&1048591&&(s.$$scope={dirty:r,ctx:i}),e.$set(s)},i(i){n||(U(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){he(e,i)}}}function Sy(t){return t=t.replace(".jpg",""),/^wit\d+_[a-zA-Z]{3}\d+_\d+_\d+,\d+,\d+,\d+$/.test(t)}function ky(t,e,n){let i,r,s,o;const{selectedRegions:l}=cn;we(t,l,T=>n(11,o=T));let{qImg:a}=e,c="";const[u,d,f,h]=a.split(".")[0].split("_"),m=`${window.location.origin}${window.location.pathname}`,p=window.location.pathname.match(/\d+/g).join("-"),g=W==="en"?"Error":"Erreur",_=Nt("manifest"),S=Nt("isInModal")||!1;Pn("qImgMetadata",Tc(a,u,h,f));async function E(){if(!c||!Sy(c)){await Ct(W==="en"?"Please insert a valid region reference to add a new match":"Veuillez insérer une référence de région valide pour ajouter une nouvelle correspondance","Error");return}try{const T=await fetch(`${m}add-region-pair`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":dn},body:JSON.stringify({q_img:a.replace(".jpg",""),s_img:c,similarity_type:2})});T.ok||(console.error("Error: Network response was not ok"),await Ct(W==="en"?"Problem with network, match was not added":"Problème de réseau, la correspondance n'a pas été ajoutée",g));const M=await T.json();if(M.hasOwnProperty("error")||!M.hasOwnProperty("s_regions")){await Ct(W==="en"?`Request was unsuccessful, match was not added:<br>${M.error}`:`La requête n'a pas abouti, la correspondance n'a pas été ajoutée :<br>${M.error}`,g);return}const C=M.s_regions;cn.addComparedRegions(C),cn.select(C)}catch(T){console.error("Error:",T),await Ct(W==="en"?`An error has occurred, match was not added:<br>${T}`:`Une erreur s'est produite, la correspondance n'a pas été ajoutée :<br>${T}`,g)}}async function w(){const T=Object.values(o[p])[0];if(await Ct(W==="en"?`Do you confirm this region does not have any match in ${T.title}?`:`Confirmez-vous que cette région n'a pas de correspondance dans ${T.title} ?`,W==="en"?"Confirm no match":"Confirmer l'absence de correspondance",!0))try{(await fetch(`${m}no-match`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":dn},body:JSON.stringify({q_img:a,s_regions:T.id})})).ok||(console.error("Error: Network response was not ok"),await Ct(W==="en"?"Problem with network":"Problème de réseau",g)),cn.select(T)}catch(C){console.error("Error:",C),await Ct(W==="en"?`An error has occurred, request was unsuccessful:<br>${C}`:`Une erreur s'est produite, la requête n'a pas abouti :<br>${C}`,g)}}function k(){c=this.value,n(1,c)}return t.$$set=T=>{"qImg"in T&&n(0,a=T.qImg)},t.$$.update=()=>{t.$$.dirty&2048&&n(3,i=o.hasOwnProperty(p)?Object.values(o[p]).length:0),t.$$.dirty&1024&&n(2,s=`fixed-grid has-${r-1}-cols`)},n(10,r=Vs(window.innerWidth)),[a,c,s,i,l,f,_,S,E,w,r,o,k]}class Ey extends Ae{constructor(e){super(),xe(this,e,ky,wy,Me,{qImg:0})}}function Cy(t){let e,n,i,r,s,o;return s=new Ey({props:{qImg:t[0].img}}),{c(){e=b("div"),n=b("a"),i=b("button"),i.textContent=`${W==="fr"?"Voir toutes les similarités pour ce document":"View all similarities for this document"}`,r=F(),me(s.$$.fragment),v(i,"class","button is-link is-small"),v(n,"href",t[1]()),v(e,"class","is-flex is-align-items-center is-justify-content-end")},m(l,a){z(l,e,a),y(e,n),y(n,i),z(l,r,a),de(s,l,a),o=!0},p(l,[a]){const c={};a&1&&(c.qImg=l[0].img),s.$set(c)},i(l){o||(U(s.$$.fragment,l),o=!0)},o(l){K(s.$$.fragment,l),o=!1},d(l){l&&D(e),l&&D(r),he(s,l)}}}function Iy(t,e,n){let{mainImgItem:i}=e;function r(){const s=i.img.match(/wit(\d+)/)[1],o=new URL(window.location.origin);return o.pathname=`${new URL(window.location).pathname.split("/")[1]}/witness/${s}/regions/`,o.searchParams.set("tab","similarity"),o.href}return t.$$set=s=>{"mainImgItem"in s&&n(0,i=s.mainImgItem)},[i,r]}class My extends Ae{constructor(e){super(),xe(this,e,Iy,Cy,Me,{mainImgItem:0})}}const xy=Object.freeze(Object.defineProperty({__proto__:null,default:My},Symbol.toStringTag,{value:"Module"}))})();
//# sourceMappingURL=documentSet.js.map
