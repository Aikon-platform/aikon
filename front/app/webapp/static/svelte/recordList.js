(function(){"use strict";function j(){}const ut=t=>t;function ft(t,e){for(const l in e)t[l]=e[l];return t}function Kl(t){return!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function"}function at(t){return t()}function dt(){return Object.create(null)}function X(t){t.forEach(at)}function Ce(t){return typeof t=="function"}function te(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Ue;function _t(t,e){return Ue||(Ue=document.createElement("a")),Ue.href=e,t===Ue.href}function Zl(t){return Object.keys(t).length===0}function Xe(t,...e){if(t==null)return j;const l=t.subscribe(...e);return l.unsubscribe?()=>l.unsubscribe():l}function Fe(t){let e;return Xe(t,l=>e=l)(),e}function ue(t,e,l){t.$$.on_destroy.push(Xe(e,l))}function Be(t,e,l,n){if(t){const i=mt(t,e,l,n);return t[0](i)}}function mt(t,e,l,n){return t[1]&&n?ft(l.ctx.slice(),t[1](n(e))):l.ctx}function De(t,e,l,n){if(t[2]&&n){const i=t[2](n(l));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],o=Math.max(e.dirty.length,i.length);for(let r=0;r<o;r+=1)s[r]=e.dirty[r]|i[r];return s}return e.dirty|i}return e.dirty}function ze(t,e,l,n,i,s){if(i){const o=mt(e,l,n,s);t.p(o,i)}}function He(t){if(t.ctx.length>32){const e=[],l=t.ctx.length/32;for(let n=0;n<l;n++)e[n]=-1;return e}return-1}function Ve(t){return t&&Ce(t.destroy)?t.destroy:j}const pt=typeof window<"u";let Xl=pt?()=>window.performance.now():()=>Date.now(),Ye=pt?t=>requestAnimationFrame(t):j;const Ee=new Set;function ht(t){Ee.forEach(e=>{e.c(t)||(Ee.delete(e),e.f())}),Ee.size!==0&&Ye(ht)}function Yl(t){let e;return Ee.size===0&&Ye(ht),{promise:new Promise(l=>{Ee.add(e={c:t,f:l})}),abort(){Ee.delete(e)}}}function p(t,e){t.appendChild(e)}function bt(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ql(t){const e=b("style");return xl(bt(t),e),e.sheet}function xl(t,e){return p(t.head||t,e),e.sheet}function S(t,e,l){t.insertBefore(e,l||null)}function w(t){t.parentNode&&t.parentNode.removeChild(t)}function le(t,e){for(let l=0;l<t.length;l+=1)t[l]&&t[l].d(e)}function b(t){return document.createElement(t)}function Le(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function $(t){return document.createTextNode(t)}function O(){return $(" ")}function J(){return $("")}function D(t,e,l,n){return t.addEventListener(e,l,n),()=>t.removeEventListener(e,l,n)}function Re(t){return function(e){return e.preventDefault(),t.call(this,e)}}function m(t,e,l){l==null?t.removeAttribute(e):t.getAttribute(e)!==l&&t.setAttribute(e,l)}const en=["width","height"];function gt(t,e){const l=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:l[n]&&l[n].set&&en.indexOf(n)===-1?t[n]=e[n]:m(t,n,e[n])}function kt(t){return t===""?null:+t}function tn(t){return Array.from(t.childNodes)}function F(t,e){e=""+e,t.data!==e&&(t.data=e)}function ne(t,e){t.value=e??""}function qe(t,e,l){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e){i.selected=!0;return}}(!l||e!==void 0)&&(t.selectedIndex=-1)}function vt(t,e){for(let l=0;l<t.options.length;l+=1){const n=t.options[l];n.selected=~e.indexOf(n.__value)}}function ln(t){const e=t.querySelector(":checked");return e&&e.__value}function me(t,e,l){t.classList[l?"add":"remove"](e)}function wt(t,e,{bubbles:l=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,l,n,e),i}const Je=new Map;let We=0;function nn(t){let e=5381,l=t.length;for(;l--;)e=(e<<5)-e^t.charCodeAt(l);return e>>>0}function sn(t,e){const l={stylesheet:Ql(e),rules:{}};return Je.set(t,l),l}function St(t,e,l,n,i,s,o,r=0){const c=16.666/n;let u=`{
`;for(let y=0;y<=1;y+=c){const E=e+(l-e)*s(y);u+=y*100+`%{${o(E,1-E)}}
`}const a=u+`100% {${o(l,1-l)}}
}`,f=`__svelte_${nn(a)}_${r}`,d=bt(t),{stylesheet:_,rules:h}=Je.get(d)||sn(d,t);h[f]||(h[f]=!0,_.insertRule(`@keyframes ${f} ${a}`,_.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${n}ms linear ${i}ms 1 both`,We+=1,f}function on(t,e){const l=(t.style.animation||"").split(", "),n=l.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=l.length-n.length;i&&(t.style.animation=n.join(", "),We-=i,We||rn())}function rn(){Ye(()=>{We||(Je.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&w(e)}),Je.clear())})}let Ae;function pe(t){Ae=t}function Ge(){if(!Ae)throw new Error("Function called outside component initialization");return Ae}function cn(t){Ge().$$.on_mount.push(t)}function un(){const t=Ge();return(e,l,{cancelable:n=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=wt(e,l,{cancelable:n});return i.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function yt(t,e){return Ge().$$.context.set(t,e),e}const Oe=[],Qe=[];let $e=[];const Et=[],fn=Promise.resolve();let xe=!1;function an(){xe||(xe=!0,fn.then(tt))}function Pe(t){$e.push(t)}const et=new Set;let Ne=0;function tt(){if(Ne!==0)return;const t=Ae;do{try{for(;Ne<Oe.length;){const e=Oe[Ne];Ne++,pe(e),dn(e.$$)}}catch(e){throw Oe.length=0,Ne=0,e}for(pe(null),Oe.length=0,Ne=0;Qe.length;)Qe.pop()();for(let e=0;e<$e.length;e+=1){const l=$e[e];et.has(l)||(et.add(l),l())}$e.length=0}while(Oe.length);for(;Et.length;)Et.pop()();xe=!1,et.clear(),pe(t)}function dn(t){if(t.fragment!==null){t.update(),X(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Pe)}}function _n(t){const e=[],l=[];$e.forEach(n=>t.indexOf(n)===-1?e.push(n):l.push(n)),l.forEach(n=>n()),$e=e}let je;function mn(){return je||(je=Promise.resolve(),je.then(()=>{je=null})),je}function lt(t,e,l){t.dispatchEvent(wt(`${e?"intro":"outro"}${l}`))}const Ke=new Set;let he;function be(){he={r:0,c:[],p:he}}function ge(){he.r||X(he.c),he=he.p}function U(t,e){t&&t.i&&(Ke.delete(t),t.i(e))}function B(t,e,l,n){if(t&&t.o){if(Ke.has(t))return;Ke.add(t),he.c.push(()=>{Ke.delete(t),n&&(l&&t.d(1),n())}),t.o(e)}else n&&n()}const pn={duration:0};function Lt(t,e,l,n){const i={direction:"both"};let s=e(t,l,i),o=n?0:1,r=null,c=null,u=null;function a(){u&&on(t,u)}function f(_,h){const g=_.b-o;return h*=Math.abs(g),{a:o,b:_.b,d:g,duration:h,start:_.start,end:_.start+h,group:_.group}}function d(_){const{delay:h=0,duration:g=300,easing:y=ut,tick:E=j,css:v}=s||pn,L={start:Xl()+h,b:_};_||(L.group=he,he.r+=1),r||c?c=L:(v&&(a(),u=St(t,o,_,g,h,y,v)),_&&E(0,1),r=f(L,g),Pe(()=>lt(t,_,"start")),Yl(k=>{if(c&&k>c.start&&(r=f(c,g),c=null,lt(t,r.b,"start"),v&&(a(),u=St(t,o,r.b,r.duration,0,y,s.css))),r){if(k>=r.end)E(o=r.b,1-o),lt(t,r.b,"end"),c||(r.b?a():--r.group.r||X(r.group.c)),r=null;else if(k>=r.start){const N=k-r.start;o=r.a+r.d*y(N/r.duration),E(o,1-o)}}return!!(r||c)}))}return{run(_){Ce(s)?mn().then(()=>{s=s(i),d(_)}):d(_)},end(){a(),r=c=null}}}function hn(t,e){const l=e.token={};function n(i,s,o,r){if(e.token!==l)return;e.resolved=r;let c=e.ctx;o!==void 0&&(c=c.slice(),c[o]=r);const u=i&&(e.current=i)(c);let a=!1;e.block&&(e.blocks?e.blocks.forEach((f,d)=>{d!==s&&f&&(be(),B(f,1,1,()=>{e.blocks[d]===f&&(e.blocks[d]=null)}),ge())}):e.block.d(1),u.c(),U(u,1),u.m(e.mount(),e.anchor),a=!0),e.block=u,e.blocks&&(e.blocks[s]=u),a&&tt()}if(Kl(t)){const i=Ge();if(t.then(s=>{pe(i),n(e.then,1,e.value,s),pe(null)},s=>{if(pe(i),n(e.catch,2,e.error,s),pe(null),!e.hasCatch)throw s}),e.current!==e.pending)return n(e.pending,0),!0}else{if(e.current!==e.then)return n(e.then,1,e.value,t),!0;e.resolved=t}}function bn(t,e,l){const n=e.slice(),{resolved:i}=t;t.current===t.then&&(n[t.value]=i),t.current===t.catch&&(n[t.error]=i),t.block.p(n,l)}function gn(t,e){t.d(1),e.delete(t.key)}function kn(t,e){B(t,1,1,()=>{e.delete(t.key)})}function Ot(t,e,l,n,i,s,o,r,c,u,a,f){let d=t.length,_=s.length,h=d;const g={};for(;h--;)g[t[h].key]=h;const y=[],E=new Map,v=new Map,L=[];for(h=_;h--;){const C=f(i,s,h),T=l(C);let z=o.get(T);z?n&&L.push(()=>z.p(C,e)):(z=u(T,C),z.c()),E.set(T,y[h]=z),T in g&&v.set(T,Math.abs(h-g[T]))}const k=new Set,N=new Set;function P(C){U(C,1),C.m(r,a),o.set(C.key,C),a=C.first,_--}for(;d&&_;){const C=y[_-1],T=t[d-1],z=C.key,Q=T.key;C===T?(a=C.first,d--,_--):E.has(Q)?!o.has(z)||k.has(z)?P(C):N.has(Q)?d--:v.get(z)>v.get(Q)?(N.add(z),P(C)):(k.add(Q),d--):(c(T,o),d--)}for(;d--;){const C=t[d];E.has(C.key)||c(C,o)}for(;_;)P(y[_-1]);return X(L),y}function vn(t,e){const l={},n={},i={$$scope:1};let s=t.length;for(;s--;){const o=t[s],r=e[s];if(r){for(const c in o)c in r||(n[c]=1);for(const c in r)i[c]||(l[c]=r[c],i[c]=1);t[s]=r}else for(const c in o)i[c]=1}for(const o in n)o in l||(l[o]=void 0);return l}function Y(t){t&&t.c()}function K(t,e,l,n){const{fragment:i,after_update:s}=t.$$;i&&i.m(e,l),n||Pe(()=>{const o=t.$$.on_mount.map(at).filter(Ce);t.$$.on_destroy?t.$$.on_destroy.push(...o):X(o),t.$$.on_mount=[]}),s.forEach(Pe)}function Z(t,e){const l=t.$$;l.fragment!==null&&(_n(l.after_update),X(l.on_destroy),l.fragment&&l.fragment.d(e),l.on_destroy=l.fragment=null,l.ctx=[])}function wn(t,e){t.$$.dirty[0]===-1&&(Oe.push(t),an(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function re(t,e,l,n,i,s,o,r=[-1]){const c=Ae;pe(t);const u=t.$$={fragment:null,ctx:[],props:s,update:j,not_equal:i,bound:dt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:dt(),dirty:r,skip_bound:!1,root:e.target||c.$$.root};o&&o(u.root);let a=!1;if(u.ctx=l?l(t,e.props||{},(f,d,..._)=>{const h=_.length?_[0]:d;return u.ctx&&i(u.ctx[f],u.ctx[f]=h)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](h),a&&wn(t,f)),d}):[],u.update(),a=!0,X(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const f=tn(e.target);u.fragment&&u.fragment.l(f),f.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&U(t.$$.fragment),K(t,e.target,e.anchor,e.customElement),tt()}pe(c)}class ce{$destroy(){Z(this,1),this.$destroy=j}$on(e,l){if(!Ce(l))return j;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(l),()=>{const i=n.indexOf(l);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Zl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const M=APP_LANG,fe=APP_NAME,Sn=WEBAPP_NAME,nt=USER_ID,it=IS_SUPERUSER,yn=CSRF_TOKEN;ADDITIONAL_MODULES,APP_URL,SAS_APP_URL,CANTALOUPE_APP_URL,MEDIA_PATH;const En=PAGE_LEN,Ze={Witness:M==="en"?"Witness":"Témoin",Work:M==="en"?"Work":"Œuvre",Series:M==="en"?"Series":"Série d'imprimés",Regions:M==="en"?"Region Extraction":"Extraction d'illustrations",User:M==="en"?"User":"Utilisateur"},Ie=[];function Ln(t,e){return{subscribe:Se(t,e).subscribe}}function Se(t,e=j){let l;const n=new Set;function i(r){if(te(t,r)&&(t=r,l)){const c=!Ie.length;for(const u of n)u[1](),Ie.push(u,t);if(c){for(let u=0;u<Ie.length;u+=2)Ie[u][0](Ie[u+1]);Ie.length=0}}}function s(r){i(r(t))}function o(r,c=j){const u=[r,c];return n.add(u),n.size===1&&(l=e(i)||j),r(t),()=>{n.delete(u),n.size===0&&l&&(l(),l=null)}}return{set:i,update:s,subscribe:o}}function Me(t,e,l){const n=!Array.isArray(t),i=n?[t]:t,s=e.length<2;return Ln(l,o=>{let r=!1;const c=[];let u=0,a=j;const f=()=>{if(u)return;a();const _=e(n?c[0]:c,o);s?o(_):a=Ce(_)?_:j},d=i.map((_,h)=>Xe(_,g=>{c[h]=g,u&=~(1<<h),r&&f()},()=>{u|=1<<h}));return r=!0,f(),function(){X(d),a(),r=!1}})}function st(t){const{type:e,modelName:l,title:n,extractMeta:i=_=>_}=t,s={id:null,type:e,title:n,is_public:!1,selected:{}},o=JSON.parse(localStorage.getItem(e))||s,r=Se(o),c=Se(!1);function u(_,h=!1){c.set(h),localStorage.setItem(e,JSON.stringify(_))}function a(){r.update(_=>{if(e!=="documentSet")return console.error("Document set management is the only type currently supported for saving."),_;const h=Object.fromEntries(Object.entries(_.selected).map(([y,E])=>[y,Object.keys(E)])),g=_.id?`${_.id}/edit`:"new";return fetch(`${window.location.origin}/${l}/${g}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":yn},body:JSON.stringify({title:_.title,is_public:_.is_public,selection:_,...h})}).then(y=>y.json()).then(y=>{if(!(y!=null&&y.document_set_id))throw new Error("Failed to save");r.update(E=>(E.id=y.document_set_id,E.title=y.document_set_title,E.is_public=y.is_public,u(E,!0),E))}).catch(y=>console.error("Error:",y)),_})}const f=_=>r.update(()=>{const h=_.selection.id?_.selection:{..._.selection,id:_.id};return u(h),h}),d=()=>r.update(()=>{const _={...s,selected:{}};return u(_),_});return{type:e,subscribe:r.subscribe,add:_=>r.update(h=>(h.selected[_.class]={...h.selected[_.class]||{},[_.id]:i(_)},u(h),h)),addAll:_=>r.update(h=>(_.forEach(g=>{h.selected[g.class]={...h.selected[g.class]||{},[g.id]:i(g)}}),u(h),h)),remove:(_,h)=>r.update(g=>{const{[_]:y,...E}=g.selected[h];return g.selected[h]=E,u(g),g}),removeAll:(_,h)=>r.update(g=>(_.forEach(y=>{var E;return(E=g.selected[h])==null?!0:delete E[y]}),u(g),g)),toggle:_=>r.update(h=>{var g;if((g=h.selected[_.class])!=null&&g[_.id]){const{[_.id]:y,...E}=h.selected[_.class];h.selected[_.class]=E}else h.selected[_.class]={...h.selected[_.class]||{},[_.id]:i(_)};return u(h),h}),toggleSet:_=>{Fe(r).id===_.id?d():f(_)},empty:()=>r.update(_=>(_.id=null,_.title=n,_.selected={},u(_,!0),_)),updateTitle:_=>r.update(h=>(h.title=_,u(h,!0),h)),updatePublic:_=>r.update(h=>(h.is_public=_,u(h,!0),h)),save:a,isSaved:c,selection:r,selectionTitle:Me(r,_=>_.title),isSelected:Me(r,_=>h=>{var g;return((g=_.selected[h.class])==null?void 0:g[h.id])||!1}),selected:Me(r,_=>_.selected),nbSelected:Me(r,_=>Object.entries(_.selected).reduce((h,[g,y])=>g==="User"?h:h+Object.keys(y).length,0)),isSetSelected:Me(r,_=>h=>_.id===h.id)}}const ve=st({type:"documentSet",modelName:"document-set",title:M==="en"?"Document set":"Set de documents",extractMeta:t=>({title:t.title,url:t.url})});st({type:"regionsSet",modelName:"regions-set",title:M==="en"?"Regions set":"Set de régions",extractMeta:t=>t});function On(t){if(!t.startsWith("wit"))return t;const[e,...l]=t.split("_wit");return`wit${l}`}st({type:"clusterSet",modelName:"cluster-set",title:M==="en"?"Selected regions":"Régions sélectionnées",extractMeta:t=>({imgRef:t.id,clusterId:t.clusterId,title:t.title,xywh:t.xywh,img:On(t.id)})});const is="";function $n(t){let e=t[1]?"Retirer de la":"Ajouter à la",l,n;return{c(){l=$(e),n=$(" sélection")},m(i,s){S(i,l,s),S(i,n,s)},p(i,s){s&2&&e!==(e=i[1]?"Retirer de la":"Ajouter à la")&&F(l,e)},d(i){i&&w(l),i&&w(n)}}}function Pn(t){let e=t[1]?"Remove from":"Add to",l,n;return{c(){l=$(e),n=$(" selection")},m(i,s){S(i,l,s),S(i,n,s)},p(i,s){s&2&&e!==(e=i[1]?"Remove from":"Add to")&&F(l,e)},d(i){i&&w(l),i&&w(n)}}}function Nn(t){let e;return{c(){e=Le("path"),m(e,"d","M0 48C0 21.5 21.5 0 48 0l0 48V441.4l130.1-92.9c8.3-6 19.6-6 27.9 0L336 441.4V48H48V0H336c26.5 0 48 21.5 48 48V488c0 9-5 17.2-13 21.3s-17.6 3.4-24.9-1.8L192 397.5 37.9 507.5c-7.3 5.2-16.9 5.9-24.9 1.8S0 497 0 488V48z")},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function In(t){let e;return{c(){e=Le("path"),m(e,"d","M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z")},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function Cn(t){let e,l,n,i,s;function o(d,_){return M==="en"?Pn:$n}let c=o()(t);function u(d,_){return d[1]?In:Nn}let a=u(t),f=a(t);return{c(){e=b("button"),c.c(),l=O(),n=Le("svg"),f.c(),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"viewBox","0 0 384 512"),m(n,"class","svelte-135nggd"),m(e,"class","button"),me(e,"is-inverted",t[1])},m(d,_){S(d,e,_),c.m(e,null),p(e,l),p(e,n),f.m(n,null),i||(s=D(e,"click",t[4]),i=!0)},p(d,[_]){c.p(d,_),a!==(a=u(d))&&(f.d(1),f=a(d),f&&(f.c(),f.m(n,null))),_&2&&me(e,"is-inverted",d[1])},i:j,o:j,d(d){d&&w(e),c.d(),f.d(),i=!1,s()}}}function Rn(t,e,l){let n,i;const{isSelected:s}=ve;ue(t,s,c=>l(3,i=c));let{item:o}=e;const r=()=>ve.toggle(o);return t.$$set=c=>{"item"in c&&l(0,o=c.item)},t.$$.update=()=>{t.$$.dirty&9&&l(1,n=i(o))},[o,n,s,i,r]}class An extends ce{constructor(e){super(),re(this,e,Rn,Cn,te,{item:0})}}function $t(t,{delay:e=0,duration:l=400,easing:n=ut}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:l,easing:n,css:s=>`opacity: ${s*i}`}}const jn=t=>typeof t=="string"||t instanceof String;function Mn(){return"https://vhs.huma-num.fr"}function Tn(t,e){if(typeof window<"u"){const l=parseInt(new URLSearchParams(window.location.search).get(e));if(!isNaN(l))return t.set(l),l}return t.set(1),1}function Un(t,e,l){if(e.set(t),typeof window<"u"){const n=new URL(window.location.href);n.searchParams.set(l,t),window.history.pushState({},"",n)}}function Fn(t=null){return t=t.split("_"),t.length<3?void 0:`${t.slice(0,3).join("_").replace(".jpg","")}.jpg`}function Bn(t=null){const e=Fn(t);return e===void 0?void 0:`${Mn()}/iiif/2/${e}`}function Pt(t=null,e=null,l="full"){if(e=jn(e)?e.replace(".jpg",""):e,!t)return"https://placehold.co/96x96/png?text=No+image";if(!t.startsWith("wit")){const[s,...o]=t.split("_wit");t=`wit${o}`}const n=Bn(t);if(n===void 0)return"https://placehold.co/96x96/png?text=No+image";const i=t.split("_");return e||(e=i[i.length-1].includes(",")?i.pop().replace(".jpg",""):"full"),`${n}/${e}/${l}/0/default.jpg`}function Te(t,e=null,l=!1){return new Promise(n=>{if(document.getElementById("msg-modal")){l?document.getElementById("modal-footer").hidden=!1:n(void 0),e&&(document.getElementById("modal-title").innerHTML=e),document.getElementById("modal-msg").innerHTML=t,document.getElementById("hidden-msg-btn").click();const s=document.getElementById("cancel-btn"),o=document.getElementById("ok-btn"),r=document.getElementById("modal-bkg"),c=()=>{s.removeEventListener("click",u),r.removeEventListener("click",u),o.removeEventListener("click",a),document.getElementById("modal-footer").hidden=!0},u=()=>{c(),n(!1)},a=()=>{c(),n(!0)};s.addEventListener("click",u),o.addEventListener("click",a)}else l?n(window.confirm(t)):(window.alert(t),n(void 0))})}async function Nt(t){try{return(await fetch(t)).ok}catch(e){return console.error("Error:",e),!1}}async function Dn(t,e){return Nt(`/${fe}/${e.toLowerCase()}/${t}/delete`)}function It(t){const e=t.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button-close"),l=()=>t.classList.remove("is-active");e.forEach(i=>i.addEventListener("click",l));const n=i=>{i.key==="Escape"&&t.classList.contains("is-active")&&l()};return document.addEventListener("keydown",n),{destroy(){e.forEach(i=>i.removeEventListener("click",l)),document.removeEventListener("keydown",n)}}}function Ct(t){const e=()=>{const l=document.getElementById(t.dataset.target);l==null||l.classList.add("is-active")};return t.addEventListener("click",e),{destroy(){t.removeEventListener("click",e)}}}const ss="",zn=t=>({}),Rt=t=>({}),Hn=t=>({}),At=t=>({});function jt(t,e,l){const n=t.slice();return n[7]=e[l],n}function Mt(t){let e,l,n,i;return{c(){e=b("div"),l=b("figure"),n=b("img"),_t(n.src,i=Pt(t[0].img,"full","250,"))||m(n,"src",i),m(n,"alt","Record illustration"),m(l,"class","card image is-96x96 svelte-1f9ag52"),m(e,"class","media-left")},m(s,o){S(s,e,o),p(e,l),p(l,n)},p(s,o){o&1&&!_t(n.src,i=Pt(s[0].img,"full","250,"))&&m(n,"src",i)},d(s){s&&w(e)}}}function Tt(t){let e;return{c(){e=b("span"),e.innerHTML=`<span class="icon has-text-success"><i class="fas fa-check-circle"></i></span>
                            <span style="margin-left: -0.5rem">Public</span>`,m(e,"class","pl-3 pt-1 icon-text is-size-7 is-center has-text-weight-normal")},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function Ut(t){let e=t[0].user+"",l;return{c(){l=$(e)},m(n,i){S(n,l,i)},p(n,i){i&1&&e!==(e=n[0].user+"")&&F(l,e)},d(n){n&&w(l)}}}function Ft(t){let e,l=t[0].updated_at+"",n;return{c(){e=b("span"),n=$(l),m(e,"class","tag p-1 mb-1")},m(i,s){S(i,e,s),p(e,n)},p(i,s){s&1&&l!==(l=i[0].updated_at+"")&&F(n,l)},d(i){i&&w(e)}}}function Bt(t){let e,l,n,i,s;return{c(){e=b("a"),l=b("span"),n=O(),i=b("span"),i.textContent=`${M==="en"?"Edit":"Éditer"}`,m(l,"class","iconify"),m(l,"data-icon","entypo:edit"),m(i,"class","ml-2"),m(e,"href",s=t[2]?t[0].edit_url:null),m(e,"class","edit-btn button is-small is-rounded is-link px-2 svelte-1f9ag52"),m(e,"title",M==="en"?"Edit":"Éditer")},m(o,r){S(o,e,r),p(e,l),p(e,n),p(e,i)},p(o,r){r&1&&s!==(s=o[2]?o[0].edit_url:null)&&m(e,"href",s)},d(o){o&&w(e)}}}function Dt(t){let e=t[0].hasOwnProperty("iiif"),l,n=e&&zt(t);return{c(){n&&n.c(),l=J()},m(i,s){n&&n.m(i,s),S(i,l,s)},p(i,s){s&1&&(e=i[0].hasOwnProperty("iiif")),e?n?n.p(i,s):(n=zt(i),n.c(),n.m(l.parentNode,l)):n&&(n.d(1),n=null)},d(i){n&&n.d(i),i&&w(l)}}}function zt(t){let e,l=t[0].iiif,n=[];for(let i=0;i<l.length;i+=1)n[i]=Ht(jt(t,l,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=J()},m(i,s){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(i,s);S(i,e,s)},p(i,s){if(s&1){l=i[0].iiif;let o;for(o=0;o<l.length;o+=1){const r=jt(i,l,o);n[o]?n[o].p(r,s):(n[o]=Ht(r),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=l.length}},d(i){le(n,i),i&&w(e)}}}function Ht(t){let e,l=t[7]+"";return{c(){e=b("span"),m(e,"class","tag logo mt-1")},m(n,i){S(n,e,i),e.innerHTML=l},p(n,i){i&1&&l!==(l=n[7]+"")&&(e.innerHTML=l)},d(n){n&&w(e)}}}function Vt(t){let e=t[0].user_id===parseInt(nt)||it,l,n=e&&qt(t);return{c(){n&&n.c(),l=J()},m(i,s){n&&n.m(i,s),S(i,l,s)},p(i,s){s&1&&(e=i[0].user_id===parseInt(nt)||it),e?n?n.p(i,s):(n=qt(i),n.c(),n.m(l.parentNode,l)):n&&(n.d(1),n=null)},d(i){n&&n.d(i),i&&w(l)}}}function qt(t){let e,l,n;return{c(){e=b("button"),m(e,"class","delete is-medium"),m(e,"title",M==="en"?"Delete":"Supprimer")},m(i,s){S(i,e,s),l||(n=D(e,"click",t[3]),l=!0)},p:j,d(i){i&&w(e),l=!1,n()}}}function Vn(t){let e,l,n,i,s=t[0].hasOwnProperty("img"),o,r,c,u,a=t[0].type+"",f,d,_=t[0].id+"",h,g,y=t[0].title+"",E,v,L,k=t[0].hasOwnProperty("is_public")&&t[0].is_public,N,P,C,T,z,Q,ke=t[0].hasOwnProperty("buttons")&&Object.keys(t[0].buttons).length!==0,ye,ae,x,we,G,ee,A,H=s&&Mt(t),I=k&&Tt(),V=t[0].user&&Ut(t),q=t[0].updated_at&&Ft(t),ie=t[2]&&t[0].can_edit&&Bt(t),se=ke&&Dt(t);const rt=t[6].buttons,de=Be(rt,t,t[5],At);let oe=(t[0].class==="Treatment"||t[0].class==="DocumentSet")&&Vt(t);const ct=t[6].body,_e=Be(ct,t,t[5],Rt);return{c(){e=b("div"),l=b("div"),n=b("div"),i=b("div"),H&&H.c(),o=O(),r=b("div"),c=b("a"),u=b("span"),f=$(a),d=$(" #"),h=$(_),g=O(),E=$(y),L=O(),I&&I.c(),N=O(),P=b("p"),V&&V.c(),C=O(),q&&q.c(),T=O(),z=b("p"),ie&&ie.c(),Q=O(),se&&se.c(),ye=O(),ae=b("div"),de&&de.c(),x=O(),oe&&oe.c(),we=O(),G=b("div"),_e&&_e.c(),m(u,"class","tag px-2 py-1 mb-1 mr-1 is-dark is-rounded"),m(c,"href",v=t[1]?t[0].view_url:null),m(c,"class","title is-4 "+(t[1]?"hoverable":"")+" pt-2 svelte-1f9ag52"),m(P,"class","subtitle is-6 mb-0 ml-2 pt-2"),m(z,"class","subtitle is-6 mb-0 ml-2 pt-2 is-middle"),m(r,"class","media-content"),m(ae,"class","media-right"),m(i,"class","media"),m(G,"class","content fixed-grid px-5"),m(n,"class","card-content"),m(l,"class","card mb-5"),m(e,"class","item")},m(R,W){S(R,e,W),p(e,l),p(l,n),p(n,i),H&&H.m(i,null),p(i,o),p(i,r),p(r,c),p(c,u),p(u,f),p(u,d),p(u,h),p(c,g),p(c,E),p(r,L),I&&I.m(r,null),p(r,N),p(r,P),V&&V.m(P,null),p(P,C),q&&q.m(P,null),p(r,T),p(r,z),ie&&ie.m(z,null),p(z,Q),se&&se.m(z,null),p(i,ye),p(i,ae),de&&de.m(ae,null),p(i,x),oe&&oe.m(i,null),p(n,we),p(n,G),_e&&_e.m(G,null),A=!0},p(R,[W]){W&1&&(s=R[0].hasOwnProperty("img")),s?H?H.p(R,W):(H=Mt(R),H.c(),H.m(i,o)):H&&(H.d(1),H=null),(!A||W&1)&&a!==(a=R[0].type+"")&&F(f,a),(!A||W&1)&&_!==(_=R[0].id+"")&&F(h,_),(!A||W&1)&&y!==(y=R[0].title+"")&&F(E,y),(!A||W&1&&v!==(v=R[1]?R[0].view_url:null))&&m(c,"href",v),W&1&&(k=R[0].hasOwnProperty("is_public")&&R[0].is_public),k?I||(I=Tt(),I.c(),I.m(r,N)):I&&(I.d(1),I=null),R[0].user?V?V.p(R,W):(V=Ut(R),V.c(),V.m(P,C)):V&&(V.d(1),V=null),R[0].updated_at?q?q.p(R,W):(q=Ft(R),q.c(),q.m(P,null)):q&&(q.d(1),q=null),R[2]&&R[0].can_edit?ie?ie.p(R,W):(ie=Bt(R),ie.c(),ie.m(z,Q)):ie&&(ie.d(1),ie=null),W&1&&(ke=R[0].hasOwnProperty("buttons")&&Object.keys(R[0].buttons).length!==0),ke?se?se.p(R,W):(se=Dt(R),se.c(),se.m(z,null)):se&&(se.d(1),se=null),de&&de.p&&(!A||W&32)&&ze(de,rt,R,R[5],A?De(rt,R[5],W,Hn):He(R[5]),At),R[0].class==="Treatment"||R[0].class==="DocumentSet"?oe?oe.p(R,W):(oe=Vt(R),oe.c(),oe.m(i,null)):oe&&(oe.d(1),oe=null),_e&&_e.p&&(!A||W&32)&&ze(_e,ct,R,R[5],A?De(ct,R[5],W,zn):He(R[5]),Rt)},i(R){A||(U(de,R),U(_e,R),Pe(()=>{A&&(ee||(ee=Lt(e,$t,{duration:500},!0)),ee.run(1))}),A=!0)},o(R){B(de,R),B(_e,R),ee||(ee=Lt(e,$t,{duration:500},!1)),ee.run(0),A=!1},d(R){R&&w(e),H&&H.d(),I&&I.d(),V&&V.d(),q&&q.d(),ie&&ie.d(),se&&se.d(),de&&de.d(R),oe&&oe.d(),_e&&_e.d(R),R&&ee&&ee.end()}}}function qn(t,e,l){let{$$slots:n={},$$scope:i}=e,{recordsStore:s}=e,{item:o}=e;const r=o.hasOwnProperty("view_url")&&o.view_url!=="",c=o.hasOwnProperty("edit_url")&&o.edit_url!=="";async function u(){if(!await Te(M==="en"?"Are you sure you want to delete this record?":"Voulez-vous vraiment supprimer cet enregistrement ?",M==="en"?"Confirm deletion":"Confirmer la suppression",!0))return;await Dn(o.id,o.class)?s.remove(o.id):await Te(M==="en"?"Failed to delete record":"Erreur lors de la suppression de l'enregistrement",M==="en"?"Error":"Erreur")}return t.$$set=a=>{"recordsStore"in a&&l(4,s=a.recordsStore),"item"in a&&l(0,o=a.item),"$$scope"in a&&l(5,i=a.$$scope)},[o,r,c,u,s,i,n]}class ot extends ce{constructor(e){super(),re(this,e,qn,Vn,te,{recordsStore:4,item:0})}}const os="";function Jt(t,e,l){const n=t.slice();return n[2]=e[l][0],n[3]=e[l][1],n}function Jn(t){let e,l,n;return l=new An({props:{item:t[0]}}),{c(){e=b("div"),Y(l.$$.fragment),m(e,"slot","buttons")},m(i,s){S(i,e,s),K(l,e,null),n=!0},p(i,s){const o={};s&1&&(o.item=i[0]),l.$set(o)},i(i){n||(U(l.$$.fragment,i),n=!0)},o(i){B(l.$$.fragment,i),n=!1},d(i){i&&w(e),Z(l)}}}function Wt(t){let e,l,n=t[2]+"",i,s,o,r=t[3]+"",c,u;return{c(){e=b("div"),l=b("div"),i=$(n),s=O(),o=b("div"),u=O(),m(l,"class","column is-4 is-bold"),m(o,"class",c="column is-8 "+(t[3]==="-"?"faded":"")),m(e,"class","datum is-middle columns svelte-ln5qdg")},m(a,f){S(a,e,f),p(e,l),p(l,i),p(e,s),p(e,o),o.innerHTML=r,p(e,u)},p(a,f){f&1&&n!==(n=a[2]+"")&&F(i,n),f&1&&r!==(r=a[3]+"")&&(o.innerHTML=r),f&1&&c!==(c="column is-8 "+(a[3]==="-"?"faded":""))&&m(o,"class",c)},d(a){a&&w(e)}}}function Wn(t){let e,l=Object.entries(t[0].metadata),n=[];for(let i=0;i<l.length;i+=1)n[i]=Wt(Jt(t,l,i));return{c(){e=b("div");for(let i=0;i<n.length;i+=1)n[i].c();m(e,"slot","body"),m(e,"class","grid metadata pt-2 svelte-ln5qdg")},m(i,s){S(i,e,s);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(i,s){if(s&1){l=Object.entries(i[0].metadata);let o;for(o=0;o<l.length;o+=1){const r=Jt(i,l,o);n[o]?n[o].p(r,s):(n[o]=Wt(r),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=l.length}},d(i){i&&w(e),le(n,i)}}}function Gn(t){let e,l;return e=new ot({props:{item:t[0],recordsStore:t[1],$$slots:{body:[Wn],buttons:[Jn]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment)},m(n,i){K(e,n,i),l=!0},p(n,[i]){const s={};i&1&&(s.item=n[0]),i&2&&(s.recordsStore=n[1]),i&65&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){l||(U(e.$$.fragment,n),l=!0)},o(n){B(e.$$.fragment,n),l=!1},d(n){Z(e,n)}}}function Kn(t,e,l){let{item:n}=e,{recordsStore:i}=e;return t.$$set=s=>{"item"in s&&l(0,n=s.item),"recordsStore"in s&&l(1,i=s.recordsStore)},[n,i]}class Zn extends ce{constructor(e){super(),re(this,e,Kn,Gn,te,{item:0,recordsStore:1})}}const rs="";function Xn(t){let e,l,n,i,s,o=M==="en"?"Selection":"Sélection",r,c,u,a,f,d;return{c(){e=b("div"),l=b("button"),n=b("span"),i=b("i"),s=O(),r=$(o),c=$(`
            (`),u=$(t[0]),a=$(")"),m(i,"class","fa-solid fa-book-bookmark"),m(n,"id","btn-content"),m(l,"id","set-btn"),m(l,"class","button px-5 py-4 is-link svelte-gmt9z5"),m(l,"data-target","selection-modal"),m(e,"class","set-container svelte-gmt9z5")},m(_,h){S(_,e,h),p(e,l),p(l,n),p(n,i),p(n,s),p(n,r),p(n,c),p(n,u),p(n,a),f||(d=Ve(Ct.call(null,l)),f=!0)},p(_,[h]){h&1&&F(u,_[0])},i:j,o:j,d(_){_&&w(e),f=!1,d()}}}function Yn(t,e,l){let{selectionLength:n=0}=e,i=n;return t.$$set=s=>{"selectionLength"in s&&l(0,n=s.selectionLength)},t.$$.update=()=>{if(t.$$.dirty&3&&n!==i){const s=n>i;l(1,i=n);const o=document.getElementById("btn-content");o&&o.animate([{transform:s?"translateY(-7px)":"translateX(-5px)"},{transform:s?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[n,i]}class Qn extends ce{constructor(e){super(),re(this,e,Yn,Xn,te,{selectionLength:0})}}function xn(t){let e,l,n,i,s=M==="en"?"Save selection":"Sauvegarder la sélection",o,r,c;return{c(){e=b("button"),l=b("span"),n=b("i"),i=O(),o=$(s),m(n,"class","fa-solid fa-floppy-disk"),m(e,"class","button is-link")},m(u,a){S(u,e,a),p(e,l),p(l,n),p(l,i),p(l,o),r||(c=D(e,"click",t[7]),r=!0)},p:j,d(u){u&&w(e),r=!1,c()}}}function ei(t){let e,l,n,i,s=M==="en"?"Go to treatment":"Accéder au traitement",o,r;return{c(){var c;e=b("a"),l=b("span"),n=b("i"),i=O(),o=$(s),m(n,"class","fa-solid fa-gear"),m(e,"class","button is-link"),m(e,"href",r="/"+fe+"/treatment/add/?document_set="+((c=t[3])==null?void 0:c.id))},m(c,u){S(c,e,u),p(e,l),p(l,n),p(l,i),p(l,o)},p(c,u){var a;u&8&&r!==(r="/"+fe+"/treatment/add/?document_set="+((a=c[3])==null?void 0:a.id))&&m(e,"href",r)},d(c){c&&w(e)}}}function Gt(t){let e,l,n,i,s,o,r;return{c(){var c,u;e=b("a"),l=b("span"),l.innerHTML='<i class="fa-solid fa-file-export"></i> JSON',i=O(),s=b("a"),o=b("span"),o.innerHTML='<i class="fa-solid fa-file-zipper"></i> ZIP',m(e,"class","button is-link is-dark"),m(e,"href",n="/"+fe+"/document-set/"+((c=t[3])==null?void 0:c.id)+"/json"),m(e,"target","_blank"),m(s,"class","button is-link is-dark"),m(s,"href",r="/"+fe+"/document-set/"+((u=t[3])==null?void 0:u.id)+"/zip"),m(s,"target","_blank")},m(c,u){S(c,e,u),p(e,l),S(c,i,u),S(c,s,u),p(s,o)},p(c,u){var a,f;u&8&&n!==(n="/"+fe+"/document-set/"+((a=c[3])==null?void 0:a.id)+"/json")&&m(e,"href",n),u&8&&r!==(r="/"+fe+"/document-set/"+((f=c[3])==null?void 0:f.id)+"/zip")&&m(s,"href",r)},d(c){c&&w(e),c&&w(i),c&&w(s)}}}function ti(t){let e,l,n,i,s,o,r;function c(d,_){return d[2]&&!d[1]?ei:xn}let u=c(t),a=u(t),f=!t[1]&&Gt(t);return{c(){e=b("footer"),l=b("div"),n=b("button"),n.textContent=`${M==="en"?"Clear selection":"Vider la sélection"}`,i=O(),a.c(),s=O(),f&&f.c(),m(n,"class","button button-close is-link is-light"),m(l,"class","buttons"),m(e,"class","modal-card-foot is-center")},m(d,_){S(d,e,_),p(e,l),p(l,n),p(l,i),a.m(l,null),p(l,s),f&&f.m(l,null),o||(r=D(n,"click",t[6]),o=!0)},p(d,[_]){u===(u=c(d))&&a?a.p(d,_):(a.d(1),a=u(d),a&&(a.c(),a.m(l,s))),d[1]?f&&(f.d(1),f=null):f?f.p(d,_):(f=Gt(d),f.c(),f.m(l,null))},i:j,o:j,d(d){d&&w(e),a.d(),f&&f.d(),o=!1,r()}}}function li(t,e,l){let n,i,{selectionStore:s}=e;const{isSaved:o,selection:r}=s;ue(t,o,f=>l(2,n=f)),ue(t,r,f=>l(3,i=f));let{isRegion:c=s.type!=="documentSet"}=e;const u=()=>s.empty(),a=()=>s.save();return t.$$set=f=>{"selectionStore"in f&&l(0,s=f.selectionStore),"isRegion"in f&&l(1,c=f.isRegion)},[s,c,n,i,o,r,u,a]}class ni extends ce{constructor(e){super(),re(this,e,li,ti,te,{selectionStore:0,isRegion:1})}}const cs="";function Kt(t,e,l){const n=t.slice();return n[31]=e[l],n}function Zt(t,e,l){const n=t.slice();return n[31]=e[l],n}function ii(t){let e,l,n,i,s,o;return{c(){e=b("span"),l=$(t[10]),n=O(),i=b("span"),i.innerHTML='<i class="fas fa-edit"></i>',m(i,"class","pl-3 smaller has-text-link")},m(r,c){S(r,e,c),p(e,l),p(e,n),p(e,i),s||(o=[D(e,"click",t[14]),D(e,"keyup",null)],s=!0)},p(r,c){c[0]&1024&&F(l,r[10])},d(r){r&&w(e),s=!1,X(o)}}}function si(t){let e,l,n;return{c(){e=b("input"),m(e,"class","input selection-title svelte-fumu7c")},m(i,s){S(i,e,s),t[23](e),ne(e,t[5]),l||(n=[D(e,"input",t[24]),D(e,"keydown",t[15]),D(e,"blur",t[16])],l=!0)},p(i,s){s[0]&32&&e.value!==i[5]&&ne(e,i[5])},d(i){i&&w(e),t[23](null),l=!1,X(n)}}}function Xt(t){let e,l,n;function i(){return t[25](t[31])}return{c(){e=b("button"),m(e,"class","tag is-delete")},m(s,o){S(s,e,o),l||(n=D(e,"click",i),l=!0)},p(s,o){t=s},d(s){s&&w(e),l=!1,n()}}}function Yt(t,e){let l,n,i=e[31].username+"",s,o,r,c=e[9]&&Xt(e);return{key:t,first:null,c(){l=b("div"),n=b("span"),s=$(i),o=O(),c&&c.c(),r=O(),m(n,"class","tag"),m(l,"class","tags has-addons svelte-fumu7c"),this.first=l},m(u,a){S(u,l,a),p(l,n),p(n,s),p(l,o),c&&c.m(l,null),p(l,r)},p(u,a){e=u,a[0]&256&&i!==(i=e[31].username+"")&&F(s,i),e[9]?c?c.p(e,a):(c=Xt(e),c.c(),c.m(l,r)):c&&(c.d(1),c=null)},d(u){u&&w(l),c&&c.d()}}}function Qt(t){let e,l,n,i,s,o,r,c,u,a,f,d,_,h,g=M==="en"?"Make public":"Rendre public",y,E,v,L=t[7].length>0&&xt(t);return{c(){var k;e=b("div"),l=b("div"),n=b("div"),i=b("p"),s=b("input"),o=O(),r=b("span"),r.innerHTML='<i class="fas fa-search"></i>',c=O(),L&&L.c(),u=O(),a=b("div"),f=b("label"),d=b("input"),h=O(),y=$(g),m(s,"class","input svelte-fumu7c"),m(s,"placeholder","Search users…"),m(r,"class","icon is-small is-right"),m(i,"class","control is-expanded has-icons-right"),m(n,"class","field"),m(l,"class","dropdown-trigger"),m(e,"class","dropdown is-active"),m(d,"type","checkbox"),d.checked=_=(k=t[2])==null?void 0:k.is_public,m(f,"class","checkbox"),m(a,"class","field mt-3 is-right")},m(k,N){S(k,e,N),p(e,l),p(l,n),p(n,i),p(i,s),ne(s,t[6]),p(i,o),p(i,r),p(e,c),L&&L.m(e,null),S(k,u,N),S(k,a,N),p(a,f),p(f,d),p(f,h),p(f,y),E||(v=[D(s,"input",t[26]),D(s,"input",t[17]),D(d,"change",t[28])],E=!0)},p(k,N){var P;N[0]&64&&s.value!==k[6]&&ne(s,k[6]),k[7].length>0?L?L.p(k,N):(L=xt(k),L.c(),L.m(e,null)):L&&(L.d(1),L=null),N[0]&4&&_!==(_=(P=k[2])==null?void 0:P.is_public)&&(d.checked=_)},d(k){k&&w(e),L&&L.d(),k&&w(u),k&&w(a),E=!1,X(v)}}}function xt(t){let e,l,n=t[7],i=[];for(let s=0;s<n.length;s+=1)i[s]=el(Kt(t,n,s));return{c(){e=b("div"),l=b("div");for(let s=0;s<i.length;s+=1)i[s].c();m(l,"class","dropdown-content"),m(e,"class","dropdown-menu"),m(e,"id","dropdown-menu"),m(e,"role","menu")},m(s,o){S(s,e,o),p(e,l);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(l,null)},p(s,o){if(o[0]&262272){n=s[7];let r;for(r=0;r<n.length;r+=1){const c=Kt(s,n,r);i[r]?i[r].p(c,o):(i[r]=el(c),i[r].c(),i[r].m(l,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=n.length}},d(s){s&&w(e),le(i,s)}}}function el(t){let e,l=t[31].username+"",n,i,s,o;function r(){return t[27](t[31])}return{c(){e=b("div"),n=$(l),i=O(),m(e,"class","dropdown-item")},m(c,u){S(c,e,u),p(e,n),p(e,i),s||(o=[D(e,"click",r),D(e,"keydown",null)],s=!0)},p(c,u){t=c,u[0]&128&&l!==(l=t[31].username+"")&&F(n,l)},d(c){c&&w(e),s=!1,X(o)}}}function oi(t){let e,l,n,i,s,o,r,c,u,a,f,d,_,h,g,y,E,v,L,k=[],N=new Map,P,C,T,z,Q,ke;function ye(I,V){return I[3]?si:ii}let ae=ye(t),x=ae(t);const we=t[22].default,G=Be(we,t,t[21],null);let ee=t[8];const A=I=>I[31].id;for(let I=0;I<ee.length;I+=1){let V=Zt(t,ee,I),q=A(V);N.set(q,k[I]=Yt(q,V))}let H=t[9]&&Qt(t);return T=new ni({props:{selectionStore:t[0]}}),{c(){e=b("div"),l=b("div"),n=O(),i=b("div"),s=b("div"),o=b("div"),r=b("i"),c=O(),x.c(),u=$(`

                (`),a=$(t[1]),f=$(")"),d=O(),_=b("button"),h=O(),g=b("section"),G&&G.c(),y=O(),E=b("h4"),E.textContent=`${M==="en"?"Shared with":"Partagé avec"}`,v=O(),L=b("div");for(let I=0;I<k.length;I+=1)k[I].c();P=O(),H&&H.c(),C=O(),Y(T.$$.fragment),m(l,"class","modal-background"),m(r,"class","fa-solid fa-book-bookmark"),m(o,"class","title is-4 mb-0 media-content"),m(_,"class","delete media-left"),m(_,"aria-label","close"),m(s,"class","modal-card-head media mb-0 is-middle"),m(L,"class","field is-grouped is-grouped-multiline"),m(g,"class","modal-card-body"),m(i,"class","modal-content"),m(e,"id","selection-modal"),m(e,"class","modal fade"),m(e,"tabindex","-1"),m(e,"aria-labelledby","selection-modal-label"),m(e,"aria-hidden","true")},m(I,V){S(I,e,V),p(e,l),p(e,n),p(e,i),p(i,s),p(s,o),p(o,r),p(o,c),x.m(o,null),p(o,u),p(o,a),p(o,f),p(s,d),p(s,_),p(i,h),p(i,g),G&&G.m(g,null),p(g,y),p(g,E),p(g,v),p(g,L);for(let q=0;q<k.length;q+=1)k[q]&&k[q].m(L,null);p(g,P),H&&H.m(g,null),p(i,C),K(T,i,null),z=!0,Q||(ke=Ve(It.call(null,e)),Q=!0)},p(I,V){ae===(ae=ye(I))&&x?x.p(I,V):(x.d(1),x=ae(I),x&&(x.c(),x.m(o,u))),(!z||V[0]&2)&&F(a,I[1]),G&&G.p&&(!z||V[0]&2097152)&&ze(G,we,I,I[21],z?De(we,I[21],V,null):He(I[21]),null),V[0]&525056&&(ee=I[8],k=Ot(k,V,A,1,I,ee,N,L,gn,Yt,null,Zt)),I[9]?H?H.p(I,V):(H=Qt(I),H.c(),H.m(g,null)):H&&(H.d(1),H=null);const q={};V[0]&1&&(q.selectionStore=I[0]),T.$set(q)},i(I){z||(U(G,I),U(T.$$.fragment,I),z=!0)},o(I){B(G,I),B(T.$$.fragment,I),z=!1},d(I){I&&w(e),x.d(),G&&G.d(I);for(let V=0;V<k.length;V+=1)k[V].d();H&&H.d(),Z(T),Q=!1,ke()}}}function ri(t,e,l){let n,i,s,o,r,{$$slots:c={},$$scope:u}=e;const{selected:a}=ve;ue(t,a,A=>l(2,o=A));let{selectionStore:f}=e,{selectionLength:d=!1}=e;const{selectionTitle:_,updateTitle:h,updatePublic:g,save:y}=f;ue(t,_,A=>l(10,r=A));let E=!1,v,L;function k(){l(3,E=!0),l(5,L=r),setTimeout(()=>v==null?void 0:v.focus(),0)}function N(A){A.key==="Enter"&&P()}function P(){l(3,E=!1),h(L),y()}let C="",T=[];async function z(){if(C.trim().length<1){l(7,T=[]);return}const H=await(await fetch(`${window.location.origin}/search/user?q=${encodeURIComponent(C)}`)).json();l(7,T=H.users||[])}function Q(A){f.add({id:A.id,class:"User",title:A.username}),l(6,C=""),l(7,T=[])}function ke(A){f.remove(A,"User")}function ye(A){Qe[A?"unshift":"push"](()=>{v=A,l(4,v)})}function ae(){L=this.value,l(5,L)}const x=A=>ke(A.id);function we(){C=this.value,l(6,C)}const G=A=>Q(A),ee=A=>g(A.target.checked);return t.$$set=A=>{"selectionStore"in A&&l(0,f=A.selectionStore),"selectionLength"in A&&l(1,d=A.selectionLength),"$$scope"in A&&l(21,u=A.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&4&&l(20,n=o==null?void 0:o.owner_id),t.$$.dirty[0]&1048576&&l(9,i=it||n===nt),t.$$.dirty[0]&4&&l(8,s=Object.entries((o==null?void 0:o.User)||{}).map(([A,H])=>({id:Number(A),username:H.title})))},[f,d,o,E,v,L,C,T,s,i,r,a,_,g,k,N,P,z,Q,ke,n,u,c,ye,ae,x,we,G,ee]}class ci extends ce{constructor(e){super(),re(this,e,ri,oi,te,{selectionStore:0,selectionLength:1},null,[-1,-1])}}const us="";function tl(t,e,l){const n=t.slice();return n[15]=e[l],n[17]=l,n}function ll(t){let e,l=t[4],n=[];for(let i=0;i<l.length;i+=1)n[i]=nl(tl(t,l,i));return{c(){e=b("ul");for(let i=0;i<n.length;i+=1)n[i].c();m(e,"class","autocomplete-list is-wide svelte-109rw7p")},m(i,s){S(i,e,s);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(i,s){if(s&592){l=i[4];let o;for(o=0;o<l.length;o+=1){const r=tl(i,l,o);n[o]?n[o].p(r,s):(n[o]=nl(r),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=l.length}},d(i){i&&w(e),le(n,i)}}}function nl(t){let e,l=t[15].label+"",n,i,s,o;function r(){return t[13](t[15])}return{c(){e=b("li"),n=$(l),i=O(),m(e,"class","svelte-109rw7p"),me(e,"selected",t[17]===t[6])},m(c,u){S(c,e,u),p(e,n),p(e,i),s||(o=[D(e,"click",r),D(e,"keyup",null)],s=!0)},p(c,u){t=c,u&16&&l!==(l=t[15].label+"")&&F(n,l),u&64&&me(e,"selected",t[17]===t[6])},d(c){c&&w(e),s=!1,X(o)}}}function ui(t){let e,l,n,i,s,o=t[5]&&ll(t);return{c(){e=b("div"),l=b("input"),n=O(),o&&o.c(),m(l,"class","input is-small is-wide svelte-109rw7p"),m(l,"name",t[1]),m(l,"id",t[2]),m(l,"placeholder",t[0]),m(l,"autocomplete","off"),m(e,"class","autocomplete svelte-109rw7p")},m(r,c){S(r,e,c),p(e,l),ne(l,t[3]),p(e,n),o&&o.m(e,null),i||(s=[D(l,"input",t[12]),D(l,"input",t[7]),D(l,"keydown",t[8])],i=!0)},p(r,[c]){c&2&&m(l,"name",r[1]),c&4&&m(l,"id",r[2]),c&1&&m(l,"placeholder",r[0]),c&8&&l.value!==r[3]&&ne(l,r[3]),r[5]?o?o.p(r,c):(o=ll(r),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i:j,o:j,d(r){r&&w(e),o&&o.d(),i=!1,X(s)}}}function fi(t,e,l){let{items:n=[]}=e,{placeholder:i=`${M==="en"?"Select":"Sélectionner"} ...`}=e,{name:s=""}=e,{id:o=""}=e,r="",c=[],u=!1,a=-1,f=null;const d=un();function _(){l(6,a=-1)}function h(v){v.key==="ArrowDown"?(v.preventDefault(),l(6,a=(a+1)%c.length)):v.key==="ArrowUp"?(v.preventDefault(),l(6,a=a<=0?c.length-1:a-1)):v.key==="Enter"&&a!==-1&&(v.preventDefault(),g(c[a]))}function g(v){l(3,r=v.label),l(11,f=v),l(5,u=!1),d("select",v)}function y(){r=this.value,l(3,r)}const E=v=>g(v);return t.$$set=v=>{"items"in v&&l(10,n=v.items),"placeholder"in v&&l(0,i=v.placeholder),"name"in v&&l(1,s=v.name),"id"in v&&l(2,o=v.id)},t.$$.update=()=>{t.$$.dirty&3080&&(r.length>0?(l(4,c=n.filter(v=>v.label.toLowerCase().includes(r.toLowerCase()))),l(5,u=!0)):(l(4,c=[]),l(5,u=!1),f&&(l(11,f=null),d("select",{id:null,label:""}))))},[i,s,o,r,c,u,a,_,h,g,n,f,y,E]}class ai extends ce{constructor(e){super(),re(this,e,fi,ui,te,{items:10,placeholder:0,name:1,id:2})}}const fs="";function il(t,e,l){const n=t.slice();return n[16]=e[l],n[17]=e,n[18]=l,n}function sl(t,e,l){const n=t.slice();return n[19]=e[l],n}function ol(t,e,l){const n=t.slice();return n[16]=e[l],n[22]=e,n[23]=l,n}function rl(t){let e,l,n,i,s,o,r,c,u,a=M==="en"?"Search":"Rechercher",f,d,_,h,g=t[0],y=[];for(let k=0;k<g.length;k+=1)y[k]=ul(ol(t,g,k));let E=t[0],v=[];for(let k=0;k<E.length;k+=1)v[k]=_l(il(t,E,k));const L=k=>B(v[k],1,1,()=>{v[k]=null});return{c(){e=b("form"),l=b("article");for(let k=0;k<y.length;k+=1)y[k].c();n=O(),i=b("div");for(let k=0;k<v.length;k+=1)v[k].c();s=O(),o=b("div"),r=b("button"),c=b("i"),u=O(),f=$(a),m(i,"class","grid"),m(l,"class","message fixed-grid"),m(c,"class","fa-solid fa-magnifying-glass"),m(r,"type","submit"),m(r,"class","button is-link is-outlined is-fullwidth"),m(o,"class","panel-block columns"),m(e,"class","is-center pb-3")},m(k,N){S(k,e,N),p(e,l);for(let P=0;P<y.length;P+=1)y[P]&&y[P].m(l,null);p(l,n),p(l,i);for(let P=0;P<v.length;P+=1)v[P]&&v[P].m(i,null);p(e,s),p(e,o),p(o,r),p(r,c),p(r,u),p(r,f),d=!0,_||(h=D(e,"submit",t[3]),_=!0)},p(k,N){if(N&3){g=k[0];let P;for(P=0;P<g.length;P+=1){const C=ol(k,g,P);y[P]?y[P].p(C,N):(y[P]=ul(C),y[P].c(),y[P].m(l,n))}for(;P<y.length;P+=1)y[P].d(1);y.length=g.length}if(N&51){E=k[0];let P;for(P=0;P<E.length;P+=1){const C=il(k,E,P);v[P]?(v[P].p(C,N),U(v[P],1)):(v[P]=_l(C),v[P].c(),U(v[P],1),v[P].m(i,null))}for(be(),P=E.length;P<v.length;P+=1)L(P);ge()}},i(k){if(!d){for(let N=0;N<E.length;N+=1)U(v[N]);d=!0}},o(k){v=v.filter(Boolean);for(let N=0;N<v.length;N+=1)B(v[N]);d=!1},d(k){k&&w(e),le(y,k),le(v,k),_=!1,h()}}}function cl(t){let e,l,n=t[16].label+"",i,s,o,r,c,u,a,f,d,_;function h(){t[7].call(c,t[16])}return{c(){e=b("div"),l=b("label"),i=$(n),o=O(),r=b("div"),c=b("input"),f=O(),m(l,"for",s=t[16].name),m(l,"class","label column is-small is-2 svelte-wwfwxh"),m(c,"type","text"),m(c,"class","input is-small is-wide"),m(c,"id",u=t[16].name),m(c,"name",a=t[16].name),m(r,"class","control has-icons-right column is-10"),m(e,"class","search-field field columns pb-3 svelte-wwfwxh")},m(g,y){S(g,e,y),p(e,l),p(l,i),p(e,o),p(e,r),p(r,c),ne(c,t[1][t[16].name]),p(e,f),d||(_=D(c,"input",h),d=!0)},p(g,y){t=g,y&1&&n!==(n=t[16].label+"")&&F(i,n),y&1&&s!==(s=t[16].name)&&m(l,"for",s),y&1&&u!==(u=t[16].name)&&m(c,"id",u),y&1&&a!==(a=t[16].name)&&m(c,"name",a),y&3&&c.value!==t[1][t[16].name]&&ne(c,t[1][t[16].name])},d(g){g&&w(e),d=!1,_()}}}function ul(t){let e,l=t[16].name==="search"&&cl(t);return{c(){l&&l.c(),e=J()},m(n,i){l&&l.m(n,i),S(n,e,i)},p(n,i){n[16].name==="search"?l?l.p(n,i):(l=cl(n),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(n){l&&l.d(n),n&&w(e)}}}function fl(t){let e,l,n=t[16].label+"",i,s,o,r,c,u,a,f,d,_;const h=[hi,pi,mi,_i,di],g=[];function y(E,v){return v&1&&(c=null),v&1&&(u=null),c==null&&(c=!!E[16].type.includes("ChoiceField")),c?0:E[16].type==="BooleanField"?1:(u==null&&(u=!!E[16].type.includes("Date")),u?2:E[16].type==="IntegerField"||E[16].type==="FloatField"?3:4)}return a=y(t,-1),f=g[a]=h[a](t),{c(){e=b("div"),l=b("label"),i=$(n),o=O(),r=b("div"),f.c(),d=O(),m(l,"for",s=t[16].name),m(l,"class","label column is-small is-3 svelte-wwfwxh"),m(r,"class","control has-icons-right column is-9"),m(e,"class","search-field field columns is-middle svelte-wwfwxh")},m(E,v){S(E,e,v),p(e,l),p(l,i),p(e,o),p(e,r),g[a].m(r,null),p(e,d),_=!0},p(E,v){(!_||v&1)&&n!==(n=E[16].label+"")&&F(i,n),(!_||v&1&&s!==(s=E[16].name))&&m(l,"for",s);let L=a;a=y(E,v),a===L?g[a].p(E,v):(be(),B(g[L],1,1,()=>{g[L]=null}),ge(),f=g[a],f?f.p(E,v):(f=g[a]=h[a](E),f.c()),U(f,1),f.m(r,null))},i(E){_||(U(f),_=!0)},o(E){B(f),_=!1},d(E){E&&w(e),g[a].d()}}}function di(t){let e,l,n,i,s;function o(){t[13].call(e,t[16])}return{c(){e=b("input"),m(e,"type","text"),m(e,"class","input is-small is-wide"),m(e,"id",l=t[16].name),m(e,"name",n=t[16].name)},m(r,c){S(r,e,c),ne(e,t[1][t[16].name]),i||(s=D(e,"input",o),i=!0)},p(r,c){t=r,c&1&&l!==(l=t[16].name)&&m(e,"id",l),c&1&&n!==(n=t[16].name)&&m(e,"name",n),c&3&&e.value!==t[1][t[16].name]&&ne(e,t[1][t[16].name])},i:j,o:j,d(r){r&&w(e),i=!1,s()}}}function _i(t){let e,l,n,i,s;function o(){t[12].call(e,t[16])}return{c(){e=b("input"),m(e,"type","number"),m(e,"class","input is-small is-wide"),m(e,"id",l=t[16].name),m(e,"name",n=t[16].name)},m(r,c){S(r,e,c),ne(e,t[1][t[16].name]),i||(s=D(e,"input",o),i=!0)},p(r,c){t=r,c&1&&l!==(l=t[16].name)&&m(e,"id",l),c&1&&n!==(n=t[16].name)&&m(e,"name",n),c&3&&kt(e.value)!==t[1][t[16].name]&&ne(e,t[1][t[16].name])},i:j,o:j,d(r){r&&w(e),i=!1,s()}}}function mi(t){let e,l,n,i,s;function o(){t[11].call(e,t[16])}return{c(){e=b("input"),m(e,"type","date"),m(e,"class","input is-small is-wide"),m(e,"id",l=t[16].name),m(e,"name",n=t[16].name)},m(r,c){S(r,e,c),ne(e,t[1][t[16].name]),i||(s=D(e,"input",o),i=!0)},p(r,c){t=r,c&1&&l!==(l=t[16].name)&&m(e,"id",l),c&1&&n!==(n=t[16].name)&&m(e,"name",n),c&3&&ne(e,t[1][t[16].name])},i:j,o:j,d(r){r&&w(e),i=!1,s()}}}function pi(t){let e,l,n,i,s;function o(){t[10].call(e,t[16])}return{c(){e=b("input"),m(e,"type","checkbox"),m(e,"id",l=t[16].name),m(e,"name",n=t[16].name)},m(r,c){S(r,e,c),e.checked=t[1][t[16].name],i||(s=D(e,"change",o),i=!0)},p(r,c){t=r,c&1&&l!==(l=t[16].name)&&m(e,"id",l),c&1&&n!==(n=t[16].name)&&m(e,"name",n),c&3&&(e.checked=t[1][t[16].name])},i:j,o:j,d(r){r&&w(e),i=!1,s()}}}function hi(t){let e,l,n,i,s;const o=[gi,bi],r=[];function c(u,a){return a&1&&(e=null),e==null&&(e=!!vi(u[16])),e?0:1}return l=c(t,-1),n=r[l]=o[l](t),{c(){n.c(),i=J()},m(u,a){r[l].m(u,a),S(u,i,a),s=!0},p(u,a){let f=l;l=c(u,a),l===f?r[l].p(u,a):(be(),B(r[f],1,1,()=>{r[f]=null}),ge(),n=r[l],n?n.p(u,a):(n=r[l]=o[l](u),n.c()),U(n,1),n.m(i.parentNode,i))},i(u){s||(U(n),s=!0)},o(u){B(n),s=!1},d(u){r[l].d(u),u&&w(i)}}}function bi(t){let e,l,n=!t[5](t[16]),i,s,o,r,c,u,a=n&&al(),f=t[16].choices,d=[];for(let y=0;y<f.length;y+=1)d[y]=dl(sl(t,f,y));let _=[{id:s=t[16].name},{name:o=t[16].name},{class:"is-wide"},t[5](t[16])?{size:3,multiple:!0}:{}],h={};for(let y=0;y<_.length;y+=1)h=ft(h,_[y]);function g(){t[9].call(l,t[16])}return{c(){e=b("div"),l=b("select"),a&&a.c(),i=J();for(let y=0;y<d.length;y+=1)d[y].c();gt(l,h),t[1][t[16].name]===void 0&&Pe(g),me(l,"svelte-wwfwxh",!0),m(e,"class",r="select is-small is-wide "+(t[5](t[16])?"is-multiple":""))},m(y,E){S(y,e,E),p(e,l),a&&a.m(l,null),p(l,i);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(l,null);"value"in h&&(h.multiple?vt:qe)(l,h.value),l.autofocus&&l.focus(),qe(l,t[1][t[16].name],!0),c||(u=D(l,"change",g),c=!0)},p(y,E){if(t=y,E&1&&(n=!t[5](t[16])),n?a?a.p(t,E):(a=al(),a.c(),a.m(l,i)):a&&(a.d(1),a=null),E&1){f=t[16].choices;let v;for(v=0;v<f.length;v+=1){const L=sl(t,f,v);d[v]?d[v].p(L,E):(d[v]=dl(L),d[v].c(),d[v].m(l,null))}for(;v<d.length;v+=1)d[v].d(1);d.length=f.length}gt(l,h=vn(_,[E&1&&s!==(s=t[16].name)&&{id:s},E&1&&o!==(o=t[16].name)&&{name:o},{class:"is-wide"},E&1&&(t[5](t[16])?{size:3,multiple:!0}:{})])),E&33&&"value"in h&&(h.multiple?vt:qe)(l,h.value),E&3&&qe(l,t[1][t[16].name]),me(l,"svelte-wwfwxh",!0),E&1&&r!==(r="select is-small is-wide "+(t[5](t[16])?"is-multiple":""))&&m(e,"class",r)},i:j,o:j,d(y){y&&w(e),a&&a.d(),le(d,y),c=!1,u()}}}function gi(t){let e,l;function n(...i){return t[8](t[16],...i)}return e=new ai({props:{items:t[16].choices,name:t[16].name,id:t[16].name}}),e.$on("select",n),{c(){Y(e.$$.fragment)},m(i,s){K(e,i,s),l=!0},p(i,s){t=i;const o={};s&1&&(o.items=t[16].choices),s&1&&(o.name=t[16].name),s&1&&(o.id=t[16].name),e.$set(o)},i(i){l||(U(e.$$.fragment,i),l=!0)},o(i){B(e.$$.fragment,i),l=!1},d(i){Z(e,i)}}}function al(t){let e;return{c(){e=b("option"),e.textContent=`${M==="en"?"Select":"Sélectionner"} ...
                                                    `,e.__value="",e.value=e.__value,e.disabled=!0,e.selected=!0,m(e,"class","faded")},m(l,n){S(l,e,n)},p:j,d(l){l&&w(e)}}}function dl(t){let e,l=t[19].label+"",n,i;return{c(){e=b("option"),n=$(l),e.__value=i=t[19].id,e.value=e.__value},m(s,o){S(s,e,o),p(e,n)},p(s,o){o&1&&l!==(l=s[19].label+"")&&F(n,l),o&1&&i!==(i=s[19].id)&&(e.__value=i,e.value=e.__value)},d(s){s&&w(e)}}}function _l(t){let e,l,n=t[16].name!=="search"&&fl(t);return{c(){n&&n.c(),e=J()},m(i,s){n&&n.m(i,s),S(i,e,s),l=!0},p(i,s){i[16].name!=="search"?n?(n.p(i,s),s&1&&U(n,1)):(n=fl(i),n.c(),U(n,1),n.m(e.parentNode,e)):n&&(be(),B(n,1,1,()=>{n=null}),ge())},i(i){l||(U(n),l=!0)},o(i){B(n),l=!1},d(i){n&&n.d(i),i&&w(e)}}}function ki(t){let e,l,n=t[0].length>0&&rl(t);return{c(){n&&n.c(),e=J()},m(i,s){n&&n.m(i,s),S(i,e,s),l=!0},p(i,[s]){i[0].length>0?n?(n.p(i,s),s&1&&U(n,1)):(n=rl(i),n.c(),U(n,1),n.m(e.parentNode,e)):n&&(be(),B(n,1,1,()=>{n=null}),ge())},i(i){l||(U(n),l=!0)},o(i){B(n),l=!1},d(i){n&&n.d(i),i&&w(e)}}}function vi(t){return t.type.includes("ChoiceField")&&t.choices.length>5}function wi(t,e,l){let n,{recordsStore:i}=e;const{recordSearch:s,searchParams:o}=i;ue(t,o,L=>l(14,n=L));let{searchFields:r=[]}=e,c={};cn(()=>{const L=n??new URLSearchParams(window.location.search);r.forEach(k=>{l(1,c[k.name]=L.get(k.name)||k.initial||"",c)})});function u(L){L.preventDefault(),s(c)}function a(L,k){l(1,c[L.name]=k.detail.id,c)}const f=L=>L.type.includes("Multiple");function d(L){c[L.name]=this.value,l(1,c),l(0,r)}const _=(L,k)=>a(L,k);function h(L){c[L.name]=ln(this),l(1,c),l(0,r)}function g(L){c[L.name]=this.checked,l(1,c),l(0,r)}function y(L){c[L.name]=this.value,l(1,c),l(0,r)}function E(L){c[L.name]=kt(this.value),l(1,c),l(0,r)}function v(L){c[L.name]=this.value,l(1,c),l(0,r)}return t.$$set=L=>{"recordsStore"in L&&l(6,i=L.recordsStore),"searchFields"in L&&l(0,r=L.searchFields)},[r,c,o,u,a,f,i,d,_,h,g,y,E,v]}class Si extends ce{constructor(e){super(),re(this,e,wi,ki,te,{recordsStore:6,searchFields:0})}}function ml(t){let e,l,n,i,s,o,r,c,u,a=t[5]>1&&pl(t),f=t[5]<t[3]&&gl(t);return{c(){e=b("nav"),l=b("ul"),a&&a.c(),n=O(),i=b("li"),s=b("a"),o=$(t[5]),r=O(),f&&f.c(),m(s,"class","pagination-link is-current"),m(s,"href",null),m(l,"class","pagination-list ml-0"),m(e,"class","pagination is-centered mb-2"),m(e,"aria-label","pagination")},m(d,_){S(d,e,_),p(e,l),a&&a.m(l,null),p(l,n),p(l,i),p(i,s),p(s,o),p(l,r),f&&f.m(l,null),c||(u=D(s,"click",Re(t[9])),c=!0)},p(d,_){d[5]>1?a?a.p(d,_):(a=pl(d),a.c(),a.m(l,n)):a&&(a.d(1),a=null),_&32&&F(o,d[5]),d[5]<d[3]?f?f.p(d,_):(f=gl(d),f.c(),f.m(l,null)):f&&(f.d(1),f=null)},d(d){d&&w(e),a&&a.d(),f&&f.d(),c=!1,u()}}}function pl(t){let e,l,n,i,s,o,r=t[5]-1>1&&hl(t);return{c(){e=b("li"),l=b("a"),l.textContent="1",n=O(),r&&r.c(),i=J(),m(l,"class","pagination-link"),m(l,"href",null)},m(c,u){S(c,e,u),p(e,l),S(c,n,u),r&&r.m(c,u),S(c,i,u),s||(o=D(l,"click",Re(t[7])),s=!0)},p(c,u){c[5]-1>1?r?r.p(c,u):(r=hl(c),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d(c){c&&w(e),c&&w(n),r&&r.d(c),c&&w(i),s=!1,o()}}}function hl(t){let e,l,n,i=t[5]-1+"",s,o,r,c=t[5]-1>2&&bl();return{c(){c&&c.c(),e=O(),l=b("li"),n=b("a"),s=$(i),m(n,"class","pagination-link"),m(n,"href",null)},m(u,a){c&&c.m(u,a),S(u,e,a),S(u,l,a),p(l,n),p(n,s),o||(r=D(n,"click",Re(t[8])),o=!0)},p(u,a){u[5]-1>2?c||(c=bl(),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),a&32&&i!==(i=u[5]-1+"")&&F(s,i)},d(u){c&&c.d(u),u&&w(e),u&&w(l),o=!1,r()}}}function bl(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function gl(t){let e,l,n,i,s,o,r=t[5]+1<t[3]&&kl(t);return{c(){r&&r.c(),e=O(),l=b("li"),n=b("a"),i=$(t[3]),m(n,"class","pagination-link"),m(n,"href",null)},m(c,u){r&&r.m(c,u),S(c,e,u),S(c,l,u),p(l,n),p(n,i),s||(o=D(n,"click",Re(t[11])),s=!0)},p(c,u){c[5]+1<c[3]?r?r.p(c,u):(r=kl(c),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),u&8&&F(i,c[3])},d(c){r&&r.d(c),c&&w(e),c&&w(l),s=!1,o()}}}function kl(t){let e,l,n=t[5]+1+"",i,s,o,r,c,u=t[5]+2<t[3]&&vl();return{c(){e=b("li"),l=b("a"),i=$(n),s=O(),u&&u.c(),o=J(),m(l,"class","pagination-link"),m(l,"href",null)},m(a,f){S(a,e,f),p(e,l),p(l,i),S(a,s,f),u&&u.m(a,f),S(a,o,f),r||(c=D(l,"click",Re(t[10])),r=!0)},p(a,f){f&32&&n!==(n=a[5]+1+"")&&F(i,n),a[5]+2<a[3]?u||(u=vl(),u.c(),u.m(o.parentNode,o)):u&&(u.d(1),u=null)},d(a){a&&w(e),a&&w(s),u&&u.d(a),a&&w(o),r=!1,c()}}}function vl(t){let e;return{c(){e=b("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>'},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function yi(t){let e,l,n=t[5]*t[2]-t[2]+1+"",i,s,o=Math.min(t[5]*t[2],t[1])+"",r,c,u,a,f=t[4]&&ml(t);return{c(){f&&f.c(),e=O(),l=b("div"),i=$(n),s=$(" - "),r=$(o),c=$(" / "),u=$(t[1]),m(l,"class",a="is-size-7 is-center mb-4 "+(t[4]?"":"mt-4"))},m(d,_){f&&f.m(d,_),S(d,e,_),S(d,l,_),p(l,i),p(l,s),p(l,r),p(l,c),p(l,u)},p(d,[_]){d[4]?f?f.p(d,_):(f=ml(d),f.c(),f.m(e.parentNode,e)):f&&(f.d(1),f=null),_&36&&n!==(n=d[5]*d[2]-d[2]+1+"")&&F(i,n),_&38&&o!==(o=Math.min(d[5]*d[2],d[1])+"")&&F(r,o),_&2&&F(u,d[1]),_&16&&a!==(a="is-size-7 is-center mb-4 "+(d[4]?"":"mt-4"))&&m(l,"class",a)},i:j,o:j,d(d){f&&f.d(d),d&&w(e),d&&w(l)}}}function Ei(t,e,l){let n,i,s,{store:o}=e;const{currentPage:r}=o;ue(t,r,g=>l(5,s=g));let{nbOfItems:c}=e,{pageLength:u=En}=e;const a=()=>o.handlePageUpdate(1),f=()=>o.handlePageUpdate(s-1),d=()=>o.handlePageUpdate(s),_=()=>o.handlePageUpdate(s+1),h=()=>o.handlePageUpdate(n);return t.$$set=g=>{"store"in g&&l(0,o=g.store),"nbOfItems"in g&&l(1,c=g.nbOfItems),"pageLength"in g&&l(2,u=g.pageLength)},t.$$.update=()=>{t.$$.dirty&6&&l(3,n=u>0?Math.ceil(c/u):1),t.$$.dirty&14&&l(4,i=n>1||c>u)},[o,c,u,n,i,s,r,a,f,d,_,h]}class wl extends ce{constructor(e){super(),re(this,e,Ei,yi,te,{store:0,nbOfItems:1,pageLength:2})}}const Li=t=>({}),Sl=t=>({});function Oi(t){let e,l,n,i,s,o,r,c,u,a,f,d,_,h,g,y,E,v,L,k,N;const P=t[1].content,C=Be(P,t,t[0],Sl);return{c(){e=b("button"),l=O(),n=b("div"),i=b("div"),s=O(),o=b("div"),r=b("div"),r.innerHTML=`<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div>
            <button class="delete media-left" aria-label="close"></button>`,c=O(),u=b("section"),a=b("div"),f=O(),d=b("div"),C&&C.c(),_=O(),h=b("footer"),g=b("div"),y=b("button"),y.textContent=`${M==="en"?"Abort":"Retour"}`,E=O(),v=b("button"),v.textContent="OK",m(e,"id","hidden-msg-btn"),m(e,"data-target","msg-modal"),e.hidden=!0,m(i,"id","modal-bkg"),m(i,"class","modal-background"),m(r,"class","modal-card-head media mb-0"),m(a,"id","modal-msg"),m(d,"class","py-3"),m(u,"id","modal-body"),m(u,"class","modal-card-body"),m(y,"id","cancel-btn"),m(y,"class","button is-link is-light button-close"),m(v,"id","ok-btn"),m(v,"class","button is-link button-close"),m(g,"class","buttons"),m(h,"id","modal-footer"),m(h,"class","modal-card-foot is-center pt-3"),h.hidden=!0,m(o,"class","modal-content"),m(n,"id","msg-modal"),m(n,"class","modal fade"),m(n,"tabindex","-1"),m(n,"aria-labelledby","selection-modal-label"),m(n,"aria-hidden","true")},m(T,z){S(T,e,z),S(T,l,z),S(T,n,z),p(n,i),p(n,s),p(n,o),p(o,r),p(o,c),p(o,u),p(u,a),p(u,f),p(u,d),C&&C.m(d,null),p(o,_),p(o,h),p(h,g),p(g,y),p(g,E),p(g,v),L=!0,k||(N=[Ve(Ct.call(null,e)),Ve(It.call(null,n))],k=!0)},p(T,[z]){C&&C.p&&(!L||z&1)&&ze(C,P,T,T[0],L?De(P,T[0],z,Li):He(T[0]),Sl)},i(T){L||(U(C,T),L=!0)},o(T){B(C,T),L=!1},d(T){T&&w(e),T&&w(l),T&&w(n),C&&C.d(T),k=!1,X(N)}}}function $i(t,e,l){let{$$slots:n={},$$scope:i}=e;return t.$$set=s=>{"$$scope"in s&&l(0,i=s.$$scope)},[i,n]}class yl extends ce{constructor(e){super(),re(this,e,$i,Oi,te,{})}}function Pi(t){const e=t,l=Se(1),n=Se([]),i=Se(0),s=Se(new URLSearchParams(window.location.search));Tn(l,"p");async function o(){const f=Fe(s);f.set("p",`${Fe(l)}`);try{const _=await(await fetch(`${window.location.origin}/search/${e}/?${f.toString()}`)).json();n.set(_.results),i.set(_.count),l.set(_.current_page),f.set("p",String(Fe(l)));const h=`${window.location.pathname}?${f.toString()}`;return history.pushState(null,"",h),_}catch(d){throw console.error("Error fetching page:",d),d}}let r=o();function c(f){Un(f,l,"p"),r=o()}function u(f){const d=new URLSearchParams(f);s.set(d),c(1)}function a(f){n.update(d=>d.filter(_=>_.id!==f))}return{currentPage:l,pageRecords:n,resultPage:r,resultNumber:i,fetchPage:o,handlePageUpdate:c,recordSearch:u,remove:a}}function El(t,e,l){const n=t.slice();return n[8]=e[l][0],n[9]=e[l][1],n}function Ll(t,e,l){const n=t.slice();return n[12]=e[l][0],n[13]=e[l][1],n}function Ol(t,e,l){const n=t.slice();return n[12]=e[l][0],n[13]=e[l][1],n}function Ni(t){let e=t[2]?"Retirer de la":"Charger dans la",l,n;return{c(){l=$(e),n=$(" sélection")},m(i,s){S(i,l,s),S(i,n,s)},p(i,s){s&4&&e!==(e=i[2]?"Retirer de la":"Charger dans la")&&F(l,e)},d(i){i&&w(l),i&&w(n)}}}function Ii(t){let e=t[2]?"Unload from":"Load to",l,n;return{c(){l=$(e),n=$(" selection")},m(i,s){S(i,l,s),S(i,n,s)},p(i,s){s&4&&e!==(e=i[2]?"Unload from":"Load to")&&F(l,e)},d(i){i&&w(l),i&&w(n)}}}function Ci(t){let e;return{c(){e=Le("path"),m(e,"d","M0 48C0 21.5 21.5 0 48 0l0 48V441.4l130.1-92.9c8.3-6 19.6-6 27.9 0L336 441.4V48H48V0H336c26.5 0 48 21.5 48 48V488c0 9-5 17.2-13 21.3s-17.6 3.4-24.9-1.8L192 397.5 37.9 507.5c-7.3 5.2-16.9 5.9-24.9 1.8S0 497 0 488V48z")},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function Ri(t){let e;return{c(){e=Le("path"),m(e,"d","M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z")},m(l,n){S(l,e,n)},d(l){l&&w(e)}}}function Ai(t){let e,l,n,i,s,o,r,c,u,a=M==="en"?"Export":"Exporter",f,d,_;function h(k,N){return M==="en"?Ii:Ni}let y=h()(t);function E(k,N){return k[2]?Ri:Ci}let v=E(t),L=v(t);return{c(){e=b("div"),l=b("button"),y.c(),n=O(),i=Le("svg"),L.c(),s=O(),o=b("button"),r=b("span"),c=b("i"),u=O(),f=$(a),m(i,"xmlns","http://www.w3.org/2000/svg"),m(i,"viewBox","0 0 384 512"),m(l,"class","button"),me(l,"is-inverted",t[2]),m(c,"class","fa-solid fa-file-export"),m(o,"class","button is-link"),me(o,"is-inverted",t[2]),m(e,"slot","buttons")},m(k,N){S(k,e,N),p(e,l),y.m(l,null),p(l,n),p(l,i),L.m(i,null),p(e,s),p(e,o),p(o,r),p(r,c),p(r,u),p(r,f),d||(_=[D(l,"click",t[6]),D(o,"click",t[7])],d=!0)},p(k,N){y.p(k,N),v!==(v=E(k))&&(L.d(1),L=v(k),L&&(L.c(),L.m(i,null))),N&4&&me(l,"is-inverted",k[2]),N&4&&me(o,"is-inverted",k[2])},d(k){k&&w(e),y.d(),L.d(),d=!1,X(_)}}}function $l(t){let e,l=t[13].task_type+"",n,i,s=t[12]+"",o,r,c,u;return{c(){e=b("a"),n=$(l),i=$(" #"),o=$(s),r=O(),m(e,"href",c=t[13].url),m(e,"class",u="tag is-rounded is-small "+Cl(t[13].status))},m(a,f){S(a,e,f),p(e,n),p(e,i),p(e,o),p(e,r)},p(a,f){f&1&&l!==(l=a[13].task_type+"")&&F(n,l),f&1&&s!==(s=a[12]+"")&&F(o,s),f&1&&c!==(c=a[13].url)&&m(e,"href",c),f&1&&u!==(u="tag is-rounded is-small "+Cl(a[13].status))&&m(e,"class",u)},d(a){a&&w(e)}}}function Pl(t){let e,l=Object.entries(t[9]),n=[];for(let i=0;i<l.length;i+=1)n[i]=Nl(Ll(t,l,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=J()},m(i,s){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(i,s);S(i,e,s)},p(i,s){if(s&1){l=Object.entries(i[9]);let o;for(o=0;o<l.length;o+=1){const r=Ll(i,l,o);n[o]?n[o].p(r,s):(n[o]=Nl(r),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=l.length}},d(i){le(n,i),i&&w(e)}}}function Nl(t){let e,l,n=t[8]+"",i,s,o=t[12]+"",r,c,u=t[13].title+"",a,f;return{c(){e=b("div"),l=b("span"),i=$(n),s=$(" #"),r=$(o),c=O(),a=$(u),f=O(),m(l,"class","tag is-rounded is-accent")},m(d,_){S(d,e,_),p(e,l),p(l,i),p(l,s),p(l,r),p(e,c),p(e,a),p(e,f)},p(d,_){_&1&&n!==(n=d[8]+"")&&F(i,n),_&1&&o!==(o=d[12]+"")&&F(r,o),_&1&&u!==(u=d[13].title+"")&&F(a,u)},d(d){d&&w(e)}}}function Il(t){let e,l=t[8]!=="User"&&Pl(t);return{c(){l&&l.c(),e=J()},m(n,i){l&&l.m(n,i),S(n,e,i)},p(n,i){n[8]!=="User"?l?l.p(n,i):(l=Pl(n),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(n){l&&l.d(n),n&&w(e)}}}function ji(t){let e,l,n,i,s=Object.entries(t[0].treatments),o=[];for(let u=0;u<s.length;u+=1)o[u]=$l(Ol(t,s,u));let r=Object.entries(t[0].selection.selected),c=[];for(let u=0;u<r.length;u+=1)c[u]=Il(El(t,r,u));return{c(){e=b("div"),l=b("div");for(let u=0;u<o.length;u+=1)o[u].c();n=O(),i=b("div");for(let u=0;u<c.length;u+=1)c[u].c();m(l,"class","tags container"),m(i,"class","grid"),m(e,"slot","body")},m(u,a){S(u,e,a),p(e,l);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(l,null);p(e,n),p(e,i);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(i,null)},p(u,a){if(a&1){s=Object.entries(u[0].treatments);let f;for(f=0;f<s.length;f+=1){const d=Ol(u,s,f);o[f]?o[f].p(d,a):(o[f]=$l(d),o[f].c(),o[f].m(l,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=s.length}if(a&1){r=Object.entries(u[0].selection.selected);let f;for(f=0;f<r.length;f+=1){const d=El(u,r,f);c[f]?c[f].p(d,a):(c[f]=Il(d),c[f].c(),c[f].m(i,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=r.length}},d(u){u&&w(e),le(o,u),le(c,u)}}}function Mi(t){let e,l,n,i;return e=new yl({}),n=new ot({props:{item:t[0],recordsStore:t[1],$$slots:{body:[ji],buttons:[Ai]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment),l=O(),Y(n.$$.fragment)},m(s,o){K(e,s,o),S(s,l,o),K(n,s,o),i=!0},p(s,[o]){const r={};o&1&&(r.item=s[0]),o&2&&(r.recordsStore=s[1]),o&262149&&(r.$$scope={dirty:o,ctx:s}),n.$set(r)},i(s){i||(U(e.$$.fragment,s),U(n.$$.fragment,s),i=!0)},o(s){B(e.$$.fragment,s),B(n.$$.fragment,s),i=!1},d(s){Z(e,s),s&&w(l),Z(n,s)}}}function Cl(t){return t?t==="CANCELLED"?"is-info":t==="ERROR"?"is-danger":t==="IN PROGRESS"?"is-warning":t==="PENDING"||t==="STARTED"?"is-info":t==="SUCCESS"?"is-success":"is-dark":"is-dark"}function Ti(t,e,l){let n,i,{item:s}=e,{recordsStore:o}=e;const{isSetSelected:r}=ve;ue(t,r,f=>l(5,i=f));async function c(f){let d=M==="en"?"You can export the contents of this set as a ZIP archive or reach our JSON API.":"Vous pouvez exporter le contenu de cet ensemble en archive ZIP ou interroger notre API JSON.",_=document.createElement("div");_.style="display: flex; gap: 1rem; align-items: center; justify-content: center; margin-top: 1em;";let h=document.createElement("a");h.classList.add("button","is-link"),h.innerHTML="<span>"+(M==="en"?"JSON API":"API JSON")+"</span>",h.href=`/${fe}/document-set/${f.id}/json`,h.target="_blank";let g=document.createElement("a");g.classList.add("button","is-link"),g.innerHTML="<span>ZIP</span>",g.href=`/${fe}/document-set/${f.id}/zip`,g.target="_blank",_.appendChild(h),_.appendChild(g),await Te(d+"<br/>"+_.outerHTML,"Export",!1)}const u=()=>ve.toggleSet(s),a=()=>c(s);return t.$$set=f=>{"item"in f&&l(0,s=f.item),"recordsStore"in f&&l(1,o=f.recordsStore)},t.$$.update=()=>{t.$$.dirty&33&&l(2,n=i(s))},[s,o,n,r,c,i,u,a]}let Ui=class extends ce{constructor(e){super(),re(this,e,Ti,Mi,te,{item:0,recordsStore:1})}};function Rl(t,e,l){const n=t.slice();return n[5]=e[l][0],n[6]=e[l][1],n}function Al(t,e,l){const n=t.slice();return n[9]=e[l][0],n[10]=e[l][1],n}function Fi(t){let e,l,n,i,s;return{c(){e=b("a"),l=b("i"),n=O(),i=b("span"),i.textContent=`${M==="en"?"Relaunch same treatment":"Relancer le même traitement"}`,m(l,"class","fa-solid fa-arrow-rotate-left"),m(e,"href",s="add/"+t[0].query_parameters),m(e,"class","button is-small is-rounded is-primary is-outlined px-2 py-1 mr-2"),m(e,"title",M==="en"?"Relaunch same treatment":"Relancer le même traitement")},m(o,r){S(o,e,r),p(e,l),p(e,n),p(e,i)},p(o,r){r&1&&s!==(s="add/"+o[0].query_parameters)&&m(e,"href",s)},d(o){o&&w(e)}}}function Bi(t){let e,l,n,i,s,o;return{c(){e=b("button"),l=b("i"),n=O(),i=b("span"),i.textContent=`${M==="en"?"Cancel treatment":"Annuler le traitement"}`,m(l,"class","fa-solid fa-ban"),m(e,"class","button is-small is-rounded is-danger is-outlined px-2 py-1 mr-2"),m(e,"title",M==="en"?"Cancel treatment":"Annuler le traitement")},m(r,c){S(r,e,c),p(e,l),p(e,n),p(e,i),s||(o=D(e,"click",t[4]),s=!0)},p:j,d(r){r&&w(e),s=!1,o()}}}function Di(t){let e,l;return{c(){e=b("span"),l=$(t[2]),m(e,"class","tag is-info p-1 mb-1")},m(n,i){S(n,e,i),p(e,l)},p(n,i){i&4&&F(l,n[2])},d(n){n&&w(e)}}}function zi(t){let e,l,n;return{c(){e=b("span"),l=$(t[2]),m(e,"class","tag is-danger p-1 mb-1"),m(e,"title",n=t[0].info||"Unknown error")},m(i,s){S(i,e,s),p(e,l)},p(i,s){s&4&&F(l,i[2]),s&1&&n!==(n=i[0].info||"Unknown error")&&m(e,"title",n)},d(i){i&&w(e)}}}function Hi(t){let e,l;return{c(){e=b("span"),l=$(t[2]),m(e,"class","tag is-success p-1 mb-1")},m(n,i){S(n,e,i),p(e,l)},p(n,i){i&4&&F(l,n[2])},d(n){n&&w(e)}}}function Vi(t){let e,l;function n(u,a){if(!u[3]&&u[0].api_tracking_id)return Bi;if(u[3]&&u[2]==="ERROR")return Fi}let i=n(t),s=i&&i(t);function o(u,a){return u[2]==="SUCCESS"?Hi:u[2]==="ERROR"?zi:Di}let r=o(t),c=r(t);return{c(){e=b("div"),s&&s.c(),l=O(),c.c(),m(e,"slot","buttons")},m(u,a){S(u,e,a),s&&s.m(e,null),p(e,l),c.m(e,null)},p(u,a){i===(i=n(u))&&s?s.p(u,a):(s&&s.d(1),s=i&&i(u),s&&(s.c(),s.m(e,l))),r===(r=o(u))&&c?c.p(u,a):(c.d(1),c=r(u),c&&(c.c(),c.m(e,null)))},d(u){u&&w(e),s&&s.d(),c.d()}}}function jl(t){let e,l=Object.entries(t[0].selection.selected),n=[];for(let i=0;i<l.length;i+=1)n[i]=Tl(Rl(t,l,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=J()},m(i,s){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(i,s);S(i,e,s)},p(i,s){if(s&1){l=Object.entries(i[0].selection.selected);let o;for(o=0;o<l.length;o+=1){const r=Rl(i,l,o);n[o]?n[o].p(r,s):(n[o]=Tl(r),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=l.length}},d(i){le(n,i),i&&w(e)}}}function Ml(t){let e,l,n=t[5]+"",i,s,o=t[9]+"",r,c,u=t[10].title+"",a,f;return{c(){e=b("div"),l=b("span"),i=$(n),s=$(" #"),r=$(o),c=O(),a=$(u),f=O(),m(l,"class","tag is-rounded is-accent")},m(d,_){S(d,e,_),p(e,l),p(l,i),p(l,s),p(l,r),p(e,c),p(e,a),p(e,f)},p(d,_){_&1&&n!==(n=d[5]+"")&&F(i,n),_&1&&o!==(o=d[9]+"")&&F(r,o),_&1&&u!==(u=d[10].title+"")&&F(a,u)},d(d){d&&w(e)}}}function Tl(t){let e,l=Object.entries(t[6]),n=[];for(let i=0;i<l.length;i+=1)n[i]=Ml(Al(t,l,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=J()},m(i,s){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(i,s);S(i,e,s)},p(i,s){if(s&1){l=Object.entries(i[6]);let o;for(o=0;o<l.length;o+=1){const r=Al(i,l,o);n[o]?n[o].p(r,s):(n[o]=Ml(r),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=l.length}},d(i){le(n,i),i&&w(e)}}}function qi(t){let e,l=t[0].hasOwnProperty("selection")&&t[0].selection.hasOwnProperty("selected")&&t[0].selection.selected,n=l&&jl(t);return{c(){e=b("div"),n&&n.c(),m(e,"slot","body"),m(e,"class","pt-2 grid")},m(i,s){S(i,e,s),n&&n.m(e,null)},p(i,s){s&1&&(l=i[0].hasOwnProperty("selection")&&i[0].selection.hasOwnProperty("selected")&&i[0].selection.selected),l?n?n.p(i,s):(n=jl(i),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(i){i&&w(e),n&&n.d()}}}function Ji(t){let e,l;return e=new ot({props:{item:t[0],recordsStore:t[1],$$slots:{body:[qi],buttons:[Vi]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment)},m(n,i){K(e,n,i),l=!0},p(n,[i]){const s={};i&1&&(s.item=n[0]),i&2&&(s.recordsStore=n[1]),i&8205&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){l||(U(e.$$.fragment,n),l=!0)},o(n){B(e.$$.fragment,n),l=!1},d(n){Z(e,n)}}}function Wi(t,e,l){let n,i,{item:s}=e,{recordsStore:o}=e;async function r(){if(!await Te(M==="en"?"Are you sure you want to cancel treatment?":"Êtes-vous sûr de vouloir annuler le traitement en cours ?",M==="en"?"Confirm cancel":"Confirmer l'annulation",!0))return;await Nt(`/${fe}/treatment/${s.id}/cancel`)?(l(3,n=!0),l(2,i="CANCELLED")):await Te(M==="en"?"Failed to cancel treatment":"Erreur lors de l'annulation du traitement",M==="en"?"Error":"Erreur")}return t.$$set=c=>{"item"in c&&l(0,s=c.item),"recordsStore"in c&&l(1,o=c.recordsStore)},t.$$.update=()=>{t.$$.dirty&1&&l(3,n=s.is_finished),t.$$.dirty&1&&l(2,i=s.status)},[s,o,i,n,r]}class Gi extends ce{constructor(e){super(),re(this,e,Wi,Ji,te,{item:0,recordsStore:1})}}function Ul(t,e,l){const n=t.slice();return n[17]=e[l][0],n[18]=e[l][1],n}function Fl(t,e,l){const n=t.slice();return n[21]=e[l][0],n[22]=e[l][1],n}function Bl(t,e,l){const n=t.slice();return n[26]=e[l],n}function Dl(t){let e,l,n,i,s;return{c(){e=b("span"),l=b("a"),n=b("i"),i=O(),s=b("span"),s.textContent=`${M==="en"?"Add":"Ajouter"}`,m(n,"class","fa-solid fa-plus"),m(l,"href",t[12]),m(l,"class","button is-rounded is-primary mb-4"),m(l,"title",M==="en"?"Add":"Ajouter"),m(e,"class","is-right")},m(o,r){S(o,e,r),p(e,l),p(l,n),p(l,i),p(l,s)},p:j,d(o){o&&w(e)}}}function Ki(t){let e,l=M==="en"?"Error when retrieving records: ":"Erreur lors de la récupération des enregistrements : ",n,i,s=t[29]+"",o;return{c(){e=b("div"),n=$(l),i=O(),o=$(s),m(e,"class","faded is-center")},m(r,c){S(r,e,c),p(e,n),p(e,i),p(e,o)},p:j,i:j,o:j,d(r){r&&w(e)}}}function Zi(t){let e,l,n=t[4].length!==0&&zl(t);return{c(){n&&n.c(),e=J()},m(i,s){n&&n.m(i,s),S(i,e,s),l=!0},p(i,s){i[4].length!==0?n?(n.p(i,s),s&16&&U(n,1)):(n=zl(i),n.c(),U(n,1),n.m(e.parentNode,e)):n&&(be(),B(n,1,1,()=>{n=null}),ge())},i(i){l||(U(n),l=!0)},o(i){B(n),l=!1},d(i){n&&n.d(i),i&&w(e)}}}function zl(t){let e,l,n,i=[],s=new Map,o,r,c;e=new wl({props:{store:t[8],nbOfItems:t[5]}});let u=t[4];const a=d=>d[26].id;for(let d=0;d<u.length;d+=1){let _=Bl(t,u,d),h=a(_);s.set(h,i[d]=Vl(h,_))}let f=null;return u.length||(f=Hl()),r=new wl({props:{store:t[8],nbOfItems:t[5]}}),{c(){Y(e.$$.fragment),l=O(),n=b("div");for(let d=0;d<i.length;d+=1)i[d].c();f&&f.c(),o=O(),Y(r.$$.fragment)},m(d,_){K(e,d,_),S(d,l,_),S(d,n,_);for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(n,null);f&&f.m(n,null),S(d,o,_),K(r,d,_),c=!0},p(d,_){const h={};_&32&&(h.nbOfItems=d[5]),e.$set(h),_&272&&(u=d[4],be(),i=Ot(i,_,a,1,d,u,s,n,kn,Vl,null,Bl),ge(),!u.length&&f?f.p(d,_):u.length?f&&(f.d(1),f=null):(f=Hl(),f.c(),f.m(n,null)));const g={};_&32&&(g.nbOfItems=d[5]),r.$set(g)},i(d){if(!c){U(e.$$.fragment,d);for(let _=0;_<u.length;_+=1)U(i[_]);U(r.$$.fragment,d),c=!0}},o(d){B(e.$$.fragment,d);for(let _=0;_<i.length;_+=1)B(i[_]);B(r.$$.fragment,d),c=!1},d(d){Z(e,d),d&&w(l),d&&w(n);for(let _=0;_<i.length;_+=1)i[_].d();f&&f.d(),d&&w(o),Z(r,d)}}}function Hl(t){let e;return{c(){e=b("p"),e.textContent=`${M==="en"?"No records found":"Aucun enregistrement trouvé"}`},m(l,n){S(l,e,n)},p:j,d(l){l&&w(e)}}}function Xi(t){let e,l;return e=new Zn({props:{item:t[26],recordsStore:t[8]}}),{c(){Y(e.$$.fragment)},m(n,i){K(e,n,i),l=!0},p(n,i){const s={};i&16&&(s.item=n[26]),e.$set(s)},i(n){l||(U(e.$$.fragment,n),l=!0)},o(n){B(e.$$.fragment,n),l=!1},d(n){Z(e,n)}}}function Yi(t){let e,l;return e=new Ui({props:{item:t[26],recordsStore:t[8]}}),{c(){Y(e.$$.fragment)},m(n,i){K(e,n,i),l=!0},p(n,i){const s={};i&16&&(s.item=n[26]),e.$set(s)},i(n){l||(U(e.$$.fragment,n),l=!0)},o(n){B(e.$$.fragment,n),l=!1},d(n){Z(e,n)}}}function Qi(t){let e,l;return e=new Gi({props:{item:t[26],recordsStore:t[8]}}),{c(){Y(e.$$.fragment)},m(n,i){K(e,n,i),l=!0},p(n,i){const s={};i&16&&(s.item=n[26]),e.$set(s)},i(n){l||(U(e.$$.fragment,n),l=!0)},o(n){B(e.$$.fragment,n),l=!1},d(n){Z(e,n)}}}function Vl(t,e){let l,n,i,s,o,r,c;const u=[Qi,Yi,Xi],a=[];function f(d,_){return _&16&&(n=null),_&16&&(i=null),n==null&&(n=!!d[26].class.includes("Treatment")),n?0:(i==null&&(i=!!d[26].class.includes("Set")),i?1:2)}return s=f(e,-1),o=a[s]=u[s](e),{key:t,first:null,c(){l=J(),o.c(),r=J(),this.first=l},m(d,_){S(d,l,_),a[s].m(d,_),S(d,r,_),c=!0},p(d,_){e=d;let h=s;s=f(e,_),s===h?a[s].p(e,_):(be(),B(a[h],1,1,()=>{a[h]=null}),ge(),o=a[s],o?o.p(e,_):(o=a[s]=u[s](e),o.c()),U(o,1),o.m(r.parentNode,r))},i(d){c||(U(o),c=!0)},o(d){B(o),c=!1},d(d){d&&w(l),a[s].d(d),d&&w(r)}}}function xi(t){let e;return{c(){e=b("div"),e.textContent=`${M==="en"?"Retrieving records...":"Récupération des enregistrements..."}`,m(e,"class","faded is-center")},m(l,n){S(l,e,n)},p:j,i:j,o:j,d(l){l&&w(e)}}}function ql(t){let e,l,n;return{c(){e=b("tr"),l=b("td"),l.textContent=`${M==="en"?"No documents in selection":"Aucun document sélectionné"}`,n=O()},m(i,s){S(i,e,s),p(e,l),p(e,n)},p:j,d(i){i&&w(e)}}}function Jl(t){let e,l=Ze[t[17]]+"",n,i,s,o,r,c=Object.entries(t[18]),u=[];for(let a=0;a<c.length;a+=1)u[a]=Wl(Fl(t,c,a));return{c(){e=b("h3"),n=$(l),i=O(),s=b("table"),o=b("tbody");for(let a=0;a<u.length;a+=1)u[a].c();r=O(),m(s,"class","table pl-2 is-fullwidth")},m(a,f){S(a,e,f),p(e,n),S(a,i,f),S(a,s,f),p(s,o);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(o,null);p(s,r)},p(a,f){if(f&8&&l!==(l=Ze[a[17]]+"")&&F(n,l),f&8){c=Object.entries(a[18]);let d;for(d=0;d<c.length;d+=1){const _=Fl(a,c,d);u[d]?u[d].p(_,f):(u[d]=Wl(_),u[d].c(),u[d].m(o,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}},d(a){a&&w(e),a&&w(i),a&&w(s),le(u,a)}}}function Wl(t){let e,l,n,i,s=t[21]+"",o,r,c,u,a=t[22].title+"",f,d,_,h,g,y,E,v;function L(){return t[16](t[21],t[17])}return{c(){e=b("tr"),l=b("th"),n=b("span"),i=$("#"),o=$(s),r=O(),c=b("td"),u=b("a"),f=$(a),_=O(),h=b("td"),g=b("button"),y=O(),m(n,"class","tag px-2 py-1 mb-1 is-dark is-rounded"),m(l,"class","is-narrow is-3"),m(u,"href",d=t[22].url),m(u,"target","_blank"),m(g,"class","delete"),m(g,"aria-label","close"),m(h,"class","is-narrow")},m(k,N){S(k,e,N),p(e,l),p(l,n),p(n,i),p(n,o),p(e,r),p(e,c),p(c,u),p(u,f),p(e,_),p(e,h),p(h,g),S(k,y,N),E||(v=D(g,"click",L),E=!0)},p(k,N){t=k,N&8&&s!==(s=t[21]+"")&&F(o,s),N&8&&a!==(a=t[22].title+"")&&F(f,a),N&8&&d!==(d=t[22].url)&&m(u,"href",d)},d(k){k&&w(e),k&&w(y),E=!1,v()}}}function Gl(t){let e=Object.values(t[18]).length>0&&t[17]in Ze&&t[17]!=="User",l,n=e&&Jl(t);return{c(){n&&n.c(),l=J()},m(i,s){n&&n.m(i,s),S(i,l,s)},p(i,s){s&8&&(e=Object.values(i[18]).length>0&&i[17]in Ze&&i[17]!=="User"),e?n?n.p(i,s):(n=Jl(i),n.c(),n.m(l.parentNode,l)):n&&(n.d(1),n=null)},d(i){n&&n.d(i),i&&w(l)}}}function es(t){let e,l=Object.entries(t[3]),n=[];for(let s=0;s<l.length;s+=1)n[s]=Gl(Ul(t,l,s));let i=null;return l.length||(i=ql()),{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=J(),i&&i.c()},m(s,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(s,o);S(s,e,o),i&&i.m(s,o)},p(s,o){if(o&8){l=Object.entries(s[3]);let r;for(r=0;r<l.length;r+=1){const c=Ul(s,l,r);n[r]?n[r].p(c,o):(n[r]=Gl(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=l.length,!l.length&&i?i.p(s,o):l.length?i&&(i.d(1),i=null):(i=ql(),i.c(),i.m(e.parentNode,e))}},d(s){le(n,s),s&&w(e),i&&i.d(s)}}}function ts(t){let e,l,n,i,s,o,r=!t[0].includes("set"),c,u,a,f;e=new yl({}),n=new Qn({props:{selectionLength:t[2]}}),s=new Si({props:{recordsStore:t[8],searchFields:t[1]}});let d=r&&Dl(t),_={ctx:t,current:null,token:null,hasCatch:!0,pending:xi,then:Zi,catch:Ki,value:25,error:29,blocks:[,,,]};return hn(t[10],_),a=new ci({props:{selectionLength:t[2],selectionStore:ve,$$slots:{default:[es]},$$scope:{ctx:t}}}),{c(){Y(e.$$.fragment),l=O(),Y(n.$$.fragment),i=O(),Y(s.$$.fragment),o=O(),d&&d.c(),c=O(),_.block.c(),u=O(),Y(a.$$.fragment)},m(h,g){K(e,h,g),S(h,l,g),K(n,h,g),S(h,i,g),K(s,h,g),S(h,o,g),d&&d.m(h,g),S(h,c,g),_.block.m(h,_.anchor=g),_.mount=()=>u.parentNode,_.anchor=u,S(h,u,g),K(a,h,g),f=!0},p(h,[g]){t=h;const y={};g&4&&(y.selectionLength=t[2]),n.$set(y);const E={};g&2&&(E.searchFields=t[1]),s.$set(E),g&1&&(r=!t[0].includes("set")),r?d?d.p(t,g):(d=Dl(t),d.c(),d.m(c.parentNode,c)):d&&(d.d(1),d=null),bn(_,t,g);const v={};g&4&&(v.selectionLength=t[2]),g&1073741832&&(v.$$scope={dirty:g,ctx:t}),a.$set(v)},i(h){f||(U(e.$$.fragment,h),U(n.$$.fragment,h),U(s.$$.fragment,h),U(_.block),U(a.$$.fragment,h),f=!0)},o(h){B(e.$$.fragment,h),B(n.$$.fragment,h),B(s.$$.fragment,h);for(let g=0;g<3;g+=1){const y=_.blocks[g];B(y)}B(a.$$.fragment,h),f=!1},d(h){Z(e,h),h&&w(l),Z(n,h),h&&w(i),Z(s,h),h&&w(o),d&&d.d(h),h&&w(c),_.block.d(h),_.token=null,_=null,h&&w(u),Z(a,h)}}}function ls(t,e,l){let n,i,s,o,r,c;const{selected:u,nbSelected:a}=ve;ue(t,u,k=>l(15,o=k)),ue(t,a,k=>l(14,s=k));let{modelName:f=""}=e;yt("modelName",f);let{modelTitle:d=""}=e;yt("modelTitle",d);const _=Pi(f),{pageRecords:h,resultPage:g,resultNumber:y}=_;ue(t,h,k=>l(4,r=k)),ue(t,y,k=>l(5,c=k));let{searchFields:E=[]}=e;const v=f.includes("treatment")?`/${fe}/${f}/add/`:`/${fe}-admin/${Sn}/${f}/add/`,L=(k,N)=>ve.remove(k,N);return t.$$set=k=>{"modelName"in k&&l(13,f=k.modelName),"modelTitle"in k&&l(0,d=k.modelTitle),"searchFields"in k&&l(1,E=k.searchFields)},t.$$.update=()=>{t.$$.dirty&32768&&l(3,n=o),t.$$.dirty&16384&&l(2,i=s)},[d,E,i,n,r,c,u,a,_,h,g,y,v,f,s,o,L]}class ns extends ce{constructor(e){super(),re(this,e,ls,ts,te,{modelName:13,modelTitle:0,searchFields:1})}}new ns({target:document.getElementById("record-list"),props:{searchFields,modelName,modelTitle}})})();
//# sourceMappingURL=recordList.js.map
